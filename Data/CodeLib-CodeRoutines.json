[{"RecordId":"2","Title":"Shut Down An Application","Description":"Shuts down an application that contains the Window's title.\r\nThis will not work if a modal form from the same application is opened.  It will work if a MessageBox is displayed.\r\nIf more than 1 instance of the app is running, use Enum Windows API.\r\n\r\n","Code":"'---------------------------------------------------------------------------------------------------------\r\n' Call with ShutDownApp \"You apps window text (even partial text)\"\r\n'---------------------------------------------------------------------------------------------------------\r\nPublic Sub ShutDownApp(strWindowText As String)\r\n\r\nDim hwnd As Long\r\nDim lRetVal As Long\r\n\r\nhwnd = LookForWindowText(strWindowText)\r\nIf hwnd Then\r\n    lRetVal = PostMessage(hwnd, WM_CLOSE, 0, 0)\r\nEnd If\r\n\r\nEnd Sub\r\n'---------------------------------------------------------------------------------------------------------\r\nPrivate Function LookForWindowText(strAppName As String) As Long\r\n     \r\nDim hwnd As Long\r\nDim strWinTitle As String\r\nDim varRet As Long\r\nDim retval2 As Long\r\n\r\nstrAppName = UCase$(strAppName)\r\nhwnd = FindWindowByNum(0&, 0&)\r\n\r\nDo Until hwnd = 0\r\n    If GetParent(hwnd) = 0 Then\r\n        strWinTitle = Space$(255)\r\n        varRet = GetWindowText(hwnd, strWinTitle, Len(strWinTitle))\r\n        If varRet Then\r\n            strWinTitle = Left$(strWinTitle, varRet)\r\n            strWinTitle = UCase$(strWinTitle)\r\n            If InStr(strWinTitle, strAppName) = 1 Then\r\n                LookForWindowText = hwnd\r\n                Exit Function\r\n            End If\r\n        End If\r\n    End If\r\n    hwnd = GetWindow(hwnd, GW_HWNDNEXT)\r\nLoop\r\n      \r\nEnd Function\r\n","Declares":"Declare Function GetWindowText Lib \"user32\" Alias \"GetWindowTextA\" (ByVal hwnd As Long, ByVal lpString As String, ByVal cch As Long) As Long\r\nDeclare Function GetWindow Lib \"user32\" (ByVal hwnd As Long, ByVal wCmd As Long) As Long\r\nDeclare Function FindWindowByNum Lib \"user32\" Alias \"FindWindowA\" (ByVal lpClassName As Long, ByVal lpWindowName As Long) As Long\r\nDeclare Function FindWindow Lib \"user32\" Alias \"FindWindowA\" (ByVal lpClassName As String, ByVal lpWindowName As String) As Long\r\nDeclare Function PostMessage Lib \"user32\" Alias \"PostMessageA\" (ByVal hwnd As Long, ByVal wMsg As Long, ByVal wParam As Long, ByVal lParam As Long) As Long\r\nDeclare Function GetParent Lib \"user32\" (ByVal hwnd As Long) As Long\r\n\r\nConst WM_CLOSE = &H10\r\nConst GW_HWNDNEXT = 2\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Shut down"]},{"RecordId":"3","Title":"Get Disk Free Space (32 bit)","Description":"Computes amount of total, free, and used disk drive space","Code":"Sub GetFreeSpace (drv$)\r\n\r\nDim freespace&, totalspace&, usedspace&\r\nDim ret&, sectors&, bytes&, free&, total&\r\n\r\ndrv$ = \"C:\\\"\r\n\r\nret& = GetDiskFreeSpace(drv$, sectors&, bytes&, free&, total&)\r\n\r\nfreespace& = sectors& * bytes& * free&\r\ntotalspace& = sectors& * bytes& * total&\r\nusedspace& = totalspace& - freespace&\r\n\r\nEnd Sub\r\n","Declares":"Declare Function GetDiskFreeSpace Lib \"kernel32\" Alias \"GetDiskFreeSpaceA\" (ByVal lpRootPathName As String, lpSectorsPerCluster As Long, lpBytesPerSector As Long, lpNumberOfFreeClusters As Long, lpTotalNumberOfClusters As Long) As Long\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Disk Space","Free Disk Space","System Info"]},{"RecordId":"4","Title":"Floating Toolbar (Toolbar)","Description":"Creates a form with a custom caption bar that can be moved (dragged) around the screen.  This form is also made to \"appear to be a child\" of a parent form and float on top of it, but it does not float on top of all of the other forms that are open.\r\n","Code":"'-------------------------------------------------------------------------------------------------\r\n'Place this code in the form load event of the toolbar form.\r\n'-------------------------------------------------------------------------------------------------\r\n  'Size & position the label to appear as a caption\r\n    Label1.Width = Me.Width\r\n    Label1.Top = 0\r\n    Label1.Caption = \"Toolbar demo\"\r\n    \r\n    'Make the toolbar form a child window of the main window so\r\n    'that it will always remain on top of main window, but not on\r\n    'top of other windows\r\n    Call SetWindowWord(ToolbarForm.hWnd, SWW_HPARENT, ParentForm.hWnd)\r\n\r\n'-------------------------------------------------------------------------------------------------\r\n'Place this code in the mouse down load event of the toolbar form.\r\n'-------------------------------------------------------------------------------------------------\r\n    Dim i As Long\r\n    \r\n    'Allows Windows to drag the window as if it had a caption bar\r\n    If Button = 1 Then\r\n        Call ReleaseCapture\r\n        i = SendMessage(hWnd, WM_NCLBUTTONDOWN, HTCAPTION, ByVal 0&)\r\n    End If\r\n'-------------------------------------------------------------------------------------------------\r\n'The toolbar is loaded from the parent with a Toolbar.Show method.\r\n'The toolbar is unloaded in the parent form's unload event using the \r\n'Unload Toolbar method.\r\n'-------------------------------------------------------------------------------------------------\r\n\r\n","Declares":"Declare Function SendMessage Lib \"User\" (ByVal hWnd As Integer, ByVal wMsg As Integer, ByVal wParam As Integer, lParam As Any) As Long\r\nDeclare Sub ReleaseCapture Lib \"User\" ()\r\nDeclare Sub SetWindowWord Lib \"User\" (ByVal hWnd As Integer, ByVal nCmd As Integer, ByVal nVal As Integer)\r\n\r\nConst WM_NCLBUTTONDOWN = &HA1\r\nConst HTCAPTION = 2\r\nConst SWW_HPARENT = -8\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Toolbar","Floating Form","Float"]},{"RecordId":"5","Title":"Center Form (With Win95 Taskbar)","Description":"Centers a form.\r\nIf Win95/NT4.0 taskbar exists, also centers based on it's height/position.\r\nNOTE:  See other Center Form example","Code":"Sub CenterForm(frm As Form)\r\n\r\nDim lpRect As RECT\r\nDim hTaskBar As Long\r\nDim lWidth As Long\r\nDim lHeight As Long\r\nDim lResult As Long\r\n\r\nhTaskBar = FindWindow(\"Shell_TrayWnd\", 0&)\r\n\r\nIf hTaskBar > 0 Then\r\n    lResult = GetWindowRect(hTaskBar, lpRect)\r\n    If (lpRect.Right - lpRect.Left) > (lpRect.Bottom - lpRect.Top) Then\r\n        lWidth = (Screen.Width - frm.Width) \\ 2\r\n        lHeight = (Screen.Height - frm.Height) \\ 2\r\n        If lpRect.Top <= 0 Then\r\n            lHeight = lHeight + ((lpRect.Bottom * Screen.TwipsPerPixelY) \\ 2)\r\n        Else\r\n            lHeight = lHeight - ((lpRect.Bottom - lpRect.Top) * Screen.TwipsPerPixelY) \\ 2\r\n        End If\r\n    Else\r\n        lWidth = (Screen.Width - frm.Width) \\ 2\r\n        lHeight = (Screen.Height - frm.Height) \\ 2\r\n        If lpRect.Left = 0 Then\r\n            lWidth = lWidth + ((lpRect.Right * Screen.TwipsPerPixelX) \\ 2)\r\n        Else\r\n            lWidth = lWidth - ((lpRect.Right - lpRect.Left) * Screen.TwipsPerPixelX) \\ 2\r\n        End If\r\n    End If\r\nElse\r\n    lWidth = (Screen.Width - frm.Width) \\ 2\r\n    lHeight = (Screen.Height - frm.Height) \\ 2\r\nEnd If\r\n\r\nfrm.Move lWidth, lHeight\r\n\r\nEnd Sub\r\n","Declares":"Declare Function FindWindow Lib \"user32\" Alias \"FindWindowA\" (ByVal lpClassName As String, ByVal lpWindowName As String) As Long\r\nDeclare Function GetWindowRect Lib \"user32\" (ByVal hwnd As Long, lpRect As RECT) As Long\r\n\r\nType RECT\r\n        Left As Long\r\n        Top As Long\r\n        Right As Long\r\n        Bottom As Long\r\nEnd Type\r\n\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Center Form","Task Bar"]},{"RecordId":"6","Title":"Crystal Reports (Preview child)","Description":"To make a Crystal Report preview window the child of another window:\r\n CrystalReport1.WindowParentHandle = myform.hwnd","Code":"","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Crystal Reports","Child Form"]},{"RecordId":"7","Title":"Add Bitmaps and Text To A Menu","Description":"Adds bitmaps and text to a form's menu","Code":"'-----------------------------------------------------------------------------------\r\n'  The form needs a picture box with the following properties set:\r\n'    AutoRedraw=True\r\n'    Appearance=Flat\r\n'    Autosize=False\r\n'    BorderStyle=None\r\n'\r\n'  You will need an ImageList control that has the icons loaded in it.\r\n'\r\n'-----------------------------------------------------------------------------------\r\n\r\n'-----------------------------------------------------------------------------------\r\n' This is how you call it.  \r\n'-----------------------------------------------------------------------------------\r\nFor i = 0 To 2  ' Assumes 3 menu items\r\n  CreateMenuBitmapWithText ImageList3, i + 1, Form1, 0, i, Picture4, \"Menu option \" & CStr(i)\r\nNext\r\n\r\n\r\n'-----------------------------------------------------------------------------------\r\n' This the bas module\r\n'-----------------------------------------------------------------------------------\r\n\r\nOption Explicit\r\n\r\nPrivate Declare Function GetClientRect Lib \"user32\" (ByVal hWnd As Long, lpRect As RECT) As Long\r\nPrivate Declare Function GetStockObject Lib \"gdi32\" (ByVal nIndex As Long) As Long\r\nPrivate Declare Function GetMenu Lib \"user32\" (ByVal hWnd As Long) As Long\r\nPrivate Declare Function GetSubMenu Lib \"user32\" (ByVal hMenu As Long, ByVal nPos As Long) As Long\r\nPrivate Declare Function ModifyMenuByNum Lib \"user32\" Alias \"ModifyMenuA\" (ByVal hMenu As Long, ByVal nPosition As Long, ByVal wFlags As Long, ByVal wIDNewItem As Long, ByVal lpString As Long) As Long\r\nPrivate Declare Function GetMenuItemID Lib \"user32\" (ByVal hMenu As Long, ByVal nPos As Long) As Long\r\nPrivate Declare Function GetObjectAPI Lib \"gdi32\" Alias \"GetObjectA\" (ByVal hObject As Long, ByVal nCount As Long, lpObject As Any) As Long\r\nPrivate Declare Function CreateBitmapIndirect Lib \"gdi32\" (lpBitmap As BITMAP) As Long\r\nPrivate Declare Function CreateCompatibleDC Lib \"gdi32\" (ByVal hDC As Long) As Long\r\nPrivate Declare Function SelectObject Lib \"gdi32\" (ByVal hDC As Long, ByVal hObject As Long) As Long\r\nPrivate Declare Function BitBlt Lib \"gdi32\" (ByVal hDestDC As Long, ByVal X As Long, ByVal Y As Long, ByVal nWidth As Long, ByVal nHeight As Long, ByVal hSrcDC As Long, ByVal xSrc As Long, ByVal ySrc As Long, ByVal dwRop As Long) As Long\r\nPrivate Declare Function DeleteDC Lib \"gdi32\" (ByVal hDC As Long) As Long\r\nPrivate Declare Function SetTextAlign Lib \"gdi32\" (ByVal hDC As Long, ByVal wFlags As Long) As Long\r\nPrivate Declare Function MoveToEx Lib \"gdi32\" (ByVal hDC As Long, ByVal X As Long, ByVal Y As Long, lpPoint As POINTAPI) As Long\r\nPrivate Declare Function TextOut Lib \"gdi32\" Alias \"TextOutA\" (ByVal hDC As Long, ByVal X As Long, ByVal Y As Long, ByVal lpString As String, ByVal nCount As Long) As Long\r\n\r\nPrivate Const MF_BITMAP = &H4&\r\nPrivate Const MF_BYPOSITION = &H400&\r\nPrivate Const SRCCOPY = &HCC0020\r\nPrivate Const LF_FACESIZE = 32\r\nPrivate Const TA_UPDATECP = 1\r\nPrivate Const TA_BASELINE = 24\r\nPrivate Const SYSTEM_FONT = 13\r\nPrivate Const TA_LEFT = 0\r\nPrivate Const TA_TOP = 0\r\n\r\nPrivate Type RECT\r\n        Left As Long\r\n        Top As Long\r\n        Right As Long\r\n        Bottom As Long\r\nEnd Type\r\n\r\nPrivate Type POINTAPI\r\n        X As Long\r\n        Y As Long\r\nEnd Type\r\n\r\nPrivate Type LOGFONT\r\n        lfHeight As Long\r\n        lfWidth As Long\r\n        lfEscapement As Long\r\n        lfOrientation As Long\r\n        lfWeight As Long\r\n        lfItalic As Byte\r\n        lfUnderline As Byte\r\n        lfStrikeOut As Byte\r\n        lfCharSet As Byte\r\n        lfOutPrecision As Byte\r\n        lfClipPrecision As Byte\r\n        lfQuality As Byte\r\n        lfPitchAndFamily As Byte\r\n        lfFaceName(LF_FACESIZE) As Byte\r\nEnd Type\r\n\r\nPrivate Type BITMAP\r\n        bmType As Long\r\n        bmWidth As Long\r\n        bmHeight As Long\r\n        bmWidthBytes As Long\r\n        bmPlanes As Integer\r\n        bmBitsPixel As Integer\r\n        bmBits As Long\r\nEnd Type\r\n\r\nPrivate Function CopyPictureImage(SourceImage As PictureBox) As Long\r\n\r\n    Dim bm As BITMAP\r\n    Dim newbm As Long\r\n    Dim tdc As Long\r\n    Dim oldbm As Long\r\n    Dim di As Long\r\n\r\n    ' First get the information about the image bitmap\r\n    di = GetObjectAPI(SourceImage.Image, Len(bm), bm)\r\n    bm.bmBits = 0\r\n    \r\n    ' Create a new bitmap with the same structure and size\r\n    ' of the image bitmap\r\n    newbm = CreateBitmapIndirect(bm)\r\n\r\n    ' Create a temporary memory device context to use\r\n    tdc = CreateCompatibleDC(SourceImage.hDC)\r\n    ' Select in the newly created bitmap\r\n    oldbm = SelectObject(tdc, newbm)\r\n\r\n    ' Now copy the bitmap from the persistant bitmap in\r\n    ' picture 2 (note that picture2 has AutoRedraw set TRUE\r\n    di = BitBlt(tdc, 0, 0, bm.bmWidth, bm.bmHeight, SourceImage.hDC, 0, 0, SRCCOPY)\r\n    \r\n    ' Select out the bitmap and delete the memory DC\r\n    oldbm = SelectObject(tdc, oldbm)\r\n    di = DeleteDC(tdc)\r\n\r\n    ' And return the new bitmap\r\n    CopyPictureImage = newbm\r\n    \r\nEnd Function\r\n\r\nPrivate Sub DrawMenuText(PicText As PictureBox, ByVal strText As String, ByVal intOffset As Integer)\r\n    \r\n    Dim lf As LOGFONT\r\n    Dim oldfont As Long\r\n    Dim newfont As Long\r\n    Dim alignorig As Long\r\n    Dim vpos As Long\r\n    Dim rc As RECT\r\n    Dim di As Long\r\n    Dim prevpoint As POINTAPI\r\n\r\n    ' Get the dimensions of the control\r\n    di = GetClientRect(PicText.hWnd, rc)\r\n\r\n    ' We get the current logical font by selecting in temporarily a stock font\r\n    oldfont = SelectObject(PicText.hDC, GetStockObject(SYSTEM_FONT))\r\n    di = GetObjectAPI(oldfont, Len(lf), lf)\r\n    \r\n    ' Restore the original font\r\n    di = SelectObject(PicText.hDC, oldfont)\r\n\r\n    ' Reset current position and alignment\r\n    ' Be sure to keep the original alignment\r\n    ' Since we're changing font sizes, align to the top left\r\n    ' To make life easier, we use the current position\r\n    alignorig = SetTextAlign(PicText.hDC, TA_LEFT Or TA_TOP Or TA_UPDATECP)\r\n    \r\n    ' Draw the text to the right of the bitmap\r\n    di = MoveToEx(PicText.hDC, intOffset, 0, prevpoint)\r\n\r\n    ' Draw the text\r\n    di = TextOut(PicText.hDC, 0, 0, strText, Len(strText))\r\n    di = SetTextAlign(PicText.hDC, alignorig)\r\n\r\nEnd Sub\r\n\r\nPublic Sub CreateMenuBitmapWithText( _\r\n    ByVal imgList As ImageList, _\r\n    ByVal imtImageIndex As Integer, _\r\n    ByVal frm As Form, _\r\n    ByVal mnuIndex As Integer, _\r\n    ByVal mnuSubMenuIndex As Integer, _\r\n    ByVal picBox As PictureBox, _\r\n    ByVal strText As String)\r\n    \r\n    Dim hMenu As Long\r\n    Dim hSubMenu As Long\r\n    Dim lRetVal As Long\r\n    Dim menuid As Long\r\n    Dim hPic As Long\r\n    Dim newNb As Long\r\n    \r\n    ' Get a handle to form's main menu\r\n    hMenu = GetMenu(frm.hWnd)\r\n    \r\n    ' Get a handle to the sub menu that we desire\r\n    hSubMenu = GetSubMenu(hMenu, mnuIndex)\r\n    \r\n    ' Get a handle to the menu item on the submenu\r\n    menuid = GetMenuItemID(hSubMenu, mnuSubMenuIndex)\r\n    \r\n    ' Set picture box height\r\n    picBox.Height = imgList.ImageHeight * Screen.TwipsPerPixelY\r\n    picBox.Width = (imgList.ImageWidth * Screen.TwipsPerPixelX) + picBox.TextWidth(strText) + (10 * Screen.TwipsPerPixelX)\r\n            \r\n    ' Copy the image from the image list to the picture box\r\n    picBox.Picture = imgList.ListImages(imtImageIndex).Picture\r\n    \r\n    ' Draw the text in the picture box (5 pixels to the right of the end of the image)\r\n    DrawMenuText picBox, strText, imgList.ImageWidth + 5\r\n    \r\n    ' Copy the bitmap from the picture box to the menu\r\n    newNb = CopyPictureImage(picBox)\r\n    lRetVal = ModifyMenuByNum(hSubMenu, mnuSubMenuIndex, MF_BITMAP Or MF_BYPOSITION, menuid, newNb)\r\n    \r\nEnd Sub\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Menu","Bitmap"]},{"RecordId":"8","Title":"Get Free System Resources","Description":"Returns the system resources in the form of percentages converted into strings.","Code":"FreeSystemResources = CStr(GetFreeSystemResources(&H0)) & \"%\"\r\n FreeGDIResources = CStr(GetFreeSystemResources(&H1)) & \"%\"\r\n FreeUserResources = CStr(GetFreeSystemResources(&H2)) & \"%\"\r\n","Declares":"Declare Function GetFreeSystemResources Lib \"User\" (Byval fuSysResource as Integer) as Integer\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["System Info","System Resource Usage"]},{"RecordId":"9","Title":"EBCDIC Numeric Conversion","Description":"Convert right byte of EBCDIC number to ASCII number with sign determination also","Code":"A = +1\tJ = -1\r\nB = +2\tK = -2\r\nC = +3\tL = -3\r\nD = +4\tM = -4\r\nE = +5\tN = -5\r\nF = +6\tO = -6\r\nG = +7\tP = -7\r\nH = +8\tQ = -8\r\nI = +9\tR = -9\r\n{ = +0\t} = -0\r\n\r\nExamples\r\n12A = +121\r\n12{ = +120\r\n12J = -121\r\n12} = -120\r\n","Declares":"","CodeCategory":{"CategoryId":"7","CategoryDescription":"Misc"},"Keywords":["EBCDIC","ASCII"]},{"RecordId":"10","Title":"Writing to the NT Event Log (Preferred)","Description":"Demonstrates how to write to the NT Application Event Log","Code":"'---------------------------------------------------------------------------\r\n' This is how you call the function\r\n'---------------------------------------------------------------------------\r\n    ' Log types:   1 - Error\r\n    '                    2 - Warning\r\n    '                    4 - Information\r\n    '                    8 - Success\r\n    '                  10 - Failure\r\n\r\n    ' Event ID:   Some long integer (3001, etc.)\r\n\r\n    ' Application Text: The name of your application\r\n\r\n    ' Description:  The message text for the event being logged\r\n    \r\n    WriteEvent CLng(txtLogType.Text), CLng(txtEventID.Text), txtApplication.Text, \r\n        txtDescription.Text\r\n\r\n'---------------------------------------------------------------------------\r\n' This is the actual logging code (A complete BAS module)\r\n'---------------------------------------------------------------------------\r\n\r\nOption Explicit\r\n\r\nPublic Const EVENTLOG_SUCCESS = 0\r\nPublic Const EVENTLOG_ERROR_TYPE = 1\r\nPublic Const EVENTLOG_WARNING_TYPE = 2\r\nPublic Const EVENTLOG_INFORMATION_TYPE = 4\r\nPublic Const EVENTLOG_AUDIT_SUCCESS = 8\r\nPublic Const EVENTLOG_AUDIT_FAILURE = 10\r\n\r\nPublic Const GMEM_ZEROINIT = &H40\r\n\r\nDeclare Sub CopyMemory Lib \"kernel32\" Alias \"RtlMoveMemory\" (hpvDest As Any, hpvSource As Any, ByVal cbCopy As Long)\r\nDeclare Function GlobalAlloc Lib \"kernel32\" (ByVal wFlags As Long, ByVal dwBytes As Long) As Long\r\nDeclare Function GlobalFree Lib \"kernel32\" (ByVal hMem As Long) As Long\r\n\r\nDeclare Function GetLastError Lib \"kernel32\" () As Long\r\n\r\nDeclare Function RegisterEventSource Lib \"advapi32.dll\" Alias \"RegisterEventSourceA\" (ByVal lpUNCServerName As String, ByVal lpSourceName As String) As Long\r\nDeclare Function DeregisterEventSource Lib \"advapi32.dll\" (ByVal hEventLog As Long) As Long\r\nDeclare Function ReportEvent Lib \"advapi32.dll\" Alias \"ReportEventA\" (ByVal hEventLog As Long, ByVal wType As Integer, ByVal wCategory As Integer, ByVal dwEventID As Long, ByVal lpUserSid As Any, ByVal wNumStrings As Integer, ByVal dwDataSize As Long, plpStrings As Long, lpRawData As Any) As Boolean\r\n\r\nPublic Sub WriteEvent(ByVal intLogType As Integer, ByVal lngEventID As Long, ByVal strApplication As String, ByVal strDescription As String)\r\n  \r\n    Dim hEventLog As Long\r\n    Dim hMsgs As Long\r\n    Dim lngBufferSize As Long\r\n    Dim blnOKToWrite As Boolean\r\n  \r\n    If (intLogType <> EVENTLOG_ERROR_TYPE) And _\r\n        (intLogType <> EVENTLOG_WARNING_TYPE) And _\r\n        (intLogType <> EVENTLOG_INFORMATION_TYPE) And _\r\n        (intLogType <> EVENTLOG_AUDIT_SUCCESS) And _\r\n        (intLogType <> EVENTLOG_AUDIT_FAILURE) Then\r\n            blnOKToWrite = False\r\n    ElseIf lngEventID <= 0 Then\r\n        blnOKToWrite = False\r\n    ElseIf strApplication = \"\" Then\r\n        blnOKToWrite = False\r\n    ElseIf strDescription = \"\" Then\r\n        blnOKToWrite = False\r\n    Else\r\n        blnOKToWrite = True\r\n    End If\r\n\r\n    If Not blnOKToWrite Then\r\n        Err.Raise vbObjectError + 1, \"Event Log Component\", \"All properties should have a valid value before writing to the event log\"\r\n    End If\r\n  \r\n    lngBufferSize = Len(strDescription) + 1\r\n    hMsgs = GlobalAlloc(GMEM_ZEROINIT, lngBufferSize)\r\n    CopyMemory ByVal hMsgs, ByVal strDescription, lngBufferSize\r\n    \r\n    hEventLog = RegisterEventSource(vbNullString, strApplication)\r\n    If ReportEvent(hEventLog, intLogType, 0, lngEventID, 0&, 1, 0, hMsgs, 0&) = 0 Then\r\n       Err.Raise vbObjectError + GetLastError(), \"Event Log Component\", \"ReportEvent() failed\"\r\n    End If\r\n    \r\n    DeregisterEventSource hEventLog\r\n    \r\n    GlobalFree hMsgs\r\n\r\nEnd Sub\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Event Log","NT Event Log"]},{"RecordId":"12","Title":"Provide Insert Object Dialog for Rich Text Box","Description":"Provide Insert Object Dialog for Rich Text Box","Code":"The Rich Text Box allows Rich Text documents to include linked or embedded OLE objects.\r\nThe Rich Text Box, however, provides no way for users to insert such objects.  They must\r\nbe added by means of the Add method of the OLEObjects collection.\r\n\r\nUse the Insert Object dialog provided by VB's OLE Container control to allow the user to\r\ninsert an OLE object into a Rich Text Box.  Add an OLE Container control (oleObj) to your\r\nform and set its Visible property to False.  Then add this code behind a button.\r\n\r\nPrivate Sub cmdInsertObject_Click()\r\n\r\n  Dim sClass As String\r\n\r\n  oleObj.InsertObjDlg\r\n  sClass = oleObj.Class\r\n\r\n  If Len(sClass) Then\r\n    rtfText.OLEObjects.Add , , , sClass\r\n    oleObj.Class = \"\"\r\n  End If\r\n\r\nEnd Sub","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Rich Text Box","Insert Object","OLE Automation"]},{"RecordId":"14","Title":"Read Files Of Unknown Record Length","Description":"Read files of unknown record length","Code":"Function ReadUnknownFile (FileName As String) As String\r\n    Dim FBuffer As Integer\r\n    Dim CyclesRead As Integer\r\n    Dim FullLenString As String * 1000\r\n    Dim PartialString As String\r\n    Dim Indicator As Long\r\n    Dim Temp As String\r\n\r\n    CyclesRead = 0\r\n    FBuffer = FreeFile\r\n    Open FileName For Random As #FBuffer Len = 1000\r\n    Do\r\n        CyclesRead = CyclesRead + 1\r\n        Get #FBuffer, CyclesRead, FullLenString\r\n        Indicator = LOF(FBuffer) - (CyclesRead * 1000)\r\n        If Indicator = 0 Then Exit Do 'You just read the last byte of the file\r\n        If Indicator < 0 Then\r\n            'You just read past the end of file\r\n            'Obtain the portion you want and discard the rest\r\n            PartialString = Left(FullLenString, (CyclesRead * 1000) + Indicator)\r\n            Exit Do\r\n        End If\r\n        Temp = Temp + FullLenString\r\n    Loop\r\n    ' Handle the Last Chunk Read\r\n    If Indicator = 0 Then\r\n        ' You've got everything in FULLLENSTRING (1K of data)\r\n        Temp = Temp + FullLenString\r\n    Else\r\n        ' Last read was a partial - Use PARTIALSTRING instead\r\n        Temp = Temp + PartialString\r\n    End If\r\n    ReadUnknownFile = Temp\r\nEnd Function\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["File I/O","Read File"]},{"RecordId":"15","Title":"Clear/Set File Attributes in a Directory Tree","Description":"Clears (and sets) file attributes in a complete directory tree.","Code":"'----------------------------------------------------------------------------------\r\n' Call with:    ClearAttributes \"c:\\download\", True, vbReadOnly\r\n'----------------------------------------------------------------------------------\r\n\r\nPrivate Sub ClearAttributes(ByVal strFolder As String, ByVal blnIncludeSubfolders As Boolean, ByVal oldAttribute As VbFileAttribute)\r\n\r\n    Dim fso As Scripting.FileSystemObject\r\n    Dim fld As Scripting.Folder\r\n    Dim subfld As Scripting.Folder\r\n    Dim file As Scripting.file\r\n    Dim lngCount As Long\r\n    \r\n    Set fso = New Scripting.FileSystemObject\r\n    Set fld = fso.GetFolder(strFolder)\r\n    For Each file In fld.Files\r\n        If file.Attributes And oldAttribute Then\r\n            file.Attributes = file.Attributes And Not oldAttribute\r\n        End If\r\n    Next\r\n    \r\n    If blnIncludeSubfolders Then\r\n        For Each subfld In fld.SubFolders\r\n            ClearAttributes subfld.Path, True, oldAttribute\r\n        Next\r\n    End If\r\n\r\nEnd Sub\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["File Attributes","Clear Attributes","Set Attributes"]},{"RecordId":"16","Title":"Week Days Between Dates","Description":"Determines number of week days (work days) between two dates, inclusive.","Code":"'Call with \"smsWorkingDays(\"1/1/96\", \"3/1/96\")\r\n\r\n'-------------------------------------------------------------------\r\n\r\nFunction smsWorkingDays(vStartDate As Variant, vEndDate As Variant) As Integer\r\n\r\nOn Error GoTo smsWorkingDays_Err\r\n\r\nDim lStartDate As Long\r\nDim lEndDate As Long\r\n\r\nlStartDate = CLng(CVDate(vStartDate))\r\nlEndDate = CLng(CVDate(vEndDate))\r\n\r\nIf lStartDate <= lEndDate Then\r\n    smsWorkingDays = DateDiff(\"w\", lStartDate, lEndDate) * 5 + smsWorkDays(WeekDay(lStartDate), WeekDay(lEndDate))\r\nElse\r\n    lStartDate = CLng(CVDate(vEndDate))\r\n    lEndDate = CLng(CVDate(vStartDate))\r\n    smsWorkingDays = DateDiff(\"w\", lStartDate, lEndDate) * 5 + smsWorkDays(WeekDay(lStartDate), WeekDay(lEndDate))\r\nEnd If\r\n\r\nsmsWorkingDays_Done:\r\nExit Function\r\n\r\nsmsWorkingDays_Err:\r\nResume smsWorkingDays_Done\r\n\r\nEnd Function\r\n\r\n'-------------------------------------------------------------------\r\n\r\nFunction smsWorkDays(iFirstWkDay As Integer, iSecondWkDay As Integer) As Integer\r\n\r\nOn Error GoTo smsWorkDays_Err\r\n\r\nDim intForIdx As Integer\r\nDim intCycle2 As Integer\r\nDim intCnt As Integer\r\n\r\nsmsWorkDays = 0\r\nintCnt = 0\r\n\r\nIf iFirstWkDay <> iSecondWkDay Then\r\n    If iFirstWkDay < iSecondWkDay Then\r\n        intCycle2 = iSecondWkDay\r\n    Else\r\n        intCycle2 = iSecondWkDay + 7\r\n    End If\r\n    \r\n    For intForIdx = iFirstWkDay To intCycle2\r\n        Select Case intForIdx Mod 7\r\n            Case 1, 7:\r\n            Case 2, 3, 4, 5, 6:\r\n                intCnt = intCnt + 1\r\n            Case Else\r\n        End Select\r\n    Next\r\nElse\r\n    Select Case iFirstWkDay Mod 7\r\n        Case 1, 7:\r\n            intCnt = 0\r\n        Case 2, 3, 4, 5, 6:\r\n            intCnt = 1\r\n        Case Else\r\n    End Select\r\nEnd If\r\n    \r\nsmsWorkDays = intCnt\r\n\r\n\r\nsmsWorkDays_Done:\r\nExit Function\r\n\r\nsmsWorkDays_Err:\r\nResume smsWorkDays_Done\r\n\r\nEnd Function","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Date computations"]},{"RecordId":"17","Title":"HotTracking on a List Box","Description":"Implements mouse Hot Tracking in a list box","Code":"Private Sub List1_MouseMove(Button As Integer, Shift As Integer, X As Single, Y As Single)\r\n\r\nDim ItemIndex As Long\r\nDim AtThisPoint As POINTAPI\r\n\r\nAtThisPoint.X = X \\ Screen.TwipsPerPixelX\r\nAtThisPoint.Y = Y \\ Screen.TwipsPerPixelY\r\nCall ClientToScreen(List1.hwnd, AtThisPoint)\r\n\r\nItemIndex = LBItemFromPt(List1.hwnd, AtThisPoint.X, AtThisPoint.Y, False)\r\nIf ItemIndex <> SendMessage(List1.hwnd, LB_GETCURSEL, 0, 0) Then\r\n    Call SendMessage(List1.hwnd, LB_SETCURSEL, ItemIndex, 0)\r\nEnd If\r\n\r\nEnd Sub\r\n","Declares":"Private Declare Function SendMessage Lib \"user32\" Alias \"SendMessageA\" (ByVal hwnd As Long, ByVal wMsg As Long, ByVal wParam As Long, lParam As Any) As Long\r\n\r\nPrivate Declare Function ClientToScreen Lib \"user32\" (ByVal hwnd As Long, lpPoint As POINTAPI) As Long\r\n\r\nPrivate Declare Function LBItemFromPt Lib \"comctl32.dll\" (ByVal hLB As Long, ByVal ptX As Long, ByVal ptY As Long, ByVal bAutoScroll As Long) As Long\r\n\r\nPrivate Const LB_SETCURSEL = &H186\r\nPrivate Const LB_GETCURSEL = &H188\r\n\r\nPrivate Type POINTAPI\r\n    X As Long\r\n    Y As Long\r\nEnd Type\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Hot Tracking","List Box"]},{"RecordId":"18","Title":"List Box Search (32 bit)","Description":"Automatically select list box items when user enters text in text box.","Code":"#If Win16 Then\r\n    lngResult = SendMessage(List1.hWnd, LB_SELECTSTRING, ByVal -1, ByVal Text1.txt)\r\n#Else\r\n    lngResult = SendMessage(List1.hWnd, CLng(LB_SELECTSTRING), ByVal -1, ByVal Text1.txt)\r\n#End If\r\n","Declares":"#If Win16 Then\r\n    Declare Function SendMessage Lib \"User\" (ByVal hWnd As Integer, ByVal wMsg As Integer, ByVal wParam As Integer, ByVal lParam As Any) As Long\r\n    Const WM_USER = &H400\r\n    Const LB_SELECTSTRING = (WM_USER + 13)\r\n#Else\r\n    Declare Function SendMessage Lib \"user32\" Alias \"SendMessageA\" (ByVal hWnd As Long, ByVal wMsg As Long, ByVal wParam As Long, ByVal lParam As Any) As Long\r\n    Const LB_SELECTSTRING = &H18C\r\n#End If\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["ListBox Search","Search"]},{"RecordId":"19","Title":"Animated Icons","Description":"Produces animated bitmaps similar to Netscape's rotating globe.","Code":"Sub Timer1_Timer()\r\n\r\n' This routine assumes that a bitmap 100 pixels wide and 3300 pixels high\r\n' exists in Picture2.  The routine copies an area 100 by 100 pixels from\r\n' Picture2 to Picture1 to produce animation.\r\n\r\n    Static CellNum As Integer\r\n    Dim rc As Integer\r\n    CellNum = (CellNum + 1) Mod 33\r\n    rc = BitBlt(Picture1.hDC, 0, 0, 100, 100, Picture2.hDC, 0, (CellNum * 100), SRCCOPY)\r\n    \r\nEnd Sub\r\n","Declares":"Declare Function BitBlt Lib \"GDI\" (ByVal hDestDC As Integer, ByVal x As Integer, _\r\n    ByVal x As Integer, ByVal nWidth As Integer, ByVal nHeight As Integer, _\r\n    ByVal hSrcDC As Integer, ByVal xSrc As Integer, ByVal ySrc As Integer, _\r\n    ByVal dwRop As Long) As Integer\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Animated bitmaps","Bitmaps"]},{"RecordId":"20","Title":"Listbox Vertical Scroll - Detecting it","Description":"Determines when a list box has been vertically scrolled.\r\nONLY detects scrolling using the up/down buttons, elevator, or scroll areas.\r\nDoes not detect up/down arrow key inside of list area.  This can be trapped using the list box's click event.","Code":"' ---  Place the following in the form load event\r\n\r\n  Msghook1.HwndHook = List1.hWnd\r\n  Msghook1.Message(WM_VSCROLL) = True\r\n\r\n\r\n' ---  Place the following in the MsgHook message event\r\n\r\nDim lngRetVal As Long\r\n\r\nIf msg = WM_VSCROLL Then\r\n    Debug.Print List1.TopIndex\r\nEnd If\r\n\r\nlngRetVal = Msghook1.InvokeWindowProc(msg, wp, lp)\r\n\r\n\r\n' ---  To achieve complete functionality, whatever code is placed in the MsgHook message event must also be placed in the list box click event\r\n\r\nDebug.Print List1.TopIndex\r\n","Declares":"Const WM_VSCROLL = &H115\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["List box","Vertical scroll"]},{"RecordId":"21","Title":"How to Enable ODBC Connection Pooling","Description":"Steps required to enable ODBC connection pooling in ADO.","Code":"To enable ODBC connection pooling from a Visual Basic/ADO application, there are two necessary steps: \r\n\r\nStep 1\r\nOpen the ODBC Data Source Administrator from the control panel. Select the Connection Pooling tab. Find the driver that you are using in the list and double-click on it. Choose the option Pool connections to this driver and enter a timeout value.\r\n\r\nNOTE: This only applies to the ODBC Administrator version 3.5 or later. If you are using an earlier version of the Administrator, then you need to find the CPTimeout value for your driver in the registry under the following registry key and set the value.: \r\n\r\nHKEY_LOCAL_MACHINE/SOFTWARE/ODBC/ODBCINST.INI/Driver_Name/CPTimeout =   someseconds\r\n \r\nFor more information on setting this value in the registry, please see the following document: \r\nhttp://msdn.microsoft.com/library/techart/pooling2.htm\r\n\r\nStep 2\r\nAdd an ODBC API function call to SQLSetEnvAttr in your application with the appropriate options to enable ODBC connection pooling for the process. This function should only be called once per process and must be called PRIOR TO OPENING ANY CONNECTIONS or executing any ADO code. \r\n\r\nOption Explicit\r\nDim rc As Long\r\n\r\nConst dbconnstring = \"DSN=Your DSN;uid=sa;pwd=;OLE DB Services=-2\"\r\n\r\nConst SQL_ATTR_CONNECTION_POOLING = 201\r\nConst SQL_CP_ONE_PER_DRIVER = 1\r\nConst SQL_IS_INTEGER = -6\r\nConst SQL_CP_OFF = 0\r\n\r\nPrivate Declare Function SQLSetEnvAttr Lib \"odbc32.dll\" ( _\r\n                    ByVal EnvironmentHandle As Long, _\r\n                    ByVal EnvAttribute As Long, _\r\n                    ByVal ValuePtr As Long, _\r\n                    ByVal StringLength As Long) As Integer\r\n                    \r\nPrivate Sub Form_Load()\r\n    \r\n    'Enable connection pooling ..  this must be done before any ADO calls\r\n    'are made.  Only needs to occur one time per process\r\n    rc = SQLSetEnvAttr(0&, _\r\n                 SQL_ATTR_CONNECTION_POOLING, _\r\n                 SQL_CP_ONE_PER_DRIVER, _\r\n                 SQL_IS_INTEGER)\r\n    If rc <> 0 Then\r\n        Debug.Print \"SQLSetEnvAttr Error \" & rc\r\n    End If\r\n\r\nEnd Sub\r\n\r\nPrivate Sub Form_Unload(Cancel As Integer)\r\n        \r\n    Call SQLSetEnvAttr(0&, _\r\n                SQL_ATTR_CONNECTION_POOLING, _\r\n                SQL_CP_OFF, _\r\n                SQL_IS_INTEGER)\r\n\r\nEnd Sub \r\n\r\n\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"3","CategoryDescription":"Database"},"Keywords":["ADO","ODBC","Connection Pooling"]},{"RecordId":"22","Title":"ProgMan - Activate ProgMan for DDE","Description":"Call this sub before starting DDE with Program Manager.  Restores Program Manager to forefront.","Code":"Sub RestoreProgMan ()\r\n\r\n    On Error GoTo RestoreProgManErr\r\n\r\n    AppActivate \"Program Manager\"   ' Activate Program Manager.\r\n    SendKeys \"%{ }{Enter}\", True      ' Send Restore keystrokes.\r\n\r\nRestoreProgManErr:\r\n\r\n    Exit Sub\r\n\r\nEnd Sub","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Activate Program Manager","Program Manager","ProgMan"]},{"RecordId":"24","Title":"Icons - Get number & draw","Description":"Determines number of icons in an EXE, DLL,  or ICO for a file that has an association in File Manager.","Code":"Call Get_Icons(\"c:\\winword\\docs\\audio_ad.doc\")\r\n\r\nSub Get_Icons (FileName As String)\r\n\r\nDim ExeFile As String\r\nDim hInst As Integer\r\nDim i As Integer\r\nDim NbrOfIcons As Integer\r\nDim hIcon As Integer\r\n\r\nExeFile = Space(1024)\r\nhInst = FindExecutable(FileName, \"c:\\\", ExeFile)\r\nIf hInst > 31 Then\r\n    ExeFile = Left(ExeFile, InStr(ExeFile, Chr(0)) - 1)\r\n    NbrOfIcons = ExtractIcon(GetWindowWord(hWnd, GWW_HINSTANCE), ExeFile, -1)\r\n    Picture1.Cls\r\n    For i = 0 To NbrOfIcons - 1\r\n        hIcon = ExtractIcon(GetWindowWord(hWnd, GWW_HINSTANCE), ExeFile, i)\r\n        DrawIcon Picture1.hDC, 0, 0, hIcon\r\n        DestroyIcon hIcon\r\n    Next i\r\nEnd If\r\n\r\nEnd Sub\r\n","Declares":"Declare Function FindExecutable% Lib \"shell.dll\" (ByVal lpszFile$, ByVal lpszDir$, ByVal lpszResult$)\r\n\r\nDeclare Function ExtractIcon% Lib \"shell.dll\" (ByVal hisnt%, ByVal lpszExeName$, ByVal iIcon%)\r\n\r\nDeclare Function GetWindowWord% Lib \"User\" (ByVal hWnd%, ByVal nIndex%)\r\n\r\nDeclare Sub DrawIcon Lib \"User\" (ByVal hDC%, ByVal X%, ByVal Y%, ByVal hIcon%)\r\n\r\nDeclare Sub DestroyIcon Lib \"User\" (ByVal hIcon%)\r\n\r\nConst GWW_HINSTANCE = (-6)\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Extract Icons","Icons"]},{"RecordId":"25","Title":"Play AVI, MPEG, Quicktime files","Description":"Play any multimedia movie file","Code":"Any PC with Internet Explorer v3.02 or higher has AMOVIE.OCX.  \r\nSimply set its FileName property to the file and it will display the file.\r\nIt supports the stop, pause, and slider status display automatically.","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["AVI","Multimedia","MPEG"]},{"RecordId":"26","Title":"Dial phone number VB4","Description":"Uses TAPI32.dll to dial a phone number","Code":"'Call with:  DialNumber \"555-1212\", \"My application\", \"Bob Smith\"\r\n\r\nSub DialNumber(sNumber As String, sAppName As String, sName As String)\r\n\r\nDim nResult As Long\r\nDim buff As String\r\n\r\nnResult = tapiRequestMakeCall&(sNumber, sAppName, sName, \"\")\r\nIf nResult <> 0 Then\r\n    buff = \"Error dialing number: \"\r\n    Select Case nResult\r\n        Case TAPIERR_NOREQUESTRECIPIENT\r\n            buff = buff & \"Could not find call control application.\"\r\n        Case TAPIERR_REQUESTQUEUEFULL\r\n            buff = buff & \"Call control application is busy.\"\r\n        Case Else\r\n            buff = buff & \"Error \" & CStr(nResult) & \".\"\r\n        End Select\r\n        MsgBox buff\r\n    End If\r\nEnd Sub\r\n","Declares":"Declare Function tapiRequestMakeCall& Lib \"TAPI32.DLL\" (ByVal DestAddress$, ByVal AppName$, ByVal CalledParty$, ByVal Comment$)\r\n\r\nConst TAPIERR_NOREQUESTRECIPIENT = -2&\r\nConst TAPIERR_REQUESTQUEUEFULL = -3&\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Dial Telephone","TAPI"]},{"RecordId":"27","Title":"Encrypt/Decrypt Password","Description":"Two functions to encrypt and decrypt a string.","Code":"'Call with this (use 1 through 10 as the incoming number)\r\n\r\nstrTemp = \"My name is Ted Gamble\"\r\nstrTemp = EncryptPassword(5, strTemp)\r\nstrTemp = DecryptPassword(5, strTemp)\r\n\r\n'--------------------------------------------------------------------\r\n\r\nPublic Function EncryptPassword(Number As Byte, DecryptedPassword As String) As String\r\n\r\nDim Password As String\r\nDim Counter As Byte\r\nDim Temp As Integer\r\n\r\nCounter = 1\r\nDo Until Counter = Len(DecryptedPassword) + 1\r\n    Temp = Asc(Mid(DecryptedPassword, Counter, 1))\r\n    If Counter Mod 2 = 0 Then\r\n        Temp = Temp - Number\r\n    Else\r\n        Temp = Temp + Number\r\n    End If\r\n    \r\n    Temp = Temp Xor (10 - Number)\r\n    Password = Password & Chr$(Temp)\r\n    Counter = Counter + 1\r\nLoop\r\n\r\nEncryptPassword = Password\r\n\r\nEnd Function\r\n\r\n'--------------------------------------------------------------------\r\n\r\nPublic Function DecryptPassword(Number As Byte, EncryptedPassword As String) As String\r\n\r\nDim Password As String\r\nDim Counter As Byte\r\nDim Temp As Integer\r\n\r\nCounter = 1\r\nDo Until Counter = Len(EncryptedPassword) + 1\r\n    Temp = Asc(Mid(EncryptedPassword, Counter, 1)) Xor (10 - Number)\r\n    If Counter Mod 2 = 0 Then\r\n        Temp = Temp + Number\r\n    Else\r\n        Temp = Temp - Number\r\n    End If\r\n    \r\n    Password = Password & Chr$(Temp)\r\n    Counter = Counter + 1\r\nLoop\r\n\r\nDecryptPassword = Password\r\n\r\nEnd Function\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Encryption","Decryption"]},{"RecordId":"28","Title":"Center Non-child On MDI Form","Description":"Centers a form over an MDI form, but the form being centered is not an MDI child.","Code":"Public Sub CenterFormInMDI(fMDI As Form, fChild As Form, Optional stsStatus As Variant)\r\n\r\nDim lngBorderWidth As Long\r\nDim lngCaptionHeight As Long\r\n\r\nIf IsMissing(stsStatus) Then\r\n    lngBorderWidth = (fMDI.Width - fMDI.ScaleWidth) / 2\r\n    lngCaptionHeight = fMDI.Height - fMDI.ScaleHeight - lngBorderWidth\r\n    fChild.Left = fMDI.Left + lngBorderWidth + ((fMDI.ScaleWidth - fChild.Width) / 2)\r\n    fChild.Top = fMDI.Top + lngCaptionHeight + lngBorderWidth + ((fMDI.ScaleHeight - fChild.Height) / 2)\r\nElse\r\n    lngBorderWidth = (fMDI.Width - fMDI.ScaleWidth) / 2\r\n    lngCaptionHeight = fMDI.Height - (fMDI.ScaleHeight + stsStatus.Height) - lngBorderWidth\r\n    fChild.Left = fMDI.Left + lngBorderWidth + ((fMDI.ScaleWidth - fChild.Width) / 2)\r\n    fChild.Top = fMDI.Top + lngCaptionHeight + ((fMDI.ScaleHeight - fChild.Height) / 2)\r\nEnd If\r\n\r\nEnd Sub\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Center Form","MDI"]},{"RecordId":"29","Title":"Menu Text (how to modify)","Description":"Change menu text before windows calculates the menu width.","Code":"'Place the following code in the Form_Load event\r\nMsgHook.hWnd = Me.hWnd\r\nMsgHook.Message(WM_INITMENUPOPUP) = True\r\n\r\n\r\nSub MsgHook_Message(msg As Integer, wParam As Integer, lParam As Long, result As Long)\r\n\r\n' This subroutine will intercept a pull down menu\r\n' and modify the menu caption text before windows\r\n' calculates the width of the text entries of the\r\n' menu.  This will allow windows to correctly\r\n' calculate the desired width of the menu before\r\n' it is displayed.  MsgHook is a MsgBlaster\r\n' type of control.\r\n\r\n\r\n\r\n'Update menu text if index = 0 (File menu).\r\n'Set the menu text to the contents of Text1\r\n\r\nIf msg = WM_INITMENUPOPUP Then\r\n    If (lParam And &HFFFF&) = 0 Then\r\n        mnuFileText.Caption = Text1\r\n        result = 0\r\n    End If\r\nEnd If\r\n\r\nEnd Sub\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Menu"]},{"RecordId":"30","Title":"Specified Path Is Valid","Description":"Determines is a passed PATH is valid.","Code":"'------------------------------------------------------\r\n' Function:   IsPathValid as integer\r\n' arguments:  DestPath$         a string that is a full path\r\n'             DefaultDrive$     the default drive.  eg.  \"C:\"\r\n'\r\n'  If DestPath$ does not include a drive specification,\r\n'  IsValidPath uses Default Drive\r\n'\r\n'  When IsValidPath is finished, DestPath$ is reformated\r\n'  to the format \"X:\\dir\\dir\\dir\\\"\r\n'\r\n' Result:  True (-1) if path is valid.\r\n'          False (0) if path is invalid\r\n'-------------------------------------------------------\r\nFunction IsPathValid (DestPath$, ByVal DefaultDrive$) As Integer\r\n' Version 1.0\r\n    '----------------------------\r\n    ' Remove left and right spaces\r\n    '----------------------------\r\n    DestPath$ = RTrim$(LTrim$(DestPath$))\r\n    \r\n\r\n    '-----------------------------\r\n    ' Check Default Drive Parameter\r\n    '-----------------------------\r\n    If Right$(DefaultDrive$, 1) <> \":\" Or Len(DefaultDrive$) <> 2 Then\r\n        MsgBox \"Bad default drive parameter specified in IsValidPath Function.  You passed,  \"\"\" + DefaultDrive$ + \"\"\".  Must be one drive letter and \"\":\"\".  For example, \"\"C:\"\", \"\"D:\"\"...\", 64, \"Setup Kit Error\"\r\n        GoTo parseErr\r\n    End If\r\n    \r\n\r\n    '-------------------------------------------------------\r\n    ' Insert default drive if path begins with root backslash\r\n    '-------------------------------------------------------\r\n    If Left$(DestPath$, 1) = \"\\\" Then\r\n        DestPath$ = DefaultDrive + DestPath$\r\n    End If\r\n    \r\n    '-----------------------------\r\n    ' check for invalid characters\r\n    '-----------------------------\r\n    On Error Resume Next\r\n    tmp$ = Dir$(DestPath$)\r\n    If Err <> 0 Then\r\n        GoTo parseErr\r\n    End If\r\n    \r\n\r\n    '-----------------------------------------\r\n    ' Check for wildcard characters and spaces\r\n    '-----------------------------------------\r\n    If (InStr(DestPath$, \"*\") <> 0) GoTo parseErr\r\n    If (InStr(DestPath$, \"?\") <> 0) GoTo parseErr\r\n    If (InStr(DestPath$, \" \") <> 0) GoTo parseErr\r\n         \r\n    \r\n    '------------------------------------------\r\n    ' Make Sure colon is in second char position\r\n    '------------------------------------------\r\n    If Mid$(DestPath$, 2, 1) <> Chr$(58) Then GoTo parseErr\r\n    \r\n\r\n    '-------------------------------\r\n    ' Insert root backslash if needed\r\n    '-------------------------------\r\n    If Len(DestPath$) > 2 Then\r\n      If Right$(Left$(DestPath$, 3), 1) <> \"\\\" Then\r\n        DestPath$ = Left$(DestPath$, 2) + \"\\\" + Right$(DestPath$, Len(DestPath$) - 2)\r\n      End If\r\n    End If\r\n\r\n    '-------------------------\r\n    ' Check drive to install on\r\n    '-------------------------\r\n    drive$ = Left$(DestPath$, 1)\r\n    ChDrive (drive$)                                                        ' Try to change to the dest drive\r\n    If Err <> 0 Then GoTo parseErr\r\n    \r\n    '-----------\r\n    ' Add final \\\r\n    '-----------\r\n    If Right$(DestPath$, 1) <> \"\\\" Then\r\n        DestPath$ = DestPath$ + \"\\\"\r\n    End If\r\n    \r\n\r\n    '-------------------------------------\r\n    ' Root dir is a valid dir\r\n    '-------------------------------------\r\n    If Len(DestPath$) = 3 Then\r\n        If Right$(DestPath$, 2) = \":\\\" Then\r\n            GoTo ParseOK\r\n        End If\r\n    End If\r\n    \r\n\r\n    '------------------------\r\n    ' Check for repeated Slash\r\n    '------------------------\r\n    If InStr(DestPath$, \"\\\\\") <> 0 Then GoTo parseErr\r\n        \r\n    '--------------------------------------\r\n    ' Check for illegal directory names\r\n    '--------------------------------------\r\n    legalChar$ = \"!#$%&'()-0123456789@ABCDEFGHIJKLMNOPQRSTUVWXYZ^_`{}~.\"\r\n    BackPos = 3\r\n    forePos = InStr(4, DestPath$, \"\\\")\r\n    Do\r\n        temp$ = Mid$(DestPath$, BackPos + 1, forePos - BackPos - 1)\r\n        \r\n        '----------------------------\r\n        ' Test for illegal characters\r\n        '----------------------------\r\n        For i = 1 To Len(temp$)\r\n            If InStr(legalChar$, UCase$(Mid$(temp$, i, 1))) = 0 Then GoTo parseErr\r\n        Next i\r\n\r\n        '-------------------------------------------\r\n        ' Check combinations of periods and lengths\r\n        '-------------------------------------------\r\n        periodPos = InStr(temp$, \".\")\r\n        length = Len(temp$)\r\n        If periodPos = 0 Then\r\n            If length > 8 Then GoTo parseErr                         ' Base too long\r\n        Else\r\n            If periodPos > 9 Then GoTo parseErr                      ' Base too long\r\n            If length > periodPos + 3 Then GoTo parseErr             ' Extension too long\r\n            If InStr(periodPos + 1, temp$, \".\") <> 0 Then GoTo parseErr' Two periods not allowed\r\n        End If\r\n\r\n        BackPos = forePos\r\n        forePos = InStr(BackPos + 1, DestPath$, \"\\\")\r\n    Loop Until forePos = 0\r\n\r\nParseOK:\r\n    IsPathValid = True\r\nExit Function\r\n\r\nparseErr:\r\n    IsPathValid = False\r\nEnd Function\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Valid Path","Directory"]},{"RecordId":"31","Title":"Universal Time  (32 bit)","Description":"Determines current Coordinated Universal Time (32 bit)","Code":"Public Function UTCNow() As Date\r\n\r\n    Dim typTimeZone As TIME_ZONE_INFORMATION\r\n    Dim lngRet As Long\r\n    lngRet = glrGetTimeZoneInformation(typTimeZone)\r\n    \r\n    UTCNow = Now() + (typTimeZone.Bias / (60 * 24))\r\n         ' -- or --\r\n    UTCNow = dateadd(\"h\", typTimeZone.Bias / 60, Now())\r\n\r\nEnd Function\r\n\r\n","Declares":"Type SYSTEMTIME\r\n    wYear As Integer\r\n    wMonth As Integer\r\n    wDayOfWeek As Integer\r\n    wDay As Integer\r\n    wHour As Integer\r\n    wMinute As Integer\r\n    wSecond As Integer\r\n    wMilliseconds As Integer\r\nEnd Type\r\n\r\nType TIME_ZONE_INFORMATION\r\n    Bias As Long\r\n    StandardName(32) As Integer\r\n    StandardDate As SYSTEMTIME\r\n    StandardBias As Long\r\n    DaylightName(32) As Integer\r\n    DaylightDate As SYSTEMTIME\r\n    DaylightBias As Long\r\nEnd Type\r\n\r\nDeclare Function glrGetTimeZoneInformation Lib \"kernel32\" Alias \"GetTimeZoneInformation\" (lpTimeZoneInformation As TIME_ZONE_INFORMATION) As Long\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Time","Time Zone","Coordinated Universal Time"]},{"RecordId":"32","Title":"ProgMan - Create Program Group","Description":"Creates a Program Manager group.\r\n","Code":"Sub CreateProgManGroup (x As Form, GroupName$, GroupPath$)\r\n'-------------------------------------------------------------\r\n' Procedure: CreateProgManGroup\r\n' Arguments: X           The Form where a Label1 exist\r\n'            GroupName$  A string that contains the group name\r\n'            GroupPath$  A string that contains the group file\r\n'                        name  ie 'myapp.grp'\r\n'-------------------------------------------------------------\r\n    \r\n    Screen.MousePointer = 11\r\n    \r\n    '----------------------------------------------------------------------\r\n    ' Windows requires DDE in order to create a program group and item.\r\n    ' Here, a Visual Basic label control is used to generate the DDE messages\r\n    '----------------------------------------------------------------------\r\n    On Error Resume Next\r\n\r\n    \r\n    '--------------------------------\r\n    ' Set LinkTopic to PROGRAM MANAGER\r\n    '--------------------------------\r\n    x.Label1.LinkTopic = \"ProgMan|Progman\"\r\n    x.Label1.LinkMode = 2\r\n    For i% = 1 To 10                                         ' Loop to ensure that there is enough time to\r\n      z% = DoEvents()                                        ' process DDE Execute.  This is redundant but needed\r\n    Next                                                     ' for debug windows.\r\n    x.Label1.LinkTimeout = 100\r\n\r\n\r\n    '---------------------\r\n    ' Create program group\r\n    '---------------------\r\n    x.Label1.LinkExecute \"[CreateGroup(\" + GroupName$ + Chr$(44) + GroupPath$ + \")]\"\r\n\r\n\r\n    '-----------------\r\n    ' Reset properties\r\n    '-----------------\r\n    x.Label1.LinkTimeout = 50\r\n    x.Label1.LinkMode = 0\r\n    \r\n    Screen.MousePointer = 0\r\nEnd Sub\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Create Program Group","Setup","ProgMan"]},{"RecordId":"33","Title":"Hide MDI Child Forms","Description":"Hide MDI child forms                     \r\nVB 3.0 does not allow you to Hide an MDI child window but the Windows API does.  This is the routine to do so.","Code":"Sub HideMDIChild (FrmID as Form)\r\n' Version 1.0\r\n    Dim HiddenMDIChild as Integer\r\n    HiddenMDIChild = ShowWindow(frmID.hWnd, 0)\r\nEnd Sub\r\n","Declares":"Declare Function ShowWindow% Lib \"User\" (ByVal hWnd%, ByVal nCmdShow%)\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["MDI Child Hide","Hide Form"]},{"RecordId":"34","Title":"Size a Label, Form, and Command Button","Description":"Sizes a label and it's container form, and positions a command button at the bottom (as in a message box scenario.)","Code":"Private Sub Form_Load()\r\n\r\nLabel1.Top = Screen.TwipsPerPixelY\r\nLabel1.Left = Screen.TwipsPerPixelY\r\nLabel1.Height = TextHeight(strTextIn) + (Screen.TwipsPerPixelY * 5)\r\nLabel1.Width = TextWidth(strTextIn) + (Screen.TwipsPerPixelY * 5)\r\nLabel1.Caption = strTextIn\r\n\r\nMe.Height = Label1.Height + Me.Height - Me.ScaleHeight + Command1.Height + (Screen.TwipsPerPixelY * 10)\r\nMe.Width = Label1.Width + Me.Width - Me.ScaleWidth\r\n\r\nCommand1.Top = Me.ScaleHeight - Command1.Height - (Screen.TwipsPerPixelY * 5)\r\nIf Me.Width < Command1.Width Then\r\n    Me.Width = Command1.Width + (Screen.TwipsPerPixelX * 10)\r\nEnd If\r\n\r\nCommand1.Left = (Me.ScaleWidth - Command1.Width) / 2\r\n\r\nEnd Sub\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Positioning","Control Centering"]},{"RecordId":"35","Title":"Persisting Objects (In Classes)","Description":"Persists object data","Code":"'-----------------------------------------\r\n' This sample contains 2 projects.\r\n' The first project is a form that uses the second project.\r\n' The second project is a DLL that implements horses and bets, in\r\n' addition to saving the existing bets.\r\n'-----------------------------------------\r\n\r\n'-----------------------------------------\r\n' Form (Uses the Bag Handler class)\r\n'-----------------------------------------\r\n\r\nOption Explicit\r\n\r\nPrivate mBet As Bet\r\n\r\nPrivate WithEvents moNotify As MSMQEvent\r\nPrivate moQueue As MSMQQueue\r\n\r\nPrivate Sub chkNotify_Click()\r\n    \r\n    Dim oQInfo As New MSMQQueueInfo\r\n    \r\n    oQInfo.PathName = txtQName.Text\r\n    Set moQueue = oQInfo.Open(MQ_RECEIVE_ACCESS, MQ_DENY_NONE)\r\n    Set moNotify = New MSMQEvent\r\n    moQueue.EnableNotification moNotify\r\n    \r\nEnd Sub\r\n\r\nPrivate Sub cmdCreate_Click()\r\n\r\n    Set mBet = createBet()\r\n\r\nEnd Sub\r\n\r\nPublic Sub displayBet(oBet As Bet)\r\n\r\n    With oBet\r\n      txtCourse.Text = .RaceCourse\r\n      txtTime.Text = .RaceTime\r\n      With .Horse\r\n         txtName.Text = .Name\r\n         txtAge.Text = .AgeInMonths\r\n         txtOwner.Text = .Owner\r\n      End With\r\n      txtOdds.Text = .Odds\r\n      txtBet.Text = .Amount\r\n      lblWinnings.Caption = .CalcWinnings\r\n    End With\r\n    \r\nEnd Sub\r\n\r\nPrivate Sub cmdFRead_Click()\r\n\r\n    Dim b() As Byte\r\n    Dim oHandler As New BagHandler\r\n    \r\n    b = oHandler.ReadFromFile(txtFileName.Text)\r\n    Set mBet = oHandler.UnStream(b)\r\n    displayBet mBet\r\n\r\nEnd Sub\r\n\r\nPrivate Sub cmdFWrite_Click()\r\n\r\n    Dim b() As Byte\r\n    Dim oHandler As New BagHandler\r\n    \r\n    Set mBet = createBet()\r\n    If IsObject(mBet) Then\r\n       b = oHandler.Stream(mBet)\r\n       oHandler.writeToFile b, txtFileName.Text\r\n    End If\r\n\r\nEnd Sub\r\n\r\nPrivate Sub cmdQWrite_Click()\r\n    \r\n    Dim b() As Byte\r\n    Dim oHandler As New BagHandler\r\n    \r\n    Set mBet = createBet()\r\n    If IsObject(mBet) Then\r\n       b = oHandler.Stream(mBet)\r\n       oHandler.writeToQ b, txtQName.Text\r\n    End If\r\n    \r\nEnd Sub\r\n\r\nPrivate Sub cmsQRead_Click()\r\n    \r\n    Dim b() As Byte\r\n    Dim oHandler As New BagHandler\r\n    \r\n    b = oHandler.readFromQ(txtQName.Text)\r\n    Set mBet = oHandler.UnStream(b)\r\n    displayBet mBet\r\n    \r\nEnd Sub\r\n\r\nPublic Function createBet() As Bet\r\n\r\n    Dim oBet As New Bet\r\n    Dim oHorse As New Horse\r\n    \r\n    With oHorse\r\n      .Name = txtName.Text\r\n      .AgeInMonths = txtAge.Text\r\n      .Owner = txtOwner.Text\r\n    End With\r\n    \r\n    With oBet\r\n      .RaceCourse = txtCourse.Text\r\n      .RaceTime = txtTime.Text\r\n      Set .Horse = oHorse\r\n      .Odds = txtOdds.Text\r\n      .Amount = txtBet.Text\r\n    End With\r\n    \r\n    displayBet oBet\r\n    Set createBet = oBet\r\n\r\nEnd Function\r\n\r\nPrivate Sub moNotify_Arrived(ByVal Queue As Object, ByVal Cursor As Long)\r\n\r\n    Dim b() As Byte\r\n    Dim oHandler As New BagHandler\r\n    \r\n    b = oHandler.readFromQ(txtQName.Text)\r\n    Set mBet = oHandler.UnStream(b)\r\n    displayBet mBet\r\n    DoEvents\r\n    moQueue.EnableNotification moNotify\r\n\r\nEnd Sub\r\n\r\n'-----------------------------------------\r\n' The remaining classes are contined as a separate DLL\r\n'-----------------------------------------\r\n'-----------------------------------------\r\n' Bag Handler Class\r\n'-----------------------------------------\r\n\r\nOption Explicit\r\n\r\nPublic Function Stream(obj As Object) As Byte()\r\n    Dim oBag As New PropertyBag\r\n    oBag.WriteProperty \"MyObj\", obj\r\n    Stream = oBag.Contents\r\nEnd Function\r\n\r\nPublic Function UnStream(bStream() As Byte) As Object\r\n    Dim oBag As New PropertyBag\r\n    oBag.Contents = bStream()\r\n    Set UnStream = oBag.ReadProperty(\"MyObj\")\r\nEnd Function\r\n\r\nPublic Sub writeToFile(bStream() As Byte, sFileName As String)\r\n    \r\n    Dim iFile As Integer\r\n    Dim vStream As Variant\r\n    \r\n    vStream = bStream()\r\n    iFile = FreeFile\r\n    \r\n    Open \"C:\\\" & sFileName & \".bag\" For Binary As iFile\r\n    Put iFile, , vStream\r\n    Close iFile\r\n\r\nEnd Sub\r\n\r\nPublic Function readFromFile(sFileName As String) As Byte()\r\n\r\n    Dim iFile As Integer\r\n    Dim vData As Variant\r\n    \r\n    iFile = FreeFile\r\n    Open \"C:\\\" & sFileName & \".bag\" For Binary As iFile\r\n    Get iFile, , vData\r\n    Close iFile\r\n    readFromFile = vData\r\n\r\nEnd Function\r\n\r\nPublic Sub writeToQ(bStream() As Byte, sQName As String)\r\n\r\n    Dim oQInfo As New MSMQQueueInfo\r\n    Dim oQueue As MSMQQueue\r\n    Dim oMessage As New MSMQMessage\r\n    \r\n    oQInfo.PathName = sQName\r\n    Set oQueue = oQInfo.Open(MQ_SEND_ACCESS, MQ_DENY_NONE)\r\n    With oMessage\r\n      .Label = \"Betting Message\"\r\n      .Body = bStream\r\n      .Send oQueue\r\n      End With\r\n    oQueue.Close\r\n\r\nEnd Sub\r\n\r\nPublic Function readFromQ(sQName As String) As Byte()\r\n\r\n    Dim oQInfo As New MSMQQueueInfo\r\n    Dim oQueue As MSMQQueue\r\n    Dim oMessage As New MSMQMessage\r\n    \r\n    oQInfo.PathName = sQName\r\n    Set oQueue = oQInfo.Open(MQ_RECEIVE_ACCESS, MQ_DENY_NONE)\r\n    Set oMessage = oQueue.Receive\r\n    readFromQ = oMessage.Body\r\n    oQueue.Close\r\n\r\nEnd Function\r\n\r\n'-----------------------------------------\r\n' Horse Class\r\n'-----------------------------------------\r\nOption Explicit\r\n\r\nPublic Name As String\r\nPublic AgeInMonths As Integer\r\nPublic Owner As String\r\n\r\nPrivate Sub Class_ReadProperties(PropBag As PropertyBag)\r\n  Me.Name = PropBag.ReadProperty(\"Name\")\r\n  Me.AgeInMonths = PropBag.ReadProperty(\"AgeInMonths\")\r\n  Me.Owner = PropBag.ReadProperty(\"Owner\")\r\nEnd Sub\r\n\r\nPrivate Sub Class_WriteProperties(PropBag As PropertyBag)\r\n  PropBag.WriteProperty \"Name\", Me.Name\r\n  PropBag.WriteProperty \"AgeInMonths\", Me.AgeInMonths\r\n  PropBag.WriteProperty \"Owner\", Me.Owner\r\nEnd Sub\r\n\r\n'-----------------------------------------\r\n' Bet Class\r\n'-----------------------------------------\r\nOption Explicit\r\n\r\nPublic RaceCourse As String\r\nPublic RaceTime As String\r\nPublic Horse As Horse\r\nPublic Odds As Double\r\nPublic Amount As Currency\r\n\r\nPublic Function CalcWinnings() As Currency\r\n  CalcWinnings = Amount * Odds\r\nEnd Function\r\n\r\nPrivate Sub Class_ReadProperties(PropBag As PropertyBag)\r\n  Me.RaceCourse = PropBag.ReadProperty(\"RaceCourse\")\r\n  Me.RaceTime = PropBag.ReadProperty(\"RaceTime\")\r\n  Set Me.Horse = PropBag.ReadProperty(\"Horse\")\r\n  Me.Odds = PropBag.ReadProperty(\"Odds\")\r\n  Me.Amount = PropBag.ReadProperty(\"Amount\")\r\nEnd Sub\r\n\r\nPrivate Sub Class_WriteProperties(PropBag As PropertyBag)\r\n  PropBag.WriteProperty \"RaceCourse\", Me.RaceCourse\r\n  PropBag.WriteProperty \"RaceTime\", Me.RaceTime\r\n  PropBag.WriteProperty \"Horse\", Me.Horse\r\n  PropBag.WriteProperty \"Odds\", Me.Odds\r\n  PropBag.WriteProperty \"Amount\", Me.Amount\r\nEnd Sub\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Persist","Object Persistance"]},{"RecordId":"36","Title":"Retrieve NT SID or Account/Domain Info","Description":"Retrieves SID for an account, then retrieves the AccountName and Domain for the given SID.","Code":"Dim sAccount As String\r\nDim sidLength As Long\r\nDim sdomain As String\r\nDim domainLength As Long\r\nDim peUse As Integer\r\nDim sidAccount As String\r\nDim accountLength As Long\r\nDim sidDomain As String\r\nDim iRet As Long\r\nDim sid() As Byte\r\nDim domain() As Byte\r\nDim i As Integer\r\nDim ssid As String\r\nDim sdomainname As String\r\n\r\nReDim sid(1) As Byte\r\n\r\n\r\n' Retrieve the SID and Domain for an account\r\nsAccount = \"gamblejt\"\r\niRet = LookupAccountName(vbNullString, sAccount, sid(0), sidLength, sdomain, domainLength, peUse)\r\n\r\nReDim sid(sidLength) As Byte\r\nReDim domain(domainLength) As Byte\r\n\r\n' sid() will contian the sid\r\n' domain() will contain the domain after the following call\r\niRet = LookupAccountName(vbNullString, sAccount, sid(0), sidLength, domain(0), domainLength, peUse)\r\n\r\nssid = \"\"\r\nFor i = 0 To sidLength - 1\r\n    ssid = ssid & sid(i)\r\nNext\r\n\r\nsdomainname = \"\"\r\nFor i = 0 To domainLength - 1\r\n    sdomainname = sdomainname & domain(i)\r\nNext\r\n\r\n\r\n' Retrieve the user and domain for a given sid\r\naccountLength = 0\r\ndomainLength = 0\r\n\r\niRet = LookupAccountSid(vbNullString, sid(0), sidAccount, accountLength, sidDomain, domainLength, peUse)\r\nsidAccount = Space(accountLength)\r\nsidDomain = Space(domainLength)\r\n\r\n' sidaccount will contain the account name\r\n' siddomain will contain the domain name\r\niRet = LookupAccountSid(vbNullString, sid(0), sidAccount, accountLength, sidDomain, domainLength, peUse)\r\n","Declares":"Private Declare Function LookupAccountName Lib \"advapi32.dll\" Alias \"LookupAccountNameA\" _\r\n   (ByVal lpSystemName As String, _\r\n    ByVal lpAccountName As String, _\r\n    sid As Any, _\r\n    cbSid As Long, _\r\n    ReferencedDomainName As Any, _\r\n    cbReferencedDomainName As Long, _\r\n    peUse As Integer) As Long\r\n \r\n \r\n Private Declare Function LookupAccountSid Lib \"advapi32.dll\" Alias \"LookupAccountSidA\" _\r\n   (ByVal lpSystemName As String, _\r\n    sid As Any, _\r\n    ByVal name As String, _\r\n    cbName As Long, _\r\n    ByVal ReferencedDomainName As String, _\r\n    cbReferencedDomainName As Long, _\r\n    peUse As Integer) As Long\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["SID","NT Security Info","Domain"]},{"RecordId":"37","Title":"Stored Procedure With Cursor","Description":"Example of how to use a cursor in a stored procedure to read a recordset","Code":"CREATE PROCEDURE TedTest1\r\n\r\nAS\r\n\r\n-- Recordset variables\r\nDECLARE @ErrorCode\tINT\r\nDECLARE @ErrorDescription\tCHAR(50)\r\n\r\n-- Local variables\r\nDECLARE @RecCount\tINT\r\nDECLARE @ECode\tChar(10)\r\nDECLARE @RCount\tChar(10)\r\n\r\n-- The main table cursor\r\nDECLARE my_cursor SCROLL CURSOR\r\n\tFOR\r\n\tSELECT \tError_Code,\t\r\n\t\tError_Description\r\n\tFROM \tError_Code_Master\r\n\tORDER BY Error_Code\r\n\r\nSELECT @RecCount = 0\r\n\r\n-- Open cursor\r\nOPEN my_cursor\r\n\r\n-- Get first record\r\nFETCH FIRST FROM my_cursor\r\nINTO \t@ErrorCode,\t\r\n\t@ErrorDescription\r\n\r\n-- Do until End of file\r\nWHILE ( @@FETCH_STATUS <> -1 )\r\n\tBEGIN\r\n\t\tSELECT @RecCount = @RecCount + 1\r\n\t\tSELECT @RCount = CONVERT(CHAR(10), @RecCount)\r\n\t\tSELECT @ECode = CONVERT(CHAR(10), @ErrorCode)\r\n\r\n\t\tPRINT @ECode\r\n\t\tPRINT @ErrorDescription\r\n\t\tPRINT @RCount\r\n\r\n\t\t-- Get next record\r\n\t\tFETCH NEXT FROM my_cursor\r\n\t\tINTO\t@ErrorCode,\r\n\t\t\t@ErrorDescription\r\n\tEND\r\n\r\n-- Close cursor\r\nCLOSE my_cursor\r\nDEALLOCATE my_cursor\r\n\r\nRETURN(@RecCount)","Declares":"","CodeCategory":{"CategoryId":"6","CategoryDescription":"T-SQL"},"Keywords":["Cursor","Stored Procedure","SQL"]},{"RecordId":"39","Title":"Search For A Window","Description":"Search for a window whose caption partially matches a string","Code":"Function SearchWindowList% (Cap$)\r\n'returns handle of first window that matches partial\r\n'caption passed to function\r\nSearchWindowList% = 0\r\nDim w%, Y%, winCap As String * 255\r\nw% = GetWindow%(MAKerMain.hWnd, GW_HWNDFIRST)\r\nDo While w% <> 0\r\n   Y% = GetWindowText(w%, winCap, 254)\r\n   If Left$(winCap, Len(Cap$)) = Cap$ Then\r\n      SearchWindowList% = w%\r\n      Exit Do\r\n   End If\r\n   w% = GetWindow%(w%, GW_HWNDNEXT)\r\nLoop\r\nEnd Function\r\n\r\n","Declares":"'Declares for SearchWindowList\r\nDeclare Function GetWindow% Lib \"USER\" (ByVal hWnd%, ByVal wCmd%)\r\nGlobal Const GW_HWNDFIRST = 0\r\nGlobal Const GW_HWNDNEXT = 2\r\nDeclare Function GetWindowText Lib \"User\" (ByVal hWnd As Integer, ByVal lpString As String, ByVal aint As Integer) As Integer\r\n\r\n'End of declares\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Find Window"]},{"RecordId":"40","Title":"Associate Win95 File Extensions","Description":"Set Win95 & NT file extension associations so that Explorer will run the app.","Code":"'Call with this code\r\nDim hKey As Long\r\nDim lResult As Long\r\nDim sKeyName As String\r\nDim sValue As String\r\n\r\nsKeyName = \".q&a\\shell\\open\\command\"\r\nsValue = \"c:\\path\\myapp.exe %1\"\r\nlResult = RegCreateKeyEx(HKEY_CLASSES_ROOT, sKeyName, 0&, vbNullString, REG_OPTION_NON_VOLATILE, KEY_ALL_ACCESS, 0&, hKey, lResult)\r\nlResult = SetValueEx(hKey, vbNullString, REG_SZ, sValue)\r\nlResult = RegCloseKey(hKey)\r\n'---------------------------------------\r\nFunction SetValueEx(ByVal hKey As Long, sValueName As String, lType As Long, vValue As Variant) As Long\r\n\r\nDim lValue As Long\r\nDim sValue As String\r\n\r\nSelect Case lType\r\n    Case REG_SZ\r\n        sValue = vValue\r\n        SetValueEx = RegSetValueExString(hKey, sValueName, 0&, lType, sValue, Len(sValue))\r\n    Case REG_DWORD\r\n        lValue = vValue\r\n        SetValueEx = RegSetValueExLong(hKey, sValueName, 0&, lType, lValue, 4)\r\n    End Select\r\n    \r\nEnd Function\r\n","Declares":"Global Const REG_SZ As Long = 1\r\nGlobal Const HKEY_CLASSES_ROOT = &H80000000\r\nGlobal Const KEY_ALL_ACCESS = &H3F\r\nGlobal Const REG_OPTION_NON_VOLATILE = 0\r\n\r\nDeclare Function RegCloseKey Lib \"advapi32.dll\" (ByVal hKey As Long) As Long\r\nDeclare Function RegCreateKeyEx Lib \"advapi32.dll\" Alias \"RegCreateKeyExA\" (ByVal hKey As Long, ByVal lpSubKey As String, ByVal Reserved As Long, ByVal lpClass As String, ByVal dwOptions As Long, ByVal samDesired As Long, ByVal lpSecurityAttributes As Long, phkResult As Long, lpdwDisposition As Long) As Long\r\nDeclare Function RegSetValueExString Lib \"advapi32.dll\" Alias \"RegSetValueExA\" (ByVal hKey As Long, ByVal lpValueName As String, ByVal Reserved As Long, ByVal dwType As Long, ByVal lpValue As String, ByVal cbData As Long) As Long\r\nDeclare Function RegSetValueExLong Lib \"advapi32.dll\" Alias \"RegSetValueExLongA\" (ByVal hKey As Long, ByVal lpValueName As String, ByVal Reserved As Long, ByVal dwType As Long, ByVal lpValue As Long, ByVal cbData As Long) As Long\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["File association","Associate extensions"]},{"RecordId":"42","Title":"Easter Date","Description":"Computes Easter for a given year","Code":"Public Function EasterDate(ByVal year As Integer) As String\r\n\r\nDim golden As Integer\r\nDim solar As Integer\r\nDim lunar As Integer\r\nDim pfm As Integer\r\nDim dom As Integer\r\nDim tmp As Integer\r\nDim easter As Integer\r\n\r\ngolden = (year Mod 19) + 1\r\n\r\nIf year <= 1752 Then\r\n    dom = (year + (year \\ 4) + 5) Mod 7\r\n    If dom < 0 Then\r\n        dom = dom + 7\r\n    End If\r\n    pfm = (3 - (11 * golden) - 7) Mod 30\r\n    If pfm < 0 Then\r\n        pfm = pfm + 30\r\n    End If\r\nElse\r\n    dom = (year + (year \\ 4) - (year \\ 100) + (year \\ 400)) Mod 7\r\n    If dom < 0 Then\r\n        dom = dom + 7\r\n    End If\r\n    solar = (year - 1600) \\ 100 - (year - 1600) \\ 400\r\n    lunar = (((year - 1400) \\ 100) * 8) \\ 25\r\n    pfm = (3 - (11 * golden) + solar - lunar) Mod 30\r\n    If pfm < 0 Then\r\n        pfm = pfm + 30\r\n    End If\r\nEnd If\r\n\r\nIf ((pfm = 29) Or (pfm = 28 And golden > 11)) Then\r\n    pfm = pfm - 1\r\nEnd If\r\n\r\ntmp = (4 - pfm - dom) Mod 7\r\nIf tmp < 0 Then\r\n    tmp = tmp + 7\r\nEnd If\r\n\r\neaster = pfm + tmp + 1\r\nIf easter < 11 Then\r\n    EasterDate = \"March \" & CStr(easter + 21)\r\nElse\r\n    EasterDate = \"April \" & CStr(easter - 10)\r\nEnd If\r\n    \r\nEnd Function\r\n","Declares":"","CodeCategory":{"CategoryId":"7","CategoryDescription":"Misc"},"Keywords":["Easter","Dates"]},{"RecordId":"43","Title":"Enter Key to Tab Key","Description":"Allows the Enter Key to move from field to field like Tab Key on form level.  Also stops beep.","Code":"Sub Form_KeyDown (KeyCode As Integer, Shift As Integer)\r\nIf KeyCode = KEY_RETURN Then\r\n    KeyCode = 0\r\n    SendKeys \"{tab}\"\r\nEnd If\r\nEnd Sub\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Enter to Tab","Tab","SendKey"]},{"RecordId":"44","Title":"About Screen (API)","Description":"Display an \"About\" message box using the Windows API","Code":"Sub Display_About ()\r\n\r\nDim MoreInfo As String\r\n\r\nMoreInfo = \"Copyright \" & Chr$(169) & \" 1994 Bug Free Software, Inc.\"\r\nMoreInfo = MoreInfo & Chr$(13) & \"Technical Support: 1-800-xxx-xxxx\"\r\n\r\nCall ShellAbout(Me.hWnd, App.Title, MoreInfo, Me.Icon)\r\n\r\nEnd Sub","Declares":"Declare Sub ShellAbout Lib \"shell.dll\" (ByVal hWndOwner As Integer, ByVal lpszAppName As String, ByVal lpszMoreInfo As String, ByVal hIcon As Integer)\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["About Screen"]},{"RecordId":"45","Title":"Rounding - A Function to Do It 2","Description":"A sample rounding function","Code":"Public Function RoundCC (byval varNumberIn as Variant) As Variant\r\n\r\n  RoundCC = Int(varNumberIn * 100 + 0.5) / 100\r\n\r\nEnd Function","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Rounding","Round"]},{"RecordId":"46","Title":"ODBC DSN Creation","Description":"Programatically create an ODBC data source","Code":"Private Sub CreateODBC_DSN()\r\n\r\ndim iRet as integer\r\ndim lpszAttributes as string\r\n\r\nlpszAttributes = \"DSN=Data source name\" & chr$(0)\r\nlpszAttributes = lpszAttributes & \"Description=Data source SQL 6.0 description\" & chr$(0)\r\nlpszAttributes = lpszAttributes & \"Server=My server\" & chr$(0)\r\n\r\n'For TCP/IP (If explicitly using name pipes, address is not included)\r\nlpszAttributes = lpszAttributes & \"Address=162.66.125.65,7024\" & chr$(0)\r\n\r\nlpszAttributes = lpszAttributes & \"UseProcForPrepare=Yes\" & chr$(0)\r\nlpszAttributes = lpszAttributes & \"Database=My database\" & chr$(0)\r\n\r\n\r\nlpszAttributes = lpszAttributes & \"Language=us_english\" & chr$(0)\r\nlpszAttributes = lpszAttributes & \"OEMTOANSI=No\" & chr$(0)\r\n\r\n'Network library\r\nlpszAttributes = lpszAttributes & \"Network=wbnovtc\" & chr$(0) & chr$(0)\r\n\r\n'Create the data source.  If you already have a data source with\r\n'the same name, display confirmation message to overwrite.\r\niRet=SQLConfigDataSource(0, 1,\"SQL Server\", lpszAttributes)\r\nif iRet <> 1 then\r\n\tiRet=SQLConfigDataSource(Setup1.hWnd, 1,\"SQL Server\", lpszAttributes)\r\n\tif iRet <> 1 then \r\n\t\tMsgBox \"Error occured during ODBC data source creation\"\r\n\tEnd if\r\nend if\r\n\r\nEnd Sub\r\n","Declares":"Declare Function SQLConfigDataSource lib \"ODBCINST.DLL\" (byval hWnd as integer, byval fRequest as integer, byval lpszDriver as string, byval lpsAttrib as string) as integer\r\n","CodeCategory":{"CategoryId":"3","CategoryDescription":"Database"},"Keywords":["ODBC","Data Source","Setup"]},{"RecordId":"47","Title":"Extract Icons","Description":"Used to extrach Icons from other files","Code":"Sub Picture1_Click ()\r\n    Dim X As Integer\r\n    X = ExtractIcon%(agGetInstance%(), \"c:\\actwin\\actwin.exe\", 0)\r\n    Print Str$(X)\r\n\r\n    Dim draw_it%\r\n    draw_it = drawIcon(picture1.hDC, 10, 10, X)\r\n    Print Str$(draw_it)\r\n\r\nEnd Sub\r\n","Declares":"Declare Function ExtractIcon% lib \"shell.dll\" (Byval hinst%, Byval ExeName$, Byval Icon%)\r\nDeclare Function DrawIcon% lib \"user\" (Byval hDC%, Byval X%, Byval Y%, Byval hIcon%)\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Extract Icons","Icons"]},{"RecordId":"48","Title":"Printer Setup","Description":"Printer Setup Dialog Box","Code":"Sub PrinterSetup_Click()\r\n        Dim dev$, devname$, devoutput$\r\n        Dim libhnd%\r\n        dev$ = GetDefPrinter$() ' Get default printer info\r\n        If dev$ = \"\" Then Exit Sub\r\n        devname$ = GetDeviceName$(dev$)\r\n        devoutput$ = GetDeviceOutput$(dev$)\r\n        ' Load the device driver library - exit if unavailable\r\n        libhnd% = LoadLibrary(GetDeviceDriver$(dev$) + \".drv\")\r\n        If libhnd% = 0 Then Exit Sub\r\n        ' WARNING - this allows change of the default printer\r\n        ' settings!\r\n        di% = agDeviceMode(hWnd, libhnd%, devname$, devoutput$)\r\n        FreeLibrary (libhnd%)\r\nEnd Sub","Declares":"Global di%\r\nDeclare Function GetProfileString% Lib \"Kernel\" (ByVal lpAppName$, ByVal lpKeyName As Any, ByVal lpDefault$, ByVal lpReturnedString$, ByVal nSize%)\r\nDeclare Function LoadLibrary% Lib \"Kernel\" (ByVal lpLibFileName$)\r\nDeclare Sub FreeLibrary Lib \"Kernel\" (ByVal hLibModule%)\r\nDeclare Function agGetStringFromLPSTR$ Lib \"Apiguide.dll\" (ByVal lpstring$)\r\nDeclare Function agDeviceMode% Lib \"Apiguide.dll\" (ByVal hWnd%, ByVal hModule%, ByVal lpszDevice$, ByVal lpszOutput$)\r\n\r\nFunction GetDefPrinter$ ()\r\n\r\nDim def$\r\ndef$ = String$(128, 0)\r\ndi% = GetProfileString%(\"WINDOWS\", \"DEVICE\", \"\", def$, 127)\r\ndef$ = agGetStringFromLPSTR$(def$)\r\nGetDefPrinter$ = def$\r\n\r\nEnd Function\r\nFunction GetDeviceDriver$ (dev$)\r\n\r\nDim firstpos%, nextpos%\r\nfirstpos% = InStr(dev$, \",\")\r\nnextpos% = InStr(firstpos% + 1, dev$, \",\")\r\nGetDeviceDriver$ = Mid$(dev$, firstpos% + 1, nextpos% - firstpos% - 1)\r\n\r\nEnd Function\r\nFunction GetDeviceName$ (dev$)\r\n\r\nDim npos%\r\nnpos% = InStr(dev$, \",\")\r\nGetDeviceName$ = Left$(dev$, npos% - 1)\r\n\r\nEnd Function\r\nFunction GetDeviceOutput$ (dev$)\r\n\r\nDim firstpos%, nextpos%\r\nfirstpos% = InStr(dev$, \",\")\r\nnextpos% = InStr(firstpos% + 1, dev$, \",\")\r\nGetDeviceOutput$ = Mid$(dev$, nextpos% + 1)\r\n\r\nEnd Function\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Printer Setup","Printer Dialog"]},{"RecordId":"49","Title":"Execute Command Line Statements","Description":"Executes command line commands (DOS or Windows)","Code":"Dim x As Long\r\n\r\nIf UCase(Left$(Text1.Text, 4)) <> \"RUN \" Then\r\n    x = Shell(\"command.com /c c:\\ted\\windos.bat \" & Text1.Text, 1)\r\nElse\r\n    x = Shell(Mid$(Text1.Text, 5), 1)\r\nEnd If\r\n\r\n\r\n'Requires the following \"windos.bat\" file:\r\n%1 %2 %3 %4 %5 %6 %7 %8 %9\r\npause","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Command Line","Run","DOS Command"]},{"RecordId":"50","Title":"Removes Path from Filename","Description":"Function removes path from fully-qualified file name, returns file name only.\r\n","Code":"Function StripPath$ (T$)\r\nDim x%, ct%\r\nStripPath$ = T$\r\nx% = InStr(T$, \"\\\")\r\nDo While x%\r\n   ct% = x%\r\n   x% = InStr(ct% + 1, T$, \"\\\")\r\nLoop\r\nIf ct% > 0 Then StripPath$ = Mid$(T$, ct% + 1)\r\nEnd Function\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["File Name"]},{"RecordId":"51","Title":"File Notification (Monitor Directory For Changes)","Description":"Demonstrates how to use File Change Notification to automatically process files.","Code":"Option Explicit\r\n\r\n    Dim hAutoBackup As Long\r\n    Dim bStop As Boolean\r\n    Dim hChangeHandle As Long\r\n    Dim NotifyPath As String\r\n    Dim BackupPath As String\r\n\r\nPrivate Sub Form_Unload(Cancel As Integer)\r\n\r\n    If hAutoBackup > 0 Then\r\n        Call NotifyDelete(hAutoBackup)\r\n    End If\r\n    \r\n    End\r\n\r\nEnd Sub\r\n\r\nPrivate Sub mnuExit_Click()\r\n\r\n    Unload Me\r\n\r\nEnd Sub\r\n\r\nPrivate Sub mnuEnd_Click()\r\n\r\n    Call NotifyDelete(hAutoBackup)\r\n    \r\n    hAutoBackup = 0\r\n    mnuStart.Enabled = True\r\n    lbStatus = \"Select Start from the File menu\"\r\n    mnuEnd.Enabled = False\r\n\r\nEnd Sub\r\n\r\nPrivate Sub mnuSelect_Click()\r\n\r\n    NotifyPath = PathDialog()\r\n    File1.Path = NotifyPath\r\n    lbStatus = \"Select Backup folder from the File menu\"\r\n\r\nEnd Sub\r\n\r\nPrivate Sub mnuBackup_Click()\r\n\r\n    BackupPath = PathDialog()\r\n    mnuStart.Enabled = True\r\n    lbStatus = \"Select Start from the File menu\"\r\n\r\nEnd Sub\r\n\r\nPrivate Sub mnuStart_Click()\r\n\r\n    Dim NotifyStatus As Long\r\n    Dim i As Long\r\n    \r\n    bStop = False\r\n    mnuStart.Enabled = False\r\n    mnuEnd.Enabled = True\r\n    \r\n    For i = 0 To File1.ListCount - 1\r\n       SetAttr NotifyPath & \"\\\" & File1.List(i), vbNormal\r\n    Next\r\n    \r\n    lbStatus = \"AutoBackup of \" & NotifyPath\r\n    Me.Caption = \"AutoBackup of \" & NotifyPath\r\n    \r\n    hAutoBackup = NotifyCreate(NotifyPath, FILE_NOTIFY_FLAGS)\r\n    If hAutoBackup <> -1 Then\r\n        NotifyAction\r\n        Do\r\n            NotifyStatus = NotifyNext(hAutoBackup, 100)\r\n            If Not NotifyStatus Then\r\n                NotifyAction\r\n            End If\r\n        Loop While NotifyStatus = 0\r\n    End If\r\n\r\nEnd Sub\r\n\r\nPrivate Function NotifyCreate(lpPathName As String, flags As Long) As Long\r\n\r\n    NotifyCreate = FindFirstChangeNotification(lpPathName, False, flags)\r\n\r\nEnd Function\r\n\r\nPrivate Sub NotifyDelete(hAutoBackup As Long)\r\n\r\n    bStop = True\r\n    DoEvents\r\n    \r\n    FindCloseChangeNotification hAutoBackup\r\n\r\nEnd Sub\r\n\r\nPrivate Function NotifyNext(hAutoBackup As Long, interval) As Boolean\r\n\r\n    Dim res As Long\r\n    \r\n    FindNextChangeNotification hAutoBackup\r\n    Do\r\n       res = WaitForSingleObject(hAutoBackup, interval)\r\n       DoEvents\r\n    Loop While res <> 0 And bStop = False\r\n    \r\n    NotifyNext = res\r\n\r\nEnd Function\r\n\r\nPrivate Sub NotifyAction()\r\n\r\n    Dim i As Long\r\n    \r\n    File1.Refresh\r\n    For i = 0 To File1.ListCount - 1\r\n       FileCopy NotifyPath & \"\\\" & File1.List(i), BackupPath & \"\\\" & File1.List(i)\r\n       SetAttr NotifyPath & \"\\\" & File1.List(i), vbNormal\r\n    Next\r\n\r\nEnd Sub\r\n","Declares":"Private Type BROWSEINFO\r\n    hOwner As Long\r\n    pidlRoot As Long\r\n    pszDisplayName As String\r\n    lpszTitle As String\r\n    ulFlags As Long\r\n    lpfn As Long\r\n    lParam As Long\r\n    iImage As Long\r\nEnd Type\r\n\r\nPrivate Const BIF_RETURNONLYFSDIRS = &H1\r\nPrivate Declare Function SHGetPathFromIDList Lib \"shell32.dll\" Alias \"SHGetPathFromIDListA\" (ByVal pidl As Long, ByVal pszPath As String) As Long\r\n\r\nPrivate Declare Function SHBrowseForFolder Lib \"shell32.dll\" Alias \"SHBrowseForFolderA\" (lpBrowseInfo As BROWSEINFO) As Long\r\n\r\nPublic Const FILE_NOTIFY_CHANGE_FILE_NAME As Long = &H1\r\nPublic Const FILE_NOTIFY_CHANGE_DIR_NAME As Long = &H2\r\nPublic Const FILE_NOTIFY_CHANGE_ATTRIBUTES As Long = &H4\r\nPublic Const FILE_NOTIFY_CHANGE_SIZE As Long = &H8\r\nPublic Const FILE_NOTIFY_CHANGE_LAST_WRITE As Long = &H10\r\nPublic Const FILE_NOTIFY_CHANGE_LAST_ACCESS As Long = &H20\r\nPublic Const FILE_NOTIFY_CHANGE_CREATION As Long = &H40\r\nPublic Const FILE_NOTIFY_CHANGE_SECURITY As Long = &H100\r\nPublic Const FILE_NOTIFY_NEWUPDATE = FILE_NOTIFY_CHANGE_CREATION Or FILE_NOTIFY_CHANGE_LAST_WRITE\r\nPublic Const FILE_NOTIFY_FLAGS = FILE_NOTIFY_CHANGE_ATTRIBUTES Or FILE_NOTIFY_CHANGE_FILE_NAME Or FILE_NOTIFY_CHANGE_LAST_WRITE\r\n\r\nPublic Declare Function FindFirstChangeNotification Lib \"kernel32\" Alias \"FindFirstChangeNotificationA\" (ByVal lpPathName As String, ByVal bNotifySubtree As Long, ByVal dwNotifyFilter As Long) As Long\r\nPublic Declare Function FindNextChangeNotification Lib \"kernel32\" (ByVal hChangeHandle As Long) As Long\r\nPublic Declare Function FindCloseChangeNotification Lib \"kernel32\" (ByVal hChangeHandle As Long) As Long\r\n\r\nPublic Const INFINITE = &HFFFF\r\nPublic Const WAIT_OBJECT_0 = &H0\r\nPublic Const WAIT_ABANDONED = &H80\r\nPublic Const WAIT_IO_COMPLETION = &HC0\r\nPublic Const WAIT_TIMEOUT = &H102\r\nPublic Const STATUS_PENDING = &H103\r\n\r\nPublic Declare Function WaitForSingleObject Lib \"kernel32\" (ByVal hHandle As Long, ByVal dwMilliseconds As Long) As Long\r\n\r\nPublic Function PathDialog() As String\r\n\r\n    Dim udtBrowseInfo As BROWSEINFO\r\n    Dim lPathID As Long\r\n    Dim sPath As String\r\n    Dim vSplit\r\n    \r\n    udtBrowseInfo.hOwner = 0&\r\n    udtBrowseInfo.pidlRoot = 0&\r\n    udtBrowseInfo.lpszTitle = \"Select a folder\"\r\n    udtBrowseInfo.ulFlags = BIF_RETURNONLYFSDIRS\r\n    lPathID = SHBrowseForFolder(udtBrowseInfo)\r\n    sPath = Space$(512)\r\n    If SHGetPathFromIDList(lPathID, sPath) Then\r\n        vSplit = Split(sPath, vbNullChar)\r\n        PathDialog = vSplit(0)\r\n    End If\r\n\r\nEnd Function\r\n\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["File Notification","Wait for File Change"]},{"RecordId":"52","Title":"ADO Samples","Description":"Samples for opening and reading an ODBC data source using ADO.","Code":"Dim conADO As New ADODB.Connection\r\nDim rstADO As New ADODB.Recordset\r\nDim strSQL As String\r\nDim strConnect As String\r\n\r\n\r\nstrConnect = \"DRIVER={SQL Server};SERVER=JCBApps6;UID=developer;PWD=developer1;DATABASE=CorpDB\"\r\nconADO.Open strConnect\r\nSet rstADO.ActiveConnection = conADO\r\n\r\nstrSQL = \"SELECT v_account.*,\"\r\nstrSQL = strSQL & \" Security_Number\"\r\nstrSQL = strSQL & \" FROM v_account\"\r\nstrSQL = strSQL & \" INNER JOIN v_position_td\"\r\nstrSQL = strSQL & \" ON v_account.Account_Branch = v_position_td.Account_Branch\"\r\nstrSQL = strSQL & \" AND v_account.Account_Base = v_position_td.Account_Base\"\r\nstrSQL = strSQL & \" WHERE v_account.Account_Branch = '143'\"\r\nstrSQL = strSQL & \" AND v_account.Broker_Number = 'M94'\"\r\n\r\nrstADO.Open strSQL\r\nDo While Not rstADO.EOF\r\n    Debug.Print rstADO!Account_Branch & \"-\" & rstADO!Account_Base & \" \" & rstADO!Security_Number\r\n    rstADO.MoveNext\r\nLoop\r\n\r\nrstADO.Close\r\nSet rstADO = Nothing\r\n\r\nconADO.Close\r\nSet conADO = Nothing\r\n","Declares":"","CodeCategory":{"CategoryId":"3","CategoryDescription":"Database"},"Keywords":["ADO","ODBC"]},{"RecordId":"53","Title":"Change Menu Captions Dynamicaly","Description":"This is sample code to enabled/disable menu options & change their captions.  This sample code is straight from this program!","Code":"Sub SetEditMenu ()\r\n    mnuEdit(2).Enabled = True\r\n    If TypeOf Screen.ActiveControl Is TextBox Then\r\n        If Screen.ActiveControl.SelText = \"\" Then\r\n            If Trim(Screen.ActiveControl.Text) <> \"\" Then\r\n                mnuEdit(2).Caption = \"&Copy \" + Screen.ActiveControl.Tag\r\n            Else\r\n                mnuEdit(2).Caption = \"Can't &Copy \"\r\n                mnuEdit(2).Enabled = False\r\n            End If\r\n        Else\r\n            mnuEdit(2).Caption = \"&Copy Selected Text\"\r\n        End If\r\n        If Clipboard.GetFormat(CF_TEXT) Then\r\n            mnuEdit(3).Caption = \"&Paste into \" + Screen.ActiveControl.Tag\r\n        Else\r\n            mnuEdit(3).Caption = \"&Paste\"\r\n        End If\r\n    End If\r\nEnd Sub\r\n \r\n \r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Menu"]},{"RecordId":"54","Title":"Exit Windows (and Reboot)","Description":"Subroutine to close Windows from a Windows App.","Code":"Sub mRestartWindows_Click ()\r\nMsg$ = \"Do You Really Want To Restart Windows????\"\r\nIf MsgBox(Msg$, 4 + 16 + 256) <> 6 Then\r\n     Exit Sub\r\nEnd If\r\ni = ExitWindows(66, 0)  'This restarts windows\r\n'i = ExitWindows(67, 0)  'This Reboots and Restarts Windows\r\nEnd Sub","Declares":"Declare Function ExitWindows Lib \"User\" (ByVal RestartCode As Long, ByVal DOSReturnCode As Integer) As Integer\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Exit Windows","Reboot","Shut down"]},{"RecordId":"55","Title":"Send Windows PopUp Message to Workstations","Description":"Uses WinPopUp to send a message to a workstation","Code":"Call it with:\r\n\r\nSendToWinPopUp \"Ted\", \"DEVL-020\", Text1.Text\r\nWhere:  \"Ted\" is the originator (any free form string)\r\n              \"DEVL-020\" is the NT machine name\r\n              \"Text1.text\" is the message string to send\r\n\r\n\r\n\r\nPublic Sub SendToWinPopUp(PopFrom As String, PopTo As String, MsgText As String)\r\n\r\nDim rc As Long\r\nDim mshandle As Long\r\nDim msgtxt As String\r\nDim byteswritten As Long\r\nDim mailslotname As String\r\nDim secattr As SECURITY_ATTRIBUTES\r\nDim ovrl As OVERLAPPED\r\n\r\nmailslotname = \"\\\\\" & PopTo & \"\\mailslot\\messngr\"\r\n\r\nmsgtxt = PopFrom & Chr(0) & PopTo & Chr(0) & MsgText & Chr(0)\r\nmshandle = CreateFile(mailslotname, GENERIC_WRITE, FILE_SHARE_READ, secattr, OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, 0)\r\n\r\nrc = WriteFile(mshandle, msgtxt, Len(msgtxt), byteswritten, ovrl)\r\nrc = CloseHandle(mshandle)\r\n\r\nEnd Sub\r\n\r\n\r\n","Declares":"Declare Function CloseHandle Lib \"kernel32\" (ByVal hObject As Long) As Long\r\nDeclare Function WriteFile Lib \"kernel32\" (ByVal hFile As Long, ByVal lpBuffer As Any, ByVal nNumberOfBytesToWrite As Long, lpNumberOfBytesWritten As Long, lpOverlapped As OVERLAPPED) As Long\r\nDeclare Function CreateFile Lib \"kernel32\" Alias \"CreateFileA\" (ByVal lpFileName As String, ByVal dwDesiredAccess As Long, ByVal dwShareMode As Long, lpSecurityAttributes As SECURITY_ATTRIBUTES, ByVal dwCreationDisposition As Long, ByVal dwFlagsAndAttributes As Long, ByVal hTemplateFile As Long) As Long\r\n\r\nPublic Const OPEN_EXISTING = 3\r\nPublic Const GENERIC_EXECUTE = &H20000000\r\nPublic Const GENERIC_READ = &H80000000\r\nPublic Const GENERIC_WRITE = &H40000000\r\nPublic Const GENERIC_ALL = &H10000000\r\nPublic Const INVALID_HANDLE_VALUE = -1\r\nPublic Const FILE_SHARE_READ = &H1\r\nPublic Const FILE_SHARE_WRITE = &H2\r\nPublic Const FILE_ATTRIBUTE_NORMAL = &H80\r\n\r\nType SECURITY_ATTRIBUTES\r\n        nLength As Long\r\n        lpSecurityDescriptor As Long\r\n        bInheritHandle As Long\r\nEnd Type\r\n\r\nType OVERLAPPED\r\n        Internal As Long\r\n        InternalHigh As Long\r\n        offset As Long\r\n        OffsetHigh As Long\r\n        hEvent As Long\r\nEnd Type\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["WinPopUp","Message","Send Message"]},{"RecordId":"56","Title":"Determine How Computer Was Booted","Description":"Determines how a system was started","Code":"Dim lngStartMode As Long\r\n\r\nlngStartMode = GetSystemMetrics(SM_CLEANBOOT)\r\nSelect Case lngStartMode\r\n    Case 0\r\n        MsgBox \"System booted in normal mode\"\r\n    Case 1\r\n        MsgBox \"System booted in fail-safe mode\"\r\n    Case 2\r\n        MsgBox \"System booted in fail-safe with network mode\"\r\n    Case Else\r\n        MsgBox \"Unknown\"\r\nEnd Select\r\n","Declares":"Private Declare Function GetSystemMetrics Lib \"user32\" (ByVal nIndex As Long) As Long\r\n\r\nPrivate Const SM_CLEANBOOT = 67\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Start Mode","Boot mode"]},{"RecordId":"57","Title":"Getting Available SQL Server Names in Visual Basic","Description":"Uses SQLDMO to retrieve list of SQL Servers.","Code":"Add this code as a reference to the Microsoft SQLDMO Object Library (SQLDMO.DLL).\r\n\r\n\r\nDim SQLApp As SQLDMO.Application\r\nDim Names As SQLDMO.NameList\r\n    \r\nSet SQLApp = New SQLDMO.Application\r\n' get available servers\r\nSet Names = SQLApp.ListAvailableSQLServers\r\n    \r\nDim indx As Integer\r\n\r\n' print names to debug window    \r\nFor indx = 1 To Names.Count\r\n    Debug.Print Names.Item(indx)\r\nNext\r\n    \r\nSet Names = Nothing\r\nSet SQLApp = Nothing\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"3","CategoryDescription":"Database"},"Keywords":["SQLDMO","SQL Server"]},{"RecordId":"58","Title":"INI Class","Description":"Class to read/write INI files","Code":"Option Explicit\r\n\r\nPrivate strIniName As String\r\nPrivate strSection As String\r\nPrivate strKeyName As String\r\nPrivate strKeyValue As String\r\n\r\nPrivate Sub ClearINIValues()\r\n    \r\n    strIniName = \"\"\r\n    strSection = \"\"\r\n    strKeyName = \"\"\r\n    strKeyValue = \"\"\r\n    \r\n    Exit Sub\r\n    \r\nEnd Sub\r\n\r\nPublic Sub INIDeleteKey()\r\n    \r\n    Dim lngRetVal As Long\r\n    \r\n    If Trim$(strIniName = \"\") Then\r\n        MsgBox \"Missing INI File Name parameter\"\r\n        Exit Sub\r\n    End If\r\n    \r\n    If Trim$(strSection = \"\") Then\r\n        MsgBox \"Missing INI Section parameter\"\r\n        Exit Sub\r\n    End If\r\n    \r\n    If Trim$(strKeyName = \"\") Then\r\n        MsgBox \"Missing INI Key Value parameter\"\r\n        Exit Sub\r\n    End If\r\n    \r\n    lngRetVal = WritePrivateProfileString(strSection, strKeyName, vbNullString, strIniName)\r\n    \r\n    ClearINIValues\r\n    \r\n    Exit Sub\r\n    \r\n    \r\nEnd Sub\r\n\r\nPublic Sub INIDeleteSection()\r\n    \r\n    Dim lngRetVal As Long\r\n    \r\n    If Trim$(strIniName = \"\") Then\r\n        MsgBox \"Missing INI File Name parameter\"\r\n        Exit Sub\r\n    End If\r\n    \r\n    If Trim$(strSection = \"\") Then\r\n        MsgBox \"Missing INI Section parameter\"\r\n        Exit Sub\r\n    End If\r\n    \r\n    lngRetVal = WritePrivateProfileString(strSection, vbNullString, vbNullString, strIniName)\r\n    \r\n    ClearINIValues\r\n    \r\n    Exit Sub\r\n    \r\n    \r\n    \r\nEnd Sub\r\n\r\nPublic Function INIGetAllKeys() As Variant\r\n    \r\n    \r\n    Dim lngRetVal As Long\r\n    Dim strReturnedString As String\r\n    Dim strKeyArray(100) As String\r\n    Dim intStart As Integer\r\n    Dim intOffset As Integer\r\n    Dim intIndex As Integer\r\n    Dim strTempString As String\r\n    \r\n    If Trim$(strIniName = \"\") Then\r\n        MsgBox \"Missing INI File Name parameter\"\r\n        Exit Function\r\n    End If\r\n    \r\n    If Trim$(strSection = \"\") Then\r\n        MsgBox \"Missing INI Section parameter\"\r\n        Exit Function\r\n    End If\r\n    \r\n    strReturnedString = Space$(1024)\r\n    lngRetVal = GetPrivateProfileSection(strSection, strReturnedString, Len(strReturnedString), strIniName)\r\n    If lngRetVal <> 0 Then\r\n        intStart = 1\r\n        intOffset = 1\r\n        intIndex = 0\r\n        intOffset = InStr(intStart, strReturnedString, Chr$(0))\r\n        Do Until intOffset = 0\r\n            \r\n            strTempString = Mid$(strReturnedString, intStart, intOffset - intStart)\r\n            If InStr(1, strTempString, \"=\") <> 0 Then\r\n                strKeyArray(intIndex) = Left$(strTempString, InStr(1, strTempString, \"=\") - 1)\r\n                intIndex = intIndex + 1\r\n            End If\r\n            intStart = intOffset + 1\r\n            intOffset = InStr(intStart, strReturnedString, Chr$(0))\r\n        Loop\r\n    End If\r\n    \r\n    INIGetAllKeys = CVar(strKeyArray)\r\n    \r\n    \r\n    Exit Function\r\n    \r\n    \r\n    \r\n    \r\n    \r\nEnd Function\r\n\r\nPublic Property Let INIKeyValue(strKeyValueIn As String)\r\n    \r\n    strKeyValue = strKeyValueIn\r\n    Exit Property\r\n    \r\nEnd Property\r\n\r\nPrivate Function INIRead() As String\r\n    \r\n    Dim lngRetVal As Long\r\n    \r\n    If Trim$(strIniName = \"\") Then\r\n        MsgBox \"Missing INI File Name parameter\"\r\n        Exit Function\r\n    End If\r\n    \r\n    If Trim$(strSection = \"\") Then\r\n        MsgBox \"Missing INI Section parameter\"\r\n        Exit Function\r\n    End If\r\n    \r\n    If Trim$(strKeyName = \"\") Then\r\n        MsgBox \"Missing INI Key Value parameter\"\r\n        Exit Function\r\n    End If\r\n    \r\n    strKeyValue = Space$(128)\r\n    INIRead = \"\"\r\n    \r\n    lngRetVal = GetPrivateProfileString(strSection, strKeyName, \"\", strKeyValue, Len(strKeyValue), strIniName)\r\n    INIRead = Left$(strKeyValue, lngRetVal)\r\n    \r\n    Exit Function\r\n    \r\nEnd Function\r\n\r\nPublic Property Let INIFileName(strININameIn As String)\r\n    \r\n    strIniName = strININameIn\r\n    Exit Property\r\n    \r\nEnd Property\r\n\r\nPublic Property Let INIKeyName(strKeyNameIn As String)\r\n    \r\n    strKeyName = strKeyNameIn\r\n    Exit Property\r\n    \r\nEnd Property\r\n\r\nPublic Property Get INIReturnValue() As String\r\n    \r\n    INIReturnValue = INIRead()\r\n    \r\n    ClearINIValues\r\n    \r\n    Exit Property\r\n    \r\nEnd Property\r\n\r\nPublic Property Let INISectionName(strSectionNameIn As String)\r\n    \r\n    strSection = strSectionNameIn\r\n    Exit Property\r\n    \r\nEnd Property\r\n\r\nPublic Sub INIWrite()\r\n    \r\n    Dim lngRetVal As Long\r\n    \r\n    If Trim$(strIniName = \"\") Then\r\n        MsgBox \"Missing INI File Name parameter\"\r\n        Exit Sub\r\n    End If\r\n    \r\n    If Trim$(strSection = \"\") Then\r\n        MsgBox \"Missing INI Section parameter\"\r\n        Exit Sub\r\n    End If\r\n    \r\n    If Trim$(strKeyName = \"\") Then\r\n        MsgBox \"Missing INI Key Value parameter\"\r\n        Exit Sub\r\n    End If\r\n    \r\n    If Trim$(strKeyValue = \"\") Then\r\n        MsgBox \"Missing INI Value parameter\"\r\n        Exit Sub\r\n    End If\r\n    \r\n    strKeyValue = Trim$(strKeyValue)\r\n    lngRetVal = WritePrivateProfileString(strSection, strKeyName, strKeyValue, strIniName)\r\n    \r\n    ClearINIValues\r\n    \r\n    Exit Sub\r\n    \r\nEnd Sub\r\n\r\nPrivate Sub Class_Initialize()\r\n    \r\n    ClearINIValues\r\n    Exit Sub\r\n    \r\nEnd Sub\r\n\r\n","Declares":"Declare Function GetPrivateProfileString Lib \"kernel32\" Alias \"GetPrivateProfileStringA\" (ByVal lpApplicationName As String, ByVal lpKeyName As Any, ByVal lpDefault As String, ByVal lpReturnedString As String, ByVal nSize As Long, ByVal lpFileName As String) As Long\r\nDeclare Function WritePrivateProfileString Lib \"kernel32\" Alias \"WritePrivateProfileStringA\" (ByVal lpApplicationName As String, ByVal lpKeyName As Any, ByVal lpString As Any, ByVal lpFileName As String) As Long\r\nDeclare Function GetPrivateProfileSection Lib \"kernel32\" Alias \"GetPrivateProfileSectionA\" (ByVal lpApplicationName As String, ByVal lpReturnedString As String, ByVal nSize As Long, ByVal lpFileName As String) As Long\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["INI","INI Class"]},{"RecordId":"60","Title":"Data Bound Class","Description":"Demonstrates how to create a class module that is bound to a datasource.\r\nThis example has 2 parts: A Class Module and a Form Module","Code":"'-----------------------------------------------------------------------\r\n'\r\n' Databound class sample (Part 1 of 2.  Part 2 is below.)\r\n'\r\n' NOTE: Set DataBindBehavior property of the class to vbSimpleBound\r\n'\r\n'-----------------------------------------------------------------------\r\n\r\nOption Explicit\r\n\r\nPrivate mBoundColumns As BindingCollection\r\n\r\nPrivate adc As New ADODB.Connection\r\nPrivate ars As New ADODB.Recordset\r\n\r\nPrivate strAccount_Branch As String\r\nPrivate strAccount_Base As String\r\nPrivate strAddress_Line_1 As String\r\nPrivate strAddress_Line_2 As String\r\n\r\nPublic Property Get Account_Base() As String\r\n\r\n\tAccount_Base = strAccount_Base\r\n\r\nEnd Property\r\n\r\nPublic Property Let Account_Base(ByVal Account_Base As String)\r\n\r\n\tstrAccount_Base = Account_Base\r\n\r\nEnd Property\r\n\r\nPublic Property Get Account_Branch() As String\r\n\r\n\tAccount_Branch = strAccount_Branch\r\n\r\nEnd Property\r\n\r\nPublic Property Let Account_Branch(ByVal Account_Branch As String)\r\n\r\n\tstrAccount_Branch = Account_Branch\r\n\r\nEnd Property\r\n\r\n\r\nPublic Property Get Address_Line_1() As String\r\n\r\n\tAddress_Line_1 = strAddress_Line_1\r\n\r\nEnd Property\r\n\r\nPublic Property Let Address_Line_1(ByVal Address_Line_1 As String)\r\n\r\n\tstrAddress_Line_1 = Address_Line_1\r\n\r\nEnd Property\r\n\r\nPublic Property Let Address_Line_2(ByVal Address_Line_2 As String)\r\n\r\n\tstrAddress_Line_2 = Address_Line_2\r\n\r\nEnd Property\r\n\r\nPublic Property Get Address_Line_2() As String\r\n\r\n\tAddress_Line_2 = strAddress_Line_2\r\n\r\nEnd Property\r\n\r\nPublic Sub MoveFirst()\r\n\r\n\tars.MoveFirst\r\n\r\nEnd Sub\r\n\r\nPublic Sub MoveLast()\r\n\r\n\tars.MoveLast\r\n\r\nEnd Sub\r\n\r\nPublic Sub MoveNext()\r\n\r\n    With ars\r\n        .MoveNext\r\n        If .EOF Then\r\n            .MoveLast\r\n        Else\r\n            If .BOF Then\r\n                .MoveFirst\r\n            End If\r\n        End If\r\n    End With\r\n            \r\nEnd Sub\r\n\r\nPublic Sub MovePrevious()\r\n\r\n    With ars\r\n        .MovePrevious\r\n        If .EOF Then\r\n            .MoveLast\r\n        Else\r\n            If .BOF Then\r\n                .MoveFirst\r\n            End If\r\n        End If\r\n    End With\r\n            \r\nEnd Sub\r\n\r\nPublic Property Let SQL_String(ByVal strSQL As String)\r\n\r\n\t' Open recordset\r\n\tadc.Open \"Provider=SQLOLEDB;Server=Develop2;uid=sa;pwd=;Database=CorpDB\"\r\n\tars.Open strSQL, adc, adOpenStatic, adLockReadOnly\r\n\r\n\t' Bind the recordset to the bindings collection\r\n\tSet mBoundColumns = New BindingCollection\r\n\tSet mBoundColumns.DataSource = ars\r\n\r\n\t' Bind each property in the class to the columns in the recordset\r\n\tmBoundColumns.Add Me, \"Account_Branch\", \"Account_Branch\"\r\n\tmBoundColumns.Add Me, \"Account_Base\", \"Account_Base\"\r\n\tmBoundColumns.Add Me, \"Address_Line_1\", \"Address_Line_1\"\r\n\tmBoundColumns.Add Me, \"Address_Line_2\", \"Address_Line_2\"\r\n\r\nEnd Property\r\n\r\nPrivate Sub Class_Terminate()\r\n\r\n\tars.Close\r\n\tadc.Close\r\n\tSet ars = Nothing\r\n\tSet adc = Nothing\r\n\r\nEnd Sub\r\n\r\n'-----------------------------------------------------------------------\r\n'\r\n' Form the uses the Data Bound Class example\r\n'\r\n'-----------------------------------------------------------------------\r\n\r\nOption Explicit\r\n\r\nPrivate oDBC As cDataBoundClass\r\n\r\nPrivate Sub FillFields()\r\n\r\n    txtAccount = oDBC.Account_Branch & \"-\" & oDBC.Account_Base\r\n    txtAddress1 = oDBC.Address_Line_1\r\n    txtAddress2 = oDBC.Address_Line_2\r\n\r\nEnd Sub\r\n\r\nPrivate Sub cmdFirst_Click()\r\n\r\n    oDBC.MoveFirst\r\n    FillFields\r\n\r\nEnd Sub\r\n\r\nPrivate Sub cmdLast_Click()\r\n    \r\n    oDBC.MoveLast\r\n    FillFields\r\n\r\nEnd Sub\r\n\r\n\r\nPrivate Sub cmdNext_Click()\r\n\r\n    oDBC.MoveNext\r\n    FillFields\r\n\r\nEnd Sub\r\n\r\nPrivate Sub cmdPrev_Click()\r\n\r\n    oDBC.MovePrevious\r\n    FillFields\r\n\r\nEnd Sub\r\n\r\nPrivate Sub Form_Load()\r\n\r\n    Dim strSQL As String\r\n    \r\n    strSQL = \"SELECT *\"\r\n    strSQL = strSQL & \" FROM v_Account\"\r\n    strSQL = strSQL & \" WHERE Account_Branch = '143'\"\r\n    strSQL = strSQL & \" ORDER BY Account_Branch, Account_Base\"\r\n    \r\n    Set oDBC = New cDataBoundClass\r\n    oDBC.SQL_String = strSQL\r\n    \r\n    FillFields\r\n    \r\nEnd Sub\r\n\r\nPrivate Sub Form_Unload(Cancel As Integer)\r\n\r\n    Set oDBC = Nothing\r\n\r\nEnd Sub\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["ADO","Data Bound Class"]},{"RecordId":"61","Title":"Always on Top (32-bit)","Description":"Forces a window to always be on top.","Code":"Say on Top\r\n        Call SetWindowPos(Me.hwnd, -1, 0, 0, 0, 0, 27)\r\n\r\nNormal\r\n        Call SetWindowPos(Me.hwnd, -2, 0, 0, 0, 0, 27)\r\n","Declares":"Declare Function SetWindowPos Lib \"user32\" (ByVal hwnd As Long, ByVal hWndInsertAfter As Long, ByVal x As Long, ByVal y As Long, ByVal cx As Long, ByVal cy As Long, ByVal wFlags As Long) As Long","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Top","Topmost","Float"]},{"RecordId":"62","Title":"CUSIP Check Digit Function","Description":"Computes a check digit for a cusip","Code":"Public Function CUSIP_CheckDigit(theCUSIP As String) As Integer\r\n\r\nConst cWeights = \"12121212\"\r\nConst cAlpha = 65   'the ascii value of \"A\"\r\nConst cAlphaBase = 10  'the new ascii value of \"A\"\r\n\r\nDim buf As String\r\nDim SumStr As String\r\nDim SumStrLen As Integer\r\nDim x As Integer\r\nDim Y As Integer\r\nDim i As Integer\r\n\r\nIf IsNull(theCUSIP) Or Len(Trim(theCUSIP)) < 8 Then\r\n    CUSIP_CheckDigit = -9\r\n    Exit Function\r\nEnd If\r\n\r\ntheCUSIP = UCase(theCUSIP)\r\n\r\nSumStr = \"\"\r\nFor i = 1 To 8  'we calculate only the first 8 characters\r\n    'one character at a time...\r\n    buf = Mid(theCUSIP, i, 1)\r\n    \r\n    'convert to int\r\n    If IsNumeric(buf) Then\r\n        x = CInt(buf)\r\n    Else\r\n        'convert alpha to base-10\r\n        x = (Asc(buf) - cAlpha) + cAlphaBase\r\n    End If\r\n\r\n    'now multiply that by the corresponding position in cWeights\r\n    Y = x * CInt(Mid(cWeights, i, 1))\r\n\r\n    'now convert that to a string and add it to the running buffer\r\n    SumStr = SumStr & Trim(Str(Y))\r\nNext\r\n        \r\n'now we add all the digits in SumStr\r\nSumStrLen = Len(SumStr)\r\nY = 0\r\nFor i = 1 To SumStrLen\r\n    Y = Y + Val(Mid(SumStr, i, 1))\r\nNext\r\n\r\n'y is now the total of all digits in SumStr\r\n' and we want the last digit in that sum\r\nx = CInt(Right(Str(Y), 1))\r\n    \r\n'the complement of x is the answer\r\nCUSIP_CheckDigit = IIf(x = 0, 0, (10 - x))\r\n\r\nEnd Function\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Check Digit","Cusip Check Digit"]},{"RecordId":"63","Title":"File Exists","Description":"The Exists() function returns a value of TRUE if the specified file exists, or FALSE if it doesn't.\r\n","Code":"Function Exists (F$) as Integer\r\nDim X&\r\nOn Error Resume Next\r\nX = FileLen(F$)\r\nIf X Then Exists = True\r\nEnd Function\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["File Exists","Exists"]},{"RecordId":"66","Title":"Find Window (Windows Task List Loop)","Description":"Loops through windows master task list looking for the main window handle of an application's instance.","Code":"Function GetHWndByInst (hInstFind%) As Integer\r\n\r\n'This function is used to find the main window handle of an application\r\n'You must pass the instance of the application (as if it was called from Shell or WinExec)\r\n\r\n    Dim hWndTmp%\r\n\r\n    'Loop through windows master task list\r\n    hWndTmp = FindWindow(0&, 0&)\r\n    Do Until hWndTmp = 0\r\n\r\n\t'Only look at parent windows\r\n        If GetParent(hWndTmp) = 0 Then\r\n\r\n\t    'Is this the one?\t\t\r\n            If hInstFind% = GetWindowWord(hWndTmp, GWW_HINSTANCE) Then\r\n                GetHWndByInst = hWndTmp\r\n                Exit Do\r\n            End If\r\n        End If\r\n        hWndTmp = GetWindow(hWndTmp, GW_HWNDNEXT)\r\n    Loop\r\nEnd Function\r\n","Declares":"Declare Function FindWindow Lib \"User\" (ByVal lpClassName As Any, ByVal lpWindowName As Any) As Integer\r\nDeclare Function GetParent Lib \"User\" (ByVal hWnd%) As Integer\r\nDeclare Function GetWindowWord Lib \"User\" (ByVal hWnd%, ByVal nIndex%) As Integer\r\nDeclare Function GetWindow Lib \"User\" (ByVal hWnd%, ByVal wCmd%) As Integer\r\n\r\nConst GW_HWNDNEXT = 2\r\nConst GWW_HINSTANCE = -6","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Find Window"]},{"RecordId":"69","Title":"Hiding The Menu Bar Dynamically","Description":"This routine allows you the dynamically remove the title bar from a VB form.  Patterned after the PC Tech column in PC Magazine 6/14/94. Volume 13, Number 11","Code":"Sub TitleBar (frm As Form, ShowTitle)\r\n   Static Oldhmenu, SavedStyle&\r\n   Dim NewStyle&, t&\r\n   If ShowTitle Then\r\n      'get the current style attributes\r\n      NewStyle& = GetWindowLong&(frm.hWnd, GWL_STYLE)\r\n      'set only the attributes that were removed earlier\r\n      NewStyle& = NewStyle& Or SavedStyle&\r\n      're-establish the menu\r\n      If Oldhmenu <> 0 Then\r\n         t& = SetWindowWord%(frm.hWnd, GWW_ID, Oldhmenu)\r\n      End If\r\n      'set the new style\r\n      t& = SetWindowLong&(frm.hWnd, GWL_STYLE, NewStyle&)\r\n      'force VB to update the form\r\n      frm.Left = frm.Left\r\n      frm.Refresh\r\n   Else\r\n      'get the current style attributes\r\n      NewStyle& = GetWindowLong&(frm.hWnd, GWL_STYLE)\r\n      'determine whether the form has a dialog frame, a ControlBox,\r\n      'a minimize button, or a maximize button and save this info.\r\n      'for later use\r\n      SavedStyle& = 0\r\n      SavedStyle& = SavedStyle& Or (NewStyle& And WS_DLGFRAME)\r\n      SavedStyle& = SavedStyle& Or (NewStyle& And WS_SYSMENU)\r\n      SavedStyle& = SavedStyle& Or (NewStyle& And WS_MINIMIZEBOX)\r\n      SavedStyle& = SavedStyle& Or (NewStyle& And WS_MAXIMIZEBOX)\r\n      'remove the attributes for a dialog frame, a ControlBox, a minimize\r\n      'button and a maximize button\r\n      NewStyle& = NewStyle& And Not WS_DLGFRAME\r\n      NewStyle& = NewStyle& And Not WS_SYSMENU\r\n      NewStyle& = NewStyle& And Not WS_MINIMIZEBOX\r\n      NewStyle& = NewStyle& And Not WS_MAXIMIZEBOX\r\n      'is there a menu associated with this form?\r\n      Oldhmenu = GetWindowWord%(frm.hWnd, GWW_ID)\r\n      If Oldhmenu <> 0 Then\r\n         'yes-zero it the menu handle\r\n         t& = SetWindowWord%(frm.hWnd, GWW_ID, 0)\r\n      End If\r\n      'set the new style\r\n      t& = SetWindowLong&(frm.hWnd, GWL_STYLE, NewStyle&)\r\n      'force VB to update the form and get rid of the title bar\r\n      frm.Left = frm.Left\r\n      frm.Refresh\r\n   End If\r\nEnd Sub\r\n","Declares":"' Syntax:\r\n'    TitleBar Form1, False        This will remove the title bar\r\n'    TitleBar Form1, True         This will restore the title bar\r\n'=================================================================\r\n \r\nDefInt A-Z\r\nOption Explicit\r\n \r\nDeclare Function GetWindowWord% Lib \"User\" (ByVal hWnd%, ByVal nIndex%)\r\nDeclare Function SetWindowWord% Lib \"User\" (ByVal hWnd%, ByVal nIndex%, ByVal w\r\nNewWord%)\r\nDeclare Function GetWindowLong& Lib \"User\" (ByVal hWnd%, ByVal nIndex%)\r\nDeclare Function SetWindowLong& Lib \"User\" (ByVal hWnd%, ByVal nIndex%, ByVal d\r\nwNewLong&)\r\n \r\nConst GWW_ID = (-12)\r\nConst GWL_STYLE = (-16)\r\n \r\nConst WS_DLGFRAME = &H400000\r\nConst WS_SYSMENU = &H80000\r\nConst WS_MINIMIZEBOX = &H20000\r\nConst WS_MAXIMIZEBOX = &H10000\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Hide Menu Bar","Menu"]},{"RecordId":"70","Title":"Find Window (partial or contains)","Description":"Searches the windows task list for a window that either contains or starts with the search string.","Code":"Function FindWindowPartial (ByVal TitlePart As String, Method As Integer) As Integer\r\n\r\n'Loops through windows task list looking for a window that either starts with or contains\r\n'the incoming parm.\r\n\r\n    Dim hWndTmp As Integer, nRet As Integer, TitleTmp As String\r\n    \r\n    TitlePart = UCase(TitlePart)\r\n    'Find first window\r\n    hWndTmp = FindWindow(0&, 0&)\r\n    \r\n    'Loop through all windows\r\n    Do Until hWndTmp = 0\r\n    \r\n        'Only consider parents\r\n        If GetParent(hWndTmp) = 0 Then\r\n            \r\n            TitleTmp = Space(256)\r\n            nRet = GetWindowText(hWndTmp, TitleTmp, Len(TitleTmp))\r\n            If nRet Then\r\n                \r\n                'Compare the windows text with the search string\r\n                TitleTmp = UCase(Left(TitleTmp, nRet))\r\n                \r\n                Select Case Method\r\n                    \r\n                    Case FWP_STARTSWITH\r\n                        If InStr(TitleTmp, TitlePart) = 1 Then\r\n                            FindWindowPartial = hWndTmp\r\n                            Exit Do        'Found it...\r\n                        End If\r\n                    \r\n                    Case FWP_CONTAINS\r\n                        If InStr(TitleTmp, TitlePart) Then\r\n                            FinwWindowPartial = hWndTmp\r\n                            Exit Do        'Found it...\r\n                        End If\r\n                End Select\r\n            End If\r\n        End If\r\n        \r\n        'Get next window\r\n        hWndTmp = GetWindow(hWndTmp, GW_HWNDNEXT)\r\n    Loop\r\n\r\nEnd Function\r\n\r\n\r\nSub AppActivatePartial (TitleContains As String, Method As Integer)\r\n\r\n    'Activates first top-level window that starts with of contains the passed string\r\n    \r\n    Dim hWndApp As Integer, nRet As Integer\r\n    \r\n    hWndApp = FindWindowPartial(TitleContains, Method)\r\n    If hWndApp Then\r\n        nRet = SetActiveWindow(hWndApp)\r\n    Else\r\n        MsgBox \"No matching apps found\"\r\n    End If\r\n\r\nEnd Sub","Declares":"Declare Function FindWindow Lib \"User\" (ByVal lpClassName As Any, ByVal lpWindowName As Any) As Integer\r\nDeclare Function SetActiveWindow Lib \"User\" (ByVal hWnd As Integer) As Integer\r\nDeclare Function GetWindow Lib \"User\" (ByVal hWnd As Integer, ByVal wCmd As Integer) As Integer\r\nDeclare Function GetWindowText Lib \"User\" (ByVal hWnd As Integer, ByVal lpString As String, ByVal aint As Integer) As Integer\r\nDeclare Function GetParent Lib \"User\" (ByVal hWnd As Integer) As Integer\r\n\r\nGlobal Const GW_HWNDNEXT = 2\r\nGlobal Const FWP_STARTSWITH = 0\r\nGlobal Const FWP_CONTAINS = 1\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Find Window"]},{"RecordId":"71","Title":"Quick Sort Routines","Description":"Sorts arrays of various types (single, integer, etc) either ascending or descending\r\nNOTE:  Works best if array is not sorted","Code":"\r\n' - - - To sort ascending, call with:              QuickSortAny Ar(), , False\r\n' - - - To sort descending, call with:            QuickSortAny Ar(), , True\r\n' - - - Replace \"QuickSortAny\" with \"QuickSortx\" where x is the array type for the specific sort routine\r\n\r\nAttribute VB_Name = \"QuickSort\"\r\nOption Explicit\r\n\r\nSub QuickSortAny(arr As Variant, Optional ByVal numEls As Variant, Optional ByVal descending As Variant)\r\n\r\n    '-----------------------------------\r\n    ' Quicksort of an array of Any type\r\n    '-----------------------------------\r\n\r\n    Dim sp As Integer\r\n    Dim leftStk(32) As Long, rightStk(32) As Long\r\n    Dim leftNdx As Long, rightNdx As Long\r\n    Dim inverseOrder As Boolean\r\n    Dim i As Long, j As Long\r\n    Dim value As Variant, temp As Variant\r\n    \r\n    ' exit if it is not an arr\r\n    If VarType(arr) < vbArray Then Exit Sub\r\n\r\n    ' account for optional arguments\r\n    If IsMissing(numEls) Then numEls = UBound(arr)\r\n    If IsMissing(descending) Then descending = False\r\n    inverseOrder = (descending <> False)\r\n\r\n    ' init pointers\r\n    leftNdx = LBound(arr)\r\n    rightNdx = numEls\r\n    ' init stack\r\n    sp = 1\r\n    leftStk(sp) = leftNdx\r\n    rightStk(sp) = rightNdx\r\n\r\n    Do\r\n        If rightNdx > leftNdx Then\r\n            \r\n            value = arr(rightNdx)\r\n            i = leftNdx - 1\r\n            j = rightNdx\r\n\r\n            ' find the pivot item\r\n            If descending Then\r\n                Do\r\n                    Do: i = i + 1: Loop Until arr(i) <= value\r\n                    Do: j = j - 1: Loop Until j = leftNdx Or arr(j) >= value\r\n                    temp = arr(i)\r\n                    arr(i) = arr(j)\r\n                    arr(j) = temp\r\n                Loop Until j <= i\r\n            Else\r\n                Do\r\n                    Do: i = i + 1: Loop Until arr(i) >= value\r\n                    Do: j = j - 1: Loop Until j = leftNdx Or arr(j) <= value\r\n                    temp = arr(i)\r\n                    arr(i) = arr(j)\r\n                    arr(j) = temp\r\n                Loop Until j <= i\r\n            End If\r\n\r\n            ' swap found items\r\n            temp = arr(j)\r\n            arr(j) = arr(i)\r\n            arr(i) = arr(rightNdx)\r\n            arr(rightNdx) = temp\r\n\r\n            ' push on the stack the pair of pointers\r\n            ' that differ most\r\n            sp = sp + 1\r\n            If (i - leftNdx) > (rightNdx - i) Then\r\n                leftStk(sp) = leftNdx\r\n                rightStk(sp) = i - 1\r\n                leftNdx = i + 1\r\n            Else\r\n                leftStk(sp) = i + 1\r\n                rightStk(sp) = rightNdx\r\n                rightNdx = i - 1\r\n            End If\r\n        Else\r\n            ' pop a new pair of pointers off the stacks\r\n            leftNdx = leftStk(sp)\r\n            rightNdx = rightStk(sp)\r\n            sp = sp - 1\r\n            If sp = 0 Then Exit Do\r\n        End If\r\n\r\n    Loop\r\n\r\nEnd Sub\r\n\r\n\r\nSub QuickSortI(arr() As Integer, Optional ByVal numEls As Variant, Optional ByVal descending As Variant)\r\n\r\n    '-----------------------------------\r\n    ' Quicksort of an array of integers\r\n    '-----------------------------------\r\n\r\n    Dim sp As Integer\r\n    Dim leftStk(32) As Long, rightStk(32) As Long\r\n    Dim leftNdx As Long, rightNdx As Long\r\n    Dim inverseOrder As Boolean\r\n    Dim i As Long, j As Long\r\n    Dim value As Integer, temp As Integer\r\n    \r\n    ' account for optional arguments\r\n    If IsMissing(numEls) Then numEls = UBound(arr)\r\n    If IsMissing(descending) Then descending = False\r\n    inverseOrder = (descending <> False)\r\n\r\n    ' init pointers\r\n    leftNdx = LBound(arr)\r\n    rightNdx = numEls\r\n    ' init stack\r\n    sp = 1\r\n    leftStk(sp) = leftNdx\r\n    rightStk(sp) = rightNdx\r\n\r\n    Do\r\n        If rightNdx > leftNdx Then\r\n            \r\n            value = arr(rightNdx)\r\n            i = leftNdx - 1\r\n            j = rightNdx\r\n\r\n            ' find the pivot item\r\n            If descending Then\r\n                Do\r\n                    Do: i = i + 1: Loop Until arr(i) <= value\r\n                    Do: j = j - 1: Loop Until j = leftNdx Or arr(j) >= value\r\n                    temp = arr(i)\r\n                    arr(i) = arr(j)\r\n                    arr(j) = temp\r\n                Loop Until j <= i\r\n            Else\r\n                Do\r\n                    Do: i = i + 1: Loop Until arr(i) >= value\r\n                    Do: j = j - 1: Loop Until j = leftNdx Or arr(j) <= value\r\n                    temp = arr(i)\r\n                    arr(i) = arr(j)\r\n                    arr(j) = temp\r\n                Loop Until j <= i\r\n            End If\r\n\r\n            ' swap found items\r\n            temp = arr(j)\r\n            arr(j) = arr(i)\r\n            arr(i) = arr(rightNdx)\r\n            arr(rightNdx) = temp\r\n\r\n            ' push on the stack the pair of pointers\r\n            ' that differ most\r\n            sp = sp + 1\r\n            If (i - leftNdx) > (rightNdx - i) Then\r\n                leftStk(sp) = leftNdx\r\n                rightStk(sp) = i - 1\r\n                leftNdx = i + 1\r\n            Else\r\n                leftStk(sp) = i + 1\r\n                rightStk(sp) = rightNdx\r\n                rightNdx = i - 1\r\n            End If\r\n        Else\r\n            ' pop a new pair of pointers off the stacks\r\n            leftNdx = leftStk(sp)\r\n            rightNdx = rightStk(sp)\r\n            sp = sp - 1\r\n            If sp = 0 Then Exit Do\r\n        End If\r\n\r\n    Loop\r\n\r\nEnd Sub\r\n\r\nSub QuickSortL(arr() As Long, Optional ByVal numEls As Variant, Optional ByVal descending As Variant)\r\n\r\n    '-----------------------------------\r\n    ' Quicksort of an array of long\r\n    '-----------------------------------\r\n\r\n    Dim sp As Integer\r\n    Dim leftStk(32) As Long, rightStk(32) As Long\r\n    Dim leftNdx As Long, rightNdx As Long\r\n    Dim inverseOrder As Boolean\r\n    Dim i As Long, j As Long\r\n    Dim value As Long, temp As Long\r\n    \r\n    ' account for optional arguments\r\n    If IsMissing(numEls) Then numEls = UBound(arr)\r\n    If IsMissing(descending) Then descending = False\r\n    inverseOrder = (descending <> False)\r\n\r\n    ' init pointers\r\n    leftNdx = LBound(arr)\r\n    rightNdx = numEls\r\n    ' init stack\r\n    sp = 1\r\n    leftStk(sp) = leftNdx\r\n    rightStk(sp) = rightNdx\r\n\r\n    Do\r\n        If rightNdx > leftNdx Then\r\n            \r\n            value = arr(rightNdx)\r\n            i = leftNdx - 1\r\n            j = rightNdx\r\n\r\n            ' find the pivot item\r\n            If descending Then\r\n                Do\r\n                    Do: i = i + 1: Loop Until arr(i) <= value\r\n                    Do: j = j - 1: Loop Until j = leftNdx Or arr(j) >= value\r\n                    temp = arr(i)\r\n                    arr(i) = arr(j)\r\n                    arr(j) = temp\r\n                Loop Until j <= i\r\n            Else\r\n                Do\r\n                    Do: i = i + 1: Loop Until arr(i) >= value\r\n                    Do: j = j - 1: Loop Until j = leftNdx Or arr(j) <= value\r\n                    temp = arr(i)\r\n                    arr(i) = arr(j)\r\n                    arr(j) = temp\r\n                Loop Until j <= i\r\n            End If\r\n\r\n            ' swap found items\r\n            temp = arr(j)\r\n            arr(j) = arr(i)\r\n            arr(i) = arr(rightNdx)\r\n            arr(rightNdx) = temp\r\n\r\n            ' push on the stack the pair of pointers\r\n            ' that differ most\r\n            sp = sp + 1\r\n            If (i - leftNdx) > (rightNdx - i) Then\r\n                leftStk(sp) = leftNdx\r\n                rightStk(sp) = i - 1\r\n                leftNdx = i + 1\r\n            Else\r\n                leftStk(sp) = i + 1\r\n                rightStk(sp) = rightNdx\r\n                rightNdx = i - 1\r\n            End If\r\n        Else\r\n            ' pop a new pair of pointers off the stacks\r\n            leftNdx = leftStk(sp)\r\n            rightNdx = rightStk(sp)\r\n            sp = sp - 1\r\n            If sp = 0 Then Exit Do\r\n        End If\r\n\r\n    Loop\r\n\r\nEnd Sub\r\n\r\nSub QuickSortS(arr() As Single, Optional ByVal numEls As Variant, Optional ByVal descending As Variant)\r\n\r\n    '-----------------------------------\r\n    ' Quicksort of an array of Single\r\n    '-----------------------------------\r\n\r\n    Dim sp As Integer\r\n    Dim leftStk(32) As Long, rightStk(32) As Long\r\n    Dim leftNdx As Long, rightNdx As Long\r\n    Dim inverseOrder As Boolean\r\n    Dim i As Long, j As Long\r\n    Dim value As Single, temp As Single\r\n    \r\n    ' account for optional arguments\r\n    If IsMissing(numEls) Then numEls = UBound(arr)\r\n    If IsMissing(descending) Then descending = False\r\n    inverseOrder = (descending <> False)\r\n\r\n    ' init pointers\r\n    leftNdx = LBound(arr)\r\n    rightNdx = numEls\r\n    ' init stack\r\n    sp = 1\r\n    leftStk(sp) = leftNdx\r\n    rightStk(sp) = rightNdx\r\n\r\n    Do\r\n        If rightNdx > leftNdx Then\r\n            \r\n            value = arr(rightNdx)\r\n            i = leftNdx - 1\r\n            j = rightNdx\r\n\r\n            ' find the pivot item\r\n            If descending Then\r\n                Do\r\n                    Do: i = i + 1: Loop Until arr(i) <= value\r\n                    Do: j = j - 1: Loop Until j = leftNdx Or arr(j) >= value\r\n                    temp = arr(i)\r\n                    arr(i) = arr(j)\r\n                    arr(j) = temp\r\n                Loop Until j <= i\r\n            Else\r\n                Do\r\n                    Do: i = i + 1: Loop Until arr(i) >= value\r\n                    Do: j = j - 1: Loop Until j = leftNdx Or arr(j) <= value\r\n                    temp = arr(i)\r\n                    arr(i) = arr(j)\r\n                    arr(j) = temp\r\n                Loop Until j <= i\r\n            End If\r\n\r\n            ' swap found items\r\n            temp = arr(j)\r\n            arr(j) = arr(i)\r\n            arr(i) = arr(rightNdx)\r\n            arr(rightNdx) = temp\r\n\r\n            ' push on the stack the pair of pointers\r\n            ' that differ most\r\n            sp = sp + 1\r\n            If (i - leftNdx) > (rightNdx - i) Then\r\n                leftStk(sp) = leftNdx\r\n                rightStk(sp) = i - 1\r\n                leftNdx = i + 1\r\n            Else\r\n                leftStk(sp) = i + 1\r\n                rightStk(sp) = rightNdx\r\n                rightNdx = i - 1\r\n            End If\r\n        Else\r\n            ' pop a new pair of pointers off the stacks\r\n            leftNdx = leftStk(sp)\r\n            rightNdx = rightStk(sp)\r\n            sp = sp - 1\r\n            If sp = 0 Then Exit Do\r\n        End If\r\n\r\n    Loop\r\n\r\nEnd Sub\r\n\r\nSub QuickSortD(arr() As Double, Optional ByVal numEls As Variant, Optional ByVal descending As Variant)\r\n\r\n    '-----------------------------------\r\n    ' Quicksort of an array of Double\r\n    '-----------------------------------\r\n\r\n    Dim sp As Integer\r\n    Dim leftStk(32) As Long, rightStk(32) As Long\r\n    Dim leftNdx As Long, rightNdx As Long\r\n    Dim inverseOrder As Boolean\r\n    Dim i As Long, j As Long\r\n    Dim value As Double, temp As Double\r\n    \r\n    ' account for optional arguments\r\n    If IsMissing(numEls) Then numEls = UBound(arr)\r\n    If IsMissing(descending) Then descending = False\r\n    inverseOrder = (descending <> False)\r\n\r\n    ' init pointers\r\n    leftNdx = LBound(arr)\r\n    rightNdx = numEls\r\n    ' init stack\r\n    sp = 1\r\n    leftStk(sp) = leftNdx\r\n    rightStk(sp) = rightNdx\r\n\r\n    Do\r\n        If rightNdx > leftNdx Then\r\n            \r\n            value = arr(rightNdx)\r\n            i = leftNdx - 1\r\n            j = rightNdx\r\n\r\n            ' find the pivot item\r\n            If descending Then\r\n                Do\r\n                    Do: i = i + 1: Loop Until arr(i) <= value\r\n                    Do: j = j - 1: Loop Until j = leftNdx Or arr(j) >= value\r\n                    temp = arr(i)\r\n                    arr(i) = arr(j)\r\n                    arr(j) = temp\r\n                Loop Until j <= i\r\n            Else\r\n                Do\r\n                    Do: i = i + 1: Loop Until arr(i) >= value\r\n                    Do: j = j - 1: Loop Until j = leftNdx Or arr(j) <= value\r\n                    temp = arr(i)\r\n                    arr(i) = arr(j)\r\n                    arr(j) = temp\r\n                Loop Until j <= i\r\n            End If\r\n\r\n            ' swap found items\r\n            temp = arr(j)\r\n            arr(j) = arr(i)\r\n            arr(i) = arr(rightNdx)\r\n            arr(rightNdx) = temp\r\n\r\n            ' push on the stack the pair of pointers\r\n            ' that differ most\r\n            sp = sp + 1\r\n            If (i - leftNdx) > (rightNdx - i) Then\r\n                leftStk(sp) = leftNdx\r\n                rightStk(sp) = i - 1\r\n                leftNdx = i + 1\r\n            Else\r\n                leftStk(sp) = i + 1\r\n                rightStk(sp) = rightNdx\r\n                rightNdx = i - 1\r\n            End If\r\n        Else\r\n            ' pop a new pair of pointers off the stacks\r\n            leftNdx = leftStk(sp)\r\n            rightNdx = rightStk(sp)\r\n            sp = sp - 1\r\n            If sp = 0 Then Exit Do\r\n        End If\r\n\r\n    Loop\r\n\r\nEnd Sub\r\n\r\nSub QuickSortC(arr() As Currency, Optional ByVal numEls As Variant, Optional ByVal descending As Variant)\r\n\r\n    '-----------------------------------\r\n    ' Quicksort of an array of Currency\r\n    '-----------------------------------\r\n\r\n    Dim sp As Integer\r\n    Dim leftStk(32) As Long, rightStk(32) As Long\r\n    Dim leftNdx As Long, rightNdx As Long\r\n    Dim inverseOrder As Boolean\r\n    Dim i As Long, j As Long\r\n    Dim value As Currency, temp As Currency\r\n    \r\n    ' account for optional arguments\r\n    If IsMissing(numEls) Then numEls = UBound(arr)\r\n    If IsMissing(descending) Then descending = False\r\n    inverseOrder = (descending <> False)\r\n\r\n    ' init pointers\r\n    leftNdx = LBound(arr)\r\n    rightNdx = numEls\r\n    ' init stack\r\n    sp = 1\r\n    leftStk(sp) = leftNdx\r\n    rightStk(sp) = rightNdx\r\n\r\n    Do\r\n        If rightNdx > leftNdx Then\r\n            \r\n            value = arr(rightNdx)\r\n            i = leftNdx - 1\r\n            j = rightNdx\r\n\r\n            ' find the pivot item\r\n            If descending Then\r\n                Do\r\n                    Do: i = i + 1: Loop Until arr(i) <= value\r\n                    Do: j = j - 1: Loop Until j = leftNdx Or arr(j) >= value\r\n                    temp = arr(i)\r\n                    arr(i) = arr(j)\r\n                    arr(j) = temp\r\n                Loop Until j <= i\r\n            Else\r\n                Do\r\n                    Do: i = i + 1: Loop Until arr(i) >= value\r\n                    Do: j = j - 1: Loop Until j = leftNdx Or arr(j) <= value\r\n                    temp = arr(i)\r\n                    arr(i) = arr(j)\r\n                    arr(j) = temp\r\n                Loop Until j <= i\r\n            End If\r\n\r\n            ' swap found items\r\n            temp = arr(j)\r\n            arr(j) = arr(i)\r\n            arr(i) = arr(rightNdx)\r\n            arr(rightNdx) = temp\r\n\r\n            ' push on the stack the pair of pointers\r\n            ' that differ most\r\n            sp = sp + 1\r\n            If (i - leftNdx) > (rightNdx - i) Then\r\n                leftStk(sp) = leftNdx\r\n                rightStk(sp) = i - 1\r\n                leftNdx = i + 1\r\n            Else\r\n                leftStk(sp) = i + 1\r\n                rightStk(sp) = rightNdx\r\n                rightNdx = i - 1\r\n            End If\r\n        Else\r\n            ' pop a new pair of pointers off the stacks\r\n            leftNdx = leftStk(sp)\r\n            rightNdx = rightStk(sp)\r\n            sp = sp - 1\r\n            If sp = 0 Then Exit Do\r\n        End If\r\n\r\n    Loop\r\n\r\nEnd Sub\r\n\r\nSub QuickSortDate(arr() As Date, Optional ByVal numEls As Variant, Optional ByVal descending As Variant)\r\n\r\n    '-----------------------------------\r\n    ' Quicksort of an array of Date\r\n    '-----------------------------------\r\n\r\n    Dim sp As Integer\r\n    Dim leftStk(32) As Long, rightStk(32) As Long\r\n    Dim leftNdx As Long, rightNdx As Long\r\n    Dim inverseOrder As Boolean\r\n    Dim i As Long, j As Long\r\n    Dim value As Date, temp As Date\r\n    \r\n    ' account for optional arguments\r\n    If IsMissing(numEls) Then numEls = UBound(arr)\r\n    If IsMissing(descending) Then descending = False\r\n    inverseOrder = (descending <> False)\r\n\r\n    ' init pointers\r\n    leftNdx = LBound(arr)\r\n    rightNdx = numEls\r\n    ' init stack\r\n    sp = 1\r\n    leftStk(sp) = leftNdx\r\n    rightStk(sp) = rightNdx\r\n\r\n    Do\r\n        If rightNdx > leftNdx Then\r\n            \r\n            value = arr(rightNdx)\r\n            i = leftNdx - 1\r\n            j = rightNdx\r\n\r\n            ' find the pivot item\r\n            If descending Then\r\n                Do\r\n                    Do: i = i + 1: Loop Until arr(i) <= value\r\n                    Do: j = j - 1: Loop Until j = leftNdx Or arr(j) >= value\r\n                    temp = arr(i)\r\n                    arr(i) = arr(j)\r\n                    arr(j) = temp\r\n                Loop Until j <= i\r\n            Else\r\n                Do\r\n                    Do: i = i + 1: Loop Until arr(i) >= value\r\n                    Do: j = j - 1: Loop Until j = leftNdx Or arr(j) <= value\r\n                    temp = arr(i)\r\n                    arr(i) = arr(j)\r\n                    arr(j) = temp\r\n                Loop Until j <= i\r\n            End If\r\n\r\n            ' swap found items\r\n            temp = arr(j)\r\n            arr(j) = arr(i)\r\n            arr(i) = arr(rightNdx)\r\n            arr(rightNdx) = temp\r\n\r\n            ' push on the stack the pair of pointers\r\n            ' that differ most\r\n            sp = sp + 1\r\n            If (i - leftNdx) > (rightNdx - i) Then\r\n                leftStk(sp) = leftNdx\r\n                rightStk(sp) = i - 1\r\n                leftNdx = i + 1\r\n            Else\r\n                leftStk(sp) = i + 1\r\n                rightStk(sp) = rightNdx\r\n                rightNdx = i - 1\r\n            End If\r\n        Else\r\n            ' pop a new pair of pointers off the stacks\r\n            leftNdx = leftStk(sp)\r\n            rightNdx = rightStk(sp)\r\n            sp = sp - 1\r\n            If sp = 0 Then Exit Do\r\n        End If\r\n\r\n    Loop\r\n\r\nEnd Sub\r\n\r\nSub QuickSortStr(arr() As String, Optional ByVal numEls As Variant, Optional ByVal descending As Variant)\r\n\r\n    '-----------------------------------\r\n    ' Quicksort of an array of String\r\n    ' Case-sensitive version\r\n    '-----------------------------------\r\n\r\n    Dim sp As Integer\r\n    Dim leftStk(32) As Long, rightStk(32) As Long\r\n    Dim leftNdx As Long, rightNdx As Long\r\n    Dim inverseOrder As Boolean\r\n    Dim i As Long, j As Long\r\n    Dim value As String, temp As String\r\n    \r\n    ' account for optional arguments\r\n    If IsMissing(numEls) Then numEls = UBound(arr)\r\n    If IsMissing(descending) Then descending = False\r\n    inverseOrder = (descending <> False)\r\n\r\n    ' init pointers\r\n    leftNdx = LBound(arr)\r\n    rightNdx = numEls\r\n    ' init stack\r\n    sp = 1\r\n    leftStk(sp) = leftNdx\r\n    rightStk(sp) = rightNdx\r\n\r\n    Do\r\n        If rightNdx > leftNdx Then\r\n            \r\n            value = arr(rightNdx)\r\n            i = leftNdx - 1\r\n            j = rightNdx\r\n\r\n            ' find the pivot item\r\n            If descending Then\r\n                Do\r\n                    Do: i = i + 1: Loop Until arr(i) <= value\r\n                    Do: j = j - 1: Loop Until j = leftNdx Or arr(j) >= value\r\n                    temp = arr(i)\r\n                    arr(i) = arr(j)\r\n                    arr(j) = temp\r\n                Loop Until j <= i\r\n            Else\r\n                Do\r\n                    Do: i = i + 1: Loop Until arr(i) >= value\r\n                    Do: j = j - 1: Loop Until j = leftNdx Or arr(j) <= value\r\n                    temp = arr(i)\r\n                    arr(i) = arr(j)\r\n                    arr(j) = temp\r\n                Loop Until j <= i\r\n            End If\r\n\r\n            ' swap found items\r\n            temp = arr(j)\r\n            arr(j) = arr(i)\r\n            arr(i) = arr(rightNdx)\r\n            arr(rightNdx) = temp\r\n\r\n            ' push on the stack the pair of pointers\r\n            ' that differ most\r\n            sp = sp + 1\r\n            If (i - leftNdx) > (rightNdx - i) Then\r\n                leftStk(sp) = leftNdx\r\n                rightStk(sp) = i - 1\r\n                leftNdx = i + 1\r\n            Else\r\n                leftStk(sp) = i + 1\r\n                rightStk(sp) = rightNdx\r\n                rightNdx = i - 1\r\n            End If\r\n        Else\r\n            ' pop a new pair of pointers off the stacks\r\n            leftNdx = leftStk(sp)\r\n            rightNdx = rightStk(sp)\r\n            sp = sp - 1\r\n            If sp = 0 Then Exit Do\r\n        End If\r\n\r\n    Loop\r\n\r\nEnd Sub\r\n\r\nSub QuickSortStrC(arr() As String, Optional ByVal numEls As Variant, Optional ByVal descending As Variant)\r\n\r\n    '-----------------------------------\r\n    ' Quicksort of an array of String\r\n    ' Case-unsensitive version\r\n    '-----------------------------------\r\n\r\n    Dim sp As Integer\r\n    Dim leftStk(32) As Long, rightStk(32) As Long\r\n    Dim leftNdx As Long, rightNdx As Long\r\n    Dim inverseOrder As Boolean\r\n    Dim i As Long, j As Long\r\n    Dim temp As String, valueLC As String\r\n    \r\n    ' account for optional arguments\r\n    If IsMissing(numEls) Then numEls = UBound(arr)\r\n    If IsMissing(descending) Then descending = False\r\n    inverseOrder = (descending <> False)\r\n\r\n    ' init pointers\r\n    leftNdx = LBound(arr)\r\n    rightNdx = numEls\r\n    ' init stack\r\n    sp = 1\r\n    leftStk(sp) = leftNdx\r\n    rightStk(sp) = rightNdx\r\n\r\n    Do\r\n        If rightNdx > leftNdx Then\r\n            \r\n            valueLC = LCase$(arr(rightNdx))\r\n            i = leftNdx - 1\r\n            j = rightNdx\r\n\r\n            ' find the pivot item\r\n            If descending Then\r\n                Do\r\n                    Do: i = i + 1: Loop Until LCase$(arr(i)) <= valueLC\r\n                    Do: j = j - 1: Loop Until j = leftNdx Or LCase$(arr(j)) >= valueLC\r\n                    temp = arr(i)\r\n                    arr(i) = arr(j)\r\n                    arr(j) = temp\r\n                Loop Until j <= i\r\n            Else\r\n                Do\r\n                    Do: i = i + 1: Loop Until LCase$(arr(i)) >= valueLC\r\n                    Do: j = j - 1: Loop Until j = leftNdx Or LCase$(arr(j)) <= valueLC\r\n                    temp = arr(i)\r\n                    arr(i) = arr(j)\r\n                    arr(j) = temp\r\n                Loop Until j <= i\r\n            End If\r\n\r\n            ' swap found items\r\n            temp = arr(j)\r\n            arr(j) = arr(i)\r\n            arr(i) = arr(rightNdx)\r\n            arr(rightNdx) = temp\r\n\r\n            ' push on the stack the pair of pointers\r\n            ' that differ most\r\n            sp = sp + 1\r\n            If (i - leftNdx) > (rightNdx - i) Then\r\n                leftStk(sp) = leftNdx\r\n                rightStk(sp) = i - 1\r\n                leftNdx = i + 1\r\n            Else\r\n                leftStk(sp) = i + 1\r\n                rightStk(sp) = rightNdx\r\n                rightNdx = i - 1\r\n            End If\r\n        Else\r\n            ' pop a new pair of pointers off the stacks\r\n            leftNdx = leftStk(sp)\r\n            rightNdx = rightStk(sp)\r\n            sp = sp - 1\r\n            If sp = 0 Then Exit Do\r\n        End If\r\n\r\n    Loop\r\n\r\nEnd Sub\r\n\r\nSub QuickSortV(arr() As Variant, Optional ByVal numEls As Variant, Optional ByVal descending As Variant)\r\n\r\n    '-----------------------------------\r\n    ' Quicksort of an array of Variant\r\n    '-----------------------------------\r\n\r\n    Dim sp As Integer\r\n    Dim leftStk(32) As Long, rightStk(32) As Long\r\n    Dim leftNdx As Long, rightNdx As Long\r\n    Dim inverseOrder As Boolean\r\n    Dim i As Long, j As Long\r\n    Dim value As Variant, temp As Variant\r\n    \r\n    ' account for optional arguments\r\n    If IsMissing(numEls) Then numEls = UBound(arr)\r\n    If IsMissing(descending) Then descending = False\r\n    inverseOrder = (descending <> False)\r\n\r\n    ' init pointers\r\n    leftNdx = LBound(arr)\r\n    rightNdx = numEls\r\n    ' init stack\r\n    sp = 1\r\n    leftStk(sp) = leftNdx\r\n    rightStk(sp) = rightNdx\r\n\r\n    Do\r\n        If rightNdx > leftNdx Then\r\n            \r\n            value = arr(rightNdx)\r\n            i = leftNdx - 1\r\n            j = rightNdx\r\n\r\n            ' find the pivot item\r\n            If descending Then\r\n                Do\r\n                    Do: i = i + 1: Loop Until arr(i) <= value\r\n                    Do: j = j - 1: Loop Until j = leftNdx Or arr(j) >= value\r\n                    temp = arr(i)\r\n                    arr(i) = arr(j)\r\n                    arr(j) = temp\r\n                Loop Until j <= i\r\n            Else\r\n                Do\r\n                    Do: i = i + 1: Loop Until arr(i) >= value\r\n                    Do: j = j - 1: Loop Until j = leftNdx Or arr(j) <= value\r\n                    temp = arr(i)\r\n                    arr(i) = arr(j)\r\n                    arr(j) = temp\r\n                Loop Until j <= i\r\n            End If\r\n\r\n            ' swap found items\r\n            temp = arr(j)\r\n            arr(j) = arr(i)\r\n            arr(i) = arr(rightNdx)\r\n            arr(rightNdx) = temp\r\n\r\n            ' push on the stack the pair of pointers\r\n            ' that differ most\r\n            sp = sp + 1\r\n            If (i - leftNdx) > (rightNdx - i) Then\r\n                leftStk(sp) = leftNdx\r\n                rightStk(sp) = i - 1\r\n                leftNdx = i + 1\r\n            Else\r\n                leftStk(sp) = i + 1\r\n                rightStk(sp) = rightNdx\r\n                rightNdx = i - 1\r\n            End If\r\n        Else\r\n            ' pop a new pair of pointers off the stacks\r\n            leftNdx = leftStk(sp)\r\n            rightNdx = rightStk(sp)\r\n            sp = sp - 1\r\n            If sp = 0 Then Exit Do\r\n        End If\r\n\r\n    Loop\r\n\r\nEnd Sub\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Sort","Quick Sort"]},{"RecordId":"72","Title":"Format Diskettes","Description":"Formats a diskette (or drive)","Code":"Dim DriveNumber As Integer\r\nDim X As Long\r\n\r\nDriveNumber = 0\r\nX = SHFormatDrive(Me.hWnd, DriveNumber, 0&, 0&)\r\nSelect Case X\r\n    Case -1\r\n        MsgBox \"Format failed, user pressed CLOSE\"\r\n    Case -2\r\n        MsgBox \"Format cancelled - user hit CLOSE\"\r\n    Case -3\r\n        MsgBox \"Unable to format this disk drive\"\r\n    Case 6\r\n        MsgBox \"Disk was formatted successfully\"\r\nEnd Select\r\n\r\n","Declares":"Private Declare Function SHFormatDrive Lib \"shell32\" _\r\n   (ByVal hWnd As Long, ByVal Drive As Long, ByVal _\r\n   fmtID As Long, ByVal options As Long) As Long\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Format"]},{"RecordId":"74","Title":"System Resource Status Win95","Description":"Displays memory status and size, swap file size, and total system resource utilization.","Code":"Dim MemInfo As MEMORYSTATUS\r\n\r\n'Load structure and call the API\r\nMemInfo.dwLength = Len(MemInfo)\r\nGlobalMemoryStatus MemInfo\r\n\r\n'Display the info\r\nMemoryLoad = CStr(MemInfo.dwMemoryLoad) & \"%\"\r\nTotalPhysicalMemory = Format$(MemInfo.dwTotalPhys, \"#,##0\") & \" bytes\"\r\nAvailablePhysicalMemory = Format$(MemInfo.dwAvailPhys, \"#,##0\") & \" bytes\"\r\nMaximumSwapFileSize = Format$(MemInfo.dwTotalPageFile, \"#,##0\") & \" bytes\"\r\nAvailableSwapFileSize = Format$(MemInfo.dwAvailPageFile, \"#,##0\") & \" bytes\"\r\nTotalVirtualMemory = Format$(MemInfo.dwTotalVirtual, \"#,##0\") & \" bytes\"\r\nAvailableVirtualMemory = Format$(MemInfo.dwAvailVirtual, \"#,##0\") & \" bytes\"\r\n\r\n\r\n\r\n","Declares":"Declare Sub GlobalMemoryStatus Lib \"kernel32\" (lpBuffer As MEMORYSTATUS)\r\n\r\nType MEMORYSTATUS\r\n    dwLength As Long\r\n    dwMemoryLoad As Long\r\n    dwTotalPhys As Long\r\n    dwAvailPhys As Long\r\n    dwTotalPageFile As Long\r\n    dwAvailPageFile As Long\r\n    dwTotalVirtual As Long\r\n    dwAvailVirtual As Long\r\nEnd Type\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["System Info","Win95 System Statistics"]},{"RecordId":"77","Title":"Find MDI Form","Description":"Finds the MDI form in an application.","Code":"' Call with:  \" If ParentForm() Is Nothing Then \"\r\n\r\n\r\nPublic Function ParentForm() As Form\r\n\r\nDim f As Form\r\n\r\nOn Error GoTo NonMDIForm\r\n\r\nSet ParentForm = Nothing\r\n\r\n'Find the MDI form (remember that there can be only 1 per project)\r\nFor Each f In Forms\r\n    \r\n    If f.AutoShowChildren Then\r\n        Set ParentForm = f\r\n        Exit For\r\n    End If\r\n\r\nNextForm:\r\n\r\nNext\r\n\r\nExit Function\r\n\r\nNonMDIForm:\r\n\r\nResume NextForm\r\n\r\nEnd Function\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["MDI Parent","Parent"]},{"RecordId":"78","Title":"Audit Log Class","Description":"Class for logging strings to a text file","Code":"Option Explicit\r\n\r\nPrivate intFileNum As Integer\r\nPrivate strMessageString As String\r\nPrivate strLogFileName As String\r\n\r\nPublic Sub LogEvent()\r\n    \r\n    \r\n    If Trim$(strLogFileName) = \"\" Then\r\n        MsgBox \"Log file name is missing\"\r\n        Exit Sub\r\n    End If\r\n    \r\n    intFileNum = FreeFile\r\n    \r\n    Open strLogFileName For Append As #intFileNum\r\n    Print #intFileNum, strMessageString\r\n    Close #intFileNum\r\n    \r\n    strMessageString = \"\"\r\n    strLogFileName = \"\"\r\n    \r\n    Exit Sub\r\n    \r\nEnd Sub\r\n\r\nPublic Property Let LogFile(strLogFileNameIn As String)\r\n    \r\n    \r\n    strLogFileName = strLogFileNameIn\r\n    \r\n    Exit Property\r\n    \r\nEnd Property\r\n\r\nPublic Property Let LogText(strMessageIn As String)\r\n    \r\n    \r\n    strMessageString = strMessageIn\r\n    \r\n    Exit Property\r\n    \r\nEnd Property\r\n\r\nPrivate Sub Class_Initialize()\r\n    \r\n    \r\n    strMessageString = \"\"\r\n    strLogFileName = \"\"\r\n    \r\n    Exit Sub\r\n    \r\nEnd Sub\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Audit Log","Logging"]},{"RecordId":"79","Title":"Print a Form","Description":"Prints a form to the printer","Code":"Public Sub PrntForm(ByVal frmWidth As Single, ByVal frmHeight As Single)\r\n\r\n    Dim sWidth As Single\r\n    Dim sHeight As Single\r\n    Dim sMargin As Single\r\n    \r\n    Clipboard.Clear\r\n    \r\n    \r\n    ' NOTE:  To print the entire screen instead of just the form, omit the two VK_MENU lines.\r\n    keybd_event VK_MENU, 0, 0, 0\r\n    keybd_event VK_SNAPSHOT, 0, 0, 0\r\n    keybd_event VK_SNAPSHOT, 0, KEYEVENTF_KEYUP, 0\r\n    keybd_event VK_MENU, 0, KEYEVENTF_KEYUP, 0\r\n    \r\n    DoEvents\r\n    \r\n    Printer.Print\r\n    \r\n    If frmWidth > Printer.ScaleWidth - (2 * sMargin) Then\r\n        sWidth = Printer.ScaleWidth - (2 * sMargin)\r\n        sHeight = (sWidth / frmWidth) * frmHeight\r\n    Else\r\n        sWidth = frmWidth\r\n        sHeight = frmHeight\r\n    End If\r\n    \r\n    Printer.PaintPicture Clipboard.GetData, sMargin, sMargin, sWidth, sHeight\r\n    \r\n    Printer.CurrentX = sMargin\r\n    Printer.CurrentY = (sMargin * 1.5) + sHeight\r\n    Printer.Print Format$(Now, \"mm/dd/yyyy hh:mm\")\r\n    \r\n    Printer.EndDoc\r\n    \r\nEnd Sub\r\n\r\nPrivate Sub Command1_Click()\r\n\r\n    PrntForm Form1.ScaleWidth, Form1.ScaleHeight\r\n\r\nEnd Sub\r\n","Declares":"Private Declare Sub keybd_event Lib \"user32\" _\r\n    (ByVal vBk As Byte, _\r\n    ByVal vScan As Byte, _\r\n    ByVal dwFlags As Long, _\r\n    ByVal dwExtraInfo As Long)\r\n    \r\nConst VK_SNAPSHOT As Byte = &H2C 'PrintScrn\r\nConst VK_MENU = &H12             'Alt\r\nConst KEYEVENTF_KEYUP = &H2\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Print Form","Form Print"]},{"RecordId":"80","Title":"Writing to the NT Event Log","Description":"How to write to the NT event log","Code":"'-- Start Event Logging\r\nCall App.StartLogging(\"\", vbLogToNT)\r\n\r\n'-- Log Events to NT\r\nCall App.LogEvent(\"Info\", vbLogEventTypeInformation)\r\nCall App.LogEvent(\"Error\", vbLogEventTypeError)\r\nCall App.LogEvent(\"Warning\", vbLogEventTypeWarning)\r\n\r\nBe aware though, these functions will only work in the compiled EXE. They will be ignored in design mode. Check out the Microsoft knowledge base article App.LogEvent Only Logs in Compiled Applications for more information.\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["NT Event Log","Event Log"]},{"RecordId":"81","Title":"Is Form Loaded","Description":"Determines if a form is loaded","Code":"' Call with   IsFormLoaded(Form1)\r\n\r\nPublic Function IsFormLoaded(frm As Form) As Boolean\r\n\r\nDim f As Form\r\n\r\nisformload = False\r\n\r\nFor Each f In Forms\r\n    If f Is frm Then\r\n        IsFormLoaded = True\r\n        Exit For\r\n    End If\r\nLoop\r\n\r\nEnd Function","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Is Form Loaded","IsFormLoaded","Loaded"]},{"RecordId":"82","Title":"System Color Hex constants","Description":"Hex Constants for system colors","Code":"System color name\t\tColor\r\n------------------\t\t-----------\r\nMenu text\t\t&H80000007&\r\nScroll bars\t\t&H80000000&\r\nWindow background\t&H80000005&\r\nWindow frame\t\t&H80000006&\r\nWindow text\t\t&H80000008&\r\nActive border\t\t&H8000000A&\r\nActive title bar\t\t&H80000002&\r\nActive title bar text\t\t&H80000009&\r\nApplication workspace\t&H8000000C&\r\nButton face\t\t&H8000000F&\r\nButton highlight\t\t&H80000014&\r\nButton shadow\t\t&H80000010&\r\nButton text\t\t&H80000012&\r\nDesktop\t\t\t&H80000001&\r\nDisabled text\t\t&H80000011&\r\nHighlight\t\t\t&H8000000D&\r\nHighlighted text\t\t&H8000000E&\r\nInactive border\t\t&H8000000B&\r\nInactive title bar\t\t&H80000003&\r\nInactive title bar text\t&H80000013&\r\nMenu bar\t\t\t&H80000004&\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Colors","System Info"]},{"RecordId":"83","Title":"Add Icon to Win95 Tray","Description":"Adds and icon to the Windows 95 tray.","Code":"'--------------------------------------------------------------------------\r\n' This code is used to add the icon to the tray\r\n'--------------------------------------------------------------------------\r\n    Dim nd As NOTIFYICONDATA\r\n    Dim nRet As Integer\r\n    \r\n    nd.cbSize = Len(nd)\r\n    nd.hWnd = Form1.hWnd\r\n    nd.uID = vbNull\r\n    nd.uCallbackMessage = vbNull\r\n    nd.hIcon = Form1.Icon\r\n    nd.szTip = \"This is the icon text\"\r\n    nd.uFlags = NIF_MESSAGE Or NIF_ICON Or NIF_TIP\r\n    \r\n    nRet = Shell_NotifyIconA(NIM_ADD, nd)\r\n    Width = 3100\r\n    Height = 1500\r\n\r\n'--------------------------------------------------------------------------\r\n' This code is used to change to icon or its text\r\n' to something else\r\n'--------------------------------------------------------------------------\r\n    Dim nd As NOTIFYICONDATA\r\n    Dim nRet As Integer\r\n    \r\n    nd.cbSize = Len(nd)\r\n    nd.hWnd = Form1.hWnd\r\n    nd.uID = vbNull\r\n    nd.hIcon = Form1.Icon\r\n    nd.szTip = \"This is the next icon text\"\r\n    nd.uFlags = NIF_MESSAGE Or NIF_ICON Or NIF_TIP\r\n    \r\n    'To ignore any mouse messages to the icon\r\n    nd.uCallbackMessage = vbNull\r\n    \r\n    'To capture mouse messages and pass them to the hWnd\r\n    nd.uCallbackMessage = WM_MOUSEMOVE\r\n    \r\n    nRet = Shell_NotifyIconA(NIM_MODIFY, nd)\r\n\r\n'--------------------------------------------------------------------------\r\n' This code is used to remove the icon from the tray\r\n'--------------------------------------------------------------------------\r\n    Dim nd As NOTIFYICONDATA\r\n    Dim nRet As Integer\r\n    \r\n    nd.cbSize = Len(nd)\r\n    nd.hWnd = Form1.hWnd\r\n    nd.uID = vbNull\r\n    nd.uCallbackMessage = vbNull\r\n    nd.hIcon = Form1.Icon\r\n    nd.uFlags = NIF_MESSAGE Or NIF_ICON Or NIF_TIP\r\n    \r\n    nRet = Shell_NotifyIconA(NIM_DELETE, nd)\r\n    \r\n'--------------------------------------------------------------------------\r\n' This code is used to respond to mouse events over the icon\r\n'--------------------------------------------------------------------------\r\nSub Form1_MouseMove(Button As Integer, Shift As Integer, X As Single, Y As Single)\r\n\r\n'  1E00 = Mouse is moving\r\n'  1E0F = Left button is down\r\n'  1E1E = Left button is up\r\n'  1E3C = Right button is down\r\n'  1E4B = Right button is up\r\n'  1E2D = Left button double-click\r\n'  1E5A = Right button double-click\r\n\r\n\r\nIf Hex(X) = \"1E3C\" Then\r\n   'Your event goes here ...\r\nEnd If\r\nEnd Sub\r\n \r\n\r\n","Declares":"' The following code goes in a MODULE.\r\nType NOTIFYICONDATA\r\n    cbSize As Long\r\n    hWnd As Long\r\n    uID As Long\r\n    uFlags As Long\r\n    uCallbackMessage As Long\r\n    hIcon As Long\r\n    szTip As String * 64\r\nEnd Type\r\n\r\nGlobal Const NIM_ADD = &H0\r\nGlobal Const NIM_MODIFY = &H1\r\nGlobal Const NIM_DELETE = &H2\r\nGlobal Const NIF_MESSAGE = &H1\r\nGlobal Const NIF_ICON = &H2\r\nGlobal Const NIF_TIP = &H4\r\nGlobal Const WM_MOUSEMOVE = &H200\r\n\r\nDeclare Function Shell_NotifyIconA Lib \"shell32\" (ByVal dwMessage As Long, lpData As NOTIFYICONDATA) As Long\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Icon Tray","Win95 Tray","Tray"]},{"RecordId":"84","Title":"Get Primary Domain Controller Name","Description":"Returns the Primary Domain Controller (PDC) name of a Windows NT domain.","Code":"Public Function GetPDCName() As String\r\n\r\nDim bDCNArray() As Byte\r\nDim lReturn As Long\r\nDim lPtr As Long\r\n\r\nReDim bDCNArray(35)\r\n\r\nlReturn = NetGetDCName(vbNullChar, vbNullChar, lPtr)\r\nIf lReturn = 0 Then\r\n    lReturn = lstrcpyW(bDCNArray(0), lPtr)\r\n    lReturn = NetApiBufferFree(lPtr)\r\n    GetPDCName = bDCNArray()\r\nEnd If\r\n\r\nEnd Function\r\n","Declares":"Private Declare Function NetGetDCName Lib \"netapi32.dll\" (ByVal sServername As String, ByVal sDomainName As String, lPtr As Long) As Long\r\nPrivate Declare Function lstrcpyW Lib \"kernel32\" (bRet As Byte, ByVal lPtr As Long) As Long\r\nPrivate Declare Function NetApiBufferFree Lib \"Netapi32\" (ByVal buffer As Long) As Long\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Primary Domain Controller","Domain","Networking"]},{"RecordId":"85","Title":"File to DB - DB to file (32 bit)","Description":"Routines to save file to a DB field and read DB field to re-create the file.","Code":"Private Sub DBFieldToFile()\r\n\r\nDim FileNum As Integer\r\nDim db As Database\r\nDim rs As Recordset\r\nDim i As Long\r\nDim TotalSize As Long\r\nDim NumChunks As Long\r\nDim RemChunk As Integer\r\nDim CurSize As Integer\r\nDim ChunkSize As Long\r\nDim CurChunk As String\r\n    \r\nFileNum = FreeFile\r\n\r\nSet db = OpenDatabase(\"c:\\ted\\db1.mdb\")\r\nSet rs = db.OpenRecordset(\"Table1\", dbOpenTable)\r\nOpen App.Path & \"\\Blue2.bmp\" For Binary As #FileNum\r\n\r\nrs.MoveLast\r\n\r\nChunkSize = 32000\r\nTotalSize = rs!f2.FieldSize()\r\nNumChunks = TotalSize \\ ChunkSize\r\nRemChunk = TotalSize Mod ChunkSize\r\nCurSize = ChunkSize\r\n\r\nFor i = 0 To NumChunks\r\n    \r\n    If i = NumChunks Then\r\n        CurSize = RemChunk\r\n    End If\r\n    \r\n    CurChunk = StrConv(rs!f2.GetChunk(i * ChunkSize, CurSize), vbUnicode) 'Create a unicode string\r\n    Put #FileNum, , CurChunk   ' Write chunk to file.\r\nNext i\r\nClose #FileNum\r\n\r\nrs.Close\r\ndb.Close\r\n\r\nEnd Sub\r\n\r\n'--------------------------------------------------------------------------\r\n\r\nPrivate Sub FileToDBField()\r\n\r\nDim db As Database\r\nDim rs As Recordset\r\nDim NumBlocks As Long\r\nDim Remainder As Long\r\nDim i As Long\r\nDim BlockSize As Integer\r\n\r\nSet db = OpenDatabase(\"c:\\ted\\db1.mdb\")\r\nSet rs = db.OpenRecordset(\"Table1\", dbOpenTable)\r\nOpen App.Path & \"\\Blue Monday.bmp\" For Binary As #1\r\nOpen App.Path & \"\\Blue1.bmp\" For Binary As #2\r\n\r\nBlockSize = 8192\r\nReDim Buffer(0 To BlockSize - 1) As Byte\r\nNumBlocks = LOF(1) \\ BlockSize\r\nRemainder = LOF(1) Mod BlockSize\r\n\r\nrs.AddNew\r\nrs!f1 = \"Three\"\r\nrs!f2 = \"\"\r\nFor i = 1 To NumBlocks\r\n    Get #1, , Buffer()\r\n    Put #2, , Buffer()              'Write to file\r\n    rs!f2.AppendChunk Buffer()      'Write to table\r\nNext\r\n\r\nIf Remainder Then\r\n    ReDim Buffer(0 To Remainder - 1) As Byte\r\n    Get #1, , Buffer()\r\n    Put #2, , Buffer()\r\n    rs!f2.AppendChunk Buffer()\r\nEnd If\r\n\r\nrs.Update\r\n\r\nrs.Close\r\ndb.Close\r\nClose #1\r\nClose #2\r\n\r\nEnd Sub\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["File I/O"]},{"RecordId":"86","Title":"Get Associated Executable","Description":"Returns complete path and file name of the EXE that runs for the given file extension.\r\nFor example:  MDB returns C:\\Program Files\\Microsoft Office\\Office\\MSACCESS.EXE","Code":"'-----------------------------------------------------------------------------------------------------\r\n' Call with:   GetAssociatedExecutable(\"MDB\")\r\n'-----------------------------------------------------------------------------------------------------\r\n\r\nPrivate Function GetAssociatedExecutable(ByVal sExtension As String) As String\r\n\r\n    Dim sPath As String\r\n    Dim sFileName As String\r\n    Dim lRet As Long\r\n    Const MAX_PATH As Long = 260\r\n    \r\n    ' Create a temp file\r\n    sPath = String$(MAX_PATH, 0)\r\n    If GetTempPath(MAX_PATH, sPath) Then\r\n        sFileName = String$(MAX_PATH, 0)\r\n        \r\n        ' Rename it so use supplied extension\r\n        If GetTempFileName(sPath, \"~\", 0, sFileName) Then\r\n            sFileName = Left$(sFileName, InStr(sFileName, vbNullChar) - 1)\r\n            Name sFileName As Left$(sFileName, InStr(sFileName, \".\")) & sExtension\r\n            sFileName = Left$(sFileName, InStr(sFileName, \".\")) & sExtension\r\n            \r\n            ' Get name of associated EXE\r\n            sPath = String$(MAX_PATH, 0)\r\n            Call FindExecutable(sFileName, vbNullString, sPath)\r\n            GetAssociatedExecutable = Left$(sPath, InStr(sPath, vbNullChar) - 1)\r\n            \r\n            ' Cleanup\r\n            Kill sFileName\r\n        End If\r\n    End If\r\n\r\nEnd Function","Declares":"Private Declare Function FindExecutable Lib \"shell32.dll\" Alias \"FindExecutableA\" _\r\n    (ByVal lpFile As String, ByVal lpDirectory As String, ByVal lpResult As String) As Long\r\n\r\nPrivate Declare Function GetTempFileName Lib \"kernel32\" Alias \"GetTempFileNameA\" _\r\n    (ByVal lpszPath As String, ByVal lpPrefixString As String, ByVal wUnique As Long, ByVal lpTempFileName As String) As Long\r\n\r\nPrivate Declare Function GetTempPath Lib \"kernel32\" Alias \"GetTempPathA\" _\r\n    (ByVal nBufferLength As Long, ByVal lpBuffer As String) As Long\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Find Executable","Associated Executable","EXE"]},{"RecordId":"87","Title":"Wait for Shell (Uses API)","Description":"Wait for shelled program to finish.  Uses API WinExec instead of SHELL.","Code":"Dim x%\r\n\r\nIf CmdShow < 0 or CmdShow > 9 then CmdShow = SW_SHOWNORMAL\r\n\r\nx% = WinExec(\"NOTEPAD.EXE\", CmdShow)       ' Modify the path as necessary.\r\n\r\nIf x% >= 32 Then\r\n\r\n  Do While GetModuleUsage(x%)     ' Has Shelled program finished?\r\n         DoEvents                             ' If not, yield to Windows.\r\n  Wend\r\n\r\nEnd If","Declares":"Declare Function GetModuleUsage% Lib \"Kernel\" (ByVal hModule%)\r\n\r\nDeclare Function WinExec% Lib \"Kernel\" (ByVal lpCmdLine As String, ByVal nCmdShow As Integer)\r\n\r\nGlobal Const SW_HIDE = 0\r\nGlobal Const SW_SHOWNORMAL = 1\r\nGlobal Const SW_SHOWMINIMIZED = 2\r\nGlobal Const SW_SHOWMAXIMIZED = 3\r\nGlobal Const SW_SHOWNOACTIVATE = 4\r\nGlobal Const SW_SHOW = 5\r\nGlobal Const SW_MINIMIZE = 6\r\nGlobal Const SW_SHOWMINNOACTIVE = 7\r\nGlobal Const SW_SHOWNA = 8\r\nGlobal Const SW_RESTORE = 9\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Wait","Shell"]},{"RecordId":"88","Title":"Print Shaded Grey Lines/Areas","Description":"Print Shaded Grey Lines/Areas","Code":"Black and white printers cannot print grey lines, but they can dither to create grey areas.  \r\nTo create a grey border around an area, draw thin grey boxes with DrawStyle=vbInvisible (5)\r\nso they have no borders.","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Grey Boxes","Print Shading"]},{"RecordId":"89","Title":"Combo Box (Auto drop down 32 bit)","Description":"Automatically open (drop down) a combo box.","Code":"dim intResult as integer\r\nif Combo1.ListCount > 0 then\r\n\tif (SendMessage(Combo1.hWnd, CB_GETDROPPEDSTATE, 0, byval 0&)) Then\r\n\t\tintResult = SendMessage(Combo1.hWnd, CB_SHOWDROPDOWN, 0, byval 0&)\r\n\t\tCombo1.setfocus\r\n\tend if\r\n\tintResult = SendMessage(Combo1.hWnd, CB_SHOWDROPDOWN, 1, byval 0&)\r\nelse\r\n\tmsgbox \"No records in combo box\"\r\nend if\r\n","Declares":"#If Win32 Then\r\n\tDeclare Function SendMessage Lib \"User32\" Alias \"SendMessageA\" (ByVal hWnd as long, byval lpMsg as long, byval wParam as integer, lParam as any) as long\r\n#ElseIf Win16 Then\r\n\tDeclare Function SendMessage Lib \"User\" (ByVal hWnd as integer, byval lpMsg as integer, byval wParam as integer, lParam as any) as integer\r\n#End If\r\n\r\n\r\n#If Win32 Then\r\n\tConst CB_SHOWDROPDOWN = &H14F\r\n\tConst CB_GETDROPPEDSTATE = &H157\r\n#ElseIf Win16 Then\r\n\tConst WM_USER = &H400\r\n\tConst CB_SHOWDROPDOWN = (WM_USER + 15)\r\n\tConst CB_GETDROPPEDSTATE = (WM_USER + 23)\r\n#End If\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Combo Box Search","Auto select"]},{"RecordId":"90","Title":"Exception Handling - Dr. Watson","Description":"Demonstrates how to implement an exception handler to handle \"un-handled\" errors (such as Dr. Watson errors.)","Code":"'*****************************************************\r\n' This is how you hook into it\r\n'*****************************************************\r\nPrivate Sub Form_Load()\r\n  'Install the custom exception filter.\r\n  Call SetUnhandledExceptionFilter(AddressOf MyExceptionFilter)\r\nEnd Sub\r\n\r\n'*****************************************************\r\n' This is how you un-hook from it\r\n'*****************************************************\r\nPrivate Sub Form_Unload(Cancel As Integer)\r\n  'Remove the custom exception filter and restore the default.\r\n  Call SetUnhandledExceptionFilter(0)\r\nEnd Sub\r\n\r\n'*****************************************************\r\n' This is the BAS module (Declares are included here)\r\n'*****************************************************\r\nOption Explicit\r\n\r\n'This API function installs your custom exception handler.\r\nDeclare Function SetUnhandledExceptionFilter Lib \"kernel32\" (ByVal lpTopLevelExceptionFilter As Long) As Long\r\n\r\n'This API function is used to raise exceptions.\r\nDeclare Sub RaiseException Lib \"kernel32\" (ByVal dwExceptionCode As Long, ByVal dwExceptionFlags As Long, ByVal nNumberOfArguments As Long, lpArguments As Long)\r\n\r\n'Possible return values for the Unhandled Exception Filter.\r\nPublic Const EXCEPTION_CONTINUE_EXECUTION = -1\r\nPublic Const EXCEPTION_CONTINUE_SEARCH = 0\r\nPublic Const EXCEPTION_EXECUTE_HANDLER = 1\r\n\r\n'Maximum number of parameters an Exception_Record can have\r\nPublic Const EXCEPTION_MAXIMUM_PARAMETERS = 15\r\n\r\n'Structure that contains processor-specific register data\r\nType CONTEXT\r\n  FltF0 As Double\r\n  FltF1 As Double\r\n  FltF2 As Double\r\n  FltF3 As Double\r\n  FltF4 As Double\r\n  FltF5 As Double\r\n  FltF6 As Double\r\n  FltF7 As Double\r\n  FltF8 As Double\r\n  FltF9 As Double\r\n  FltF10 As Double\r\n  FltF11 As Double\r\n  FltF12 As Double\r\n  FltF13 As Double\r\n  FltF14 As Double\r\n  FltF15 As Double\r\n  FltF16 As Double\r\n  FltF17 As Double\r\n  FltF18 As Double\r\n  FltF19 As Double\r\n  FltF20 As Double\r\n  FltF21 As Double\r\n  FltF22 As Double\r\n  FltF23 As Double\r\n  FltF24 As Double\r\n  FltF25 As Double\r\n  FltF26 As Double\r\n  FltF27 As Double\r\n  FltF28 As Double\r\n  FltF29 As Double\r\n  FltF30 As Double\r\n  FltF31 As Double\r\n\r\n  IntV0 As Double\r\n  IntT0 As Double\r\n  IntT1 As Double\r\n  IntT2 As Double\r\n  IntT3 As Double\r\n  IntT4 As Double\r\n  IntT5 As Double\r\n  IntT6 As Double\r\n  IntT7 As Double\r\n  IntS0 As Double\r\n  IntS1 As Double\r\n  IntS2 As Double\r\n  IntS3 As Double\r\n  IntS4 As Double\r\n  IntS5 As Double\r\n  IntFp As Double\r\n  IntA0 As Double\r\n  IntA1 As Double\r\n  IntA2 As Double\r\n  IntA3 As Double\r\n  IntA4 As Double\r\n  IntA5 As Double\r\n  IntT8 As Double\r\n  IntT9 As Double\r\n  IntT10 As Double\r\n  IntT11 As Double\r\n  IntRa As Double\r\n  IntT12 As Double\r\n  IntAt As Double\r\n  IntGp As Double\r\n  IntSp As Double\r\n  IntZero As Double\r\n\r\n  Fpcr As Double\r\n  SoftFpcr As Double\r\n\r\n  Fir As Double\r\n  Psr As Long\r\n\r\n  ContextFlags As Long\r\n  Fill(4) As Long\r\nEnd Type\r\n\r\n'Structure that describes an exception.\r\nType EXCEPTION_RECORD\r\n    ExceptionCode As Long\r\n    ExceptionFlags As Long\r\n    pExceptionRecord As Long  ' Pointer to an EXCEPTION_RECORD structure\r\n    ExceptionAddress As Long\r\n    NumberParameters As Long\r\n    ExceptionInformation(EXCEPTION_MAXIMUM_PARAMETERS) As Long\r\nEnd Type\r\n\r\n'Structure that contains exception information that can be used by a debugger.\r\nType EXCEPTION_DEBUG_INFO\r\n        pExceptionRecord As EXCEPTION_RECORD\r\n        dwFirstChance As Long\r\nEnd Type\r\n\r\n'The EXCEPTION_POINTERS structure contains an exception record with a\r\n'machine-independent description of an exception and a context record\r\n'with a machine-dependent description of the processor context at the\r\n'time of the exception.\r\nType EXCEPTION_POINTERS\r\n    pExceptionRecord As EXCEPTION_RECORD\r\n    ContextRecord As CONTEXT\r\nEnd Type\r\n\r\n'Standard Exception Codes\r\nPublic Const EXCEPTION_ACCESS_VIOLATION = &HC0000005\r\nPublic Const EXCEPTION_DATATYPE_MISALIGNMENT = &H80000002\r\nPublic Const EXCEPTION_BREAKPOINT = &H80000003\r\nPublic Const EXCEPTION_SINGLE_STEP = &H80000004\r\nPublic Const EXCEPTION_ARRAY_BOUNDS_EXCEEDED = &HC000008C\r\nPublic Const EXCEPTION_FLT_DENORMAL_OPERAND = &HC000008D\r\nPublic Const EXCEPTION_FLT_DIVIDE_BY_ZERO = &HC000008E\r\nPublic Const EXCEPTION_FLT_INEXACT_RESULT = &HC000008F\r\nPublic Const EXCEPTION_FLT_INVALID_OPERATION = &HC0000090\r\nPublic Const EXCEPTION_FLT_OVERFLOW = &HC0000091\r\nPublic Const EXCEPTION_FLT_STACK_CHECK = &HC0000092\r\nPublic Const EXCEPTION_FLT_UNDERFLOW = &HC0000093\r\nPublic Const EXCEPTION_INT_DIVIDE_BY_ZERO = &HC0000094\r\nPublic Const EXCEPTION_INT_OVERFLOW = &HC0000095\r\nPublic Const EXCEPTION_PRIVILEGED_INSTRUCTION = &HC0000096\r\nPublic Const EXCEPTION_IN_PAGE_ERROR = &HC0000006\r\nPublic Const EXCEPTION_ILLEGAL_INSTRUCTION = &HC000001D\r\nPublic Const EXCEPTION_NONCONTINUABLE_EXCEPTION = &HC0000025\r\nPublic Const EXCEPTION_STACK_OVERFLOW = &HC00000FD\r\nPublic Const EXCEPTION_INVALID_DISPOSITION = &HC0000026\r\nPublic Const EXCEPTION_GUARD_PAGE_VIOLATION = &H80000001\r\nPublic Const EXCEPTION_INVALID_HANDLE = &HC0000008\r\nPublic Const EXCEPTION_CONTROL_C_EXIT = &HC000013A\r\n\r\n'This is a friendly declaration of the CopyMemory function.  It is used to copy\r\n'data into an EXTENSION_RECORD structure from a pointer to another structure.\r\nDeclare Sub CopyExceptionRecord Lib \"kernel32\" Alias \"RtlMoveMemory\" (pDest As EXCEPTION_RECORD, ByVal LPEXCEPTION_RECORD As Long, ByVal lngBytes As Long)\r\n\r\n'******************************\r\n'  GetExceptionText\r\n'******************************\r\n'  This function receives an exception code value and returns the\r\n'  text description of the exception.\r\n'\r\nPublic Function GetExceptionText(ByVal ExceptionCode As Long) As String\r\n  Dim strExceptionString As String\r\n  \r\n  Select Case ExceptionCode\r\n    Case EXCEPTION_ACCESS_VIOLATION\r\n      strExceptionString = \"Access Violation\"\r\n    Case EXCEPTION_DATATYPE_MISALIGNMENT\r\n      strExceptionString = \"Data Type Misalignment\"\r\n    Case EXCEPTION_BREAKPOINT\r\n      strExceptionString = \"Breakpoint\"\r\n    Case EXCEPTION_SINGLE_STEP\r\n      strExceptionString = \"Single Step\"\r\n    Case EXCEPTION_ARRAY_BOUNDS_EXCEEDED\r\n      strExceptionString = \"Array Bounds Exceeded\"\r\n    Case EXCEPTION_FLT_DENORMAL_OPERAND\r\n      strExceptionString = \"Float Denormal Operand\"\r\n    Case EXCEPTION_FLT_DIVIDE_BY_ZERO\r\n      strExceptionString = \"Divide By Zero\"\r\n    Case EXCEPTION_FLT_INEXACT_RESULT\r\n      strExceptionString = \"Floating Point Inexact Result\"\r\n    Case EXCEPTION_FLT_INVALID_OPERATION\r\n      strExceptionString = \"Invalid Operation\"\r\n    Case EXCEPTION_FLT_OVERFLOW\r\n      strExceptionString = \"Float Overflow\"\r\n    Case EXCEPTION_FLT_STACK_CHECK\r\n      strExceptionString = \"Float Stack Check\"\r\n    Case EXCEPTION_FLT_UNDERFLOW\r\n      strExceptionString = \"Float Underflow\"\r\n    Case EXCEPTION_INT_DIVIDE_BY_ZERO\r\n      strExceptionString = \"Integer Divide By Zero\"\r\n    Case EXCEPTION_INT_OVERFLOW\r\n      strExceptionString = \"Integer Overflow\"\r\n    Case EXCEPTION_PRIVILEGED_INSTRUCTION\r\n      strExceptionString = \"Privileged Instruction\"\r\n    Case EXCEPTION_IN_PAGE_ERROR\r\n      strExceptionString = \"In Page Error\"\r\n    Case EXCEPTION_ILLEGAL_INSTRUCTION\r\n      strExceptionString = \"Illegal Instruction\"\r\n    Case EXCEPTION_NONCONTINUABLE_EXCEPTION\r\n      strExceptionString = \"Non Continuable Exception\"\r\n    Case EXCEPTION_STACK_OVERFLOW\r\n      strExceptionString = \"Stack Overflow\"\r\n    Case EXCEPTION_INVALID_DISPOSITION\r\n      strExceptionString = \"Invalid Disposition\"\r\n    Case EXCEPTION_GUARD_PAGE_VIOLATION\r\n      strExceptionString = \"Guard Page Violation\"\r\n    Case EXCEPTION_INVALID_HANDLE\r\n      strExceptionString = \"Invalid Handle\"\r\n    Case EXCEPTION_CONTROL_C_EXIT\r\n      strExceptionString = \"Control-C Exit\"\r\n    Case Else\r\n      strExceptionString = \"Unknown (&H\" & Right(\"00000000\" & Hex(ExceptionCode), 8) & \")\"\r\n  End Select\r\n  GetExceptionText = strExceptionString\r\nEnd Function\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n'******************************\r\n'  MyExceptionFilter\r\n'******************************\r\n'  This function will be called when an unhandled exception occurs.\r\n'  It raises an error so that it can be trapped with an ON ERROR statement\r\n'  in the procedure that caused the exception.\r\nPublic Function MyExceptionFilter(ByRef ExceptionPtrs As EXCEPTION_POINTERS) As Long\r\n  Dim Rec As EXCEPTION_RECORD\r\n  Dim strException As String\r\n  \r\n  'Get the current exception record.\r\n  Rec = ExceptionPtrs.pExceptionRecord\r\n  \r\n  'If Rec.pExceptionRecord is not zero, then it is a nested exception and\r\n  'Rec.pExceptionRecord points to another EXCEPTION_RECORD structure.  Follow\r\n  'the pointers back to the original exception.\r\n  Do Until Rec.pExceptionRecord = 0\r\n    'A friendly declaration of CopyMemory.\r\n    CopyExceptionRecord Rec, Rec.pExceptionRecord, Len(Rec)\r\n  Loop\r\n  \r\n  'Translate the exception code into a user-friendly string.\r\n  strException = GetExceptionText(Rec.ExceptionCode)\r\n  \r\n  'Raise an error to return control to the calling procedure.\r\n  Err.Raise 10000, \"MyExceptionFilter\", strException\r\nEnd Function\r\n\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Exception Handling","Error Handling","Dr. Watson"]},{"RecordId":"91","Title":"Run An Application When Windows Starts","Description":"Automatically run a program once (or everytime) Windows starts.","Code":"Place an entry in either the Run or RunOnce key under the following\r\nregistry structure:\r\n\r\nHKEY_LOCAL_MACHINE or HKEY_CURRENT_USER\r\n  Software\r\n    Microsoft\r\n      Windows\r\n        CurrentVersion\r\n          Run (Runs every time)\r\n          RunOnce (Runs only on first restart)\r\n","Declares":"","CodeCategory":{"CategoryId":"7","CategoryDescription":"Misc"},"Keywords":["Run","RunOnce","Startup"]},{"RecordId":"92","Title":"App Loaded","Description":"Determines if an app of the passed classname is loaded.","Code":"Function Loaded (ClassName$)\r\n     Loaded = FindWindow(ClassName$, 0&)\r\nEnd Function\r\n","Declares":"Declare Function FindWindow Lib \"user\" (ByVal CName As Any, ByVal Caption As Any)\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["App is loaded","Loaded","Instance loaded"]},{"RecordId":"93","Title":"Progress Bar - Copying Files","Description":"Show a progress bar when copying files","Code":"Sub VisualFileCopy (SourceFileName As String, TargetFileName As String,  ProgressGuage As Control)\r\n\r\n   Dim I As Integer\r\n   Dim SourceFileNo As Integer\r\n   Dim TargetFileNo As Integer\r\n   Dim SourceFileSize As Long\r\n   Dim CopyBuffer As String\r\n   \r\n   On Error GoTo FileCopyErrorRoutine\r\n   SourceFileSize = FileLen(SourceFileName)\r\n   CopyBuffer = Space$(25000)             'AS LARGE AS POSSIBLE UNDER 65,000\r\n   \r\n'--KILL THE CURRENT TARGET FILE IF IT EXISTS\r\n   If Len(Dir$(TargetFileName)) Then\r\n      Kill TargetFileName\r\n   End If\r\n\r\n'--OPEN FILES\r\n   SourceFileNo = FreeFile\r\n   Open SourceFileName For Binary Access Read As SourceFileNo\r\n   TargetFileNo = FreeFile\r\n   Open TargetFileName For Binary Access Write As TargetFileNo\r\n\r\n'--COPY SOURCE FILE TO TARGET FILE\r\n   For I = 1 To SourceFileSize \\ Len(CopyBuffer)\r\n      Get #SourceFileNo, , CopyBuffer\r\n      ProgressGuage.FloodPercent = I * Len(CopyBuffer) / SourceFileSize * 100  \r\n'UPDATE PROGRESS GUAGE\r\n      Put #TargetFileNo, , CopyBuffer\r\n      DoEvents\r\n   Next I\r\n\r\n'--COPY ANY ODD PORTION OF THE SOURCE FILE REMAINING\r\n   CopyBuffer = Space$(SourceFileSize - Loc(TargetFileNo))\r\n   If Len(CopyBuffer) Then\r\n      Get #SourceFileNo, , CopyBuffer\r\n      Put #TargetFileNo, , CopyBuffer\r\n   End If\r\n   Close SourceFileNo\r\n   Close TargetFileNo\r\nExit Sub\r\n\r\nFileCopyErrorRoutine:\r\n   MsgBox Error$\r\nExit Sub\r\n\r\nEnd Sub\r\n   \r\n   \r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Progress Bar","File I/O","Copy File"]},{"RecordId":"94","Title":"WWW - Read a web page textually","Description":"Reads the HTML from a web page and outputs the string so that it can be parsed.","Code":"'  Requires a reference to \"Microsoft Internet Controls (ShDocVW.DLL)\"\r\n\r\nPublic Function GoWinInet(sURL As String) As String\r\n\r\nDim sBuffer As String * 4096\r\nDim sReturn As String\r\nDim lNumBytes As Long\r\nDim lSession As Long\r\nDim lFile As Long\r\nDim bReadOK As Boolean\r\n\r\nlSession = InternetOpen(\"GSInternet\", INTERNET_OPEN_TYPE_PRECONFIG, vbNullString, vbNullString, 0)\r\nlFile = InternetOpenUrl(lSession, sURL, vbNullString, 0, INTERNET_FLAG_EXISTING_CONNECT, 0)\r\n\r\nIf lFile Then\r\n    Do\r\n        bReadOK = InternetReadFile(lFile, sBuffer, Len(sBuffer), lNumBytes)\r\n        If lNumBytes Then\r\n            sReturn = sReturn & Left$(sBuffer, lNumBytes)\r\n        End If\r\n    Loop While bReadOK And lNumBytes > 0\r\n    InternetCloseHandle (lFile)\r\n    GoWinInet = sReturn\r\nElse\r\n    MsgBox \"Cannot open URL\"\r\nEnd If\r\n\r\nEnd Function\r\n","Declares":"Public Const INTERNET_OPEN_TYPE_PRECONFIG = 0\r\nPublic Const INTERNET_FLAG_EXISTING_CONNECT = &H20000000\r\n\r\nPublic Declare Function InternetOpenUrl Lib \"wininet.dll\" Alias \"InternetOpenUrlA\" (ByVal hInternetSession As Long, ByVal lpszUrl As String, ByVal lpszHeaders As String, ByVal dwHeadersLength As Long, ByVal dwFlags As Long, ByVal dwContext As Long) As Long\r\nPublic Declare Function InternetOpen Lib \"wininet.dll\" Alias \"InternetOpenA\" (ByVal sAgent As String, ByVal lAccessType As Long, ByVal sProxyName As String, ByVal sProxyBypass As String, ByVal lFlags As Long) As Long\r\nPublic Declare Function InternetReadFile Lib \"wininet.dll\" (ByVal hFile As Long, ByVal sBuffer As String, ByVal lNumBytesToRead As Long, lNumberOfBytesRead As Long) As Integer\r\nPublic Declare Function InternetCloseHandle Lib \"wininet.dll\" (ByVal hInet As Long) As Integer\r\n","CodeCategory":{"CategoryId":"2","CategoryDescription":"Web"},"Keywords":["HTML","WWW","Internet"]},{"RecordId":"95","Title":"Detect Available Drive Letters","Description":"Fills two combo boxes.  One contains used drives and the other contains available drives.","Code":"Private Sub FillCombo(cbo As ComboBox, ByVal blnUsed As Boolean)\r\n\r\n    Dim lngDriveNum As Long\r\n    \r\n    cbo.Clear\r\n    For lngDriveNum = 0 To 25\r\n        If CBool(GetLogicalDrives And (2 ^ lngDriveNum)) = blnUsed Then\r\n            cbo.AddItem Chr$(Asc(\"A\") + lngDriveNum) & \":\"\r\n        End If\r\n    Next\r\n    \r\nEnd Sub\r\n\r\n\r\nPrivate Sub Form_Load()\r\n\r\n    FillCombo Combo1, True   ' Gets used drives\r\n    FillCombo Combo2, False  ' Gets available drives\r\n\r\nEnd Sub\r\n","Declares":"Private Declare Function GetLogicalDrives Lib \"kernel32\" () As Long\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Drives","Available Drive"]},{"RecordId":"96","Title":"Impersonating Users","Description":"Logon to NT using a user profile (as in NT Services) to obtain priviledges","Code":"NOTES\r\n\r\nThe SID constant that is hard-coded in the LoadHive function can be obtained by looking in the registry at the following location:\r\n  HKEY_LOCAL_MACHINE\r\n    Software\r\n      Microsoft\r\n        Windows NT\r\n          CurrentVersion\r\n            ProfileList\r\n\r\nThe NTUSER_DAT constant that is hardcoded in the LoadHive function can be obtained by looking in the following folder:\r\n  WINNT\r\n    Profiles\r\n      YourUserNameHere  <---\r\n        NTUser.dat\r\n          \r\n'-----------------------------------------------------------------------------------------------\r\n\r\nPublic Function ImpersonateUser(strDomainIn As String, strUserIn As String, strPasswordIn As String) As Long\r\n\r\n       ' Use this function if no printing is required\t\t\r\n\r\n       Dim lngRetVal As Long\r\n       Dim strUser As String\r\n       Dim strPassword As String\r\n       Dim strDomain As String\r\n       Dim lngToken As Long\r\n\r\n       lngRetVal = LogonUser(strUserIn, strDomainIn, strPasswordIn, LOGON32_LOGON_INTERACTIVE, LOGON32_PROVIDER_DEFAULT, lngToken)\r\n       If lngRetVal Then\r\n           lngRetVal = ImpersonateLoggedOnUser(lngToken)\r\n       End If\r\n\r\n       ImpersonateUser = lngToken\r\n\r\nEnd Function\r\n          \r\n'-----------------------------------------------------------------------------------------------\r\n\r\nPublic Function ImpersonatePrintUser(strDomainIn As String, strUserIn As String, strPasswordIn As String) As Long\r\n\r\n       ' Use this function if printing is required\t\t\r\n\r\n       Dim lngRetVal As Long\r\n       Dim strUser As String\r\n       Dim strPassword As String\r\n       Dim strDomain As String\r\n       Dim lngToken As Long\r\n\r\n       lngRetVal = LogonUser(strUserIn, strDomainIn, strPasswordIn, LOGON32_LOGON_INTERACTIVE, LOGON32_PROVIDER_DEFAULT, lngToken)\r\n       If lngRetVal Then\r\n\r\n           AdjustToken\r\n\r\n           LoadHive True\r\n\r\n           lngRetVal = ImpersonateLoggedOnUser(lngToken)\r\n       End If\r\n\r\n       ImpersonatePrintUser = lngToken\r\n\r\nEnd Function\r\n\r\n'-----------------------------------------------------------------------------------------------\r\n\r\nPublic Sub UnImpersonateUser(lngTokenIn As Long)\r\n\r\n       Dim lngRetVal As Long\r\n\r\n       lngRetVal = RevertToSelf\r\n       lngRetVal = CloseHandle(lngTokenIn)\r\n\r\nEnd Sub\r\n          \r\n'-----------------------------------------------------------------------------------------------\r\n\r\nPrivate Sub AdjustToken()\r\n\r\n       '********************************************************************\r\n       '* This procedure sets the proper privileges to allow a load a hive of\r\n       '* the registry.\r\n       '********************************************************************\r\n\r\n       Dim hdlProcessHandle As Long\r\n       Dim hdlTokenHandle As Long\r\n       Dim tmpLuid As LUID\r\n       Dim tkp As TOKEN_PRIVILEGES\r\n       Dim tkpNewButIgnored As TOKEN_PRIVILEGES\r\n       Dim lBufferNeeded As Long\r\n\r\n       'Set the error code of the last thread to zero using the\r\n       'SetLast Error function. Do this so that the GetLastError\r\n       'function does not return a value other than zero for no\r\n       'apparent reason.\r\n       SetLastError 0\r\n\r\n       'Use the GetCurrentProcess function to set the hdlProcessHandle\r\n       'variable.\r\n       hdlProcessHandle = GetCurrentProcess()\r\n       OpenProcessToken hdlProcessHandle, (TOKEN_ADJUST_PRIVILEGES Or TOKEN_QUERY), hdlTokenHandle\r\n\r\n       'Get the LUID for privilege\r\n       LookupPrivilegeValue \"\", \"SeRestorePrivilege\", tmpLuid\r\n\r\n       tkp.PrivilegeCount = 1    ' One privilege to set\r\n       tkp.TheLuid = tmpLuid\r\n       tkp.Attributes = SE_PRIVILEGE_ENABLED\r\n\r\n       'Enable the shutdown privilege in the access token of this process\r\n       AdjustTokenPrivileges hdlTokenHandle, False, tkp, Len(tkpNewButIgnored), tkpNewButIgnored, lBufferNeeded\r\n\r\nEnd Sub\r\n          \r\n'-----------------------------------------------------------------------------------------------\r\n\r\nPrivate Function LoadHive(ByVal blnLoad As Boolean) As Boolean\r\n\r\n       Dim strSID As String\r\n       Dim strUserDATFileName As String\r\n       Dim lngRetVal As Long\r\n\r\n       Const HKEY_USERS = &H80000003\r\n       Const SID = \"S-1-5-21-35654138-578429491-347745105-3036\"    <---- Change accordingly\r\n       Const NTUSER_DAT = \"c:\\winnt\\profiles\\sysdevelop\\ntuser.dat\" <---- Change accordingly\r\n\r\n       If blnLoad = True Then\r\n           lngRetVal = RegLoadKey(HKEY_USERS, SID, NTUSER_DAT)\r\n       Else\r\n           lngRetVal = RegUnLoadKey(HKEY_USERS, SID)\r\n       End If\r\n\r\nEnd Function\r\n","Declares":"Declare Function LogonUser Lib \"advapi32.dll\" Alias \"LogonUserA\" (ByVal lpszUsername As String, ByVal lpszDomain As String, ByVal lpszPassword As String, ByVal dwLogonType As Long, ByVal dwLogonProvider As Long, phToken As Long) As Long\r\nDeclare Function ImpersonateLoggedOnUser Lib \"advapi32\" (ByVal hToken As Long) As Long\r\nDeclare Function RevertToSelf Lib \"advapi32.dll\" () As Long\r\nDeclare Function CloseHandle Lib \"kernel32\" (ByVal hObject As Long) As Long\r\n\r\nPublic Const LOGON32_LOGON_BATCH = 4\r\nPublic Const LOGON32_LOGON_INTERACTIVE = 2\r\nPublic Const LOGON32_LOGON_SERVICE = 5\r\nPublic Const LOGON32_PROVIDER_DEFAULT = 0\r\n\r\nPrivate Declare Function RegLoadKey Lib \"advapi32.dll\" Alias \"RegLoadKeyA\" (ByVal hKey As Long, ByVal lpSubKey As String, ByVal lpFile As String) As Long\r\nPrivate Declare Function RegUnLoadKey Lib \"advapi32.dll\" Alias \"RegUnLoadKeyA\" (ByVal hKey As Long, ByVal lpSubKey As String) As Long\r\nPrivate Declare Sub SetLastError Lib \"kernel32\" (ByVal dwErrCode As Long)\r\nPrivate Declare Function GetCurrentProcess Lib \"kernel32\" () As Long\r\nPrivate Declare Function OpenProcessToken Lib \"advapi32\" (ByVal ProcessHandle As Long, ByVal DesiredAccess As Long, TokenHandle As Long) As Long\r\nPrivate Declare Function LookupPrivilegeValue Lib \"advapi32\" Alias \"LookupPrivilegeValueA\" (ByVal lpSystemName As String, ByVal lpName As String, lpLuid As LUID) As Long\r\nPrivate Declare Function AdjustTokenPrivileges Lib \"advapi32\" (ByVal TokenHandle As Long, ByVal DisableAllPrivileges As Long, NewState As TOKEN_PRIVILEGES, ByVal BufferLength As Long, PreviousState As TOKEN_PRIVILEGES, ReturnLength As Long) As Long\r\n\r\nPrivate Type LUID\r\n    UsedPart As Long\r\n    IgnoredForNowHigh32BitPart As Long\r\nEnd Type\r\n\r\nPrivate Type TOKEN_PRIVILEGES\r\n    PrivilegeCount As Long\r\n    TheLuid As LUID\r\n    Attributes As Long\r\nEnd Type\r\n\r\nPrivate Const TOKEN_ADJUST_PRIVILEGES = &H20\r\nPrivate Const TOKEN_QUERY = &H8\r\nPrivate Const SE_PRIVILEGE_ENABLED = &H2\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Logon","Impersonate User","NT Service"]},{"RecordId":"97","Title":"GUID - Creating One","Description":"Creates a GUID","Code":"Public Function CreateGUIDKey() As String\r\n\r\nDim udtGUID As GUID\r\nDim strFormattedGUID As String\r\nDim lngResult As Long\r\n\r\nlngResult = CoCreateGuid(udtGUID)\r\nIf lngResult = GUID_OK Then\r\n    strFormattedGUID = String$(GUID_LENGTH, 0)\r\n    StringFromGUID2 udtGUID, StrPtr(strFormattedGUID), GUID_LENGTH + 1\r\nElse\r\n    strFormattedGUID = \"\"\r\nEnd If\r\n\r\nCreateGUIDKey = strFormattedGUID\r\n\r\nEnd Function\r\n\r\n","Declares":"Declare Function CoCreateGuid Lib \"OLE32.DLL\" (pGuid As GUID) As Long\r\nDeclare Function StringFromGUID2 Lib \"OLE32.DLL\" (pGuid As GUID, ByVal PointerToString As Long, ByVal MaxLength As Long) As Long\r\n\r\nConst GUID_OK As Long = 0\r\nConst GUID_LENGTH As Long = 38\r\n\r\nType GUID\r\n    Guid1 As Long\r\n    Guid2 As Integer\r\n    Guid3 As Integer\r\n    Guid4(0 To 7) As Byte\r\nEnd Type\r\n\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["GUID"]},{"RecordId":"98","Title":"Find Parent Window","Description":"Routine to locate the progenitor of a series of windows","Code":"Function FindProgenitor (WinHand As Integer) As Integer\r\n     Parent% = GetParent(WinHand%)\r\n     OldParent%=Parent%\r\n     'Get the parent of the parent if any\r\n     Do While Parent%\r\n          OldParent% = Parent%\r\n          Parent% = GetParent%(OldParent%)\r\n         ' Debug.Print Parent%\r\n     Loop\r\nParent%=OldParent%\r\nFindProgenitor = Parent%\r\nEnd Function\r\n\r\n","Declares":"'Declares for Find Parent\r\nDeclare Function GetParent Lib \"User\" (ByVal hWnd As Integer) As Integer\r\n'End of declares\r\n","CodeCategory":{"CategoryId":"2","CategoryDescription":"Web"},"Keywords":["Parent Form"]},{"RecordId":"99","Title":"Rounding - A Function To Do It","Description":"Rounds numbers to specified decimal positions","Code":"Public Function Round(ByVal Number As Variant, _\r\n                        ByVal NumDigits As Long, _\r\n                        Optional ByVal UseBankersRounding As Boolean = False) As Double\r\n\r\n\r\nDim dblPower As Double\r\nDim varTemp As Variant\r\nDim intSgn As Integer\r\n\r\nIf Not IsNumeric(Number) Then\r\n    Err.Raise 5\r\nEnd If\r\n\r\ndblPower = 10 ^ NumDigits\r\nintSgn = Sgn(Number)\r\nNumber = Abs(Number)\r\n\r\nvarTemp = CDec(Number) * dblPower + 0.5\r\n\r\nIf UseBankersRounding Then\r\n    If Int(varTemp) = varTemp Then\r\n        If varTemp Mod 2 = 1 Then\r\n            varTemp = varTemp - 1\r\n        End If\r\n    End If\r\nEnd If\r\n\r\nRound = intSgn * Int(varTemp) / dblPower\r\n\r\nEnd Function\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Round","Rounding"]},{"RecordId":"100","Title":"EMail Class","Description":"Class for sending email","Code":"Option Explicit\r\n\r\nPrivate mstrRecipientList As String\r\nPrivate mstrSubjectLine As String\r\nPrivate mstrMessageText As String\r\n\r\nConst HKEY_CURRENT_USER = &H80000001\r\nConst REG_SZ = 1\r\nConst REG_DWORD = 4\r\nPrivate Function BuildRecipientArray(strRecipientListIn As String) As Variant\r\n    \r\n    Dim strTempString As String\r\n    Dim strTempWord As String\r\n    Dim intOffset As Integer\r\n    Dim intStringLength As Integer\r\n    Dim intCount As Integer\r\n    Dim intStart As Integer\r\n    Dim strWordArray(1 To 20) As String\r\n    \r\n    intCount = 1\r\n    intStart = 1\r\n    intOffset = 1\r\n    \r\n    strTempString = Trim$(strRecipientListIn) & \";\"\r\n    intStringLength = Len(strTempString)\r\n    \r\n    Do While intOffset <= intStringLength\r\n        intOffset = InStr(intOffset, strTempString, \";\")\r\n        strTempWord = Mid$(strTempString, intStart, intOffset - intStart)\r\n        \r\n        strWordArray(intCount) = Trim$(strTempWord)\r\n        intCount = intCount + 1\r\n        \r\n        intStart = intOffset + 1\r\n        intOffset = intOffset + 1\r\n    Loop\r\n    \r\n    BuildRecipientArray = CVar(strWordArray)\r\n    \r\nEnd Function\r\n\r\n\r\nPrivate Function DefaultExchangeProfile() As String\r\n    \r\n    Dim lngResult As Long\r\n    Dim lngCch As Long\r\n    Dim lngType As Long\r\n    Dim strReturnString As String\r\n    Dim lngReturnValue As Long\r\n    Dim lngKey As Long\r\n    \r\n    DefaultExchangeProfile = \"\"\r\n    strReturnString = \"\"\r\n    \r\n    lngResult = RegOpenKey(HKEY_CURRENT_USER, \"Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows Messaging Subsystem\\Profiles\", lngKey) 'Retrieve a string/numeric value\r\n    \r\n    If lngResult = 0 Then\r\n        \r\n        lngResult = RegQueryValueExNULL(lngKey, \"DefaultProfile\", 0&, lngType, 0&, lngCch)\r\n        Select Case lngType\r\n                'Strings\r\n            Case REG_SZ:\r\n                strReturnString = String(lngCch, 0)\r\n                lngResult = RegQueryValueEx(lngKey, \"DefaultProfile\", 0&, lngType, ByVal strReturnString, lngCch)\r\n                If lngResult = 0 Then\r\n                    strReturnString = Left$(strReturnString, lngCch - 1)\r\n                Else\r\n                    strReturnString = \"\"\r\n                End If\r\n                'DWORDS\r\n            Case REG_DWORD:\r\n                lngResult = RegQueryValueEx(lngKey, \"My Entry\", 0&, lngType, lngReturnValue, lngCch)\r\n                If lngResult <> 0 Then\r\n                    lngReturnValue = 0\r\n                End If\r\n            Case Else\r\n                'all other data types not supported\r\n        End Select\r\n    End If\r\n    \r\n    lngResult = RegCloseKey(lngKey)\r\n    \r\n    DefaultExchangeProfile = strReturnString\r\n    \r\n    \r\nEnd Function\r\n\r\nPublic Property Let MessageText(strMessageTextIn As String)\r\n    mstrMessageText = strMessageTextIn\r\nEnd Property\r\n\r\nPublic Property Let RecipientList(strRecipientListIn As String)\r\n    \r\n    mstrRecipientList = strRecipientListIn\r\n    \r\nEnd Property\r\n\r\nPublic Sub SendEMail()\r\n    \r\n    Dim oMAPISession As Object\r\n    Dim oMAPIObject As Object\r\n    Dim oMAPIRecipient As Object\r\n    Dim varRecipientArray As Variant\r\n    Dim varRecipient As Variant\r\n    Dim intRecipientCount As Integer\r\n    \r\n    On Error GoTo MAPIError\r\n    \r\n    If mstrMessageText <> \"\" Then\r\n        \r\n        \r\n        'Connect to MAPI\r\n        \r\n        Set oMAPISession = CreateObject(\"MAPI.Session\")\r\n        oMAPISession.Logon DefaultExchangeProfile()\r\n        \r\n        \r\n        'Create message\r\n        \r\n        Set oMAPIObject = oMAPISession.Outbox.Messages.Add\r\n        oMAPIObject.Text = mstrMessageText\r\n        oMAPIObject.subject = mstrSubjectLine\r\n        \r\n        \r\n        'Create recipient list\r\n        \r\n        varRecipientArray = BuildRecipientArray(mstrRecipientList)\r\n        \r\n        For Each varRecipient In varRecipientArray\r\n            If varRecipient <> \"\" Then\r\n                intRecipientCount = intRecipientCount + 1\r\n                Set oMAPIRecipient = oMAPIObject.Recipients.Add\r\n                oMAPIRecipient.Name = varRecipient\r\n                oMAPIRecipient.Resolve False\r\n            End If\r\n        Next\r\n        \r\n        \r\n        'Send mail\r\n        \r\n        oMAPIObject.Send showdialog:=False\r\n        \r\n        \r\n        'Shut down\r\n        \r\n        Set oMAPIRecipient = Nothing\r\n        Set oMAPIObject = Nothing\r\n        \r\n        oMAPISession.Logoff\r\n        Set oMAPISession = Nothing\r\n    End If\r\n    \r\n    Exit Sub\r\n    \r\n    MAPIError:\r\n    If Err.Number < 0 Then\r\n        oMAPIObject.Recipients.Item(intRecipientCount).Delete\r\n        intRecipientCount = intRecipientCount - 1\r\n        Resume Next\r\n    Else\r\n        Exit Sub\r\n    End If\r\n    \r\nEnd Sub\r\nPublic Property Let SubjectLine(strSubjectLineIn As String)\r\n    mstrSubjectLine = strSubjectLineIn\r\nEnd Property\r\n\r\n\r\n","Declares":"Declare Function RegQueryValueEx Lib \"advapi32.dll\" Alias \"RegQueryValueExA\" (ByVal hKey As Long, ByVal lpValueName As String, ByVal lpReserved As Long, lpType As Long, lpData As Any, lpcbData As Long) As Long         ' Note that if you declare the lpData parameter as String, you must pass it By Value.\r\nDeclare Function RegCloseKey Lib \"advapi32.dll\" (ByVal hKey As Long) As Long\r\nDeclare Function RegOpenKey Lib \"advapi32.dll\" Alias \"RegOpenKeyA\" (ByVal hKey As Long, ByVal lpSubKey As String, phkResult As Long) As Long\r\nDeclare Function RegQueryValueExNULL Lib \"advapi32.dll\" Alias \"RegQueryValueExA\" (ByVal hKey As Long, ByVal lpValueName As String, ByVal lpReserved As Long, lpType As Long, ByVal lpData As Long, lpcbData As Long) As Long\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["EMail","MAPI"]},{"RecordId":"102","Title":"Outline Routines","Description":"Routines for adding, deleting, moving items in the MS Outline VBX.\r\n","Code":"\r\n' This file contains 4 routines for adding, deleting, moving and sorting items \r\n' on the MS Outline VBX.\r\n\r\nSub Add_Outline_Item (Outlist As Outline, item As String, Parent As Integer, Picture As Integer)\r\n 'Author: Scott Greenberger (Dive Blue @AOL.COM)\r\n 'Type: Freely Distributed (Do not remove this or any other comments)\r\n 'In other words,give me credit for the original and keep it well documented!\r\n 'Disclaimers: ALL (In other words, I'm not responsible for the results of\r\n ' using this procedure or modified versions of it.)\r\n 'Last Changed:02/02/94\r\n'*******************************************************\r\n'Declarations: Option compare text (so sort is not case sensitive)\r\n            '  Global ErrorFlag as string *1  (to alert the sub that called\r\n            '  this if there is an error & the item isn't added)\r\n'*******************************************************\r\n'  DESCRIPTION/FUNCTION :\r\n' this procedure adds an Item to an outline control using\r\n' file manager type rules. Let's define items in two states, \"Reference\" or\r\n' \"Data\".\r\n\r\n' A \"Reference\" item will be represented by picture closed(0) or by\r\n' picture open(1). (Usually the open and closed file folders we see\r\n' in file manager). This type of list item will refer to a path (like\r\n' a \"directory or subdirectory\" or a \"book and chapter\")\r\n\r\n' A \"Data\" item will be represented by picture leaf(2).(usually the page\r\n' looking pictures that represent files in file manager). We'll treat this\r\n' type as representing actual data(like a file or the text of chapter)\r\n' All items will be sorted alphabetically in reference to their parent item\r\n'************************************************************\r\n'NEEDS(OR WHAT TO PASS):\r\n' Pass this sub the :\r\n'       name of the outline control(OutList)\r\n'       text of the item (Item)\r\n'       index of the item's parent (parent)\r\n'       picture type [picture closed,open,or leaf (0,1 or 2)]\r\n'**************************************************************\r\n 'Now The Important Stuff:\r\nIf Outlist.PictureType(Parent) = 2 Then\r\n 'we can't put a Reference item below a Data item so display your error\r\n 'message and get out\r\n  Beep\r\n  MsgBox (\"Items cannot be placed beneath Routines !\"), 64, App.title\r\n  ErrorFlag = \"Y\"\r\n  Exit Sub\r\nEnd If\r\n   'set up for sort\r\n   Static StringIndex  As Integer 'the index of the item to compare\r\n   StringIndex = Parent\r\n   Static ItemAdded As String * 1\r\n   ItemAdded = \"N\"\r\n'***************************************************************************************************************************\r\n'SORT ROUTINE:\r\n    'no need to compare if parent has no subitems\r\nIf Outlist.HasSubItems(Parent) = True Then\r\n\r\n  Do While Outlist.ListCount <> StringIndex + 1 'don't go past the end\r\n\r\n    StringIndex = StringIndex + 1  'don't compare to parent\r\n    'is this a subitem of parent?\r\n    If Outlist.FullPath(StringIndex) = Outlist.FullPath(Parent) + Outlist.PathSeparator + Outlist.List(StringIndex) Then\r\n         'is the new item alphabetically = to or before this one? or is the items picture a folder and this one's a leaf?\r\n        If item <= Outlist.List(StringIndex) Or Picture = 0 And Outlist.PictureType(StringIndex) = 2 Then\r\n              If item = Outlist.List(StringIndex) Then 'let's not allow this\r\n                Beep\r\n                MsgBox (\"This item already exists in this directory!\"), 64, App.Title\r\n                ErrorFlag = \"Y\"\r\n                Exit Sub\r\n              End If\r\n             'keep all leaf type pictures together\r\n             If Picture = 2 And Outlist.PictureType(StringIndex) <> 2 Then\r\n               GoTo DiffType\r\n             End If\r\n             If StringIndex > 1 And Picture <> 2 And Outlist.PictureType(StringIndex) = 2 Then\r\n                 \r\n             Outlist.AddItem item, StringIndex\r\n             ItemAdded = \"Y\"\r\n             Outlist.PictureType(StringIndex) = Picture\r\n             Exit Do\r\n              \r\n             End If\r\n             \r\n             Outlist.AddItem item, StringIndex 'yes, so add it here\r\n             ItemAdded = \"Y\"\r\n             Outlist.PictureType(StringIndex) = Picture\r\n             Exit Do\r\n        End If\r\n     'if it's not a subitem of parent, is it nested deeper?\r\n    Else\r\n       If Outlist.Indent(StringIndex) <= Outlist.Indent(Parent) Then\r\n       Exit Do 'We must have hit the last subitem don't bother going on\r\n       End If\r\n    End If\r\nDiffType:\r\n  Loop\r\nEnd If\r\n'Now let's make sure we haven't forgotten to add it\r\nIf ItemAdded = \"N\" Then\r\n  Outlist.AddItem item\r\n  Outlist.PictureType(StringIndex + 1) = Picture\r\nEnd If\r\n' End of Sort Routine\r\n'****************************************************************************\r\n\r\nOutlist.Expand(Parent) = True 'make new item is visible\r\nOutlist.PictureType(Parent) = 1  'set parent's picture to picture open\r\n\r\n\r\nEnd Sub\r\n\r\n\r\n\r\n\r\n\r\n'Description:  This module contains three functions:\r\n\r\n'1.  Add_Outline_Item.  Some may recognize this name.  Scott\r\n'GreenBerger (diveblue@aol.com) did a good function that I\r\n'tore apart and rewrote to make it work with my other two.\r\n'2.  Move_Outline_Item.\r\n'3.  Copy_Outline_Item.\r\n'See each function to find out what to pass and how it works.\r\n\r\n'Error Codes:   -1: Parent is a leaf (can not recieve child data)\r\n'               -2: Item already exists in list at same level\r\n\r\n'So that string comparisons are not case sensitive\r\nOption Compare Text\r\n\r\nConst OLN_NOTPARENT = -1\r\nConst OLN_ITEMEXISTS = -2\r\n\r\nFunction Add_Outline_Item (OutlineControl As Outline, Item As String, Parent As Integer, Picture As Integer)\r\n\r\n'Author:  Tim Laird (timl112074@aol.com)\r\n'Idea by: Scott GreenBerger(Dive Blue@aol.com)\r\n'Type:    Freely Distribute, but do not remove any comments\r\n\r\n'Items to pass: OutlineControl:  The control to add to\r\n'               Item:            The string to add\r\n'               Parent:          The Index of the Parent item\r\n'               Picture:         The type of picture to associate\r\n'                                with the item 0=Closed\r\n'                                              1=Open\r\n'                                              2=Leaf\r\n\r\n'This function adds the passed item as a subitem of the parent\r\n'It assumes that the control is alphabetically sorted, and\r\n'places the new item alphabetically among the parents sub-\r\n'items.  It returns the place it plugged the item in (the\r\n'listindex of the added item).\r\n\r\n    Dim AddIndex As Integer\r\n\r\n    'if the picture on the parent is a leaf (representing\r\n    'data that cannot be a parent to other data) the function\r\n    'returns an error code.  See the main module for error\r\n    'codes.\r\n    If OutlineControl.PictureType(Parent) = 2 Then\r\n\r\n        Add_Outline_Item = OLN_NOTPARENT\r\n        Exit Function\r\n\r\n    End If\r\n\r\n    'Start the item off right below its parent\r\n    AddIndex = Parent + 1\r\n\r\n    If OutlineControl.HasSubItems(Parent) Then\r\n\r\n        Do Until AddIndex = OutlineControl.ListCount\r\n\r\n            'leave if the loop has gone out of the parent's subitems\r\n            If OutlineControl.Indent(AddIndex) <= OutlineControl.Indent(Parent) Then Exit Do\r\n\r\n            'Only compare to the parent's first sublevel.\r\n            If OutlineControl.Indent(AddIndex) = OutlineControl.Indent(Parent) + 1 Then\r\n            \r\n                'If the item already exists,\r\n                'the function returns an error code.\r\n                If OutlineControl.List(AddIndex) = Item Then\r\n\r\n                    Add_Outline_Item = OLN_ITEMEXISTS\r\n                    Exit Function\r\n\r\n                End If\r\n            \r\n                'Once the text at AddIndex is greater than the text\r\n                'in Item, the function knows that AddIndex is the\r\n                'proper place to add the item\r\n                If OutlineControl.List(AddIndex) >= Item Then Exit Do\r\n\r\n            End If\r\n\r\n            'Go to the next sub Item\r\n            AddIndex = AddIndex + 1\r\n\r\n        Loop\r\n\r\n    End If\r\n\r\n    OutlineControl.AddItem Item, AddIndex 'add the item\r\n    OutlineControl.PictureType(AddIndex) = Picture 'give it the appropriate picture\r\n    OutlineControl.Indent(AddIndex) = OutlineControl.Indent(Parent) + 1 'indent the item one under the parent\r\n\r\n    OutlineControl.Expand(Parent) = True 'expand the parent so that item is visible\r\n    OutlineControl.PictureType(Parent) = 1 'open the parents picture\r\n\r\n    Add_Outline_Item = AddIndex 'return the position of the new item\r\n\r\nEnd Function\r\n\r\nFunction Copy_Outline_Item (OutlineControl As Outline, MoveIndex As Integer, parentindex As Integer)\r\n\r\n'Author:    Tim Laird (timl112074@aol.com)\r\n'Type:      Freely Distribute, but do not remove any comments\r\n\r\n'Items to pass: OutlineControl: the outline to use\r\n'               MoveIndex:      the position to move\r\n'               ParentIndex:    the index of the new parent\r\n\r\n'This function copies the item referenced by MoveIndex (and\r\n'all its sub items) under the item reference by ParentIndex.\r\n'It returns the number of items copied, and also returns the\r\n'new index of the item referenced by MoveIndex in the MoveIndex\r\n'variable, since adding items above another item can change its\r\n'index.\r\n\r\n    Dim i As Integer\r\n    Dim i2 As Integer\r\n    Dim icount As Integer\r\n    Dim NewIndex As Integer\r\n\r\n\r\n    'Add the original item under the new parent\r\n    NewIndex = Add_Outline_Item(OutlineControl, (OutlineControl.List(MoveIndex)), parentindex, (OutlineControl.PictureType(MoveIndex)))\r\n    icount = 1\r\n    \r\n    'Check for errors\r\n    If NewIndex < 0 Then\r\n        \r\n        Copy_Outline_Item = NewIndex\r\n        Exit Function\r\n\r\n    End If\r\n\r\n    'If the item was copied above the original, then the\r\n    'original was pushed down one.\r\n    If NewIndex <= MoveIndex Then MoveIndex = MoveIndex + 1\r\n    \r\n    'start looking for sub-items one item under the original\r\n    i = MoveIndex + 1\r\n    \r\n    If OutlineControl.HasSubItems(MoveIndex) Then\r\n\r\n        Do Until i >= OutlineControl.ListCount\r\n\r\n            'if there are no more subitems, then exit the loop\r\n            If OutlineControl.Indent(i) <= OutlineControl.Indent(MoveIndex) Then Exit Do\r\n\r\n            'copy the subitem\r\n            i2 = Copy_Outline_Item(OutlineControl, i, NewIndex)\r\n            \r\n            'increase the counter the number of items that copy_outline_item moved\r\n            icount = icount + i2\r\n\r\n            'if the items are being copied above the original, then increase\r\n            'moveindex to account for the movement\r\n            If NewIndex <= MoveIndex Then MoveIndex = MoveIndex + i2\r\n            \r\n            i = i + i2\r\n\r\n        Loop\r\n\r\n    End If\r\n\r\n    'return the number of items moved\r\n    Copy_Outline_Item = icount\r\n\r\nEnd Function\r\n\r\nFunction Move_Outline_Item (OutlineControl As Outline, MoveIndex As Integer, parentindex As Integer)\r\n\r\n'Author:    Tim Laird (timl112074@aol.com)\r\n'Type:      Freely Distribute, but do not remove any comments\r\n\r\n'Items to pass: OutlineControl: the outline to use\r\n'               MoveIndex:      the position to move\r\n'               ParentIndex:    the index of the new parent\r\n\r\n'This function calls Copy_Outline_Item to copy the\r\n'item and subitems referenced by MoveItem, and then\r\n'removes the item referenced by Moveitem.  It returns the\r\n'number of items moved, or an error code\r\n\r\n    Dim i As Integer\r\n    \r\n    'copy the items and remove the old if there are no errors\r\n    i = Copy_Outline_Item(OutlineControl, MoveIndex, parentindex)\r\n    If i >= 0 Then OutlineControl.RemoveItem MoveIndex\r\n\r\n    'return the new location of the original\r\n    Move_Outline_Item = i\r\n    \r\nEnd Function\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Outline"]},{"RecordId":"103","Title":"Creating an AutoRun Application for CDs","Description":"How to have a program automatically run when a CD (or diskette) is inserted.","Code":"To set what program runs when a CD is inserted:\r\n\r\n\r\nEnable Autorun on the PC by searching for\r\n\"NodrivetypeAutoRun\" using RegEdit.  Change\r\nthe value from 95 00 00 00 to 91 00 00 00.\r\n\r\n\r\nCreate an AUTORUN.INF file on the CD.  In the\r\nfile, create the following entry:\r\n\r\n[autorun]\r\nopen=myprogram.exe\r\n\r\nNOTE:  Although floppy drives won't automatically\r\nlook for autorun.inf, you can test this by \r\nright-clicking on the drive and selecting \"autorun\".\r\n\r\nNOTE:  You can also cause any file to be opened in\r\na browser by using an entry similar to the following:\r\n\r\n[autorun]\r\nopen=start myfile.htm\r\n\r\nThen, on that page, you could place a link to \r\nyour setup program.  The possibilites now become\r\nlimitless.\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"7","CategoryDescription":"Misc"},"Keywords":["Setup","AutoRun","Startup"]},{"RecordId":"104","Title":"Text Box - Undo changes","Description":"Aborts changes to a text box","Code":"Sub undotextboxchange (TBox As TextBox)\r\n\r\n    Dim ret As Long\r\n\r\n    ret = sendmessage(TBox.hWnd, EM_UNDO, 0, 0)\r\n\r\n\r\nEnd Sub","Declares":"Declare Function SendMessage Lib \"User\" (ByVal hWnd As Integer, ByVal wMsg As Integer, ByVal wParam As Integer, lparam As Any) As Long","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Undo Text Box","Text Box"]},{"RecordId":"105","Title":"Automatically LogOn to NT","Description":"Shows how to have the PC automatically log on to NT at startup","Code":"You can configure a Windows NT-based computer with the information it needs to automatically log on as a specific user rather than prompting for a user name and password. Although this can be a security risk on a work computer, you might use an automatic logon on your home computer. You configure an automatic logon by editing your computer's registry. Begin by making sure that the DefaultUserName value contains your user name (or the user name you want to use for the automatic logon). This value is stored below the HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon key. Next, add the following values (replace \"password\" with your username's password):\r\n     AutoAdminLogon              REG_SZ:   1\r\n     DefaultPassword             REG_SZ:   password\r\n\r\nIf you're using Novell's Client32, you'll also need to add the following values to the HKEY_LOCAL_MACHINE\\SOFTWARE\\NOVELL\\NWGINA\\Login key:\r\nDefaultNetWareUserName        REG_SZ:    username\r\nDefaultNetWarePassword        REG_SZ:    password\r\nNetWareAutoAdminLogon         REG_SZ:    1\r\n","Declares":"","CodeCategory":{"CategoryId":"7","CategoryDescription":"Misc"},"Keywords":["Logon","Automatic Logon"]},{"RecordId":"106","Title":"Text Box - Undo Operation","Description":"This option calls the Windows API to UNDO the last action in the ACTIVE text box.  (CUT operations can not be undone as this code is - must be Pasted).","Code":"Sub TextUndo (ctrl As Control)\r\n    On Error Resume Next\r\n    Dim lreturn As Long\r\n    Const EM_Undo = &H417\r\n    If TypeOf Screen.ActiveControl Is TextBox Then\r\n        lreturn = SendMessage(ctrl.hWnd, EM_Undo, 0, 0&)\r\n        If lreturn = 0 Then MsgBox \"Can't Undo\", 48, \"Can't Undo\"\r\n    End If\r\nEnd Sub\r\n","Declares":"","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Undo Text Box","Text Box"]},{"RecordId":"107","Title":"Hide Windows","Description":"Use ShowWindow API to display/hide windows\r\n","Code":"Sub Form_Load()\r\n   Const SW_Hide = 0\r\n   WindowName$ = \"Graphics Server\"\r\n   Handle% = FindWindow%(0&, WindowName$)\r\n   If Handle% <> 0 Then\r\n      Result% = ShowWindow(Handle%, SW_Hide)\r\n   End If\r\nEnd Sub","Declares":"Declare Function FindWindow Lib \"User\" (ByVal lpClassName As Any, ByVal lpWindowName As Any) As Integer\r\nDeclare Function ShowWindow Lib \"User\" (ByVal hWnd As Integer, ByVal nCmdShow As Integer) As Integer\r\n\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Hide Form","Show/Hide Form"]},{"RecordId":"109","Title":"Flash Window","Description":"Cause a window to flash","Code":"' Call with:\r\nFlash Me.hWnd, 20, 0.5\r\n\r\nPublic Sub Flash(hWnd As Long, intTimes As Integer, intInterval As Integer)\r\n\r\nDim i As Integer\r\nDim sngStart As Single\r\n\r\nFor i = 1 To intTimes\r\n    \r\n    Call FlashWindow(hWnd, True)\r\n    \r\n   sngStart = Timer\r\n    Do Until Timer > sngStart + intInterval\r\n        DoEvents\r\n    Loop\r\nNext\r\n\r\nCall FlashWindow(hWnd, False)\r\n\r\nEnd Sub\r\n","Declares":"Declare Function FlashWindow Lib \"user32\" (ByVal hWnd As Long, ByVal bInvert As Long) As Long\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Flash Window"]},{"RecordId":"110","Title":"Registry","Description":"Read/write registry/ini files","Code":"VB3 and VB4 16 bit uses INI files.  VB4 32 bit uses the registry.  The VB4 API calls (getsetting, savesetting, getallsettings, and deletesetting) will use INI files if running in 16 bit mode and they reference the registry if in 32 bit mode.\r\n\r\nAn INI file translates into the following registry information:\r\n \r\nInvoice.INI\r\n[DatabaseInfo]\r\nDBPath=c:\\invoice\\database\\\r\nDBName=Invoice.mdb\r\n\r\n[UserInfo]\r\nUID=UserID\r\nWorkGroupID=Admin\r\n\r\nRegistry\r\nHKEY_CURRENT_USER\r\n  \\Software\r\n    \\VB and VBA Program Settings\r\n      \\Invoice\r\n        \\DatabaseInfo\r\n          \\DBPath=c:\\invoice\\database\\\r\n          \\DBName=Invoice.mdb\r\n        \\UserInfo\r\n          \\UID=UserID\r\n          \\WorkGroupID=Admin\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Registry","INI"]},{"RecordId":"111","Title":"Run Control Panel Applets From VB","Description":"Run any of the Control Panel applets (install printer, etc.) from VB.  See web site www.mvps.org/vb and follow the \"tipsheets\" link.\r\n\r\nUses \"rundll32.exe shell32.dll\" functions","Code":"","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Control Panel","Applets","Shell"]},{"RecordId":"113","Title":"Tab Stops in List Box","Description":"How to set the tab stops in a list box","Code":"'  Call the routine with this (List1 is the list box to set tab stops in)\r\nSetListBoxTabStops List1\r\n\r\n'  Load the list box like this using Chr$(9) for tabs\r\nList1.AddItem \"String 1\" & Chr$(9) & \"String 2\" & Chr$(9) & \"String 3\"\r\n\r\n'------------------------------------------------------------------------------\r\nSub SetListBoxTabStops (LstBox As Control)\r\n\r\n    Dim WhiteSpace As Integer\r\n    Dim ret As Long\r\n    ReDim TabStops(1 To 2)  As Integer\r\n    Dim alphabet As String\r\n    Dim AvgCharWidth As Single\r\n    \r\n    'Determine average character width of the alphabet\r\n    alphabet = \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\"\r\n    AvgCharWidth = (Me.TextWidth(alphabet) / screen.TwipsPerPixelX) / 52\r\n    \r\n    'Use 2 characters as the whitespace between columns\r\n    WhiteSpace = AvgCharWidth * 2\r\n    \r\n    'Compute the actual width of the text to go into each column\r\n    'Tabstops(1) = 56\r\n    'TabStops(2) = 108\r\n    TabStops(1) = ((Me.TextWidth(\"Date mm/dd/yy\") / screen.TwipsPerPixelX + WhiteSpace) \\ AvgCharWidth) * 4\r\n    TabStops(2) = TabStops(1) + ((Me.TextWidth(\"Amt X,XXX.XX\") / screen.TwipsPerPixelX + WhiteSpace) \\ AvgCharWidth) * 4\r\n    \r\n    'Set the tab stops in the list box\r\n    ret = SendMessage(LstBox.hWnd, LB_SETTABSTOPS, 2, TabStops(1))\r\n\r\nEnd Sub\r\n","Declares":"Declare Function SendMessage Lib \"User\" (ByVal hWnd As Integer, ByVal wMsg As Integer, ByVal wParam As Integer, lparam As Any) As Long\r\n\r\nConst WM_USER = &H400\r\nConst LB_SETTABSTOPS = WM_USER + 19\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["List Box","Tab Stops"]},{"RecordId":"114","Title":"Fill List Box with Drives/Dirs/Files","Description":"This routine fills a standard list box with a list of drives, directories, and files using a Windows API call.","Code":"'----------------------------------------------------------------------------------------\r\n'Call the routine with this  \r\n'----------------------------------------------------------------------------------------  \r\nCall ListFiles(\"c:\\*.*\")\r\n\r\nSub ListFiles (sFileSpec As String)\r\n    \r\n    Dim i As Long\r\n    \r\n    'Note:  Some experimentation might be required to get the exact list of files needed.\r\n    i = SendMessage(List1.hWnd, LB_DIR, DIR_DRIVES, ByVal sFileSpec)\r\n    i = SendMessage(List1.hWnd, LB_DIR, DIR_DIRECTORIES, ByVal sFileSpec)\r\n    i = SendMessage(List1.hWnd, LB_DIR, DIR_NORMALFILES, ByVal sFileSpec)\r\n    i = SendMessage(List1.hWnd, LB_DIR, DIR_READONLY, ByVal sFileSpec)\r\n    i = SendMessage(List1.hWnd, LB_DIR, DIR_SYSTEM Or DIR_HIDDEN, ByVal sFileSpec)\r\n\r\nEnd Sub\r\n\r\n\r\n","Declares":"Declare Function SendMessage Lib \"User\" (ByVal hWnd As Integer, ByVal wMsg As Integer, ByVal wParam As Integer, lParam As Any) As Long\r\n\r\nConst WM_USER = &H400\r\nConst LB_DIR = (WM_USER + 14)\r\nConst DIR_DRIVES = &HC000\r\nConst DIR_DIRECTORIES = &H8010\r\nConst DIR_NORMALFILES = &H0\r\nConst DIR_READONLY = &H8001\r\nConst DIR_HIDDEN = &H8002\r\nConst DIR_SYSTEM = &H8004\r\nConst DIR_ARCHIVED = &H8020\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Files","Directory"]},{"RecordId":"115","Title":"Mousepointer Coordinates - Obtaining","Description":"Gets the x and y coordinates of the mouse pointer when the event DblClick or Click is invoked.","Code":"'in the DblClick (or whatever) event:\r\nDim pnt as POINTAPI\r\nGetCursorPos pnt\r\n' pnt.x is the x coordinate in pixels, pnt.y y-coordinate in pixels.\r\n","Declares":"Type POINTAPI\r\n    x As Integer\r\n    y As Integer\r\nEnd Type\r\n\r\nDeclare Sub GetCursorPos Lib \"User\" (lpPoint As POINTAPI)\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Mouse Pointer","Mouse Location"]},{"RecordId":"116","Title":"Combo Box - Simulate tab stops","Description":"Simulates tab stops (evenly spaced items) while loading a combo box.\r\nList boxes can use the SendMessage API, but this doesn't work on combo boxes.  This routine computes the length of the key string and adds the correct number of spaces at the end.","Code":"Dim strKey As String\r\n    Dim strDescription As String\r\n    Dim lngAllXLength As Long\r\n    Dim lngSpaceLength As Long\r\n        \r\n    'Compute length of all Xs based on length of key field\r\n    lngAllXLength = TextWidth(String(KeyFieldLength, \"X\"))\r\n    \r\n    'Compute length of one space character\r\n    lngSpaceLength = TextWidth(\" \")\r\n    \r\n    strKey = Trim$(TableIn(0))\r\n    strDescription = Trim$(TableIn(1))\r\n        \r\n    'Items are added to the list box, but space is allocated to fill the full length of the key\r\n    'string so that the description column lines up cleanly.\r\n    If ((lngAllXLength - TextWidth(strKey)) / lngSpaceLength) > 1 Then\r\n        cboSearch.AddItem strKey & Space((lngAllXLength - TextWidth(strKey)) / lngSpaceLength) & \" - \" & strDescription\r\n    Else\r\n        cboSearch.AddItem strKey & \" - \" & strDescription\r\n    End If\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Combo Box","Tab Stops"]},{"RecordId":"118","Title":"Collections (Wrapper Template)","Description":"Template for a collection class","Code":"'--------------------------------------------------------------\r\n' This is the class that represents one item in the collection\r\n'--------------------------------------------------------------\r\nOption Explicit\r\n\r\nPublic ID As Long\r\nPublic Name As String\r\nPublic Age As Integer\r\nPublic Birthday As Date\r\n\r\n'--------------------------------------------------------------\r\n' This is the collection wrapper class\r\n'--------------------------------------------------------------\r\nOption Explicit\r\n\r\nPublic Items As Collection\r\n\r\nPublic Function Add(ByVal lngID As Long, ByVal strName As String, ByVal intAge As Integer, ByVal datBirthdate As Date) As Boolean\r\n\r\n    Dim oItem As cItem\r\n    \r\n    On Error GoTo EH\r\n    \r\n    Add = False\r\n    \r\n    Set oItem = New cItem\r\n    \r\n    oItem.ID = lngID\r\n    oItem.Name = strName\r\n    oItem.Age = intAge\r\n    oItem.Birthday = datBirthdate\r\n    \r\n    Items.Add Item:=oItem, Key:=CStr(lngID)\r\n    \r\n    Set oItem = Nothing\r\n    Add = True\r\n    Exit Function\r\n    \r\nEH:\r\n    Set oItem = Nothing\r\n    Add = False\r\n    Exit Function\r\n    \r\nEnd Function\r\n\r\nPublic Function Remove(ByVal varKey As Variant) As Boolean\r\n\r\n    On Error GoTo EH\r\n    \r\n    Remove = False\r\n    \r\n    Items.Remove varKey\r\n    \r\n    Remove = True\r\n    Exit Function\r\n    \r\nEH:\r\n    Remove = False\r\n    Exit Function\r\n    \r\nEnd Function\r\n\r\nPublic Property Get Count() As Integer\r\n\r\n    Count = Items.Count\r\n\r\nEnd Property\r\n\r\nPublic Property Get Item(ByVal varKey As Variant) As cItem\r\n\r\n    Set Item = Items.Item(varKey)\r\n    \r\nEnd Property\r\n\r\nPublic Function NewEnum() As IUnknown\r\nAttribute NewEnum.VB_UserMemId = -4\r\nAttribute NewEnum.VB_MemberFlags = \"40\"\r\n    \r\n    ' Enables the For...Each\r\n    ' NOTE: Requires using the Tools\\Procedure Attributes dialog box from hell\r\n    '       to set \"Procedure ID\" to \"-4\" and \"Hide this member\" to \"checked\".\r\n    \r\n    Set NewEnum = Items.[_NewEnum]\r\n\r\nEnd Function\r\n\r\nPublic Sub Clear()\r\n\r\n    Set Items = Nothing\r\n    Set Items = New Collection\r\n    \r\nEnd Sub\r\n\r\nPrivate Sub Class_Initialize()\r\n\r\n    Set Items = New Collection\r\n\r\nEnd Sub","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Collection"]},{"RecordId":"119","Title":"Parse string into indivual lines","Description":"Breaks a long string up into wrapped lines for printing.","Code":"'This is the calling function  \r\n dim iTxtlen as integer\r\n dim LineStart as integer\r\n dim StringIn as string\r\n\r\n iTxtlen = 36    'Desired line length is 36 characters\r\n LineStart = 0\r\n\r\n 'Remove CR/LF\r\n If InStr(StringIn, Chr$(13)) Then\r\n     For ii = 1 To Len(StringIn)\r\n         If Mid$(StringIn, i, 1) = Chr$(13) Or Mid$(StringIn, i, 1) = Chr$(10) Then\r\n            Mid$(StringIn, i, 1) = \" \"\r\n         End If\r\n     Next\r\n End If\r\n\r\n\r\n 'Break the string into 7 separate lines\r\n For i = 1 To 7\r\n     PrintString = GetOneLine(StringIn, LineStart, 36)\r\n     Printer.Print PrintString\r\n     LineStart = LineStart + Len(PrintString)\r\n Next\r\n\r\n\r\nFunction GetOneLine (ByVal StringIn As String, ByVal StartPosition As Integer, ByVal LengthLimit As Integer) As String\r\n\r\n Dim j As Integer\r\n Dim TempString As String\r\n Dim TempWord As String\r\n Dim LastBreak As Integer\r\n Dim OverFlow As Integer\r\n\r\n OverFlow = False\r\n GetOneLine = \"\"\r\n\r\n LastBreak = 1\r\n\r\n For j = 1 To LengthLimit\r\n    \r\n     If Mid$(StringIn, StartPosition + j, 1) = \" \" Then\r\n         LastBreak = j\r\n     End If\r\n\r\n     TempString = TempString & Mid$(StringIn, StartPosition + j, 1)\r\n     If Len(TempString) >= LengthLimit Then\r\n         OverFlow = True\r\n         Exit For\r\n     End If\r\n Next\r\n\r\n If LastBreak = 1 Then\r\n     GetOneLine = Mid$(StringIn, StartPosition + 1, 36)\r\n Else\r\n     If OverFlow Then\r\n         GetOneLine = Mid$(StringIn, StartPosition + 1, LastBreak)\r\n     Else\r\n         GetOneLine = Mid$(StringIn, StartPosition + 1, 36)\r\n     End If\r\n End If\r\n\r\nEnd Function\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Parse Line","Word Wrap","Parse"]},{"RecordId":"120","Title":"Limit Number Of Characters Typed In ComboBox","Description":"A textbox has a MaxChars property.  A combo box does not.","Code":"Private Sub Form_Load()\r\n\r\n    Const Max_Char = 24\r\n    \r\n    Call SendMessage(Combo1.hwnd, CB_LIMITTEXT, Max_Char, 0&)\r\n    \r\nEnd Sub\r\n","Declares":"Declare Function SendMessage Lib \"user32\" Alias \"SendMessageA\" (ByVal hwnd As Long, ByVal wMsg As Long, ByVal wParam As Long, lParam As Any) As Long\r\n\r\nConst CB_LIMITTEXT = &H141\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Combo Box","Max Char"]},{"RecordId":"121","Title":"Auto Resize Label Height to Accomodate Text","Description":"Auto-resize causes a label to resize horizontally, but not vertically when resizing to accomodate text.\r\nThis routine resizes the label vertically.  NOTE:  AutoResize must be FALSE.\r\n","Code":"'Call it with Label1.Height = AutoLabelHeight(Me, Label1)\r\n\r\nPublic Function AutoLabelHeight(DrawObj As Object, lbl As Label) As Long\r\n\r\nDim dRect As RECT\r\nDim SaveFont As Font\r\n\r\ndRect.Top = 0\r\ndRect.Left = 0\r\ndRect.Bottom = 0\r\n\r\nIf lbl.BorderStyle = 1 Then\r\n    If lbl.Appearance = 0 Then\r\n        dRect.Right = (lbl.Width / Screen.TwipsPerPixelX) - 2\r\n    Else\r\n        dRect.Right = (lbl.Width / Screen.TwipsPerPixelX) - 4\r\n    End If\r\nElse\r\n    dRect.Right = (lbl.Width / Screen.TwipsPerPixelX)\r\nEnd If\r\n\r\nSet SaveFont = DrawObj.Font\r\nSet DrawObj.Font = lbl.Font\r\n\r\nDrawTextGDI Obj:=DrawObj, DrawRect:=dRect, Txt:=(lbl.Caption), WordWrap:=True, CalcExtent:=True\r\n\r\nIf lbl.BorderStyle = 1 Then\r\n    If lbl.Appearance = 0 Then\r\n        AutoLabelHeight = (dRect.Bottom + 3) * Screen.TwipsPerPixelY\r\n    Else\r\n        AutoLabelHeight = (dRect.Bottom + 5) * Screen.TwipsPerPixelY\r\n    End If\r\nElse\r\n    AutoLabelHeight = (dRect.Bottom + 1) * Screen.TwipsPerPixelY\r\nEnd If\r\n\r\nEnd Function\r\n\r\nPrivate Sub DrawTextGDI(Obj As Object, DrawRect As RECT, Txt As String, WordWrap As Integer, CalcExtent As Integer)\r\n\r\nDim CheckIt As Long\r\nDim Options As Long\r\n\r\nIf WordWrap Then\r\n    Options = &H10\r\nElse\r\n    Options = &H20\r\nEnd If\r\n\r\nIf CalcExtent Then Options = Options + &H400\r\n\r\nCheckIt = DrawText(Obj.hdc, Txt, Len(Txt), DrawRect, Options)\r\n\r\nEnd Sub\r\n\r\n\r\n","Declares":"Declare Function DrawText Lib \"user32\" Alias \"DrawTextA\" (ByVal hdc As Long, ByVal lpStr As String, ByVal nCount As Long, lpRect As RECT, ByVal wFormat As Long) As Long\r\n\r\nType RECT\r\n        Left As Long\r\n        Top As Long\r\n        Right As Long\r\n        Bottom As Long\r\nEnd Type\r\n\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Auto Resize","Label Height","AutoHeight"]},{"RecordId":"122","Title":"Center MDI Child Form","Description":"Centers a child form on it's MDI parent","Code":"Private Sub CenterChildForm (frmChild as Form)\r\n\r\nDim f as Form\r\nDim frmParent as Form\r\n\r\nOn Error GoTo NonMDIForm\r\n\r\nSet frmParent = Nothing\r\n\r\nFor Each f in Forms\r\n  If f.AutoShowChildren Then    'Only MDI forms have this property\r\n    Set frmParent = f\r\n    Exit For\r\n  End If\r\n\r\nNonMDIForm:\r\n\r\nNext\r\n\r\nOn Error GoTo 0\r\n\r\nIf Not frmParent Is Nothing Then\r\n  frmChild.Top=(frmParent.ScaleHeight - frmChild.Height) / 2\r\n  frmChild.Left=(frmParent.ScaleWidth - frmChild.Width) / 2\r\nEnd If\r\n\r\nEnd Sub","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Center Form","MDI"]},{"RecordId":"123","Title":"Tiles an Image on a Form","Description":"Tiles an image contained in a Picture Box across the entire form","Code":"'--------------------------------------------------------------\r\nPrivate Sub Form_Paint()\r\n'--------------------------------------------------------------\r\nDim i As Long\r\nDim j As Long\r\n\r\nWith Picture1\r\n    For i = 0 To Me.ScaleWidth Step .Width\r\n        For j = 0 To Me.ScaleHeight Step .Height\r\n            PaintPicture .Picture, i, j\r\n        Next\r\n    Next\r\nEnd With\r\n\r\nEnd Sub\r\n\r\n'--------------------------------------------------------------\r\nPrivate Sub Form_Resize()\r\n'--------------------------------------------------------------\r\nMe.Refresh\r\nEnd Sub\r\n\r\n'--------------------------------------------------------------\r\nPrivate Sub Form_Load()\r\n'--------------------------------------------------------------\r\n\r\nWith Picture1\r\n    .AutoSize = True\r\n    .BorderStyle = 0\r\n    .Visible = False\r\nEnd With\r\n\r\nEnd Sub\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Tile bitmap","Form background","Background"]},{"RecordId":"124","Title":"Scroll a List Box","Description":"Programatically scroll a list box","Code":"lRetVal = SendMessage(List1.hwnd, WM_VSCROLL, SB_TOP, 0)\r\nlRetVal = SendMessage(List1.hwnd, WM_VSCROLL, SB_BOTTOM, 0)\r\n\r\nlRetVal = SendMessage(List1.hwnd, WM_VSCROLL, SB_PAGEUP, 0)\r\nlRetVal = SendMessage(List1.hwnd, WM_VSCROLL, SB_PAGEDOWN, 0)\r\n\r\nlRetVal = SendMessage(List1.hwnd, WM_VSCROLL, SB_LINEUP, 0)\r\nlRetVal = SendMessage(List1.hwnd, WM_VSCROLL, SB_LINEDOWN, 0)\r\n","Declares":"Public Declare Function SendMessage Lib \"user32\" Alias \"SendMessageA\" (ByVal hwnd As Long, ByVal wMsg As Long, ByVal wParam As Long, lParam As Any) As Long\r\n\r\nPublic Const SB_LINEUP = 0\r\nPublic Const SB_LINEDOWN = 1\r\n\r\nPublic Const SB_PAGEUP = 2\r\nPublic Const SB_PAGEDOWN = 3\r\n\r\nPublic Const SB_TOP = 6\r\nPublic Const SB_BOTTOM = 7\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["List box","Scroll"]},{"RecordId":"125","Title":"Create Path","Description":"Creates the passed path, returns true if successful.","Code":"Function CreatePath (ByVal DestPath$) As Integer\r\nScreen.MousePointer = 11\r\nIf Right$(DestPath$, 1) <> \"\\\" Then\r\n    DestPath$ = DestPath$ & \"\\\"\r\nEnd If\r\nOn Error Resume Next\r\nChDrive DestPath$\r\nIf Err <> 0 Then GoTo errorOut\r\nChDir \"\\\"\r\nBackPos = 3\r\nforePos = InStr(4, DestPath$, \"\\\")\r\nDo While forePos <> 0\r\n     temp$ = Mid$(DestPath$, BackPos + 1, forePos - BackPos - 1)\r\n     Err = 0\r\n     MkDir temp$\r\n     If Err <> 0 And Err <> 75 Then GoTo errorOut\r\n     Err = 0\r\n     ChDir temp$\r\n     If Err <> 0 Then GoTo errorOut\r\n     BackPos = forePos\r\n     forePos = InStr(BackPos + 1, DestPath$, \"\\\")\r\nLoop\r\nCreatePath = True\r\nScreen.MousePointer = 0\r\nExit Function\r\n\r\nerrorOut:\r\nMsgBox \"Error While Attempting to Create Directories on Destination Drive.\", 48, \"SETUP\"\r\nCreatePath = False\r\nScreen.MousePointer = 0\r\nExit Function\r\nEnd Function\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Create Directory"]},{"RecordId":"126","Title":"Find Window  (32 bit)","Description":"Activates an application if it is running and sets focus to it. (32 bit)","Code":"Dim retval As Long\r\nDim retval2 As Long\r\n\r\nretval = FindWindow(\"XLMAIN\", 0&)    'XLMAIN is the class name for Excel.\r\nIf retval <> 0 Then\r\n    retval2 = ShowWindow(retval, SW_NORMAL)\r\n    retval2 = SetForegroundWindow(retval)\r\nElse\r\n    MsgBox \"Excel is not running\"\r\nEnd If\r\n\r\n","Declares":"Declare Function FindWindow Lib \"user32\" Alias \"FindWindowA\" (ByVal lpClassName As Any, ByVal lpWindowName As Any) As Long\r\nDeclare Function ShowWindow Lib \"user32\" (ByVal hwnd As Long, ByVal nCmdShow As Long) As Long\r\nDeclare Function SetForegroundWindow Lib \"user32\" (ByVal hwnd As Long) As Long\r\n\r\nGlobal Const SW_NORMAL = 1\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Find Window","Activate","Running"]},{"RecordId":"127","Title":"Timer (High resolution)","Description":"Determines high resolution timer ticks (VB4)","Code":"Private Function ConvertLargeInteger(li As LARGE_INTEGER) As Double\r\n    Dim n As Double\r\n    If (li.lowpart < 0) Then\r\n        n = CDbl(li.lowpart) * -2\r\n    Else\r\n        n = li.lowpart\r\n    End If\r\n    ConvertLargeInteger = (li.highpart * (65535 ^ 2)) + n\r\nEnd Function\r\n\r\nFunction TimerMark() As Double\r\n\r\n    Dim Frequency As Double\r\n    Dim li As LARGE_INTEGER\r\n    dim b as long\r\n\r\n    b = QueryPerformanceFrequency(li)\r\n    If (b) Then\r\n        Frequency = ConvertLargeInteger(li)\r\n    End If\r\n    \r\n    b = QueryPerformanceCounter(li)\r\n    If Not (b) Then\r\n        MsgBox \"High-resolution performance counter not available on this system\"\r\n        Exit Function\r\n    End If\r\n\r\n    TimerMark = ConvertLargeInteger(li)\r\n      \r\nEnd Function\r\n","Declares":"Private Type LARGE_INTEGER\r\n    lowpart As Long\r\n    highpart As Long\r\nEnd Type\r\nPrivate Declare Function QueryPerformanceCounter Lib \"kernel32\" (lpPerformanceCount As LARGE_INTEGER) As Long\r\nPrivate Declare Function QueryPerformanceFrequency Lib \"kernel32\" (lpPerformanceCount As LARGE_INTEGER) As Long\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Timer"]},{"RecordId":"128","Title":"User Name","Description":"Determine who's logged onto the computer","Code":"Function GetUser() As String\r\n\r\n    Dim lpBuffer As String * 255\r\n    Dim lRet As Long\r\n    Dim UserName As String\r\n\r\n    lpBuffer = Space$(255)\r\n    lRet = GetUserName(lpBuffer, 255)\r\n\r\n    If Len(Trim$(lpBuffer)) > 0 Then\r\n        UserName = Mid$(Trim$(lpBuffer), 1, Len(Trim$(lpBuffer)) - 1)\r\n    Else\r\n        UserName = \"\"\r\n    End If\r\n    \r\n    GetUser = UserName\r\n    \r\nEnd Function\r\n","Declares":"Declare Function GetUserName Lib \"advapi32.dll\" Alias \"GetUserNameA\" (ByVal lpBuffer As String, nSize As Long) As Long\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["User ID","System Info"]},{"RecordId":"129","Title":"Help Menu Commands","Description":"Commands for accessing help for project and Windows","Code":"Sub mHelp1_Click (Index As Integer)\r\nSelect Case Index\r\n    Case 0\r\n    Case 1  'Search help file\r\n        CMDialog1.HelpCommand = HELP_KEY ' Help on Windows Help.\r\n        CMDialog1.Action = 6    ' Execute WINHELP.EXE.\r\n    Case 2 ' Help on Help\r\n        CMDialog1.HelpCommand = HELP_HELPONHELP ' Help on Windows HElp.\r\n        CMDialog1.Action = 6    ' Execute WINHELP.EXE.\r\n    Case 3 ' separator - not used\r\n    Case 4  ' about box\r\n        AboutBox.Show 1\r\nEnd Select\r\nEnd Sub\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Help","WinHelp"]},{"RecordId":"130","Title":"Set Mask Edit control to blanks","Description":"Set a masked edit control (that requires numbers) to blanks","Code":"vTemp = mskMaskEdit.Mask\r\nmskMaskEdit.Mask = \"\"\r\nmskMaskEdit.Text = \"\"\r\nmskMaskEdit.Mask = vTemp\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Masked Edit"]},{"RecordId":"131","Title":"Set Tab Stops in a List Box","Description":"To set ListBox tabs you need to use an API call to SendMessage.","Code":"Sub Settabs\r\n    redim tabvals%(8)\r\n    tabvals%(0)  =  16\r\n    tabvals%(1)  =  24\r\n    tabvals%(2)  =  32\r\n    tabvals%(3)  =  40\r\n    di& = SendMessage(List1.hWnd, LB_SETTABSTOPS, 4, tabvals%(0))\r\nEnd Sub\r\n \r\n","Declares":"Declare Function SendMessage Lib \"User\" (ByVal hwnd As Integer, ByVal wMsg As Integer, ByVal wParam As Integer, lParam As Any) As Long\r\nConst WM_USER = &H400\r\nConst LB_SETTABSTOPS = WM_USER + 19","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["List Box","Tab Stops"]},{"RecordId":"132","Title":"Register Un-register OCX, DLL, OLE Servers","Description":"How to register OCXs, DLLs, and OLE servers","Code":"To register an OCX:\r\n\r\n1.\tCopy the OCX to C:\\windows\\system directory.\r\n2.\tIssue the command REGOCX32.EXE C:\\windows\\system directory\\myctl.OCX.\r\n\tIf 16 bit, use REGOCX16.EXE.  \r\n\r\nTo register an in-process OLE server:\r\n\r\n1.\tCopy the DLL or EXE to your application directory.\r\n2.\tIssue the command REGSVR32.EXE C:\\MYDIR\\MYDLL.DLL. \r\n\r\nTo un-register an in-process OLE server:\r\n\r\n1.\tIssue the command REGSVR32.EXE /U C:\\MYDIR\\MYDLL.DLL. \r\n\r\nTo register standalone OLE servers:\r\n\r\n1.\tMYOLESVR.EXE /REGSERVER\r\n\r\nTo un-register standalone OLE servers:\r\n\r\n1.\tMYOLESVR.EXE /UNREGSERVER\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Register","Unregister","Registering controls/DLLs"]},{"RecordId":"133","Title":"Prevent Window More/Resizing","Description":"Prevents a window from being moved or resized","Code":"'Place the following code in the Form_Load event\r\nMsgHook.hWnd = Me.hWnd\r\nMsgHook.Message(WM_WINDOWPOSCHANGING) = True\r\n\r\n\r\nSub MsgHook_Message(msg As Integer, wParam As Integer, lParam As Long, result As Long)\r\n\r\n' This subroutine will intercept the window move\r\n' and resize events to prevent it from being\r\n' moved or resized.  MsgHook is a MsgBlaster type\r\n' of control.\r\n\r\nDim WinPosition As WINDOWPOS\r\n\r\nIf msg = WM_WINDOWPOSCHANGING Then\r\n\r\n    Call hmemcpy(WinPosition, ByVal lParam, Len(WinPosition))\r\n    WinPosition.Flags = WinPosition.Flags Or SWP_NOMOVE Or SWP_NOSIZE\r\n    Call hmemcpy(ByVal lParam, WinPosition, Len(WinPosition))\r\n    result = 0\r\n\r\nEnd Sub","Declares":"","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Move Window","Size Window","MsgBlaster"]},{"RecordId":"134","Title":"Registry (Using it)","Description":"Routines to add/delete keys & values, and retrieve values from the registry","Code":"Dim lresult As Long\r\nDim hNewKey As Long\r\nDim strMyValue As String\r\nDim lngMyValue As Long\r\nDim lRetVal As Long\r\nDim hKey As Long\r\nDim cch As Long\r\nDim lType As Long\r\n\r\n\r\n'Add a key\r\nlRetVal = RegCreateKeyEx(HKEY_CLASSES_ROOT, \"Zebra1\\ZebraSub1\", 0&, vbNullString, REG_OPTION_NON_VOLATILE, KEY_ALL_ACCESS, 0&, hNewKey, lRetVal)\r\nlRetVal = RegCloseKey(hNewKey)\r\n\r\n\r\n'Change/Create a string value\r\nstrMyValue = \"AbcDef\"\r\nlresult = RegOpenKey(HKEY_CLASSES_ROOT, \"Zebra1\\ZebraSub1\", hKey)\r\nlresult = RegSetValueEx(hKey, \"My String Entry\", 0, REG_SZ, ByVal strMyValue, Len(strMyValue))\r\nlresult = RegCloseKey(hKey)\r\n\r\n\r\n'Change/Create a numeric value\r\nlngMyValue = 123\r\nlresult = RegOpenKey(HKEY_CLASSES_ROOT, \"Zebra1\\ZebraSub1\", hKey)\r\nlresult = RegSetValueEx(hKey, \"My Numeric Entry\", 0, REG_DWORD, lngMyValue, REG_DWORD)\r\nlresult = RegCloseKey(hKey)\r\n\r\n\r\n'Retrieve a string/numeric value\r\nlresult = RegQueryValueExNULL(hKey, \"My Entry\", 0&, lType, 0&, cch)\r\nSelect Case lType\r\n    'Strings\r\n    Case REG_SZ:\r\n        strMyValue = String(cch, 0)\r\n        lresult = RegQueryValueEx(hKey, \"My Entry\", 0&, lType, ByVal strMyValue, cch)\r\n        If lresult = 0 Then\r\n            strMyValue = Left$(strMyValue, cch - 1)\r\n        Else\r\n            strMyValue = \"\"\r\n        End If\r\n    'DWORDS\r\n    Case REG_DWORD:\r\n        lresult = RegQueryValueEx(hKey, \"My Entry\", 0&, lType, lngMyValue, cch)\r\n        If lresult <> 0 Then\r\n            lngMyValue = 0\r\n        End If\r\n    Case Else\r\n    'all other data types not supported\r\nEnd Select\r\nlresult = RegCloseKey(hKey)\r\n\r\n\r\n'Delete one value\r\nlresult = RegOpenKey(HKEY_CLASSES_ROOT, \"Zebra1\\ZebraSub1\", hKey)\r\nlresult = RegDeleteValue(hKey, \"My Numeric Entry\")\r\nlresult = RegCloseKey(hKey)\r\n\r\n\r\n'Delete a key (does not require open/close key, but can't delete a key if it has subkeys)\r\nlresult = RegDeleteKey(HKEY_CLASSES_ROOT, \"Zebra1\\ZebraSub1\")\r\nlresult = RegDeleteKey(HKEY_CLASSES_ROOT, \"Zebra1\")\r\n","Declares":"Declare Function RegCloseKey Lib \"advapi32.dll\" (ByVal hKey As Long) As Long\r\nDeclare Function RegDeleteKey Lib \"advapi32.dll\" Alias \"RegDeleteKeyA\" (ByVal hKey As Long, ByVal lpSubKey As String) As Long\r\nDeclare Function RegDeleteValue Lib \"advapi32.dll\" Alias \"RegDeleteValueA\" (ByVal hKey As Long, ByVal lpValueName As String) As Long\r\nDeclare Function RegOpenKey Lib \"advapi32.dll\" Alias \"RegOpenKeyA\" (ByVal hKey As Long, ByVal lpSubKey As String, phkResult As Long) As Long\r\nDeclare Function RegQueryValueEx Lib \"advapi32.dll\" Alias \"RegQueryValueExA\" (ByVal hKey As Long, ByVal lpValueName As String, ByVal lpReserved As Long, lpType As Long, lpData As Any, lpcbData As Long) As Long         ' Note that if you declare the lpData parameter as String, you must pass it By Value.\r\nDeclare Function RegSetValueEx Lib \"advapi32.dll\" Alias \"RegSetValueExA\" (ByVal hKey As Long, ByVal lpValueName As String, ByVal Reserved As Long, ByVal dwType As Long, lpData As Any, ByVal cbData As Long) As Long         ' Note that if you declare the lpData parameter as String, you must pass it By Value.\r\nDeclare Function RegCreateKeyEx Lib \"advapi32.dll\" Alias \"RegCreateKeyExA\" (ByVal hKey As Long, ByVal lpSubKey As String, ByVal Reserved As Long, ByVal lpClass As String, ByVal dwOptions As Long, ByVal samDesired As Long, ByVal lpSecurityAttributes As Long, phkResult As Long, lpdwDisposition As Long) As Long\r\nDeclare Function RegQueryValueExNULL Lib \"advapi32.dll\" Alias \"RegQueryValueExA\" (ByVal hKey As Long, ByVal lpValueName As String, ByVal lpReserved As Long, lpType As Long, ByVal lpData As Long, lpcbData As Long) As Long\r\n\r\nPublic Const HKEY_CLASSES_ROOT = &H80000000\r\nPublic Const HKEY_CURRENT_CONFIG = &H80000005\r\nPublic Const HKEY_CURRENT_USER = &H80000001\r\nPublic Const HKEY_DYN_DATA = &H80000006\r\nPublic Const HKEY_LOCAL_MACHINE = &H80000002\r\nPublic Const HKEY_USERS = &H80000003\r\n\r\nPublic Const REG_SZ = 1\r\nPublic Const REG_DWORD = 4\r\n\r\nPublic Const ERROR_SUCCESS = 0&\r\nPublic Const REG_OPTION_NON_VOLATILE = 0\r\nPublic Const STANDARD_RIGHTS_ALL = &H1F0000\r\nPublic Const KEY_QUERY_VALUE = &H1\r\nPublic Const KEY_CREATE_SUB_KEY = &H4\r\nPublic Const KEY_ENUMERATE_SUB_KEYS = &H8\r\nPublic Const KEY_NOTIFY = &H10\r\nPublic Const KEY_CREATE_LINK = &H20\r\nPublic Const SYNCHRONIZE = &H100000\r\nPublic Const KEY_SET_VALUE = &H2\r\nPublic Const KEY_ALL_ACCESS = ((STANDARD_RIGHTS_ALL Or KEY_QUERY_VALUE Or KEY_SET_VALUE Or KEY_CREATE_SUB_KEY Or KEY_ENUMERATE_SUB_KEYS Or KEY_NOTIFY Or KEY_CREATE_LINK) And (Not SYNCHRONIZE))\r\n\r\nType SECURITY_ATTRIBUTES\r\n        nLength As Long\r\n        lpSecurityDescriptor As Long\r\n        bInheritHandle As Boolean\r\nEnd Type\r\n\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Registry"]},{"RecordId":"135","Title":"Smart Forms (Remembers position)","Description":"Routines to display a form in the same place that it was previously displayed, then save its new position","Code":"'Display the form with this call\r\nCall DialogLoad(Me.hWnd, FormToDisplay) \r\n\r\n'Put this is the displayed forms unload event\r\nCall DialogUnload(Me) \r\n  \r\n'If you want to center the displayed form over the calling form (parent)\r\n' then place this code in the form to be displayed's form load event and\r\n' remove the code that gets the prior position.\r\nCall DialogCenterParent(frmParent.hWnd, Me)\r\n\r\n'--------------------------------------------------------------------------\r\n'The following (all of it) goes in a separate code module\r\nDim mbSmartDialogs As Integer\r\n\r\nConst MODAL = 1\r\nConst MODELESS = 0\r\nConst DEFAULT = 0\r\nConst HOURGLASS = 11\r\n\r\nType RectType\r\n    iLeft As Integer\r\n    iTop As Integer\r\n    iRight As Integer\r\n    iBottom As Integer\r\nEnd Type\r\n\r\nConst MF_BYPOSITION = &H400\r\n\r\nDeclare Function GetPrivateProfileInt% Lib \"Kernel\" (ByVal lpApplicationName$, ByVal lpKeyName$, ByVal nDefault%, ByVal lpFileName$)\r\nDeclare Function WritePrivateProfileString% Lib \"Kernel\" (ByVal lpApplicationName$, ByVal lpKeyName$, ByVal lpString$, ByVal lplFileName$)\r\nDeclare Sub GetWindowRect Lib \"User\" (ByVal hWnd%, lpRect As RectType)\r\nDeclare Function GetSystemMenu% Lib \"User\" (ByVal hWnd%, ByVal bRevert%)\r\nDeclare Function RemoveMenu% Lib \"User\" (ByVal hMenu%, ByVal nPosition%, ByVal wFlags%)\r\n\r\nPrivate Function DialogGetINIInteger (sKeyName As String, iDefault As Integer) As Integer\r\n    DialogGetINIInteger = GetPrivateProfileInt(App.Title, sKeyName, iDefault, App.EXEName & \".INI\")\r\nEnd Function\r\n\r\nFunction DialogGetSmart () As Integer\r\n    DialogGetSmart = mbSmartDialogs\r\nEnd Function\r\n\r\nSub DialogLoad (ByVal hWndParent As Integer, frmDialog As Form)\r\n\r\nDim iLeft As Integer\r\nDim iTop As Integer\r\nDim iMidX As Integer\r\nDim iMidY As Integer\r\nDim hWndCtlMenu As Integer\r\nDim iRetCode As Integer\r\nDim rcParent As RectType\r\n\r\nScreen.MousePointer = HOURGLASS\r\n\r\n\r\n'See if forms position has been previously saved\r\nIf mbSmartDialogs = True Then\r\n    iLeft = DialogGetINIInteger(frmDialog.Tag & \"Left\", 0)\r\n    iTop = DialogGetINIInteger(frmDialog.Tag & \"Top\", 0)\r\nEnd If\r\n\r\n'If forms previous position was not found, center it\r\nIf (mbSmartDialogs = False) Or (iLeft = 0 And iTop = 0) Then\r\n    If hWndParent = 0 Then\r\n        iMidX = Screen.Width / 2\r\n        iMidY = Screen.Height / 2\r\n    Else\r\n        Call GetWindowRect(hWndParent, rcParent)\r\n        iMidX = ((rcParent.iLeft * Screen.TwipsPerPixelX) + (rcParent.iRight * Screen.TwipsPerPixelY)) / 2\r\n        iMidY = ((rcParent.iTop * Screen.TwipsPerPixelY) + (rcParent.iBottom * Screen.TwipsPerPixelY)) / 2\r\n    End If\r\n    iLeft = iMidX - (frmDialog.Width) / 2\r\n    iTop = iMidY - (frmDialog.Height) / 2\r\nEnd If\r\n\r\n'If from is outside of screen, move it inside\r\nIf iLeft < 0 Then\r\n    iLeft = 0\r\nElseIf (iLeft + frmDialog.Width) > Screen.Width Then\r\n    iLeft = Screen.Width - frmDialog.Width\r\nEnd If\r\n\r\nIf iTop < 0 Then\r\n    iTop = 0\r\nElseIf (iTop + frmDialog.Height) > Screen.Height Then\r\n    iTop = Screen.Height - frmDialog.Height\r\nEnd If\r\n\r\n\r\n'Move form to its new position\r\nfrmDialog.Move iLeft, iTop\r\n\r\n'Remove all but the MOVE and CLOSE options from Control Box Menu.\r\nhWndCtlMenu = GetSystemMenu(frmDialog.hWnd, 0)\r\niRetCode = RemoveMenu(hWndCtlMenu, 8, MF_BYPOSITION)'Switch to\r\niRetCode = RemoveMenu(hWndCtlMenu, 7, MF_BYPOSITION)'Separator\r\niRetCode = RemoveMenu(hWndCtlMenu, 5, MF_BYPOSITION)'Separator\r\n\r\n'Show form modally\r\nScreen.MousePointer = DEFAULT\r\nfrmDialog.Show MODAL\r\n\r\nEnd Sub\r\n\r\nSub DialogSetSmart (ByVal bValue As Integer)\r\nmbSmartDialogs = bValue\r\nEnd Sub\r\n\r\nSub DialogUnload (frmDialog As Form)\r\n\r\nIf mbSmartDialogs = True Then\r\n    Call DialogWriteINIInteger(frmDialog.Tag & \"Left\", frmDialog.Left)\r\n    Call DialogWriteINIInteger(frmDialog.Tag & \"Top\", frmDialog.Top)\r\nEnd If\r\n\r\nUnload frmDialog\r\n\r\nEnd Sub\r\n\r\nPrivate Sub DialogWriteINIInteger (sOption As String, ByVal iValue As Integer)\r\n    Dim iRetCode As Integer\r\n    iRetCode = WritePrivateProfileString(App.Title, sOption, Format$(iValue), App.EXEName & \".INI\")\r\nEnd Sub\r\n","Declares":"'The following goes in a separate code module\r\nDim mbSmartDialogs As Integer\r\n\r\nConst MODAL = 1\r\nConst MODELESS = 0\r\nConst DEFAULT = 0\r\nConst HOURGLASS = 11\r\n\r\nType RectType\r\n    iLeft As Integer\r\n    iTop As Integer\r\n    iRight As Integer\r\n    iBottom As Integer\r\nEnd Type\r\n\r\nConst MF_BYPOSITION = &H400\r\n\r\nDeclare Function GetPrivateProfileInt% Lib \"Kernel\" (ByVal lpApplicationName$, ByVal lpKeyName$, ByVal nDefault%, ByVal lpFileName$)\r\nDeclare Function WritePrivateProfileString% Lib \"Kernel\" (ByVal lpApplicationName$, ByVal lpKeyName$, ByVal lpString$, ByVal lplFileName$)\r\nDeclare Sub GetWindowRect Lib \"User\" (ByVal hWnd%, lpRect As RectType)\r\nDeclare Function GetSystemMenu% Lib \"User\" (ByVal hWnd%, ByVal bRevert%)\r\nDeclare Function RemoveMenu% Lib \"User\" (ByVal hMenu%, ByVal nPosition%, ByVal wFlags%)\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Position Form","Save Form Position"]},{"RecordId":"136","Title":"Status Bar Display","Description":"Subroutine to display status bar and have percent string reverse colors as bar passes over string.","Code":"'Put in form load event\r\n\r\n    picStatus.AutoRedraw = True\r\n    picStatus.DrawMode = 10\r\n    picStatus.FillStyle = 0\r\n\r\n'Call with \r\ndim i as integer\r\nfor i = 0 to 100\r\n    call UpdateStatus i\r\nnext\r\n\r\nSub UpdateStatus (pctValue As Integer)\r\n    Dim pct$\r\n    Dim rv As Integer\r\n    Const SRCCOPY = &HCC0020\r\n\r\n    pct$ = Format$(pctValue) & \"%\"\r\n    picStatus.Cls\r\n    picStatus.CurrentX = (picStatus.ScaleWidth - picStatus.TextWidth(pct$)) \\ 2\r\n    picStatus.CurrentY = (picStatus.ScaleHeight - picStatus.TextHeight(pct$)) \\ 2\r\n    picStatus.Print pct$\r\n    picStatus.Line (0, 0)-(pctValue * picStatus.ScaleWidth / 100, picStatus.ScaleHeight), picStatus.ForeColor, BF\r\n    ' Dont need this  -->  rv = BitBlt(picStatus.hDC, 0, 0, picStatus.ScaleWidth, picStatus.ScaleHeight, picStatus.hDC, 0, 0, SRCCOPY)\r\n    DoEvents\r\nEnd Sub\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Status Bar","Progress Bar"]},{"RecordId":"137","Title":"Capture screen to a bitmap","Description":"Captures a screen to a bitmap image","Code":"Public Sub FileCapture()\r\n\r\nDim intHt As Integer\r\nDim intWd As Integer\r\nDim rWidth As Integer\r\nDim rHeight As Integer\r\nDim intTop As Integer\r\nDim intLeft As Integer\r\nDim SourceDC As Long\r\nDim DestDC As Long\r\nDim BHandle As Long\r\nDim Wnd As Long\r\nDim Dummy As DEVMODE\r\n\r\nintHt = Screen.Height / Screen.TwipsPerPixelX\r\nintWd = Screen.Width / Screen.TwipsPerPixelY\r\n\r\nScreen.ActiveForm.WindowState = vbMinimized\r\nDoEvents\r\n\r\nintLeft = 0\r\nintTop = 0\r\n\r\nrWidth = intWd - intLeft\r\nrHeight = intHt = intTop\r\n\r\n'Create a device context for the screen and copy the screen to a bitmap\r\nSourceDC = CreateDC(\"DISPLAY\", 0, 0, Dummy)\r\nDestDC = CreateCompatibleDC(SourceDC)\r\nBHandle = CreateCompatibleBitmap(SourceDC, rWidth, rHeight)\r\nSelectObject DestDC, BHandle\r\nBitBlt DestDC, 0, 0, rWidth, rHeight, SourceDC, intLeft, intTop, &HCC0020\r\n\r\n'Copy the bitmap to the clipboard\r\nWnd = Form1.hwnd\r\nOpenClipboard Wnd\r\nEmptyClipboard\r\nSetClipboardData 2, BHandle\r\nCloseClipboard\r\n\r\n'Clean-up\r\nDeleteDC DestDC\r\nReleaseDC BHandle, SourceDC  '** this line may be wrong\r\n\r\n'Copy clipboard bitmap to image control\r\nForm1.Image1.Picture = Clipboard.GetData()\r\n\r\nEnd Sub\r\n\r\n\r\n","Declares":"Declare Function ReleaseDC Lib \"user32\" (ByVal hwnd As Long, ByVal hdc As Long) As Long\r\nDeclare Function OpenClipboard Lib \"user32\" (ByVal hwnd As Long) As Long\r\nDeclare Function EmptyClipboard Lib \"user32\" () As Long\r\nDeclare Function SetClipboardData Lib \"user32\" (ByVal wFormat As Long, ByVal hMem As Long) As Long\r\nDeclare Function CloseClipboard Lib \"user32\" () As Long\r\nDeclare Function SelectObject Lib \"gdi32\" (ByVal hdc As Long, ByVal hObject As Long) As Long\r\nDeclare Function DeleteDC Lib \"gdi32\" (ByVal hdc As Long) As Long\r\nDeclare Function BitBlt Lib \"gdi32\" (ByVal hDestDC As Long, ByVal x As Long, ByVal y As Long, ByVal nWidth As Long, ByVal nHeight As Long, ByVal hSrcDC As Long, ByVal xSrc As Long, ByVal ySrc As Long, ByVal dwRop As Long) As Long\r\nDeclare Function CreateDC Lib \"gdi32\" Alias \"CreateDCA\" (ByVal lpDriverName As String, ByVal lpDeviceName As String, ByVal lpOutput As String, lpInitData As DEVMODE) As Long\r\nDeclare Function CreateCompatibleDC Lib \"gdi32\" (ByVal hdc As Long) As Long\r\nDeclare Function CreateCompatibleBitmap Lib \"gdi32\" (ByVal hdc As Long, ByVal nWidth As Long, ByVal nHeight As Long) As Long\r\n\r\nPublic Const CCHDEVICENAME = 32\r\nPublic Const CCHFORMNAME = 32\r\n\r\nType DEVMODE\r\n        dmDeviceName As String * CCHDEVICENAME\r\n        dmSpecVersion As Integer\r\n        dmDriverVersion As Integer\r\n        dmSize As Integer\r\n        dmDriverExtra As Integer\r\n        dmFields As Long\r\n        dmOrientation As Integer\r\n        dmPaperSize As Integer\r\n        dmPaperLength As Integer\r\n        dmPaperWidth As Integer\r\n        dmScale As Integer\r\n        dmCopies As Integer\r\n        dmDefaultSource As Integer\r\n        dmPrintQuality As Integer\r\n        dmColor As Integer\r\n        dmDuplex As Integer\r\n        dmYResolution As Integer\r\n        dmTTOption As Integer\r\n        dmCollate As Integer\r\n        dmFormName As String * CCHFORMNAME\r\n        dmUnusedPadding As Integer\r\n        dmBitsPerPel As Integer\r\n        dmPelsWidth As Long\r\n        dmPelsHeight As Long\r\n        dmDisplayFlags As Long\r\n        dmDisplayFrequency As Long\r\nEnd Type\r\n\r\n\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Capture Screen","Screen capture"]},{"RecordId":"138","Title":"Registry Usage","Description":"Examples of what registry keys to use.  Also Jet registry settings.","Code":"Registry settings that affect the entire PC\r\nHKEY_LOCAL_MACHINE\r\n\r\nRegistry settings that affect the currently logged in user\r\nHKEY_CURRENT_USER\r\n\r\nRegistry settings that affect the current application for the currently logged in user\r\nHKEY_CURRENT_MACHINE\r\n\r\n\r\nSetting Jet options in the registry\r\n\r\nDBEngine.INIPath = \"HKEY_CURRENT_USER\\SOFTWARE\\MyApps\\ThisApp\\Jet\\3.0\"\r\nset db = OpenDatabase(\"workdb\")\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"7","CategoryDescription":"Misc"},"Keywords":["Registry"]},{"RecordId":"139","Title":"Set File Date/Time (16 bit)","Description":"Set a file's date/time.  Requires VBASM.VBX.","Code":"'-- Call the function like this....\r\n\r\nCall SetFileDate(\"c:\\autoexec.bat\", \"10/16/96 12:30 am\")\r\n\r\n\r\n\r\nSub SetFileDate (sFileName As String, sDate As String)\r\n\r\n\tDim hFile As Integer\r\n\tDim iHour As Integer\r\n\tDim iMinute As Integer\r\n\tDim iSecond As Integer\r\n\tDim iYear As Integer\r\n\tDim iMonth As Integer\r\n\tDim iDate As Integer\r\n\tDim Regs As VBREGS\r\n    \r\n\thFile = FreeFile\r\n\tOpen sFileName For Binary As hFile\r\n\r\n\tiHour = Hour(sDate)\r\n\tiMinute = Minute(sDate)\r\n\tiSecond = Second(sDate)\r\n\r\n\tiYear = Year(sDate)\r\n\tiMonth = Month(sDate)\r\n\tiDate = Day(sDate)\r\n\r\n\tRegs.AX = &H5701\r\n\tRegs.BX = FileAttr(hFile, 2)\r\n\tRegs.CX = Signed(iHour * 2048& + iMinute * 32 + _\r\n\t\tiSecond \\ 2)\r\n\tRegs.DX = Signed((iYear - 1980) * _\r\n\t\t512& + iMonth * 32 + iDate)\r\n\tCall vbInterrupt(&H21, Regs, Regs)\r\n\r\n\tClose hFile\r\n\r\nEnd Sub\r\n\r\nFunction Signed (lValue As Long) As Integer\r\n\r\n\t'Converts unsigned integer to signed equivalent.\r\n\r\n\tIf lValue > 32767 Then\r\n\tSigned = lValue - 65536\r\n\tElse\r\n\tSigned = lValue\r\n\tEnd If\r\n\r\nEnd Function\r\n","Declares":"Type VBREGS\r\n\tAX As Integer\r\n\tBX As Integer\r\n\tCX As Integer\r\n\tDX As Integer\r\n\tBP As Integer\r\n\tSI As Integer\r\n\tDI As Integer\r\n\tFlags As Integer\r\n\tDS As Integer\r\n\tES As Integer\r\nEnd Type\r\n\r\nDeclare Sub vbInterrupt Lib \"VBASM.DLL\" (ByVal IntNum _\r\n\tAs Integer, InRegs As VBREGS, OutRegs As VBREGS)\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["File Date/Time","File Info"]},{"RecordId":"140","Title":"Key Press Validation","Description":"Various routines to validate key presses on date, numeric, currency, etc. text boxes.","Code":"Public Function CheckDecimalKeyPress(ByVal KeyAscii As Integer) As Integer\r\n\r\n    If (KeyAscii < 48 Or KeyAscii > 57) And (KeyAscii <> 8) And (KeyAscii <> 45) And (KeyAscii <> 46) Then\r\n        KeyAscii = 0\r\n        Beep\r\n    End If\r\n    \r\n    CheckDecimalKeyPress = KeyAscii\r\n\r\nEnd Function\r\n\r\n\r\nPublic Function CheckNumberKeyPress(ByVal KeyAscii As Integer) As Integer\r\n\r\n    If (KeyAscii < 48 Or KeyAscii > 57) And (KeyAscii <> 8) Then\r\n        KeyAscii = 0\r\n        Beep\r\n    End If\r\n    \r\n    CheckNumberKeyPress = KeyAscii\r\n    \r\nEnd Function\r\n\r\n\r\nPublic Function UpperCaseKeyPress(ByVal KeyAscii As Integer) As Integer\r\n\r\n    If KeyAscii >= 97 And KeyAscii <= 122 Then\r\n        KeyAscii = KeyAscii - 32\r\n    End If\r\n    \r\n    UpperCaseKeyPress = KeyAscii\r\n    \r\nEnd Function\r\n\r\nPublic Function CheckDateKeyPress(KeyAscii As Integer) As Integer\r\n    \r\n    If (KeyAscii < 48 Or KeyAscii > 57) And (KeyAscii <> 8) And (KeyAscii <> 47) Then\r\n        KeyAscii = 0\r\n        Beep\r\n    End If\r\n    \r\n    CheckDateKeyPress = KeyAscii\r\n\r\nEnd Function\r\n\r\n\r\nPublic Function CheckTimeKeyPress(KeyAscii As Integer) As Integer\r\n\r\n    If (KeyAscii < 48 Or KeyAscii > 57) And (KeyAscii <> 8) And (KeyAscii <> 58) Then\r\n        KeyAscii = 0\r\n        Beep\r\n    End If\r\n    \r\n    CheckTimeKeyPress = KeyAscii\r\n\r\nEnd Function\r\n\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Key Press - Validation","Validation"]},{"RecordId":"141","Title":"Play WAV From Resource File","Description":"Plays a WAV from a Resource File\r\nNOTE:  This has to run from an EXE.  It will not work in the VB IDE.","Code":"Public Sub PlaySound()\r\n\r\nDim hInst As Long\r\nDim strSoundName As String\r\nDim lngFlags As Long\r\nDim lngRet As Long\r\n\r\nhInst = App.hInstance\r\nstrSoundName = \"MySound\"\r\nlngFlags = SND_RESOURCE + SND_ASYNC + SND_NODEFAULT\r\n\r\nlngRet = PlaySound(strSoundName, hInst, lngFlags)\r\n\r\n\r\nEnd Sub\r\n\r\n\r\n","Declares":"\r\nDeclare Function PlaySound Lib \"winmm.dll\" Alias \"PlaySoundA\" (ByVal lpszName As String, ByVal hModule As Long, ByVal dwFlags As Long) As Long\r\n\r\nPrivate Const SND_ASYNC& = &H1\r\nPrivate Const SND_NODEFAULT& = &H2\r\nPrivate Const SND_RESOURCE& = &H40004\r\n\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["WAV","Sound","Resource File"]},{"RecordId":"142","Title":"Adding Controls At Runtime","Description":"How to add controls to a form at runtime","Code":"' -- VB5 (A control array of Text1() must already exist)\r\nLoad Text1(2)\r\nText1(2).Text = \"New Text Box\"\r\nText1(2).Top = 500\r\nText1(2).Left = 20\r\nText1(2).Visible = True\r\n\r\n' -- VB6\r\nDim cmdButton as Object\r\nset cmdButton = Form1.Controls.Add(\"VB.CommandButton\", \"newButton\")\r\ncmdButton.Caption = \"New Button\"\r\ncmdButton.Height = 1100\r\ncmdButton.Width = 1200\r\ncmdButton.Visible = True\r\n\r\n' If licenses are required ...\r\nLicenses.Add \"MSFlexGridLib.MSFlexGrid.1\"","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Adding Controls","Dynamically adding controls","Runtime"]},{"RecordId":"143","Title":"Wavs in VB","Description":"To get .WAVs to work in VB","Code":"Sub PlaySound()\r\ndim x%\r\nx% = sndPlaySound(\"C:\\Windows\\Ahead.Wav\", 1)\r\nEnd Sub","Declares":"Declare function sndPlaySound Lib \"MMSYSTEM\" (byval lpWavName$, byval Flags%) as Integer\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["WAV","Multimedia"]},{"RecordId":"144","Title":"Printer Margins","Description":"Set printer margins.  \r\nLeft is set at 0.5 inches and right is top is set at 0.75 inches.","Code":"Printer.ScaleLeft = -0.75 * 1440\r\nPrinter.ScaleTop = -0.5 * 1440\r\nPrinter.CurrentX = 0\r\nPrinter.CurrentY = 0","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Printer margins","Margins"]},{"RecordId":"145","Title":"Network Tid-Bits","Description":"Some network information passed along by a helpful soul on the internet.","Code":"'You can access an Access Database by simply specifiying the complete network path name in your OpenDatabase function:\r\nSet MyDB = OpenDatabase(\"\\\\YOUR_SERVER_NAME\\SHARE_NAME\\DATABASE\\MYFILES\\MYDB.MDB\")\r\n \r\nYou can also connect, disconnect, and find information about network drives with the following functions:\r\n'Network Constants\r\n \r\nGlobal Const WN_Success = &H0\r\nGlobal Const WN_Not_Supported = &H1\r\nGlobal Const WN_Net_Error = &H2\r\nGlobal Const WN_Bad_Pointer = &H4\r\nGlobal Const WN_Bad_NetName = &H32\r\nGlobal Const WN_Bad_Password = &H6\r\nGlobal Const WN_Bad_Localname = &H33\r\nGlobal Const WN_Access_Denied = &H7\r\nGlobal Const Wn_Out_Of_Memory = &HB\r\nGlobal Const WN_Already_Connected = &H34\r\n \r\n'NETWORK API Calls\r\n \r\nDeclare Function WNetAddConnection Lib \"User\" (ByVal lpszNetPath As String, ByVal lpszPassword As String, ByVal lpszLocalName As String) As Integer\r\nDeclare Function GetDriveType Lib \"kernel\" (ByVal nDrive As Integer) As Integer\r\nDeclare Function WNetCancelConnection Lib \"User\" (ByVal lpszName As String, ByVal bForce As Integer) As Integer\r\nDeclare Function WNetGetConnection Lib \"User\" (ByVal lpszLocalName As String, ByVal lpszRemoteName As String, cbRemoteName As Integer) As Integer\r\n \r\nHere's an example of how to connect a network drive:\r\n \r\nAPI_Error = WNetAddConnection(\"\\\\YOUR_SERVER\\YOUR_SHARE\" + Chr$(0),\"password\" + Chr$(0), \"M:\"+ Chr$(0))\r\nIf API_Error <> WN_Success Then\r\n     MsgBox \"Error Connecting to Network Resource.\"\r\n     Exit Sub\r\nEnd If\r\n","Declares":"","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Network","Drive Mappings","UNC"]},{"RecordId":"146","Title":"Type Ahead combo box","Description":"Add the following code in the Change event of a combo box.  I will position to the matching entry with each keystroke.","Code":"Sub ComboTypeAhead(Combo As ComboBox)\r\n\r\nGlobal gblTypeAhead As Integer\r\nDim i As Integer, Keystring As String, KeyLen As Integer\r\n\r\nKeystring = Combo.Text\r\nKeyLen = Len(Keystring)\r\ngblTypeAhead = False\r\n\r\nIf KeyLen > 0 Then\r\n    For i = 0 To Combo.ListCount - 1\r\n        If Left(Combo.List(i), KeyLen) = Keystring Then\r\n            Combo.SetFocus\r\n            Combo.ListIndex = i\r\n            Combo.SelStart = KeyLen\r\n            Combo.SelLength = Len(Combo.Text) - KeyLen\r\n            Exit For\r\n        End If\r\n    Next i\r\nEnd If\r\n\r\nEnd Sub\r\n\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Combo Box Search","Search","Type ahead"]},{"RecordId":"147","Title":"Hide Record Selector in Grid","Description":"Prevents the record selector from stepping through a grid during iterating through the grid.","Code":"'Before stepping through the grid\r\nlRetVal = LockWindowUpdate(Grid1.hwnd)\r\n\r\n'After finished stepping through the grid\r\nlRetVal = LockWindowUpdate(0)\r\n","Declares":"Declare Function LockWindowUpdate Lib \"user32\" (ByVal hwndLock As Long) As Long\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Record selector","Grid","Lock Window"]},{"RecordId":"148","Title":"Determine Next Available Drive Spec","Description":"How to Find Next Available Drive Letter (Excerpt from MSKB - Article ID: Q100834)\r\n\r\n","Code":"Function Freedrive ()\r\n      Dim DriveNum As Integer, FirstFreeDrive As String\r\n      Dim FirstDrive As Integer\r\n      DriveNum = -1\r\n      Do\r\n         DriveNum = DriveNum + 1   ' start at drive zero.\r\n         FirstDrive% = GetDriveType(DriveNum)\r\n         ' GetDriveType returns zero if it cannot determine drive\r\n         ' type or returns 1 if the specified drive does not exist.\r\n      Loop Until FirstDrive% = 0\r\n      ' DriveNum of 0 means Drive A, 1=B, 2=C, 3=D, 4=E, 5=F, and so on:\r\n      FirstFreeDrive = Chr$(DriveNum + 65) + \":\"\r\n      Freedrive = FirstFreeDrive\r\n    'Print \"The next available (unused) drive letter is: \"; Freedrive()\r\n    'Print \"The title for the EXE in Windows Task Manager: \"; app.Title\r\n    'Print \"The name of this EXE, or project in VB, is: \"; app.EXEName\r\n    'Print \"The path to this application is: \"; app.Path\r\nEnd Function\r\n","Declares":"Declare Function GetDriveType Lib \"kernel\" (ByVal nDrive As Integer) As Integer\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Drive - Next available","Hardware"]},{"RecordId":"150","Title":"Identify Networked CD drives","Description":"GetDriveType reports networked CD drives as DRIVE_REMOTE.  Combine that with GetVolumeInformation and you can determine that it is both a networked drive and a CD drive.\r\n","Code":"' Next to last parameter returns a string that identifies type of file system:\r\n' FAT, NTFS, HPFS, CDFS (CD file system)\r\n\r\npstrRootPath = \"E:\\\"\r\npstrVolName = Space$(256)\r\npstrSystemType = Space$(32)\r\nplngSysTypeSize = CLng(Len(pstrSystemType))\r\nplngVolNameSize = CLng(Len(pstrVolName))\r\nplngRtn = GetVolumeInformation(pstrRootPath, pstrVolName, plngVolNameSize, plngVolSerialNum, plngMaxFilenameLen, plngSysFlags, pstrSystemType, plngSysTypeSize)\r\n","Declares":"Declare Function GetVolumeInformation Lib \"kernel32\" Alias \"GetVolumeInformationA\" (ByVal lpRootPathName As String, ByVal lpVolumeNameBuffer As String, ByVal nVolumeNameSize As Long, lpVolumeSerialNumber As Long, lpMaximumComponentLength As Long, lpFileSystemFlags As Long, ByVal lpFileSystemNameBuffer As String, ByVal nFileSystemNameSize As Long) As Long\r\n \r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Drive Types","Hardware"]},{"RecordId":"152","Title":"INI files","Description":"To Write or Read APP.INI files","Code":"Sub WriteINI()\r\n\r\nDim msX%\r\n\r\n'   If using literals, use this\r\nmsX = WritePrivateProfileString(\"SECURITY\", \"Password\", \"ThePassword\", \"APP.INI\")\r\n\r\n'   If using a variable as the value to write, use this\r\nmsX = WritePrivateProfileString(\"SECURITY\", \"Password\", Trim$(StringVar), \"APP.INI\")\r\n\r\n'This would put the following in the file APP.INI\r\n'[SECURITY]\r\n'Password = ThePassword\r\n\r\nEnd Sub\r\n\r\nSub ReadINI()\r\ndim x%, PW$, DefaultPW$\r\nPW$ = String$(128,0)\r\nx%=GetPrivateProfileString(\"SECURITY\",\"Password\", \"\", PW$,Len(PW$),\"APP.INI\")\r\nPW$=Left$(PW$,x%)\r\n'And PW$ will contain \"ThePassword\"\r\nEnd Sub","Declares":"Declare Function WritePrivateProfileString% lib \"Kernel\" (byval AppName$, byval Key$, byval Value as Any, byval Filename$)\r\nDeclare Function GetPrivateProfileString% lib \"Kernel\"(byval AppName$, byval Key$, byval Default$, byval ReturnedString$, byval Size%, byval FileName$)\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["INI Operations"]},{"RecordId":"153","Title":"Error Display","Description":"Displays errors from the Errors Collection with tags that denote database (and ODBC) errors or regular errors.","Code":"Public Sub ShowError ()\r\n\r\ndim sError as string\r\ndim nI as integer\r\ndim sTitle as string\r\n\r\nsError = \"\"\r\nif DBEngine.Errors.Count > 0 then\r\n\tif DBEngine.Errors(DBEngine.Errors.Count-1).Number = Err.Number then\r\n\t\tsTitle = \"Database error\"\r\n\t\tFor nI = 0 to DBEngine.Errors.Count - 1\r\n\t\t\tsError = sError & DBEngine.Errors(nI) & vbCrLf\r\n\t\tNext\r\n\t\tsError = sError & vbCrLf\r\n\tEnd If\r\nEnd If\r\n\r\nif sError = \"\" then\r\n\tsTitle = \"Error\"\r\n\tsError = sError & Err.Description & vbCrLf\r\nEnd If\r\n\r\nMsgBox sError,,sTitle\r\n\r\nEnd Sub\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Jet Errors Collection","Errors Collection","Errors"]},{"RecordId":"154","Title":"Show Blocked and Blocking Processes On SQL Server","Description":"Stored procedure to displays blocked processes, and which processes are blocking other processes on SQL Server.","Code":"create proc sp_culprit\r\nas\r\n\r\n/*\r\n**\tThis procedure will assist in identifying SQL Blockers\r\n**\tIf a blocker is found it will return process information\r\n**\r\n**\tTo get results from dbcc pss you must run dbcc traceon(3604)\r\n**\tin the client window prior to calling sp_culprit\r\n**\tDatabase Systems Engineering, Starwave Corporation\r\n**\tStuart McKee 1998\r\n*/\r\n\r\n\r\nset nocount on\r\n\r\n\r\n/*\r\n**\tHow many processes are blocked?\r\n*/\r\n\r\n\tDeclare @total_blockers smallint\r\n\r\n\tselect @total_blockers =\r\n\t(select count(*) from master..sysprocesses where blocked > 0)\r\n\r\n/*\r\n**\tIf there is a blocker\r\n**\tLet's capture some info\r\n*/\r\n\r\n\tif @total_blockers < 1\r\n\t\tbegin\r\n\t\tselect getdate()\r\n\t\tprint ' '\r\n\t\tprint 'No Blockers at This Time'\r\n\t\tend\r\n   else\r\n     begin\r\n\r\n\t/*\r\n\t** \tWho's the blocker?\r\n\t*/\r\n\r\n\tselect @total_blockers 'Total Blocked Processes'\r\n\r\n\tprint ' '\r\n\r\n\tdeclare @culprit_blocker_count smallint\r\n\r\n\tselect @culprit_blocker_count =\r\n\t\t(select count(*)\r\n\t        from master..sysprocesses\r\n\t\twhere blocked = 0\r\n\t\tand spid in (\tselect blocked from master..sysprocesses\r\n\t\t\twhere blocked > 0 ))\r\n\t     begin \r\n                 print ' '\r\n\t\t select @culprit_blocker_count 'Total Culprit Blockers'\r\n                 print ' '\r\n\t     end\r\n\t\r\n\r\n\tdeclare @blocker_spid smallint\r\n\tdeclare @blocker_suid smallint\r\n\r\n\r\n\tDECLARE blocker_cursor INSENSITIVE CURSOR \r\n\tFOR (select spid from master..sysprocesses\r\n\twhere blocked = 0\r\n\tand spid in (\tselect blocked from master..sysprocesses\r\n\t\t\twhere blocked > 0 ))\r\n\r\n\tOPEN blocker_cursor\r\n\tFETCH NEXT FROM blocker_cursor INTO @blocker_spid\r\n\r\n\tWHILE (@@FETCH_STATUS <> -1)\r\n\tbegin\r\n\t\r\n\r\n\t    select @blocker_spid 'This is the Culprit'\r\n\r\n\t    select @blocker_suid =\r\n\t\t\t(select suid\r\n\t\t\t from master..sysprocesses\r\n\t\t\t where spid = @blocker_spid)\r\r\n\r\n    \t    print ' '\r\n\r\n    \t   /*\r\n  \t   **\tWe will create character strings for execution\r\n\t   */\r\n\r\n\t   Declare @sp_who_string char(20)\r\n\t   Declare @sp_lock_string char(20)\r\n\t   Declare @i_buff_string char(30)\r\n\t   Declare @o_buff_string char(30)\r\n\t   Declare @dbcc_pss_string char(30)\r\n\r\n\t   /*\r\n\t   **\tCreate sp_who string and execute\r\n\t   */\r\n\r\n\t   select getdate()\r\n\r\n\t   print '  '\r\n\r\n\t   select @sp_who_string =  \r\n\t   (\"sp_who '\" + convert(char(6),@blocker_spid) +\"'\")\r\n\t      begin \r\n                 print ' '\r\n\t\t print 'SP_WHO output for Blocker'\r\n                 print '*************************'\r\n\t         exec (@sp_who_string)\r\n\t      end\r\n\r\n\t   /*\r\n\t   **\tCreate sp_lock string and execute\r\n\t   */\r\n\r\n\r\n\t   select @sp_lock_string = \r\n\t   ('sp_lock ' + convert(char(6),@blocker_spid))\r\n\t     begin\r\n                 print ' '\r\n\t\t print 'SP_LOCK output for Blocker'\r\n                 print '**************************'\r\n\t     end\r\n\t   exec (@sp_lock_string)\r\n\r\n\r\n\t   /*\r\n\t   **\tCreate dbcc inputputbuffer string and execute\r\n\t   */\r\n\r\n\t   select @i_buff_string =\r\n\t   (\"dbcc inputbuffer (\" + convert(char(6),@blocker_spid) +\")\")\r\n\t     begin\r\n                 print ' '\r\n\t\t print 'INPUTBUFFER output for Blocker'\r\n                 print '******************************'\r\n\t     end\r\n\t   exec (@i_buff_string)\r\n\r\n\t   /*\r\n\t   **\tCreate dbcc outputbuffer string and execute\r\n\t   */\r\n\r\n\t   select @o_buff_string =\r\n\t   (\"dbcc outputbuffer (\" + convert(char(6),@blocker_spid) +\")\")\r\n\t     begin\r\n                 print ' '\r\n\t\t print 'OUTPUTBUFFER output for Blocker'\r\n                 print '*******************************'\r\n\t     end\r\n\t   exec (@o_buff_string)\r\n\r\n\t   /*\r\n\t   **\tCreate dbcc pss string and execute\r\n\t   */\r\n\r\n\t   select @dbcc_pss_string =\r\n\t   (\"dbcc pss(\"+convert(char(5),@blocker_suid)+\",\"+convert(char(3),@blocker_spid)+\",1)\")\r\n\t     begin\r\n                 print ' '\r\n\t\t print 'DBSS PSS will only print if a dbcc traceon(3604) is issued prior'\r\n\t\t print 'DBCC PSS output for Blocker'\r\n                 print '***************************'\r\n\t     end\r\n\r\n  \t   select @dbcc_pss_string =  \r\n\t   (\"dbcc pss(\"+convert(char(5),@blocker_suid)+\",\"+convert(char(4),@blocker_spid)+\",0)\")\r\n\r\n\t   exec (@dbcc_pss_string)\r\n\r\n\t     begin\r\n                 print ' '\r\n\t\t print 'END of Blocker Output for CULPRIT'\r\n                 print '*********************************'\r\n                 print ' '\r\n\t     end\r\n\r\n\r\n   \t   FETCH NEXT FROM blocker_cursor INTO @blocker_spid\r\n\r\n\tend\r\n\r\n\tDEALLOCATE blocker_cursor\r\n     end\r\n\r\n\t/*\r\n\t**\tThats all folks\r\n\t*/\r\nGO\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"10","CategoryDescription":"SQL Server"},"Keywords":["Blocked Processes"]},{"RecordId":"156","Title":"Previous Instance of Application Running","Description":"Determine if previous instance of an application is already running.","Code":"Sub Main()\r\n\r\nDim hWnd As Integer\r\nDim iResult As Integer\r\n\r\nApp.Title = \"My Application\"\r\nIf App.PrevInstance Then\r\n    hWnd = FindWindow(\"ThunderForm\", App.Title)\r\n    If hWnd <> 0 Then\r\n        iResult = ShowWindow(hWnd, SW_RESTORE)\r\n        iResult = SetFocusAPI(hWnd)\r\n        End\r\n    End If\r\nElse\r\n    frmMain.Show\r\nEnd If\r\n\r\nEnd Sub\r\n","Declares":"Global Const SW_RESTORE = 9\r\n\r\nDeclare Function FindWindow Lib \"User\" (ByVal lpClassName As Any, ByVal lpWindowName As Any) As Integer\r\nDeclare Function ShowWindow Lib \"User\" (ByVal hWnd As Integer, ByVal nCmdShow As Integer) As Integer\r\nDeclare Function SetFocusAPI Lib \"User\" (ByVal hWnd As Integer) As Integer\r\n\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["App Instance","Previous Instance"]},{"RecordId":"157","Title":"Mouse Cursor","Description":"In case you changed the mouse to a different cursor in an earlier routine then change it later, this routine resets the mouse back to the previous cursor.","Code":"Dim mnOldMouse$\r\n\r\nmnOldMouse = Screen.MousePointer\r\nScreen.MousePointer = HOURGLASS ' or other curser\r\n\r\n'........code\r\n\r\nScreen.MousePointer = mnOldMouse","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Mouse Pointer","Cursor"]},{"RecordId":"158","Title":"Directories - List files","Description":"Lists all files in a directory","Code":"'--------------------------------------------\r\n' Call the function this way\r\n'--------------------------------------------\r\n\r\nIf Right$(List1.Text, 1) <> \"\\\" Then\r\n    Call ListFiles(List1.Text & \"\\\")\r\nElse\r\n    Call ListFiles(List1.Text & \"\")\r\nEnd If\r\n\r\n'--------------------------------------------\r\n' This is the function\r\n'--------------------------------------------\r\n\r\nSub ListFiles (DirName As String)\r\n    \r\n    On Error GoTo FileError\r\n\r\n    Dim Count As Integer, F() As String, I As Integer, FileName As String\r\n    \r\n    Erase F\r\n    FileName = Dir(DirName, ATTR_NORMAL + ATTR_HIDDEN + ATTR_SYSTEM)' Get first file name.\r\n    \r\n    'Iterate through PATH, caching all files in F()\r\n    Do While FileName <> \"\"\r\n        If FileName <> \".\" And FileName <> \"..\" Then\r\n            If (GetAttr(DirName + FileName) And ATTR_DIRECTORY) <> ATTR_DIRECTORY Then\r\n                If Err <> 53 And Err <> 76 Then\r\n                    If (Count Mod 10) = 0 Then\r\n                        ReDim Preserve F(Count + 10)    ' Resize the array.\r\n                    End If\r\n                    Count = Count + 1   ' Increment counter.\r\n                    F(Count) = FileName\r\n                End If\r\n            End If\r\n        End If\r\n\r\n    FileName = Dir   ' Get another file name.\r\n    Loop\r\n    \r\n    ' Now load list box.\r\n    List2.Clear\r\n    For I = 1 To Count\r\n        List2.AddItem F(I)    ' Put name in list box.\r\n    Next I\r\n    Exit Sub\r\n\r\nFileError:\r\n    \r\n    If Err = 53 Or Err = 76 Then\r\n        Resume Next\r\n    Else\r\n        MsgBox Str$(Err) & \" - \" & Error$\r\n        Exit Sub\r\n    End If\r\n\r\nEnd Sub\r\n","Declares":"Const ATTR_NORMAL = 0\r\nConst ATTR_HIDDEN = 2\r\nConst ATTR_SYSTEM = 4\r\n\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["File List","Directory List"]},{"RecordId":"159","Title":"MTS Roles Examples","Description":"Demonstrates MTS security roles","Code":"Dim ctxObject As ObjectContext\r\nDim strOriginalCaller As String\r\n\r\nOn Error GoTo EH\r\n\r\nSet ctxObject = GetObjectContext()\r\n\r\nIf ctxObject.IsSecurityEnabled Then\r\n    If ctxObject.IsCallerInRole(\"Manager\") Then\r\n        strOriginalCaller = ctxObject.Security.GetOriginalCallerName()\r\n        Debug.Print \"User: \" & strOriginalCaller\r\n    End If\r\nEnd If\r\n\r\nctxObject.SetComplete\r\nExit Sub\r\n\r\nEH:\r\n    ctxObject.SetAbort\r\n    Exit Sub\r\n","Declares":"","CodeCategory":{"CategoryId":"14","CategoryDescription":"MTS"},"Keywords":["MTS"]},{"RecordId":"160","Title":"Collections - Removing items","Description":"Removing items from collections.","Code":"'The fastest way to remove items from a collection is to \r\n'remove the first item repeatedly.\r\n\r\nFor i = 1 to colTest.Count\r\n\tcolTest.Remove 1\r\nNext\r\nSet colTest = Nothing","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Collections","Remove"]},{"RecordId":"161","Title":"ADO Stored Procedure Samples","Description":"Several samples of how to use prepared statements and stored procedures in ADO","Code":"'------------------------------------------------------------------------------------------\r\n' Execute stored procedure that already exists on the server (example 1)\r\n'------------------------------------------------------------------------------------------\r\nDim ps As New ADODB.Command\r\nDim adoParm As ADODB.Parameter\r\n\r\nTooManyHits = False\r\n\r\n\r\nps.CommandText = \"{ call spAcctNameSearchRowCount(?,?,?)}\"\r\nps.CommandType = adCmdText\r\n\r\nps.Parameters.Append ps.CreateParameter(\"@p1\", adChar, adParamInput, 15)\r\nps.Parameters.Append ps.CreateParameter(\"@p2\", adChar, adParamInput, 1)\r\nps.Parameters.Append ps.CreateParameter(\"@p3\", adInteger, adParamOutput)\r\nps.ActiveConnection = pCorpDBConnection\r\n\r\nps.Parameters(0) = strStringIn\r\nps.Parameters(1) = strTypeIn\r\n\r\nps.Execute\r\nIf ps.Parameters(2) > 2000 Then\r\n\r\n\t' . . . \r\n\r\nEnd If\r\n\r\nSet ps = Nothing\r\n\r\n'------------------------------------------------------------------------------------------\r\n' Execute stored procedure that already exists on the server (example 2)\r\n'------------------------------------------------------------------------------------------\r\n\r\nDim cmd As New ADODB.Command\r\nDim rs As New ADODB.Recordset\r\n\r\ncmd.ActiveConnection = cn\r\ncmd.CommandText = \"TedsProc\"\r\ncmd.CommandType = adCmdStoredProc\r\n\r\ncmd.Parameters.Append cmd.CreateParameter(\"@P1\", adNumeric, adParamInput)\r\ncmd.Parameters(0).Precision = 5\r\ncmd.Parameters(0).NumericScale = 2\r\n\r\ncmd.Parameters.Append cmd.CreateParameter(\"@P2\", adChar, adParamInput, 3)\r\ncmd.Parameters.Append cmd.CreateParameter(\"@P3\", adInteger, adParamInput)\r\ncmd.Parameters.Append cmd.CreateParameter(\"@P4\", adDBTimeStamp, adParamInput)\r\ncmd.Parameters.Append cmd.CreateParameter(\"@P5\", adCurrency, adParamInput)\r\n\r\n\r\ncmd.Parameters(0) = 123.456\r\ncmd.Parameters(1) = \"ABC\"\r\ncmd.Parameters(2) = 987654321\r\ncmd.Parameters(3) = \"1/1/1999\"\r\ncmd.Parameters(4) = 123456.78988\r\n\r\nSet rs = cmd.Execute\r\nDo While Not rs.EOF\r\n    Debug.Print rs.Fields(0).Value, rs.Fields(1).Value, rs.Fields(2).Value, rs.Fields(3).Value, rs.Fields(4).Value\r\n    rs.MoveNext\r\nLoop\r\n\r\nrs.Close\r\nSet rs = Nothing\r\nSet cmd = Nothing\r\n\r\n'------------------------------------------------------------------------------------------\r\n' Execute dynamically created SQL Insert statement\r\n'------------------------------------------------------------------------------------------\r\nDim SQLStatement As String\r\nDim ps As New ADODB.Command\r\nDim adoParm As New ADODB.Parameter\r\n\r\nSQLStatement = \"INSERT INTO ErrorLog\"\r\nSQLStatement = SQLStatement & \" (Executable, Common_Name, Number, Description, Location, Line_Number, Date, User_Name, Machine_Name)\"\r\nSQLStatement = SQLStatement & \" VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)\"\r\n\r\nps.CommandText = SQLStatement\r\nps.CommandType = adCmdText\r\nps.ActiveConnection = cn\r\n\r\nWith ps\r\n .Parameters(0) = strExecutableName\r\n .Parameters(1) = strCommonName\r\n .Parameters(2) = strErrNumber\r\n .Parameters(3) = strErrDescription\r\n .Parameters(4) = strWhereErrorOccurred\r\n .Parameters(5) = strErrLineNumber\r\n .Parameters(6) = Format$(Now, \"mm/dd/yyyy hh:mm:ss\")\r\n .Parameters(7) = strUserName\r\n .Parameters(8) = strMachineName\r\nEnd With\r\n\r\nps.Execute\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["ADO","Stored Procedure","Prepared Statement"]},{"RecordId":"162","Title":"Return IDENTITY Value From Stored Procedure","Description":"Demonstrates how to retrieve the identify value of a newly inserted record from a stored procedure.  Also presents an alternative to an identify value where the unique id is determined at run time.","Code":"/*------------------------------------------------------------------------------------*/\r\n/* Uses an identify column and returns the value of the */\r\n/* inserted record.                                                          */\r\n/*-----------------------------------------------------------------------------------*/\r\nCreate Proc emp_Insert\r\n\r\n@EmpID int = NULL OUTPUT,\r\n@Firstname varchar(10),\r\n@Lastname varchar(20)\r\n\r\nas \r\n   begin\r\n\r\n      insert into employees (Firstname, Lastname)\r\n      values (@Firstname, @Lastname)\r\n\t\t\t\t\r\n      select @EmpID = @@identity\r\n   end\r\ngo\r\n\r\n/*------------------------------------------------------*/\r\n/* Uses an internally generated ID and the record key   */\r\n/*------------------------------------------------------*/\r\nCreate proc region_Insert\r\n\r\n@RegionID int = NULL OUTPUT,\r\n@RegionDesc varchar(20)\r\n\r\nas\r\n   begin\r\n      declare @ID int\r\n         \r\n      begin tran region_Insert_trans\r\n\r\n      select @id = (Select max(regionID) + 1 from regionmaster tablockx)\r\n\t\t\r\n      insert into regionmaster (regionid, regiondescription)\r\n      values(@ID, @regiondesc)\r\n\t\t\t\r\n      commit tran region_insert_trans\r\n\t\t\r\n      select @RegionID = @ID\r\n   end\r\ngo\r\n","Declares":"","CodeCategory":{"CategoryId":"6","CategoryDescription":"T-SQL"},"Keywords":["Identity","SQL Server"]},{"RecordId":"163","Title":"Read and Write to the Registry From SQL Server","Description":"Shows how to read and write registry entries from within a stored procedure","Code":"Read the registry \r\nEXECUTE master.dbo.xp_regread 'HKEY_LOCAL_MACHINE',\r\n'SOFTWARE\\Microsoft\\MSSQLServer\\Setup','SQLDataRoot',\r\n@DataRoot OUTPUT\r\n\r\n\r\nWrite a registry entry\r\nEXECUTE master.dbo.xp_regwrite 'HKEY_LOCAL_MACHINE',\r\n'SOFTWARE\\Microsoft\\MSSQLServer\\Setup',\r\n'SQLLogRoot','REG_SZ' ,@LogRoot","Declares":"","CodeCategory":{"CategoryId":"10","CategoryDescription":"SQL Server"},"Keywords":["Registry"]},{"RecordId":"164","Title":"Time - Convert 24 hr to 12 hr format","Description":"Converts 24 hour time to 12 hour am/pm format","Code":"Function Convert24To12 (TimeString As String) As String\r\n    Dim OutString As String\r\n    Dim TimeHour As Integer\r\n    '\r\n    ' get hour\r\n    '\r\n    TimeHour = Val(Left(TimeString, 2))\r\n    '\r\n    ' format first part of string, make sure 00:00:00\r\n    ' is formatted as 12:00:00\r\n    '\r\n    If (TimeHour Mod 12) = 0 Then\r\n        OutString = \"12\" & Mid(TimeString, 3)\r\n    Else\r\n        OutString = Format(TimeHour Mod 12, \"00\") & Mid(TimeString, 3)\r\n    End If\r\n    '\r\n    ' check for AM/PM\r\n    '\r\n    If TimeHour < 12 Then\r\n        OutString = OutString & \" AM\"\r\n    Else\r\n        OutString = OutString & \" PM\"\r\n    End If\r\n    '\r\n    ' return new time\r\n    '\r\n    Convert24To12 = OutString\r\nEnd Function\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Time Conversion","Time"]},{"RecordId":"166","Title":"Properties and Methods of the IXMLDOMNode Object","Description":"Properties and Methods of the IXMLDOMNode Object","Code":"Properties and Methods of the IXMLDOMNode Object. Node objects of all types share many of these properties and methods, which is a huge advantage for programmers learning the object model. \r\n\r\nProperty/Method \tDescription \r\nAppendChild \tAppends a node to the collection of Child nodes. \r\nAttributes \t\tCollection of attributes for the current node. \r\nBaseName \tReturns the right-hand side of a namespace-qualified name.  \r\nChildNodes \tCollection of child node objects \r\nCloneNode \tCreates a duplicate of the current node. \r\nDataType \tDatatype constant. \r\nDefinition \t\tReturns the definition for the current node. \r\nFirstChild \t\tReturns the first child from the childNodes collection. \r\nHasChildNodes \tReturns True if the current node contains any child nodes.  \r\nInsertBefore \tInserts a new node before a specified child node. \r\nLastChild \t\tReturns the last child from the childNodes collection. \r\nnamespaceURI \tThe Universal Resource Identifier (usually a URL ) identifying the\r\n                      \tnamespace the current node belongs to.  \r\nnextSibling \tReturns the next node at the same hierarchical level as the current node. \r\nnodeName \tReturns the name of the current node. \r\nnodeType \tReturns a NodeType constant that specifies the current node's function. \r\nnodeTypedValue \tReturns the node value cast to the type specified in the schema. By \r\n \t \tdefault, the method returns a string. \r\nnodeTypeString \tReturns the name of the NodeType constant for the current node. \r\nnodeValue \tReturns the current node's value. \r\nownerDocument \tReturns the root node for the document the current node belongs to. \r\nparentNode \tReturns the current node's parent. \r\nparsed \t\tReturns True if the current node has been parsed by the XML parser. \r\nprefix \t\tReturns the namespace prefix - the left-hand side of a namespace-qualified \r\n \t \tname for the current node. \r\npreviousSibling\tReturns the previous node at the same hierarchical level as the current \r\n \t \tnode. \r\nremoveChild \tRemoves the specified child node. \r\nreplaceChild \tReplaces the specified child node with another node. \r\nselectNodes \tSelects a subset of the child nodes for the current node. \r\nselectSingleNode \tReturns true if the current node explicitly appears in the document or \r\n \t \tfalse if the current node was generated from a default value in the DTD. \r\ntext \t\tReturns the text of the current node (the node's data). \r\ntransformNode \tTransforms one node type into a different type using XSL. \r\ntransformNodeToObject   Transforms the current node to an object using XSL. \r\nxml \t\tReturns the XML associated with the current node and its children.","Declares":"","CodeCategory":{"CategoryId":"8","CategoryDescription":"XML"},"Keywords":["XML"]},{"RecordId":"167","Title":"Retrieve List of Local Machine Adminstrators","Description":"Retrieves list of NT users that are authorized to administer the local machine","Code":"'*************************************************************************\r\n' On a form with a command button and a listbox, paste the following code:\r\n'*************************************************************************\r\n\r\nPrivate Sub Command1_Click()\r\n   Dim vntRtn As Variant\r\n   Dim lngNumItems As Long\r\n   Dim lngLoop As Long\r\n   \r\n   Me.List1.Clear\r\n   \r\n   ' Blank for local computer\r\n   vntRtn = Module1.GetAdminUsers(\"\")\r\n   \r\n   On Error Resume Next\r\n   lngNumItems = UBound(vntRtn)\r\n   On Error GoTo 0\r\n   \r\n   If lngNumItems > 0 Then\r\n      For lngLoop = 1 To lngNumItems\r\n         Me.List1.AddItem vntRtn(lngLoop)\r\n      Next lngLoop\r\n   End If\r\n   \r\nEnd Sub\r\n\r\n'*************************************************************************\r\n' In a BAS file called Module1, paste the following code:\r\n'*************************************************************************\r\n\r\nOption Explicit\r\n\r\nPrivate Declare Function NetUserEnum _\r\n   Lib \"netapi32\" _\r\n   (abytServer As Byte, _\r\n    ByVal Level As Long, _\r\n    ByVal Flags As Long, _\r\n    lngBuffer As Long, _\r\n    ByVal MaxLen As Long, _\r\n    lpEntriesRead As Long, _\r\n    lpTotalEntries As Long, _\r\n    lpResume_Handle As Long) As Long\r\nPrivate Declare Function NetApiBufferFree _\r\n   Lib \"netapi32\" _\r\n   (ByVal pBuffer As Long) As Long\r\nPrivate Declare Sub CopyMem _\r\n   Lib \"kernel32\" Alias \"RtlMoveMemory\" _\r\n   (pTo As Any, _\r\n    uFrom As Any, _\r\n    ByVal lSize As Long)\r\nPrivate Declare Function lstrlenW _\r\n   Lib \"kernel32\" _\r\n   (ByVal lpString As Long) As Long\r\nPrivate Declare Function lstrlen _\r\n   Lib \"kernel32\" _\r\n   (ByVal lpString As Long) As Long\r\n\r\nPrivate Const USER_PRIV_GUEST       As Long = &H0\r\nPrivate Const USER_PRIV_USER        As Long = &H1\r\nPrivate Const USER_PRIV_ADMIN       As Long = &H2\r\n\r\nPrivate Const constUserInfo1        As Long = 1\r\n\r\nPrivate Type USER_INFO_1_API\r\n    usri1_name          As Long\r\n    usri1_password      As Long\r\n    usri1_password_age  As Long\r\n    usri1_priv          As Long\r\n    usri1_home_dir      As Long\r\n    usri1_comment       As Long\r\n    usri1_flags         As Long\r\n    usri1_script_path   As Long\r\nEnd Type\r\n\r\nPrivate Type USER_INFO_1\r\n    usri1_name          As String\r\n    usri1_password      As Long\r\n    usri1_password_age  As Long\r\n    usri1_priv          As Long\r\n    usri1_home_dir      As String\r\n    usri1_comment       As String\r\n    usri1_flags         As Long\r\n    usri1_script_path   As String\r\nEnd Type\r\n\r\nPrivate Const NERR_Success As Long = 0&\r\nPrivate Const ERROR_MORE_DATA As Long = 234&\r\n\r\nPublic Function GetAdminUsers(Optional ByVal xi_strServer As String) As Variant\r\n   Dim lngBuffer           As Long\r\n   Dim abytServer()        As Byte\r\n   Dim atypUsers()         As USER_INFO_1_API\r\n   Dim astrAdmins()        As String\r\n   Dim strName             As String\r\n   Dim lngTotalUsers       As Long\r\n   Dim lngTotalUsersRead   As Long\r\n   Dim lngRtn              As Long\r\n   Dim lngResumeHwnd       As Long\r\n   Dim lngNumAdmins        As Long\r\n   Dim lngLevel            As Long\r\n   Dim lngLoop             As Long\r\n   Const Flags& = 0\r\n                \r\n   If Len(xi_strServer) = 0 Then\r\n      abytServer = \"\"\r\n   Else\r\n      If InStr(1, xi_strServer, \"\\\\\", vbTextCompare) <= 0 Then\r\n         xi_strServer = \"\\\\\" & xi_strServer\r\n      Else\r\n         ' Already OK\r\n      End If\r\n      abytServer = xi_strServer & vbNullChar\r\n   End If\r\n      \r\n    'call API to Enumerate users\r\n   If Len(xi_strServer) <> 0 Then\r\n      lngRtn = NetUserEnum(abytServer(0), constUserInfo1, _\r\n                           Flags, lngBuffer, _\r\n                           &H4000, lngTotalUsersRead, _\r\n                           lngTotalUsers, lngResumeHwnd)\r\n   Else\r\n      lngRtn = NetUserEnum(ByVal 0&, constUserInfo1, _\r\n                           Flags, lngBuffer, _\r\n                           &H4000, lngTotalUsersRead, _\r\n                           lngTotalUsers, lngResumeHwnd)\r\n   End If\r\n            \r\n   If lngTotalUsersRead > 0 Then\r\n      ReDim atypUsers(0 To lngTotalUsersRead - 1)\r\n      CopyMem atypUsers(0), _\r\n              ByVal lngBuffer, _\r\n              Len(atypUsers(0)) * lngTotalUsersRead\r\n      lngLoop = 0\r\n      lngNumAdmins = 0\r\n      \r\n      For lngLoop = 0 To lngTotalUsers - 1\r\n         strName = PointerToStringW(atypUsers(lngLoop).usri1_name)\r\n         lngLevel = atypUsers(lngLoop).usri1_priv\r\n         ' Only return admin-level users\r\n         If lngLevel = USER_PRIV_ADMIN Then\r\n            lngNumAdmins = lngNumAdmins + 1\r\n            ReDim Preserve astrAdmins(1 To lngNumAdmins)\r\n            astrAdmins(lngNumAdmins) = strName\r\n         End If\r\n      Next lngLoop\r\n   End If\r\n   \r\n   ' Set the return value\r\n   GetAdminUsers = astrAdmins\r\n   If lngBuffer Then\r\n      NetApiBufferFree lngBuffer\r\n   End If\r\n      \r\nEnd Function\r\n\r\nPrivate Function PointerToStringW(lpStringW As Long) As String\r\n   Dim Buffer() As Byte\r\n   Dim nLen As Long\r\n   \r\n   If lpStringW Then\r\n      nLen = lstrlenW(lpStringW) * 2\r\n      If nLen Then\r\n         ReDim Buffer(0 To (nLen - 1)) As Byte\r\n         CopyMem Buffer(0), ByVal lpStringW, nLen\r\n         PointerToStringW = Buffer\r\n      End If\r\n   End If\r\nEnd Function\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Local Administrator","NT Users","Administrators"]},{"RecordId":"168","Title":"Split & Reassemble File","Description":"Split file and reassemble file for Setup installation","Code":"'------------------------------------------------------------------------------\r\nSplitUpFile \"c:\\msoffice\\winword\\winword.exe\"\r\nAssembleFile \"c:\\msoffice\\winword\\winword.\", \"ex2\"\r\n'------------------------------------------------------------------------------\r\nStatic Sub SplitUpFile(Fil As String)\r\n    Dim x As Integer\r\n    Dim Root As String\r\n    Dim Ext As String\r\n    Dim hSource As Integer\r\n    Dim hDest As Integer\r\n    Dim SourceLen As Long\r\n    Dim DestCount As Integer\r\n    Dim Dest As Integer\r\n    Dim Length As Long\r\n    Dim Res As Integer\r\n    \r\n    Const MaxSize = 1450000\r\n    \r\n    x = InStr(Right(Fil, 4), \".\")\r\n    Ext = Right(Fil, 4 - x)\r\n    Root = Left(Fil, Len(Fil) - Len(Ext))\r\n    \r\n    hSource = FreeFile\r\n    Open Root & Ext For Binary As #hSource\r\n    \r\n    SourceLen = LOF(hSource)\r\n    If SourceLen <= MaxSize Then\r\n        MsgBox \"No need to split file\", 16\r\n        Exit Sub\r\n    End If\r\n    \r\n    DestCount = 1 + SourceLen \\ MaxSize\r\n    For Dest = 1 To DestCount\r\n        hDest = FreeFile\r\n        Open Root & Right(\"000\" & Trim(Str(Dest)), 3) For Binary As #hDest\r\n        If Dest = DestCount Then\r\n            Length = (SourceLen) Mod MaxSize\r\n        Else\r\n            Length = MaxSize\r\n        End If\r\n        \r\n        Res = CopyChunk(hSource, hDest, Length)\r\n        If Res <> 0 Then\r\n            MsgBox \"Error during copy: \" & Error(Err), 16\r\n            Exit Sub\r\n        End If\r\n        Close #hDest\r\n    Next\r\n    \r\n    Close #hSource\r\n    \r\nEnd Sub\r\n'------------------------------------------------------------------------------\r\nSub AssembleFile(Root As String, Ext As String)\r\n    Dim SourceCount As Integer\r\n    Dim Fil As String\r\n    Dim hDest As Integer\r\n    Dim Source As Integer\r\n    Dim hSource As Integer\r\n    Dim Res As Integer\r\n    \r\n    If Right(Root, 1) <> \".\" Then Root = Root & \".\"\r\n    \r\n    SourceCount = 0\r\n    Fil = Dir(Root & \"0??\")\r\n    While Len(Fil)\r\n        SourceCount = SourceCount + 1\r\n        Fil = Dir\r\n    Wend\r\n    \r\n    If SourceCount = 0 Then\r\n        MsgBox \"No pieces of \" & Root & \" found to assemble\", 16\r\n        Exit Sub\r\n    End If\r\n    \r\n    hDest = FreeFile\r\n    Open Root & Ext For Binary As #hDest\r\n    For Source = 1 To SourceCount\r\n        hSource = FreeFile\r\n        Open Root & Right(\"000\" & Trim(Str(Source)), 3) For Binary As #hSource\r\n        Res = CopyChunk(hSource, hDest, LOF(hSource))\r\n        If Res <> 0 Then\r\n            MsgBox \"Error during copy: \" & Error(Err), 16\r\n            Exit Sub\r\n        End If\r\n        Close #hSource\r\n    Next\r\n    \r\n    Close #hDest\r\n    \r\nEnd Sub\r\n'------------------------------------------------------------------------------\r\nStatic Function CopyChunk(hSource As Integer, hDest As Integer, Length As Long)\r\n\r\n    Dim BlockSize As Integer\r\n    Dim Buffer As String\r\n    Dim Blocks As Integer\r\n    Dim LastBlockSize As Integer\r\n    Dim Block As Integer\r\n    \r\n    On Local Error Resume Next\r\n    \r\n    BlockSize = 8192\r\n    Buffer = Space(BlockSize)\r\n    Blocks = (Length \\ BlockSize) + 1\r\n    LastBlockSize = Length Mod BlockSize\r\n    Err = 0\r\n    \r\n    For Block = 1 To Blocks\r\n        If Block = Blocks Then Buffer = Space(LastBlockSize)\r\n        Get #hSource, , Buffer\r\n        Put #hDest, , Buffer\r\n    Next\r\n    \r\n    CopyChunk = Err\r\n    \r\nEnd Function\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["File I/O","Split File","Reassemble File"]},{"RecordId":"169","Title":"Listview Subclassing","Description":"Demonstrates changing behavior of listview control","Code":"NOTE:  Listview view must be lvwReport\r\n\r\nPrivate Sub cmdCheckBoxes_Click()\r\n\r\n    Dim Style As Long\r\n    Dim x As Long\r\n    \r\n    Style = SendMessageLong(lv1.hwnd, LVM_GETEXTENDEDLISTVIEWSYTLE, 0&, 0&)\r\n    Style = Style Or LVM_EX_CHECKBOXES\r\n    \r\n    x = SendMessageLong(lv1.hwnd, LVM_SETEXTENDEDLISTVIEWSYTLE, 0&, Style)\r\n\r\nEnd Sub\r\n\r\nPrivate Sub cmdFullRowSelect_Click()\r\n\r\n    Dim Style As Long\r\n    Dim x As Long\r\n    \r\n    Style = SendMessageLong(lv1.hwnd, LVM_GETEXTENDEDLISTVIEWSYTLE, 0&, 0&)\r\n    Style = Style Or LVM_EX_FULLROWSELECT\r\n    \r\n    x = SendMessageLong(lv1.hwnd, LVM_SETEXTENDEDLISTVIEWSYTLE, 0&, Style)\r\n\r\nEnd Sub\r\n\r\nPrivate Sub cmdGridLines_Click()\r\n\r\n    Dim Style As Long\r\n    Dim x As Long\r\n    \r\n    Style = SendMessageLong(lv1.hwnd, LVM_GETEXTENDEDLISTVIEWSYTLE, 0&, 0&)\r\n    Style = Style Or LVM_EX_GRIDLINES\r\n    \r\n    x = SendMessageLong(lv1.hwnd, LVM_SETEXTENDEDLISTVIEWSYTLE, 0&, Style)\r\n\r\nEnd Sub\r\n\r\nPrivate Sub cmdHdrDropDrag_Click()\r\n\r\n    Dim Style As Long\r\n    Dim x As Long\r\n    \r\n    Style = SendMessageLong(lv1.hwnd, LVM_GETEXTENDEDLISTVIEWSYTLE, 0&, 0&)\r\n    Style = Style Or LVM_EX_HEADERDRAGDROP\r\n    \r\n    x = SendMessageLong(lv1.hwnd, LVM_SETEXTENDEDLISTVIEWSYTLE, 0&, Style)\r\n\r\nEnd Sub\r\n\r\nPrivate Sub cmdTrackSelect_Click()\r\n\r\n    Dim Style As Long\r\n    Dim x As Long\r\n    \r\n    Style = SendMessageLong(lv1.hwnd, LVM_GETEXTENDEDLISTVIEWSYTLE, 0&, 0&)\r\n    Style = Style Or LVM_EX_TRACKSELECT\r\n    \r\n    x = SendMessageLong(lv1.hwnd, LVM_SETEXTENDEDLISTVIEWSYTLE, 0&, Style)\r\n\r\nEnd Sub\r\n","Declares":"Private Declare Function SendMessageLong Lib \"user32\" Alias \"SendMessageA\" (ByVal hwnd As Long, ByVal Msg As Long, ByVal wParam As Long, ByVal lParam As Long) As Long\r\n\r\nConst LVM_FIRST = &H1000\r\nConst LVM_SETEXTENDEDLISTVIEWSYTLE = LVM_FIRST + 54\r\nConst LVM_GETEXTENDEDLISTVIEWSYTLE = LVM_FIRST + 55\r\nConst LVM_EX_GRIDLINES = &H1\r\nConst LVM_EX_CHECKBOXES = &H4\r\nConst LVM_EX_TRACKSELECT = &H8\r\nConst LVM_EX_HEADERDRAGDROP = &H10\r\nConst LVM_EX_FULLROWSELECT = &H20\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["ListView","Subclass"]},{"RecordId":"170","Title":"File Version Information","Description":"Retrieves company name, version info, etc. for a given filename.","Code":"'NOTE:  This function searches for strings such as \"CompanyName\" in the sVerInfo string variable.  Actually, the values returned from the API call\r\n'             have nulls between each character, so it doesn't work.  Minor tweaking should allow things to function properly, however.\r\n\r\n\r\nPublic Sub GetFileVersionData(sFileName As String)\r\n\r\nDim sVerInfo As String\r\nDim sTemp As String\r\nDim lSz As Long\r\nDim lRes As Long\r\nDim iPos As Integer\r\nDim n As Integer\r\nDim hWnd As Long\r\n\r\nDim sFileDateTime As String\r\nDim dFileDateTime As Double\r\nDim lFileLen As Long\r\nDim bHasVerInfo As Boolean\r\nDim sCompanyName As String\r\nDim sFileDescription As String\r\nDim sFileVersion As String\r\nDim sInternalName As String\r\nDim sLegalCopyright As String\r\nDim sLegalTrademarks As String\r\nDim sOriginalFilename As String\r\nDim sProductName As String\r\nDim sProductVersion As String\r\nDim iMajor As Integer\r\nDim iMinor As Integer\r\nDim iRevision As Integer\r\n\r\n sFileDateTime = \"\"\r\n dFileDateTime = 0\r\n lFileLen = 0\r\n bHasVerInfo = False\r\n sCompanyName = \"\"\r\n sFileDescription = \"\"\r\n sInternalName = \"\"\r\n sLegalCopyright = \"\"\r\n sLegalTrademarks = \"\"\r\n sOriginalFilename = \"\"\r\n sProductName = \"\"\r\n sProductVersion = \"\"\r\n iMajor = 0\r\n iMinor = 0\r\n iRevision = 0\r\n\r\n\r\nIf Len(sFileName) Then\r\n    lFileLen = FileLen(sFileName)\r\n    dFileDateTime = CDbl(FileDateTime(sFileName))\r\n    sFileDateTime = Format$(dFileDateTime, \"dd-mmm-yy hh:nn:ss\")\r\n    lSz = GetFileVersionInfoSize(sFileName, hWnd)\r\n    If lSz Then\r\n        sVerInfo = String$(lSz, 0)\r\n        lRes = GetFileVersionInfo(ByVal sFileName, 0&, ByVal lSz, ByVal sVerInfo)\r\n        If lRes Then\r\n            bHasVerInfo = True\r\n            sCompanyName = ParseResource(sVerInfo, \"CompanyName\", 12)\r\n            sFileDescription = ParseResource(sVerInfo, \"FileDescription\", 16)\r\n            sFileVersion = ParseResource(sVerInfo, \"F i l e V e r s i o n\", 12)\r\n            sInternalName = ParseResource(sVerInfo, \"InternalName\", 16)\r\n            sLegalCopyright = ParseResource(sVerInfo, \"LegalCopyright\", 16)\r\n            sLegalTrademarks = ParseResource(sVerInfo, \"LegalTrademarks\", 16)\r\n            sOriginalFilename = ParseResource(sVerInfo, \"OriginalFilename\", 20)\r\n            sProductName = ParseResource(sVerInfo, \"ProductName\", 12)\r\n            sProductVersion = ParseResource(sVerInfo, \"ProductVersion\", 16)\r\n            \r\n            iPos = InStr(sFileVersion, \".\")\r\n            If iPos > 0 Then\r\n                iMajor = CInt(Left(sFileVersion, iPos))\r\n                sTemp = Mid$(sFileVersion, iPos + 1)\r\n                iPos = InStr(sTemp, \".\")\r\n                If iPos > 0 Then\r\n                    iMinor = CInt(Left(sTemp, iPos))\r\n                    iRevision = CInt(Mid$(sTemp, iPos + 1))\r\n                End If\r\n            End If\r\n        End If\r\n    End If\r\nEnd If\r\n    \r\nEnd Sub\r\n\r\n\r\nPrivate Function ParseResource(r As String, s As String, l As Long) As String\r\n\r\nDim pos As Long\r\n\r\npos = InStr(r, s)\r\nIf pos Then\r\n    ParseResource = TrimNul(Mid$(r, pos + 1))\r\nEnd If\r\n\r\nEnd Function\r\n\r\nPrivate Function TrimNul(s As String) As String\r\n\r\nDim pos As Long\r\n\r\npos = InStr(s, Chr$(0))\r\nIf pos Then\r\n    TrimNul = Left$(s, pos - 1)\r\nEnd If\r\n\r\nEnd Function\r\n","Declares":"Declare Function GetFileVersionInfo Lib \"version.dll\" Alias \"GetFileVersionInfoA\" (ByVal lptstrFilename As String, ByVal dwHandle As Long, ByVal dwLen As Long, lpData As Any) As Long\r\nDeclare Function GetFileVersionInfoSize Lib \"version.dll\" Alias \"GetFileVersionInfoSizeA\" (ByVal lptstrFilename As String, lpdwHandle As Long) As Long\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["File Info","Version Info"]},{"RecordId":"171","Title":"Save/Get Binary Data To A Jet Database","Description":"Reads binary file and saves in Jet database field.  Saves binary from Jet binary field and write binary file.","Code":"Public Function GetBinaryDataDAO(F As field) As String\r\n\r\n'Creates a binary file from the data in a Jet database field\r\n\r\nDim iFileNbr As Integer\r\nDim sSndFile As String\r\nDim nChunkSize As Long\r\nDim nLenLeft As Long\r\nDim nPos As Long\r\nDim sBuffer As String\r\n\r\niFileNbr = FreeFile\r\nsSndFile = \"c:\\temp\\tempfile.ext\"\r\nOpen sSndFile For Binary As #iFileNbr\r\n\r\nnLenLeft = F.fieldsize\r\nnChunkSize = 16380\r\nIf nLenLeft < nChunkSize Then\r\n    nChunkSize = nLenLeft\r\nEnd If\r\n\r\nnPos = 0\r\n\r\nDo\r\n    sBuffer = Space(nChunkSize)\r\n    sBuffer = F.getchunk(nPos, nChunkSize)\r\n    \r\n    Put #filenbr, , sBuffer\r\n    \r\n    nPos = nPos + nChunkSize\r\n    nLenLeft = nLenLeft - nChunkSize\r\n    If nLenLeft < nChunkSize Then\r\n        nChunkSize = nLenLeft\r\n    End If\r\n    \r\nLoop Until nLenLeft <= 0\r\n\r\nGetBinaryDataDAO = sSndFile\r\nClose #iFileNbr\r\n\r\nEnd Function\r\n\r\nPublic Function SaveBinaryDataDAO(sFileName As String, F As field) As Boolean\r\n\r\n'Reads a binary file and saves it in a Jet database field\r\n\r\nDim iFileNbr As Integer\r\nDim nChunkSize As Long\r\nDim nLenLeft As Long\r\nDim nPos As Long\r\nDim sBuffer As String\r\n\r\niFileNbr = FreeFile\r\nsFileName = \"c:\\temp\\tempfile.ext\"\r\nOpen sFileName For Binary As #iFileNbr\r\n\r\nnChunkSize = 16380\r\nnLenLeft = LOF(iFileNbr)\r\nIf nLenLeft < nChunkSize Then\r\n    nChunkSize = nLenLeft\r\nEnd If\r\n\r\nnPos = 1\r\n\r\nDo\r\n    sBuffer = Space(nChunkSize)\r\n    Get #iFileNbr, nPos, sBuffer\r\n    F.appendchunk sBuffer\r\n    \r\n    nPos = nPos + nChunkSize\r\n    nLenLeft = nLenLeft - nChunkSize\r\n    If nLenLeft < nChunkSize Then\r\n        nChunkSize = nLenLeft\r\n    End If\r\n    \r\nLoop Until nLenLeft <= 0\r\n\r\nSaveBinaryDataDAO = True\r\nClose #iFileNbr\r\n\r\nEnd Function\r\n\r\n\r\n\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"3","CategoryDescription":"Database"},"Keywords":["Binary data","AppendChunk"]},{"RecordId":"172","Title":"Remove System Menu Item Of Given Form","Description":"Removes system menu item of a given form","Code":"Function RemoveSystemMenuItem (ByVal hForm As Integer, ByVal strMenu As String) As Integer\r\n'===============================================================\r\n'Removes the system menu item of a given form.\r\n'Returns True (-1) on success, zero otherwise.\r\n'\r\n'   hForm   The handle to the form window (commonly Me.hWnd)\r\n'   strMenu A string used to identify the menu item.  Use enoungh\r\n'           characters so that the left portion of the menu item string\r\n'           matching strMenu is unique.\r\n'===============================================================\r\nDim i As Integer\r\nDim rsp As Integer\r\n\r\nDim hSysMenu As Integer\r\nDim cntMenuItems As Integer\r\nDim posItem As Integer\r\nDim strBuffer As String * 128\r\nDim lenStr As Integer\r\n\r\nhSysMenu = GetSystemMenu(hForm, 0)\r\ncntMenuItems = GetMenuItemCount(hSysMenu)\r\n\r\nposItem = -1\r\nFor i = 0 To cntMenuItems - 1\r\n  lenStr = GetMenuString(hSysMenu, i, strBuffer, 128, MF_BYPOSITION)\r\n  If Left$(Left$(strBuffer, lenStr), Len(strMenu)) = strMenu Then\r\n    posItem = i\r\n    Exit For\r\n  End If\r\nNext\r\n\r\nIf posItem = -1 Then Exit Function ' string not found\r\n\r\nrsp = RemoveMenu(hSysMenu, posItem, MF_BYPOSITION)\r\n\r\nIf rsp <> 0 Then RemoveSystemMenuItem = True\r\n\r\nEnd Function\r\n\r\n","Declares":"'Declares for Remove System Items from Menu\r\nDeclare Function GetSystemMenu Lib \"User\" (ByVal hWnd As Integer, ByVal bRevert As Integer) As Integer\r\nDeclare Function GetMenuString Lib \"User\" (ByVal hMenu As Integer, ByVal wIDItem As Integer, ByVal lpString As String, ByVal nMaxCount As Integer, ByVal wFlag As Integer) As Integer\r\nDeclare Function RemoveMenu Lib \"User\" (ByVal hMenu As Integer, ByVal nPosition As Integer, ByVal wFlags As Integer) As Integer\r\nDeclare Function GetMenuItemCount Lib \"User\" (ByVal hMenu As Integer) As Integer\r\nGlobal Const MF_BYPOSITION = &H400\r\n'End of declares\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Menu","System Menu"]},{"RecordId":"173","Title":"Registry Setting to Allow IIS to Run MTS Component","Description":"You must make this change to allow IIS to run MTS objects out of process (which is the preferred way).","Code":"This entry allows IIS to run an MTS component out of process (which is the preferred method).\r\n\r\nHKEY_LOCAL_MACHINE\r\n  System\r\n    CurrentControlSet\r\n      Services\r\n        W3SVC\r\n          ASP\r\n            Parameters\r\n              \r\nSet AllowOutOfProcCmpnts to 1.\r\n\r\n\r\nAdditionally, you must have an entry for the component to allow it to be launched via Remote Data Services.\r\n\r\nHKEY_LOCAL_MACHINE\r\n  System\r\n    CurrentControlSet\r\n      Services\r\n        W3SVC\r\n          Parameters\r\n            ADCLaunch\r\n              YourApp.YourClass  (Create a key for the Prog ID of the object that you want to run.)\r\n     \r\n\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"14","CategoryDescription":"MTS"},"Keywords":["MTS","IIS"]},{"RecordId":"174","Title":"Simple Scrollable Read-Only Textbox","Description":"This routine call the Windows API to make a textbox be \"Read-Only\".  The text is NOT gray, the Scrollbars STILL WORK, Text can be selected & copied but cannot be modified or deleted.","Code":"Sub txtViewMessage_GotFocus\r\n        x = SendMessage(txtViewMessage.hWnd, EM_SETREADONLY, 1, 0)\r\n        HideCaret txtViewMessage.hWnd\r\nEnd Sub","Declares":"Global Const WM_USER = &H400\r\nGlobal Const EM_SETREADONLY = (WM_USER + 31)\r\nDeclare Sub HideCaret Lib \"User\" (ByVal hWnd As Integer)\r\nDeclare Function SendMessage Lib \"User\" (ByVal hWnd As Integer, ByVal wMsg As Integer, ByVal wParam As Integer, lParam As Any) As Long\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Text Box","Read Only"]},{"RecordId":"175","Title":"Select All Items in a ListBox","Description":"Select all items in a list box (fast method)","Code":"First set listbox list index to -1, then call:\r\n\r\nRetVal = SendMessage(lst.hwnd, LB_SETSEL, bState, -1)\r\n\r\n(bState = 0 deselects all items)\r\n","Declares":"","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["List Box","Select List Items"]},{"RecordId":"176","Title":"Print Clipboard (ActiveWindow or Screen)","Description":"Copies active window or complete screen to clipboard then prints it.","Code":"NOTE:  Requires a PictureBox on a form.\r\n\r\nPrivate Sub cmdCaptureScreen_Click()\r\n   keybd_event VK_SNAPSHOT, 1, 0, 0\r\nEnd Sub\r\n\r\nPrivate Sub cmdCaptureActiveWindow_Click()\r\n   keybd_event VK_MENU, 0, 0, 0\r\n   keybd_event VK_SNAPSHOT, 0, 0, 0\r\n   keybd_event VK_SNAPSHOT, 0, KEYEVENTF_KEYUP, 0\r\n   keybd_event VK_MENU, 0, KEYEVENTF_KEYUP, 0\r\nEnd Sub\r\n\r\nPrivate Sub cmdPrint_Click()\r\n   ' Load the captured image into a PictureBox and print it\r\n   Picture1.Picture = Clipboard.GetData()\r\n   Printer.PaintPicture Picture1.Picture, 0, 0\r\n   Printer.EndDoc\r\nEnd Sub\r\n\r\n\r\n","Declares":"Private Declare Sub keybd_event Lib \"user32\" ( _\r\n    ByVal bVk As Byte, _\r\n    ByVal bScan As Byte, _\r\n    ByVal dwFlags As Long, _\r\n    ByVal dwExtraInfo As Long)\r\n\r\nPrivate Const KEYEVENTF_EXTENDEDKEY = &H1\r\nPrivate Const KEYEVENTF_KEYUP = &H2\r\nPrivate Const VK_SNAPSHOT = &H2C\r\nPrivate Const VK_MENU = &H12\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Print Clipboard","Print Form","Print Screen"]},{"RecordId":"178","Title":"Text Box - Read only","Description":"Makes a text read only","Code":"Sub settextboxreadonly (TBox As TextBox, ByVal flag As Integer)\r\n\r\n    ' Flag should be true or false\r\n    ' True will make the text box read only false will make textbox read write\r\n\r\n    Dim ret As Long\r\n\r\n    ret = sendmessage(TBox.hWnd, EM_SETREADONLY, flag, 0)\r\n\r\n\r\nEnd Sub","Declares":"Declare Function SendMessage Lib \"User\" (ByVal hWnd As Integer, ByVal wMsg As Integer, ByVal wParam As Integer, lparam As Any) As Long","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Read Only Text Box","Text Box"]},{"RecordId":"179","Title":"Delay a program","Description":"Delay a program for a certain number of milliseconds","Code":"Delay 5000\r\n\r\nSub Delay(MilliSeconds As Integer)\r\n\r\n    If MilliSeconds > 0 And MilliSeconds < 32767 Then\r\n        TimeExpired = False\r\n        Timer1.Interval = MilliSeconds\r\n        Timer1.Enabled = True\r\n        While (TimeExpired = False)\r\n            DoEvents\r\n        Wend\r\n    End If\r\n    \r\nEnd Sub\r\n\r\nSub Timer1_Timer()\r\n\r\nTimeExpired = True\r\nTimer1.Enabled = False\r\n\r\nEnd Sub\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Delay program","Timer","Pause"]},{"RecordId":"181","Title":"List Box Cumulative Search","Description":"Searches the items in a SORTED list box based on all characters typed by the user","Code":"Global ListBoxSearch As String\r\n\r\nSub ListBox_KeyPress(KeyAscii As Integer)\r\n    KeyAscii = SearchListBox(Me.ActiveControl, KeyAscii)\r\nEnd Sub\r\n\r\nFunction SearchListBox(CurrentActiveControl As Control, KeyAscii As Integer)\r\n\r\nDim ListBoxIndex As Integer\r\nDim Result As Integer\r\n\r\nListBoxSearch = ListBoxSearch & Chr$(KeyAscii)\r\nListBoxIndex = CurrentActiveControl.ListIndex\r\nWhile ListBoxIndex < CurrentActiveControl.ListCount\r\n    Result = StrComp(UCase$(ListBoxSearch), UCase$(Left$(CurrentActiveControl.List(ListBoxIndex), Len(ListBoxSearch))))\r\n    If Result <= 0 Then\r\n        CurrentActiveControl.ListIndex = ListBoxIndex\r\n        SearchListBox = 0\r\n        Exit Function\r\n    End If\r\n    ListBoxIndex = ListBoxIndex + 1\r\nWend\r\n\r\nListBoxIndex = CurrentActiveControl.ListCount - 1\r\nCurrentActiveControl.ListIndex = ListBoxIndex\r\nSearchListBox = 0\r\n\r\nEnd Function\r\n\r\n\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["ListBox Search","Search"]},{"RecordId":"182","Title":"Display Color Palette From a User Control (OCX)","Description":"Automatically displays the color selection palette on a user created activeX control.","Code":"' Simply add these two properties to user ActiveX control\r\n\r\nPublic Property Let MyColor (ByVal NewColor As OLE_COLOR)\r\nEnd Property\r\n\r\nPublic Property Get MyColor() As OLE_COLOR\r\nEnd Property","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Color Palette","User Control"]},{"RecordId":"183","Title":"Determine Excel Spreadsheet Cell Information","Description":"Determines value, attributes, formula, and formatting of cells in excel spreadsheet.\r\nRequires setting reference to MS Excel Object Library in project references.","Code":"Public Sub ExcelInfo()\r\n\r\nDim objXL As New Excel.application\r\nDim objXLCell As Object\r\nDim strTemp As String\r\nDim strFileName As String\r\nDim strWorksheetName As String\r\nDim strCellRange As String\r\n\r\nlstCell.Clear\r\nlstValue.Clear\r\nlstType.Clear\r\nlstFormat.Clear\r\nlstInfo.Clear\r\n\r\nstrFileName = \"c:\\excel\\myspreadsheet.xls\"\r\nstrWorksheetName = \"Sheet1\"\r\nstrCellRange = \"A1:B4\"\r\n\r\nobjXL.Workbooks.Open strFileName\r\n\r\nFor Each objXLCell In objXL.Worksheets(strWorksheetName).Range(strCellRange).Cells\r\n    \r\n    With objXLCell\r\n        \r\n        lstCell.AddItem Chr(64 + .Column) & Trim(Str(.Row))\r\n        lstValue.AddItem .Value\r\n        \r\n        If IsEmpty(.Value) Then\r\n            lstType.AddItem \"Empty\"\r\n            lstFormat.AddItem \"\"\r\n            lstInfo.AddItem \"\"\r\n        ElseIf .HasFormula Then\r\n            lstType.AddItem \"Formula\"\r\n            lstFormat.AddItem .NumberFormat\r\n            lstInfo.AddItem .Formula\r\n        ElseIf VarType(.Value) = vbDate Then\r\n            lstType.AddItem \"Date\"\r\n            lstFormat.AddItem .NumberFormat\r\n            lstInfo.AddItem \"\"\r\n        ElseIf VarType(.Value) = vbString Then\r\n            lstType.AddItem \"Text\"\r\n            lstFormat.AddItem .Style.Name\r\n            strTemp = \"\"\r\n            If .Font.Bold Then strTemp = strTemp & \"Bold, \"\r\n            If .Font.Italic Then strTemp = strTemp & \"Italics, \"\r\n            If Len(strTemp) <> 0 Then strTemp = Left(strTemp, Len(strTemp) - 2)\r\n            lstInfo.AddItem = strTemp\r\n        Else\r\n            lstType.AddItem \"Value\"\r\n            lstFormat.AddItem .NumberFormat\r\n            lstInfo.AddItem \"\"\r\n        End If\r\n    End With\r\nNext\r\n\r\nobjXL.Quit\r\nSet objXLCell = Nothing\r\nSet objXL = Nothing\r\n\r\nEnd Sub\r\n\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Excel","OLE Automation","VBA"]},{"RecordId":"184","Title":"Wait for Shell (VB4-32)","Description":"Wait for shelled program to finish for VB4-32 bit only.","Code":"Private Function SyncShell (byval pathname as string, windowstyle as integer) as boolean\r\n\r\nDim ProcessID as long\r\nDim ProcessHandle as long\r\n\r\nOn Error GoTo SyncShell_Error\r\n\r\nProcessID = Shell(pathname, windowstyle)\r\nProcessHandle = OpenProcess(SYNCHRONIZE, True, ProcessID)\r\n\r\nWaitForSingleObject ProcessHandle, INFINITE\r\n\r\nSyncShell = True\r\nExit Function\r\n\r\nSyncShell_Error:\r\n\r\nOn Error GoTo 0\r\nSyncShell = False\r\nExit Function \r\n\r\nEnd Function","Declares":"Declare Function OpenProcess Lib \"Kernel32\" (byval dwDesiredAccess as long, byval bInheritHandle as long, byval dwProcessId as long) as long\r\nDeclare Function WaitForSingleObject Lib \"Kernel32\" (byval hHandle as long, byval dwMilliseconds as long) as long\r\n\r\nConst SYNCHRONIZE = &H100000\r\nConst INFINITE = &HFFFFFFFF","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Wait","Shell"]},{"RecordId":"185","Title":"Restore Previous Instance","Description":"Finds and restores a previous running instance of app","Code":"Sub FindAndRestorePrevInstance (Cap$)\r\nDim X%\r\nIf App.PrevInstance Then\r\n   AppActivate Cap$\r\n   SendKeys (\"% R\")\r\n   End\r\nEnd If\r\nEnd Sub\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Find Window","Activate Application","Activate Window"]},{"RecordId":"186","Title":"ProgMan - Create Program Manager Icons","Description":"Create (or place) icons into program groups in Program Manager","Code":"Sub CreateProgManItem (x As Form, CmdLine$, IconTitle$)\r\n' Version 1.0\r\n'----------------------------------------------------------\r\n' Procedure: CreateProgManItem\r\n'\r\n' Arguments: X           The form where Label1 exists\r\n'\r\n'            CmdLine$    A string that contains the command\r\n'                        line for the item/icon.\r\n'                        ie 'c:\\myapp\\setup.exe'\r\n'\r\n'            IconTitle$  A string that contains the item's\r\n'                        caption\r\n'----------------------------------------------------------\r\n    \r\n    Screen.MousePointer = 11\r\n    \r\n    '----------------------------------------------------------------------\r\n    ' Windows requires DDE in order to create a program group and item.\r\n    ' Here, a Visual Basic label control is used to generate the DDE messages\r\n    '----------------------------------------------------------------------\r\n    On Error Resume Next\r\n\r\n\r\n    '---------------------------------\r\n    ' Set LinkTopic to PROGRAM MANAGER\r\n    '---------------------------------\r\n    x.Label1.LinkTopic = \"ProgMan|Progman\"\r\n    x.Label1.LinkMode = 2\r\n    For i% = 1 To 10                                         ' Loop to ensure that there is enough time to\r\n      z% = DoEvents()                                        ' process DDE Execute.  This is redundant but needed\r\n    Next                                                     ' for debug windows.\r\n    x.Label1.LinkTimeout = 100\r\n\r\n    '------------------------------------------------\r\n    ' Create Program Item, one of the icons to launch\r\n    ' an application from Program Manager\r\n    '------------------------------------------------\r\n    x.Label1.LinkExecute \"[AddItem(\" + CmdLine$ + Chr$(44) + IconTitle$ + Chr$(44) + \",,)]\"\r\n '------------------------------------------------\r\n ' Activate the group\r\n '------------------------------------------------\r\n   x.Label1.LinkExecute \"[ShowGroup(groupname, 1)]\"    \r\n    '-----------------\r\n    ' Reset properties\r\n    '-----------------\r\n    x.Label1.LinkTimeout = 50\r\n    x.Label1.LinkMode = 0\r\n    \r\n    Screen.MousePointer = 0\r\nEnd Sub\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Create Icons","Setup","ProgMan"]},{"RecordId":"187","Title":"First/Last Day of Month","Description":"Determine dates of first and last day of a given month","Code":"'First day of month\r\nDateSerial(Year(DateIn), Month(DateIn),1)\r\n\r\n'Last day of month\r\nDateSerial(Year(DateIn), Month(DateIn)+1, 0)","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Dates"]},{"RecordId":"188","Title":"Print Grid and Print at Location","Description":"Prints a grid template to position on preprinted forms.  Also contains routine to print at specific location, given a global offset.","Code":"'--------------------------------------------------------------------------------\r\n'\r\n' The following line will print the string at the specified location with\r\n' a horizontal & vertical adjustment of zero.  Typically, the horizontal\r\n' and vertical adjustment would be due to an offset in certain laser printers.\r\n'\r\n'\r\n' PrintData \"String of data\", 1.5, 2.5, 0, 0\r\n'\r\n'--------------------------------------------------------------------------------\r\nSub PrintData (FieldData As String, XLocation As Single, YLocation As Single, XAdjust As Single, YAdjust As Single)\r\n\r\nPrinter.CurrentX = XAdjust + XLocation\r\nPrinter.CurrentY = YAdjust + YLocation\r\nPrinter.Print FieldData\r\n\r\nEnd Sub\r\n\r\n'--------------------------------------------------------------------------------\r\n'\r\n' The following subroutine will print an 8 x 10 inch grid with .5 inch\r\n' horizontal & vertical spacing.  This could be used as a template to\r\n' determine where to print data on a page.\r\n'\r\n'--------------------------------------------------------------------------------\r\nSub PrintGrid ()\r\n\r\nDim PrintAreaHeight As Single\r\nDim PrintAreaWidth As Single\r\nDim CellWidth As Single\r\nDim CellHeight As Single\r\nDim XPos As Single\r\nDim YPos As Single\r\n\r\nPrinter.FontName = \"Arial\"\r\nPrinter.FontSize = 5\r\nPrinter.ScaleMode = 5\r\nPrintAreaHeight = 10\r\nPrintAreaWidth = 8\r\nCellWidth = .5\r\nCellHeight = .5\r\nFor YPos = 0 To PrintAreaHeight Step CellHeight\r\n    Printer.Line (0, YPos)-(PrintAreaWidth, YPos)\r\n    For XPos = 0 To PrintAreaWidth Step CellWidth\r\n        Printer.Line (XPos, YPos)-(XPos, YPos + CellHeight)\r\n        Printer.CurrentX = XPos\r\n        Printer.CurrentY = YPos\r\n        Printer.Print \"x\"; XPos\r\n        Printer.CurrentX = XPos\r\n        Printer.Print \"y\"; YPos\r\n    Next\r\nNext\r\nPrinter.EndDoc\r\nEnd Sub\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Printing"]},{"RecordId":"190","Title":"Create Excel Spreadsheet","Description":"Creates a new Excel Spreadsheet and saves it","Code":"Dim objExcel As Object\r\nDim i As Integer\r\n\r\n'Start excel\r\nSet objExcel = CreateObject(\"Excel.sheet\")\r\n\r\n'Format column headings\r\nFor i = 1 To 2\r\n    objExcel.Cells(1, i).Value = \"Column \" & Format$(i, \"00\")\r\nNext\r\n\r\n'Load cells with 10 rows of data\r\nFor i = 2 To 10\r\n    objExcel.Cells(i, 1).Value = Format$(i, \"00\")\r\n    objExcel.Cells(i, 2).Value = \"Some text\"\r\nNext\r\n\r\n'Save sheet (Save As)\r\nobjExcel.SaveAs \"c:\\ted\\vbtest.xls\"\r\n\r\n'Shut down\r\nobjExcel.Application.Quit\r\n\r\nSet objExcel = Nothing","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Excel","OLE Automation","VBA"]},{"RecordId":"191","Title":"Determine Number of Users in MDB","Description":"Determine number of active users in Jet database","Code":"Function activeusers (ByVal sLDBname As String) As Integer\r\n\t sLDBname is the complete name (path and suffix included) for the companion .LDB of the MDB file\r\n\t you want count active users\r\n  Dim filenum As Integer, nuser As Integer, counter As Integer\r\n  On Error Resume Next\r\n  \tIf Dir$(sLDBname) = \"\" Then\t if .LDB not exist no user is active\r\n    \t\tactiveusers = 0\r\n    \t\tExit Function\r\n  \tEnd If\r\n  \tfilenum = FreeFile\t get first handle free\r\n  \tOpen sLDBname For Random Shared As filenum Len = 1\r\n  \t\tnuser = 0\r\n  \t\tFor counter = 1 To 255\t for all possible users\r\n\t\t\tLock filenum, 268435457 + counter\t try user lock\r\n    \t\t\tIf Err <> 0 Then\t\t if not successful\r\n        \t\t\t\tnuser = nuser + 1\t the lock is busy (one active user)\r\n\t\t\t\tErr = 0\r\n    \t\t\tElse\r\n        \t\t\t\tUnlock filenum, 268435457 + counter\tfree the user lock\r\n    \t\t\tEnd If\r\n    \t\tNext counter\r\n  \tClose filenum\r\n  \tactiveusers = nuser\r\nEnd Function\r\n","Declares":"","CodeCategory":{"CategoryId":"3","CategoryDescription":"Database"},"Keywords":["Users (Jet)","Jet Users"]},{"RecordId":"192","Title":"RichTextBox Margins","Description":"How to set print margins in VB4 RichTextBox","Code":"Use SendMessage API (32 bit) to send EM_SETTARGETDEVICE and \r\nEM_FORMATRANGE messages to the control.  \r\n\r\nAdditional info can be found in MS Knowledge Base article Q146022 \r\n\"How to set up the RichTextBox Control for WYSIWYG printing\".\r\n\r\nhttp://www.microsoft.com/kb/:","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Rich Text Box","Margins"]},{"RecordId":"193","Title":"Find Window Example","Description":"An example on how to find a window based on the TitleBar's caption.","Code":"'gets the handle of the window and set the windowstate\r\nhandle% = FindWindow%(0&, WindowName$)  'name is caption, can also use class if known\r\nIf handle% <> 0 Then X% = ShowWindow%(handle%, SW_SHOWNORMAL)\r\n","Declares":"Declare Function FindWindow% Lib \"user\" (ByVal lpClassName As Any, ByVal lpCaption As Any)\r\nDeclare Function ShowWindow% Lib \"User\" (ByVal hWnd As Integer, ByVal nCmdShow As Integer)\r\nGlobal Const SW_SHOWNORMAL = 1\r\nGlobal Const SW_SHOWMINIMIZED = 2\r\nGlobal Const SW_SHOWMAXIMIZED = 3\r\n'others available see WIN31 API Help in VB\r\n \r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Find Window"]},{"RecordId":"194","Title":"Parse a String Into Words","Description":"Parses a string into individual words (uses a space as the delimeter) and places each word into an array named WordArray","Code":"Private Sub ParseLine(strLineIn As String)\r\n    \r\nDim intOffset As Integer\r\nDim intStringLength As Integer\r\nDim intCount As Integer\r\nDim intStart As Integer\r\nDim strTempString As String\r\n\r\n\r\nErase WordArray()\r\nReDim WordArray(WORD_ARRAY_SIZE)\r\n\r\n\r\nintCount = 0\r\nintStart = 1\r\nintOffset = 1\r\n\r\nstrLineIn = strLineIn & \" \"\r\nintStringLength = Len(strLineIn)\r\n\r\nDo While intOffset <= intStringLength\r\n    intOffset = InStr(intOffset, strLineIn, \" \")\r\n    strTempString = Mid$(strLineIn, intStart, intOffset - intStart)\r\n    \r\n    If strTempString <> \"\" Then\r\n        WordArray(intCount) = Trim$(strTempString)\r\n        intCount = intCount + 1\r\n    End If\r\n    \r\n    intStart = intOffset + 1\r\n    intOffset = intOffset + 1\r\nLoop\r\n    \r\nEnd Sub\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Parse String","Parse"]},{"RecordId":"195","Title":"Add Items To System Menu","Description":"Adds items to Control Box Menu","Code":"Dim hMenu As Long\r\n  Dim lRetVal As Long\r\n\r\n  hMenu = GetSystemMenu(hwnd, False)\r\n\r\n  lRetVal = AppendMenu(hMenu, MF_SEPARATOR, SCOFFSET, vbNullChar)\r\n  lRetVal = AppendMenu(hMenu, MF_STRING, SCOFFSET + 1, \"Item 1\")\r\n  lRetVal = AppendMenu(hMenu, MF_STRING, SCOFFSET + 2, \"Item 2\")\r\n","Declares":"Declare Function AppendMenu Lib \"user32\" Alias \"AppendMenuA\" (ByVal hMenu As Long, ByVal wFlags As Long, ByVal wIDNewItem As Long, ByVal lpNewItem As String) As Long\r\nDeclare Function GetSystemMenu Lib \"user32\" (ByVal hwnd As Long, ByVal bRevert As Long) As Long\r\n\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Menu","Add Menu Items"]},{"RecordId":"196","Title":"Modify Excel Spreadsheet","Description":"Modify existing Excel spreadsheet, prints it, and saves the changes","Code":"Dim objExcel As Object\r\nDim i As Integer\r\n\r\n'Start excel\r\nSet objExcel = CreateObject(\"Excel.Application\")\r\n\r\n'Open existing sheet\r\nobjExcel.Workbooks.Open \"c:\\ted\\vb-excel\\vbtest.xls\"\r\n\r\n'Modify some cells\r\nFor i = 1 To 2\r\n    objExcel.Cells(1, i).Value = \"Columnxx \" & Format$(i, \"00\")\r\nNext\r\n\r\n'Select print range\r\nActiveSheet.PageSetup.PrintArea = \"$A$1:$B$2\"\r\n\r\n'Print it\r\nActiveSheet.PrintOut\r\n\r\n'Delete resume.xlw file (workspace file)\r\nOn Error Resume Next\r\nKill objExcel.DefaultFilePath & \"\\Resume.xlw\"\r\nOn Error GoTo 0\r\n\r\n\r\n'Save changes and exit\r\nobjExcel.Save\r\nobjExcel.Quit\r\n\r\nSet objExcel = Nothing\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Excel","OLE Automation","VBA"]},{"RecordId":"197","Title":"Initial Caps Within A String","Description":"This routine capitalizes the first letter of each word in a string.  (All characters following spaces and hyphens.  Also capitalizes the first letter after Mc for names.","Code":"Function Upeach (msg As Variant)\r\n  On Error Resume Next\r\n  Dim length As Integer\r\n  Dim tmpmsg As String\r\n  Dim count As Integer\r\n\r\n  length = Len(msg): If length < 1 Then Exit Function\r\n  tmpmsg = UCase$(Left$(msg, 1))\r\n  For count% = 2 To length\r\n    If Mid$(msg, count% - 1, 1) = \" \" Or Mid$(msg, count% - 1, 1) = \"-\" Then\r\n      tmpmsg = tmpmsg + UCase$(Mid$(msg, count%, 1))\r\n    ElseIf count% = 3 Then\r\n      If Mid$(msg, count% - 2, 2) = \"mc\" Or Mid$(msg, count% - 2, 2) = \"Mc\" Then\r\n        tmpmsg = tmpmsg + UCase$(Mid$(msg, count%, 1))\r\n      Else\r\n        tmpmsg = tmpmsg + Mid$(msg, count%, 1)\r\n      End If\r\n    Else\r\n      tmpmsg = tmpmsg + Mid$(msg, count%, 1)\r\n    End If\r\n  Next count%\r\n  Upeach = tmpmsg\r\nEnd Function\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Capitalization"]},{"RecordId":"199","Title":"VB6 Controls","Description":"OCX filenames for VB6 controls","Code":"ADO Data Control\t\tMSADODC.ocx\r\nCoolbar\t\t\tCOMCT332.ocx\r\nDatagrid\t\t\tMSDATGRD.ocx\r\nDataList & DataCombo\tMSDATLST.ocx\r\nDataRepeater\t\tMSDATREP.ocx\r\nDateTimePicker\t\tMSCOMCT2.ocx\r\nFlatScrollBar\t\tMSCOMCT2.ocx\r\nHierarchical FlexGrid\tMSHFLXGD.ocx\r\nImageCombo\t\tMSCOMCTL.ocx\r\nMonthView\t\tMSCOMCT2.ocx","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["VB6","Control Names"]},{"RecordId":"200","Title":"Restore MDI Child With Enter Key","Description":"This routine allows the user to press the ENTER key while a minimized child form (within an MDI application) has the focus to \"restore\" the window.\r\n\r\n","Code":"'Set the child form KeyPreview property to true, and use the following code in the form's KeyDown event:\r\nSub Form_KeyDown (KeyCode As Integer, Shift As Integer)\r\n   If KeyCode = 13 and Me.WindowState =1 Then Me.WindowState = 0\r\nEnd Sub\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Restore Window","MDI"]},{"RecordId":"201","Title":"Justify Text (Right or Left)","Description":"Right or Left justify text in a field","Code":"Format$(123, \"@@@@@@\")    'gives \"    123\"\r\nFormat$(123, \"!@@@@@@\")    'gives \"123    \"","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Justify Text","Position Text"]},{"RecordId":"202","Title":"Timer (Benchmarking)","Description":"VB4 benchmarking routines","Code":"'This initializes the timer\r\nBenchmarkStart\r\n\r\n'This prints benchmark time values\r\nDebug.Print \"Time = \"; BenchmarkTime(); \"seconds.\"\r\n\r\nPublic Sub BenchmarkStart()\r\n    Dim mmt As MMTIME, ret As Long\r\n    mmt.wType = TIME_MS\r\n    ret = timeGetSystemTime(mmt, LenB(mmt))\r\n    bmStart = mmt.units\r\nEnd Sub\r\n\r\nPublic Function BenchmarkTime() As Single\r\n    Dim mmt As MMTIME, ret As Long\r\n    mmt.wType = TIME_MS\r\n    ret = timeGetSystemTime(mmt, LenB(mmt))\r\n    BenchmarkTime = (mmt.units - bmStart) / 1000\r\nEnd Function\r\n","Declares":"#If Win16 Then\r\n    Type SMPTE\r\n        hour As String * 1\r\n        min As String * 1\r\n        sec As String * 1\r\n        frame As String * 1\r\n        fps As String * 1\r\n        dummy As String * 1\r\n    End Type\r\n    Type MMTIME\r\n        wType As Integer\r\n        units As Long\r\n        smpteVal As SMPTE\r\n        songptrpos As Long\r\n    End Type\r\n    Declare Function timeGetSystemTime Lib \"MMSYSTEM\" (lpTime As MMTIME, ByVal uSize As Integer) As Integer\r\n#Else\r\n    Type SMPTE\r\n        hour As Byte\r\n        min As Byte\r\n        sec As Byte\r\n        frame As Byte\r\n        fps As Byte\r\n        dummy As Byte\r\n        pad(2) As Byte\r\n    End Type\r\n    Type MMTIME\r\n        wType As Long\r\n        units As Long\r\n        smpteVal As SMPTE\r\n        songptrpos As Long\r\n    End Type\r\n    Declare Function timeGetSystemTime Lib \"winmm.dll\" (lpTime As MMTIME, ByVal uSize As Long) As Long\r\n#End If\r\n\r\nConst TIME_MS = 1\r\nDim bmStart As Long\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Timer"]},{"RecordId":"203","Title":"Document-centered shell execution","Description":"Use ShellExecute to open a document with the document's parent application based on the document's extension","Code":"'-------------------------------------\r\n'Actions are: open, print, explore\r\nShellEx Me.hWnd, \"c:\\msoffice\\winword\\docs\\\", \"Day Runner.doc\", \"open\"\r\n'-------------------------------------\r\nPublic Sub ShellEx(hWnd As Long, cPath As String, cDoc As String, Optional cAction As Variant, Optional cParms As Variant, Optional nShowCmd As Variant)\r\n    \r\n    Dim lRtn As Long\r\n    Dim cMsg As String\r\n    \r\n    If IsMissing(cAction) Or Trim(cAction) = \"\" Then\r\n        cAction = \"open\"\r\n    End If\r\n    \r\n    If IsMissing(cParms) Then\r\n        cParms = vbNullString\r\n    End If\r\n    \r\n    If IsMissing(nShowCmd) Then\r\n        nShowCmd = SW_NORMAL\r\n    End If\r\n    \r\n    lRtn = ShellExecute(hWnd, cAction, cPath & cDoc, cParms, cPath, nShowCmd)\r\n    \r\n    If lRtn <= 32 Then\r\n        ShellErr (lRtn)\r\n    End If\r\n    \r\nEnd Sub\r\n'-------------------------------------\r\nPublic Sub ShellErr(lRtn As Long)\r\n\r\n    Dim cMsg As String\r\n    \r\n    Select Case lRtn\r\n        Case 0\r\n            cMsg = \"Memory Error\"\r\n        Case ERROR_BAD_FORMAT\r\n            cMsg = \"Bad executable format\"\r\n        Case ERROR_FILE_NOT_FOUND\r\n            cMsg = \"File not found\"\r\n        Case ERROR_PATH_NOT_FOUND\r\n            cMsg = \"Path not found\"\r\n        Case SE_ERR_ACCESSDENIED\r\n            cMsg = \"Access denied\"\r\n        Case SE_ERR_ASSOCINCOMPLETE\r\n            cMsg = \"Association incomplete\"\r\n        Case SE_ERR_DDEBUSY\r\n            cMsg = \"DDE busy error\"\r\n        Case SE_ERR_DDEFAIL\r\n            cMsg = \"DDE failed\"\r\n        Case SE_ERR_DDETIMEOUT\r\n            cMsg = \"DDE time out\"\r\n        Case SE_ERR_FNF\r\n            cMsg = \"File not found\"\r\n        Case SE_ERR_NOASSOC\r\n            cMsg = \"No association for this file\"\r\n        Case SE_ERR_OOM\r\n            cMsg = \"Out of memory\"\r\n        Case SE_ERR_PNF\r\n            cMsg = \"Path not found\"\r\n        Case SE_ERR_SHARE\r\n            cMsg = \"Sharing violation\"\r\n        Case Else\r\n            cMsg = \"Unknown error\"\r\n    End Select\r\n    \r\n    MsgBox cMsg, vbCritical, \"Shell execute error [\" & CStr(lRtn) & \"]\"\r\n    \r\nEnd Sub\r\n\r\n\r\n","Declares":"Option Explicit\r\n\r\n#If Win16 Then\r\n    Private Declare Function ShellExecute Lib \"shell.dll\" (ByVal hWnd As Integer, ByVal lpOperation As String, ByVal lpFile As String, ByVal lpParameters As String, ByVal lpDrectory As String, ByVal nShowCmd As Integer) As Integer\r\n#Else\r\n    Private Declare Function ShellExecute Lib \"shell32.dll\" Alias \"ShellExecuteA\" (ByVal hWnd As Long, ByVal lpOperation As String, ByVal lpFile As String, ByVal lpParameters As String, ByVal lpDrectory As String, ByVal nShowCmd As Long) As Long\r\n#End If\r\n\r\nPublic Const SW_HIDE = 0\r\nPublic Const SW_MAXIMIZE = 3\r\nPublic Const SW_MINIMIZE = 6\r\nPublic Const SW_NORMAL = 1\r\nPublic Const SW_SHOWDEFAULT = 10\r\nPublic Const SW_SHOWMAXIMIZED = 3\r\nPublic Const SW_SHOWMINIMIZED = 2\r\nPublic Const SW_SHOWNA = 8\r\nPublic Const SW_SHOWNOACTIVATE = 4\r\nPublic Const SW_SHOWNORMAL = 1\r\n\r\nPublic Const ERROR_BAD_FORMAT = 11&\r\nPublic Const ERROR_FILE_NOT_FOUND = 2&\r\nPublic Const ERROR_PATH_NOT_FOUND = 3&\r\nPublic Const SE_ERR_ACCESSDENIED = 5\r\nPublic Const SE_ERR_ASSOCINCOMPLETE = 27\r\nPublic Const SE_ERR_DDEBUSY = 30\r\nPublic Const SE_ERR_DDEFAIL = 29\r\nPublic Const SE_ERR_DDETIMEOUT = 28\r\nPublic Const SE_ERR_FNF = 2\r\nPublic Const SE_ERR_NOASSOC = 31\r\nPublic Const SE_ERR_OOM = 8\r\nPublic Const SE_ERR_PNF = 3\r\nPublic Const SE_ERR_SHARE = 26\r\n\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Shell","File Association"]},{"RecordId":"205","Title":"Free Space on Drive","Description":"Determines free space on a drive","Code":"'-----------------------------------------------------------------------------\r\n' Get freespace on a drive\r\n'-----------------------------------------------------------------------------\r\ndim destSpaceFree as long\r\n\r\ndestSpaceFree = GetDiskSpaceFree(destDrive$)  \r\nFunction GetDiskSpaceFree (drive As String) As Long\r\n    ChDrive drive\r\n    GetDiskSpaceFree = DiskSpaceFree()\r\nEnd Function\r\n","Declares":"Declare Function DiskSpaceFree Lib \"SETUPKIT.DLL\" () As Long","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Disk Space","Free Disk Space","System Info"]},{"RecordId":"207","Title":"Convert Amounts to Words (Check Writing)","Description":"Converts currency amounts to words for check writing.\r\nHandles up to 999,999,999,999.99 (999+ Billion).","Code":"'--------------------------------------------------------------------------\r\n' Call it like this: \r\n'--------------------------------------------------------------------------\r\nstrYourStringVar = AmountsToWords(1234567.89)\r\n\r\n\r\n'--------------------------------------------------------------------------\r\n' The following is the complete class module\r\n'--------------------------------------------------------------------------\r\nOption Explicit\r\n\r\nPrivate strTens(2 To 9) As String\r\nPrivate strDigits(0 To 19) As String\r\n\r\nPublic Function AmountToWords(ByVal curAmountIn As Currency) As String\r\n\r\nDim intBillions As Integer\r\nDim intMillions As Integer\r\nDim intThousands As Integer\r\nDim intHundreds As Integer\r\nDim intCents As Integer\r\nDim strAmountIn As String\r\nDim strTempString As String\r\n\r\n\r\n'Break up amount into billions, millions, thousands, and hundreds\r\nstrAmountIn = Format$(curAmountIn, \"000000000000.00\")\r\n\r\nintBillions = CInt(Left$(strAmountIn, 3))\r\nintMillions = CInt(Mid$(strAmountIn, 4, 3))\r\nintThousands = CInt(Mid$(strAmountIn, 7, 3))\r\nintHundreds = CInt(Mid$(strAmountIn, 10, 3))\r\nintCents = CInt(Right$(strAmountIn, 2))\r\n\r\nstrTempString = \"\"\r\n\r\n'1 billion and above (Don't I wish . . .)\r\nIf intBillions > 0 Then\r\n    strTempString = ThreeDigitsToWords(intBillions) & \" Billion \"\r\nEnd If\r\n\r\n\r\n'1,000,000 - 999,999,999.99\r\nIf intMillions > 0 Then\r\n    strTempString = strTempString & ThreeDigitsToWords(intMillions) & \" Million \"\r\nEnd If\r\n\r\n\r\n'1,000 - 999,999.99\r\nIf intThousands > 0 Then\r\n    strTempString = strTempString & ThreeDigitsToWords(intThousands) & \" Thousand \"\r\nEnd If\r\n\r\n\r\n'1 - 999.99\r\nIf intHundreds > 0 Then\r\n    strTempString = strTempString & ThreeDigitsToWords(intHundreds)\r\nEnd If\r\n\r\n'Add cents to the end\r\nIf strTempString <> \"\" Then\r\n    strTempString = Trim$(strTempString) & \" & \"\r\nEnd If\r\n\r\nstrTempString = strTempString & Format$(intCents, \"00\") & \"/100 Dollars\"\r\n\r\nAmountToWords = strTempString\r\n\r\nEnd Function\r\n\r\n\r\n\r\nPrivate Function ThreeDigitsToWords(ByVal intNumberIn As String) As String\r\n\r\nDim strTempString As String\r\nDim strNumberIn As String\r\nDim intOnes As Integer\r\nDim intTens As Integer\r\nDim intHundreds As Integer\r\n\r\n\r\nstrTempString = \"\"\r\nstrNumberIn = Format$(intNumberIn, \"000\")\r\n\r\nintHundreds = CInt(Left$(strNumberIn, 1))\r\nintTens = CInt(Mid$(strNumberIn, 2, 1))\r\nintOnes = CInt(Right$(strNumberIn, 1))\r\n\r\n\r\n'Hundreds\r\nIf intHundreds > 0 Then\r\n    strTempString = strDigits(intHundreds) & \" Hundred \"\r\nEnd If\r\n\r\n\r\n'Tens (20 - 99)\r\nIf intTens >= 2 Then\r\n    strTempString = strTempString & strTens(intTens) & \" \"\r\n    \r\n'Tens (10 - 19)\r\nElse\r\n    If intTens >= 1 Then\r\n        strTempString = strTempString & strDigits((intTens * 10) + intOnes) & \" \"\r\n    End If\r\nEnd If\r\n\r\n'Ones (0 - 9)\r\nIf intTens <> 1 And intOnes > 0 Then\r\n    strTempString = strTempString + strDigits(intOnes)\r\nEnd If\r\n\r\nThreeDigitsToWords = Trim$(strTempString)\r\n\r\nEnd Function\r\n\r\n\r\nPrivate Sub Class_Initialize()\r\n\r\nstrTens(2) = \"Twenty\"\r\nstrTens(3) = \"Thirty\"\r\nstrTens(4) = \"Forty\"\r\nstrTens(5) = \"Fifty\"\r\nstrTens(6) = \"Sixty\"\r\nstrTens(7) = \"Seventy\"\r\nstrTens(8) = \"Eighty\"\r\nstrTens(9) = \"Ninety\"\r\n\r\nstrDigits(0) = \"Zero\"\r\nstrDigits(1) = \"One\"\r\nstrDigits(2) = \"Two\"\r\nstrDigits(3) = \"Three\"\r\nstrDigits(4) = \"Four\"\r\nstrDigits(5) = \"Five\"\r\nstrDigits(6) = \"Six\"\r\nstrDigits(7) = \"Seven\"\r\nstrDigits(8) = \"Eight\"\r\nstrDigits(9) = \"Nine\"\r\nstrDigits(10) = \"Ten\"\r\nstrDigits(11) = \"Eleven\"\r\nstrDigits(12) = \"Twelve\"\r\nstrDigits(13) = \"Thirteen\"\r\nstrDigits(14) = \"Fourteen\"\r\nstrDigits(15) = \"Fifteen\"\r\nstrDigits(16) = \"Sixteen\"\r\nstrDigits(17) = \"Seventeen\"\r\nstrDigits(18) = \"Eighteen\"\r\nstrDigits(19) = \"Nineteen\"\r\n\r\nEnd Sub","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["AmountsToWords","Check Writing","Checks"]},{"RecordId":"208","Title":"Timestamp Fields In SQL Server (ADO)","Description":"Demonstrates how to retrieve/update records that contain timestamp fields.","Code":"Option Explicit\r\n\r\nPrivate con As New ADODB.Connection\r\n\r\n' A SQL Server timestamp column is a binary array.\r\n' We can store a timestamp in a Visual Basic Variant variable.\r\nPrivate varTStamp As Variant\r\n\r\n\r\nPrivate Sub Form_Load()\r\n\r\n  Command1.Caption = \"Retrieve by Date\"\r\n  Command2.Caption = \"Retrieve by TimeStamp\"\r\n  Command2.Enabled = False\r\n  Command3.Caption = \"Quit\"\r\n\r\n 'This example uses the ODBC Provider with a Pubs DSN.\r\n 'Modify your connect string as needed.\r\n  con.CursorLocation = adUseClient\r\n  con.Open (\"DSN=Pubs;UID=sa;PWD=;\")\r\n\r\nEnd Sub\r\n\r\n\r\nPrivate Sub Command1_Click()\r\n\r\n  'Retrieve a row based on date\r\n  'then store the retrieved timestamp column in a Variant.\r\n\r\n  Dim rs As New ADODB.Recordset\r\n\r\n  rs.ActiveConnection = con\r\n  rs.Open \"select * from whatime where tdate = '10/31/1998'\"\r\n\r\n  Debug.Print rs(\"id\"), rs(\"aname\"), rs(\"tdate\"), rs(\"tstamp\")\r\n  Debug.Print rs(\"tstamp\").Type   '128: timestamp is type adBinary\r\n\r\n  ' Store the timestamp value, to retrieve the record in Command2.\r\n  ' The timestamp must be stored in a Variant.\r\n  varTStamp = rs(\"tstamp\")\r\n\r\n  Command2.Enabled = True\r\n\r\n  rs.Close\r\n  Set rs = Nothing\r\n\r\nEnd Sub\r\n\r\n\r\nPrivate Sub Command2_Click()\r\n\r\n  'Retrieve a row using the timestamp value from Command1.\r\n  'Use a Command object and a Parameter object to explicitly pass\r\n  'the timestamp as adVarBinary, size 8.\r\n\r\n  Dim cmd As New ADODB.Command\r\n  Dim param As New ADODB.Parameter\r\n  Dim rs As New ADODB.Recordset\r\n\r\n  cmd.ActiveConnection = con\r\n  cmd.CommandType = adCmdText\r\n  cmd.CommandText = \"select * from whatime where tstamp = ?\"\r\n\r\n 'The parameter must be type adVarBinary, size 8 to pass a timestamp.\r\n\r\n  Set param = cmd.CreateParameter(, adVarBinary, adParamInput)\r\n  param.Size = 8\r\n\r\n  cmd.Parameters.Append param\r\n\r\n  'Retrieve based on the Variant from Command1.\r\n  param.Value = varTStamp\r\n\r\n  Set rs = cmd.Execute()\r\n\r\n  Debug.Print rs(\"id\"), rs(\"aname\"), rs(\"tdate\"), rs(\"tstamp\")\r\n  Debug.Print rs(\"tstamp\").Type     'Type 128: adBinary\r\n\r\n  rs.Close\r\n  Set rs = Nothing\r\n  Set cmd = Nothing\r\n\r\nEnd Sub\r\n\r\n\r\nPrivate Sub Command3_Click()\r\n\r\n   Unload Me\r\n   End\r\n\r\nEnd Sub\r\n\r\n\r\nPrivate Sub Form_Unload(Cancel As Integer)\r\n\r\n   con.Close\r\n   Set con = Nothing\r\n\r\nEnd Sub","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Timestamp","SQL Server","ADO"]},{"RecordId":"209","Title":"Purge FileName Entry","Description":"Routine that removes invalid characters from a filename and returns the result as a string.","Code":"Function PurgeFileNameEntry (Argument As String) As String\r\n' Version 1.0\r\n    Dim x As Integer\r\n    Dim ValidCharacter As Integer\r\n    Dim NewFileName As String\r\n\r\n    PurgeFileNameEntry = \"\"\r\n    Argument = UCase(Trim(Argument))\r\n    If Len(Argument) = \"\" Then Exit Function\r\n    For x = 1 To Len(Argument)\r\n        ValidCharacter = False\r\n        Select Case Mid(Argument, x, 1)\r\n            Case \"A\" To \"Z\": ValidCharacter = True\r\n            Case \"0\" To \"9\": ValidCharacter = True\r\n            Case \"-\": ValidCharacter = True\r\n            Case \"_\": ValidCharacter = True\r\n            Case \"!\": ValidCharacter = True\r\n            Case \"@\": ValidCharacter = True\r\n            Case \"#\": ValidCharacter = True\r\n            Case \"$\": ValidCharacter = True\r\n            Case \"%\": ValidCharacter = True\r\n            Case \"&\": ValidCharacter = True\r\n            Case \"(\": ValidCharacter = True\r\n            Case \")\": ValidCharacter = True\r\n            Case \"{\": ValidCharacter = True\r\n            Case \"}\": ValidCharacter = True\r\n            Case \"'\": ValidCharacter = True\r\n            Case \"`\": ValidCharacter = True\r\n            Case \"~\": ValidCharacter = True\r\n            Case Chr$(128) To Chr$(255): ValidCharacter = True\r\n        End Select\r\n        If ValidCharacter = True Then NewFileName = NewFileName + Mid(Argument, x, 1)\r\n    Next x\r\n    If Len(NewFileName) > 8 Then NewFileName = Left(NewFileName, 8)\r\n    If Len(NewFileName) > 0 Then PurgeFileNameEntry = NewFileName\r\n\r\nEnd Function\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["File Name"]},{"RecordId":"210","Title":"Navigate XML DOM","Description":"Demonstrates how to navigate the XML DOM","Code":"Dim xmlDoc\r\nSet xmlDoc = Server.CreateObject(\"Microsoft.XMLDOM\")\r\n   or\r\nSet xmlDoc = CreateObject(\"MSXML.DOMDocument\")\r\n\r\n'load the widget.xml document\r\nxmlDoc.load(Server.MapPath(\"widget.xml\"))\r\n  or\r\nbSuccess = xmlDoc.load(\"hamburger.xml\")\r\n\r\nIf bSuccess Then\r\n   For Each node in xmlDoc.documentElement.childNodes\r\n       strNodeName = node.NodeName\r\n       strNodeText = node.Text\r\n   Next\r\nEnd If\r\n\r\n\r\n'--------------------------------\r\n'  hamburger.xml\r\n'--------------------------------\r\n<?xml version=\"1.0\"?>\r\n<hamburgers>\r\n  <hamburger lowfat=\"dream on\">\r\n    <name>CowBurger</name>\r\n    <description>Greasy and good.</description>\r\n    <price>2.99</price>\r\n  </hamburger>\r\n</hamburgers>\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"8","CategoryDescription":"XML"},"Keywords":["XML","DOM"]},{"RecordId":"211","Title":"ADO Providers","Description":"Connect strings for ADO using SQL, ODBC, and Jet providers","Code":"OLEDB Provider for ODBC           Provider=MSDASQL;\r\n                                                     Driver={SQL Server};\r\n                                                     UID=sa;\r\n                                                     PWD=;\r\n                                                     Server=MyServer;\r\n                                                     Database=MyDatabaseName\r\n\r\nOLEDB Provider for SQL Server   Provider=OLEDBSQL;\r\n                                                     UID=sa;\r\n                                                     PWD=;\r\n                                                     Server=MyServer;\r\n                                                     Database=MyDatabaseName\r\n\r\nOLEDB Provider for JET               Provider=Microsoft.Jet.OLEDB.4.0;\r\n                                                     Data Source=c:\\Path\\MyDatabaseName.mdb;\r\n\r\nOLEDB Provider for Oracle                        Provider=MSDAORA;\r\nOLEDB Provider for MS Index Server        Provider=MSIDXS;\r\nOLEDB Provider for MS Active Directory   Provider=ADSDSOObject;\r\n\r\nOLEDB Provider for MS Excel\r\nSet adoCN = CreateObject(\"ADODB.Connection\")\r\n With adoCn\r\n  .Provider = \"Microsoft.Jet.OLEDB.4.0\"\r\n  .ConnectionString = _\r\n       \"Data Source = \" & server.mapPath(strPhotoPath & photofilename) & \";\" & _\r\n       \"Extended Properties=Excel 8.0;\"\r\n  .Open\r\nEnd With","Declares":"","CodeCategory":{"CategoryId":"3","CategoryDescription":"Database"},"Keywords":["ADO","Connect Strings","DSNLess Connections"]},{"RecordId":"212","Title":"Unload All Forms","Description":"Unloads all forms at close (2 methods)","Code":"Dim i As Integer\r\n\r\n'---- Method 1 ----\r\nFor i = Forms.Count - 1 To 1 Step -1\r\n  Unload Forms(i)\r\n  Set Forms(i) = Nothing\r\nNext\r\n\r\n'---- Method 2 ----\r\ni = Forms.Count\r\nDo While i > 0\r\n  Unload Forms(i - 1)\r\n  Set Forms(i - 1) = Nothing\r\n  If i = Forms.Count Then Exit Do\r\n  i = i - 1\r\nLoop\r\n\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Unload Forms","Close forms"]},{"RecordId":"215","Title":"Get Windows\\System Directory","Description":"Returns the location of the windows\\system directory","Code":"winSysDir$ = UCase$(GetWindowsSysDir$())\r\n\r\nFunction GetWindowsSysDir () As String\r\n    temp$ = String$(145, 0)                 ' Size Buffer\r\n    x = GetSystemDirectory(temp$, 145)      ' Make API Call\r\n    temp$ = Left$(temp$, x)                 ' Trim Buffer\r\n\r\n    If Right$(temp$, 1) <> \"\\\" Then         ' Add \\ if necessary\r\n        GetWindowsSysDir$ = temp$ + \"\\\"\r\n    Else\r\n        GetWindowsSysDir$ = temp$\r\n    End If\r\nEnd Function","Declares":"Declare Function GetSystemDirectory Lib \"Kernel\" (ByVal lpBuffer As String, ByVal nSize As Integer) As Integer","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Windows Directory","System Info"]},{"RecordId":"216","Title":"Default Windows Wallpaper","Description":"Location of (and how to change) Windows default wall paper (at logon screen)","Code":"HKEY_USERS\r\n  .Default\r\n    Control Panel\r\n        Desktop\r\n            Wallpaper\r\nThe default value is \"(Default)\".  Change it to the fully qualified path of the bitmap.\r\n\r\nThe default background color is located in:\r\nHKEY_USERS\r\n  .Default\r\n    Control Panel\r\n        Colors\r\n            Background\r\nThe default value is \"0 128 128\".  \"0 0 0\" is black.\r\n","Declares":"","CodeCategory":{"CategoryId":"7","CategoryDescription":"Misc"},"Keywords":["Wallpaper","Logon Wallpaper","Desktop"]},{"RecordId":"217","Title":"Wipe File","Description":"Overwrites a file on disk with Xs and spaces to prevent recovery","Code":"Sub WipeFile (FileName As String)\r\n\r\n'This subroutine will read a file and replace it with Xs and spaces.\r\n'This subroutine is used to \"clear\" a file from disk so that it can not be recovered.\r\n\r\nDim Block1 As String, Block2 As String, Blocks As Long\r\nDim hFile As Integer, i As Long, Offset As Long\r\n\r\nConst BLOCKSIZE = 4096\r\n\r\nBlock1 = String(BLOCKSIZE, \"X\")\r\nBlock2 = String(BLOCKSIZE, \" \")\r\n\r\nhFile = FreeFile\r\nOpen FileName For Binary As hFile\r\nBlocks = (LOF(hFile) \\ BLOCKSIZE) + 1\r\n\r\nFor i = 1 To Blocks\r\n    Offset = Seek(hFile)\r\n    Put hFile, , Block1\r\n    Put hFile, Offset, Block2\r\nNext i\r\n\r\nClose hFile\r\nKill FileName\r\n\r\nEnd Sub","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Wipe File","Delete","Security"]},{"RecordId":"218","Title":"MS Word Routines","Description":"Routines for opening documents, printing, mail merges, and table creation.\r\nRequires reference to MS Word 8.0 Object Library in project references.","Code":"Public gboolRunning As Boolean\r\nPublic goWord As Word.Application\r\n'---------------------------------------------------------------------------------\r\nPublic Function MSWordOpen() As Boolean\r\n\r\nOn Error Resume Next\r\n\r\ngboolRunning = True\r\nSet goWord = GetObject(, \"Word.Application\")\r\nIf goWord Is Nothing Then\r\n    Set goWord = CreateObject(\"Word.Application\")\r\n    gboolRunning = True\r\nEnd If\r\n\r\nIf goWord Is Nothing Then\r\n    MsgBox \"Can't create word object\"\r\n    MSWordOpen = False\r\nElse\r\n    If Not goWord.Visible Then\r\n        goWord.Visible = True\r\n    End If\r\n    MSWordOpen = True\r\nEnd If\r\n\r\nDoEvents\r\n\r\nEnd Function\r\n'---------------------------------------------------------------------------------\r\nPublic Sub MSWordShutdown()\r\n\r\nIf Not goWord Is Nothing Then\r\n    If goWord.Documents.Count > 1 Then\r\n        If MsgBox(\"Close Word Document\", vbYesNo + vbQuestion, \"Word Automation\") = vbYes Then\r\n            'goWord.ActiveDocument.Close wdDoNotSaveChanges\r\n            goWord.ActiveDocument.Close wdSaveChanges\r\n        End If\r\n    End If\r\n    \r\n    If Not gboolRunning Then\r\n        goWord.Quit\r\n    End If\r\n    \r\n    Set goWord = Nothing\r\n    \r\nEnd If\r\n\r\nEnd Sub\r\n'---------------------------------------------------------------------------------\r\nPublic Sub PrintWordDocument()\r\n\r\nDim oDoc As Word.Document\r\n\r\nIf MSWordOpen() Then\r\n    Set oDoc = goWord.ActiveDocument\r\n    oDoc.PrintPreview\r\n    'oDoc.PrintOut\r\nEnd If\r\n    \r\nDoEvents\r\n\r\nEnd Sub\r\n'---------------------------------------------------------------------------------\r\nPublic Function FindWordDocument(strName As String) As Boolean\r\n\r\nDim oDoc As Word.Document\r\nDim blnFound As Boolean\r\n\r\nblnFound = False\r\n\r\nIf MSWordOpen() Then\r\n    For Each oDoc In goWord.Documents\r\n    \r\n        If Trim$(UCase(oDoc.Name)) = Trim$(UCase(strName)) Then\r\n            oDoc.Activate\r\n            blnFound = True\r\n            Exit For\r\n        End If\r\n    Next\r\nEnd If\r\n    \r\nDoEvents\r\n\r\nIf blnFound Then\r\n    ' do something here . . .\r\nEnd If\r\n\r\nFindWordDocument = blnFound\r\n\r\nEnd Function\r\n'---------------------------------------------------------------------------------\r\nPublic Sub MailMerge1()\r\n\r\n'Assumes that bookmarks Company, Street, City, State, and ZipCode exist in a word document\r\n\r\nDim oDoc As Word.Document\r\n\r\nIf MSWordOpen() Then\r\n    Set oDoc = goWord.Documents.Add(App.Path & \"\\AutoWord.dot\")\r\n    With oDoc.Bookmarks\r\n        .Item(\"Company\").Range.Text = txtCompany\r\n        .Item(\"Street\").Range.Text = txtStreet\r\n        .Item(\"City\").Range.Text = txtCity\r\n        .Item(\"State\").Range.Text = txtState\r\n        .Item(\"ZipCode\").Range.Text = txtZip\r\n    End With\r\n     \r\n    With oDoc.PageSetup\r\n        .BottomMargin = 1.5\r\n        .TopMargin = 1.5\r\n        .RightMargin = 2#\r\n        .LeftMargin = 2#\r\n        .Orientation = wdOrientPortrait\r\n    End With\r\n    \r\n    DoEvents\r\nEnd If\r\n\r\nEnd Sub\r\n'---------------------------------------------------------------------------------\r\nPublic Sub MailMerge2()\r\n\r\nDim oDoc As Word.Document\r\n\r\nIf MSWordOpen() Then\r\n    Set oDoc = goWord.Documents.Add(App.Path & \"\\DogSales.doc\")\r\n    \r\n    With oDoc.MailMerge\r\n        .Destination = wdSendToNewDocument\r\n        With .DataSource\r\n            .FirstRecord = wdDefaultFirstRecord\r\n            .LastRecord = wdLastRecord\r\n        End With\r\n        .Execute Pause:=False\r\n    End With\r\nEnd If\r\n    \r\nDoEvents\r\n\r\nEnd Sub\r\n'---------------------------------------------------------------------------------\r\nPublic Sub CreateWordTable()\r\n\r\nDim oDoc As Word.Document\r\nDim oTable As Word.Table\r\nDim intPos As Integer\r\nDim intRow As Integer\r\nDim db As Database\r\nDim rs As Recordset\r\n\r\nIf MSWordOpen() Then\r\n\r\n    Set oDoc = goWord.Documents.Add(App.Path & \"\\pdsa.dot\")\r\n    \r\n    'Optimize word settings for speed\r\n    goWord.ScreenUpdating = False\r\n    With goWord.Options\r\n        .CheckGrammarAsYouType = False\r\n        .CheckSpellingAsYouType = False\r\n        .Pagination = False\r\n    End With\r\n    \r\n    'Create report header\r\n    oDoc.Paragraphs.Add\r\n    With oDoc.Paragraphs(1)\r\n        .Range.Text = \"My Heading Text\"\r\n        .Style = \"Heading 1\"\r\n    End With\r\n    oDoc.Paragraphs.Add\r\n    oDoc.Paragraphs.Add\r\n    \r\n    'Get end of document position\r\n    intPos = oDoc.Paragraphs(oDoc.Paragraphs.Count).Range.End\r\n    \r\n    'Create a table\r\n    Set oTable = oDoc.Tables.Add(Range:=oDoc.Range(Start:=intPos - 1, End:=intPos), NumRows:=1, NumColumns:=8)\r\n    With oTable\r\n        .Cell(1, 1).Range.InsertAfter \"Breed Name\"\r\n        .Cell(1, 2).Range.InsertAfter \"Size\"\r\n        .Cell(1, 3).Range.InsertAfter \"Friendly\"\r\n        .Cell(1, 4).Range.InsertAfter \"Aggressive\"\r\n        .Cell(1, 5).Range.InsertAfter \"Family\"\r\n        .Cell(1, 6).Range.InsertAfter \"Hunter\"\r\n        .Cell(1, 7).Range.InsertAfter \"Herder\"\r\n        .Cell(1, 8).Range.InsertAfter \"Guard Dog\"\r\n    End With\r\n    \r\n    'Open recordset\r\n    Set db = Opendatabase(\"MyDB.mdb\")\r\n    Set rs = db.openrecordset(\"tblMyDogTable\")\r\n    \r\n    'Fill table\r\n    intRow = 2\r\n    Do While Not rs.EOF\r\n        \r\n        With oTable\r\n            .Rows.Add\r\n            .Cell(intRow, 1).Range.InsertAfter rs!Breed\r\n            .Cell(intRow, 2).Range.InsertAfter rs!Size\r\n            .Cell(intRow, 3).Range.InsertAfter rs!Friendly\r\n            .Cell(intRow, 4).Range.InsertAfter rs!Aggressive\r\n            .Cell(intRow, 5).Range.InsertAfter rs!Family\r\n            .Cell(intRow, 6).Range.InsertAfter rs!Hunter\r\n            .Cell(intRow, 7).Range.InsertAfter rs!Herder\r\n            .Cell(intRow, 8).Range.InsertAfter rs!GuardDog\r\n        End With\r\n        \r\n        intRow = intRow + 1\r\n        rs.movenext\r\n    Loop\r\n    \r\n    rs.Close\r\n    db.Close\r\n    Set rs = Nothing\r\n    Set db = Nothing\r\n    \r\n    'Turn screen updating back on\r\n    goWord.ScreenUpdating = True\r\n    \r\n    'Make row 1 the table header\r\n    With oTable\r\n        .Rows(1).HeadingFormat = True\r\n        .Rows(1).Range.Font.Bold = True\r\n        .Columns.AutoFit\r\n    End With\r\n    \r\n    'Set cursor to top of page\r\n    oDoc.Range(0, 0).Select\r\n\r\nEnd If\r\n\r\nEnd Sub\r\n'---------------------------------------------------------------------------------","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Word","OLE Automation"]},{"RecordId":"219","Title":"3D - Common Dialog 3D(2)","Description":"Makes all forms, controls, and common dialog boxes look 3D.\r\nNOTE:  BorderStyle of form must be 3 (Fixed double).","Code":"'---------------------------------------------------------------------------------------\r\n'Call this with every forms hWnd handle at form load event\r\n\r\nSub Ctl3DInit (hWnd As Integer)\r\n\r\nDim hInst  As Integer\r\nDim iResult As Integer\r\n\r\nhInst = GetWindowWord(hWnd, GWW_HINSTANCE)\r\niResult = Ctl3dRegister(hInst)\r\niResult = Ctl3dAutoSubClass(hInst)\r\n\r\n\r\nEnd Sub\r\n\r\n'---------------------------------------------------------------------------------------\r\n'Call this with every forms hWnd handle at form unload event\r\n\r\nSub Ctl3DExit (hWnd As Integer)\r\n\r\nDim hInst  As Integer\r\nDim iResult As Integer\r\n\r\nhInst = GetWindowWord(hWnd, GWW_HINSTANCE)\r\niResult = Ctl3dUnregister(hInst)\r\n\r\nEnd Sub\r\n\r\n'---------------------------------------------------------------------------------------\r\n'Call this with every forms name at form load event\r\n\r\nSub Ctl3DForm (frm As Form)\r\n\r\nDim hWnd  As Integer\r\nDim iResult As Integer\r\nDim lStyle As Long\r\n\r\nhWnd = frm.hWnd\r\n\r\nIf frm.BorderStyle = FIXED_DOUBLE Then\r\n   frm.BackColor = BUTTON_FACE\r\n   lStyle = GetWindowLong(hWnd, GWL_STYLE)\r\n   lStyle = lStyle Or DS_MODALFRAME\r\n   lStyle = SetWindowLong(hWnd, GWL_STYLE, lStyle)\r\n   iResult = Ctl3DSubclassDlgEx(hWnd, 0)\r\nEnd If\r\nEnd Sub\r\n","Declares":"Global Const BUTTON_FACE = &H8000000F\r\nGlobal Const FIXED_DOUBLE = 3\r\nGlobal Const DS_MODALFRAME = &H80&\r\nGlobal Const GWL_STYLE = (-16)\r\nGlobal Const GWW_HINSTANCE = (-6)\r\n\r\nDeclare Function Ctl3dAutoSubClass% Lib \"ctl3d.dll\" (ByVal hInst%)\r\nDeclare Function Ctl3dSubClassDlgEx% Lib \"ctl3d.dll\" (ByVal    hWnd%, ByVal Flags&)\r\nDeclare Function Ctl3dRegister% Lib \"ctl3d.dll\" (ByVal hInst%)\r\nDeclare Function Ctl3dUnRegister% Lib \"ctl3d.dll\" (ByVal hInst%)\r\nDeclare Function GetWindowLong& Lib \"User\" (ByVal   hWnd%, ByVal nIndex%)\r\nDeclare Function GetWindowWord% Lib \"User\" (ByVal hWnd%, ByVal   nIndex%)\r\nDeclare Function SetWindowLong& Lib \"User\" (ByVal   hWnd%, ByVal   nIndex%, ByVal dwNewLong&)","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["3D"]},{"RecordId":"221","Title":"Enum (Hiding Items)","Description":"Hide enum items from displaying, but include them for documentation.","Code":"Public Enum MyEnum\r\n    [_maMin] = 1\r\n    maLow = 1\r\n    maMedium = 2\r\n    maHigh = 3\r\n    [_maMax] = 3\r\nEnd Enum\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Enum","Hiding Enum Items"]},{"RecordId":"222","Title":"Undo Text Box Entry","Description":"Undo enterred data in a text to its previous value","Code":"iRet = SendMessage(txtTextBox.hWnd, EM_UNDO, 0, 0&)\r\n","Declares":"Declare Function SendMessage Lib \"User\" (byval hWnd as integer, byval wMsg as integer, byval wParam as integer, lParam as any) as long\r\n\r\nglobal const WM_USER = &H400\r\nglobal const EM_UNDO = (WM_USER + 23)\r\nglobal const CF_TEXT = 1\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Undo Text Box","Text Box"]},{"RecordId":"223","Title":"Dockable Form - Lock at top left","Description":"Locks a form in the top left corner of a screen.  (Requires Message Blaster VBX).","Code":"'Place the following code in the form load event\r\nDim hw As Integer\r\nhw = Me.hwd\r\n\r\nMsgBlaster1.hWndTarget = hw\r\nMsgBlaster1.MstList(0) = WM_MOVE\r\n\r\n'Place the following code in the Message Blaster Message event\r\nIf MsgVal = WM_MOVE Then\r\n    Visible = False\r\n    Me.top = 0\r\n    Me.left = 0\r\n    Visible = True\r\nEnd If\r\n\r\n","Declares":"Const WM_MOVE = &H3\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Dock Form","Lock Form Position"]},{"RecordId":"224","Title":"About Screen","Description":"Display an \"About\" message box","Code":"Sub Display_About ()\r\n\r\nDim KBFree As Long\r\nDim m As String\r\nDim GDIFree As Integer\r\nDim UserFree As Integer\r\nDim ExeDateTime As Variant\r\nDim ExePath As String\r\nDim ExeFile As String\r\n\r\nExePath = App.Path\r\n\r\nIf Right$(ExePath, 1) <> \"\\\" Then\r\n    ExePath = ExePath & \"\\\"\r\nEnd If\r\n\r\nExeFile = ExePath & App.EXEName & \".EXE\"\r\nOn Error Resume Next\r\n\r\nExeDateTime = FileDateTime(ExeFile)\r\nIf Err Then\r\n    m = \"Unable to verify EXE date and time.\" & Chr$(13)\r\nElse\r\n    m = \"File:  \" & ExeFile & Chr$(13)\r\n    m = m & \"Date:  \" & Format(ExeDateTime, \"mm/dd/yy\") & Chr$(13)\r\n    m = m & \"Time:  \" & Format(ExeDateTime, \"h:mm AM/PM\") & Chr$(13)\r\nEnd If\r\n\r\n\r\nKBFree = GetFreeSpace(0) \\ 1024\r\nm = m & \"Memory: \" & KBFree & \" KB Free\" & Chr$(13)\r\nGDIFree = GetFreeSystemResources(GFSR_GDIResources%)\r\nUserFree = GetFreeSystemResources(GFSR_UserResources%)\r\nm = m & \"Resources: \"\r\nIf UserFree <= GDIFree Then\r\n  m = m & UserFree & \"%\"\r\nElse\r\n  m = m & GDIFree & \"%\"\r\nEnd If\r\nMsgBox m\r\n\r\nEnd Sub","Declares":"Const GFSR_GDIResources% = 1\r\nConst GFSR_UserResources% = 2\r\n\r\nDeclare Function GetFreeSystemResources Lib \"User\" (ByVal fuSysResource As Integer) As Integer\r\nDeclare Function GetFreeSpace Lib \"Kernel\" (ByVal wFlags As Integer) As Long\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["About Screen"]},{"RecordId":"226","Title":"Clipboard Routines","Description":"Copy, Cut to clipboard; Paste from clipboard","Code":"Sub mEdit1_Click (Index As Integer)\r\nSelect Case Index\r\n    Case 0 'Undo Routine\r\n        'Basically need a variable to save old text to, to replace later.\r\n        ' Depending on how many levels of undo you need you can\r\n        'use an array to store old values in.\r\n    Case 2 'Cut to clipboard\r\n        Clipboard.Clear\r\n        Clipboard.SetText Screen.ActiveControl.SelText \r\n        Screen.ActiveControl.SelText = \"\" ' Clear text from the document.\r\n    Case 3 'Copy text to clipboard\r\n        Clipboard.Clear\r\n        ClipBoard.SetText Screen.ActiveControl.SelText\r\n    Case 4 'Paste text into document.\r\n        Screen.ActiveControl.SelText = Clipboard.GetText() \r\nEnd Select\r\nEnd Sub\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Clipboard"]},{"RecordId":"227","Title":"3D - CTL3DV2 & CTL3D","Description":"3D forms - Checks to see if it can first use CTL3Dv2.DLL, then tries to use CTL3D.DLL.\r\n","Code":"'-------------------------------------------------------\r\n' Put this code in the form load event to register 3D\r\n'-------------------------------------------------------\r\n \r\n Call Start3D(Me, Version3D())\r\n'-------------------------------------------------------\r\n' Put this code in the exit routines to unregister 3D\r\n'-------------------------------------------------------\r\n    ' stop the 3D functions\r\n Call End3D(Version3D())\r\n\r\nFunction Version3D () As Integer\r\n\r\nVersion3D = 0\r\n\r\nIf FileExists(\"c:\\windows\\system\\CTL3DV2.DLL\") Then\r\n    Version3D = 2\r\nElse\r\n    If FileExists(\"c:\\windows\\system\\CTL3D.DLL\") Then\r\n        Version3D = 1\r\n    End If\r\nEnd If\r\n\r\nEnd Function\r\nFunction FileExists (FileName As String) As Integer\r\n\r\n    Dim x As Long\r\n\r\n    On Error Resume Next\r\n    x = FileLen(FileName)\r\n    If x Then\r\n        FileExists = True\r\n    Else\r\n        FileExists = False\r\n    End If\r\n    \r\nEnd Function\r\nSub Start3D (Frm As Form, Version As Integer)\r\n    \r\n    Dim iResult As Integer\r\n    Dim lStyle As Long\r\n    \r\n    If Version = 1 Or Version = 2 Then\r\n\r\n        hInstance = GetWindowWord(Frm.hWnd, GWW_HINSTANCE)\r\n    \r\n        If Frm.BorderStyle = FIXED_DOUBLE Then\r\n            ' Set the Windows style bits to make CTL3D paint\r\n            ' the border as well as the client area\r\n            lStyle = GetWindowLong((Frm.hWnd), GWL_STYLE)\r\n            lStyle = lStyle Or DS_MODALFRAME\r\n            lStyle = SetWindowLong((Frm.hWnd), GWL_STYLE, lStyle)\r\n        End If\r\n        \r\n        Frm.BackColor = BUTTON_FACE\r\n        \r\n        If Version = 1 Then\r\n                iResult = Ctl3dRegisterV1(hInstance)\r\n                iResult = Ctl3dAutoSubClassV1(hInstance) 'MSGBoxes, InputBoxes  & Common dialogs\r\n                iResult = Ctl3dSubClassDlgExV1((Frm.hWnd), 0&) 'Form captions\r\n        ElseIf Version = 2 Then\r\n                iResult = Ctl3dRegisterV2(hInstance)\r\n                iResult = Ctl3dAutoSubclassV2(hInstance) 'MSGBoxes, InputBoxes & Common dialogs\r\n                iResult = Ctl3DSubClassDlgExV2((Frm.hWnd), 0&) 'Form captions\r\n        End If\r\n    End If\r\n\r\nEnd Sub\r\nSub End3D (Version As Integer)\r\n'-------------------------------------------------------\r\n' Un-Registers 3D\r\n'-------------------------------------------------------\r\n\r\n    Dim iResult As Integer\r\n    ' Unregister with CTL3D\r\n    If Version = 1 Then\r\n        iResult = Ctl3dUnRegisterV1(hInstance)\r\n    ElseIf Version = 2 Then\r\n        iResult = Ctl3dUnregisterV2(hInstance)\r\n    End If\r\n\r\n\r\nEnd Sub","Declares":"' API functions\r\nDeclare Function GetWindowLong& Lib \"User\" (ByVal hWnd%, ByVal nIndex%)\r\nDeclare Function GetWindowWord% Lib \"User\" (ByVal hWnd%, ByVal nIndex%)\r\nDeclare Function SetWindowLong& Lib \"User\" (ByVal hWnd%, ByVal nIndex%, ByVal dwNewLong&)\r\n\r\n' CTL3DV1 functions\r\nDeclare Function Ctl3dAutoSubClassV1% Lib \"ctl3d.dll\" Alias \"Ctl3dAutoSubClass\" (ByVal hInst%)\r\nDeclare Function Ctl3dSubClassDlgExV1% Lib \"ctl3d.dll\" Alias \"Ctl3dSubClassDlgEx\" (ByVal hWnd%, ByVal Flags&)\r\nDeclare Function Ctl3dRegisterV1% Lib \"ctl3d.dll\" Alias \"Ctl3dRegister\" (ByVal hInst%)\r\nDeclare Function Ctl3dUnRegisterV1% Lib \"ctl3d.dll\" Alias \"Ctl3dUnRegister\" (ByVal hInst%)\r\n\r\n' CTL3DV2 functions\r\nDeclare Function Ctl3dAutoSubclassV2 Lib \"Ctl3DV2.DLL\" Alias \"Ctl3dAutoSubclass\" (ByVal hInst As Integer) As Integer\r\nDeclare Function Ctl3dRegisterV2 Lib \"Ctl3DV2.DLL\" Alias \"Ctl3dRegister\" (ByVal hInst As Integer) As Integer\r\nDeclare Function Ctl3dUnregisterV2 Lib \"Ctl3DV2.DLL\" Alias \"Ctl3dUnregister\" (ByVal hInst As Integer) As Integer\r\nDeclare Function Ctl3DSubClassDlgExV2 Lib \"Ctl3DV2.DLL\" Alias \"Ctl3DSubClassDlgEx\" (ByVal hInst As Integer, ByVal Flags As Long) As Integer\r\nDeclare Function Ctl3dSubclassCtlExV2 Lib \"Ctl3DV2.DLL\" Alias \"Ctl3dSubclassCtlEx\" (ByVal hWnd As Integer, ByVal CntrlType As Integer) As Integer\r\n\r\n' Frame types\r\nGlobal Const DS_MODALFRAME = &H80&\r\nGlobal Const BUTTON_FACE = &H8000000F\r\nGlobal Const FIXED_DOUBLE = 3\r\n\r\n'Misc stuff\r\nGlobal Const GWL_STYLE = (-16)\r\nGlobal Const GWW_HINSTANCE = (-6)\r\nGlobal hInstance As Integer\r\n\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["3D","CTL3D"]},{"RecordId":"228","Title":"Center Forms (Relative to Another)","Description":"Use VB5's StartUpPosition property to make a form a child of another form and center it relative to the form.  (Makes the form behave just like a child of an MDI.","Code":"Me.StartUpPosition = vbStartUpOwner\r\nMe.Show vbModeless, frmParent","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Center form","MDI child"]},{"RecordId":"229","Title":"Printer Control - Passthrough Escape","Description":"Passthrough Escape Printer Control      \r\n'Using PASSTHROUGH Escape to Send Data Directly to Printer\r\nArticle ID: Q96795: Copyright 1993 Microsoft Corporation. All rights reserved.","Code":"PCL_Escape$ = Chr$(27) + RevLandScape ' HP/PCL Reverse Landscape\r\nPCL_Escape$ = Chr$(27) + Portrait ' HP/PCL Portrait \r\nPCL_Escape$ = Chr$(27) + ManualFeed ' HP/PCL Manual Feed Envelope\r\nPCL_Escape$ = Chr$(27) + AutoFeed ' HP/PCL Paper Tray Auto Feed\r\nPCL_Escape$ = Chr$(Len(PCL_Escape$) MOD 256) + Chr$(Len(PCL_Escape$) \\ 256) + PCL_Escape$\r\nPrinter.Print \"\"\r\nResult% = Escape%(Printer.hDC, PASSTHROUGH, 0, PCL_Escape$, 0&)\r\nSelect Case Result%\r\n      Case Is < 0: MsgBox \"The PASSTHROUGH Escape is not supported by this printer driver.\", 48\r\n      Case 0: MsgBox \"An error occurred sending the escape sequence.\", 48\r\n      Case Is > 0: MsgBox \"Escape Successfully sent. Sending test printout to printer.\"\r\n      Printer.Print \"Test case of \"; List1.Text\r\n      Printer.EndDoc\r\nEnd Select\r\n","Declares":"' NOTES:\r\n'The Windows API Escape() function is provided in Windows versions 3.0 and 3.1 for backward compatibility with earlier ''versions of Microsoft Windows.  Applications are supposed to use the GDI DeviceCapabilities() and ExtDeviceMode() 'functions instead of the Escape() function, but neither DeviceCapabilities() nor ExtDeviceMode() can be called directly from 'Visual Basic. This is because they are exported by the printer driver, not by the Windows GDI. The only way to use  'ExtDeviceMode() or DeviceCapabilities() in Visual Basic is to create a DLL and call them from there.\r\n\r\n'There have been reports of problems using the PASSTHROUGH escape with the driver HPPCL5A.DRV. This is the version 'of the printer driver for the HP LaserJet III series that shipped with Windows 3.1. A more recent version of the driver '(HPPCL5MS.DRV), which has no known problems with the PASSTHROUGH escape, is available in the Windows Driver 'Library (WDL). To obtain the latest driver for the HP LaserJet III series, download the self-extracting file HPPCL5.EXE from 'the WDL. \r\n'If the printer driver does not support the PASSTHROUGH printer escape, you must use the DeviceCapabilities() and ExtDevMode() functions instead.\r\n \r\nDeclare Function Escape Lib \"Gdi\" (ByVal Hdc%, ByVal nEscape%,  ByVal ncount%, ByVal indata$, ByVal oudata as Any) As Integer\r\nConst PASSTHROUGH = 19\r\nConst RevLandScape = \"&l3O\" ' PCL command to change Paper orientation to Reverse Landscape.\r\nConst Portrait = \"&l0O\"     ' PCL command to change paper  orientation to Portrait.\r\nConst ManualFeed = \"&l3H\"   ' PCL command to change Paper Bin  to Manual Feed Envelope.\r\nConst AutoFeed = \"&l1H\"     ' PCL command to change Paper Bin  to Paper Tray AutoFeed\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Printer Control Codes","Printer Passthrough","Printing"]},{"RecordId":"230","Title":"File Search (with overlap)","Description":"Searches a file for a string.  Performs overlap in the event that the string spans two blocks.","Code":"Function lInFile (szFileName As String, szSearch As stirng, ErrNum As Integer) As Long\r\n\r\n'This function searches a file for a string.  It performs overlapping in the\r\n'event that the string spans two reads.\r\n\r\nConst lBlockSize = 30000&\r\nDim szBuffer As String\r\nDim nNumBlocks As Integer\r\nDim nRemainder As Integer\r\nDim nIndex As Integer\r\nDim nLenSearch As ineger\r\nDim nHitPos As Integer\r\nDim nFileNum As Integer\r\n\r\n'Open file\r\nnLenSearch = Len(szSearch)\r\nnFileNum = FreeFile\r\nOn Error Resume Next\r\nOpen szFileName For Binary As nFileNum\r\nIf Err Then\r\n    ErrNum = Err\r\n    GoTo BailOuttaHere\r\nElse\r\n    If LOF(nFileNum) = 0 Then\r\n        ErrNum = 52\r\n        GoTo BailOuttaHere\r\n    End If\r\n    On Error GoTo 0\r\nEnd If\r\n\r\n'Get number of blocks\r\nnNumBlocks = LOF(nFileNum) \\ lBlockSize\r\nnRemainder = LOF(nFileNum) Mod lBlockSize\r\n\r\n'Read file and overlap based on number of bytes being searched for\r\nFor nIndex = 1 To nNumBlocks\r\n    If nIndex = 1 Then       'First pass\r\n        szBuffer = Space$(lBlockSize)\r\n        Get #nFileNum, , szBuffer\r\n    Else                     'Any pass other than first\r\n        szBuffer = Space$(lBlockSize + nLenSearch)\r\n        Get #nFileNum, (Loc(nFileNum) + 1) - nLenSearch, szBuffer\r\n    End If\r\n\r\n    'Search buffer for string\r\n    nHitPos = InStr(szBuffer, szSearch)\r\n\r\n    'Found it...\r\n    If nHitPos Then\r\n        lInFile = (lBlockSize * (nIndex - 1)) + nHitPos\r\n        GoTo BailOuttaHere\r\n    End If\r\n\r\nNext nIndex\r\n\r\n'Data left over in file\r\nIf nRemainder Then\r\n    \r\n    szBuffer = Space$(lBlockSize)\r\n    If lNumBlocks = 0 Then\r\n        Get #nFileNum, , szBuffer\r\n    Else\r\n        Get #nFileNum, (Loc(nFileNum) + 1) - nLenSearch, szBuffer\r\n    End If\r\n    \r\n    'Search buffer for string\r\n    nHitPos = InStr(szBuffer, szSearch)\r\n\r\n    'Found it...\r\n    If nHitPos Then\r\n        lInFile = (lBlockSize * nNumBlocks) + nHitPos\r\n    End If\r\nEnd If\r\n\r\nBailOuttaHere:\r\nIf LOF(nFileNum) Then\r\n    Close nFileNum\r\nEnd If\r\n\r\nEnd Function\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["File I/O","File Search","Read File"]},{"RecordId":"231","Title":"Determine How Long SQL Server Has Been Running","Description":"Programmatically determine how long SQL Server has been up.","Code":"Q. I'm looking for a programmatic way to find out how long SQL Server \r\nhas been running. However, I need to be able to get the answer from a \r\nTransact-SQL (T-SQL) script.\r\n\r\nA: You can easily get this information from the sysprocesses table, a \r\ntable in the master database that contains information about processes \r\nrunning on the server. The cool thing about sysprocesses is that it's \r\nnot like an ordinary table because it doesn't have permanent disk \r\nstorage associated with it. SQL Server builds the sysprocesses table \r\ndynamically whenever a user queries it, and you can't update it. \r\nHowever, it contains all sorts of information that's helpful for \r\nperformance tuning and doing SQL tricks.\r\n  You can figure out how long SQL Server has been running by checking \r\nthe login_time column for any of the four system processes \r\n(CHECKPOINT, Mirror Handler, Lazy Writer, and RA Manager) that SQL \r\nServer uses to help manage certain tasks. These processes run \r\ncontinuously, so you can use the login_time for any of these processes \r\nto check the time that the server started. For example, you can use \r\nthe following command:\r\n\r\nSELECT login_time FROM master..sysprocesses WHERE spid = 1\r\n","Declares":"","CodeCategory":{"CategoryId":"6","CategoryDescription":"T-SQL"},"Keywords":["SQL Server"]},{"RecordId":"232","Title":"Status Bar Display (in Status Panel)","Description":"You can't normally place a progress bar in a status panel.  You can, however, copy the image of a picture box into the picture property of a status bar panel.","Code":"'---------------------------------------\r\n'  Put in form load event\r\n'---------------------------------------\r\nDim i As Integer\r\n\r\nPicture1.AutoRedraw = True\r\nPicture1.DrawMode = 10\r\nPicture1.FillStyle = 0\r\nPicture1.ForeColor = vbHighlight\r\nPicture1.BackColor = vb3DFace\r\nPicture1.BorderStyle = 0\r\nPicture1.Font = StatusBar1.Font\r\n\r\nStatusBar1.Panels(1).Text = \"\"\r\n\r\nPicture1.Width = StatusBar1.Panels(1).Width - Screen.TwipsPerPixelX * 4\r\nPicture1.Height = StatusBar1.Height - Screen.TwipsPerPixelY * 4\r\n\r\nFor i = 0 To 100\r\n    UpdateStatus Picture1, i\r\n    StatusBar1.Panels(1).Picture = Picture1.Image\r\n    StatusBar1.Refresh\r\nNext\r\n\r\n'---------------------------------------\r\n'  This is the status bar paint routine\r\n'---------------------------------------\r\nSub UpdateStatus(picStatus As PictureBox, pctValue As Integer)\r\n\r\n    Dim pct As String\r\n\r\n    pct = Format$(pctValue) & \"%\"\r\n    picStatus.Cls\r\n    picStatus.CurrentX = (picStatus.ScaleWidth - picStatus.TextWidth(pct$)) \\ 2\r\n    picStatus.CurrentY = (picStatus.ScaleHeight - picStatus.TextHeight(pct$)) \\ 2\r\n    picStatus.Print pct\r\n    picStatus.Line (Screen.TwipsPerPixelX * 4, Screen.TwipsPerPixelY * 4)-(pctValue * picStatus.ScaleWidth / 100, picStatus.ScaleHeight - Screen.TwipsPerPixelY * 4), picStatus.ForeColor, BF\r\n    DoEvents\r\n\r\nEnd Sub\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Progress Bar","Status Bar"]},{"RecordId":"233","Title":"Form - UNMOVEABLE","Description":"Makes a form unmoveable","Code":"'Place the following code in the form load event\r\nDim hw As Integer\r\nhw = Me.hWnd\r\n\r\nMsgBlaster1.hWndTarget = hw\r\nMsgBlaster1.MsgList(0) = WM_MOVE\r\n\r\n'Place the following code in the Message Blaster Message event\r\nIf MsgVal = WM_MOVE Then\r\n    make message blaster EAT the message\r\nEnd If","Declares":"Const WM_MOVE = &H3","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Form Unmoveable","Lock Form","MsgBlaster"]},{"RecordId":"234","Title":"MAPI Samples","Description":"Demonstrates how to create an email message to multiple recipients and attachments.","Code":"'-------------------------------\r\n'This sample code uses the main SendEMail procedure to create and send an email message.\r\n'\r\n'There are 2 supporting procedures included:\r\n'\r\n'  DefaultExchangeProfile - Retrieves default exchange profile from the registry\r\n'  BuildRecipientArray - Takes a semicolon delimited string (\"abc;def;ghi\") and returns an array with each item\r\n'                        occupying an array element.  This is the recipient list.\r\n'\r\n'-------------------------------\r\n\r\nPublic Sub SendEMail()\r\n\r\n    Dim oMAPISession As Object\r\n    Dim oMAPIObject As Object\r\n    Dim oMAPIRecipient As Object\r\n    Dim oMAPIAttachment As Object\r\n    Dim varRecipientArray As Variant\r\n    Dim varRecipient As Variant\r\n    Dim intRecipientCount As Integer\r\n\r\n    On Error GoTo MAPIError\r\n    \r\n    If mstrMessageText <> \"\" Then\r\n    \r\n        \r\n        'Connect to MAPI\r\n        \r\n        Set oMAPISession = CreateObject(\"MAPI.Session\")\r\n        oMAPISession.Logon DefaultExchangeProfile()\r\n\r\n        \r\n        'Create message\r\n        \r\n        Set oMAPIObject = oMAPISession.Outbox.Messages.Add\r\n        oMAPIObject.Text = mstrMessageText\r\n        oMAPIObject.subject = mstrSubjectLine\r\n\r\n\r\n        'Insert message attachment (DOC)\r\n        \r\n        Set oMAPIAttachment = oMAPIObject.Attachments.Add\r\n        oMAPIAttachment.Type = mapiFileData\r\n        oMAPIAttachment.Name = strReportNameIn & \".doc\"\r\n        oMAPIAttachment.ReadFromFile WordSaveAsFileName(strReportFileNameIn)\r\n\r\n\r\n        'Create recipient list\r\n        \r\n        varRecipientArray = BuildRecipientArray(mstrRecipientList)\r\n        \r\n        For Each varRecipient In varRecipientArray\r\n            If varRecipient <> \"\" Then\r\n                intRecipientCount = intRecipientCount + 1\r\n                Set oMAPIRecipient = oMAPIObject.Recipients.Add\r\n                oMAPIRecipient.Name = varRecipient\r\n                oMAPIRecipient.Resolve False\r\n            End If\r\n        Next\r\n\r\n        \r\n        'Send mail\r\n        \r\n        oMAPIObject.Send showdialog:=False\r\n\r\n        \r\n        'Shut down\r\n        \r\n        Set oMAPIRecipient = Nothing\r\n        Set oMAPIObject = Nothing\r\n        \r\n        oMAPISession.Logoff\r\n        Set oMAPISession = Nothing\r\nEnd If\r\n \r\nExit Sub\r\n\r\nMAPIError:\r\nIf Err.Number < 0 Then\r\n    oMAPIObject.Recipients.Item(intRecipientCount).Delete\r\n    intRecipientCount = intRecipientCount - 1\r\n    Resume Next\r\nEnd If\r\n\r\nEnd Sub\r\n\r\n'----------------------\r\n\r\nPrivate Function DefaultExchangeProfile() As String\r\n\r\n    Dim lngResult As Long\r\n    Dim lngCch As Long\r\n    Dim lngType As Long\r\n    Dim strReturnString As String\r\n    Dim lngReturnValue As Long\r\n    Dim lngKey As Long\r\n\r\n    DefaultExchangeProfile = \"\"\r\n    strReturnString = \"\"\r\n\r\n    'NT Users\t\r\n    lngResult = RegOpenKey(HKEY_CURRENT_USER, \"Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows Messaging Subsystem\\Profiles\", lngKey) 'Retrieve a string/numeric value\r\n\r\n    'Win95 Users\r\n    lngResult = RegOpenKey(HKEY_CURRENT_USER, \"Software\\Microsoft\\Windows Messaging Subsystem\\Profiles\", lngKey) 'Retrieve a string/numeric value\r\n\r\n    If lngResult = 0 Then\r\n\r\n        lngResult = RegQueryValueExNULL(lngKey, \"DefaultProfile\", 0&, lngType, 0&, lngCch)\r\n        Select Case lngType\r\n                'Strings\r\n            Case REG_SZ:\r\n                strReturnString = String(lngCch, 0)\r\n                lngResult = RegQueryValueEx(lngKey, \"DefaultProfile\", 0&, lngType, ByVal strReturnString, lngCch)\r\n                If lngResult = 0 Then\r\n                    strReturnString = Left$(strReturnString, lngCch - 1)\r\n                Else\r\n                    strReturnString = \"\"\r\n                End If\r\n                'DWORDS\r\n            Case REG_DWORD:\r\n                lngResult = RegQueryValueEx(lngKey, \"My Entry\", 0&, lngType, lngReturnValue, lngCch)\r\n                If lngResult <> 0 Then\r\n                    lngReturnValue = 0\r\n                End If\r\n            Case Else\r\n                'all other data types not supported\r\n        End Select\r\n    End If\r\n\r\n    lngResult = RegCloseKey(lngKey)\r\n\r\n    DefaultExchangeProfile = strReturnString\r\n\r\n\r\nEnd Function\r\n\r\n'-------------------------------------\r\n\r\nPrivate Function BuildRecipientArray(strRecipientListIn As String) As Variant\r\n\r\nDim strTempString As String\r\nDim strTempWord As String\r\nDim intOffset As Integer\r\nDim intStringLength As Integer\r\nDim intCount As Integer\r\nDim intStart As Integer\r\nDim strWordArray(1 To 20) As String\r\n\r\nintCount = 1\r\nintStart = 1\r\nintOffset = 1\r\n\r\nstrTempString = Trim$(strRecipientListIn) & \";\"\r\nintStringLength = Len(strTempString)\r\n\r\nDo While intOffset <= intStringLength\r\n    intOffset = InStr(intOffset, strTempString, \";\")\r\n    strTempWord = Mid$(strTempString, intStart, intOffset - intStart)\r\n    \r\n    strWordArray(intCount) = Trim$(strTempWord)\r\n    intCount = intCount + 1\r\n    \r\n    intStart = intOffset + 1\r\n    intOffset = intOffset + 1\r\nLoop\r\n\r\nBuildRecipientArray = CVar(strWordArray)\r\n\r\nEnd Function","Declares":"Const HKEY_CURRENT_USER = &H80000001\r\nConst REG_SZ = 1\r\nConst REG_DWORD = 4\r\n\r\nDeclare Function RegQueryValueEx Lib \"advapi32.dll\" Alias \"RegQueryValueExA\" (ByVal hKey As Long, ByVal lpValueName As String, ByVal lpReserved As Long, lpType As Long, lpData As Any, lpcbData As Long) As Long         ' Note that if you declare the lpData parameter as String, you must pass it By Value.\r\nDeclare Function RegCloseKey Lib \"advapi32.dll\" (ByVal hKey As Long) As Long\r\nDeclare Function RegOpenKey Lib \"advapi32.dll\" Alias \"RegOpenKeyA\" (ByVal hKey As Long, ByVal lpSubKey As String, phkResult As Long) As Long\r\nDeclare Function RegQueryValueExNULL Lib \"advapi32.dll\" Alias \"RegQueryValueExA\" (ByVal hKey As Long, ByVal lpValueName As String, ByVal lpReserved As Long, lpType As Long, ByVal lpData As Long, lpcbData As Long) As Long\r\n\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["MAPI","EMail"]},{"RecordId":"235","Title":"Rotate an Image Around the Center of a Form","Description":"Rotates an image around the center of a form (or any object)","Code":"Private Direction As Long\r\nPrivate Xo As Long\r\nPrivate Yo As Long\r\n'----------------------------------------------------------------\r\nPrivate Sub Command1_Click()\r\n\r\n' Reverse the direction of rotation\r\nIf Direction = 1 Then\r\n    Direction = 359 'Counter-clockwise\r\nElse\r\n    Direction = 1   'Clockwise\r\nEnd If\r\n\r\nEnd Sub\r\n'----------------------------------------------------------------\r\nPrivate Sub Form_Load()\r\n\r\nDirection = 1\r\n\r\nEnd Sub\r\n'----------------------------------------------------------------\r\nPrivate Sub Form_Resize()\r\n\r\nXo = Me.ScaleWidth \\ 2\r\nYo = Me.ScaleHeight \\ 2\r\n\r\nEnd Sub\r\n'----------------------------------------------------------------\r\nPrivate Sub Timer1_Timer()\r\n\r\nDim i As Byte\r\nDim r As Single\r\nDim Pi As Single\r\nDim theta As Single\r\nDim plotx As Integer\r\nDim ploty As Integer\r\nDim dx As Integer\r\nDim dy As Integer\r\n\r\n\r\n' Get form center point\r\nXo = Form1.Width / 2\r\nYo = Form1.Height / 2\r\nPi = 4 * Atn(1)\r\n\r\n\r\n' Get image1 distance from center point\r\ndx = Image1.Left - Xo\r\ndy = Image1.Top - Yo\r\n\r\n' Get angle about center\r\ntheta = Atn(dy / dx)\r\n\r\n' Get distance from center\r\nr = dx / Cos(theta)\r\n\r\nplotx = r * Cos(theta + Direction * Pi / 180) + Xo\r\nploty = r * Sin(theta + Direction * Pi / 180) + Yo\r\n\r\nImage1.Left = plotx\r\nImage1.Top = ploty\r\n\r\nEnd Sub\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Image Rotate","Rotate Image"]},{"RecordId":"236","Title":"Cursor - Make A New One","Description":"Make a new CURSOR?","Code":"Sub Change_Click ()\r\n\r\nReDim ANDbitPlane%(63), ORbitPlane%(63)  'make some space\r\n'experiment with twiddling these between &H0 and &HFFFF.\r\nFor C% = 0 To 63\r\n  ANDbtPlane%(C%) = &H3F  'set up for sample\r\n  XORbitPlane%(C%) = &HFF ' dittoNext\r\nNext\r\n\r\nnWidth% = 32            'cursor width\r\nnHeight% = 32          'cursor height\r\nhInstance% = GetModuleHandle%(\"VB.EXE\")      'get our Instance\r\nhCursor% = CreateCursor%(hInstance%, 0, 0, nWidth%, Height%, \r\n  ANDbitPlane%(0), XORbitPlane%(0))'create the cursor\r\nhOldursor% = GetClassWord%(Form1.hWnd, -12)  'save the old one\r\nX% =SetClassWord%(Form1.hWnd, -12, hCursor%) 'set our test one\r\n\r\nEnd Sub\r\n\r\nSub Restore_Click ()\r\nX% = SetClassWord%(Form1.hWnd, -12, hOldCursr%)  'put old cursor back\r\nDummy% = DeleteObject(hCursor%)                  'delete the cursor created\r\nEnd Sub\r\n","Declares":"'API's required\r\nDeclare Function CreateCursor% Lib \"User\" (ByVal hInstance%, ByVal nXhotspot%, ByVal nYhotspt%, ByVal nWidth%, ByVal nHeight%, lpANDbitPlane%, lpXORbitPlane%\r\n\r\nDeclare Function SetClassWord% Lib \"User\" (ByVal hWnd%, ByVal Index%, ByVal wNewWord%)\r\nDeclare Function GetClassWord% Lib \"Usr\" (ByVal hWnd%, ByVal nIndex%)\r\nDeclare Function DeleteObject% Lb \"GDI\" (ByVal hObject%)\r\nDeclare Function GetModuleHandle% Lib \"ernel\" (ByVal lpModuleName$)\r\nDeclare Function SetCursor% Lib \"User (ByVal hCursor%)\r\n\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Cursor"]},{"RecordId":"240","Title":"Change Text Box Pop-up Menu","Description":"Change Text Box Pop-up Menu","Code":"In Windows 95, right-clicking any text box brings up a context menu with basic edit commands on it. If you want to change this menu, put the following code in the MouseDown event of the text box. \r\n\r\nIf Button = vbRightButton Then\r\nText1.Enabled = False\r\nText1.Enabled = True\r\nText1.SetFocus\r\nPopUpMenu Menu1\r\nEnd If\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Text Box","Pop-up menu"]},{"RecordId":"241","Title":"Send eMail Via Outlook","Description":"Uses Outlook to send email from a VB app","Code":"Dim oOutlook As Object\r\nDim oItem As Object\r\n\r\nSet oOutlook = CreateObject(\"Outlook.Application\")\r\nSet oItem = oOutlook.createitem(0)\r\n\r\nWith oItem\r\n    .Subject = \"TEST\"\r\n    .To = \"gamblejt\"\r\n    .Body = \"This is a test\"\r\n    .Send\r\nEnd With\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["MAPI","Outlook","EMail"]},{"RecordId":"242","Title":"Drag_Drop - Print or run a file","Description":"Subroutine to receive a file from drag/drop operation and print to print manager if association exists in File Manager.","Code":"Call Receive_File(\"c:\\winword\\docs\\audio_ad.doc\", \"print\")\r\nCall Receive_File(\"c:\\winword\\docs\\audio_ad.doc\", \"open\")\r\n\r\nSub Receive_File (FileName As String, Action As String)\r\n\r\n'Call this code from the Drop_Drag event of the picture that the file is\r\n'being dropped into.\r\n\r\nDim hInst As Integer\r\n\r\nIf Action = \"open\" Then\r\n    'Open & run the file if association exists in File Manager\r\n    hInst = ShellExecute(Me.hWnd, \"open\", FileName, 0&, CurDir$, SH_SHOWNA)\r\nElse\r\n    'Automatically fires up Print Manager if association exists in File Manager\r\n    If Action = \"print\" Then\r\n        hInst = ShellExecute(Me.hWnd, \"print\", FileName, 0&, CurDir$, SH_SHOWNA)\r\n    End If\r\nEnd If\r\n\r\nEnd Sub\r\n","Declares":"Declare Function ShellExecute% Lib \"shell.dll\" (ByVal hWnd%, ByVal lpszOp$, ByVal lpszFile$, ByVal spszParams As Any, ByVal lpszDir$, ByVal fsShowCmd%) \r\n\r\nConst SH_SHOWNA = 8","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Drag/Drop","Print from Drag/Drop"]},{"RecordId":"245","Title":"Copy File (Win95 Explorer-like)","Description":"Copies, moves, etc. files using the Win95 Explorer floating folder, progress bar interface.","Code":"' NOTE:  The SHFileOperation API accepts wildcards such as *.txt and can copy multiple files\r\n' to the same directory at once using chr$(0) as a separator between file names.\r\n\r\nPublic Sub CopyFiles()\r\n    \r\n    FileOp.hwnd = 0\r\n    FileOp.wFunc = FO_COPY\r\n    FileOp.pFrom = \"c:\\temp1\\*.*\" & Chr$(0)\r\n    FileOp.pTo = \"c:\\temp2\" & Chr$(0)\r\n    FileOp.fFlags = FOF_ALLOWUNDO Or FOF_NOCONFIRMATION\r\n    \r\n    If SHFileOperation(FileOp) <> 0 Then\r\n        MsgBox \"SHFileOperation was not successful\"\r\n    End If\r\n     \r\nEnd Sub\r\n","Declares":"Private Type SHFILEOPSTRUCT\r\n    hwnd As Long\r\n    wFunc As Long\r\n    pFrom As String\r\n    pTo As String\r\n    fFlags As Integer\r\n    fAnyOperationsAborted As Boolean\r\n    hNameMappings As Long\r\n    lpszProgressTitle As String\r\nEnd Type\r\n\r\nPrivate Declare Function SHFileOperation Lib \"shell32.dll\" Alias \"SHFileOperationA\" (lpFileOp As SHFILEOPSTRUCT) As Long\r\n\r\nPrivate Const FO_MOVE = 1\r\nPrivate Const FO_COPY = 2\r\nPrivate Const FO_DELETE = 3\r\nPrivate Const FO_RENAME = 4\r\n\r\nConst FOF_MULTIDESTFILES = &H1\r\nConst FOF_SILENT = &H4\r\nConst FOF_RENAMEONCOLLISION = &H8\r\nConst FOF_NOCONFIRMATION = &H10\r\nConst FOF_WANTMAPPINGHANDLE = &H20\r\nConst FOF_ALLOWUNDO = &H40\r\nConst FOF_FILESONLY = &H80\r\nConst FOF_SIMPLEPROGRESS = &H100\r\nConst FOF_NOCONFIRMMDIR = &H200\r\n\r\nPrivate FileOp As SHFILEOPSTRUCT\r\n\r\n\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Copy File","Win95 Copy File"]},{"RecordId":"246","Title":"Clear the Swap File When NT Shuts Down","Description":"Clears the NT Swap File when NT shuts down.","Code":"CLEAR SYSTEM PAGEFILE AT SHUTDOWN\r\n\r\nA few of the publicly available attacks on Windows NT security rely on the fact that the NT pagefile is left intact on shutdown, and can subsequently be scanned for useful information. \r\n\r\nTo clear the pagefile at shutdown, add the REG_DWORD value HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Memory Management\\ClearPageFileAtShutdown value and set it to 1. This value causes NT to clear the pagefile when it shuts down. \r\n\r\nRemember to back up your Registry before making any manual changes. After you are satisfied that your Registry changes have done what you wanted them to, update your Emergency Repair disk.\r\n","Declares":"","CodeCategory":{"CategoryId":"7","CategoryDescription":"Misc"},"Keywords":["PageFile","Swap File"]},{"RecordId":"247","Title":"Wait for Shell Completion","Description":"Wait for Shelled program to complete execution","Code":"x% = Shell(\"NOTEPAD.EXE\")       ' Modify the path as necessary.\r\n\r\nWhile GetModuleUsage(x%) > 0    ' Has Shelled program finished?\r\n         z% = DoEvents()              ' If not, yield to Windows.\r\nWend\r\n","Declares":"Declare Function GetModuleUsage% Lib \"Kernel\" (ByVal hModule%)","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Wait","Shell"]},{"RecordId":"248","Title":"Sort ListView list control","Description":"Sorts a listview control (like Win95 explorer) when user clicks on column headers.  If listview is currently sorted by clicked column, sort order is reversed (just like Windows Explorer)","Code":"Sub ListView1_ColumnClick(ByVal ColumnHeader As ColumnHeader)\r\n\r\n    With ListView1\r\n        If (ColumnHeader.Index - 1) = .SortKey Then\r\n            .Sortorder = (.Sortorder + 1) Mod 2\r\n        Else\r\n            .Sorted = False\r\n            .Sortorder = 0\r\n            .SortKey = ColumnHeader.Index - 1\r\n            .Sorted = True\r\n        End If\r\n    End With\r\n            \r\nEnd Sub\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["ListView","Sort ListView"]},{"RecordId":"249","Title":"Day of Week (Compensates for 9/2/1752 - 9/14/1752)","Description":"Dates between September 2, 1752 and September 14, 1752 were dropped when converting from Julian to Gregorian calendar.  Access and VB don't correctly handle that fact when computing the day of the week.","Code":"More info is available at www.astro.virginia.edu/~eww6n/astro/GregorianCalendar.html.\r\n\r\nPublic Function DayOfWeek(InDate As Variant) As String\r\n\r\nDim DayName As String * 10\r\n\r\nSelect Case InDate\r\n    \r\n    Case Is > #9/13/1752#\r\n        DayName = Format$(InDate, \"dddd\")\r\n    Case #9/3/1752# To #9/13/1752#\r\n        DayName = \"See Notes\"\r\n    Case Is > #2/28/1700#\r\n        DayName = Format$(DateAdd(\"d\", 11, InDate), \"dddd\")\r\n    Case Is > #2/28/1500#\r\n        DayName = Format$(DateAdd(\"d\", 10, InDate), \"dddd\")\r\n    Case Else\r\n        DayName = \"Beyond scope\"\r\n\r\nEnd Select\r\n    \r\nEnd Function\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Dates","Day of Week","Weekday"]},{"RecordId":"250","Title":"Saving & Retrieving Information to a Property Bag","Description":"Demonstrates how to save information to and retrieve information from a property bag.","Code":"' Convert two discrete values into a property bag persisted stream\r\nDim strPersistedStream As String\r\nstrPersistedStream = SavePBData(\"ABC\", \"69\")\r\n\r\n' Retrieve two discrete values from a property bag persisted stream\r\n' Note: strPersistedStream would have been previously populated using the SavePBData function.\r\nDim strValue1 As String\r\nDim strValue2 As String\r\nGetPBData strPersistedStream, strValue1, strValue2\r\n\r\n'------------------------------------------------------------------------------------------------------------------------------------\r\nPublic Function SavePBData(ByVal strP1 As String, ByVal strP2 As String) As String\r\n\r\n    ' Persists two descrete values into a property bag's contents data stream\r\n    \r\n    Dim pb As PropertyBag\r\n    \r\n    Set pb = New PropertyBag\r\n    \r\n    pb.WriteProperty \"Property1\", strP1\r\n    pb.WriteProperty \"Property2\", strP2\r\n    \r\n    SavePBData = pb.Contents\r\n    \r\n    Set pb = Nothing\r\n\r\nEnd Function\r\n\r\n'------------------------------------------------------------------------------------------------------------------------------------\r\nPublic Sub GetPBData(ByVal strPBData As String, ByRef strP1 As String, ByVal strP2 As String)\r\n\r\n    ' Takes a persisted property bag's contents and separates it back into discrete values\r\n\r\n    Dim pb As PropertyBag\r\n    Dim bytData() As Byte\r\n    \r\n    Set pb = New PropertyBag\r\n    \r\n    bytData = strPBData\r\n    pb.Contents = bytData\r\n    \r\n    strP1 = pb.ReadProperty(\"Property1\")\r\n    strP2 = pb.ReadProperty(\"Property2\")\r\n    \r\n    Set pb = Nothing\r\n\r\nEnd Sub\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Property Bag"]},{"RecordId":"252","Title":"Drag/Drop Item Into ListBox","Description":"Inserts item into a list box at dropped position (Uses SendMessage API to determine top displayed item in the box)","Code":"Sub List1_DragDrop (Source As Control, X As Single, Y As Single)\r\n\r\nDim iTop As Long\r\nDim iItemHeight As Integer\r\nDim iInsertPos As Long\r\n\r\niTop = SendMessage(List1.hWnd, LB_GETTOPINDEX, 0&, 0&)\r\n\r\niItemHeight = TextHeight(\"A \")\r\niInsertPos = Y \\ iItemHeight\r\n\r\nIf iInsertPos <= List1.ListCount Then\r\n    List1.AddItem \"my item added here\", iInsertPos + iTop\r\nElse\r\n    List1.AddItem \"My item added here\"\r\nEnd If\r\n\r\nEnd Sub\r\n","Declares":"Declare Function SendMessage Lib \"User\" (ByVal hWnd As Integer, ByVal wMsg As Integer, ByVal wParam As Integer, lParam As Any) As Long\r\n\r\nConst LB_GETTOPINDEX = &H400 + 15\r\n\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Drag/Drop","List Box Drag/Drop"]},{"RecordId":"253","Title":"Binary Search","Description":"Binary Search algorithm","Code":"Public Function BinarySearch(list() As Long, ByVal target As Long) As Long\r\n\r\n    Dim middle As Long\r\n    Dim min As Long\r\n    Dim max As Long\r\n\r\n    min = LBound(list)\r\n    max = UBound(list)\r\n\r\n    ' During the search, min <= target index <= max.\r\n    Do While min <= max\r\n        middle = (min + max) \\ 2\r\n        If target = list(middle) Then\r\n            ' We found it.\r\n            BinarySearch = middle\r\n            Exit Function\r\n        ElseIf target < list(middle) Then\r\n            ' Search the left half.\r\n            max = middle - 1\r\n        Else\r\n            ' Search the right half.\r\n            min = middle + 1\r\n        End If\r\n    Loop\r\n\r\n    BinarySearch = 0\r\n\r\nEnd Function\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Search","Binary Search"]},{"RecordId":"254","Title":"Print Bitmaps From VB","Description":"Add a picture box to your form and put your image in it.\r\n","Code":"'In your print procedure use some code like this:\r\n'Declare local variables.\r\nDim hMemoryDC%\r\nDim hOldBitMap%\r\nDim ApiError%\r\nDim Result%\r\n \r\nConst SRCCOPY = &HCC0020\r\nConst NEWFRAME = 1\r\nConst PIXEL = 3\r\n \r\n'go to the position for the bitmap( in this case I have set ScaleMode to inches)\r\nPrinter.CurrentX = .2\r\nPrinter.CurrentY = .2\r\n'\r\n'* StretchBlt requires pixel coordinates.\r\nPicture1.Picture = Picture1.Image\r\nPicture1.ScaleMode = PIXEL\r\nPrinter.ScaleMode = PIXEL\r\nhMemoryDC% = CreateCompatibleDC(pfrm.Picture1.hDC)\r\nhOldBitMap% = SelectObject(hMemoryDC%, pfrm.Picture1.Picture)\r\n'Enter the following three lines as one, single line:\r\nApiError% = StretchBlt(Printer.hDC, Printer.CurrentX, Printer.CurrentY,\r\nPicture1.ScaleWidth * 2, Picture1.ScaleHeight * 2, hMemoryDC%, 0, 0,\r\nPicture1.ScaleWidth, Picture1.ScaleHeight, SRCCOPY)\r\nhOldBitMap% = SelectObject(hMemoryDC%, hOldBitMap%)\r\nApiError% = DeleteDC(hMemoryDC%)\r\n'\r\nPrinter.EndDoc\r\n'\r\nResult% = Escape(Printer.hDC, NEWFRAME, 0, 0&, 0&)\r\n","Declares":"'api functions to print an image\r\nDeclare Function CreateCompatibleDC% Lib \"GDI\" (ByVal hDC%)\r\nDeclare Function SelectObject% Lib \"GDI\" (ByVal hDC%, ByVal hObject%)\r\nDeclare Function StretchBlt% Lib \"GDI\" (ByVal hDC%, ByVal x%, ByVal Y%, ByVal nWidth%, ByVal nHght%, ByVal hSrcDC%, ByVal XSrc%, ByVal YSrc%, ByVal nSrcWidth%, ByVal nSrcHeight%, ByVal dwRop&)\r\nDeclare Function DeleteDC% Lib \"GDI\" (ByVal hDC%)\r\nDeclare Function Escape% Lib \"GDI\" (ByVal hDC As Integer, ByVal nEscape As Integer, ByVal nCount As Integer, LpInData As Any, LpOutData As Any)\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Printing Bitmaps","Bitmaps"]},{"RecordId":"255","Title":"Add Font to Windows","Description":"Adds font to existing Windows installation","Code":"Function AddFont (FileName As String) As Integer\r\n\r\n    Dim WindowsDir As String\r\n    Dim lBuf As Long\r\n\r\n    lBuff = GetWindowsDirectory(WindowsDir, Len(Buffer))\r\n    If lBuff Then\r\n        WindowsDir = Left$(WindowsDir, lBuf)\r\n        FileCopy FileName, WindowsDir & \"\\Fonts\\\" & FileName\r\n        If AddFontResource(FileName) Then\r\n            SendMessage HWND_BROADCAST, WM_FONTCHANGE, 0, 0\r\n            AddFont = True\r\n        End If\r\n    End If\r\n    \r\nEnd Function\r\n","Declares":"","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Fonts","Installation","Setup"]},{"RecordId":"256","Title":"Time (Display on menu bar)","Description":"Displays the current time on a menu bar","Code":"Sub Timer1_Timer ()\r\n\r\n'Create a menu option named \"mnuTime\"\r\n'Set timer interval to 1000 (1 second)\r\nmnuTime.Caption = Chr$(8) & Format(Now, \"h:nn:ss AM/PM\")\r\n\r\nEnd Sub\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Time","Menu"]},{"RecordId":"257","Title":"3D - CTL3DV2","Description":"Makes msgbox, dialogs, and all controls on form 3D.","Code":"'-------------------------------------------------------\r\n' Put this code in the form load event to register 3D\r\n'-------------------------------------------------------\r\n\r\n    ' Get instance handle of project\r\n    hInstance = GetInstance(Me)\r\n    ' start the 3D functions\r\n    Start3D\r\n    ' show this form as 3D\r\n    Make3D Me\r\n\r\n'-------------------------------------------------------\r\n' Put this code in the exit routines to unregister 3D\r\n'-------------------------------------------------------\r\n    ' stop the 3D functions\r\n    End3D\r\n'-------------------------------------------------------\r\n' Gets the instance of a form\r\n'-------------------------------------------------------\r\nFunction GetInstance (oFrm As Form)\r\n\r\n    ' Get the Instance Handle for this program. It MUST be used in place\r\n    ' of the Module Handle to ensure programs running more than once\r\n    ' will work correctly\r\n    \r\n    GetInstance = GetWindowWord(oFrm.hWnd, GWW_HINSTANCE)\r\n\r\nEnd Function\r\n\r\n'-------------------------------------------------------\r\n' Registers 3D\r\n'-------------------------------------------------------\r\nSub Start3D ()\r\n    \r\n    ' Register with CTL3DV2. You must register with an instance\r\n    ' handle NOT the module handle, you will cause GPF's when\r\n    ' running multiple instances of your program.\r\n    \r\n    Dim iResult As Integer\r\n    ' Register with CTL3DV2\r\n    iResult = Ctl3dRegister(hInstance)\r\n    If iResult Then\r\n        ' Make MSGBoxes and Common dialogs 3D\r\n        iResult = Ctl3dAutoSubclass(hInstance)\r\n    End If\r\nEnd Sub\r\n'-------------------------------------------------------\r\n' Un-Registers 3D\r\n'-------------------------------------------------------\r\nSub End3D ()\r\n\r\n    ' Again we MUST use the instance handle not the\r\n    ' Module handle. See InitCTL3D for details\r\n\r\n    Dim iResult As Integer\r\n    ' Unregister with CTL3D\r\n    iResult = Ctl3dUnregister(hInstance)\r\n\r\nEnd Sub\r\n'-------------------------------------------------------\r\n' Makes all controls on a form 3D\r\n'-------------------------------------------------------\r\nSub Make3D (Frm As Form)\r\n    \r\n    ' Show a ThreeD dialog\r\n    Dim iResult As Integer, iCTRL As Integer\r\n    Dim iType As Integer, bColour As Integer, cLabel As String\r\n    Dim lStyle As Long\r\n    \r\n    If Frm.BorderStyle = 3 Then\r\n        ' Set the Windows style bits to make CTL3D paint\r\n        ' the border as well as the client area\r\n        lStyle = GetWindowLong((Frm.hWnd), GWL_STYLE)\r\n        lStyle = lStyle Or DS_MODALFRAME\r\n        lStyle = SetWindowLong((Frm.hWnd), GWL_STYLE, lStyle)\r\n    End If\r\n    \r\n    Frm.BackColor = BUTTON_FACE\r\n    \r\n    ' Activate CTL3D for this window, since VB doesn't use true\r\n    ' Dialogs you must tell it to do it yourself\r\n    iResult = Ctl3DSubClassDlgEx((Frm.hWnd), 0&)\r\n    \r\n    ' Since VB has already subclassed the controls to 'THUNDER' controls\r\n    ' CTL3D will not touch them. So we must walk through the controls and\r\n    ' tell it what class to subclass them as\r\n    For iCTRL = 0 To Frm.Controls.Count - 1\r\n        ' Start by assuming we won't subclass the control\r\n        iType = DONT_SUBCLASS\r\n        ' Used to store a fake label used in frames\r\n        cLabel = \"\"\r\n        ' and not change it's back color\r\n        bColour = False\r\n        ' Lets find the type of the control\r\n        If TypeOf Frm.Controls(iCTRL) Is OptionButton Then\r\n            ' Colour it and Subclass it as a button\r\n            bColour = True\r\n            iType = CTL3D_BUTTON_CTL\r\n        ElseIf TypeOf Frm.Controls(iCTRL) Is CheckBox Then\r\n            ' Colour it and Subclass it as a button\r\n            bColour = True\r\n            iType = CTL3D_BUTTON_CTL\r\n        ElseIf TypeOf Frm.Controls(iCTRL) Is CommandButton Then\r\n            ' Colour it and Subclass it as a button\r\n            bColour = True\r\n            iType = CTL3D_BUTTON_CTL\r\n        ElseIf TypeOf Frm.Controls(iCTRL) Is ListBox Then\r\n            ' Colour it and Subclass it as a listbox\r\n            bColour = True\r\n            iType = CTL3D_LISTBOX_CTL\r\n        ElseIf TypeOf Frm.Controls(iCTRL) Is FileListBox Then\r\n            ' Colour it and Subclass it as a listbox\r\n            bColour = True\r\n            iType = CTL3D_LISTBOX_CTL\r\n        ElseIf TypeOf Frm.Controls(iCTRL) Is DirListBox Then\r\n            ' Colour it and Subclass it as a listbox\r\n            bColour = True\r\n            iType = CTL3D_LISTBOX_CTL\r\n        ElseIf TypeOf Frm.Controls(iCTRL) Is PictureBox Then\r\n            ' for picture boxes i've decided to only subclass\r\n            ' if there is a border, otherwise I set it's back colour\r\n            ' This gives white 3D pictures or a grey panel which\r\n            ' can be used to group controls such as OptionButtons\r\n            If Frm.Controls(iCTRL).BorderStyle Then\r\n                iType = CTL3D_LISTBOX_CTL\r\n            Else\r\n                bColour = True\r\n            End If\r\n            If Frm.Controls(iCTRL).Tag <> \"\" Then\r\n                cLabel = Frm.Controls(iCTRL).Tag\r\n            End If\r\n        ElseIf TypeOf Frm.Controls(iCTRL) Is TextBox Then\r\n            ' Don't color text boxes but Subclass them as Edit controls\r\n            iType = CTL3D_EDIT_CTL\r\n        ElseIf TypeOf Frm.Controls(iCTRL) Is ComboBox Then\r\n            ' Don't color ComboBoxes but subclass them as COMBO controls\r\n            iType = CTL3D_COMBO_CTL\r\n        ElseIf TypeOf Frm.Controls(iCTRL) Is DriveListBox Then\r\n            ' Don't color DriveListBoxes but subclass them as COMBO controls\r\n            iType = CTL3D_COMBO_CTL\r\n        ElseIf TypeOf Frm.Controls(iCTRL) Is Frame Then\r\n            ' Colour and Subclass them as Buttons controls\r\n            ' Yes, windows calls Frames buttons!\r\n            bColour = True\r\n            iType = CTL3D_BUTTON_CTL\r\n        ElseIf TypeOf Frm.Controls(iCTRL) Is Label Then\r\n            ' Colour but don't subclass a label\r\n            bColour = True\r\n        End If\r\n        ' Set the BackColor as required\r\n        If bColour Then\r\n            Frm.Controls(iCTRL).BackColor = BUTTON_FACE\r\n        End If\r\n        ' Produce a fake label that will survive a 3D Frame\r\n        If cLabel <> \"\" Then\r\n            Frm.Controls(iCTRL).Print cLabel\r\n        End If\r\n        ' Subclass the control as required\r\n        If iType <> DONT_SUBCLASS Then\r\n            ' Pass it the Controls hWnd and type type required\r\n           'iResult = Ctl3dSubclassCtlEx((Frm.Controls(iCTRL).hWnd), iType)\r\n        End If\r\n    Next\r\n    \r\n    ' Display the form, I'm using Modal in this example but it's not required\r\n    Frm.Show 1\r\nEnd Sub\r\n\r\n'-------------------------------------------------------\r\n' Makes radio buttons on a form 3D\r\n'-------------------------------------------------------\r\nSub PaintRadio (obWas As OptionButton, obNew As OptionButton)\r\n    \r\n    ' Call this routine from the MouseUp event of the OptionButton\r\n    ' to ensure you the 3D painting is correct.\r\n    ' Repaint the control being activated\r\n    \r\n    obNew.Refresh\r\n    ' We must do it twice to ensure the focus rect\r\n    ' is painted correctly (It doesn't work with one!)\r\n    obNew.Refresh\r\n    ' If these are two different controls then update\r\n    ' the one that used to be set\r\n    If obWas.hWnd <> obNew.hWnd Then\r\n        ' Only one update is required for this one\r\n        ' since it doesn't have the focus\r\n        obWas.Refresh\r\n    End If\r\nEnd Sub\r\n","Declares":"' CTL3DV2 functions\r\nDeclare Function Ctl3dAutoSubclass Lib \"Ctl3DV2.DLL\" (ByVal hInst As Integer) As Integer\r\nDeclare Function Ctl3dRegister Lib \"Ctl3DV2.DLL\" (ByVal hInst As Integer) As Integer\r\nDeclare Function Ctl3dUnregister Lib \"Ctl3DV2.DLL\" (ByVal hInst As Integer) As Integer\r\nDeclare Function Ctl3DSubClassDlgEx Lib \"Ctl3DV2.DLL\" (ByVal hInst As Integer, ByVal Flags As Long) As Integer\r\nDeclare Function Ctl3dSubclassCtlEx Lib \"Ctl3DV2.DLL\" (ByVal hWnd As Integer, ByVal CntrlType As Integer) As Integer\r\n\r\n' CTL3DV2 constants\r\nGlobal Const CTL3D_BUTTON_CTL = 0\r\nGlobal Const CTL3D_LISTBOX_CTL = 1\r\nGlobal Const CTL3D_EDIT_CTL = 2\r\nGlobal Const CTL3D_COMBO_CTL = 3\r\nGlobal Const CTL3D_STATIC_CTL = 4\r\n\r\n' API routines\r\nDeclare Function GetWindowWord Lib \"User\" (ByVal hWnd As Integer, ByVal nOffset As Integer) As Integer\r\nDeclare Function GetWindowLong Lib \"User\" (ByVal hWnd As Integer, ByVal nIndex As Integer) As Long\r\nDeclare Function SetWindowLong Lib \"User\" (ByVal hWnd As Integer, ByVal nIndex As Integer, ByVal dwNewLong As Long) As Long\r\n\r\n' API Constants\r\nGlobal Const GWW_HINSTANCE = -6\r\nGlobal Const GWL_STYLE = -16\r\n\r\n' Frame types\r\nGlobal Const SS_BLACKFRAME = &H7&\r\nGlobal Const SS_GRAYFRAME = &H8&\r\nGlobal Const SS_WHITEFRAME = &H9&\r\nGlobal Const DS_MODALFRAME = &H80&\r\nGlobal Const WINDOW_BACKGROUND = &H80000005     ' Window background.\r\nGlobal Const BUTTON_FACE = &H8000000F           ' Face shading on command buttons.\r\nGlobal Const BUTTON_SHADOW = &H80000010         ' Edge shading on command buttons.\r\n\r\n'Misc stuff\r\nGlobal Const DONT_SUBCLASS = -1\r\nGlobal hInstance As Integer\r\n\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["3D","CTL3DV2"]},{"RecordId":"258","Title":"DOS Prompt Auto-Complete","Description":"Causes a DOS prompt to \"auto-complete\" the first matching directory enty.","Code":"AUTO-COMPLETING DIRECTORY PATH NAMES \r\n\r\nYou can configure Windows NT to automatically complete long directory path names. Begin by editing your computer's registry (run regedt32.exe). Access the registry key HKEY_CURRENT_USER\\Software\\Microsoft\\Command Prompt. In the pane on the right, double-click on the CompletionChar value. By changing CompletionChar from 0 to 9, you configure Windows NT to automatically complete paths for you in a Command Prompt window.\r\n\r\nTo try out your change, open a Command Prompt window. Type cd p, then press the TAB key. You should see that Windows NT automatically fills in the path for you with the first directory on your hard drive that begins with the letter \"p.\" \r\n","Declares":"","CodeCategory":{"CategoryId":"7","CategoryDescription":"Misc"},"Keywords":["Auto-complete","Auto complete"]},{"RecordId":"259","Title":"Delete File to Recycle Bin","Description":"Delete file to Win95 recycle bin (32 bit)","Code":"Dim lResult As Integer\r\nDim sFileName(3) As String\r\n\r\n'Delete a single file\r\nlResult = ShellDelete(\"c:\\myfile.ext\")\r\n\r\n'Delete array of file names\r\nsFileName(0) = \"c:\\file1.ext\"\r\nsFileName(1) = \"c:\\file2.ext\"\r\nsFileName(2) = \"c:\\file3.ext\"\r\nlResult = ShellDelete(sFileName())\r\n\r\n'Delete multiple files using paramaters\r\nlResult = ShellDelete(\"c:\\file1.ext\", \"c:\\file2.ext\", \"c:\\file3.ext\")\r\n'------------------------------------------------------------------------------------------------\r\nPublic Function ShellDelete(ParamArray vntFileName() As Variant)\r\n    \r\n    Dim I As Integer\r\n    Dim SHFileOp As SHFILEOPSTRUCT\r\n    Dim sFileNames As String\r\n    \r\n    For I = LBound(vntFileName) To UBound(vntFileName)\r\n        sFileNames = sFileNames & vntFileName(I) & vbNullChar\r\n    Next\r\n    \r\n    sFileNames = sFileNames & vbNullChar\r\n\r\n    With SHFileOp\r\n       .wFunc = FO_DELETE\r\n       .pFrom = sFileNames\r\n       .fFlags = FOF_ALLOWUNDO\r\n    End With\r\n    \r\n    ShellDelete = SHFileOperation(SHFileOp)\r\n    \r\nEnd Function\r\n","Declares":"Type SHFILEOPSTRUCT\r\n    hWnd As Long\r\n    wFunc As Long\r\n    pFrom As String\r\n    pTo As String\r\n    fFlags As Integer\r\n    fAborted As Boolean\r\n    hNameMaps As Long\r\n    sProgress As String\r\nEnd Type\r\n\r\nPublic Const FO_DELETE = &H3\r\nPublic Const FOF_ALLOWUNDO = &H40\r\nDeclare Function SHFileOperation Lib \"shell32.dll\" Alias \"SHFileOperationA\" (lpFileOp As SHFILEOPSTRUCT) As Long\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Delete File","Win95 Recycle Bin"]},{"RecordId":"260","Title":"Run Access Report From VB","Description":"Use VB to open and run a report in an Access MDB.","Code":"Dim oAccess As Access.Application\r\n\r\nSet oAccess = New Access.Application\r\noAccess.OpenCurrentDatabase \"c:\\mydb.mdb\", False\r\n\r\noAccess.DoCmd.OpenReport \"Report1\"\r\n\r\noAccess.CloseCurrentDatabase\r\noAccess.Quit\r\n\r\nSet oAccess=Nothing","Declares":"","CodeCategory":{"CategoryId":"3","CategoryDescription":"Database"},"Keywords":["Access","OLE Automation"]},{"RecordId":"261","Title":"ODBC Connect Strings","Description":"ODBC connect strings with and without data source name","Code":"'Sybase with a data source name\r\nstrConnect =  DSN=TedDSN;\r\n                      SRVR=mySybaseServer;\r\n                      DB=myDatabase;\r\n                      UID=gamblejt;PWD=password;\r\n\r\n'Sybase without a data source name\r\nstrConnect =  DRIVER={Sybase System 10};\r\n                      SRVR=mySybaseServer;\r\n                      DB=myDatabase;\r\n                      UID=gamblejt;PWD=password;\r\n\r\n'SQL Server with a data source name:\r\nstrConnect = DSN=TedDSN;\r\n                     UID=gamblejt;PWD=password;\r\n                     DATABASE=mydb;APP=myappname;\r\n\r\n'SQL Server without a data source name\r\nstrConnect = DRIVER={SQL Server};SERVER=mysqlserver;\r\n                     UID=gamblejt;PWD=password;\r\n                     DATABASE=mydb;APP=myappname;\r\n\r\n'Access without a data source name (Preferred)\r\nstrConnect = Driver={Microsoft Access Driver (*.mdb)};\r\n                     Dbq=nwind.mdb;\r\n                     DefaultDir=C:\\program files\\devstudio\\vb;\r\n                     Uid=Admin;Pwd=;\r\n\r\n'Access without a data source name\r\nstrConnect = DRIVER={Microsoft Access Driver (*.mdb)};\r\n                     UID=gamblejt;PWD=password;\r\n                     DATABASE=mydb;APP=myappname;\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"3","CategoryDescription":"Database"},"Keywords":["ODBC","Connect Strings"]},{"RecordId":"262","Title":"Make the My Computer Icon Display Computer/User","Description":"Causes \"My Computer\" to dispay the user name and computer name on the Desktop","Code":"MAKE THE MY COMPUTER ICON SHOW CURRENT USER NAME AND MACHINE NAME \r\n\r\nEach Windows desktop has a My Computer icon. Clicking the icon opens the My Computer folder, displaying available resources such as hard disks, printers, DUN, scheduled tasks and mobile device connections. \r\n\r\nOpen regedt32.exe and navigate to HKEY_CLASSES_ROOT\\CLSID\\ subtree, locate the key named 20D04FE0-3AEA-1069-A2D8-08002B30309D, and follow one of the two instruction sets below, depending on whether you have Windows 2000 or Windows NT 4.0.\r\n    \r\nWindows 2000\r\nSelect and edit LocalizedString. Copy its text contents to a safe location such as Notepad. The contents should be similar to \"@D:\\WINNT\\system32\\shell32.dll,-9216@1033, My Computer,\" without the quotes. Next, delete the LocalizedString value. Create a new value with the same name (LocalizedString) whose type is REG_EXPAND_SZ. Paste the saved text into the text field of the newly created value, but edit the prefix before saving it. Replace the text \"My Computer\" in the string with \"%username% on %computername%,\" without the quotes. For example, a modified string might read @D:\\WINNT\\system32\\shell32.dll,-9216@1033,%username% on %computername%. \r\n\r\nWindows NT 4.0\r\nSelect the <No Name> item in the right pane and delete it. On the Edit menu, click Add Value and leave the Value Name blank. Select a Data Type of REG_EXPAND_SZ, and in the string box enter \"%userName% on %computername%,\" without the quotes. Now close Regedt32 and refresh the desktop to see the new display caption. \r\n","Declares":"","CodeCategory":{"CategoryId":"7","CategoryDescription":"Misc"},"Keywords":["Computer Name","User Name","Desktop"]},{"RecordId":"263","Title":"Envelope Print Routine","Description":"Prints an Envelope, code can be used to print at any direction and size.","Code":"Sub EnvelopePrint1 (SzEnv As Envelope, Align%, Font$, Ret1$, Ret2$, Ret3$, Add1$, Add2$, Add3$)\r\n\r\nDim lf As LOGFONT\r\nDim oldhdc%, di%, Offset%, dvX%, dvY%, YPos%\r\nOn Error GoTo EnvelopePrintErr1\r\nIf Font$ = \"\" Then Font$ = \"Arial\"\r\ndvX% = GetDeviceCaps%(Printer.hDC, LOGPIXELSX)\r\ndvY% = GetDeviceCaps%(Printer.hDC, LOGPIXELSY)\r\nIf Align% > 0 Then\r\n    Offset% = Int((4.25 - (.5 * SzEnv.enWidth / 1000)) * dvX%)\r\nElse\r\n    Offset% = 0\r\nEnd If\r\nPrinter.Print \"\"\r\n\r\n'Set the font for the return address\r\nlf.lfHeight = Int((40 / 300) * dvX%)\r\nlf.lfWidth = Int((15 / 300) * dvY%)\r\n'Set 90 degree rotation of font (This does landscape)\r\nlf.lfEscapement = 900\r\n'Set other print options\r\nlf.lfWeight = 300\r\nlf.lfOutPrecision = Chr$(OUT_DEFAULT_PRECIS)\r\nlf.lfClipPrecision = Chr$(OUT_DEFAULT_PRECIS)\r\nlf.lfQuality = Chr$(DEFAULT_QUALITY)\r\nlf.lfPitchAndFamily = Chr$(DEFAULT_PITCH Or FF_DONTCARE)\r\nlf.lfCharSet = Chr$(DEFAULT_CHARSET)\r\nlf.lfFaceName = Font$ + Chr$(0)\r\nFontToUse% = CreateFontIndirect(lf)\r\nIf FontToUse% = 0 Then Exit Sub\r\noldhdc% = SelectObject(Printer.hDC, FontToUse%)\r\nYPos% = Int((SzEnv.enLength / 1000 * dvY%) - (.5 * dvY%))\r\ndi% = TextOut(Printer.hDC, Int((30 / 300 * dvX%) + Offset%), YPos%, Ret1$, Len(Ret1$))\r\ndi% = TextOut(Printer.hDC, Int((70 / 300 * dvX%) + Offset%), YPos%, Ret2$, Len(Ret2$))\r\ndi% = TextOut(Printer.hDC, Int((110 / 300 * dvX%) + Offset%), YPos%, Ret3$, Len(Ret3$))\r\ndi% = DeleteObject(FontToUse%)\r\n\r\n'Set the mailing address font\r\nlf.lfHeight = 50\r\nlf.lfWidth = 20\r\nlf.lfEscapement = 900\r\nlf.lfWeight = 500\r\nlf.lfOutPrecision = Chr$(OUT_DEFAULT_PRECIS)\r\nlf.lfClipPrecision = Chr$(OUT_DEFAULT_PRECIS)\r\nlf.lfQuality = Chr$(DEFAULT_QUALITY)\r\nlf.lfPitchAndFamily = Chr$(DEFAULT_PITCH Or FF_DONTCARE)\r\nlf.lfCharSet = Chr$(DEFAULT_CHARSET)\r\nlf.lfFaceName = Font$ + Chr$(0)\r\nFontToUse% = CreateFontIndirect(lf)\r\nIf FontToUse% = 0 Then Exit Sub\r\ndi% = SelectObject(Printer.hDC, FontToUse%)\r\nYPos% = Int((SzEnv.enLength / 2000 * dvY%) + (.75 * dvY%))\r\ndi% = TextOut(Printer.hDC, Int((450 / 300 * dvX%) + Offset%), YPos%, Add1$, Len(Add1$))\r\ndi% = TextOut(Printer.hDC, Int((510 / 300 * dvX%) + Offset%), YPos%, Add2$, Len(Add2$))\r\ndi% = TextOut(Printer.hDC, Int((560 / 300 * dvX%) + Offset%), YPos%, Add3$, Len(Add3$))\r\ndi% = SelectObject(Printer.hDC, oldhdc%)\r\ndi% = DeleteObject(FontToUse%)\r\nPrinter.EndDoc\r\n\r\nOn Error GoTo 0\r\nAlign% = 0\r\nExit Sub\r\n\r\nEnvelopePrintErr1:\r\n    Align% = Err\r\n    Exit Sub\r\n    Resume Next\r\n\r\nEnd Sub\r\n","Declares":"'  Logical Font - This TYPE is used to request a logical\r\n'font from the GDI for use on a device context. Note that\r\n'this can be done on the screen as well as on the printer.\r\nType LOGFONT   ' 50 Bytes\r\n        lfHeight As Integer\r\n        lfWidth As Integer\r\n        lfEscapement As Integer\r\n        lfOrientation As Integer\r\n        lfWeight As Integer\r\n        lfItalic As String * 1\r\n        lfUnderline As String * 1\r\n        lfStrikeOut As String * 1\r\n        lfCharSet As String * 1\r\n        lfOutPrecision As String * 1\r\n        lfClipPrecision As String * 1\r\n        lfQuality As String * 1\r\n        lfPitchAndFamily As String * 1\r\n        lfFaceName As String * 32\r\nEnd Type\r\n'With this type, set the width and length to the size of the envelope such as:\r\n'MyEnvelope.enWidth = 4.13 * 1000 (so the int holds it)\r\nType Envelope   'Describes dimensions of the envelope\r\n        enWidth As Integer\r\n        enLength As Integer\r\nEnd Type\r\n'Global mEnv As Envelope\r\n'API functions\r\nDeclare Function CreateFontIndirect% Lib \"GDI\" (lpLogFont As LOGFONT)\r\nDeclare Function SelectObject% Lib \"GDI\" (ByVal hDC%, ByVal hObject%)\r\nDeclare Function TextOut% Lib \"GDI\" (ByVal hDC%, ByVal x%, ByVal y%, ByVal lpString$, ByVal nCount%)\r\nDeclare Function DeleteObject% Lib \"GDI\" (ByVal hObject%)\r\nDeclare Function GetDeviceCaps% Lib \"GDI\" (ByVal hDC%, ByVal nIndex%)\r\n'Global constants\r\nGlobal Const DEFAULT_QUALITY = 0\r\nGlobal Const OUT_DEFAULT_PRECIS = 0\r\nGlobal Const DEFAULT_PITCH = 0\r\nGlobal Const FF_DONTCARE = 0\r\nGlobal Const DEFAULT_CHARSET = 1\r\nGlobal Const LOGPIXELSX = 88 '  Logical pixels/inch in X\r\nGlobal Const LOGPIXELSY = 90 '  Logical pixels/inch in Y\r\nGlobal FontToUse%  ' store font\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Envelope Printing","Printing - Envelopes"]},{"RecordId":"264","Title":"Numeric Base Conversions","Description":"Two functions to convert decimal to another base, and another base to decimal.","Code":"'BASES.BAS Version 1.00. 1st March 1997. Ian Howlett.\r\n'----------------------------------------------------\r\n\r\n\r\n'This BAS file is used for converting numbers between one base and another.\r\n'Bases 2-36 are handled, using digits 0-9 and then A-Z to give the 36\r\n'\"digits\" needed.\r\n\r\n'The functions do not handle numbers with a point (real numbers) or negative\r\n'values (less than 0).\r\n\r\n\r\n'There are two functions:\r\n\r\n'DecimalToBase converts a decimal to a base.\r\n'BaseToDecimal converts a number stored in another base to decimal (base 10).\r\n\r\n\r\n\r\n'Usage Guide\r\n'------------\r\n\r\n'To convert 95 in base 10 (decimal) to base 8 (octal), use\r\n'    DecimalToBase(95,8)\r\n\r\n\r\n'To convert 137 in base 8 (octal) to base 10 (decimal), use\r\n'    BaseToDecimal(\"137\",8)\r\n'    (Remember the \"\" signs!)\r\n\r\n\r\n'To convert a number in a non-decimal base to another non-decimal base,\r\n'for example 42 in base 2 (binary) is 101010, but 2A in base 16 (hex). To\r\n'convert it use:\r\n'    DecimalToBase(BaseToDecimal(\"101010\",2),16)\r\n\r\n\r\n\r\n'Bugs, errors and improvements\r\n'-----------------------------\r\n\r\n'If you find a bug, get an error, need help using the functions or can\r\n'suggest or have made any improvements, please contact me on one of the\r\n'e-mail addresses listed below. I have tested both functions and they\r\n'seem to work alright.\r\n\r\n'If you get an error, first ensure that every parameter passed and the\r\n'result of of the correct data type. e.g. Strings where strings should\r\n'be passed, numbers where numbers should be passed, etc.\r\n\r\n'The functions don't like numbers being passed using exponents, for example\r\n'3.215E+16\r\n\r\n'The level of accuracy that Visual BASIC uses to store numbers sometimes\r\n'gives slight errors. You should be alright up to at least\r\n'101,559,956,668,415 in base 10 (\"ZZZZZZZZZ\" in base 36)!\r\n\r\n\r\n\r\n'Version Information\r\n'-------------------\r\n\r\n'These functions were written using Visual BASIC 3 for Windows 3.11.\r\n'However, there are no special version-specific commands, so any\r\n'version of Visual BASIC should be alright.\r\n\r\n\r\n\r\n'Legal Information\r\n'-----------------\r\n\r\n'I give absolutely no guarantee whatsoever that these functions work and do\r\n'anything I say they do. You use them completely at your own risk.\r\n\r\n'This code is placed in the Public Domain. (PD). You may modify it, use\r\n'it in your own programs, or use it however you see fit. A mention in\r\n'some credits would be nice though! :)\r\n\r\n\r\n\r\n'Contacting the Author\r\n'---------------------\r\n\r\n'These functions were written by:\r\n\r\n'Ian Howlett.\r\n\r\n'CompuServe: 101720,3025\r\n'Internet:   igh@compuserve.com\r\n'FidoNet:    2:2500/708.20     (Last resort!)\r\n'Web:        http://ourworld.compuserve.com/homepages/igh\r\n\r\nFunction BaseToDecimal (Number As String, BaseNo As Integer)\r\n\r\n'Converts a positive whole number in any base from 2 to 36 into a decimal\r\n'(base 10) number.\r\n'\r\n'Does NOT deal with real numbers (having a decimal point)\r\n'or negative numbers (smaller than 0).\r\n'\r\n'\r\n'SYNTAX for use:\r\n'\r\n'DecimalToBase (Number To Convert, Base the number is currently stored in)\r\n'\r\n'Where: Number To Convert is a string. If you are giving a value rather\r\n'            than a string-type variable, enclose the value in \"\".\r\n'       Base the number is currently stored in is an integer from 2 to 36\r\n\r\n'       The result of the function is returned as type variant.\r\n\r\n\r\n\r\nOn Error GoTo BaseToDecimal_Error\r\n\r\nStatic BaseChars(0 To 35) As String\r\nDim AmountLeft, c1, c2, Temp  As Integer\r\nDim Result As Double\r\nDim NumberStr As String\r\n\r\nErase BaseChars\r\n\r\n'Define Base characters\r\nBaseChars(0) = \"0\"\r\nBaseChars(1) = \"1\"\r\nBaseChars(2) = \"2\"\r\nBaseChars(3) = \"3\"\r\nBaseChars(4) = \"4\"\r\nBaseChars(5) = \"5\"\r\nBaseChars(6) = \"6\"\r\nBaseChars(7) = \"7\"\r\nBaseChars(8) = \"8\"\r\nBaseChars(9) = \"9\"\r\nBaseChars(10) = \"A\"\r\nBaseChars(11) = \"B\"\r\nBaseChars(12) = \"C\"\r\nBaseChars(13) = \"D\"\r\nBaseChars(14) = \"E\"\r\nBaseChars(15) = \"F\"\r\nBaseChars(16) = \"G\"\r\nBaseChars(17) = \"H\"\r\nBaseChars(18) = \"I\"\r\nBaseChars(19) = \"J\"\r\nBaseChars(20) = \"K\"\r\nBaseChars(21) = \"L\"\r\nBaseChars(22) = \"M\"\r\nBaseChars(23) = \"N\"\r\nBaseChars(24) = \"O\"\r\nBaseChars(25) = \"P\"\r\nBaseChars(26) = \"Q\"\r\nBaseChars(27) = \"R\"\r\nBaseChars(28) = \"S\"\r\nBaseChars(29) = \"T\"\r\nBaseChars(30) = \"U\"\r\nBaseChars(31) = \"V\"\r\nBaseChars(32) = \"W\"\r\nBaseChars(33) = \"X\"\r\nBaseChars(34) = \"Y\"\r\nBaseChars(35) = \"Z\"\r\n\r\n\r\n'Check base is within range\r\nIf BaseNo < 2 Or BaseNo > 36 Then Exit Function\r\n\r\n'Ensure any letters in Number are upper case\r\nNumber = UCase$(Number)\r\n\r\n'Check that there are no characters used in Number that are not supported\r\n'by the base the number is represented in.\r\n\r\n'Uses Temp as a flag to show that a character has been found\r\nFor c1 = 1 To Len(Number)\r\n    Temp = False\r\n    For c2 = 0 To (BaseNo - 1)\r\n        If Mid$(Number, c1, 1) = BaseChars(c2) Then\r\n            Temp = True\r\n            Exit For\r\n        End If\r\n    Next c2\r\nIf Temp = False Then\r\n    MsgBox \"The number passed to BaseToDecimal is NOT stored in base \" + Format$(BaseNo) + \" as stated.\"\r\n    Exit Function\r\nEnd If\r\nNext c1\r\n\r\n\r\n'Work through Number from left to right\r\n\r\nResult = 0\r\nFor c1 = 1 To Len(Number)\r\n    'find what the character represents\r\n    For c2 = 0 To 36\r\n        If Mid$(Number, c1, 1) = BaseChars(c2) Then\r\n            Temp = c2\r\n            Exit For\r\n        End If\r\n    Next c2\r\n    Result = Result + Temp * (BaseNo ^ (Len(Number) - c1))\r\nNext c1\r\n\r\nBaseToDecimal = Result\r\n\r\nExit Function\r\n\r\n\r\nBaseToDecimal_Error:\r\nMsgBox \"There was an error converting \" + Format$(Number) + \" to base \" + Format$(BaseNo) + \". The error was \" + Error$(Err), , \"Error in Base Conversion\"\r\nExit Function\r\nResume\r\n\r\nEnd Function\r\n\r\nFunction DecimalToBase (Number, BaseNo As Integer) As String\r\n\r\n'Converts a positive decimal (base 10) whole number into any base\r\n'from 2 to 36.\r\n'\r\n'Does NOT deal with real numbers (having a decimal point)\r\n'or negative numbers (smaller than 0).\r\n'\r\n'\r\n'SYNTAX for use:\r\n'\r\n'DecimalToBase (Number To Convert, Base to convert into)\r\n'\r\n'Where: Number To Convert is a whole number\r\n'       Base to convert into is an integer from 2 to 36\r\n'\r\n'       The result of the function is returned as a string.\r\n\r\n\r\n\r\nOn Error GoTo DecimalToBase_Error\r\n\r\nStatic BaseChars(0 To 35) As String\r\nDim AmountLeft, Power, c1, Temp As Integer\r\nDim Result As String\r\n\r\nErase BaseChars\r\n\r\n'Check base\r\nIf BaseNo < 2 Or BaseNo > 36 Then Exit Function\r\n\r\n'Define Base characters\r\nBaseChars(0) = \"0\"\r\nBaseChars(1) = \"1\"\r\nBaseChars(2) = \"2\"\r\nBaseChars(3) = \"3\"\r\nBaseChars(4) = \"4\"\r\nBaseChars(5) = \"5\"\r\nBaseChars(6) = \"6\"\r\nBaseChars(7) = \"7\"\r\nBaseChars(8) = \"8\"\r\nBaseChars(9) = \"9\"\r\nBaseChars(10) = \"A\"\r\nBaseChars(11) = \"B\"\r\nBaseChars(12) = \"C\"\r\nBaseChars(13) = \"D\"\r\nBaseChars(14) = \"E\"\r\nBaseChars(15) = \"F\"\r\nBaseChars(16) = \"G\"\r\nBaseChars(17) = \"H\"\r\nBaseChars(18) = \"I\"\r\nBaseChars(19) = \"J\"\r\nBaseChars(20) = \"K\"\r\nBaseChars(21) = \"L\"\r\nBaseChars(22) = \"M\"\r\nBaseChars(23) = \"N\"\r\nBaseChars(24) = \"O\"\r\nBaseChars(25) = \"P\"\r\nBaseChars(26) = \"Q\"\r\nBaseChars(27) = \"R\"\r\nBaseChars(28) = \"S\"\r\nBaseChars(29) = \"T\"\r\nBaseChars(30) = \"U\"\r\nBaseChars(31) = \"V\"\r\nBaseChars(32) = \"W\"\r\nBaseChars(33) = \"X\"\r\nBaseChars(34) = \"Y\"\r\nBaseChars(35) = \"Z\"\r\n\r\n\r\n'Determine column at which to start\r\n\r\nPower = -1\r\nDo\r\n    Power = Power + 1\r\nLoop Until (BaseNo ^ Power) > Number\r\nPower = Power - 1\r\n\r\n\r\nAmountLeft = Number\r\n                     \r\nFor c1 = Power To 0 Step -1\r\n    Temp = Int(AmountLeft / (BaseNo ^ c1))\r\n    If Temp = BaseNo Then\r\n        Result = Result + BaseChars(0)\r\n    Else\r\n        Result = Result + BaseChars(Temp)\r\n    End If\r\n    AmountLeft = AmountLeft - (Temp * (BaseNo ^ c1))\r\nNext c1\r\n\r\nIf Result = \"\" Then Result = BaseChars(0)\r\nDecimalToBase = Result\r\n\r\nExit Function\r\n\r\n\r\nDecimalToBase_Error:\r\nMsgBox \"There was an error converting \" + Format$(Number) + \" to base \" + Format$(BaseNo) + \". The error was \" + Error$(Err), , \"Error in Base Conversion\"\r\nExit Function\r\nResume\r\n\r\nEnd Function\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Base Conversion","Numeric Conversion"]},{"RecordId":"265","Title":"Change a Form Icon (Alt-Tab)","Description":"Changes a forms icon and makes the new icon display when switching tasks using Alt-Tab","Code":"' *************************************************************************\r\n' This is the complete BAS module code required.\r\n' Call from a form with SetAppIcon(Me)\r\n' *************************************************************************\r\n'  You are free to use this code within your own applications, but you\r\n'  are expressly forbidden from selling or otherwise distributing this\r\n'  source code, non-compiled, without prior written consent.\r\n' *************************************************************************\r\nOption Explicit\r\n\r\nPrivate Declare Function GetWindowLong Lib \"user32\" Alias \"GetWindowLongA\" (ByVal hWnd As Long, ByVal nIndex As Long) As Long\r\nPrivate Declare Function SendMessage Lib \"user32\" Alias \"SendMessageA\" (ByVal hWnd As Long, ByVal wMsg As Long, ByVal wParam As Long, lParam As Any) As Long\r\nPrivate Declare Function LoadIcon Lib \"user32\" Alias \"LoadIconA\" (ByVal hInstance As Long, lpIconName As Any) As Long\r\n\r\nPrivate Const GWL_HWNDPARENT = (-8)\r\n\r\nPrivate Const WM_GETICON = &H7F\r\nPrivate Const WM_SETICON = &H80\r\n\r\nPrivate Const ICON_SMALL = 0\r\nPrivate Const ICON_BIG = 1\r\n\r\nPrivate Const IDI_WINLOGO = 32517&\r\n\r\n\r\nPublic Function SetAppIcon(obj As Object) As Boolean\r\n   Dim hIcon As Long\r\n   Dim hWnd As Long\r\n   Dim nRet As Long\r\n   \r\n   If TypeOf obj Is Form Or TypeOf obj Is MDIForm Then\r\n      ' Get top-level hidden window\r\n      nRet = GetWindowLong(obj.hWnd, GWL_HWNDPARENT)\r\n      Do While nRet\r\n         hWnd = nRet\r\n         nRet = GetWindowLong(hWnd, GWL_HWNDPARENT)\r\n      Loop\r\n      \r\n      ' Get a handle to icon\r\n      hIcon = SendMessage(obj.hWnd, WM_GETICON, ICON_BIG, ByVal 0&)\r\n      If hIcon = 0 Then\r\n         ' Load default waving-flag logo\r\n         hIcon = LoadIcon(0, ByVal IDI_WINLOGO)\r\n      End If\r\n      \r\n      ' Pass form icon as new app icon\r\n      Call SendMessage(hWnd, WM_SETICON, ICON_BIG, ByVal hIcon)\r\n                        \r\n      ' See if change took\r\n      SetAppIcon = (hIcon = SendMessage(hWnd, WM_GETICON, ICON_BIG, ByVal 0&))\r\n   End If\r\nEnd Function\r\n","Declares":"","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Icon","Alt-Tab"]},{"RecordId":"266","Title":"Import Text File Then Export As Word Document","Description":"Imports a text document and exports as a Word document","Code":"Public Function ExportToWordNew(strReportFileNameIn As String)\r\n\r\n  Dim objWord As Word.Application\r\n  Dim strWordSaveAsFileName As String\r\n  Dim blnRetVal As Boolean\r\n  Dim blnWordWasRunning As Boolean\r\n  Dim objWordDoc As Word.Document\r\n  Dim objRange As Word.Range\r\n\r\n  ' Create export file name with DOC extension\r\n  strWordSaveAsFileName = WordSaveAsFileName(strReportFileNameIn)\r\n\r\n\r\n  ' If Word is running, shut it down\r\n  If WordIsRunning() Then\r\n      StopWord\r\n  End If\r\n\r\n  ' Wait 5 seconds just in case Word is slow in closing\r\n  Sleep 5000\r\n\r\n  ' Start up word\r\n  Set objWord = CreateObject(\"Word.Application\")\r\n\r\n  'Close any open documents\r\n  If objWord.Documents.Count <> 0 Then\r\n      objWord.Documents.Close wdDoNotSaveChanges\r\n  End If\r\n\r\n  ' Open the document\r\n  objWord.Documents.Open strReportFileNameIn, False\r\n\r\n  ' Set landscape with 1\" margins\r\n  Set objWordDoc = objWord.ActiveDocument\r\n  objWordDoc.PageSetup.Orientation = wdOrientLandscape\r\n  objWordDoc.PageSetup.RightMargin = 72\r\n  objWordDoc.PageSetup.LeftMargin = 72\r\n\r\n  ' Select all of the text\r\n  Set objRange = objWordDoc.Range(Start:=0, End:=objWordDoc.Characters.Count)\r\n  objRange.Select\r\n  \r\n  ' Set text to Courer 8 pt\r\n  objRange.Font.Name = \"Courier New\"\r\n  objRange.Font.Size = 8\r\n  \r\n  ' Save the document as Word Native format\r\n  objWordDoc.SaveAs strWordSaveAsFileName, wdFormatDocument\r\n  \r\n  ' Close any open documents\r\n  objWord.Documents.Close wdDoNotSaveChanges\r\n\r\n  ' Close word\r\n  objWord.Quit\r\n\r\n  ' Wait 5 seconds just in case Word is slow in closing\r\n  Sleep 5000\r\n  \r\n  Set objRange = Nothing\r\n  Set objWordDoc = Nothing\r\n  Set objWord = Nothing\r\n\r\n  ' Safety net just to be absolutely sure that Word is no longer running\r\n  StopWord\r\n\r\nEnd Function\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Word","OLE Automation"]},{"RecordId":"267","Title":"Call Click Events","Description":"Calls click events on command button, check boxes, and option buttons.","Code":"Call SendMessage(Check1.hWnd, BM_CLICK, 0, ByVal 0&)\r\nCall SendMessage(Option1.hWnd, BM_CLICK, 0, ByVal 0&)\r\nCall SendMessage(Command1.hWnd, BM_CLICK, 0, ByVal 0&)\r\n","Declares":"Private Declare Function SendMessage _\r\n    Lib \"user32\" Alias \"SendMessageA\" _\r\n    (ByVal hWnd As Long, _\r\n    ByVal wMsg As Long, _\r\n    ByVal wParam As Long, _\r\n    lParam As Any) As Long\r\n\r\nPrivate Declare Function PostMessage _\r\n    Lib \"user32\" Alias \"PostMessageA\" _\r\n    (ByVal hWnd As Long, _\r\n    ByVal wMsg As Long, _\r\n    ByVal wParam As Long, _\r\n    ByVal lParam As Long) As Long\r\n    \r\nPrivate Const BM_CLICK = &HF5\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Click Events"]},{"RecordId":"268","Title":"Center Form","Description":"Centers the form passed to it horizontally and vertically on the screen. \r\n","Code":"Sub CenterForm (F As Form)\r\n\r\nF.Left = (Screen.Width - F.Width) / 2\r\nF.Top = (Screen.Height - F.Height) / 2\r\n\r\nEnd Sub\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Center Form"]},{"RecordId":"269","Title":"ADO Marshalling","Description":"MSDN Article on ADO Marshalling","Code":"ADO General Marshaling\r\nBy default, ADO provides standard COM marshaling. This means that ADO uses standard OLE automation types for its arguments and interface pointers can be passed across processes without any special custom marshaling code. A COM server for example can return a connection or recordset object to a client and the ADO object's interface pointer is passed across the process (in other words, passing a reference to the object). Any calls to methods of the interface cause a call from the client back to the ADO object that was created and exists on the server. One key pitfall is that ADO does not allow you to pass a connection pointer across process boundaries and then attach that to an ADO recordset object that was created in a different process space. Recordsets and their associated connections must be created in the same process space. \r\n\r\nFor example, suppose you have the following Visual Basic code:\r\n\r\nProcess #1:\r\nDim rs As ADODB.Recordset\r\nDim conn As New ADODB.Connection\r\nDim server As New Server.Class1\r\nconn.Open \"Provider=SQLOLEDB;Data Source=myserver;initial catalog=pubs\", \"sa\"\r\nSet rs = server.GetRecordset(conn) \r\n\r\nProcess #2:\r\nPublic Function GetRecordset(conn As ADODB.Connection) As ADODB.Recordset\r\n    Set GetRecordset = conn.Execute(\"Select * from authors\")  \r\nEnd Function \r\n\r\nThis code sample works. The connection's interface is marshaled from process #1 to process #2 using standard marshaling. When the Execute call is made, process #2 calls across its process boundary to process #1 where the ADO connection constructs a recordset object and returns it back to process #2.\r\n\r\n\r\nHowever, lets say you have the following code in process #2: \r\nPublic Function GetRecordset(conn As ADODB.Connection) As ADODB.Recordset\r\n    Dim rs As New Recordset\r\n    Set rs.ActiveConnection = conn \r\nEnd Function \r\n\r\nThe function fails on the assignment of the ADO connection object to the recordset object. ADO prevents the assignment of connection objects in one process from being assigned to recordset objects created in a different process. For the in-process case, ADO specializes the marshaling of its objects by using the COM free-threaded marshaler (using CoCreateFreeThreadedMarshaler). This means that while ADO is marked for apartment-model threading by default, ADO skirts the apartment rules with the free-threaded marshaler and has direct pass-through of any ADO object interfaces from one thread to another. No COM synchronization takes place as ADO is thread-safe and does all of the necessary synchronization. Overall, this means that ADO does no COM marshaling for the in-process scenarios. \r\n\r\nBeyond Standard Marshaling\r\nADO's standard marshaling is sufficient for many scenarios but not all. For example, standard marshaling across processes can hurt performance because for each call to the ADO object, an application is making a call across process. It would be better for performance if all of the data of a recordset was returned to the client and then any subsequent calls such as fetching were made locally in the client rather than back to the COM server where the recordset was created.\r\n\r\nADO provides such a mechanism for the recordset object. To return a recordset object from a server and have the data of the recordset marshaled to the client, you specify adUseClient for the recordset's CursorLocation property. The adUseClient value tells the recordset object to use the Client Cursor Engine which caches all of the records of the recordset. Whenever a recordset is sent across process boundaries with adUseClient set, a recordset object (which also uses the client cursor engine) is constructed in the receiving process and it is populated with the sent records. At this point, the recordset is \"disconnected\" or is \"disassociated\" from a database connection. The database connection is not carried along with the recordset data when adUseClient is specified. \r\n\r\nWith adUseClient set, you always pass the data of the recordset when sending the recordset across process. This is typically called \"passing by value\". Without adUseClient, you always get standard marshaling and only a reference to the ADO Recordset object is passed across process boundaries and is typically called \"passing by reference\". \r\n\r\nLimitations of Marshaling recordsets \"By Value\" \r\nWhen ADO recordsets are passed by-value, it is the client cursor engine that is really marshaling the recordset data across the process boundaries. The newly created ADO recordset object in the receiving process simply attaches to the recordset stored in the client cursor engine cache. There are some important ramifications from this. Because the ADO recordset is not being marshaled but rather than underlying the OLE DB rowset, the properties of the recordset object do not get marshaled. This means that properties such as Filter, Sort, and ActiveConnection are not carried from one process to the next. Thus, for example, a common pitfall is to set the Filter property of a recordset and then expect only the filtered records to be passed across the process boundaries. Instead, all of the original records of the query are passed. Furthermore, the cursor location is set to the beginning of the recordset as the cursor position is not preserved because a new ADO recordset is created in the receiving process and then it is attached to the marshaled rowset causing the cursor to be positioned at the first record. So as a general rule, do not expect recordset properties to be marshaled across the process. The advantage to this is that ADO recordset marshaling has very little overhead; only the metadata (table name, column name and data types, and some flags) and record data. \r\n\r\nUsing the COM Global Interface Table with ADO Recordsets\r\nCOM provides a component called Global Interface Table (GIT). The GIT allows an application to store a reference to an object's interface in the table so that the interface pointer can be retrieved at any time. When storing the interface pointer into the GIT, the object is queried for IMarshal and if IMarshal is exposed by the object, then the marshaling data of the object is placed into a stream where it can be retrieved at some later time when the interface pointer is retrieved. IMarshal is exposed by the client cursor that actually does the passing of the recordset data. There is a problem if an open ADO recordset object which uses adUseClient (for example, disconnected recordset) is placed into the GIT and then is later revoked from the table. An access violation occurs. To avoid the problem, place the recordset's interface pointer into the GIT before calling Open on the recordset. This places the interface pointer into the GIT before the client cursor engine is invoked which essentially causes standard marshaling to occur rather than record data being streamed from the cursor engine through IMarshal. Only a pointer to the ADO recordset's interface is stored in this case and that is the real intent of the programmer.","Declares":"","CodeCategory":{"CategoryId":"3","CategoryDescription":"Database"},"Keywords":["ADO","Marshalling"]},{"RecordId":"270","Title":"Changing Program Files Directory","Description":"How to change the default install directory from ProgramFiles to something else.","Code":"CHANGING THE DEFAULT LOCATION FOR INSTALLING APPLICATIONS\r\n\r\nMost programs install in C:\\Program Files by default. You can change this default by editing the registry. Open the Registry Editor by selecting Start | Run | Regedt32. Navigate to HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\Current Version.\r\nIn the right pane, double-click ProgramFilesDir and change the path in the String Editor to the drive and folder you want (i.e. D:\\Program Files). You must also modify the entry for ProgramFilesPath.\r\n\r\nExit the Registry Editor and restart your computer. Be aware that some programs still require installation in the C:\\Progam Files folder.\r\n","Declares":"","CodeCategory":{"CategoryId":"7","CategoryDescription":"Misc"},"Keywords":["Program Files","Installation","Install Directory"]},{"RecordId":"271","Title":"Giving NT Services Access to Printers","Description":"Steps necessary to allow NT Services to use printers.","Code":"SYMPTOMS\r\nA COM object that sends output to a printer fails when called from Active Server Pages (ASP), but functions correctly when called from an interactive application. This COM object could be either a commercial product such as a Microsoft Office application, or a custom third-party object. A common error message is \"ClassName error '800a01e2' Printer error.\" \r\n\r\nCAUSE\r\nThe standard APIs that most objects use to print depend on registry entries located in HKEY_CURRENT_USER. This registry hive is dynamic. Depending on which user context the process is running under, different information will be loaded into this hive. ASP pages run under IIS, which is running as the SYSTEM account. When you create an instance of a COM object in your ASP code, by default, it will also run as the SYSTEM account. By default, the SYSTEM account does not have any printers set up in the registry. \r\n\r\nRESOLUTION\r\nYou can set up printers for the SYSTEM account to resolve this problem. To set up printers for the SYSTEM account, perform the following:\r\n\r\nThis method requires you to modify the registry using the Registry Editor. \r\n\r\n1.  Ensure that the user you are currently logged into on the server has the desired printers installed.\r\n\r\n2.  Launch the Registry Editor (Regedit.exe).\r\n\r\n3.  Select the following key:\r\n      HKEY_CURRENT_USER\r\n         \\Software\\Microsoft\\Windows NT\\Current Version\\Devices\r\n \r\n4.  From the Registry menu, click Export Registry File.\r\n\r\n5.  In the File Name text box, type c:\\Devices.reg.\r\n\r\n6.  Select the following key:\r\n      HKEY_CURRENT_USER\r\n         \\Software\\Microsoft\\Windows NT\\Current Version\\PrinterPorts\r\n \r\n7.  From the Registry menu, click Export Registry File.\r\n\r\n8.  In the File Name text box, type c:\\PrinterPorts.reg.\r\n\r\n9.  Select the following key:\r\n      HKEY_CURRENT_USER\r\n         \\Software\\Microsoft\\Windows NT\\Current Version\\Windows\r\n \r\n10. From the Registry menu, click Export Registry File.\r\n\r\n11. In the File Name text box, type c:\\Windows.reg.\r\n\r\n12. From the Start button, select Run. Open Devices.reg in Notepad by typing Notepad Devices.reg in Run dialog box. \r\n\r\n13. Replace the text HKEY_CURRENT_USER with HKEY_USERS\\.DEFAULT \r\n\r\n14. Save the file. Then import it into the registry by double-clicking the file in Windows Explorer.\r\n\r\n15. Repeat steps 13 through 15 for PrinterPorts.reg and Windows.reg.","Declares":"","CodeCategory":{"CategoryId":"7","CategoryDescription":"Misc"},"Keywords":["Services","Printing"]},{"RecordId":"273","Title":"Registering a Java Class in COM","Description":"How to register a Java class so that it can be called using COM","Code":"Compile the Java file into a class file.\r\n\r\nMove the class to the Winnt\\Java\\TrustLib folder.\r\n\r\n\r\nRegister the component using:\r\n   javareg /register /class:<javaclass> /progid:<Progid.classname>\r\n\r\n  For a java class named \"MyClass.class\", use:\r\n  javareg /register /class:MyClass /progid:MyProg.MyClass\r\n\r\n\r\nCall the class using either:\r\nSet o = CreateObject(\"YourProg.YourClass\")\r\n  or\r\nSet o = GetObject(\"java:YourClass\")\r\n","Declares":"","CodeCategory":{"CategoryId":"16","CategoryDescription":"Java"},"Keywords":["COM","Java","CreateObject"]},{"RecordId":"274","Title":"Save and Rehydrate ADO (2.5) Record Using XML","Description":"Demonstrates how to open a normal ADO recordset, save it as XML, and then re-create an identical ADO recordset from the XML.","Code":"' NOTE: Requires reference to the following libraries:\r\n'   Microsoft ActiveX Data Objects 2.5 Library\r\n'   Microsoft XML, version 2.0\r\n    \r\n    Dim cn As ADODB.Connection\r\n    Dim rsIn As ADODB.Recordset\r\n    Dim rsOut As ADODB.Recordset\r\n    Dim oStream As ADODB.Stream\r\n    Dim oDOMDoc As DOMDocument\r\n    Dim strXML As String\r\n    Dim strSQL As String\r\n    Dim strConnect As String\r\n    \r\n    \r\n    Set cn = New ADODB.Connection\r\n    Set rsIn = New ADODB.Recordset\r\n    Set oStream = New ADODB.Stream\r\n    \r\n    strConnect = \"Provider=SQLOLEDB;Server=JCBApps6;Database=CorpDB;UID=;PWD=;\"\r\n    cn.Open strConnect\r\n    \r\n    strSQL = \"SELECT Account_Branch, Account_Base, Address_Line_1 FROM v_Account WHERE Account_Branch = '143' AND Account_Base LIKE '0079%'\"\r\n    rsIn.Open strSQL, cn, adOpenStatic, adLockReadOnly\r\n    \r\n    ' Persist the recordset to an xml stream\r\n    oStream.Type = adTypeText\r\n    rsIn.Save oStream, adPersistXML\r\n    strXML = oStream.ReadText\r\n    \r\n    Set oStream = Nothing\r\n    rsIn.Close\r\n    Set rsIn = Nothing\r\n    cn.Close\r\n    Set cn = Nothing\r\n    \r\n    ' Recreate the recordset from the xml stream\r\n    Set oDOMDoc = New DOMDocument\r\n    Set rsOut = New ADODB.Recordset\r\n    oDOMDoc.loadXML strXML\r\n    rsOut.Open oDOMDoc\r\n    \r\n    Do While Not rsOut.EOF\r\n        Debug.Print rsOut(\"Account_Branch\") & \"-\" & rsOut(\"Account_Base\") & \"  \"; rsOut(\"Address_Line_1\")\r\n        rsOut.MoveNext\r\n    Loop\r\n    \r\n    Set rsOut = Nothing\r\n    Set oDOMDoc = Nothing\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"8","CategoryDescription":"XML"},"Keywords":["XML","ADO"]},{"RecordId":"277","Title":"Format Diskettes (Without Prompting)","Description":"Code to format a floppy that doesn't prompt the user with the normal format dialog.\r\nThe SHFormatDrive API prompts the user with a dialog box.  This function does not.","Code":"' ------------------------------------------------------------------------------------------------\r\n' This is the callback function that reports status during the formatting procedure\r\n' ------------------------------------------------------------------------------------------------\r\nPublic Function FMIFSCallback(ByVal Command As Long, _\r\n\tByVal SubAction As Long, ByVal ActionInfo As Long) _\r\n\tAs Byte\r\n\r\n\tDim lPercent As Long\r\n\tDim bytStatus as Byte\r\n\tDim bStatus As Boolean\r\n\tDim uTextOutput As uTextOutputType\r\n\r\n\tSelect Case Command\r\n\tCase PROGRESS\r\n\t\tCopyMemory lPercent, ByVal ActionInfo, 4\r\n\t\tDebug.Print \"Percent complete: \" & lPercent\r\n\tCase DONE\r\n\t\tCopyMemory bytStatus, ByVal ActionInfo, 1\r\n\t\tBStatus = Cbool(bytStatus)\r\n\t\tDebug.Print \"Status: \" & bStatus\r\n\tCase WRITEPROTECTED\r\n\t\tDebug.Print \"Disk is write protected.\"\r\n\tCase STRUCTUREPROGRESS\r\n\t\tIf (ActionInfo <> 0) Then\r\n\t\t\tCopyMemory uTextOutput, ByVal ActionInfo, 8\r\n\t\tEnd If\r\n\tCase DONEWITHSTRUCTURE\r\n\t\tIf (ActionInfo <> 0) Then\r\n\t\t\tCopyMemory uTextOutput, ByVal ActionInfo, 8\r\n\t\tEnd If\r\n\t'The following cases are not currently recognized \r\n\t'so we return a failure\r\n\tCase Else\r\n\t\tDebug.Print \"FMIFSCallback - unknown command\" _\r\n\t\t& \" not handled (\" & Command & \";\" & SubAction _\r\n\t\t& \";\" & ActionInfo & \").\"\r\n\t\tGoTo Exit_\r\n\tEnd Select\r\n\r\n\t'Return C-style True = 1\r\n\tFMIFSCallback = &H1\r\nExit_:\r\nEnd Function\r\n\r\n' ------------------------------------------------------------------------------------------------\r\n' This is how you call the formatting procedure\r\n' ------------------------------------------------------------------------------------------------\r\nPublic Sub Main()\r\n\r\n\tDim DriveRoot() As Byte\r\n\tDim Format() As Byte\r\n\tDim Label() As Byte\r\n\tDim QuickFormat As Long\r\n\tDim ClusterSize As Long\r\n\r\n\tDriveRoot = \"A:\\\" & vbNullChar\r\n\tFormat = \"FAT\" & vbNullChar\r\n\tLabel = \"Test\" & vbNullChar\r\n\tQuickFormat = 0\r\n\tClusterSize = 0\r\n\r\n\tFormatEx DriveRoot(0), FMIFS_FLOPPY, Format(0), _\r\n\t\tLabel(0), QuickFormat, ClusterSize, _\r\n\t\tAddressOf FMIFSCallback\r\nEnd Sub","Declares":"Private Type uTextOutputType\r\n\tLines As Long\r\n\tOutput As Long\r\nEnd Type\r\n\r\nPrivate Enum CallbackCommand\r\n\tPROGRESS\r\n\tDONEWITHSTRUCTURE\r\n\tUNKNOWN2\r\n\tUNKNOWN3\r\n\tUNKNOWN4\r\n\tUNKNOWN5\r\n\tINSUFFICIENTRIGHTS\r\n\tWRITEPROTECTED\r\n\tUNKNOWN8\r\n\tUNKNOWN9\r\n\tUNKNOWNA\r\n\tDONE\r\n\tUNKNOWNC\r\n\tUNKNOWND\r\n\tOutput\r\n\tSTRUCTUREPROGRESS\r\nEnd Enum \r\n\r\n'Beware of this value!\r\n'Public Const FMIFS_HARDDISK& = &HC\r\nPublic Const FMIFS_FLOPPY& = &H8\r\n\r\nPublic Declare Sub FormatEx _\r\n\tLib \"fmifs.dll\" ( _\r\n\tByRef DriveRoot As Byte, _\r\n\tByVal MediaFlag As Long, _\r\n\tByRef Format As Byte, _\r\n\tByRef Label As Byte, _\r\n\tByVal QuickFormat As Long, _\r\n\tByVal ClusterSize As Long, _\r\n\tByVal Callback As Long)\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Diskettes","Format"]},{"RecordId":"278","Title":"SQL Server System Tables and Stored Procedures","Description":"How SQL Server stores metadata info about system tables and stored procedures","Code":"--------------------------------------------------------------------------------------------------------------\r\nSystem tables store metadata data about the databases in SQL Server. This table shows you a subset of the SQL Server system tables.\r\n--------------------------------------------------------------------------------------------------------------\r\nsysforeignkeys \r\nResides in each database and stores information about the foreign keys in that database. \r\n\r\nsysindexes \r\nContains a row for each index within a database. Specifies the table with which the index is associated, whether it's clustered or nonclustered, the number of keys, and so on. \r\n\r\nsysindexkeys \r\nStores information on the keys or columns in an index. Specifies the table ID, the index ID, the column, and the position of the column in the index. \r\n\r\nsysobjects \r\nContains a row for each database object such as a user table, system table, check constraint, default constraint, foreign key, log, stored procedure, primary key, trigger, and new or extended stored procedure. This table is the hub of all the system tables and provides information about these objects, including name, object ID, the owner object, and creation date. \r\n\r\nsyspermissions \r\nStores information about the permissions granted and denied to users, groups, and roles for the objects in a database. \r\n\r\nsystypes \r\nContains a row for each datatype in the current database. Datatypes detailed in this table include the SQL Server standard datatypes as well as user-defined datatypes. \r\n\r\nsyscolumns \r\nContains a row for each column in a table or each parameter in a stored procedure. This table maintains the specifics for each column, including name, datatype, length, precision, scale, and nullability. The ID field specifies the table or stored procedure with which the column or parameter is associated. \r\n\r\nsyscomments \r\nContains a row for each stored procedure, view, rule, default, trigger, or check constraint. The rows in this table store details about each of these objects, including the actual text of the object. \r\n\r\nsysconstraints \r\nEach database has a sysconstraints table with a row for each constraint. Specifies the table and column with which the constraint is associated as well as the type of constraint: primary key, foreign key, unique constraint, check constraint, or default constraint. \r\n\r\nsysdatabases \r\nContains information on each database residing on the server and is part of the master system database. Includes the database name, ID, status, the database owner, and the date it was created. \r\n\r\nsysdepends \r\nContains object dependencies for views, stored procedures, and triggers in the current database. \r\n\r\n--------------------------------------------------------------------------------------------------------------\r\nSystem stored procedures query and update the system tables. System stored procedures provide a layer of abstraction from the system tables and return information from them. Instead of querying the system tables directly, you call these procedures to return metadata about the current database objects.\r\n--------------------------------------------------------------------------------------------------------------\r\nsp_column_privileges\t\r\nReturns privilege information for the specified table. This data is retrieved from the syscolumns, sysprotects, sysobjects, sysusers, and sysmembers system tables.\r\n\r\nsp_columns\t\r\nReturns the details for the columns in the specified table or view. This procedure queries the sysobjects, systypes, syscolumns, and syscomments tables and returns information on the datatype, precision, length, scale, and nullability of a column.\r\n\r\nsp_databases\t\r\nReturns a row for each database residing on the current server as stored in the sysdatabases system table.\r\n\r\nsp_fkeys\t\r\nReturns foreign key information found in the sysreferences, sysobjects, and sysindexes system tables. If you provide this procedure with the primary key table name it returns a list of all the tables that have a foreign key to that table. If you provide the foreign key table name, it returns a list of the tables that are related to the foreign keys in that table.\r\n\r\nsp_pkeys\t\r\nReturns information about the primary key for the specified table. This procedure queries the sysobjects, syscolumns, and sysindexes system tables.\r\n\r\nsp_server_info\t\r\nReturns the attribute names and values for a SQL Server. Each row returned contains an attribute ID, the attribute name, and the attribute value. This procedure queries the spt_server_info system table.\r\n\r\nsp_special_columns\t\r\nReturns the columns that uniquely identify a row in the specified table. The uniqueness can be enforced by a primary key or unique index.\r\n\r\nsp_sproc_columns\t\r\nReturns information about the input and output parameters for the specified procedure.\r\n\r\nsp_statistics\t\r\nReturns information on all the indexes on the specified table. This data is retrieved from the sysobjects, sysindexes, and syscolumns system tables.\r\n\r\nsp_stored_procedures\t\r\nReturns information about the stored procedures in the current database including the system stored procedures. Queries the sysobjects and syscomments system tables.\r\n\r\nsp_table_privileges\t\r\nReturns the SELECT, INSERT, UPDATE, DELETE, and REFERENCES permissions granted on the specified table. Granting REFERENCES permission allows owners of other tables to use columns in the specified table in a foreign key constraint.\r\n\r\nsp_tables\t\r\nReturns the details about all the tables and views in the current database including system tables. Queries the sysobjects, syscolumns, and sysdatabases system tables.","Declares":"","CodeCategory":{"CategoryId":"10","CategoryDescription":"SQL Server"},"Keywords":["Metadata","SysObjects"]},{"RecordId":"279","Title":"FileSystemObject Samples","Description":"Demonstrates usage of the FileSystemObject to read, write, copy, delete, etc.","Code":"' NOTE:  Requires a reference to the \"Microsoft Scripting Runtime\" library\r\n\r\n'----------------------------------------------------------------------------------------------------\r\nOpen a file for reading (using read-all)\r\n'----------------------------------------------------------------------------------------------------\r\nDim objFSO\r\nSet objFSO = Server.CreateObject(\"Scripting.FileSystemObject\")\r\n\r\nDim objTextStream\r\n\r\nconst strFileName = \"D:\\scott\\resume.txt\"\r\nconst fsoForReading = 1\r\n\r\nIf objFSO.FileExists(\"D:\\scott\\resume.txt\") then\r\n\t'The file exists, so open it and output its contents\r\n\tSet objTextStream = objFSO.OpenTextFile(strFileName, fsoForReading)\r\n\tResponse.Write \"\" & objTextStream.ReadAll & \"\"\r\n\tobjTextStream.Close\r\n\tSet objTextStream = Nothing\r\nElse\r\n\t'The file did not exist\r\n\tResponse.Write strFileName & \" was not found.\"\r\nEnd If\r\n\r\n'Clean up\r\nSet objFSO = Nothing\r\n\r\n'----------------------------------------------------------------------------------------------------\r\nOpen a file for appending\r\n'----------------------------------------------------------------------------------------------------\r\nConst fsoForAppend = 8\r\n\r\nDim objFSO\r\nSet objFSO = Server.CreateObject(\"Scripting.FileSystemObject\")\r\n\r\n'Open the text file\r\nDim objTextStream\r\nSet objTextStream = objFSO.OpenTextFile(\"C:\\Welcome.txt\", fsoForAppend)\r\n\r\n'Display the contents of the text file\r\nobjTextStream.WriteLine \"Hello, World!\"\r\nobjTextStream.WriteLine \"This is fun!!\"\r\n\r\n'Close the file and clean up\r\nobjTextStream.Close\r\nSet objTextStream = Nothing\r\nSet objFSO = Nothing\r\n\r\n'----------------------------------------------------------------------------------------------------\r\nOpen a file for output (replaces current contents).\r\n'----------------------------------------------------------------------------------------------------\r\nConst fsoForWriting = 2\r\n\r\nDim objFSO\r\nSet objFSO = Server.CreateObject(\"Scripting.FileSystemObject\")\r\n\r\n'Open the text file\r\nDim objTextStream\r\nSet objTextStream = objFSO.OpenTextFile(\"C:\\SomeFile.txt\", fsoForWriting, True)\r\n\r\n'Display the contents of the text file\r\nobjTextStream.WriteLine \"Hello, World!\"\r\n\r\n'Close the file and clean up\r\nobjTextStream.Close\r\nSet objTextStream = Nothing\r\nSet objFSO = Nothing\r\n\r\n'----------------------------------------------------------------------------------------------------\r\nCopy files (copies all of the .htm files in C:\\InetPub\\wwwroot to the directory C:\\windows\\desktop) \r\n'----------------------------------------------------------------------------------------------------\r\nDim objFSO\r\nSet objFSO = Server.CreateObject(\"Scripting.FileSystemObject\")\r\n\r\nobjFSO.CopyFile \"C:\\InetPub\\wwwroot\\*.htm\", \"C:\\Windows\\Desktop\"\r\n\r\nSet objFSO = Nothing\r\n\r\n'----------------------------------------------------------------------------------------------------\r\nDelete files (Can delete a single file, or multiple files by use of the wildcard character \"*\")\r\n'----------------------------------------------------------------------------------------------------\r\nDim objFSO\r\nSet objFSO = Server.CreateObject(\"Scripting.FileSystemObject\")\r\n\r\nobjFSO.DeleteFile \"C:\\InetPub\\wwwroot\\*.asp\", False\r\n\r\nSet objFSO = Nothing\r\n\r\n'----------------------------------------------------------------------------------------------------\r\nIterating through list of files in a folder\r\n'----------------------------------------------------------------------------------------------------\r\nDim objFSO\r\nSet objFSO = Server.CreateObject(\"Scripting.FileSystemObject\")\r\n\r\n'Get the folder object associated with the directory\r\nDim objFolder\r\nSet objFolder = objFSO.GetFolder(\"C:\\InetPub\\wwwroot\")\r\n\r\nResponse.Write \"The files found in \" & objFolder.Name & \":\"\r\n\r\n'Loop through the Files collection\r\nDim objFile\r\nFor Each objFile in objFolder.Files\r\n  Response.Write objFile.Name & \"\"\r\nNext\r\n\r\n'Clean up!\r\nSet objFolder = Nothing\r\nSet objFile = Nothing\r\nSet objFSO = Nothing\r\n\r\n'----------------------------------------------------------------------------------------------------\r\nRetrieve specific Drive, Folder, and File objects: GetDrive, GetFolder, and GetFile, respectively. Each of these three functions returns the appropriate object type. So, if you want to obtain specific information about a particular file (for example, it's last modified date, or its file size), you can use the GetFile method to retrieve the File object that represents that particular file. \r\n'----------------------------------------------------------------------------------------------------\r\nDim objFSO\r\nDim objFile\r\n\r\nSet objFSO = Server.CreateObject(\"Scripting.FileSystemObject\")\r\n\r\nSet objFile = objFSO.GetFile(\"C:\\Windows\\System.ini\")\r\n\r\n'Output some of the File object properties\r\nResponse.Write \"Name: \" & objFile.Name & \"\"\r\nResponse.Write \"Size: \" & objFile.Size & \"\"\r\nResponse.Write \"Last Modified: \" & objFile.DateLastModified & \"\"\r\n\r\n'Clean up\r\nSet objFile = Nothing\r\nSet objFSO = Nothing","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["FileSystemObject"]},{"RecordId":"280","Title":"Generate Random Numbers Between X And Y","Description":"Generate range of random numbers","Code":"Dim intLowLimit As Integer\r\nDim intHighLimit As Integer\r\nDim intRandomNumber As Integer\r\n\r\nintLowLimit = 5\r\nintHighLimit = 100 - intLowLimit\r\n\r\nRandomize Timer\r\nintRandomNumber = Int(Rnd() * intHighLimit) + intLowLimit\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Random Numbers"]},{"RecordId":"281","Title":"Minimize an Application's Window","Description":"Subroutine to minimize an application's window.  (You must know the CLASS of the window prior to doing this.)","Code":"Call Minimize_Window(\"PROGMAN\")\r\n\r\nSub Minimize_Window (WindowClass As String)\r\nDim hw As Integer\r\nDim WhoCares As Long\r\n\r\nhw = FindWindow(WindowClass, 0&)\r\nIf hw Then\r\n    WhoCares = PostMessage(hw, WM_SYSCOMMAND, SC_MINIMiZE, 0&)\r\nEnd If\r\n\r\nEnd Sub\r\n","Declares":"Const WM_SYSCOMMAND = &H112\r\nConst SC_MINIMiZE = &HF020\r\n\r\nDeclare Function FindWindow% Lib \"User\" (ByVal lpClassName As Any, ByVal lpWindowName As Any)\r\n\r\nDeclare Function PostMessage% Lib \"User\" (ByVal hWnd%, ByVal wMsg%, ByVal wParam%, lParam As Any)\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Minimize Forms"]},{"RecordId":"282","Title":"Use Common Dialog ctl with Multiple Long File Name","Description":"Use the Common Dialog Control with Multiple Long File Names","Code":"Private Sub Command1_Click()\r\n\r\n   Dim current As Integer\r\n   Dim I As Integer\r\n   Dim intIndex As Integer\r\n   Dim iStart As Integer\r\n   Dim FileNames$()\r\n   Dim sFname As String\r\n   Dim iEndPath As Integer\r\n\r\n   Text2.Text = \"\"\r\n   With CommonDialog1\r\n      .MaxFileSize = 2048   ' Set as appropriate\r\n      .filename = \"\"\r\n      .Filter = \"All Files|*.*\"\r\n      .Flags = cdlOFNAllowMultiselect + cdlOFNExplorer\r\n      .ShowOpen\r\n      sFname = .filename & vbNullChar\r\n   End With\r\n\r\n   iEndPath = 1\r\n   ' determine if multiple files were selected\r\n   ' null delimiter is not inserted if only 1 file is selected\r\n   If countDelimiters(sFname, vbNullChar) = 1 Then\r\n      Do Until (iEndPath = 0)\r\n         iStart = iEndPath + 1\r\n         iEndPath = InStr(iEndPath + 1, sFname, \"\\\")\r\n      Loop\r\n      ReDim Preserve FileNames(0)\r\n      ' determine if root directory was selected - preserve the \"\\\"\r\n      If countDelimiters(sFname, \"\\\") = 1 Then\r\n         FileNames(0) = Mid(sFname, 1, iStart - 1)\r\n      Else\r\n         FileNames(0) = Mid(sFname, 1, iStart - 2)\r\n      End If\r\n   Else\r\n      iStart = InStr(1, sFname, vbNullChar) + 1\r\n      ReDim Preserve FileNames(0)\r\n      FileNames(0) = Left(sFname, iStart - 2)\r\n   End If\r\n\r\n   intIndex = 1\r\n   For I = iStart To Len(sFname)\r\n      If Mid(sFname, I, 1) = vbNullChar Then\r\n        ReDim Preserve FileNames(intIndex)\r\n        FileNames(intIndex) = Mid(sFname, iStart, I - iStart)\r\n        iStart = I + 1\r\n        intIndex = intIndex + 1\r\n      End If\r\n   Next I\r\n\r\n   ' display information in proper text box\r\n   For I = 0 To UBound(FileNames)\r\n      If I Then\r\n         Text2.Text = Text2.Text & FileNames(I) & vbCrLf\r\n      Else\r\n         Text1.Text = FileNames(I)\r\n      End If\r\n   Next I\r\n\r\nEnd Sub\r\n\r\nFunction countDelimiters(ByVal sFiles As String, _\r\n      ByVal vSearchChar As Variant) As Integer\r\n\r\n    Dim iCtr As Integer\r\n    Dim iResult As Integer\r\n\r\n    For iCtr = 1 To Len(sFiles)\r\n        If Mid(sFiles, iCtr, 1) = vSearchChar Then iResult = iResult + 1\r\n    Next iCtr\r\n\r\n    countDelimiters = iResult\r\n\r\nEnd Function","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Common Dialog","File Open"]},{"RecordId":"283","Title":"XML Samples","Description":"Various info on XML","Code":"Dim xml As DOMDocument\r\n\r\nSet xml = New DOMDocument\r\nCall xml.Load(App.Path & \"\\CPerson.xml\")\r\n\r\nDim root As IXMLDOMNode\r\nSet root = xml.documentElement\r\n\r\nDim node As IXMLDOMNode\r\nFor Each node In root.childNodes\r\n\tDebug.Print node.Text\r\nNext\r\n\r\nNote that the Text property for each node also contains all the text for that node's children. You don't have to work with all the nodes at the same time. You can get a reference to a specific subset of nodes using the selectNodes method. The selectNodes method returns an IXMLDOMNodeList object. Add this code to the end of the cmdLoad_Click() event: \r\n\r\nDim propertyNodes As IXMLDOMNodeList\r\nSet propertyNodes = root.selectNodes _\r\n\t(\"property\")\r\nFor Each node In propertyNodes\r\n\tDebug.Print node.selectSingleNode _\r\n\t\t(\"scope\").Text & \" \" & _\r\n\t\tnode.selectSingleNode _\r\n\t\t(\"propertyType\").Text & \" \" & _\r\n\t\tnode.selectSingleNode _\r\n\t\t(\"name\").Text\r\nNext\r\n\r\nThe preceding code selects all the nodes in the document, then uses the selectSingleNode method to print the text of the scope, propertyType, and name nodes. \r\n\r\n\r\nUpdate Node Values\r\nYou can update the value of any node, just like a database. Just change the text property for that node: \r\n\r\nSet node = root.selectSingleNode _\r\n\t(\"name\")\r\nIf Not node Is Nothing Then\r\n\tnode.Text = \"CPersonObject\"\r\nEnd If\r\n\r\n\r\nFinally, you can save the file using the Save method. The Save method can save an XML file to a file, a stream, or the ASP Response object (which is the method you use to write XML to a browser): \r\n\r\nxml.save App.Path & _\r\n\t\"CPersonObject.xml\"\r\n\r\nAdd the code from the preceding two examples to the end of the cmdLoad_Click() event and run the program again. This time, you should find a new file called CPersonObject.xml in your application directory. If you view the file in IE, you'll see that the name tag text is now CPersonObject.","Declares":"","CodeCategory":{"CategoryId":"8","CategoryDescription":"XML"},"Keywords":["XML"]},{"RecordId":"284","Title":"Get App.Path for a UserControl","Description":"Determines the App.Path of the application that hosts a user contol (ocx).","Code":"Private Sub UserControl_Paint()\r\n\r\n    Dim AppPath As String\r\n    Const MAX_PATH = 260\r\n    \r\n    UserControl.Cls\r\n    AppPath = Space$(MAX_PATH)\r\n    If GetModuleFileName(0, AppPath, Len(AppPath)) Then\r\n        AppPath = Left$(AppPath, InStr(AppPath, vbNullChar) - 1)\r\n        UserControl.Print AppPath\r\n    Else\r\n        UserControl.Print \"FUBAR\"\r\n    End If\r\n\r\nEnd Sub\r\n","Declares":"Private Declare Function GetModuleFileName _\r\n    Lib \"kernel32\" Alias \"GetModuleFileNameA\" _\r\n    (ByVal hModule As Long, _\r\n    ByVal lpFileName As String, _\r\n    ByVal nSize As Long) As Long\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["OCX","App.Path"]},{"RecordId":"285","Title":"Move Mouse to and Click a Control","Description":"Move the mouse cursor to, and/or click, any absolute location on screen.","Code":"Public Sub CursorClickAbs(ByVal X As Long, ByVal Y _\r\n\tAs Long)\r\n\t' X/Y need to be passed as pixels!\r\n\tConst meFlagsDn As Long = MOUSEEVENTF_ABSOLUTE Or _\r\n\t\tMOUSEEVENTF_LEFTDOWN\r\n\tConst meFlagsUp As Long = MOUSEEVENTF_ABSOLUTE Or _\r\n\t\tMOUSEEVENTF_LEFTUP\r\n\r\n\t' Move cursor to destination, first.\r\n\tCall CursorMoveAbs(X, Y)\r\n\r\n\t' Map into same coordinate space used by mouse_event.\r\n\tX = (X / GetSystemMetrics(SM_CXSCREEN)) * &HFFFF&\r\n\tY = (Y / GetSystemMetrics(SM_CYSCREEN)) * &HFFFF&\r\n\r\n\t' Click the mouse, with delay to simulate human \r\n\t' timing.\r\n\tCall mouse_event(meFlagsDn, X, Y, 0, 0)\r\n\tDoEvents ' allow down position to paint\r\n\tCall Sleep(250)\r\n\tCall mouse_event(meFlagsUp, X, Y, 0, 0)\r\nEnd Sub\r\n\r\nPublic Sub CursorMoveAbs(ByVal X As Long, ByVal Y As _\r\n\tLong)\r\n\t' X/Y need to be passed as pixels!\r\n\tConst meFlags As Long = MOUSEEVENTF_ABSOLUTE Or _\r\n\t\tMOUSEEVENTF_MOVE\r\n\r\n\t' Map into same coordinate space used by mouse_event.\r\n\tX = (X / GetSystemMetrics(SM_CXSCREEN)) * &HFFFF&\r\n\tY = (Y / GetSystemMetrics(SM_CYSCREEN)) * &HFFFF&\r\n\r\n\t' Move the cursor to destination.\r\n\tCall mouse_event(meFlags, X, Y, 0, 0)\r\nEnd Sub\r\n\r\nPublic Sub CursorMoveCntl(ByVal ctl As Control)\r\n\tDim r As RECT, X As Long, Y As Long\r\n\r\n\t' Place origin in center of control.\r\n\tCall GetWindowRect(ctl.hWnd, r)\r\n\tX = r.Left + ((r.Right - r.Left) \\ 2)\r\n\tY = r.Top + ((r.Bottom - r.Top) \\ 2)\r\n\tCall CursorMoveAbs(X, Y)\r\nEnd Sub\r\n\r\n\r\n","Declares":"Private Declare Sub mouse_event Lib \"user32\" (ByVal _\r\n\tdwFlags As Long, ByVal dX As Long, ByVal dY As Long, _\r\n\tByVal dwData As Long, ByVal dwExtraInfo As Long)\r\nPrivate Declare Function GetWindowRect Lib \"user32\" _\r\n\t(ByVal hWnd As Long, lpRect As RECT) As Long\r\nPrivate Declare Function GetSystemMetrics Lib \"user32\" _\r\n\t(ByVal nIndex As Long) As Long\r\nPrivate Declare Sub Sleep Lib \"kernel32\" (ByVal _\r\n\tdwMilliseconds As Long)\r\n\r\n' API structure definition for Rectangle\r\nPrivate Type RECT\r\n\tLeft As Long\r\n\tTop As Long\r\n\tRight As Long\r\n\tBottom As Long\r\nEnd Type\r\n\r\nPrivate Const MOUSEEVENTF_ABSOLUTE = &H8000\r\n\t' absolute move\r\nPrivate Const MOUSEEVENTF_LEFTDOWN = &H2\r\n\t' left button down\r\nPrivate Const MOUSEEVENTF_LEFTUP = &H4\r\n\t' left button up\r\nPrivate Const MOUSEEVENTF_MIDDLEDOWN = &H20\r\n\t' middle button down\r\nPrivate Const MOUSEEVENTF_MIDDLEUP = &H40\r\n\t' middle button up\r\nPrivate Const MOUSEEVENTF_MOVE = &H1\r\n\t' mouse move\r\nPrivate Const MOUSEEVENTF_RIGHTDOWN = &H8\r\n\t' right button down\r\nPrivate Const MOUSEEVENTF_RIGHTUP = &H10\r\n\t' right button up\r\nPrivate Const MOUSEEVENTF_WHEEL = &H800\r\n\t' wheel button rolled\r\n\r\n' GetSystemMetrics() codes\r\nPrivate Const SM_CXSCREEN = 0\r\nPrivate Const SM_CYSCREEN = 1\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Mouse Control","Mouse Click"]},{"RecordId":"286","Title":"Icon Programming in the System Tray (Preferred)","Description":"Demonstrates how to build an application that uses an icon in the system tray.","Code":"' create a form named Form1\r\n' add a commond dialog control named CommonDialog1\r\n' add two command buttons named Command1 and Command2\r\n\r\nPrivate Sub Command1_Click()\r\n   'Click this button to add an icon to the taskbar status area.\r\n\r\n   'Set the individual values of the NOTIFYICONDATA data type.\r\n   nid.cbSize = Len(nid)\r\n   nid.hWnd = Form1.hWnd\r\n   nid.uId = vbNull\r\n   nid.uFlags = NIF_ICON Or NIF_TIP Or NIF_MESSAGE\r\n   nid.uCallBackMessage = WM_MOUSEMOVE\r\n   nid.hIcon = Form1.Icon\r\n   nid.szTip = \"Taskbar Status Area Sample Program\" & vbNullChar\r\n\r\n   'Call the Shell_NotifyIcon function to add the icon to the taskbar\r\n   'status area.\r\n   Shell_NotifyIcon NIM_ADD, nid\r\nEnd Sub\r\n\r\nPrivate Sub Command2_Click()\r\n   'Click this button to delete the added icon from the taskbar\r\n   'status area by calling the Shell_NotifyIcon function.\r\n   Shell_NotifyIcon NIM_DELETE, nid\r\nEnd Sub\r\n\r\nPrivate Sub Form_Load()\r\n   'Set the captions of the command button when the form loads.\r\n   Command1.Caption = \"Add an Icon\"\r\n   Command2.Caption = \"Delete Icon\"\r\nEnd Sub\r\n\r\nPrivate Sub Form_Terminate()\r\n   'Delete the added icon from the taskbar status area when the\r\n   'program ends.\r\n   Shell_NotifyIcon NIM_DELETE, nid\r\nEnd Sub\r\n\r\nPrivate Sub Form_MouseMove _\r\n   (Button As Integer, _\r\n    Shift As Integer, _\r\n    X As Single, _\r\n    Y As Single)\r\n    'Event occurs when the mouse pointer is within the rectangular\r\n    'boundaries of the icon in the taskbar status area.\r\n    Dim msg As Long\r\n    Dim sFilter As String\r\n    msg = X / Screen.TwipsPerPixelX\r\n    Select Case msg\r\n       Case WM_LBUTTONDOWN\r\n       Case WM_LBUTTONUP\r\n       Case WM_LBUTTONDBLCLK\r\n       CommonDialog1.DialogTitle = \"Select an Icon\"\r\n       sFilter = \"Icon Files (*.ico)|*.ico\"\r\n       sFilter = sFilter & \"|All Files (*.*)|*.*\"\r\n       CommonDialog1.Filter = sFilter\r\n       CommonDialog1.ShowOpen\r\n       If CommonDialog1.FileName <> \"\" Then\r\n          Form1.Icon = LoadPicture(CommonDialog1.FileName)\r\n          nid.hIcon = Form1.Icon\r\n          Shell_NotifyIcon NIM_MODIFY, nid\r\n       End If\r\n       Case WM_RBUTTONDOWN\r\n          Dim ToolTipString As String\r\n          ToolTipString = InputBox(\"Enter the new ToolTip:\", \"Change ToolTip\")\r\n          If ToolTipString <> \"\" Then\r\n             nid.szTip = ToolTipString & vbNullChar\r\n             Shell_NotifyIcon NIM_MODIFY, nid\r\n          End If\r\n       Case WM_RBUTTONUP\r\n       Case WM_RBUTTONDBLCLK\r\n    End Select\r\nEnd Sub","Declares":"Private Type NOTIFYICONDATA\r\n   cbSize As Long\r\n   hWnd As Long\r\n   uId As Long\r\n   uFlags As Long\r\n   uCallBackMessage As Long\r\n   hIcon As Long\r\n   szTip As String * 64\r\nEnd Type\r\n\r\n'The following constants are the messages sent to the\r\n'Shell_NotifyIcon function to add, modify, or delete an icon from the\r\n'taskbar status area.\r\nPrivate Const NIM_ADD = &H0\r\nPrivate Const NIM_MODIFY = &H1\r\nPrivate Const NIM_DELETE = &H2\r\n\r\n'The following constant is the message sent when a mouse event occurs\r\n'within the rectangular boundaries of the icon in the taskbar status\r\n'area.\r\nPrivate Const WM_MOUSEMOVE = &H200\r\n\r\n'The following constants are the flags that indicate the valid\r\n'members of the NOTIFYICONDATA data type.\r\nPrivate Const NIF_MESSAGE = &H1\r\nPrivate Const NIF_ICON = &H2\r\nPrivate Const NIF_TIP = &H4\r\n\r\n'The following constants are used to determine the mouse input on the\r\n'the icon in the taskbar status area.\r\n\r\n'Left-click constants.\r\nPrivate Const WM_LBUTTONDBLCLK = &H203   'Double-click\r\nPrivate Const WM_LBUTTONDOWN = &H201     'Button down\r\nPrivate Const WM_LBUTTONUP = &H202       'Button up\r\n\r\n'Right-click constants.\r\nPrivate Const WM_RBUTTONDBLCLK = &H206   'Double-click\r\nPrivate Const WM_RBUTTONDOWN = &H204     'Button down\r\nPrivate Const WM_RBUTTONUP = &H205       'Button up\r\n\r\n'Declare the API function call.\r\nPrivate Declare Function Shell_NotifyIcon Lib \"shell32\" Alias \"Shell_NotifyIconA\" (ByVal dwMessage As Long, pnid As NOTIFYICONDATA) As Boolean\r\n\r\n'Dimension a variable as the user-defined data type.\r\nDim nid As NOTIFYICONDATA","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Icon Tray","System Tray","Tray"]},{"RecordId":"287","Title":"Hide and Show Windows Task Bar","Description":"Hides and shows Windows task bar","Code":"Public Sub SetStartButton(blnHide As Boolean)\r\n\r\nDim lngRetVal As Long\r\nDim lngStartWindow As Long\r\nDim strClassName As String\r\n\r\nstrClassName = Space(256)\r\nstrClassName = \"Shell_TrayWnd\"\r\n\r\nlngStartWindow = FindWindow(strClassName, vbNullString)\r\n\r\nIf blnHide Then\r\n    lngRetVal = ShowWindow(lngStartWindow, SW_HIDE)\r\nElse\r\n    lngRetVal = ShowWindow(lngStartWindow, SW_SHOWNORMAL)\r\nEnd If\r\n\r\nEnd Sub\r\n","Declares":"Public Declare Function FindWindow Lib \"user32\" Alias \"FindWindowA\" (ByVal lpClassName As String, ByVal lpWindowName As String) As Long\r\nPublic Declare Function ShowWindow Lib \"user32\" (ByVal hWnd As Long, ByVal nCmdShow As Long) As Long\r\n\r\nConst SW_HIDE = 0\r\nConst SW_SHOWNORMAL = 1\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Task Bar","Start Button"]},{"RecordId":"288","Title":"Cross-Tab Query in SQL Server (1)","Description":"Demonstrates how to create the equivalent of an Access cross-tab query.","Code":"SELECT SalesAgent,\r\nSUM( CASE Country WHEN 'USA' THEN Amount ELSE 0 END) AS 'T_USA',\r\nSUM( CASE Country WHEN 'Germany' THEN Amount ELSE 0 END) AS 'T_Germany',\r\nSUM( CASE Country WHEN 'France' THEN Amount ELSE 0 END) AS 'T_France',\r\nSUM(Amount) AS 'T_Amount'\r\nFROM Sales\r\nWHERE(...)\r\nGROUP BY SalesAgent\r\n\r\nAssumes a table such as:\r\nSalesAgent\r\nCountry\r\nAmount","Declares":"","CodeCategory":{"CategoryId":"6","CategoryDescription":"T-SQL"},"Keywords":["Cross-tab query","Cross Tab","SQL Server"]},{"RecordId":"289","Title":"Timer (Using API)","Description":"Create timer using API (does not require a form)\r\n","Code":"Public Sub StartTimer(lngInterval As Long)\r\n   lngTimerID = SetTimer(0, 0, lngInterval, AddressOf TimerEvent)\r\nEnd Sub\r\n\r\nPublic Sub StopTimer()\r\n  If lngTimerID >= 0 Then\r\n    KillTimer 0, lngTimerID\r\n    lngTimerID = 0\r\n  End If\r\nEnd Sub\r\n\r\nPrivate Sub TimerEvent(ByVal hwnd As Long, ByVal msg As Long, ByVal idEvent As Long, ByVal curTime As Long)\r\n    Debug.Print \"Event fired at: \" & CStr(curTime)\r\nEnd Sub\r\n\r\n","Declares":"Declare Function SetTimer Lib \"user32\" (ByVal hwnd As Long, ByVal nIDEvent As Long, ByVal uElapse As Long, ByVal lpTimerFunc As Long) As Long\r\n\r\nDeclare Function KillTimer Lib \"user32\" (ByVal hwnd As Long, ByVal nIDEvent As Long) As Long\r\n\r\nPrivate lngTimerID As Long\r\n\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Timer"]},{"RecordId":"290","Title":"Determining Installed Version","Description":"How to determine the currently installed version of ADO","Code":"Locate the following registry key:\r\n\r\nHKEY_CLASSES_ROOT\r\n   ADODB.Connection\r\n      CurVer\r\n\r\n\r\n\r\nExample value:   \"ADODB.Connection.2.5\"","Declares":"","CodeCategory":{"CategoryId":"3","CategoryDescription":"Database"},"Keywords":["ADO"]},{"RecordId":"291","Title":"Generate GUID in SQL Server","Description":"Stored Procedure for generating a GUID","Code":"CREATE PROCEDURE prAPP_Insert_Session\r\nAS\r\n    SET NOCOUNT ON\r\n    DECLARE @sKey UNIQUEIDENTIFIER\r\n    SET @sKey = NEWID()\r\n    INSERT tblSession (sSessionKey, dtLastAccessDateTime) VALUES\r\n                      (@sKey, getdate())\r\n    SELECT @sKey\r\nGO\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"6","CategoryDescription":"T-SQL"},"Keywords":["GUID","State","SQL Server"]},{"RecordId":"292","Title":"Get Internet Name From Global Address Book","Description":"Retrieves Internet Name for members of global address list","Code":"'----------------------------------------------------\r\n' NOTE:  Assumes that you've already picked members from the address book dialog\r\n'----------------------------------------------------\r\n\r\n    Dim objMapi As Object\r\n    Dim objRecipients As Object\r\n    Dim lngRecipientsCount As Long\r\n    Dim i As Integer\r\n    Dim strInternetName As String\r\n    \r\n    Set objMapi = CreateObject(\"MAPI.Session\")\r\n    objMapi.Logon\r\n    \r\n    Set objRecipients = objMapi.AddressBook\r\n    lngRecipientsCount = objRecipients.Count\r\n    For i = 1 To lngRecipientsCount\r\n        strInternetName = objRecipients.Item(i).AddressEntry.Fields(&H39FE001E).Value\r\n        Debug.Print strInternetName\r\n    Next\r\n    \r\n    Set objRecipients = Nothing\r\n    Set objMapi = Nothing\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["CDO","Global Address List","Internet Name"]},{"RecordId":"293","Title":"Change Form Border, Tile Bar, Control Box, etc.","Description":"Examples of how to change a form border, min-max-ctl buttons, caption/title bar, etc at run time.  These are typically design-time properties.","Code":"' *********************************************************************\r\n'  This sample consists of two parts.  \r\n'  1.  The class module that actually changes the form properties with SendMessage API.\r\n'  2.  The form that calls the class module to.\r\n'  \r\n' *********************************************************************\r\n\r\n' *********************************************************************\r\n'  1.  The class module that actually changes the form properties with SendMessage API.\r\n' *********************************************************************\r\n\r\nOption Explicit\r\n\r\n' Win32 APIs used to toggle border styles.\r\nPrivate Declare Function GetWindowLong Lib \"user32\" Alias \"GetWindowLongA\" (ByVal hWnd As Long, ByVal nIndex As Long) As Long\r\nPrivate Declare Function SetWindowLong Lib \"user32\" Alias \"SetWindowLongA\" (ByVal hWnd As Long, ByVal nIndex As Long, ByVal dwNewLong As Long) As Long\r\nPrivate Declare Function SetWindowPos Lib \"user32\" (ByVal hWnd As Long, ByVal hWndInsertAfter As Long, ByVal x As Long, ByVal y As Long, ByVal cx As Long, ByVal cy As Long, ByVal wFlags As Long) As Long\r\n\r\n' Win32 APIs used to automate drag and sysmenu support.\r\nPrivate Declare Function SendMessage Lib \"user32\" Alias \"SendMessageA\" (ByVal hWnd As Long, ByVal wMsg As Long, ByVal wParam As Long, lParam As Any) As Long\r\nPrivate Declare Function ReleaseCapture Lib \"user32\" () As Long\r\nPrivate Declare Function GetCursorPos Lib \"user32\" (lpPoint As POINTAPI) As Long\r\n\r\nPrivate Type POINTAPI\r\n   x As Long\r\n   y As Long\r\nEnd Type\r\n\r\n' Used to support captionless drag\r\nPrivate Const WM_NCLBUTTONDOWN = &HA1\r\nPrivate Const HTCAPTION = 2\r\n\r\n' Undocumented message constant.\r\nPrivate Const WM_GETSYSMENU = &H313\r\n\r\n' Used to get window style bits.\r\nPrivate Const GWL_STYLE = (-16)\r\nPrivate Const GWL_EXSTYLE = (-20)\r\n\r\n' Style bits.\r\nPrivate Const WS_MAXIMIZEBOX = &H10000\r\nPrivate Const WS_MINIMIZEBOX = &H20000\r\nPrivate Const WS_THICKFRAME = &H40000\r\nPrivate Const WS_SYSMENU = &H80000\r\nPrivate Const WS_CAPTION = &HC00000\r\n\r\n' Extended Style bits.\r\nPrivate Const WS_EX_TOPMOST = &H8\r\nPrivate Const WS_EX_TOOLWINDOW = &H80\r\nPrivate Const WS_EX_CONTEXTHELP = &H400\r\n\r\n' Force total redraw that shows new styles.\r\nPrivate Const SWP_FRAMECHANGED = &H20\r\nPrivate Const SWP_NOMOVE = &H2\r\nPrivate Const SWP_NOZORDER = &H4\r\nPrivate Const SWP_NOSIZE = &H1\r\n\r\n' Used to toggle into topmost layer.\r\nPrivate Const HWND_TOPMOST = -1\r\nPrivate Const HWND_NOTOPMOST = -2\r\n\r\n' References to client form.\r\nPrivate WithEvents m_Client As Form\r\nPrivate m_hWnd As Long\r\n\r\n' Member variables\r\nPrivate m_AutoSysMenu As Boolean\r\nPrivate m_AutoDrag As Boolean\r\n\r\n' ************************************************\r\n'  Initialize/Terminate\r\n' ************************************************\r\nPrivate Sub Class_Initialize()\r\n   '\r\nEnd Sub\r\n\r\nPrivate Sub Class_Terminate()\r\n   '\r\nEnd Sub\r\n\r\n' ************************************************\r\n'  Sunken Client Events\r\n' ************************************************\r\nPrivate Sub m_Client_MouseDown(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n   ' Automatically allow user to drag using\r\n   ' any portion of form, not just titlebar,\r\n   ' when user depresses left mousebutton.\r\n   ' Useful for captionless forms.\r\n   If Button = vbLeftButton Then\r\n      If m_AutoDrag Then\r\n         Call ReleaseCapture\r\n         Call SendMessage(m_hWnd, WM_NCLBUTTONDOWN, HTCAPTION, ByVal 0&)\r\n      End If\r\n   End If\r\nEnd Sub\r\n\r\nPrivate Sub m_Client_MouseUp(Button As Integer, Shift As Integer, x As Single, y As Single)\r\n   ' Automatically handle system menu display\r\n   ' when user right-clicks anywhere on form.\r\n   ' Useful for captionless forms.\r\n   Dim pt As POINTAPI\r\n   ' This is relative to the screen, so we can't\r\n   ' use the coordinates passed in the event\r\n   Call GetCursorPos(pt)\r\n   If Button = vbRightButton Then\r\n      If m_AutoSysMenu Then\r\n         Call ShowSysMenu(pt.x, pt.y)\r\n      End If\r\n   End If\r\nEnd Sub\r\n\r\n' ************************************************\r\n'  Public Properties: Read/Write\r\n' ************************************************\r\nPublic Property Let AutoDrag(ByVal Value As Boolean)\r\n   ' Automatically allow user to drag using\r\n   ' any portion of form, not just titlebar,\r\n   ' when user depresses left mousebutton.\r\n   ' Useful for captionless forms.\r\n   m_AutoDrag = Value\r\nEnd Property\r\n\r\nPublic Property Get AutoDrag() As Boolean\r\n   AutoDrag = m_AutoDrag\r\nEnd Property\r\n\r\nPublic Property Let AutoSysMenu(ByVal Value As Boolean)\r\n   ' Automatically handle system menu display\r\n   ' when user right-clicks anywhere on form.\r\n   ' Useful for captionless forms.\r\n   m_AutoSysMenu = True\r\nEnd Property\r\n\r\nPublic Property Get AutoSysMenu() As Boolean\r\n   AutoSysMenu = m_AutoSysMenu\r\nEnd Property\r\n\r\nPublic Property Set Client(ByVal obj As Form)\r\n   ' Store reference to client.\r\n   Set m_Client = obj\r\n   ' Cache hWnd as it'll be accessed frequently.\r\n   If m_Client Is Nothing Then\r\n      m_hWnd = 0\r\n   Else\r\n      m_hWnd = m_Client.hWnd\r\n   End If\r\nEnd Property\r\n\r\nPublic Property Get Client() As Form\r\n   ' Return reference to client.\r\n   Set Client = m_Client\r\nEnd Property\r\n\r\nPublic Property Let ControlBox(ByVal Value As Boolean)\r\n   ' Set WS_SYSMENU On or Off as requested.\r\n   Call FlipBit(WS_SYSMENU, Value)\r\nEnd Property\r\n\r\nPublic Property Get ControlBox() As Boolean\r\n   ' Return value of WS_SYSMENU bit.\r\n   ControlBox = CBool(Style And WS_SYSMENU)\r\nEnd Property\r\n\r\nPublic Property Let MaxButton(ByVal Value As Boolean)\r\n   ' Set WS_MAXIMIZEBOX On or Off as requested.\r\n   Call FlipBit(WS_MAXIMIZEBOX, Value)\r\nEnd Property\r\n\r\nPublic Property Get MaxButton() As Boolean\r\n   ' Return value of WS_MAXIMIZEBOX bit.\r\n   MaxButton = CBool(Style And WS_MAXIMIZEBOX)\r\nEnd Property\r\n\r\nPublic Property Let MinButton(ByVal Value As Boolean)\r\n   ' Set WS_MINIMIZEBOX On or Off as requested.\r\n   Call FlipBit(WS_MINIMIZEBOX, Value)\r\nEnd Property\r\n\r\nPublic Property Get MinButton() As Boolean\r\n   ' Return value of WS_MINIMIZEBOX bit.\r\n   MinButton = CBool(Style And WS_MINIMIZEBOX)\r\nEnd Property\r\n\r\nPublic Property Let Sizable(ByVal Value As Boolean)\r\n   ' Set WS_THICKFRAME On or Off as requested.\r\n   Call FlipBit(WS_THICKFRAME, Value)\r\nEnd Property\r\n\r\nPublic Property Get Sizable() As Boolean\r\n   ' Return value of WS_THICKFRAME bit.\r\n   Sizable = CBool(Style And WS_THICKFRAME)\r\nEnd Property\r\n\r\nPublic Property Let Titlebar(ByVal Value As Boolean)\r\n   ' Set WS_CAPTION On or Off as requested.\r\n   Call FlipBit(WS_CAPTION, Value)\r\nEnd Property\r\n\r\nPublic Property Get Titlebar() As Boolean\r\n   ' Return value of WS_CAPTION bit.\r\n   Titlebar = CBool(Style And WS_CAPTION)\r\nEnd Property\r\n\r\nPublic Property Let ToolWindow(ByVal Value As Boolean)\r\n   ' Set WS_EX_TOOLWINDOW On or Off as requested.\r\n   Call FlipBitEx(WS_EX_TOOLWINDOW, Value)\r\nEnd Property\r\n\r\nPublic Property Get ToolWindow() As Boolean\r\n   ' Return value of WS_EX_TOOLWINDOW bit.\r\n   ToolWindow = CBool(StyleEx And WS_EX_TOOLWINDOW)\r\nEnd Property\r\n\r\nPublic Property Let TopMost(ByVal Value As Boolean)\r\n   Const swpFlags = SWP_NOMOVE Or SWP_NOSIZE\r\n   ' Unlike most style bits, WS_EX_TOPMOST must be\r\n   ' set with SetWindowPos rather than SetWindowLong.\r\n   If Value Then\r\n      Call SetWindowPos(m_hWnd, HWND_TOPMOST, 0, 0, 0, 0, swpFlags)\r\n   Else\r\n      Call SetWindowPos(m_hWnd, HWND_NOTOPMOST, 0, 0, 0, 0, swpFlags)\r\n   End If\r\n   ' Additional references on VB use of SetWindowPos...\r\n   ' BUG: SetWindowPos API Does Not Set Topmost Window in VB\r\n   ' -- http://support.microsoft.com/support/kb/articles/Q192/2/54.ASP\r\n   ' FIX: TopMost Window Does Not Stay on Top in Design Environment\r\n   ' -- http://support.microsoft.com/support/kb/articles/Q150/2/33.ASP\r\nEnd Property\r\n\r\nPublic Property Get TopMost() As Boolean\r\n   ' Return value of WS_EX_TOPMOST bit.\r\n   TopMost = CBool(StyleEx And WS_EX_TOPMOST)\r\nEnd Property\r\n\r\nPublic Property Let WhatsThisButton(ByVal Value As Boolean)\r\n   ' Set WS_EX_CONTEXTHELP On or Off as requested.\r\n   Call FlipBitEx(WS_EX_CONTEXTHELP, Value)\r\nEnd Property\r\n\r\nPublic Property Get WhatsThisButton() As Boolean\r\n   ' Return value of WS_EX_CONTEXTHELP bit.\r\n   WhatsThisButton = CBool(StyleEx And WS_EX_CONTEXTHELP)\r\nEnd Property\r\n\r\n' ************************************************\r\n'  Public Properties: Read-only\r\n' ************************************************\r\nPublic Property Get hWnd() As Long\r\n   hWnd = m_hWnd\r\nEnd Property\r\n\r\n' ************************************************\r\n'  Public Methods\r\n' ************************************************\r\nPublic Sub Redraw()\r\n   ' Redraw window with new style.\r\n   Const swpFlags As Long = _\r\n      SWP_FRAMECHANGED Or SWP_NOMOVE Or _\r\n      SWP_NOZORDER Or SWP_NOSIZE\r\n   SetWindowPos m_hWnd, 0, 0, 0, 0, 0, swpFlags\r\nEnd Sub\r\n\r\nPublic Sub ShowSysMenu(ByVal x As Long, ByVal y As Long)\r\n   ' Must be in screen coordinates.\r\n   Call SendMessage(m_hWnd, WM_GETSYSMENU, 0, ByVal MakeLong(y, x))\r\nEnd Sub\r\n\r\n' ************************************************\r\n'  Private Methods\r\n' ************************************************\r\nPrivate Function MakeLong(ByVal WordHi As Integer, ByVal WordLo As Integer) As Long\r\n   ' High word is coerced to Long to allow it to\r\n   ' overflow limits of multiplication which shifts\r\n   ' it left.\r\n   MakeLong = (CLng(WordHi) * &H10000) Or (WordLo And &HFFFF&)\r\nEnd Function\r\n\r\nPrivate Function Style(Optional ByVal NewBits As Long = 0) As Long\r\n   ' Attempt to set new style bits.\r\n   If NewBits Then\r\n      Call SetWindowLong(m_hWnd, GWL_STYLE, NewBits)\r\n   End If\r\n   ' Retrieve current style bits.\r\n   Style = GetWindowLong(m_hWnd, GWL_STYLE)\r\nEnd Function\r\n\r\nPrivate Function StyleEx(Optional ByVal NewBits As Long = 0) As Long\r\n   ' Attempt to set new style bits.\r\n   If NewBits Then\r\n      Call SetWindowLong(m_hWnd, GWL_EXSTYLE, NewBits)\r\n   End If\r\n   ' Retrieve current style bits.\r\n   StyleEx = GetWindowLong(m_hWnd, GWL_EXSTYLE)\r\nEnd Function\r\n\r\nPrivate Function FlipBit(ByVal Bit As Long, ByVal Value As Boolean) As Boolean\r\n   Dim nStyle As Long\r\n   \r\n   ' Retrieve current style bits.\r\n   nStyle = GetWindowLong(m_hWnd, GWL_STYLE)\r\n   \r\n   ' Attempt to set requested bit On or Off,\r\n   ' and redraw\r\n   If Value Then\r\n      nStyle = nStyle Or Bit\r\n   Else\r\n      nStyle = nStyle And Not Bit\r\n   End If\r\n   Call SetWindowLong(m_hWnd, GWL_STYLE, nStyle)\r\n   Call Redraw\r\n   \r\n   ' Return success code.\r\n   FlipBit = (nStyle = GetWindowLong(m_hWnd, GWL_STYLE))\r\nEnd Function\r\n\r\nPrivate Function FlipBitEx(ByVal Bit As Long, ByVal Value As Boolean) As Boolean\r\n   Dim nStyleEx As Long\r\n   \r\n   ' Retrieve current style bits.\r\n   nStyleEx = GetWindowLong(m_hWnd, GWL_EXSTYLE)\r\n   \r\n   ' Attempt to set requested bit On or Off,\r\n   ' and redraw.\r\n   If Value Then\r\n      nStyleEx = nStyleEx Or Bit\r\n   Else\r\n      nStyleEx = nStyleEx And Not Bit\r\n   End If\r\n   Call SetWindowLong(m_hWnd, GWL_EXSTYLE, nStyleEx)\r\n   Call Redraw\r\n   \r\n   ' Return success code.\r\n   FlipBitEx = (nStyleEx = GetWindowLong(m_hWnd, GWL_EXSTYLE))\r\nEnd Function\r\n\r\n' *********************************************************************\r\n'  2.  The form that uses the class module\r\n' *********************************************************************\r\nVERSION 5.00\r\nBegin VB.Form FBorderDemo \r\n   Caption         =   \"CFormBorder Demo\"\r\n   ClientHeight    =   4695\r\n   ClientLeft      =   60\r\n   ClientTop       =   345\r\n   ClientWidth     =   2940\r\n   LinkTopic       =   \"Form1\"\r\n   ScaleHeight     =   4695\r\n   ScaleWidth      =   2940\r\n   StartUpPosition =   3  'Windows Default\r\n   WhatsThisHelp   =   -1  'True\r\n   Begin VB.Frame Frame2 \r\n      Caption         =   \"Caption Messages\"\r\n      Height          =   1155\r\n      Left            =   120\r\n      TabIndex        =   8\r\n      Top             =   3360\r\n      Width           =   2655\r\n      Begin VB.CheckBox Check2 \r\n         Caption         =   \"Check2\"\r\n         Height          =   255\r\n         Index           =   1\r\n         Left            =   180\r\n         TabIndex        =   10\r\n         Top             =   660\r\n         Width           =   2175\r\n      End\r\n      Begin VB.CheckBox Check2 \r\n         Caption         =   \"Check2\"\r\n         Height          =   255\r\n         Index           =   0\r\n         Left            =   180\r\n         TabIndex        =   9\r\n         Top             =   360\r\n         Width           =   2175\r\n      End\r\n   End\r\n   Begin VB.Frame Frame1 \r\n      Caption         =   \"Window Style Bits\"\r\n      Height          =   2955\r\n      Left            =   120\r\n      TabIndex        =   0\r\n      Top             =   120\r\n      Width           =   2655\r\n      Begin VB.CheckBox Check1 \r\n         Caption         =   \"Check1\"\r\n         Height          =   255\r\n         Index           =   7\r\n         Left            =   240\r\n         TabIndex        =   11\r\n         Top             =   2460\r\n         Width           =   2175\r\n      End\r\n      Begin VB.CheckBox Check1 \r\n         Caption         =   \"Check1\"\r\n         Height          =   255\r\n         Index           =   6\r\n         Left            =   240\r\n         TabIndex        =   7\r\n         Top             =   2160\r\n         Width           =   2175\r\n      End\r\n      Begin VB.CheckBox Check1 \r\n         Caption         =   \"Check1\"\r\n         Height          =   255\r\n         Index           =   5\r\n         Left            =   240\r\n         TabIndex        =   6\r\n         Top             =   1860\r\n         Width           =   2175\r\n      End\r\n      Begin VB.CheckBox Check1 \r\n         Caption         =   \"Check1\"\r\n         Height          =   255\r\n         Index           =   4\r\n         Left            =   240\r\n         TabIndex        =   5\r\n         Top             =   1560\r\n         Width           =   2175\r\n      End\r\n      Begin VB.CheckBox Check1 \r\n         Caption         =   \"Check1\"\r\n         Height          =   255\r\n         Index           =   3\r\n         Left            =   240\r\n         TabIndex        =   4\r\n         Top             =   1260\r\n         Width           =   2175\r\n      End\r\n      Begin VB.CheckBox Check1 \r\n         Caption         =   \"Check1\"\r\n         Height          =   255\r\n         Index           =   2\r\n         Left            =   240\r\n         TabIndex        =   3\r\n         Top             =   960\r\n         Width           =   2175\r\n      End\r\n      Begin VB.CheckBox Check1 \r\n         Caption         =   \"Check1\"\r\n         Height          =   255\r\n         Index           =   1\r\n         Left            =   240\r\n         TabIndex        =   2\r\n         Top             =   660\r\n         Width           =   2175\r\n      End\r\n      Begin VB.CheckBox Check1 \r\n         Caption         =   \"Check1\"\r\n         Height          =   255\r\n         Index           =   0\r\n         Left            =   240\r\n         TabIndex        =   1\r\n         Top             =   360\r\n         Width           =   2175\r\n      End\r\n   End\r\nEnd\r\nAttribute VB_Name = \"FBorderDemo\"\r\nAttribute VB_GlobalNameSpace = False\r\nAttribute VB_Creatable = False\r\nAttribute VB_PredeclaredId = True\r\nAttribute VB_Exposed = False\r\n\r\nOption Explicit\r\n\r\n' Control array indices\r\nPrivate Const chkTitlebar = 0\r\nPrivate Const chkSizable = 1\r\nPrivate Const chkControlBox = 2\r\nPrivate Const chkMinButton = 3\r\nPrivate Const chkMaxButton = 4\r\nPrivate Const chkWhatsThis = 5\r\nPrivate Const chkToolWindow = 6\r\nPrivate Const chkTopMost = 7\r\n\r\nPrivate Const chkAutoSysMenu = 0\r\nPrivate Const chkAutoDrag = 1\r\n\r\n' Border handler class\r\nPrivate m_bdr As CFormBorder\r\n\r\n' Flag to ignore click\r\nPrivate m_Ignore As Boolean\r\n\r\nPrivate Sub Check1_Click(Index As Integer)\r\n   Dim nValue As Boolean\r\n   ' Bail if being set programatically\r\n   If Not m_Ignore Then\r\n      ' Get new value\r\n      nValue = CBool(Check1(Index).Value)\r\n      ' Set appropriate style bit\r\n      Select Case Index\r\n         Case chkTitlebar\r\n            m_bdr.Titlebar = nValue\r\n         Case chkSizable\r\n            m_bdr.Sizable = nValue\r\n         Case chkControlBox\r\n            m_bdr.ControlBox = nValue\r\n         Case chkMinButton\r\n            m_bdr.MinButton = nValue\r\n         Case chkMaxButton\r\n            m_bdr.MaxButton = nValue\r\n         Case chkWhatsThis\r\n            m_bdr.WhatsThisButton = nValue\r\n         Case chkToolWindow\r\n            m_bdr.ToolWindow = nValue\r\n         Case chkTopMost\r\n            m_bdr.TopMost = nValue\r\n      End Select\r\n      ' Update display of styles set\r\n      Call UpdateStyleboxes\r\n   End If\r\nEnd Sub\r\n\r\nPrivate Sub Check2_Click(Index As Integer)\r\n   Dim nValue As Boolean\r\n   ' Bail if being set programatically\r\n   If Not m_Ignore Then\r\n      ' Get new value\r\n      nValue = CBool(Check2(Index).Value)\r\n      ' Set appropriate behavior mode\r\n      Select Case Index\r\n         Case chkAutoSysMenu\r\n            m_bdr.AutoSysMenu = nValue\r\n         Case chkAutoDrag\r\n            m_bdr.AutoDrag = nValue\r\n      End Select\r\n   End If\r\nEnd Sub\r\n\r\nPrivate Sub Form_Load()\r\n   ' Set up border style class.\r\n   Set m_bdr = New CFormBorder\r\n   Set m_bdr.Client = Me\r\n   \r\n   ' Label checkboxes\r\n   Check1(chkTitlebar).Caption = \"WS_CAPTION\"\r\n   Check1(chkTitlebar).ToolTipText = \"Toggles titlebar on/off.\"\r\n   Check1(chkSizable).Caption = \"WS_THICKFRAME\"\r\n   Check1(chkSizable).ToolTipText = \"Toggles whether or not form is sizable.\"\r\n   Check1(chkControlBox).Caption = \"WS_SYSMENU\"\r\n   Check1(chkControlBox).ToolTipText = \"Toggles (normally read-only at runtime) ControlBox property.\"\r\n   Check1(chkMinButton).Caption = \"WS_MINIMIZEBOX\"\r\n   Check1(chkMinButton).ToolTipText = \"Toggles (normally read-only at runtime) MinButton property.\"\r\n   Check1(chkMaxButton).Caption = \"WS_MAXIMIZEBOX\"\r\n   Check1(chkMaxButton).ToolTipText = \"Toggles (normally read-only at runtime) MaxButton property.\"\r\n   Check1(chkWhatsThis).Caption = \"WS_EX_CONTEXTHELP\"\r\n   Check1(chkWhatsThis).ToolTipText = \"Toggles (normally read-only at runtime) WhatsThisButton property. Only works when MinButton and MaxButton are False.\"\r\n   Check1(chkToolWindow).Caption = \"WS_EX_TOOLWINDOW\"\r\n   Check1(chkToolWindow).ToolTipText = \"A tool window has a title bar that is shorter than a normal title bar, and the window title is drawn using a smaller font.\"\r\n   Check1(chkTopMost).Caption = \"WS_EX_TOPMOST\"\r\n   Check1(chkTopMost).ToolTipText = \"Toggles whether or not window is in topmost layer.\"\r\n   \r\n   Check2(chkAutoSysMenu).Caption = \"SysMenu Anywhere\"\r\n   Check2(chkAutoSysMenu).ToolTipText = \"When checked, right-click anywhere on form brings up system menu.\"\r\n   Check2(chkAutoDrag).Caption = \"Drag Anywhere\"\r\n   Check2(chkAutoDrag).ToolTipText = \"When checked, user may drag form by depressing left mouse button anywhere on form.\"\r\n   \r\n   ' Assign initial checkbox values\r\n   Call UpdateStyleboxes\r\n   \r\n   ' Replace default icon with Windows flag.\r\n   ' Not needed, but nicer.\r\n   Set Me.Icon = Nothing\r\nEnd Sub\r\n\r\nPrivate Sub UpdateStyleboxes()\r\n   ' Set flag to ignore ensuing \"Click\"\r\n   m_Ignore = True\r\n      ' Assign checkbox values\r\n      Check1(chkTitlebar).Value = Abs(m_bdr.Titlebar)\r\n      Check1(chkSizable).Value = Abs(m_bdr.Sizable)\r\n      Check1(chkControlBox).Value = Abs(m_bdr.ControlBox)\r\n      Check1(chkMinButton).Value = Abs(m_bdr.MinButton)\r\n      Check1(chkMaxButton).Value = Abs(m_bdr.MaxButton)\r\n      Check1(chkToolWindow).Value = Abs(m_bdr.ToolWindow)\r\n      Check1(chkTopMost).Value = Abs(m_bdr.TopMost)\r\n      Check2(chkAutoSysMenu).Value = Abs(m_bdr.AutoSysMenu)\r\n      Check2(chkAutoDrag).Value = Abs(m_bdr.AutoDrag)\r\n   m_Ignore = False\r\nEnd Sub","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Border","Caption Bar","Title Bar"]},{"RecordId":"294","Title":"Set Default Printer","Description":"Displays list of printers and allows sets the default print to the one selected","Code":"'----------------------------------------------------------------------------------------------\r\n' Assumes a form with a listbox named List1 and a command button named Command1.\r\n'----------------------------------------------------------------------------------------------\r\n\r\nPrivate Sub Form_Load()\r\n    Dim r As Long\r\n    Dim Buffer As String\r\n\r\n    ' Get the list of available printers from WIN.INI\r\n    Buffer = Space(8192)\r\n    r = GetProfileString(\"PrinterPorts\", vbNullString, \"\", _\r\n       Buffer, Len(Buffer))\r\n\r\n    ' Display the list of printer in the ListBox List1\r\n    ParseList List1, Buffer\r\nEnd Sub\r\n\r\nPrivate Sub Command1_Click()\r\n    Dim osinfo As OSVERSIONINFO\r\n    Dim retvalue As Integer\r\n\r\n    osinfo.dwOSVersionInfoSize = 148\r\n    osinfo.szCSDVersion = Space$(128)\r\n    retvalue = GetVersionExA(osinfo)\r\n\r\n    If osinfo.dwPlatformId = VER_PLATFORM_WIN32_WINDOWS Then\r\n        Call Win95SetDefaultPrinter\r\n    Else\r\n    ' This assumes that future versions of Windows use the NT method\r\n        Call WinNTSetDefaultPrinter\r\n    End If\r\nEnd Sub\r\n\r\nPrivate Function PtrCtoVbString(Add As Long) As String\r\n    Dim sTemp As String * 512, x As Long\r\n\r\n    x = lstrcpy(sTemp, Add)\r\n    If (InStr(1, sTemp, Chr(0)) = 0) Then\r\n         PtrCtoVbString = \"\"\r\n    Else\r\n         PtrCtoVbString = Left(sTemp, InStr(1, sTemp, Chr(0)) - 1)\r\n    End If\r\nEnd Function\r\n\r\nPrivate Sub SetDefaultPrinter(ByVal PrinterName As String, _\r\n    ByVal DriverName As String, ByVal PrinterPort As String)\r\n    Dim DeviceLine As String\r\n    Dim r As Long\r\n    Dim l As Long\r\n    DeviceLine = PrinterName & \",\" & DriverName & \",\" & PrinterPort\r\n    ' Store the new printer information in the [WINDOWS] section of\r\n    ' the WIN.INI file for the DEVICE= item\r\n    r = WriteProfileString(\"windows\", \"Device\", DeviceLine)\r\n    ' Cause all applications to reload the INI file:\r\n    l = SendMessage(HWND_BROADCAST, WM_WININICHANGE, 0, \"windows\")\r\nEnd Sub\r\n\r\nPrivate Sub Win95SetDefaultPrinter()\r\n    Dim Handle As Long          'handle to printer\r\n    Dim PrinterName As String\r\n    Dim pd As PRINTER_DEFAULTS\r\n    Dim x As Long\r\n    Dim need As Long            ' bytes needed\r\n    Dim pi5 As PRINTER_INFO_5   ' your PRINTER_INFO structure\r\n    Dim LastError As Long\r\n\r\n    ' determine which printer was selected\r\n    PrinterName = List1.List(List1.ListIndex)\r\n    ' none - exit\r\n    If PrinterName = \"\" Then\r\n        Exit Sub\r\n    End If\r\n\r\n    ' set the PRINTER_DEFAULTS members\r\n    pd.pDatatype = 0&\r\n    pd.DesiredAccess = PRINTER_ALL_ACCESS Or pd.DesiredAccess\r\n\r\n    ' Get a handle to the printer\r\n    x = OpenPrinter(PrinterName, Handle, pd)\r\n    ' failed the open\r\n    If x = False Then\r\n        'error handler code goes here\r\n        Exit Sub\r\n    End If\r\n\r\n    ' Make an initial call to GetPrinter, requesting Level 5\r\n    ' (PRINTER_INFO_5) information, to determine how many bytes\r\n    ' you need\r\n    x = GetPrinter(Handle, 5, ByVal 0&, 0, need)\r\n    ' don't want to check Err.LastDllError here - it's supposed\r\n    ' to fail\r\n    ' with a 122 - ERROR_INSUFFICIENT_BUFFER\r\n    ' redim t as large as you need\r\n    ReDim t((need \\ 4)) As Long\r\n\r\n    ' and call GetPrinter for keepers this time\r\n    x = GetPrinter(Handle, 5, t(0), need, need)\r\n    ' failed the GetPrinter\r\n    If x = False Then\r\n        'error handler code goes here\r\n        Exit Sub\r\n    End If\r\n\r\n    ' set the members of the pi5 structure for use with SetPrinter.\r\n    ' PtrCtoVbString copies the memory pointed at by the two string\r\n    ' pointers contained in the t() array into a Visual Basic string.\r\n    ' The other three elements are just DWORDS (long integers) and\r\n    ' don't require any conversion\r\n    pi5.pPrinterName = PtrCtoVbString(t(0))\r\n    pi5.pPortName = PtrCtoVbString(t(1))\r\n    pi5.Attributes = t(2)\r\n    pi5.DeviceNotSelectedTimeout = t(3)\r\n    pi5.TransmissionRetryTimeout = t(4)\r\n\r\n    ' this is the critical flag that makes it the default printer\r\n    pi5.Attributes = PRINTER_ATTRIBUTE_DEFAULT\r\n\r\n    ' call SetPrinter to set it\r\n    x = SetPrinter(Handle, 5, pi5, 0)\r\n    ' failed the SetPrinter\r\n    If x = False Then\r\n        MsgBox \"SetPrinterFailed. Error code: \" & Err.LastDllError\r\n        Exit Sub\r\n    End If\r\n\r\n    ' and close the handle\r\n    ClosePrinter (Handle)\r\nEnd Sub\r\n\r\nPrivate Sub GetDriverAndPort(ByVal Buffer As String, DriverName As _\r\n    String, PrinterPort As String)\r\n\r\n    Dim iDriver As Integer\r\n    Dim iPort As Integer\r\n    DriverName = \"\"\r\n    PrinterPort = \"\"\r\n\r\n    ' The driver name is first in the string terminated by a comma\r\n    iDriver = InStr(Buffer, \",\")\r\n    If iDriver > 0 Then\r\n\r\n         ' Strip out the driver name\r\n        DriverName = Left(Buffer, iDriver - 1)\r\n\r\n        ' The port name is the second entry after the driver name\r\n        ' separated by commas.\r\n        iPort = InStr(iDriver + 1, Buffer, \",\")\r\n\r\n        If iPort > 0 Then\r\n            ' Strip out the port name\r\n            PrinterPort = Mid(Buffer, iDriver + 1, _\r\n            iPort - iDriver - 1)\r\n        End If\r\n    End If\r\nEnd Sub\r\n\r\nPrivate Sub ParseList(lstCtl As Control, ByVal Buffer As String)\r\n    Dim i As Integer\r\n    Dim s As String\r\n\r\n    Do\r\n        i = InStr(Buffer, Chr(0))\r\n        If i > 0 Then\r\n            s = Left(Buffer, i - 1)\r\n            If Len(Trim(s)) Then lstCtl.AddItem s\r\n            Buffer = Mid(Buffer, i + 1)\r\n        Else\r\n            If Len(Trim(Buffer)) Then lstCtl.AddItem Buffer\r\n            Buffer = \"\"\r\n        End If\r\n    Loop While i > 0\r\nEnd Sub\r\n\r\nPrivate Sub WinNTSetDefaultPrinter()\r\n    Dim Buffer As String\r\n    Dim DeviceName As String\r\n    Dim DriverName As String\r\n    Dim PrinterPort As String\r\n    Dim PrinterName As String\r\n    Dim r As Long\r\n    If List1.ListIndex > -1 Then\r\n        ' Get the printer information for the currently selected\r\n        ' printer in the list. The information is taken from the\r\n        ' WIN.INI file.\r\n        Buffer = Space(1024)\r\n        PrinterName = List1.Text\r\n        r = GetProfileString(\"PrinterPorts\", PrinterName, \"\", _\r\n            Buffer, Len(Buffer))\r\n\r\n        ' Parse the driver name and port name out of the buffer\r\n        GetDriverAndPort Buffer, DriverName, PrinterPort\r\n\r\n        If DriverName <> \"\" And PrinterPort <> \"\" Then\r\n            SetDefaultPrinter List1.Text, DriverName, PrinterPort\r\n        End If\r\n    End If\r\nEnd Sub\r\n","Declares":"Public Const HWND_BROADCAST = &HFFFF\r\nPublic Const WM_WININICHANGE = &H1A\r\n\r\n' constants for DEVMODE structure\r\nPublic Const CCHDEVICENAME = 32\r\nPublic Const CCHFORMNAME = 32\r\n\r\n' constants for DesiredAccess member of PRINTER_DEFAULTS\r\nPublic Const STANDARD_RIGHTS_REQUIRED = &HF0000\r\nPublic Const PRINTER_ACCESS_ADMINISTER = &H4\r\nPublic Const PRINTER_ACCESS_USE = &H8\r\nPublic Const PRINTER_ALL_ACCESS = (STANDARD_RIGHTS_REQUIRED Or _\r\nPRINTER_ACCESS_ADMINISTER Or PRINTER_ACCESS_USE)\r\n\r\n' constant that goes into PRINTER_INFO_5 Attributes member\r\n' to set it as default\r\nPublic Const PRINTER_ATTRIBUTE_DEFAULT = 4\r\n\r\n' Constant for OSVERSIONINFO.dwPlatformId\r\nPublic Const VER_PLATFORM_WIN32_WINDOWS = 1\r\n\r\nPublic Type OSVERSIONINFO\r\n    dwOSVersionInfoSize As Long\r\n    dwMajorVersion As Long\r\n    dwMinorVersion As Long\r\n    dwBuildNumber As Long\r\n    dwPlatformId As Long\r\n    szCSDVersion As String * 128\r\nEnd Type\r\n\r\nPublic Type DEVMODE\r\n     dmDeviceName As String * CCHDEVICENAME\r\n     dmSpecVersion As Integer\r\n     dmDriverVersion As Integer\r\n     dmSize As Integer\r\n     dmDriverExtra As Integer\r\n     dmFields As Long\r\n     dmOrientation As Integer\r\n     dmPaperSize As Integer\r\n     dmPaperLength As Integer\r\n     dmPaperWidth As Integer\r\n     dmScale As Integer\r\n     dmCopies As Integer\r\n     dmDefaultSource As Integer\r\n     dmPrintQuality As Integer\r\n     dmColor As Integer\r\n     dmDuplex As Integer\r\n     dmYResolution As Integer\r\n     dmTTOption As Integer\r\n     dmCollate As Integer\r\n     dmFormName As String * CCHFORMNAME\r\n     dmLogPixels As Integer\r\n     dmBitsPerPel As Long\r\n     dmPelsWidth As Long\r\n     dmPelsHeight As Long\r\n     dmDisplayFlags As Long\r\n     dmDisplayFrequency As Long\r\n     dmICMMethod As Long        ' // Windows 95 only\r\n     dmICMIntent As Long        ' // Windows 95 only\r\n     dmMediaType As Long        ' // Windows 95 only\r\n     dmDitherType As Long       ' // Windows 95 only\r\n     dmReserved1 As Long        ' // Windows 95 only\r\n     dmReserved2 As Long        ' // Windows 95 only\r\nEnd Type\r\n\r\nPublic Type PRINTER_INFO_5\r\n     pPrinterName As String\r\n     pPortName As String\r\n     Attributes As Long\r\n     DeviceNotSelectedTimeout As Long\r\n     TransmissionRetryTimeout As Long\r\nEnd Type\r\n\r\nPublic Type PRINTER_DEFAULTS\r\n     pDatatype As Long\r\n     pDevMode As Long\r\n     DesiredAccess As Long\r\nEnd Type\r\n\r\nDeclare Function GetProfileString Lib \"kernel32\" _\r\nAlias \"GetProfileStringA\" _\r\n(ByVal lpAppName As String, _\r\nByVal lpKeyName As String, _\r\nByVal lpDefault As String, _\r\nByVal lpReturnedString As String, _\r\nByVal nSize As Long) As Long\r\n\r\nDeclare Function WriteProfileString Lib \"kernel32\" _\r\nAlias \"WriteProfileStringA\" _\r\n(ByVal lpszSection As String, _\r\nByVal lpszKeyName As String, _\r\nByVal lpszString As String) As Long\r\n\r\nDeclare Function SendMessage Lib \"user32\" _\r\nAlias \"SendMessageA\" _\r\n(ByVal hwnd As Long, _\r\nByVal wMsg As Long, _\r\nByVal wParam As Long, _\r\nlparam As String) As Long\r\n\r\nDeclare Function GetVersionExA Lib \"kernel32\" _\r\n(lpVersionInformation As OSVERSIONINFO) As Integer\r\n\r\nPublic Declare Function OpenPrinter Lib \"winspool.drv\" _\r\nAlias \"OpenPrinterA\" _\r\n(ByVal pPrinterName As String, _\r\nphPrinter As Long, _\r\npDefault As PRINTER_DEFAULTS) As Long\r\n\r\nPublic Declare Function SetPrinter Lib \"winspool.drv\" _\r\nAlias \"SetPrinterA\" _\r\n(ByVal hPrinter As Long, _\r\nByVal Level As Long, _\r\npPrinter As Any, _\r\nByVal Command As Long) As Long\r\n\r\nPublic Declare Function GetPrinter Lib \"winspool.drv\" _\r\nAlias \"GetPrinterA\" _\r\n(ByVal hPrinter As Long, _\r\nByVal Level As Long, _\r\npPrinter As Any, _\r\nByVal cbBuf As Long, _\r\npcbNeeded As Long) As Long\r\n\r\nPublic Declare Function lstrcpy Lib \"kernel32\" _\r\nAlias \"lstrcpyA\" _\r\n(ByVal lpString1 As String, _\r\nByVal lpString2 As Any) As Long\r\n\r\nPublic Declare Function ClosePrinter Lib \"winspool.drv\" _\r\n(ByVal hPrinter As Long) As Long","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Default Printer","Set Printer","Printers"]},{"RecordId":"295","Title":"Font Installation VB4-32","Description":"Install fonts under 32 bit Windows or NT","Code":"Private Sub Command1_Click()\r\n\tDim lResult As Long\r\n\tDim strFontPath As String\r\n\tDim hKey As Long\r\n\r\n\t'This is the font name and path\r\n\r\n\tstrFontPath = Space$(MAX_PATH)\r\n    \r\n\tIf NT Then\r\n\t\t'Windows NT - Call and get the path to the \r\n\t\t'\\windows\\system directory\r\n\t\tlResult = GetWindowsDirectory(strFontPath, _\r\n\t\t\tMAX_PATH)\r\n\t\tIf lResult <> 0 Then Mid$(strFontPath, _\r\n\t\t\tlResult + 1, 1) = \"\\\"\r\n\t\tstrFontPath = RTrim$(strFontPath)\r\n\tElse\r\n\t\t'Win95 - Call and get the path to the \r\n\t\t'\\windows\\fonts directory\r\n\t\tlResult = GetWindowsDirectory(strFontPath, _\r\n\t\t\tMAX_PATH)\r\n\t\tIf lResult <> 0 Then Mid$(strFontPath, _\r\n\t\t\tlResult + 1) = \"\\fonts\\\"\r\n\t\tstrFontPath = RTrim$(strFontPath)\r\n\tEnd If\r\n    \r\n        \r\n\t'This Actually adds the font to the system's available \r\n\t'fonts for this windows session\r\n\tlResult = AddFontResource(strFontPath + strFontName)\r\n\tIf lResult = 0 Then MsgBox \"Error Occured \" & _\r\n\t\t\"Calling AddFontResource\"\r\n    \r\n    \r\n\t'Write the registry value to permanently install the \r\n\t'font\r\n\tlResult = RegOpenKey(HKEY_LOCAL_MACHINE, _\r\n\t\t\"software\\microsoft\\windows\\currentversion\\\" & _\r\n\t\t\"fonts\", hKey)\r\n\tlResult = RegSetValueEx(hKey, \"My Font \" & _\r\n\t\t\"(TrueType)\", 0, REG_SZ, ByVal strFontName, _\r\n\t\tLen(strFontName))\r\n\tlResult = RegCloseKey(hKey)\r\n    \r\n\t'This call broadcasts a message to let all top-level \r\n\t'windows know that a font change has occured so they \r\n\t'can reload their font list\r\n\tlResult = PostMessage(HWND_BROADCAST, WM_FONTCHANGE, _\r\n\t\t0, 0)\r\n\r\n\tMsgBox \"Font Added!\"\r\nEnd Sub\r\n\r\nPrivate Sub Command2_Click()\r\n\tDim hKey As Long\r\n\tDim strFontPath As String\r\n\tstrFontPath = Space$(MAX_PATH)\r\n    \r\n\tIf NT() Then\r\n\t\t'Windows NT - Call and get the path to the \r\n\t\t'\\windows\\system directory\r\n\t\tlResult = GetWindowsDirectory(strFontPath, _\r\n\t\t\tMAX_PATH)\r\n\t\tIf lResult <> 0 Then Mid$(strFontPath, lResult + _\r\n\t\t\t1, 1) = \"\\\"\r\n\t\tstrFontPath = RTrim$(strFontPath)\r\n\tElse\r\n\t\t'Win95 - Call and get the path to the \r\n\t\t'\\windows\\fonts directory\r\n\t\tlResult = GetWindowsDirectory(strFontPath, _\r\n\t\t\tMAX_PATH)\r\n\t\tIf lResult <> 0 Then Mid$(strFontPath, lResult + _\r\n\t\t\t1) = \"\\fonts\\\"\r\n\t\tstrFontPath = RTrim$(strFontPath)\r\n\tEnd If\r\n    \r\n\t'This removes our font!\r\n\tlResult = RemoveFontResource(strFontPath + _\r\n\t\tstrFontName)\r\n\r\n\t'Delete the registry value to permanently remove the \r\n\t'font\r\n\tlResult = RegOpenKey(HKEY_LOCAL_MACHINE, _\r\n\t\t\"software\\microsoft\\windows\\currentversion\\\" & _\r\n\t\t\"fonts\", hKey)\r\n\tlResult = RegDeleteValue(hKey, \"My Font \" & _\r\n\t\t\"(TrueType)\")\r\n\tlResult = RegCloseKey(hKey)\r\n    \r\n\t'This call broadcasts a message to let all top-level \r\n\t'windows know that a font change has occured so they \r\n\t'can reload their font list\r\n\tlResult = PostMessage(HWND_BROADCAST, WM_FONTCHANGE, _\r\n\t\t0, 0)\r\n    \r\n\tMsgBox \"Font Removed!\"\r\n\r\nEnd Sub\r\n\r\nPrivate Sub Form_Load()\r\n\tCommand1.Caption = \"Add Font\"\r\n\tCommand2.Caption = \"Remove Font\"\r\nEnd Sub\r\n\r\nPrivate Function NT() As Boolean\r\n\tDim lResult As Long\r\n\tDim vi As OSVERSIONINFO\r\n    \r\n\tvi.dwOSVersionInfoSize = Len(vi)\r\n\tlResult = GetVersionEx(vi)\r\n    \r\n\tIf vi.dwPlatformId And VER_PLATFORM_WIN32_NT Then\r\n\t\tNT = True\r\n\tElse\r\n\t\tNT = False\r\n\tEnd If\r\nEnd Function\r\n\r\n","Declares":"\t'32-bit declares\r\n\tPrivate Type OSVERSIONINFO\r\n\t\t\tdwOSVersionInfoSize As Long\r\n\t\t\tdwMajorVersion As Long\r\n\t\t\tdwMinorVersion As Long\r\n\t\t\tdwBuildNumber As Long\r\n\t\t\tdwPlatformId As Long\r\n\t\t\tszCSDVersion As String * 128\r\n\t\t'  Maintenance string for PSS usage\r\n\tEnd Type\r\n    \r\n\tPrivate Declare Function PostMessage Lib \"user32\" _\r\n\t\tAlias \"PostMessageA\" (ByVal hWnd As Long, ByVal _\r\n\t\twMsg As Long, ByVal wParam As Long, ByVal _\r\n\t\tlParam As Long) As Long\r\n\r\n\tPrivate Declare Function AddFontResource Lib \"gdi32\" _\r\n\t\tAlias \"AddFontResourceA\" (ByVal lpFilename As _\r\n\t\tString) As Long\r\n\r\n\tPrivate Declare Function CreateScalableFontResource _\r\n\t\tLib \"gdi32\" Alias \"CreateScalableFontResourceA\" _\r\n\t\t(ByVal fHidden As Long, ByVal lpszResourceFile _\r\n\t\tAs String, ByVal lpszFontFile As String, ByVal _\r\n\t\tlpszCurrentPath As String) As Long\r\n\r\n\tPrivate Declare Function RemoveFontResource Lib _\r\n\t\t\"gdi32\" Alias \"RemoveFontResourceA\" (ByVal _\r\n\t\tlpFilename As String) As Long\r\n\r\n\tPrivate Declare Function GetWindowsDirectory Lib _\r\n\t\t\"kernel32\" Alias \"GetWindowsDirectoryA\" (ByVal _\r\n\t\tlpBuffer As String, ByVal nSize As Long) As Long\r\n\r\n\tPrivate Declare Function GetSystemDirectory Lib _\r\n\t\t\"kernel32\" Alias \r\n\"GetWindowsDirectoryA\" (ByVal lpBuffer As String, ByVal _\r\n\tnSize As Long) As Long\r\n \r\n\tPrivate Declare Function RegSetValueEx Lib _\r\n\t\t\"advapi32.dll\" Alias \"RegSetValueExA\" (ByVal _\r\n\t\thKey As Long, ByVal lpValueName As String, _\r\n\t\tByVal Reserved As Long, ByVal dwType As Long, _\r\n\t\tlpData As Any, ByVal cbData As Long) As Long\r\n\r\n\tPrivate Declare Function RegOpenKey Lib _\r\n\t\t\"advapi32.dll\" Alias \"RegOpenKeyA\" (ByVal hKey _\r\n\t\tAs Long, ByVal lpSubKey As String, phkResult _\r\n\t\tAs Long) As Long\r\n\r\n\tPrivate Declare Function RegCloseKey Lib _\r\n\t\t\"advapi32.dll\" (ByVal hKey As Long) As Long\r\n\r\n\tPrivate Declare Function RegDeleteValue Lib _\r\n\t\t\"advapi32.dll\" Alias \"RegDeleteValueA\" (ByVal _\r\n\t\thKey As Long, ByVal lpValueName As String) As Long\r\n\r\n\tPrivate Declare Function GetVersionEx Lib \"kernel32\" _\r\n\tAlias \"GetVersionExA\" (lpVersionInformation As _\r\n\tOSVERSIONINFO) As Long\r\n\r\n'  dwPlatformId defines:\r\n'\r\n\tPrivate Const VER_PLATFORM_WIN32_NT = 2\r\n\r\n\tPrivate Const HWND_BROADCAST = &HFFFF&\r\n\tPrivate Const WM_FONTCHANGE = &H1D\r\n\tPrivate Const MAX_PATH = 260\r\n\tPrivate Const HKEY_LOCAL_MACHINE = &H80000002\r\n\tPrivate Const REG_SZ = 1\t' Unicode null \r\n\t'terminated string\r\n\r\n\tPrivate Const strFontName = \"myname.ttf\"\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Fonts","Installation","Setup"]},{"RecordId":"296","Title":"Retrieving IDENTITY Value of Newly Inserted Record","Description":"Demonstrates 3 ways to retrieve the IDENTITY value of a record that was inserted into a SQL Server table.","Code":"Three ways to retrieve the IDENTITY value of a newly inserted record\r\n\r\n1.  In VBScript using an SQL Insert statement\r\n2.  In a T-SQL stored procedure\r\n3.  Using ADO's AddNew method\r\n\r\n-----------------------------------------------------------------------------------\r\nMethod 1 (VBScript)\r\n-----------------------------------------------------------------------------------\r\n\r\nDim db,rcs,new_identity\r\n\r\n'Create a database connection\r\nSet db = Server.CreateObject(\"adodb.connection\")\r\ndb.Open \"DSN=MyDSN\"\r\n\r\n'Execute the INSERT statement and the SELECT @@IDENTITY\r\nSet rcs = db.execute(\"insert into tablename (fields,..) \" & _\r\n                     \"values (values,...);\" & _\r\n                     \"select @@identity\").nextrecordset\r\n\r\n'Retrieve the @@IDENTITY value\r\nnew_identity = rcs(0)\r\n\r\n-----------------------------------------------------------------------------------\r\nMethod 2 (T-SQL Stored Procedure)\r\n-----------------------------------------------------------------------------------\r\n\r\ndeclare @Inserted_Key int\r\ninsert into foo (datavalue) values ('hello')\r\nset @Inserted_Key = @@Identity\r\n\r\n-----------------------------------------------------------------------------------\r\nMethod 3 (ADO AddNew)\r\n-----------------------------------------------------------------------------------\r\n\r\nSet Rs = Server.CreateObject(\"ADODB.Recordset\")\r\nRs.ActiveConnection = Conn\r\nRs.CursorType = adOpenKeyset\r\nRs.LockType = adLockOptimistic\r\nRs.Source = \"People\" ' This is the Table Name\r\nRs.Open\r\n\r\nRs.AddNew\r\nRS(\"Name\") = Request.form(\"name\")\r\nRS.Update\r\n  \r\nId = Rs(\"Id\") ' This Returns the Id of the record that was just inserted.\r\n  \r\n","Declares":"","CodeCategory":{"CategoryId":"3","CategoryDescription":"Database"},"Keywords":["Identity","SQL","Insert"]},{"RecordId":"297","Title":"Change Screen Resolution","Description":"Code to change screen resolution","Code":"' Change the screen resolution mode - Rreturns True if the requested resolution mode\r\n'  is among those supported by the display adapter (otherwise it doesn't even\r\n' try to change the screen resolution)\r\n\r\nFunction ChangeScreenResolution(ByVal Width As Long, ByVal Height As Long, _\r\n    ByVal NumColors As Long, Optional Frequency As Long) As Boolean\r\n\r\n    Dim lpDevMode As DEVMODE\r\n    Dim index As Long\r\n    \r\n    ' set the DEVMODE flags and structure size\r\n    lpDevMode.dmSize = Len(lpDevMode)\r\n    lpDevMode.dmFields = DM_PELSWIDTH Or DM_PELSHEIGHT Or DM_BITSPERPEL\r\n    \r\n    ' retrieve info on the Nth display mode, exit if no more\r\n    Do While EnumDisplaySettings(0, index, lpDevMode) > 0\r\n\r\n        ' check whether this is the mode we're looking for\r\n        If lpDevMode.dmPelsWidth = Width And lpDevMode.dmPelsHeight = Height _\r\n            And 2 ^ lpDevMode.dmBitsPerPel = NumColors Then\r\n\r\n            ' check that the frequency is also the one we're looking for\r\n            If Frequency = 0 Or Frequency = lpDevMode.dmDisplayFrequency Then\r\n\r\n                ' try changing the resolution\r\n                If ChangeDisplaySettings(lpDevMode, CDS_FORCE) = 0 Then\r\n                    ' zero means success\r\n                    ChangeScreenResolution = True\r\n                    Exit Do\r\n                End If\r\n            End If\r\n        End If\r\n\r\n        ' skip to next screen mode\r\n        index = index + 1\r\n    Loop\r\n\r\nEnd Function","Declares":"Const DM_BITSPERPEL As Long = &H40000\r\nConst DM_PELSWIDTH As Long = &H80000\r\nConst DM_PELSHEIGHT As Long = &H100000\r\nConst CDS_FORCE As Long = &H80000000\r\n\r\nConst CCDEVICENAME As Long = 32\r\nConst CCFORMNAME As Long = 32\r\n\r\nPrivate Type DEVMODE\r\n    dmDeviceName As String * CCDEVICENAME\r\n    dmSpecVersion As Integer\r\n    dmDriverVersion As Integer\r\n    dmSize As Integer\r\n    dmDriverExtra As Integer\r\n    dmFields As Long\r\n    dmOrientation As Integer\r\n    dmPaperSize As Integer\r\n    dmPaperLength As Integer\r\n    dmPaperWidth As Integer\r\n    dmScale As Integer\r\n    dmCopies As Integer\r\n    dmDefaultSource As Integer\r\n    dmPrintQuality As Integer\r\n    dmColor As Integer\r\n    dmDuplex As Integer\r\n    dmYResolution As Integer\r\n    dmTTOption As Integer\r\n    dmCollate As Integer\r\n    dmFormName As String * CCFORMNAME\r\n    dmUnusedPadding As Integer\r\n    dmBitsPerPel As Long\r\n    dmPelsWidth As Long\r\n    dmPelsHeight As Long\r\n    dmDisplayFlags As Long\r\n    dmDisplayFrequency As Long\r\nEnd Type\r\n\r\nPrivate Declare Function EnumDisplaySettings Lib \"user32\" Alias _\r\n    \"EnumDisplaySettingsA\" (ByVal lpszDeviceName As Long, _\r\n    ByVal modeIndex As Long, lpDevMode As Any) As Boolean\r\n\r\nPrivate Declare Function ChangeDisplaySettings Lib \"user32\" Alias _\r\n    \"ChangeDisplaySettingsA\" (lpDevMode As Any, ByVal dwflags As Long) As Long","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Screen Resolution","Display Settings"]},{"RecordId":"298","Title":"Retrieve T-SQL of a Stored Procedure","Description":"Uses sp_helptext to get the actual T-SQL code for a stored procedure","Code":"sp_helptext 'your-proc'","Declares":"","CodeCategory":{"CategoryId":"6","CategoryDescription":"T-SQL"},"Keywords":["SQL Server","Stored Procedure"]},{"RecordId":"299","Title":"Create DSN Programmatically","Description":"Uses VB to create a DSN programmatically","Code":"<%\r\n\r\nSet xObj = Server.CreateObject(\"Softwing.OdbcRegTool\")\r\n\r\nstrDriver = \"SQL Server\"\r\nstrDSN = \"DSN=New SQL Server Data Source\" & vbNullChar & \"Description=New SQL Server Data Source\" & vbNullChar\r\nstrDSN = strDSN & \"Server=(local)\" & vbNullChar\r\nstrDSN = strDSN & \"DATABASE=pubs\" & vbNullChar & vbNullChar\r\n\r\nretval = xObj.CreateDSN(strDriver, strDSN)\r\nif retval = True then\r\n\tResponse.Write \"DSN Creation successful.\"\r\nelse\r\n\tResponse.Write \"DSN Creation failed.\"\r\nend if\r\n\r\n%>\r\n","Declares":"","CodeCategory":{"CategoryId":"5","CategoryDescription":"ASP"},"Keywords":["DSN","ODBC","Create DSN"]},{"RecordId":"300","Title":"Save/Get Binary Data To SQL Server (Preferred)","Description":"Saving and retrieving binary data (such as an image) to/from a SQL Server field.","Code":"'-------------------------------------------------------------------------------------------------------------\r\n'  GetImageFromDB\r\n'-------------------------------------------------------------------------------------------------------------\r\nPrivate Sub GetImageFromDB(rs As ADODB.Recordset)\r\n\r\n    Dim intFileNum As Integer\r\n    Dim strTempFileName As String\r\n    Dim lngImageSize As Long\r\n    Dim lngOffset As Long\r\n    Dim bytChunk() As Byte\r\n    Const conChunkSize = 1024\r\n    \r\n    If Not rs.EOF Then\r\n    \r\n        strTempFileName = App.Path & \"\\TempPic.jpg\"\r\n        \r\n        ' If temp file exists, delete it\r\n        If Len(Dir(strTempFileName)) > 0 Then\r\n            Kill strTempFileName\r\n        End If\r\n    \r\n        intFileNum = FreeFile\r\n        Open strTempFileName For Binary As #intFileNum\r\n        lngImageSize = rs(\"ImageBlob\").ActualSize\r\n        \r\n        ' Get the image out of the recordset and write it to disk\r\n        Do While lngOffset < lngImageSize\r\n            bytChunk() = rs(\"ImageBlob\").GetChunk(conChunkSize)\r\n            Put #intFileNum, , bytChunk()\r\n            lngOffset = lngOffset + conChunkSize\r\n        Loop\r\n        \r\n        Close #intFileNum\r\n        \r\n        ' Load the picture\r\n        imgControl.Picture = LoadPicture(strTempFileName)\r\n        Kill strTempFileName\r\n            \r\n    End If\r\n\r\nEnd Sub\r\n\r\n'-------------------------------------------------------------------------------------------------------------\r\n'  SaveImageToDB\r\n'-------------------------------------------------------------------------------------------------------------\r\nPrivate Sub SaveImageToDB(rs As ADODB.Recordset)\r\n\r\n    Dim bytBlob() As Byte\r\n    Dim strImagePath As String\r\n    Dim intNum As Integer\r\n    \r\n    strImagePath = Trim$(txtImagePath.Text)\r\n    intNum = FreeFile\r\n    \r\n    ' Read in the file\r\n    Open strImagePath For Binary As #intNum\r\n    ReDim bytBlob(FileLen(strImagePath))\r\n    Get #intNum, , bytBlob\r\n    Close #intNum\r\n    \r\n    ' Save to db\r\n    rs.AddNew\r\n    rs(\"ImageBlob\").AppendChunk bytBlob\r\n    rs.Update\r\n    \r\nEnd Sub","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["AppendChunk","GetChunk","Binary data"]},{"RecordId":"301","Title":"Change Background Color of TreeView Control","Description":"Changes the background color of the TreeView control","Code":"Sub SetTreeViewBackColor(TV As TreeView, ByVal BackColor As Long)\r\n\r\n    Dim lStyle As Long\r\n    Dim TVNode As node\r\n         \r\n    ' set the BackColor for every node\r\n    For Each TVNode In TV.Nodes\r\n        TVNode.BackColor = BackColor\r\n    Next\r\n\r\n    ' set the BackColor for the TreeView's window\r\n    SendMessage TV.hwnd, TVM_SETBKCOLOR, 0, ByVal BackColor\r\n    ' get the current style\r\n    lStyle = GetWindowLong(TV.hwnd, GWL_STYLE)\r\n    ' temporary hide lines\r\n    SetWindowLong TV.hwnd, GWL_STYLE, lStyle And (Not TVS_HASLINES)\r\n    ' redraw lines\r\n    SetWindowLong TV.hwnd, GWL_STYLE, lStyle\r\n\r\nEnd Sub","Declares":"Declare Function SendMessage Lib \"user32\" Alias \"SendMessageA\" (ByVal hwnd As _\r\n    Long, ByVal wMsg As Long, ByVal wParam As Long, lParam As Any) As Long\r\n\r\nDeclare Function GetWindowLong Lib \"user32\" Alias \"GetWindowLongA\" (ByVal hwnd _\r\n    As Long, ByVal nIndex As Long) As Long\r\n\r\nDeclare Function SetWindowLong Lib \"user32\" Alias \"SetWindowLongA\" (ByVal hwnd _\r\n    As Long, ByVal nIndex As Long, ByVal dwNewLong As Long) As Long\r\n\r\nConst GWL_STYLE = -16&\r\nConst TVM_SETBKCOLOR = 4381&\r\nConst TVS_HASLINES = 2&","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["TreeView","Background Color"]},{"RecordId":"302","Title":"Create Captionless MDI Form","Description":"Removes title bar (and access to system menu) on MDI form","Code":"Private Sub MDIForm_Load()\r\n\r\n    Dim lStyle As Long\r\n    \r\n    lStyle = GetWindowLong(Me.hwnd, GWL_STYLE)\r\n    lStyle = lStyle Xor WS_CAPTION\r\n    \r\n    ' Uncomment to remove system menu access\r\n    'lStyle = lStyle Xor WS_SYSMENU\r\n    \r\n    Call SetWindowLong(Me.hwnd, GWL_STYLE, lStyle)\r\n\r\nEnd Sub\r\n","Declares":"Declare Function GetWindowLong Lib \"user32\" Alias \"GetWindowLongA\" (ByVal hwnd As Long, ByVal nIndex As Long) As Long\r\n\r\nDeclare Function SetWindowLong Lib \"user32\" Alias \"SetWindowLongA\" (ByVal hwnd As Long, ByVal nIndex As Long, ByVal dwNewLong As Long) As Long\r\n\r\nConst GWL_STYLE = (-16)\r\nConst WS_CAPTION = &HC00000\r\nConst WS_SYSMENU = &H80000\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Captionless MDI","MDI"]},{"RecordId":"303","Title":"Get Relative Path Between Two Directories / Files","Description":"Determines the relative path between two directories (or folders).\r\nFor example:  C:\\A and C:\\Winnt\\System32 returns  ..\\winnt\\system32","Code":"Private Function GetRelativePath(ByVal sPathFrom As String, ByVal sPathTo As String) As String\r\n\r\n    Dim bResult As Boolean\r\n    Dim sRelativePath As String\r\n    Const MAX_PATH As Long = 260\r\n    \r\n    sRelativePath = Space(MAX_PATH)\r\n    \r\n    ' Set \"dwAttr...\" to vbDirectory for directories, = for files\r\n    bResult = PathRelativePathToW(StrPtr(sRelativePath), StrPtr(sPathFrom), vbDirectory, StrPtr(sPathTo), 0)\r\n    If bResult Then\r\n        GetRelativePath = Left$(sRelativePath, InStr(sRelativePath, vbNullChar) - 1)\r\n    Else\r\n        GetRelativePath = \"\"\r\n    End If\r\n\r\nEnd Function\r\n\r\n\r\nPrivate Sub Command1_Click()\r\n\r\n    Dim sRelative As String\r\n    \r\n    '  txtFromPath should contain the directory path to go from\r\n    '  txtToPath should contain the file path to go to\r\n    '  txtRelativePath will contain the result\r\n\r\n    txtRelativePath.Text = GetRelativePath(txtFromPath.Text, txtToPath.Text)\r\n    \r\nEnd Sub\r\n","Declares":"Private Declare Function PathRelativePathToW Lib \"shlwapi.dll\" _\r\n    (ByVal pszPath As Long, _\r\n    ByVal pszFrom As Long, _\r\n    ByVal dwAttrFrom As Long, _\r\n    ByVal pszTo As Long, _\r\n    ByVal dwAttrTo As Long) As Boolean\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Relative Path"]},{"RecordId":"304","Title":"Cross-Tab in SQL Server (Preferred)","Description":"Stored procedure for creating a cross-tab result set on the fly.","Code":"----------------------------------------------------------------------------------------------------------\r\n  This sample consists of two parts.\r\n    Part 1 is the stored procesure \"crosstab\" that builds the result set\r\n    Part 2 is the explanation of how to use it.\r\n----------------------------------------------------------------------------------------------------------\r\n\r\n----------------------------------------------------------------------------------------------------------\r\n  Part 1 - Stored procedure \"crosstab\"\r\n----------------------------------------------------------------------------------------------------------\r\n\r\nCREATE PROCEDURE crosstab \r\n@select varchar(8000),\r\n@sumfunc varchar(100), \r\n@pivot varchar(100), \r\n@table varchar(100) \r\nAS\r\n\r\nDECLARE @sql varchar(8000), @delim varchar(1)\r\nSET NOCOUNT ON\r\nSET ANSI_WARNINGS OFF\r\n\r\nEXEC ('SELECT ' + @pivot + ' AS pivot INTO ##pivot FROM ' + @table + ' WHERE 1=2')\r\nEXEC ('INSERT INTO ##pivot SELECT DISTINCT ' + @pivot + ' FROM ' + @table + ' WHERE ' \r\n+ @pivot + ' Is Not Null')\r\n\r\nSELECT @sql='',  @sumfunc=stuff(@sumfunc, len(@sumfunc), 1, ' END)' )\r\n\r\nSELECT @delim=CASE Sign( CharIndex('char', data_type)+CharIndex('date', data_type) ) \r\nWHEN 0 THEN '' ELSE '''' END \r\nFROM tempdb.information_schema.columns \r\nWHERE table_name='##pivot' AND column_name='pivot'\r\n\r\nSELECT @sql=@sql + '''' + convert(varchar(100), pivot) + ''' = ' + \r\nstuff(@sumfunc,charindex( '(', @sumfunc )+1, 0, ' CASE ' + @pivot + ' WHEN ' \r\n+ @delim + convert(varchar(100), pivot) + @delim + ' THEN ' ) + ', ' FROM ##pivot\r\n\r\nDROP TABLE ##pivot\r\n\r\nSELECT @sql=left(@sql, len(@sql)-1)\r\nSELECT @select=stuff(@select, charindex(' FROM ', @select)+1, 0, ', ' + @sql + ' ')\r\n\r\nEXEC (@select)\r\nSET ANSI_WARNINGS ON\r\n\r\n\r\n----------------------------------------------------------------------------------------------------------\r\n  Part 2 - Usage example and explanation\r\n\r\n  EXECUTE crosstab \r\n     'select title from titles \r\n      inner join sales on (sales.title_id=titles.title_id) group by title', \r\n     'sum(qty)', \r\n     'stor_id', \r\n     'stores'\r\n\r\n  EXECUTE crosstab \r\n     'select pub_name, count(qty) as orders, sum(qty) as total from sales \r\n      inner join titles on (sales.title_id=titles.title_id) \r\n      right join publishers on (publishers.pub_id=titles.pub_id) \r\n      group by pub_name', \r\n      'sum(qty)',\r\n      'type',\r\n      'titles'\r\n \r\n  EXECUTE crosstab \r\n     'SELECT LastName FROM Employees \r\n      INNER JOIN Orders ON (Employees.EmployeeID=Orders.EmployeeID) \r\n      GROUP BY LastName', \r\n      'count(lastname)', \r\n      'Year(OrderDate)', \r\n      'Orders'\r\n----------------------------------------------------------------------------------------------------------\r\n\r\nEXECUTE crosstab SELECT statement, summary calculation, pivot column, table name \r\n\r\n1.  The SELECT statement can be anything, as long as it has proper syntax and includes a GROUP BY clause. You can use JOINs, but if you use table aliases you should include the alias in the summary calculation expression (2).\r\n\r\n2.  The summary calculation must have an aggregate function like SUM(), AVG(), MIN(), MAX(), etc. You'd have to modify the code if you want to use DISTINCT with these functions. COUNT(*) won't work, you have to COUNT on a column.\r\n\r\n3.  The pivot column must be in the table (4). You can use an expression for the pivot column (a+b, LEFT(FirstName,3), etc.) as long as it can be derived from the table listed in (4). A cross-tab heading will be created for each distinct value in the pivot colum/expression.\r\n\r\n4.  This table can be any table in your database, or another database if you use the full naming syntax (database.owner.table). Tables in a linked server may also work, but I haven't tested this. It's possible that a derived table (nested SELECT) can work, but I haven't tested this either. You would need to enclose the SELECT statement in parentheses, and use a table alias outside these parentheses, like this: '(SELECT LastName FROM myTable) AS Surnames'","Declares":"","CodeCategory":{"CategoryId":"6","CategoryDescription":"T-SQL"},"Keywords":["Cross-tab query","Cross Tab","SQL Server"]},{"RecordId":"305","Title":"Combo Box Search","Description":"Search combo box, select item, and select text in text area of combo box (like Access does).\r\n\r\nNOTE:  This code goes in the KeyPress event of the Combo Box","Code":"Public Sub SearchComboBox(cboBox As Control, KeyAscii As Integer)\r\n\r\n    '*** Be sure to set ListBox/ComboBox \"\"sorted\"\" property to TRUE\r\n    Dim lngIndex As Long\r\n    Dim strSearch As String\r\n    \r\n    If KeyAscii < 32 Or KeyAscii > 127 Then\r\n        Exit Sub\r\n    End If\r\n    \r\n    If TypeOf cboBox Is ComboBox Then\r\n    \r\n        If cboBox.SelLength = 0 Then\r\n            strSearch = cboBox.Text & Chr$(KeyAscii)\r\n        Else\r\n            strSearch = Left$(cboBox.Text, cboBox.SelStart) & Chr$(KeyAscii)\r\n        End If\r\n        \r\n        lngIndex = SendMessage(cboBox.hwnd, CB_FINDSTRING, -1, ByVal strSearch)\r\n        If lngIndex <> CB_ERR Then\r\n            cboBox.ListIndex = lngIndex\r\n            cboBox.SelStart = Len(strSearch)\r\n            cboBox.SelLength = Len(cboBox) - Len(strSearch)\r\n            KeyAscii = 0\r\n        End If\r\n    End If\r\n    \r\nEnd Sub\r\n\r\n","Declares":"Const CB_ERR = -1\r\nConst CB_FINDSTRING = &H14C\r\n\r\nDeclare Function SendMessage Lib \"user32\" _\r\n    Alias \"SendMessageA\" _\r\n    (ByVal hwnd As Long, _\r\n    ByVal wMsg As Long, _\r\n    ByVal wParam As Long, _\r\n    lParam As Any) As Long\r\n\r\n\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Combo Box Search","Search"]},{"RecordId":"306","Title":"Screen Resolution","Description":"Determines whether screen is set to VGA or higher","Code":"Public Function IsVGA() As Integer\r\n\r\nDim r As RECT\r\nDim hWnd As Integer\r\nDim Result As Variant\r\n\r\nhWnd = GetDesktopWindow()\r\nResult = GetWindowRect(hWnd, r)\r\nIf (((r.Bottom - r.Top) < 481) Or ((r.Right - r.Left) < 641)) Then\r\n    IsVGA = True\r\nElse\r\n    IsVGA = False\r\nEnd If\r\n\r\nEnd Function\r\n","Declares":"#If Win16 Then\r\n\r\n    Type RECT\r\n            Left As Integer\r\n            Top As Integer\r\n            Right As Integer\r\n            Bottom As Integer\r\n    End Type\r\n    \r\n    Declare Function GetDesktopWindow Lib \"User\" () As Integer\r\n    Declare Sub GetWindowRect Lib \"GDI\" (ByVal hWnd As Integer, lpRect As RECT)\r\n\r\n#Else\r\n\r\n    Type RECT\r\n            Left As Long\r\n            Top As Long\r\n            Right As Long\r\n            Bottom As Long\r\n    End Type\r\n    \r\n    Declare Function GetDesktopWindow Lib \"user32\" () As Long\r\n    Declare Function GetWindowRect Lib \"user32\" (ByVal hWnd As Long, lpRect As RECT) As Long\r\n\r\n#End If\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Screen Resolution","Hardware"]},{"RecordId":"307","Title":"Gradient Form Background","Description":"Creates a gradient shading for a form","Code":"Sub ShadeForm (Frm As Form)\r\n    \r\n    Dim I As Integer\r\n    Dim NbrOfRects As Integer\r\n    Dim GradColor As Long\r\n    Dim GradValue As Integer\r\n    Frm.ScaleMode = 3\r\n    Frm.DrawStyle = 6\r\n    Frm.DrawWidth = 2\r\n    Frm.AutoRedraw = True\r\n    NbrOfRects = 64\r\n    For I = 1 To 64\r\n\tGradValue = 255 - (I * 4 - 1)\r\n\tIf GradValue = 192 Then GradValue = 191 \r\n              GradColor = RGB(0, 0, GradValue)\r\n\tFrm.Line (0, Frm.ScaleHeight * (I - 1) / 64)-(Frm.ScaleWidth, Frm.ScaleHeight * I / 64), GradColor, BF\r\n    Next I\r\n    Frm.Refresh\r\n\r\nEnd Sub\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Gradient Background","Shaded Form"]},{"RecordId":"308","Title":"List Running Processes","Description":"Retrieves list of running processes on NT, Win95, and Win98","Code":"Public Sub GetAllProcesses()\r\n\r\n    Dim f As Long, sname As String\r\n    Dim hSnap As Long\r\n    Dim proc As PROCESSENTRY32\r\n    Dim cb As Long\r\n    Dim cbNeeded As Long\r\n    Dim NumElements As Long\r\n    Dim ProcessIDs() As Long\r\n    Dim cbNeeded2 As Long\r\n    Dim NumElements2 As Long\r\n    Dim Modules(1 To 200) As Long\r\n    Dim lRet As Long\r\n    Dim ModuleName As String\r\n    Dim nSize As Long\r\n    Dim hProcess As Long\r\n    Dim i As Long\r\n\r\n    Select Case GetVersion()\r\n\r\n      Case 1 'Windows 95/98\r\n\r\n         hSnap = CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, 0)\r\n         If hSnap = hNull Then Exit Sub\r\n         proc.dwSize = Len(proc)\r\n         ' Iterate through the processes\r\n         f = Process32First(hSnap, proc)\r\n         Do While f\r\n           sname = StrZToStr(proc.szExeFile)\r\n           Debug.Print sname\r\n           f = Process32Next(hSnap, proc)\r\n         Loop\r\n\r\n      Case 2 'Windows NT\r\n\r\n         'Get the array containing the process id's for each process object\r\n         cb = 8\r\n         cbNeeded = 96\r\n         Do While cb <= cbNeeded\r\n            cb = cb * 2\r\n            ReDim ProcessIDs(cb / 4) As Long\r\n            lRet = EnumProcesses(ProcessIDs(1), cb, cbNeeded)\r\n         Loop\r\n         NumElements = cbNeeded / 4\r\n\r\n         For i = 1 To NumElements\r\n            'Get a handle to the Process\r\n            hProcess = OpenProcess(PROCESS_QUERY_INFORMATION _\r\n               Or PROCESS_VM_READ, 0, ProcessIDs(i))\r\n            'Got a Process handle\r\n            If hProcess <> 0 Then\r\n                'Get an array of the module handles for the specified\r\n                'process\r\n                lRet = EnumProcessModules(hProcess, Modules(1), 200, _\r\n                                             cbNeeded2)\r\n                'If the Module Array is retrieved, Get the ModuleFileName\r\n                If lRet <> 0 Then\r\n                   ModuleName = Space(MAX_PATH)\r\n                   nSize = 500\r\n                   lRet = GetModuleFileNameExA(hProcess, Modules(1), _\r\n                                   ModuleName, nSize)\r\n                   Debug.Print Left(ModuleName, lRet)\r\n                End If\r\n            End If\r\n          'Close the handle to the process\r\n         lRet = CloseHandle(hProcess)\r\n         Next\r\n\r\n      End Select\r\n\r\nEnd Sub\r\n\r\nPrivate Function GetVersion() As Long\r\n\r\n         Dim osinfo As OSVERSIONINFO\r\n         Dim retvalue As Integer\r\n         osinfo.dwOSVersionInfoSize = 148\r\n         osinfo.szCSDVersion = Space$(128)\r\n         retvalue = GetVersionExA(osinfo)\r\n         GetVersion = osinfo.dwPlatformId\r\n\r\nEnd Function\r\n\r\n\r\nPrivate Function StrZToStr(s As String) As String\r\n         StrZToStr = Left$(s, Len(s) - 1)\r\nEnd Function\r\n","Declares":"Public Declare Function Process32First Lib \"kernel32\" (ByVal hSnapshot As Long, lppe As PROCESSENTRY32) As Long\r\nPublic Declare Function Process32Next Lib \"kernel32\" (ByVal hSnapshot As Long, lppe As PROCESSENTRY32) As Long\r\nPublic Declare Function CloseHandle Lib \"Kernel32.dll\" (ByVal Handle As Long) As Long\r\nPublic Declare Function OpenProcess Lib \"Kernel32.dll\" (ByVal dwDesiredAccessas As Long, ByVal bInheritHandle As Long, ByVal dwProcId As Long) As Long\r\nPublic Declare Function EnumProcesses Lib \"psapi.dll\" (ByRef lpidProcess As Long, ByVal cb As Long, ByRef cbNeeded As Long) As Long\r\nPublic Declare Function GetModuleFileNameExA Lib \"psapi.dll\" (ByVal hProcess As Long, ByVal hModule As Long, ByVal ModuleName As String, ByVal nSize As Long) As Long\r\nPublic Declare Function EnumProcessModules Lib \"psapi.dll\" (ByVal hProcess As Long, ByRef lphModule As Long, ByVal cb As Long, ByRef cbNeeded As Long) As Long\r\nPublic Declare Function CreateToolhelp32Snapshot Lib \"kernel32\" (ByVal dwFlags As Long, ByVal th32ProcessID As Long) As Long\r\nPublic Declare Function GetVersionExA Lib \"kernel32\" (lpVersionInformation As OSVERSIONINFO) As Integer\r\n\r\nPublic Type PROCESSENTRY32\r\n         dwSize As Long\r\n         cntUsage As Long\r\n         th32ProcessID As Long           ' This process\r\n         th32DefaultHeapID As Long\r\n         th32ModuleID As Long            ' Associated exe\r\n         cntThreads As Long\r\n         th32ParentProcessID As Long     ' This process's parent process\r\n         pcPriClassBase As Long          ' Base priority of process threads\r\n         dwFlags As Long\r\n         szExeFile As String * 260       ' MAX_PATH\r\nEnd Type\r\n\r\nPublic Type OSVERSIONINFO\r\n         dwOSVersionInfoSize As Long\r\n         dwMajorVersion As Long\r\n         dwMinorVersion As Long\r\n         dwBuildNumber As Long\r\n         dwPlatformId As Long           '1 = Windows 95. '2 = Windows NT\r\n         szCSDVersion As String * 128\r\nEnd Type\r\n\r\nPublic Const PROCESS_QUERY_INFORMATION = 1024\r\nPublic Const PROCESS_VM_READ = 16\r\nPublic Const MAX_PATH = 260\r\nPublic Const STANDARD_RIGHTS_REQUIRED = &HF0000\r\nPublic Const SYNCHRONIZE = &H100000       'STANDARD_RIGHTS_REQUIRED Or SYNCHRONIZE Or &HFFF\r\nPublic Const PROCESS_ALL_ACCESS = &H1F0FFF\r\nPublic Const TH32CS_SNAPPROCESS = &H2&\r\nPublic Const hNull = 0\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Processes","Running Processes"]},{"RecordId":"309","Title":"Set File Date/Time (32 Bit)","Description":"Set a file's date/time","Code":"'-- Call the function like this....\r\n\r\nCall SetFileDate(\"c:\\autoexec.bat\", \"10/16/96 12:30 pm\")\r\n\r\n\r\n\r\nSub SetFileDate(sFileName As String, sDate As String)\r\n\r\n\tDim hFile As Long\r\n\tDim lResult As Long\r\n\tDim udtSysTime As SYSTEMTIME\r\n\tDim udtFileTime As FILETIME\r\n\tDim udtLocalTime As FILETIME\r\n\r\n\tWith udtSysTime\r\n\t\t.wYear = Year(sDate)\r\n\t\t.wMonth = Month(sDate)\r\n\t\t.wDay = Day(sDate)\r\n\t\t.wDayOfWeek = WeekDay(sDate) - 1\r\n\t\t.wHour = Hour(sDate)\r\n\t\t.wMinute = Minute(sDate)\r\n\t\t.wSecond = Second(sDate)\r\n\tEnd With\r\n\r\n\tlResult = SystemTimeToFileTime(udtSysTime, _\r\n\t\tudtLocalTime)\r\n\tlResult = LocalFileTimeToFileTime(udtLocalTime, _\r\n\t\tudtFileTime)\r\n\thFile = CreateFile(sFileName, GENERIC_WRITE, _\r\n\t\tFILE_SHARE_READ _\r\n\t\tOr FILE_SHARE_WRITE, ByVal 0&, OPEN_EXISTING, _\r\n\t\t0, 0)\r\n\tlResult = SetFileTime(hFile, ByVal 0&, ByVal 0&, _\r\n\t\tudtFileTime)\r\n\tCall CloseHandle(hFile)\r\n\r\nEnd Sub","Declares":"Private Type FILETIME\r\n\tdwLowDate\t\tAs Long\r\n\tdwHighDate\tAs Long\r\nEnd Type\r\n\r\nPrivate Type SYSTEMTIME\r\n\twYear\t\t\tAs Integer\r\n\twMonth\t\t\tAs Integer\r\n\twDayOfWeek\tAs Integer\r\n\twDay\t\t\tAs Integer\r\n\twHour\t\t\tAs Integer\r\n\twMinute\t\tAs Integer\r\n\twSecond\t\tAs Integer\r\n\twMillisecs\tAs Integer\r\nEnd Type\r\n\r\nPrivate Const FILE_SHARE_READ = &H1\r\nPrivate Const FILE_SHARE_WRITE = &H2\r\nPrivate Const GENERIC_WRITE = &H40000000\r\nPrivate Const OPEN_EXISTING = 3\r\n\r\nPrivate Declare Function CloseHandle Lib \"kernel32\" _\r\n\t(ByVal hObject As Long) As Long\r\n\r\nPrivate Declare Function CreateFile Lib \"kernel32\" _\r\n\tAlias \"CreateFileA\" (ByVal lpFileName As String, _\r\n\tByVal dwDesiredAccess As Long, ByVal dwShareMode _\r\n\tAs Long, ByVal lpSecurityAttributes As Long, ByVal _\r\n\tdwCreationDisposition As Long, ByVal _\r\n\tdwFlagsAndAttributes As Long, ByVal hTemplateFile _\r\n\tAs Long) As Long\r\n\r\nPrivate Declare Function LocalFileTimeToFileTime Lib _\r\n\t\"kernel32\" (lpLocalFileTime As FILETIME, lpFileTime _\r\n\tAs FILETIME) As Long\r\n\r\nPrivate Declare Function SetFileTime Lib \"kernel32\" _\r\n\t(ByVal hFile As Long, ByVal MullP As Long, ByVal _\r\n\tNullP2 As Long, lpLastWriteTime As FILETIME) As Long\r\n\r\nPrivate Declare Function SystemTimeToFileTime Lib _\r\n\t\"kernel32\" (lpSystemTime As SYSTEMTIME, lpFileTime _\r\n\tAs FILETIME) As Long\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["File Date/Time"]},{"RecordId":"310","Title":"Long File Names (Retrieving)","Description":"How to retrieve a long file name from the 8.3 translation.  (ie. Retrieve \"program files\" instead of \"progra~1\", etc.","Code":"Private Function GetLongFileName(strShortName As String) As String\r\n\r\n    Dim sWrkStr As String\r\n    Dim sNewFile As String\r\n    Dim i As Integer\r\n    Dim iLastPos As Integer\r\n    Dim iLen As Integer\r\n    Dim bFilePart As Boolean\r\n    \r\n    bFilePart = True\r\n    iLen = Len(strShortName)\r\n    iLastPos = iLen\r\n    \r\n    For i = iLen To 1 Step -1\r\n        If Mid$(strShortName, i, 1) = \"\\\" Then\r\n            sWrkStr = Mid$(strShortName, 1, iLastPos)\r\n            If bFilePart Then\r\n                bFilePart = False\r\n                If i = iLen Then\r\n                    sNewFile = \"\"\r\n                Else\r\n                    sNewFile = Dir(sWrkStr)\r\n                    If sNewFile = \"\" Then\r\n                        sNewFile = Mid$(strShortName, i + 1, iLen)\r\n                    End If\r\n                End If\r\n            Else\r\n                sWrkStr = Dir(sWrkStr, vbDirectory)\r\n                If sWrkStr = \"\" Then\r\n                    sWrkStr = Mid$(strShortName, i + 1, (iLastPos - i))\r\n                End If\r\n                sNewFile = sWrkStr & \"\\\" & sNewFile\r\n            End If\r\n            iLastPos = i - 1\r\n        End If\r\n    Next\r\n    \r\n    GetLongFileName = Left$(strShortName, 3) & sNewFile\r\n    \r\nEnd Function\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Long File Name","File Name"]},{"RecordId":"311","Title":"Popup Menu Tracking Routine","Description":"Popup menu tracking routine","Code":"Sub TrackPopUp (Menu As Integer, X As Single, Y As Single, F as Form, MenuForm As Form)\r\n          Const PIXEL = 3\r\n          Const TWIP = 1\r\n          F.ScaleMode = PIXEL\r\n          InPixels = F.ScaleWidth\r\n          F.ScaleMode = TWIP\r\n          ix = (X + F.Left) \\ (F.ScaleWidth \\ InPixels)\r\n          iy = (Y + (F.Top + (F.Height - F.ScaleHeight - (F.Width - F.ScaleWidth)))) \\ (F.ScaleWidth \\ InPixels)\r\n          hMenu% = GetMenu(MenuForm.hWnd)\r\n          hSubMenu% = GetSubMenu(hMenu%, Menu)\r\n          '2 tells it to use right mouse button, 1 the left button\r\n          r = TrackPopupMenu(hSubMenu%, 2, ix, iy, 0, MenuForm.hWnd, 0)\r\nEnd Sub\r\n\r\n","Declares":"Declare Function TrackPopupMenu% Lib \"user\" (ByVal hMenu%, ByVal wFlags%, ByVal X%, ByVal Y%, ByVal r2%, ByVal hWnd%, ByVal r1&)\r\nDeclare Function GetMenu% Lib \"user\" (ByVal hWnd%)\r\nDeclare Function GetSubMenu% Lib \"user\" (ByVal hMenu%, ByVal nPos%)","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Popup Menu","Menu"]},{"RecordId":"312","Title":"Start NT Explorer With Specific Drive Expanded","Description":"Start NT Explorer with a specific drive expanded","Code":"By default, Windows NT Explorer always starts with the drive containing the Windows NT root folder (\\winnt) expanded. But what if you want to start Explorer with a different drive expanded? You can do this by choosing Start| Run, and then typing\r\n\r\nexplorer /e, d:\r\n\r\nReplace d: with the letter of the drive you want to expand when you start Explorer. (You could also modify the Explorer shortcut on your Start menu to run this command.)\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"7","CategoryDescription":"Misc"},"Keywords":["Explorer"]},{"RecordId":"313","Title":"CPU Type","Description":"Determines PC processor type (386, 486, pentium, etc.)","Code":"Dim si As SYSTEM_INFO\r\n\r\nCall GetSystemInfo(si)\r\nSelect Case (si.dwOemID)\r\n    Case PROCESSOR_ARCHITECTURE_INTEL: Debug.Print \"Intel processor\"\r\n    Case PROCESSOR_ARCHITECTURE_MIPS: Debug.Print \"Mips processor\"\r\n    Case PROCESSOR_ARCHITECTURE_ALPHA: Debug.Print \"Alpha processor\"\r\n    Case PROCESSOR_ARCHITECTURE_PPC: Debug.Print \"PowerPC processor\"\r\n    Case PROCESSOR_ARCHITECTURE_UNKNOWN: Debug.Print \"Unknown processor\"\r\nEnd Select\r\n\r\nSelect Case (si.dwProcessorType)\r\n    Case PROCESSOR_INTEL_386: Debug.Print \"386 CPU\"\r\n    Case PROCESSOR_INTEL_486: Debug.Print \"486 CPU\"\r\n    Case PROCESSOR_INTEL_PENTIUM: Debug.Print \"Pentium CPU\"\r\n    Case PROCESSOR_MIPS_R4000: Debug.Print \"MIPS R4000 CPU\"\r\n    Case PROCESSOR_ALPHA_21064: Debug.Print \"Alpha 21064 CPU\"\r\nEnd Select\r\n\r\nDebug.Print \"Number of CPUs: \"; si.dwNumberOfProcessors\r\nDebug.Print \"Memory page size: \"; si.dwPageSize\r\n","Declares":"Private Type SYSTEM_INFO\r\n    dwOemID As Long\r\n    dwPageSize As Long\r\n    lpMinimumApplicationAddress As Long\r\n    lpMaximumApplicationAddress As Long\r\n    dwActiveProcessorMask As Long\r\n    dwNumberOfProcessors As Long\r\n    dwProcessorType As Long\r\n    dwAllocatoinGranularity As Long\r\n    dwReserved As Long\r\nEnd Type\r\n\r\nPrivate Declare Sub GetSystemInfo Lib \"kernel32\" (lpSystemInfo As SYSTEM_INFO)\r\n\r\nPrivate Const PROCESSOR_INTEL_386 = 386\r\nPrivate Const PROCESSOR_INTEL_486 = 486\r\nPrivate Const PROCESSOR_INTEL_PENTIUM = 586\r\nPrivate Const PROCESSOR_MIPS_R4000 = 4000\r\nPrivate Const PROCESSOR_ALPHA_21064 = 21064\r\n\r\nPrivate Const PROCESSOR_ARCHITECTURE_INTEL = 0\r\nPrivate Const PROCESSOR_ARCHITECTURE_MIPS = 1\r\nPrivate Const PROCESSOR_ARCHITECTURE_ALPHA = 2\r\nPrivate Const PROCESSOR_ARCHITECTURE_PPC = 3\r\nPrivate Const PROCESSOR_ARCHITECTURE_UNKNOWN = &HFFFF\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["CPU Type","System Info"]},{"RecordId":"314","Title":"Customizing Web-View Background in Explorer","Description":"Change the background bitmap when \"view as web page\" is selected in Windows Explorer","Code":"CUSTOMIZING WEB VIEW BACKGROUND\r\n\r\nWhen you pull down the View menu in My Computer or Windows Explorer and select the As Web Page command, Windows 98 automatically uses a cloud image for the background of the Web view. \r\n\r\nHowever, if you'd like to use your own image for that Web view background here's what you need to do:\r\n\r\n1) Open either My Computer or Windows Explorer and access the C:\\Windows\\Web folder.\r\n\r\n2) Locate and rename the file Wvleft.bmp.\r\n\r\n3) Open Paint, press [Ctrl]-E and type 242 and 600 in the Width and Height text boxes respectively.\r\n\r\n4) Create your image and save it in the C:\\Windows\\Web folder as Wvleft.bmp.\r\n","Declares":"","CodeCategory":{"CategoryId":"7","CategoryDescription":"Misc"},"Keywords":["Background","Web","Explorer"]},{"RecordId":"315","Title":"Spellcheck Using Word","Description":"Uses OLE automation to spell check a text box using Word's spell checker.","Code":"Dim objWord As Object\r\nDim sTemp As String\r\n\r\nSet objWord = CreateObject(\"Word.Basic\")\r\n\r\nobjWord.filenew\r\nobjWord.Insert Trim$(Text1.Text)\r\nobjWord.ToolsSpelling\r\nobjWord.EditSelectAll\r\nobjWord.SetDocumentVar \"Myvar\", objWord.selection\r\nsTemp = objWord.GetDocumentVar(\"Myvar\")\r\nText1.SelText = Left$(sTemp, Len(sTemp) - 1)","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["SpellCheck","Word"]},{"RecordId":"316","Title":"Find File","Description":"Uses API to locate a file.  NOTE: Returns first location found.  Does not continue to search.","Code":"Public Function FindFile(ByVal sRootPath As String, ByVal sFileName As String) As String\r\n\r\nDim iNull As Integer\r\nDim lResult As Long\r\nDim sBuffer As String\r\n\r\nsBuffer = String$(1024, 0)\r\nlResult = SearchTreeForFile(sRootPath, sFileName, sBuffer)\r\nIf lResult Then\r\n    iNull = InStr(sBuffer, vbNullChar)\r\n    If iNull Then\r\n        sBuffer = Left$(sBuffer, iNull - 1)\r\n    End If\r\n    FindFile = sBuffer\r\nElse\r\n    FindFile = \"\"\r\nEnd If\r\n\r\nEnd Function\r\n","Declares":"Declare Function SearchTreeForFile Lib \"imagehlp.dll\" (ByVal lpRootPath As String, ByVal lpInputPathName As String, ByVal lpOutputPath As String) As Long\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Find File","Search"]},{"RecordId":"317","Title":"Create Excel Chart From VB","Description":"Use VB to create a chart in existing Excel spreadsheet.","Code":"NOTE:  Requires setting reference to Excel in project references.\r\nAssumes an existing Excel spreadsheet with data in the first workbook.\r\n\r\nPrivate Sub MakeExcelChart()\r\n\r\n    Dim xlApp As Excel.Application\r\n    Dim xlWrkbk As Excel.Workbook\r\n    Dim xlChartObj As Excel.Chart\r\n    Dim xlSourceRange As Excel.Range\r\n    Dim xlColPoint As Excel.Point\r\n    \r\n    \r\n    ' Start excel and open the spreadsheet\r\n    Set xlApp = CreateObject(\"Excel.Application\")\r\n    Set xlWrkbk = xlApp.Workbooks.Open(App.Path & \"\\qryTed.xls\")\r\n    Set xlSourceRange = xlWrkbk.Worksheets(1).Range(\"A1\").CurrentRegion\r\n    \r\n    ' Set up the chart\r\n    Set xlChartObj = xlApp.Charts.Add\r\n    With xlChartObj\r\n        \r\n        ' Specify a line chart with markers\r\n        .ChartType = xlLineMarkers\r\n        \r\n        ' Set the range of the chart\r\n        .SetSourceData xlSourceRange, xlColumns\r\n        \r\n        ' Specify the chart's location\r\n        .Location xlLocationAsNewSheet\r\n        \r\n        ' Set up the chart's title\r\n        .HasTitle = True\r\n        With .ChartTitle\r\n            .Text = \"Your chart title here\"\r\n            .Font.Size = 18\r\n        End With\r\n        \r\n        ' Rotate the X axis labels 90 degrees\r\n        .Axes(xlCategory).TickLabels.Orientation = xlUpward\r\n        \r\n        ' Include the label to the right of the X axis\r\n        .Axes(xlValue, xlPrimary).HasTitle = False\r\n        .Axes(xlValue).TickLabels.NumberFormat = \"$#,##0\"\r\n        \r\n        ' Include the legend\r\n        .HasLegend = True\r\n        .Legend.AutoScaleFont = True\r\n        .Legend.Font.Name = \"Arial\"\r\n        .Legend.Font.FontStyle = \"Regular\"\r\n        .Legend.Position = xlLegendPositionTop\r\n        .PlotArea.Border.Weight = xlThin\r\n        .PlotArea.Border.LineStyle = xlAutomatic\r\n        .PlotArea.Interior.ColorIndex = xlNone\r\n        \r\n        ' Set each datapoint to show the dollar amount and format the datapoint as currency with no decimals\r\n        With .SeriesCollection(1)\r\n            .ApplyDataLabels Type:=xlDataLabelsShowValue, LegendKey:=False\r\n            .DataLabels.NumberFormat = \"$#,##0\"\r\n        End With\r\n        With .SeriesCollection(2)\r\n            .ApplyDataLabels Type:=xlDataLabelsShowValue, LegendKey:=False\r\n        End With\r\n    End With\r\n        \r\n    ' Save it and close it\r\n    With xlWrkbk\r\n        .Save\r\n        .Close\r\n    End With\r\n    \r\n    ' Shut down excel\r\n    xlApp.Quit\r\n    Set xlSourceRange = Nothing\r\n    Set xlColPoint = Nothing\r\n    Set xlChartObj = Nothing\r\n    Set xlWrkbk = Nothing\r\n    Set xlApp = Nothing\r\n    \r\nEnd Sub\r\n\r\n\r\n\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Excel","Chart"]},{"RecordId":"320","Title":"Find Window Filename","Description":"Finds the handle of the window whose file name matches the passed filename.","Code":"Function GetModuleHWnd (ByVal Module As String) As Integer\r\n\r\n'This function is used to find the main window handle of an application\r\n'You must pass the filename of the application (don't include the path)\r\n\r\n    Dim hWndTmp%\r\n    Dim hInstTmp%\r\n    Dim ModTmp$\r\n    Dim nRet%\r\n\r\n    \r\n    Module = Trim$(UCase$(Module))\r\n    ModTmp = Space$(128)\r\n\r\n    'Loop through windows master task list\r\n    hWndTmp = FindWindow(0&, 0&)\r\n    Do Until hWndTmp = 0\r\n\r\n    'Only look at parent windows\r\n        If GetParent(hWndTmp) = 0 Then\r\n             \r\n            hInstTmp = GetWindowWord(hWndTmp, GWW_HINSTANCE)\r\n            nRet = GetModuleFileName(hInstTmp, ModTmp, 128)\r\n            \r\n            'Match?\r\n            If Right$(Left$(ModTmp, nRet), Len(Module)) = Module Then\r\n                GetModuleHWnd = hWndTmp\r\n                Exit Do\r\n            End If\r\n        End If\r\n        \r\n        hWndTmp = GetWindow(hWndTmp, GW_HWNDNEXT)\r\n    Loop\r\n\r\nEnd Function\r\n","Declares":"Declare Function FindWindow Lib \"User\" (ByVal lpClassName As Any, ByVal lpWindowName As Any) As Integer\r\nDeclare Function GetParent Lib \"User\" (ByVal hWnd%) As Integer\r\nDeclare Function GetWindowWord Lib \"User\" (ByVal hWnd%, ByVal nIndex%) As Integer\r\nDeclare Function GetWindow Lib \"User\" (ByVal hWnd%, ByVal wCmd%) As Integer\r\nDeclare Function GetModuleFileName Lib \"Kernel\" (ByVal hModule As Integer, ByVal lpFilename As String, ByVal nSize As Integer) As Integer\r\n\r\nConst GW_HWNDNEXT = 2\r\nConst GWW_HINSTANCE = -6\r\n\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Find Window"]},{"RecordId":"321","Title":"File I/O","Description":"Read a text file (such as AUTOEXEC.BAT)","Code":"Sub ReadFile (FileName As String)\r\n\r\n'Read a text file (such as AUTOEXEC.BAT)\r\n\r\nDim filein As Integer\r\nDim filebuffer As String\r\n\r\n'Get file number\r\nfilein = FreeFile\r\n\r\n'Open the file\r\nOpen FileName For Input As #filein\r\n\r\n'Read until end of file\r\nDo While Not EOF(filein)\r\n    \r\n    Line Input #filein, filebuffer\r\n    If InStr(UCase$(filebuffer), \"SHARE\") Then\r\n\t'Do something\r\n    End If\r\n\r\nLoop\r\n\r\n'Close file\r\nClose #filein\r\n\r\nEnd Sub\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["File I/O"]},{"RecordId":"322","Title":"Create nested subdirectories","Description":"Creates all necessary parent directories above and including the requested directory.","Code":"Sub CreateLongDir(sDrive As String, sDir As String)\r\n\r\nDim sBuild As String\r\n\r\nWhile InStr(2, sDir, \"\\\") > 1\r\n    sBuild = sBuild & Left$(sDir, InStr(2, sDir, \"\\\") - 1)\r\n    sDir = Mid$(sDir, InStr(2, sDir, \"\\\"))\r\n    If Dir$(sDrive & sBuild, 16) = \"\" Then\r\n        MkDir sDrive & sBuild\r\n    End If\r\nWend\r\n\r\nEnd Sub\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Directory Creation"]},{"RecordId":"323","Title":"ADO SQL Server Data Type Mapping","Description":"ADO to SQL Server datatype mapping","Code":"ADO Datatype\tSQL Datatype\r\nadSmallInt\tSmallInt\r\nadInteger\t\tInt\r\nadSingle\t\tReal\r\nadDouble\t\tFloat\r\nadCurrency\tMoney\r\nadCurrency\tSmallMoney\r\nadBoolean\tBit\r\nadUnsignedTinyInt\tTinyInt\r\nadBinary\t\tTimeStamp\r\nadBinary\t\tBinary\r\nadChar\t\tChar\t\tLength 3\r\nadNumeric\tNumeric \t\tPrecision, Numeric Scale 11,4\r\nadNumeric\tDecimal\t\tPrecision, Numeric Scale 10,3\r\nadDBTimeStamp\tSmallDateTime\r\nadDBTimeStamp\tDateTime\r\nadVarChar\tVarChar\t\tLength 20\r\nadVarChar\tSysname\t\tLength 30\r\nadLongVarChar\tText\r\nadVarBinary\tVarBinary\t\tLength 30\r\nadLongVarBinary\tImage\r\n","Declares":"","CodeCategory":{"CategoryId":"3","CategoryDescription":"Database"},"Keywords":["ADO","Datatype","SQL Server"]},{"RecordId":"324","Title":"File I/O Read a binary file","Description":"Best way to read a binary file","Code":"Dim MyFile As String\r\nDim Buffer As String\r\nDim FileNumber As Integer\r\nDim NumBlocks As Integer\r\nDim Remainder As Integer\r\nDim I As Integer\r\n\r\n\r\nMyFile = \"c:\\logo.sys\"\r\nFileNumber = FreeFile\r\n\r\nOpen MyFile For Binary As FileNumber\r\n\r\nNumBlocks = LOF(FileNumber) \\ 8192\r\nRemainder = LOF(FileNumber) Mod 8192\r\n\r\nFor I = 1 To NumBlocks\r\n    Buffer = Space$(8192)\r\n    Get #FileNumber, , Buffer\r\nNext\r\n\r\nIf Remainder Then\r\n        Buffer = Space$(Remainder)\r\n    Get #FileNumber, , Buffer\r\nEnd If\r\n\r\nClose FileNumber\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["File I/O","Binary read"]},{"RecordId":"326","Title":"Mail Merge Using Word and Outlook","Description":"Demonstrates how to perform a mail merge using Word and the Outlook Contacts folder.","Code":"Option Explicit\r\n\r\n' ---------------------------------------------------------\r\n' Mail Merge sample that uses Word and Outlook Contacts.  This\r\n' example assumes that you have added a custom property named\r\n' \"Gifts Received\" to the Outlook Contacts folder.\r\n'\r\n' A reference to Outlook 98 and Word 8 is required.\r\n'\r\n' The \"AutoOpen\" procedure is the starting point of the process.\r\n'\r\n' ---------------------------------------------------------\r\n\r\nPrivate ol As New Outlook.Application\r\nPrivate ContactFolder As MAPIFolder\r\nPrivate GiftItems As Items\r\nPrivate AppPath As String\r\n\r\nPrivate Sub AutoOpen()\r\n\r\n    AppPath = ActiveDocument.Path\r\n    If MsgBox(\"Ready to create thank you notes?\", vbYesNo) = vbYes Then\r\n        CreateThankYou\r\n    End If\r\n    \r\nEnd Sub\r\n\r\nPrivate Sub CreateThankYou()\r\n\r\n    LoadContacts\r\n    CreateDataDoc\r\n    DoMailMerge\r\n\r\nEnd Sub\r\n\r\nPrivate Sub LoadContacts()\r\n\r\n    ol.GetNamespace(\"MAPI\").GetDefaultFolder (olFolderContacts)\r\n    Set GiftItems = ContactFolder.Items.Restrict(\"[Gifts Received] > ''\")\r\n    \r\nEnd Sub\r\n\r\nPrivate Sub CreateDataDoc()\r\n\r\n    Dim Row As Integer\r\n    Dim adoc As Document\r\n    \r\n    Set adoc = Documents.Add\r\n    With adoc\r\n        .Tables.Add Range:=adoc.Content, NumRows:=GiftItems.Count + 1, NumColumns:=7\r\n        .Tables(1).Cell(1, 1).Range.Text = \"FirstName\"\r\n        .Tables(1).Cell(1, 2).Range.Text = \"LastName\"\r\n        .Tables(1).Cell(1, 3).Range.Text = \"Street\"\r\n        .Tables(1).Cell(1, 4).Range.Text = \"City\"\r\n        .Tables(1).Cell(1, 5).Range.Text = \"State\"\r\n        .Tables(1).Cell(1, 6).Range.Text = \"Zip\"\r\n        .Tables(1).Cell(1, 7).Range.Text = \"Gift\"\r\n    End With\r\n    \r\n    For Row = 1 To GiftItems.Count\r\n        With GiftItems(Row)\r\n            adoc.Tables(1).Cell(Row + 1, 1).Range.Text = .FirstName\r\n            adoc.Tables(1).Cell(Row + 1, 2).Range.Text = .LastName\r\n            adoc.Tables(1).Cell(Row + 1, 3).Range.Text = .MailingAddressStreet\r\n            adoc.Tables(1).Cell(Row + 1, 4).Range.Text = .MailingAddressCity\r\n            adoc.Tables(1).Cell(Row + 1, 5).Range.Text = .MailingAddressState\r\n            adoc.Tables(1).Cell(Row + 1, 6).Range.Text = .MailingAddressPostalCode\r\n            If Left(.UserProperties![Gifts Received].Value, 1) = \"$\" Then\r\n                adoc.Tables(1).Cell(Row + 1, 7).Range.Text = \"generous gift\"\r\n            Else\r\n                adoc.Tables(1).Cell(Row + 1, 7).Range.Text = .UserProperties![Gifts Received].Value\r\n            End If\r\n            \r\n        End With\r\n    Next\r\n    \r\n    adoc.SaveAs AppPath & \"/giftmerg.doc\"\r\n        \r\nEnd Sub\r\n\r\nPrivate Sub DoMailMerge()\r\n\r\n    Documents.Add AppPath & \"/giftform.dot\"\r\n    \r\n    ActiveDocument.MailMerge.OpenDataSource Name:=AppPath & \"/giftmerg.doc\"\r\n    ActiveDocument.MailMerge.EditMainDocument\r\n    \r\n    Selection.GoTo what:=wdGoToBookmark, Name:=\"Address\"\r\n    With ActiveDocument.MailMerge.Fields\r\n        .Add Range:=Selection.Range, Name:=\"FirstName\"\r\n        Selection.InsertAfter \" \"\r\n        \r\n        .Add Range:=Selection.Range, Name:=\"LastName\"\r\n        Selection.InsertParagraphAfter\r\n        Selection.MoveDown wdLine\r\n        \r\n        .Add Range:=Selection.Range, Name:=\"Street\"\r\n        Selection.InsertParagraphAfter\r\n        Selection.MoveDown wdLine\r\n        \r\n        .Add Range:=Selection.Range, Name:=\"City\"\r\n        Selection.InsertAfter \", \"\r\n        .Add Range:=Selection.Range, Name:=\"State\"\r\n        Selection.InsertAfter \"  \"\r\n        .Add Range:=Selection.Range, Name:=\"Zip\"\r\n        \r\n        Selection.GoTo what:=wdGoToBookmark, Name:=\"Salutation\"\r\n        .Add Range:=Selection.Range, Name:=\"FirstName\"\r\n        \r\n        Selection.GoTo what:=wdGoToBookmark, Name:=\"Gift\"\r\n        .Add Range:=Selection.Range, Name:=\"Gift\"\r\n        \r\n    End With\r\n    \r\n    With ActiveDocument.MailMerge\r\n        .Destination = wdSendToNewDocument\r\n        .Execute\r\n    End With\r\n    \r\nEnd Sub\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Mail Merge","Outlook","Word"]},{"RecordId":"327","Title":"FileIO - 1 Approach To Handling DB Ops","Description":"Uses Append Chunk to handle MDB files","Code":"Sub FileIO (TableName As Variant, SaveMode As Variant)\r\n    On Error Resume Next\r\n    Screen.MousePointer = 11\r\n    On Local Error GoTo BadSave\r\n    Dim DB As Database, TB As Table\r\n    Dim ErrorOccurred As Integer\r\n    Dim Criteria As Variant, Work As String, x As Integer, y As Integer\r\n    Dim IncrementFlag As Integer\r\n    Dim LocationStatus As String\r\n    \r\n    ErrorOccurred = False\r\n    GoSub ProcedureFileHandling\r\n    Screen.MousePointer = 0\r\nExit Sub\r\n\r\nProcedureFileHandling:\r\n    Select Case UCase(SaveMode)\r\n    Case \"NEW\", \"EDIT\", \"SAVE\"\r\n        Set DB = OpenDatabase(ActiveDataBase)\r\n        Set TB = DB.OpenTable(\"Procedures\")\r\n        TB.Index = \"ProcIndex\"\r\n        Proc.Procedure = Left(Upeach(frmMain!lstProc) + Space(40), 40)\r\n        TB.Seek \"=\", Proc.Procedure\r\n        If TB.NoMatch Then\r\n            TB.AddNew\r\n            frmMain!lstProc.AddItem Proc.Procedure\r\n        Else\r\n            TB.Edit\r\n        End If\r\n        TB(\"Procedure\").Value = Proc.Procedure\r\n        TB(\"Desc\").AppendChunk frmMain!txtBox(0) + Space(1)\r\n        'TB(\"Types\").AppendChunk frmMain!txtBox(1) + Space(1)\r\n        TB(\"Declarations\").AppendChunk frmMain!txtBox(1) + Space(1)\r\n        TB(\"ModuleCode\").AppendChunk frmMain!txtBox(2) + Space(1)\r\n        TB(\"EventCode\").AppendChunk frmMain!txtBox(3) + Space(1)\r\n        TB.Update\r\n        TB.Close\r\n        DB.Close\r\n    'Case \"LOAD\", \"NEXT\", \"PREVIOUS\", \"QUERYVIEW\"\r\n    Case \"LOAD\"\r\n        Set DB = OpenDatabase(ActiveDataBase)\r\n        Set TB = DB.OpenTable(\"Procedures\")\r\n        TB.Index = \"ProcIndex\"\r\n        Proc.Procedure = Left(Upeach(frmMain!lstProc) + Space(40), 40)\r\n        TB.Seek \"=\", Proc.Procedure\r\n        If TB.NoMatch Then\r\n            TB.Close : Return\r\n        Else\r\n            TB.Edit\r\n        End If\r\n        Proc.Procedure = TB(\"Procedure\").Value\r\n        frmMain!txtBox(0) = TB(\"Desc\").GetChunk(0, TB(\"Desc\").FieldSize())\r\n        'frmMain!txtBox(1) = TB(\"Types\").GetChunk(0, TB(\"Types\").FieldSize())\r\n        frmMain!txtBox(1) = TB(\"Declarations\").GetChunk(0, TB(\"Declarations\").FieldSize())\r\n        frmMain!txtBox(2) = TB(\"ModuleCode\").GetChunk(0, TB(\"ModuleCode\").FieldSize())\r\n        frmMain!txtBox(3) = TB(\"EventCode\").GetChunk(0, TB(\"EventCode\").FieldSize())\r\n        TB.Close\r\n        DB.Close\r\n    Case \"LOADBOX\"\r\n        LoadingBox = True\r\n        x = 0\r\n        Set DB = OpenDatabase(ActiveDataBase)\r\n        Set TB = DB.OpenTable(\"Procedures\")\r\n        TB.Index = \"ProcIndex\"\r\n        Proc.Procedure = Left(Upeach(frmMain!lstProc) + Space(40), 40)\r\n        TB.MoveFirst\r\n        Do\r\n            If TB.EOF Then Exit Do\r\n            If TB.NoMatch Then Exit Do\r\n            TB.Edit\r\n            Proc.Procedure = TB(\"Procedure\").Value\r\n            frmMain!lstProc.AddItem Proc.Procedure\r\n            x = x + 1\r\n            If x = 1 Then\r\n                frmMain!lstProc.Text = Proc.Procedure\r\n                frmMain!txtBox(0) = TB(\"Desc\").GetChunk(0, TB(\"Desc\").FieldSize())\r\n                'frmMain!txtBox(1) = TB(\"Types\").GetChunk(0, TB(\"Types\").FieldSize())\r\n                frmMain!txtBox(1) = TB(\"Declarations\").GetChunk(0, TB(\"Declarations\").FieldSize())\r\n                frmMain!txtBox(2) = TB(\"ModuleCode\").GetChunk(0, TB(\"ModuleCode\").FieldSize())\r\n                frmMain!txtBox(3) = TB(\"EventCode\").GetChunk(0, TB(\"EventCode\").FieldSize())\r\n            End If\r\n            TB.MoveNext\r\n        Loop\r\n        TB.Close\r\n        DB.Close\r\n        LoadingBox = False\r\n    Case \"SEARCHING\"\r\n        LoadingBox = True\r\n        Dim Working As String\r\n        Dim found As Integer\r\n        Static SearchingFor As String\r\n        Static LastSearch As String\r\n        Static BookMark As String\r\n        SearchingFor = UCase(Trim(TableName))\r\n        Set DB = OpenDatabase(ActiveDataBase)\r\n        Set TB = DB.OpenTable(\"Procedures\")\r\n        TB.Index = \"ProcIndex\"\r\n        If LastSearch = SearchingFor Then\r\n            If Trim(BookMark) <> \"\" Then\r\n                TB.Seek \">\", BookMark\r\n                If TB.NoMatch Then\r\n                    LastSearch = \"\"\r\n                    GoTo ProcedureFileHandling\r\n                End If\r\n            Else\r\n                TB.MoveFirst\r\n            End If\r\n        Else\r\n            LastSearch = SearchingFor\r\n            TB.MoveFirst\r\n        End If\r\n        Do\r\n            If TB.EOF Then\r\n                MsgBox \"Match not found\", 48, \"Not Found\"\r\n                SearchFound = False\r\n                Exit Do\r\n            End If\r\n            SearchFound = True\r\n            TB.Edit\r\n            Working = UCase(TB(\"Procedure\").Value): Proc.Procedure = Working\r\n            BookMark = Working\r\n            If InStr(Working, SearchingFor) Then found = True\r\n            Working = UCase(TB(\"Desc\").GetChunk(0, TB(\"Desc\").FieldSize()))\r\n            If InStr(Working, SearchingFor) Then found = True\r\n            'Working = UCase(TB(\"Types\").GetChunk(0, TB(\"Types\").FieldSize()))\r\n            'If InStr(Working, SearchingFor) Then found = True\r\n            Working = UCase(TB(\"Declarations\").GetChunk(0, TB(\"Declarations\").FieldSize()))\r\n            If InStr(Working, SearchingFor) Then found = True\r\n            Working = UCase(TB(\"ModuleCode\").GetChunk(0, TB(\"ModuleCode\").FieldSize()))\r\n            If InStr(Working, SearchingFor) Then found = True\r\n            Working = UCase(TB(\"EventCode\").GetChunk(0, TB(\"EventCode\").FieldSize()))\r\n            If InStr(Working, SearchingFor) Then found = True\r\n            If found Then\r\n                frmMain!lstProc.Text = Proc.Procedure\r\n                frmMain!txtBox(0) = TB(\"Desc\").GetChunk(0, TB(\"Desc\").FieldSize())\r\n                'frmMain!txtBox(1) = TB(\"Types\").GetChunk(0, TB(\"Types\").FieldSize())\r\n                frmMain!txtBox(1) = TB(\"Declarations\").GetChunk(0, TB(\"Declarations\").FieldSize())\r\n                frmMain!txtBox(2) = TB(\"ModuleCode\").GetChunk(0, TB(\"ModuleCode\").FieldSize())\r\n                frmMain!txtBox(3) = TB(\"EventCode\").GetChunk(0, TB(\"EventCode\").FieldSize())\r\n                Exit Do\r\n            End If\r\n            TB.MoveNext\r\n        Loop\r\n        TB.Close\r\n        DB.Close\r\n        LoadingBox = False\r\n    Case \"DELETE\"\r\n        Set DB = OpenDatabase(ActiveDataBase)\r\n        Set TB = DB.OpenTable(\"Procedures\")\r\n        TB.Index = \"ProcIndex\"\r\n        Proc.Procedure = Left(Upeach(frmMain!lstProc) + Space(40), 40)\r\n        TB.Seek \"=\", Proc.Procedure\r\n        If TB.NoMatch Then TB.Close : DB.Close : Return\r\n        If Not TB.NoMatch Then TB.Delete\r\n        TB.MoveFirst\r\n        Dim ItemNum As Long\r\n        LoadingBox = True\r\n        ItemNum = -1\r\n        Do\r\n            ItemNum = ItemNum + 1\r\n            If ItemNum > frmMain!lstProc.ListCount Then Exit Do\r\n            If Trim(frmMain!lstProc.List(ItemNum)) = Trim(frmMain!lstProc.Text) Then\r\n                frmMain!lstProc.RemoveItem ItemNum\r\n                Exit Do\r\n            End If\r\n        Loop\r\n        TB.MoveFirst\r\n        If Not TB.EOF Then\r\n            Proc.Procedure = TB(\"Procedure\").Value\r\n            frmMain!lstProc.Text = Proc.Procedure\r\n            frmMain!txtBox(0) = TB(\"Desc\").GetChunk(0, TB(\"Desc\").FieldSize())\r\n            'frmMain!txtBox(1) = TB(\"Types\").GetChunk(0, TB(\"Types\").FieldSize())\r\n            frmMain!txtBox(1) = TB(\"Declarations\").GetChunk(0, TB(\"Declarations\").FieldSize())\r\n            frmMain!txtBox(2) = TB(\"ModuleCode\").GetChunk(0, TB(\"ModuleCode\").FieldSize())\r\n            frmMain!txtBox(3) = TB(\"EventCode\").GetChunk(0, TB(\"EventCode\").FieldSize())\r\n        End If\r\n        LoadingBox = False\r\n        TB.Close\r\n        DB.Close\r\n    End Select\r\nReturn\r\n\r\nBadSave:\r\n    If LocationStatus = \"Justify load\" Then Resume Next\r\n    If LocationStatus = \"Delete\" Then Resume Next\r\n    If LocationStatus = \"LoadListBox\" Then Resume Next\r\n    If Err = 3021 Then Resume Next\r\n    ErrorOccurred = Err\r\n    MsgBox \"Error Occurred - \" + Str$(Err) + \"  \" + Error$\r\nResume Next\r\n\r\nEnd Sub\r\n","Declares":"","CodeCategory":{"CategoryId":"3","CategoryDescription":"Database"},"Keywords":["File I/O"]},{"RecordId":"328","Title":"User Resources","Description":"Find User Resources","Code":"'Place the following in all the Form_Load events\r\nuserSpace = GetFreeSystemResources(2)\r\nUser.Caption = userSpace & \"%\"\r\n","Declares":"Declare Function GetFreeSystemResources Lib \"User\" (ByVal ResType As Integer) As Integer\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Resources","System Info"]},{"RecordId":"329","Title":"Center Form (With Win95 Taskbar - Preferred)","Description":"Takes into account size of task bar when centering a form","Code":"Public Sub CenterFormWithTaskBar(frm As Form)\r\n\r\nDim ScreenWidth As Long\r\nDim ScreenHeight As Long\r\nDim ScreenTop As Long\r\nDim ScreenLeft As Long\r\nDim DesktopArea As RECT\r\n\r\nCall SystemParametersInfo(SPI_GETWORKAREA, 0, DesktopArea, 0)\r\n\r\nScreenHeight = (DesktopArea.Bottom - DesktopArea.Top) * Screen.TwipsPerPixelY\r\nScreenWidth = (DesktopArea.Right - DesktopArea.Left) * Screen.TwipsPerPixelX\r\nScreenLeft = DesktopArea.Left * Screen.TwipsPerPixelX\r\nScreenTop = DesktopArea.Top * Screen.TwipsPerPixelY\r\n\r\nfrm.Move (ScreenWidth - frm.Width) \\ 2 + ScreenLeft, (ScreenHeight - frm.Height) \\ 2 + ScreenTop\r\n\r\nEnd Sub\r\n","Declares":"\r\nDeclare Function SystemParametersInfo Lib \"user32\" Alias \"SystemParametersInfoA\" (ByVal uAction As Long, ByVal uParam As Long, lpvParam As Any, ByVal fuWinIni As Long) As Long\r\n\r\nPrivate Type RECT\r\n    Left As Long\r\n    Top As Long\r\n    Right As Long\r\n    Bottom As Long\r\nEnd Type\r\n\r\nPrivate Const SPI_GETWORKAREA = 48\r\n\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Center Form","Task Bar"]},{"RecordId":"330","Title":"Insertion Sort Routines","Description":"Sorts arrays of various types (single, integer, etc) either ascending or descending","Code":"\r\n' - - - To sort ascending, call with:              InsertSortAny Ar(), , False\r\n' - - - To sort descending, call with:            InsertSortAny Ar(), , True\r\n' - - - Replace \"InsertSortAny\" with \"InsertSortx\" where x is the array type for the specific sort routine\r\n\r\nAttribute VB_Name = \"InsertSort\"\r\nOption Explicit\r\n\r\nSub InsertSortAny(arr As Variant, Optional ByVal numEls As Variant, Optional ByVal descending As Variant)\r\n\r\n    '---------------------------------------\r\n    '  Insert Sort of an array of any type\r\n    '---------------------------------------\r\n\r\n    Dim index As Long, first As Long\r\n    Dim last As Long, middle As Long\r\n    Dim firstItem As Long, i As Long\r\n    Dim inverseOrder As Boolean\r\n    Dim value As Variant\r\n    \r\n    ' exit if it is not an arr\r\n    If VarType(arr) < vbArray Then Exit Sub\r\n\r\n    ' account for optional arguments\r\n    If IsMissing(numEls) Then numEls = UBound(arr)\r\n    If IsMissing(descending) Then descending = False\r\n    inverseOrder = (descending <> False)\r\n    \r\n    firstItem = LBound(arr)\r\n\r\n    For index = firstItem + 1 To numEls\r\n        value = arr(index)\r\n\r\n        If ((value < arr(index - 1)) Xor inverseOrder) Then\r\n            ' (this nested IF spares a comparison if not really needed\r\n            If (value <> arr(index - 1)) Then\r\n                ' the element is out of order: search the subarray arr(1 to index-1)\r\n                ' for locating the position it should occupy\r\n                ' since subarray is already sorted we can use binary search\r\n                first = firstItem\r\n                last = index - 1\r\n                Do\r\n                    middle = (first + last) \\ 2\r\n                    If arr(middle) = value Then\r\n                        first = middle: Exit Do\r\n                    ElseIf ((arr(middle) < value) Xor inverseOrder) Then\r\n                        first = middle + 1\r\n                    Else\r\n                        last = middle - 1\r\n                    End If\r\n                Loop Until first > last\r\n                ' insert the value in arr(first), shifting items\r\n                ' with higher indexes\r\n                For i = index To first + 1 Step -1\r\n                    arr(i) = arr(i - 1)\r\n                Next\r\n                arr(first) = value\r\n            End If\r\n        End If\r\n    Next index\r\n\r\nEnd Sub\r\n\r\nSub InsertSortI(arr() As Integer, Optional ByVal numEls As Variant, Optional ByVal descending As Variant)\r\n\r\n    '---------------------------------------\r\n    '  Insert Sort of an array of integers\r\n    '---------------------------------------\r\n\r\n    Dim index As Long, first As Long\r\n    Dim last As Long, middle As Long\r\n    Dim firstItem As Long\r\n    Dim itemLen As Integer\r\n    Dim inverseOrder As Boolean\r\n    Dim value As Integer\r\n\r\n    ' account for optional arguments\r\n    If IsMissing(numEls) Then numEls = UBound(arr)\r\n    If IsMissing(descending) Then descending = False\r\n    inverseOrder = (descending <> False)\r\n    \r\n    firstItem = LBound(arr)\r\n    ' this approach makes the routine easily modifiable\r\n    itemLen = Len(arr(firstItem))\r\n\r\n    For index = firstItem + 1 To numEls\r\n        value = arr(index)\r\n\r\n        If ((value < arr(index - 1)) Xor inverseOrder) Then\r\n            ' (this nested IF spares a comparison if not really needed\r\n            If (value <> arr(index - 1)) Then\r\n                ' the element is out of order: search the subarray arr(1 to index-1)\r\n                ' for locating the position it should occupy\r\n                ' since subarray is already sorted we can use binary search\r\n                first = firstItem\r\n                last = index - 1\r\n                Do\r\n                    middle = (first + last) \\ 2\r\n                    If arr(middle) = value Then\r\n                        first = middle: Exit Do\r\n                    ElseIf ((arr(middle) < value) Xor inverseOrder) Then\r\n                        first = middle + 1\r\n                    Else\r\n                        last = middle - 1\r\n                    End If\r\n                Loop Until first > last\r\n                ' insert the value in arr(first), shifting items\r\n                ' with higher indexes\r\n                CopyMemory arr(first + 1), arr(first), (index - firstItem - first + 1) * itemLen\r\n                arr(first) = value\r\n            End If\r\n        End If\r\n    Next index\r\n\r\nEnd Sub\r\n\r\nSub InsertSortL(arr() As Long, Optional ByVal numEls As Variant, Optional ByVal descending As Variant)\r\n\r\n    '---------------------------------------\r\n    '  Insert Sort of an array of long\r\n    '---------------------------------------\r\n\r\n    Dim index As Long, first As Long\r\n    Dim last As Long, middle As Long\r\n    Dim firstItem As Long\r\n    Dim itemLen As Integer\r\n    Dim inverseOrder As Boolean\r\n    Dim value As Long\r\n\r\n    ' account for optional arguments\r\n    If IsMissing(numEls) Then numEls = UBound(arr)\r\n    If IsMissing(descending) Then descending = False\r\n    inverseOrder = (descending <> False)\r\n    \r\n    firstItem = LBound(arr)\r\n    ' this approach makes the routine easily modifiable\r\n    itemLen = Len(arr(firstItem))\r\n\r\n    For index = firstItem + 1 To numEls\r\n        value = arr(index)\r\n\r\n        If ((value < arr(index - 1)) Xor inverseOrder) Then\r\n            ' (this nested IF spares a comparison if not really needed\r\n            If (value <> arr(index - 1)) Then\r\n                ' the element is out of order: search the subarray arr(1 to index-1)\r\n                ' for locating the position it should occupy\r\n                ' since subarray is already sorted we can use binary search\r\n                first = firstItem\r\n                last = index - 1\r\n                Do\r\n                    middle = (first + last) \\ 2\r\n                    If arr(middle) = value Then\r\n                        first = middle: Exit Do\r\n                    ElseIf ((arr(middle) < value) Xor inverseOrder) Then\r\n                        first = middle + 1\r\n                    Else\r\n                        last = middle - 1\r\n                    End If\r\n                Loop Until first > last\r\n                ' insert the value in arr(first), shifting items\r\n                ' with higher indexes\r\n                CopyMemory arr(first + 1), arr(first), (index - firstItem - first + 1) * itemLen\r\n                arr(first) = value\r\n            End If\r\n        End If\r\n    Next index\r\n\r\nEnd Sub\r\n\r\nSub InsertSortS(arr() As Single, Optional ByVal numEls As Variant, Optional ByVal descending As Variant)\r\n\r\n    '---------------------------------------\r\n    '  Insert Sort of an array of Single\r\n    '---------------------------------------\r\n\r\n    Dim index As Long, first As Long\r\n    Dim last As Long, middle As Long\r\n    Dim firstItem As Long\r\n    Dim itemLen As Integer\r\n    Dim inverseOrder As Boolean\r\n    Dim value As Single\r\n\r\n    ' account for optional arguments\r\n    If IsMissing(numEls) Then numEls = UBound(arr)\r\n    If IsMissing(descending) Then descending = False\r\n    inverseOrder = (descending <> False)\r\n    \r\n    firstItem = LBound(arr)\r\n    ' this approach makes the routine easily modifiable\r\n    itemLen = Len(arr(firstItem))\r\n\r\n    For index = firstItem + 1 To numEls\r\n        value = arr(index)\r\n\r\n        If ((value < arr(index - 1)) Xor inverseOrder) Then\r\n            ' (this nested IF spares a comparison if not really needed\r\n            If (value <> arr(index - 1)) Then\r\n                ' the element is out of order: search the subarray arr(1 to index-1)\r\n                ' for locating the position it should occupy\r\n                ' since subarray is already sorted we can use binary search\r\n                first = firstItem\r\n                last = index - 1\r\n                Do\r\n                    middle = (first + last) \\ 2\r\n                    If arr(middle) = value Then\r\n                        first = middle: Exit Do\r\n                    ElseIf ((arr(middle) < value) Xor inverseOrder) Then\r\n                        first = middle + 1\r\n                    Else\r\n                        last = middle - 1\r\n                    End If\r\n                Loop Until first > last\r\n                ' insert the value in arr(first), shifting items\r\n                ' with higher indexes\r\n                CopyMemory arr(first + 1), arr(first), (index - firstItem - first + 1) * itemLen\r\n                arr(first) = value\r\n            End If\r\n        End If\r\n    Next index\r\n\r\nEnd Sub\r\n\r\nSub InsertSortD(arr() As Double, Optional ByVal numEls As Variant, Optional ByVal descending As Variant)\r\n\r\n    '---------------------------------------\r\n    '  Insert Sort of an array of Double\r\n    '---------------------------------------\r\n\r\n    Dim index As Long, first As Long\r\n    Dim last As Long, middle As Long\r\n    Dim firstItem As Long\r\n    Dim itemLen As Integer\r\n    Dim inverseOrder As Boolean\r\n    Dim value As Double\r\n\r\n    ' account for optional arguments\r\n    If IsMissing(numEls) Then numEls = UBound(arr)\r\n    If IsMissing(descending) Then descending = False\r\n    inverseOrder = (descending <> False)\r\n    \r\n    firstItem = LBound(arr)\r\n    ' this approach makes the routine easily modifiable\r\n    itemLen = Len(arr(firstItem))\r\n\r\n    For index = firstItem + 1 To numEls\r\n        value = arr(index)\r\n\r\n        If ((value < arr(index - 1)) Xor inverseOrder) Then\r\n            ' (this nested IF spares a comparison if not really needed\r\n            If (value <> arr(index - 1)) Then\r\n                ' the element is out of order: search the subarray arr(1 to index-1)\r\n                ' for locating the position it should occupy\r\n                ' since subarray is already sorted we can use binary search\r\n                first = firstItem\r\n                last = index - 1\r\n                Do\r\n                    middle = (first + last) \\ 2\r\n                    If arr(middle) = value Then\r\n                        first = middle: Exit Do\r\n                    ElseIf ((arr(middle) < value) Xor inverseOrder) Then\r\n                        first = middle + 1\r\n                    Else\r\n                        last = middle - 1\r\n                    End If\r\n                Loop Until first > last\r\n                ' insert the value in arr(first), shifting items\r\n                ' with higher indexes\r\n                CopyMemory arr(first + 1), arr(first), (index - firstItem - first + 1) * itemLen\r\n                arr(first) = value\r\n            End If\r\n        End If\r\n    Next index\r\n\r\nEnd Sub\r\n\r\nSub InsertSortC(arr() As Currency, Optional ByVal numEls As Variant, Optional ByVal descending As Variant)\r\n\r\n    '---------------------------------------\r\n    '  Insert Sort of an array of Currency\r\n    '---------------------------------------\r\n\r\n    Dim index As Long, first As Long\r\n    Dim last As Long, middle As Long\r\n    Dim firstItem As Long\r\n    Dim itemLen As Integer\r\n    Dim inverseOrder As Boolean\r\n    Dim value As Currency\r\n\r\n    ' account for optional arguments\r\n    If IsMissing(numEls) Then numEls = UBound(arr)\r\n    If IsMissing(descending) Then descending = False\r\n    inverseOrder = (descending <> False)\r\n    \r\n    firstItem = LBound(arr)\r\n    ' this approach makes the routine easily modifiable\r\n    itemLen = Len(arr(firstItem))\r\n\r\n    For index = firstItem + 1 To numEls\r\n        value = arr(index)\r\n\r\n        If ((value < arr(index - 1)) Xor inverseOrder) Then\r\n            ' (this nested IF spares a comparison if not really needed\r\n            If (value <> arr(index - 1)) Then\r\n                ' the element is out of order: search the subarray arr(1 to index-1)\r\n                ' for locating the position it should occupy\r\n                ' since subarray is already sorted we can use binary search\r\n                first = firstItem\r\n                last = index - 1\r\n                Do\r\n                    middle = (first + last) \\ 2\r\n                    If arr(middle) = value Then\r\n                        first = middle: Exit Do\r\n                    ElseIf ((arr(middle) < value) Xor inverseOrder) Then\r\n                        first = middle + 1\r\n                    Else\r\n                        last = middle - 1\r\n                    End If\r\n                Loop Until first > last\r\n                ' insert the value in arr(first), shifting items\r\n                ' with higher indexes\r\n                CopyMemory arr(first + 1), arr(first), (index - firstItem - first + 1) * itemLen\r\n                arr(first) = value\r\n            End If\r\n        End If\r\n    Next index\r\n\r\nEnd Sub\r\n\r\nSub InsertSortDate(arr() As Date, Optional ByVal numEls As Variant, Optional ByVal descending As Variant)\r\n\r\n    '---------------------------------------\r\n    '  Insert Sort of an array of Date\r\n    '---------------------------------------\r\n\r\n    Dim index As Long, first As Long\r\n    Dim last As Long, middle As Long\r\n    Dim firstItem As Long\r\n    Dim itemLen As Integer\r\n    Dim inverseOrder As Boolean\r\n    Dim value As Date\r\n\r\n    ' account for optional arguments\r\n    If IsMissing(numEls) Then numEls = UBound(arr)\r\n    If IsMissing(descending) Then descending = False\r\n    inverseOrder = (descending <> False)\r\n    \r\n    firstItem = LBound(arr)\r\n    ' this approach makes the routine easily modifiable\r\n    itemLen = Len(arr(firstItem))\r\n\r\n    For index = firstItem + 1 To numEls\r\n        value = arr(index)\r\n\r\n        If ((value < arr(index - 1)) Xor inverseOrder) Then\r\n            ' (this nested IF spares a comparison if not really needed\r\n            If (value <> arr(index - 1)) Then\r\n                ' the element is out of order: search the subarray arr(1 to index-1)\r\n                ' for locating the position it should occupy\r\n                ' since subarray is already sorted we can use binary search\r\n                first = firstItem\r\n                last = index - 1\r\n                Do\r\n                    middle = (first + last) \\ 2\r\n                    If arr(middle) = value Then\r\n                        first = middle: Exit Do\r\n                    ElseIf ((arr(middle) < value) Xor inverseOrder) Then\r\n                        first = middle + 1\r\n                    Else\r\n                        last = middle - 1\r\n                    End If\r\n                Loop Until first > last\r\n                ' insert the value in arr(first), shifting items\r\n                ' with higher indexes\r\n                CopyMemory arr(first + 1), arr(first), (index - firstItem - first + 1) * itemLen\r\n                arr(first) = value\r\n            End If\r\n        End If\r\n    Next index\r\n\r\nEnd Sub\r\n\r\nSub InsertSortStr(arr() As String, Optional ByVal numEls As Variant, Optional ByVal descending As Variant)\r\n\r\n    '---------------------------------------\r\n    '  Insert Sort of an array of strings\r\n    '---------------------------------------\r\n\r\n    Dim index As Long, first As Long\r\n    Dim last As Long, middle As Long\r\n    Dim firstItem As Long, i As Long\r\n    Dim inverseOrder As Boolean\r\n    Dim value As String\r\n    \r\n    ' account for optional arguments\r\n    If IsMissing(numEls) Then numEls = UBound(arr)\r\n    If IsMissing(descending) Then descending = False\r\n    inverseOrder = (descending <> False)\r\n    \r\n    firstItem = LBound(arr)\r\n\r\n    For index = firstItem + 1 To numEls\r\n        value = arr(index)\r\n\r\n        If ((value < arr(index - 1)) Xor inverseOrder) Then\r\n            ' (this nested IF spares a comparison if not really needed\r\n            If (value <> arr(index - 1)) Then\r\n                ' the element is out of order: search the subarray arr(1 to index-1)\r\n                ' for locating the position it should occupy\r\n                ' since subarray is already sorted we can use binary search\r\n                first = firstItem\r\n                last = index - 1\r\n                Do\r\n                    middle = (first + last) \\ 2\r\n                    If arr(middle) = value Then\r\n                        first = middle: Exit Do\r\n                    ElseIf ((arr(middle) < value) Xor inverseOrder) Then\r\n                        first = middle + 1\r\n                    Else\r\n                        last = middle - 1\r\n                    End If\r\n                Loop Until first > last\r\n                ' insert the value in arr(first), shifting items\r\n                ' with higher indexes\r\n                For i = index To first + 1 Step -1\r\n                    arr(i) = arr(i - 1)\r\n                Next\r\n                arr(first) = value\r\n            End If\r\n        End If\r\n    Next index\r\n\r\nEnd Sub\r\n\r\nSub InsertSortStrC(arr() As String, Optional ByVal numEls As Variant, Optional ByVal descending As Variant)\r\n\r\n    '---------------------------------------\r\n    ' Insert Sort of an array of strings\r\n    ' Case-unsensitive version\r\n    '---------------------------------------\r\n\r\n    Dim index As Long, first As Long\r\n    Dim last As Long, middle As Long\r\n    Dim firstItem As Long, i As Long\r\n    Dim inverseOrder As Boolean\r\n    Dim value As String\r\n    Dim valueLC As String\r\n    \r\n    ' account for optional arguments\r\n    If IsMissing(numEls) Then numEls = UBound(arr)\r\n    If IsMissing(descending) Then descending = False\r\n    inverseOrder = (descending <> False)\r\n    \r\n    firstItem = LBound(arr)\r\n\r\n    For index = firstItem + 1 To numEls\r\n        value = arr(index)\r\n        valueLC = LCase$(value)\r\n\r\n        If ((valueLC < LCase$(arr(index - 1))) Xor inverseOrder) Then\r\n            ' (this nested IF spares a comparison if not really needed\r\n            If (valueLC <> LCase$(arr(index - 1))) Then\r\n                ' the element is out of order: search the subarray arr(1 to index-1)\r\n                ' for locating the position it should occupy\r\n                ' since subarray is already sorted we can use binary search\r\n                first = firstItem\r\n                last = index - 1\r\n                Do\r\n                    middle = (first + last) \\ 2\r\n                    If LCase$(arr(middle)) = valueLC Then\r\n                        first = middle: Exit Do\r\n                    ElseIf ((LCase$(arr(middle)) < valueLC) Xor inverseOrder) Then\r\n                        first = middle + 1\r\n                    Else\r\n                        last = middle - 1\r\n                    End If\r\n                Loop Until first > last\r\n                ' insert the value in arr(first), shifting items\r\n                ' with higher indexes\r\n                For i = index To first + 1 Step -1\r\n                    arr(i) = arr(i - 1)\r\n                Next\r\n                arr(first) = value\r\n            End If\r\n        End If\r\n    Next index\r\n\r\nEnd Sub\r\n\r\nSub InsertSortV(arr() As Variant, Optional ByVal numEls As Variant, Optional ByVal descending As Variant)\r\n\r\n    '---------------------------------------\r\n    '  Insert Sort of an array of Variants\r\n    '---------------------------------------\r\n\r\n    Dim index As Long, first As Long\r\n    Dim last As Long, middle As Long\r\n    Dim firstItem As Long, i As Long\r\n    Dim inverseOrder As Boolean\r\n    Dim value As Variant\r\n    \r\n    ' account for optional arguments\r\n    If IsMissing(numEls) Then numEls = UBound(arr)\r\n    If IsMissing(descending) Then descending = False\r\n    inverseOrder = (descending <> False)\r\n    \r\n    firstItem = LBound(arr)\r\n\r\n    For index = firstItem + 1 To numEls\r\n        value = arr(index)\r\n\r\n        If ((value < arr(index - 1)) Xor inverseOrder) Then\r\n            ' (this nested IF spares a comparison if not really needed\r\n            If (value <> arr(index - 1)) Then\r\n                ' the element is out of order: search the subarray arr(1 to index-1)\r\n                ' for locating the position it should occupy\r\n                ' since subarray is already sorted we can use binary search\r\n                first = firstItem\r\n                last = index - 1\r\n                Do\r\n                    middle = (first + last) \\ 2\r\n                    If arr(middle) = value Then\r\n                        first = middle: Exit Do\r\n                    ElseIf ((arr(middle) < value) Xor inverseOrder) Then\r\n                        first = middle + 1\r\n                    Else\r\n                        last = middle - 1\r\n                    End If\r\n                Loop Until first > last\r\n                ' insert the value in arr(first), shifting items\r\n                ' with higher indexes\r\n                For i = index To first + 1 Step -1\r\n                    arr(i) = arr(i - 1)\r\n                Next\r\n                arr(first) = value\r\n            End If\r\n        End If\r\n    Next index\r\n\r\nEnd Sub\r\n","Declares":"#If Win16 Then\r\nDeclare Sub CopyMemory Lib \"Kernel\" Alias \"hmemcpy\" (dest As Any, source As Any, ByVal numBytes As Long)\r\n#Else\r\nDeclare Sub CopyMemory Lib \"kernel32\" Alias \"RtlMoveMemory\" (dest As Any, source As Any, ByVal numBytes As Long)\r\n#End If","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Sort","Insertion Sort"]},{"RecordId":"331","Title":"Copy Picture from 1 control to another (quick)","Description":"Copies picture from one control to another using BitBlt() API","Code":"Sub Picture1_Click()\r\n\r\nDim hDestDC%, hSrcDC%, XSrc%, YSrc%, X%, Y%, nWidth%, nHeight%, \r\ndwRop&, retVal%\r\n\r\n'The next 3 lines can be omitted if you set the picture controls to pixel in design view.\r\nConst PIXEL = 3\r\nPicture1.ScaleMode = PIXEL\r\nPicture2.ScaleMode = PIXEL\r\n\r\n'The hDC property returns a handle to the device context of an object provided by windows\r\nhDestDC = Picture2.hDC\r\nX = 0\r\nY = 0\r\nnWidth = Picture2.ScaleWidth\r\nnHeight = Picture2.ScaleHeight\r\nhSrcDC = Picture1.hDC\r\nXSrc = 0\r\nYSrc = 0\r\n\r\n'The windows SDK documents other values for the raster operation parameter of BitBlt\r\ndwRop = &HCC0020\r\nretVal = BitBlt(hDestDC, X, Y, nWidth, nHeight, hSrcDC, XSrc, YSrc, dwRop)\r\n\r\n'Clear image from picture1\r\nPicture1 = LoadPicture()\r\n\r\nEnd Sub","Declares":"Declare Function BitBlt Lib \"GDI\" (ByVal hDestDC As Integer, ByVal X As Integer, ByVal Y As Integer, ByVal nWidth As Integer, ByVal nHeight As Integer, ByVal hSrcDC As Integer, ByVal dwRop As Long) As Integer","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Bitmap Copy","BitBlt"]},{"RecordId":"332","Title":"Create Subdirectories on the Fly","Description":"Creates complete directory tree for specified path","Code":"Dim MyPath As String\r\nDim lngRetVal As Long\r\n\r\nMyPath = \"c:\\sub1\\sub2\\sub3\\\"\r\nlngRetVal = MakeSureDirectoryPathExists(MyPath)\r\n\r\nIf lngRetVal = 0 Then\r\n   MsgBox \"It did not work\"\r\nEnd If\r\n","Declares":"Private Declare Function MakeSureDirectoryPathExists Lib \"IMAGEHLP.DLL\" (ByVal DirPath As String) As Long\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Directory","Path"]},{"RecordId":"333","Title":"Initialize A Database","Description":"This code sets up and initializes the CODMANxx.MDB database.","Code":"Sub InitializeDatabase (Database As String)\r\n    On Error Resume Next\r\n    Dim DB As Database, DBName As String, i As Integer\r\n\r\n    DBName = Database\r\n    If Trim(DBName) = \"\" Then DBName = \"DATABASE.MDB\"\r\n    ChDir app.Path\r\n    On Local Error Resume Next\r\n    Dim Retried As Integer\r\n    Retried = False\r\nOpenDataBaseFile:\r\n    Set DB = OpenDatabase(DBName)\r\n    Select Case Err\r\n    Case 3043: MsgBox \"Database engine error - Unrecoverable error\", 16: Close : End\r\n    Case 3049:\r\n      If Not Retried Then\r\n        Retried = True\r\n        MsgBox \"Database is corrupted - Click OK to attempt repairs\", 16\r\n        RepairDatabase DBName\r\n        GoTo OpenDataBaseFile\r\n      Else\r\n        MsgBox \"Database is corrupted - Cannot repair it\", 16: Close : End\r\n      End If\r\n    Case 0: ' Database opened fine\r\n    Case Else: GoTo CreateDataBaseFile\r\n    End Select\r\nExit Sub\r\n\r\nCreateDataBaseFile:\r\n    On Error GoTo DBCreateErr\r\n    Set DB = CreateDatabase(DBName, DB_LANG_GENERAL)\r\n    GoSub CreateCodeTable\r\n    GoTo OpenDataBaseFile\r\nDBCreateErr:\r\n    MsgBox \"Unable to create database - Unrecoverable error\", 16: Close : End\r\nResume Next\r\n\r\nCreateCodeTable:\r\n    Dim RT As New TableDef\r\n    Dim RX As New Index\r\n    ReDim Fld(1 To 5) As New Field\r\n    ' Assign properties Table Fields\r\n    ' ==============================================\r\n    RT.Name = \"Procedures\"\r\n    For i = 1 To 5  ' Set properties for fields.\r\n        Fld(i).Name = Choose(i, \"Procedure\", \"Desc\", \"Declarations\", \"ModuleCode\", \"EventCode\")\r\n        Select Case i\r\n            Case 1: Fld(i).Type = DB_TEXT\r\n            Case Else: Fld(i).Type = DB_MEMO\r\n        End Select\r\n        If i < 2 Then Fld(i).Size = Choose(i, 40)\r\n        RT.Fields.Append Fld(i)\r\n    Next i\r\n    ' Assign the properties of the Table's Primary Index File\r\n    RX.Name = \"ProcIndex\"\r\n    RX.Fields = \"Procedure\"\r\n    RX.Primary = True\r\n    ' Add the Index to the Table's index collection\r\n    RT.Indexes.Append RX\r\n    ' Add the Table to the Database\r\n    DB.TableDefs.Append RT\r\nReturn\r\n\r\nEnd Sub\r\n","Declares":"","CodeCategory":{"CategoryId":"3","CategoryDescription":"Database"},"Keywords":["MDB Table Creation"]},{"RecordId":"334","Title":"Cross-Tab Query in SQL Server (2)","Description":"Creates a cross-tab query from a SQL Server table using Transact SQL","Code":"SELECT   btd_customer_account_nbr,\r\n\t Jan = SUM( btd_quantity * ( 1 - ABS( SIGN (DATEPART( MONTH, btd_trans_date) - 1)))),\r\n\t Feb = SUM( btd_quantity * ( 1 - ABS( SIGN (DATEPART( MONTH, btd_trans_date) - 2)))),\r\n\t Mar = SUM( btd_quantity * ( 1 - ABS( SIGN (DATEPART( MONTH, btd_trans_date) - 3)))),\r\n\t Apr = SUM( btd_quantity * ( 1 - ABS( SIGN (DATEPART( MONTH, btd_trans_date) - 4)))),\r\n\t May = SUM( btd_quantity * ( 1 - ABS( SIGN (DATEPART( MONTH, btd_trans_date) - 5)))),\r\n\t Jun = SUM( btd_quantity * ( 1 - ABS( SIGN (DATEPART( MONTH, btd_trans_date) - 6)))),\r\n\t Jul = SUM( btd_quantity * ( 1 - ABS( SIGN (DATEPART( MONTH, btd_trans_date) - 7)))),\r\n\t Aug = SUM( btd_quantity * ( 1 - ABS( SIGN (DATEPART( MONTH, btd_trans_date) - 8)))),\r\n\t Sep = SUM( btd_quantity * ( 1 - ABS( SIGN (DATEPART( MONTH, btd_trans_date) - 9)))),\r\n\t Oct = SUM( btd_quantity * ( 1 - ABS( SIGN (DATEPART( MONTH, btd_trans_date) - 10)))),\r\n\t Nov = SUM( btd_quantity * ( 1 - ABS( SIGN (DATEPART( MONTH, btd_trans_date) - 11)))),\r\n\t Dec = SUM( btd_quantity * ( 1 - ABS( SIGN (DATEPART( MONTH, btd_trans_date) - 12))))\r\n\r\nFROM \t Bits_Trade_Data\r\n\r\nGROUP BY btd_customer_account_nbr\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"6","CategoryDescription":"T-SQL"},"Keywords":["Cross Tab","Cross-tab Query","SQL Server"]},{"RecordId":"335","Title":"Help (Accessing it)","Description":"Myriad of help calls","Code":"Sub ShowHelp ()\r\n\r\nDim R As Integer\r\n\r\n'To go to the CONTENTS topic\r\nR = WinHelp(Form1.hWnd, \"MyHelp.HLP\", HELP_CONTENTS, CLng(0))\r\n\r\n'To display the Search dialog box\r\nR = WinHelp(Form1.hWnd, \"MyHelp.HLP\", HELP_PARTIALKEY, \"\")\r\n\r\n'To display the Search dialog box and begin at a string\r\nR = WinHelp(Form1.hWnd, \"MyHelp.HLP\", HELP_PARTIALKEY, \"My string goes here\")\r\n\r\n'To display the topic based on a predefined key word\r\nR = WinHelp(Form1.hWnd, \"MyHelp.HLP\", HELP_KEY, \"My keyword string goes here\")\r\n\r\n'To display the How to Use Help dialog\r\nR = WinHelp(Form1.hWnd, \"\", HELP_HELPONHELP, CLng(0))\r\n\r\n'To display Help using a Help Context ID\r\nR = WinHelp(Form1.hWnd, \"MyHelp.HLP\", HELP_CONTEXT, CLng(Context1))\r\n\r\n'To close help (it doesnt automatically close when your program closes.\r\nR = WinHelp(Form1.hWnd, \"MyHelp.HLP\", HELP_QUIT, CLng(0))\r\n\r\n'To position the help window at a specific place and a specific size.\r\n'Note that the WinHelp engine uses a 1024 x 1024 coordinate system.\r\n'You will need to convert to pixels or twips to coincide with this.\r\n\r\nDim NewPos As HELPWININFO\r\n\r\nNewPos.wStructSize = 12\r\nNewPos.x = 10\r\nNewPos.y = 10\r\nNewPos.Width = 100\r\nNewPos.Height = 100\r\nNewPos.wMax = SW_SHOWNORMAL\r\nNewPos.rgchMember = \"\"\r\n\r\nR = WinHelpType(Form1.hWnd, \"MyHelp.HLP\", HELP_SETWINDOWPOS, NewPos)\r\n\r\n\r\n'To force the display of a specified help file if it is not already\r\n'displayed.  This is useful if you want to make sure the help file\r\n'gets displayed, but you dont want it to go to the CONTENTS topic if\r\n'the user is already at another topic.  If it is not displayed, it\r\n'will be displayed on the CONTENTS topic.\r\nR = WinHelp(Form1.hWnd, \"MyHelp.HLP\", HELP_FORCEFILE, CLng(0))\r\n\r\nEnd Sub\r\n","Declares":"Type HELPWININFO\r\n    '12 bytes + length of rgchMember\r\n    wStructSize As Integer\r\n    x As Integer\r\n    y As Integer\r\n    Width As Integer\r\n    Height As Integer\r\n    wMax As Integer\r\n    rgchMember As String * 2\r\n    'Length varies depending on window name\r\nEnd Type\r\n\r\n'Help constants\r\nGlobal Const HELP_CONTEXT = &H1\r\nGlobal Const HELP_QUIT = &H2\r\nGlobal Const HELP_CONTENTS = &H3\r\nGlobal Const HELP_HELPONHELP = &H4\r\nGlobal Const HELP_FORCEFILE = &H9\r\nGlobal Const HELP_KEY = &H101\r\nGlobal Const HELP_COMMAND = &H102\r\nGlobal Const HELP_PARTIALKEY = &H105\r\nGlobal Const HELP_SETWINDOWPOS = &H203\r\n\r\n'Help context IDs\r\nGlobal Const Context1 = 1000\r\nGlobal Const Context2 = 1001\r\n\r\n'Window state constants\r\nGlobal Const SW_HIDE = 0\r\nGlobal Const SW_SHOWNORMAL = 1\r\nGlobal Const SW_SHOWMINIMIZED = 2\r\nGlobal Const SW_SHOWMAXIMIZED = 3\r\nGlobal Const SW_SHOWNOACTIVE = 4\r\nGlobal Const SW_SHOW = 5\r\nGlobal Const SW_MINIMIZE = 6\r\nGlobal Const SW_SHOWMINNOACTIVE = 7\r\nGlobal Const SW_SHOWNA = 8\r\nGlobal Const SW_RESTORE = 9\r\n\r\nDeclare Function WinHelp Lib \"User\" (ByVal hWnd As Integer, ByVal lpHelpFile As String, ByVal wCommand As Integer, dwData As Any) As Integer\r\nDeclare Function WinHelpType Lib \"User\" Alias \"WinHelp\" (ByVal hWnd As Integer, ByVal lpHelpFile As String, ByVal wCommand As Integer, dwData As Any) As Integer\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Help","WinHelp"]},{"RecordId":"337","Title":"Persisting Class Data","Description":"Demonstrates using a class to save object with ADO and metadata","Code":"'--------------------------------------------------------------------------\r\n' Class1 (Exposed to the client.  Internally calls Class2\r\n'--------------------------------------------------------------------------\r\nOption Explicit\r\n\r\nPrivate datInvoiceDate As Date\r\nPrivate curAmount As Currency\r\n\r\n\r\nPublic Property Let InvoiceDate(ByVal DateIn As Date)\r\n    datInvoiceDate = DateIn\r\nEnd Property\r\n\r\nPublic Property Let InvoiceAmount(ByVal AmountIn As Currency)\r\n    curAmount = AmountIn\r\nEnd Property\r\n\r\nPublic Function Save() As Long\r\n\r\nDim vMeta As Variant\r\nDim vData As Variant\r\nDim oSave As New Class2\r\n\r\nvMeta = Array(\"InvoiceDate\", \"Amount\")\r\nvData = Array(datInvoiceDate, curAmount)\r\noSave.Persist vMeta, vData\r\n\r\nEnd Function\r\n\r\n'--------------------------------------------------------------------------\r\n' Class2 (Called by Class1 to save the data\r\n'--------------------------------------------------------------------------\r\nOption Explicit\r\n\r\nPublic Function Persist(ByVal vMeta As Variant, ByVal vData As Variant) As Long\r\n\r\nDim cn As New ADODB.Connection\r\nDim rs As New ADODB.Recordset\r\n\r\ncn.Open \"ConnectString\"\r\nrs.Open \"tblInvoice\", cn, adOpenKeyset, adLockOptimistic\r\n\r\nrs.AddNew\r\nrs.Update vMeta, vData\r\n\r\nPersist = rs.Fields(\"ID\")\r\n\r\nrs.Close\r\ncn.Close\r\n\r\nSet rs = Nothing\r\nSet cn = Nothing\r\n\r\nEnd Function\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Metadata","ADO","Persist"]},{"RecordId":"338","Title":"ProgMan - Delete Program Manager Group","Description":"Delete a group from Program Manager","Code":"Sub DeleteProgManGroup (xForm As Form, GroupName As String)\r\n    \r\n    ' Sub/Function Name       : CreateProgManGroup\r\n    ' Purpose                 : Create Program Manager Group\r\n    ' Parameters              : xForm (Form with Label called DDELabel)\r\n    '                           Groupname (Name of Group to delete)\r\n    ' Created by              : Paul Treffers\r\n    ' Date Created            : 12/05/95\r\n    \r\n    \r\n    Dim I%\r\n    Dim Z%\r\n    Screen.MousePointer = 11\r\n    On Error Resume Next\r\n    xForm.DDELabel.LinkTopic = \"ProgMan|Progman\"\r\n    xForm.DDELabel.LinkMode = 2\r\n    For I% = 1 To 10                                         ' Loop to ensure that there is enough time to\r\n      Z% = DoEvents()                                        ' process DDE Execute.  This is redundant but needed\r\n    Next                                                     ' for debug windows.\r\n    xForm.DDELabel.LinkTimeout = 100\r\n    xForm.DDELabel.LinkExecute \"[DeleteGroup(\" + GroupName$ + \")]\"\r\n    xForm.DDELabel.LinkTimeout = 50\r\n    xForm.DDELabel.LinkMode = 0\r\n    Screen.MousePointer = 0\r\n\r\nEnd Sub","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Delete Program Manager Group","Setup","ProgMan"]},{"RecordId":"339","Title":"File Info","Description":"Retrieves file information (date created/changed, etc.)","Code":"'-----------------------------------------\r\nCLASS\r\n\r\nDim m_strFileName As String\r\nDim m_bShortDate As Boolean\r\n\r\nProperty Let FileName(fname As String)\r\n\tDim strTemp As String\r\n\tstrTemp = m_strFileName\r\n\tm_strFileName = fname\r\n    \r\n\t'The file has to exist or we throw an error\r\n\tIf Not FileExists Then\r\n\t\tm_strFileName = strTemp\r\n\t\tError 53  'File not found\r\n\tEnd If\r\nEnd Property\r\n\r\nProperty Get ReadOnly() As Boolean\r\n\tDim i As Integer\r\n    \r\n\tIf Not FileExists Then\r\n\t\tError 53  'File not found\r\n\tEnd If\r\n    \r\n\ti = GetAttr(m_strFileName)\r\n\tIf i And vbReadOnly Then\r\n\t\tReadOnly = True\r\n\tElse\r\n\t\tReadOnly = False\r\n\tEnd If\r\nEnd Property\r\n\r\nFunction Executable() As Long\r\n\t'This can Only be used under NT\r\n\tDim lResult As Long\r\n\tDim lType As Long\r\n    \r\n\tIf Not FileExists Then\r\n\t\tError 53 ' File Not Found\r\n\tEnd If\r\n    \r\n\tlResult = GetBinaryType(m_strFileName, lType)\r\n\tIf lResult Then\r\n\t\tExecutable = lType\r\n\tElse\r\n\t\tErr.Raise CFILE_ERROR_NTONLY, , _\r\n\t\t\t\"Only Available on Windows NT\"\r\n\tEnd If\r\nEnd Function\r\n\r\nProperty Get CreatedDate() As String\r\n\tIf Not FileExists Then\r\n\t\tError 53 ' File Not Found\r\n\tEnd If\r\n\r\n\tCreatedDate = GetFileDateOrTime(1)\r\nEnd Property\r\n\r\nProperty Get CreatedTime() As String\r\n\tIf Not FileExists Then\r\n\t\tError 53 ' File Not Found\r\n\tEnd If\r\n\r\n\tCreatedTime = GetFileDateOrTime(4)\r\nEnd Property\r\n\r\nProperty Get UpdatedDate() As String\r\n\tIf Not FileExists Then\r\n\t\tError 53 ' File Not Found\r\n\tEnd If\r\n\r\n\tUpdatedDate = GetFileDateOrTime(3)\r\nEnd Property\r\n\r\nProperty Get UpdatedTime() As String\r\n\tIf Not FileExists Then\r\n\t\tError 53 ' File Not Found\r\n\tEnd If\r\n\r\n\tUpdatedTime = GetFileDateOrTime(6)\r\nEnd Property\r\n\r\n\r\nProperty Get LastAccessedDate() As String\r\n\tIf Not FileExists Then\r\n\t\tError 53 ' File Not Found\r\n\tEnd If\r\n\r\n\tLastAccessedDate = GetFileDateOrTime(2)\r\nEnd Property\r\n\r\nPrivate Function GetFileDateOrTime(WhichValue _\r\n\tAs Integer) As String\r\n\tDim ofs As OFSTRUCT\r\n\tDim lHandle As Long\r\n\tDim lResult As Long\r\n\tDim ftCreated As FILETIME\r\n\tDim ftAccessed As FILETIME\r\n\tDim ftWritten As FILETIME\r\n\tDim lFileNum As Long\r\n    \r\n\tDim stDate As SYSTEMTIME\r\n\tDim ftTemp As FILETIME\r\n    \r\n\tlHandle = OpenFile(m_strFileName, ofs, OF_READ _\r\n\t\tOr OF_SHARE_DENY_NONE)\r\n    \r\n\t'If we have a valid handle\r\n\tIf lHandle <> -1 Then\r\n\t\tlResult = GetFileTime(lHandle, ftCreated, _\r\n\t\t\tftAccessed, ftWritten)\r\n\t\tlResult = CloseHandle(lHandle)\r\n        \r\n\t\t'Get the correct value based on which date/time \r\n\t\t'the caller wants\r\n\t\tSelect Case WhichValue\r\n\t\t\tCase 1, 4\r\n\t\t\t\tlResult = FileTimeToLocalFileTime_\r\n\t\t\t\t\t(ftCreated, ftTemp)\r\n\t\t\tCase 2, 5\r\n\t\t\t\tlResult = FileTimeToLocalFileTime_\r\n\t\t\t\t\t(ftAccessed, ftTemp)\r\n\t\t\tCase 3, 6\r\n\t\t\t\tlResult = FileTimeToLocalFileTime_\r\n\t\t\t\t\t(ftWritten, ftTemp)\r\n\t\t\tCase Else\r\n\t\t\t\tlResult = FileTimeToLocalFileTime_\r\n\t\t\t\t\t(ftCreated, ftTemp)\r\n\t\tEnd Select\r\n        \r\n\t\tlResult = FileTimeToSystemTime(ftTemp, stDate)\r\n        \r\n\t\t'if the caller of this routine is requesting a \r\n\t\t'date, return a date otherwise a time\r\n\t\tIf WhichValue <= 3 Then\r\n\t\t\tIf m_bShortDate Then\r\n\t\t\t\tGetFileDateOrTime = _\r\n\t\t\t\t\tFormat(Str$(stDate.wMonth) + \"/\" + _\r\n\t\t\t\t\tStr$(stDate.wDay) + \"/\" + _\r\n\t\t\t\t\tStr$(stDate.wYear), \"mm/dd/yy\")\r\n\t\t\tElse\r\n\t\t\t\tGetFileDateOrTime = _\r\n\t\t\t\t\tFormat(Str$(stDate.wMonth) + \"/\" + _\r\n\t\t\t\t\tStr$(stDate.wDay) + \"/\" + _\r\n\t\t\t\t\tStr$(stDate.wYear), \"long date\")\r\n\t\t\tEnd If\r\n\t\tElse\r\n\t\t\t\tGetFileDateOrTime = _\r\n\t\t\t\t\tFormat(Str$(stDate.wHour) + \":\" + _\r\n\t\t\t\t\tStr$(stDate.wMinute) + \":\" + _\r\n\t\t\t\t\tStr$(stDate.wSecond), \"hh:mm:ss\")\r\n\t\tEnd If\r\n        \r\n\tEnd If\r\nEnd Function\r\n\r\n\r\n'----------------------------\r\n'Usage\r\n\r\n    \r\n\tDim myfile As New CFile\r\n    \r\n\t'Set this to a file that exists on your system\r\n\t'myfile.FileName = \"c:\\ notepad.exe\"\r\n    \r\n\tPrint \"Filename:\", , , myfile.FileName\r\n\tPrint \"Is ReadOnly?\", , , myfile.ReadOnly\r\n\t'This method of our class only works on Win NT.\r\n\t'You can uncomment the next line if you are running\r\n\t'on NT.\r\n    \r\n\t'Print \"Is Executable?\", , , myfile.Executable\r\n    \r\n\tPrint \"===========\"\r\n\tPrint \"File Size\", , , myfile.Size\r\n\tPrint\r\n\tPrint \"Create Date:\", , , myfile.CreatedDate\r\n\tPrint \"Create Time:\", , , myfile.CreatedTime\r\n\tPrint\r\n\tPrint \"Last Accessed Date:\", , myfile.LastAccessedDate\r\n\tPrint\r\n\tPrint \"Last Updated Date:\", , myfile.UpdatedDate\r\n\tPrint \"Last Updated Time:\", , myfile.UpdatedTime\r\n","Declares":"Public Const OFS_MAXPATHNAME = 128\r\nPublic Const OF_READ = &H0\r\nPublic Const OF_SHARE_DENY_NONE = &H40\r\n\r\nType OFSTRUCT\r\n        cBytes As Byte\r\n        fFixedDisk As Byte\r\n        nErrCode As Integer\r\n        Reserved1 As Integer\r\n        Reserved2 As Integer\r\n        szPathName(OFS_MAXPATHNAME) As Byte\r\nEnd Type\r\n\r\nType FILETIME\r\n        dwLowDateTime As Long\r\n        dwHighDateTime As Long\r\nEnd Type\r\n\r\nType SYSTEMTIME\r\n        wYear As Integer\r\n        wMonth As Integer\r\n        wDayOfWeek As Integer\r\n        wDay As Integer\r\n        wHour As Integer\r\n        wMinute As Integer\r\n        wSecond As Integer\r\n        wMilliseconds As Integer\r\nEnd Type\r\n\r\nDeclare Function GetFileTime Lib \"kernel32\" (ByVal hFile As Long, lpCreationTime As FILETIME, lpLastAccessTime As FILETIME, lpLastWriteTime As FILETIME) As Long\r\nDeclare Function FileTimeToLocalFileTime Lib \"kernel32\" (lpFileTime As FILETIME, lpLocalFileTime As FILETIME) As Long\r\nDeclare Function FileTimeToSystemTime Lib \"kernel32\" (lpFileTime As FILETIME, lpSystemTime As SYSTEMTIME) As Long\r\nDeclare Function GetBinaryType Lib \"kernel32\" Alias \"GetBinaryTypeA\" (ByVal lpApplicationName As String, lpBinaryType As Long) As Long\r\nDeclare Function OpenFile Lib \"kernel32\" (ByVal lpFileName As String, lpReOpenBuff As OFSTRUCT, ByVal wStyle As Long) As Long\r\nDeclare Function CloseHandle Lib \"kernel32\" (ByVal hObject As Long) As Long\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["File Date/Time","File Info"]},{"RecordId":"340","Title":"Change Wallpaper","Description":"Changes Windows wallpaper","Code":"'Call wth:  ChangeWallpaper \"c:\\myfilem.bmp\"\r\n\r\nPublic Sub ChangeWallpaper(ByVal strBMP As String)\r\n  SystemParametersInfo SPI_SETDESKWALLPAPER, 0, strBMP, SPIF_UPDATEINIFILE Or SPIF_SENDWININICHANGE\r\nEnd Sub\r\n","Declares":"Private Const SPI_SETDESKWALLPAPER = 20\r\nPrivate Const SPIF_UPDATEINIFILE = &H1\r\nPrivate Const SPIF_SENDWININICHANGE = &H2\r\n\r\nDeclare Function SystemParametersInfo Lib \"user32\" Alias \"SystemParametersInfoA\" (ByVal uAction As Long, ByVal uParam As Long, ByVal lpvParam As Any, ByVal fuWinIni As Long) As Long\r\n\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Wallpaper","System Info"]},{"RecordId":"341","Title":"Retrieve UNC Path For a Drive","Description":"Returns UNC path for a drive letter","Code":"Public Function GetUNCPath(strDriveLetter As String) As String\r\n \r\n         On Local Error GoTo GetUNCPath_Err\r\n         \r\n         Dim Msg As String, lngReturn As Long\r\n         Dim lpszLocalName As String\r\n         Dim lpszRemoteName As String\r\n         Dim cbRemoteName As Long\r\n         \r\n         lpszLocalName = strDriveLetter\r\n         lpszRemoteName = Space$(255)\r\n         'String$(255, Chr$(32))\r\n         cbRemoteName = Len(lpszRemoteName)\r\n         \r\n         lngReturn = WNetGetConnection(lpszLocalName, lpszRemoteName, cbRemoteName)\r\n         Select Case lngReturn\r\n            Case ERROR_BAD_DEVICE\r\n               Msg = \"Error: Bad Device\"\r\n            Case ERROR_CONNECTION_UNAVAIL\r\n               Msg = \"Error: Connection Un-Available\"\r\n            Case ERROR_EXTENDED_ERROR\r\n               Msg = \"Error: Extended Error\"\r\n            Case ERROR_MORE_DATA\r\n               Msg = \"Error: More Data\"\r\n            Case ERROR_NOT_SUPPORTED\r\n               Msg = \"Error: Feature not Supported\"\r\n            Case ERROR_NO_NET_OR_BAD_PATH\r\n               Msg = \"Error: No Network Available or Bad Path\"\r\n            Case ERROR_NO_NETWORK\r\n               Msg = \"Error: No Network Available\"\r\n            Case ERROR_NOT_CONNECTED\r\n               Msg = \"Error: Not Connected\"\r\n            Case NO_ERROR\r\n               ' all is successful...\r\n         End Select\r\n         If Len(Msg) Then\r\n            MsgBox Msg, vbInformation\r\n         Else\r\n            ' Display the path in a Message box or return\r\n            ' the UNC through the function.\r\n          '  MsgBox Left$(lpszRemoteName, cbRemoteName)\r\n          If InStr(lpszRemoteName, vbNullChar) Then\r\n            GetUNCPath = Left$(lpszRemoteName, InStr(lpszRemoteName, vbNullChar) - 1)\r\n          End If\r\n         End If\r\nGetUNCPath_End:\r\n         Exit Function\r\nGetUNCPath_Err:\r\n         MsgBox Err.Description, vbInformation\r\n         Resume GetUNCPath_End\r\n      End Function\r\n\r\n","Declares":"Const ERROR_BAD_DEVICE = 1200&\r\nConst ERROR_CONNECTION_UNAVAIL = 1201&\r\nConst ERROR_EXTENDED_ERROR = 1208&\r\nConst ERROR_MORE_DATA = 234\r\nConst ERROR_NOT_SUPPORTED = 50&\r\nConst ERROR_NO_NET_OR_BAD_PATH = 1203&\r\nConst ERROR_NO_NETWORK = 1222&\r\nConst ERROR_NOT_CONNECTED = 2250&\r\nConst NO_ERROR = 0\r\n\r\nDeclare Function WNetGetConnection Lib \"mpr.dll\" Alias \"WNetGetConnectionA\" (ByVal lpszLocalName As String, ByVal lpszRemoteName As String, cbRemoteName As Long) As Long\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["UNC","Path","Network drive"]},{"RecordId":"342","Title":"Web Browser (IE)","Description":"Navigate to a URL using Internet Explorer","Code":"'  Requires a reference to \"Microsoft Internet Controls (ShDocVW.DLL)\"\r\n\r\nDim cWeb As New SHDocVw.InternetExplorer\r\ncWeb.Navigate \"http://www.usatoday.com\"\r\ncWeb.Visible = True\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["WWW","Web","Internet"]},{"RecordId":"343","Title":"Computer Name in Win95 and NT","Description":"Determines Win95 or NT computer name.","Code":"Dim strBuffer As String * 255\r\nDim lngRetVal As Long\r\n\r\nstrBuffer = Space(255)\r\nlngRetVal = GetComputerName(strBuffer, 255&)\r\nIf lngRetVal <> 0 Then\r\n    strBuffer = Left$(strBuffer, InStr(strBuffer, vbNullChar) - 1)\r\nEnd If\r\n","Declares":"Declare Function GetComputerName Lib \"kernel32\" Alias \"GetComputerNameA\" (ByVal lpBuffer As String, nSize As Long) As Long\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Computer Name","System Info"]},{"RecordId":"344","Title":"Minimize ALL Forms In Your App","Description":"To minimize all of your application's forms place the code below into the appropriate event which you want to trigger this action.","Code":"Dim iCount as Integer\r\n   For iCount = 0 To Forms.Count - 1\r\n      Forms(iCount).WindowState = 1  'Minimized\r\n   Next iCount\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Minimize Forms"]},{"RecordId":"345","Title":"Move Forms Without Title Bars","Description":"This example was posted on the internet and shows a way that a form without a title bar can be moved around by the user with a mouse.","Code":"'PLACE THE FOLLOWING INTO THE FORM_MOUSEDOWN EVENT\r\nIf Button = 1 Then\r\n   Dim ReturnVal%\r\n   ReleaseCapture\r\n   ReturnVal% = SendMessage(hWnd, WM_NCLBUTTONDOWN, HTCAPTION, 0)\r\nEnd Sub\r\n","Declares":"Declare Function SendMessage Lib \"User\" (ByVal hwnd As Integer, ByVal wMsg As Integer, ByVal wParam As Integer, lParam As Any) As Long\r\nDeclare Sub ReleaseCapture Lib \"User\" ()\r\nConst WM_NCLBUTTONDOWN = &HA1\r\nConst HTCAPTION = 2\r\n\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Move Forms","Caption Bar"]},{"RecordId":"346","Title":"Resize Combo Box Drown-down Width","Description":"Resizes the drop-down area of a combo box","Code":"Public Sub SetDropdownWidth(cboHWnd As Long, NewWidthPixel As Long)\r\n\r\nDim lRetVal As Long\r\n\r\nlRetVal = SendMessage(cboHWnd, CB_SETDROPPEDWIDTH, NewWidthPixel, 0)\r\n\r\nEnd Sub\r\n\r\n","Declares":"Declare Function SendMessage Lib \"user32\" Alias \"SendMessageA\" (ByVal hwnd As Long, ByVal wMsg As Long, ByVal wParam As Long, lParam As Any) As Long\r\n\r\nPrivate Const CB_SETDROPPEDWIDTH = &H160\r\nPrivate Const CB_ERR = -1\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Combo Box","Resize combo"]},{"RecordId":"347","Title":"Find Window  Text (32 bit)","Description":"Search windows task list for window containing string and optionally activates it to the foreground (32 bit)\r\nNOTE:  Text search works on partial and complete.","Code":"Function LookForWindow(strAppName As String, blnActivateWindow As Boolean) As Boolean\r\n\r\n    Dim hWnd As Long\r\n    Dim strWinTitle As String\r\n    Dim varRet As Long\r\n    Dim retval2 As Long\r\n    \r\n    LookForWindow = False\r\n    strAppName = UCase$(strAppName)\r\n    hWnd = FindWindowByNum(0&, 0&)\r\n    \r\n    Do Until hWnd = 0\r\n        If GetParent(hWnd) = 0 Then\r\n            strWinTitle = Space$(255)\r\n            varRet = GetWindowText(hWnd, strWinTitle, Len(strWinTitle))\r\n            If varRet Then\r\n                strWinTitle = Left$(strWinTitle, varRet)\r\n                strWinTitle = UCase$(strWinTitle)\r\n                If InStr(strWinTitle, strAppName) = 1 Then\r\n                    LookForWindow = True\r\n                    \r\n                    If blnActivateWindow Then\r\n                        retval2 = ShowWindow(hWnd, SW_NORMAL)\r\n                        retval2 = SetForegroundWindow(hWnd)\r\n                    End If\r\n                    \r\n                    Exit Do\r\n                End If\r\n            End If\r\n        End If\r\n        hWnd = GetWindow(hWnd, GW_HWNDNEXT)\r\n    Loop\r\n    \r\nEnd Function\r\n","Declares":"Declare Function FindWindowByNum Lib \"user32\" Alias \"FindWindowA\" (ByVal lpClassName As Long, ByVal lpWindowName As Long) As Long\r\nDeclare Function GetParent Lib \"user32\" (ByVal hWnd As Long) As Long\r\nDeclare Function GetWindowText Lib \"user32\" Alias \"GetWindowTextA\" (ByVal hWnd As Long, ByVal lpString As String, ByVal cch As Long) As Long\r\nDeclare Function GetWindow Lib \"user32\" (ByVal hWnd As Long, ByVal wCmd As Long) As Long\r\nDeclare Function ShowWindow Lib \"user32\" (ByVal hWnd As Long, ByVal nCmdShow As Long) As Long\r\nDeclare Function SetForegroundWindow Lib \"user32\" (ByVal hWnd As Long) As Long\r\n  \r\nGlobal Const GW_HWNDNEXT = 2\r\nGlobal Const SW_NORMAL = 1\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Find Window","Activate app","Running"]},{"RecordId":"348","Title":"Pause Processing By Seconds","Description":"Suspends processing for a few moments","Code":"Sub WaitSecs (secs)\r\nDim sTart!, Temp%\r\n\r\n    start! = Timer\r\n    While Timer < start! + secs +1\r\n         Temp% = DoEvents()\r\n    Wend\r\nEnd Sub\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Pause","Wait"]},{"RecordId":"350","Title":"Format/Diskcopy Routines","Description":"Format floppies.  Copy floppies.","Code":"Public Sub DiskCopy()\r\n\r\nDim DriveLetter As String\r\nDim DriveNumber As Long\r\nDim DriveType As Long\r\nDim RetVal As Long\r\nDim RetFromMsg As Long\r\n\r\nDriveLetter = \"A\"\r\nDriveNumber = Asc(DriveLetter) - 65\r\n\r\nDriveType = GetDriveType(DriveLetter)\r\nIf DriveType = 2 Then  'Floppies only\r\n    RetVal = Shell(\"rundll32.exe \" & \"diskcopy.dll,\" & \"DiskCopyRunDll \" & DriveNumber & \",\" & DriveNumber, 1)\r\nElse\r\n    RetFromMsg = MsgBox(\"Only floppies can be copied\")\r\nEnd If\r\n\r\nEnd Sub\r\n'-----------------------------------------------------------\r\nPublic Sub FormatDrive()\r\n\r\nDim DriveLetter As String\r\nDim DriveNumber As Long\r\nDim DriveType As Long\r\nDim RetVal As Long\r\nDim RetFromMsg As Long\r\n\r\nDriveLetter = \"A\"\r\nDriveNumber = Asc(DriveLetter) - 65\r\n\r\nDriveType = GetDriveType(DriveLetter)\r\nIf DriveType = 2 Then  'Floppies only\r\n    RetVal = SHFormatDrive(Me.hwnd, DriveNumber, 0&, 0&)\r\nElse\r\n    RetFromMsg = MsgBox(\"Only floppies can be formatted\")\r\nEnd If\r\n\r\nEnd Sub\r\n","Declares":"Declare Function GetDriveType Lib \"kernel32\" Alias \"GetDriveTypeA\" (ByVal nDrive As String) As Long\r\nDeclare Function SHFormatDrive Lib \"shell32\" (ByVal hwnd As Long, ByVal drive As Long, ByVal fmtID As Long, ByVal options As Long) As Long\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Format","Diskcopy","Diskettes"]},{"RecordId":"351","Title":"Animated Cursors","Description":"Demonstrates how to change the cursor to an animated cursor and then change it back again.","Code":"Private Sub AnimateCursor()\r\n\r\n    Dim hAniCursor As Long\r\n    \r\n    hAniCursor = LoadCursorFromFile(\"c:\\Program Files\\plus!\\Themes\\Cool Cursors\\ball4.ani\")\r\n    hSwapCursor = SetClassLong(Me.hwnd, GCL_HCURSOR, hAniCursor)\r\n\r\nEnd Sub\r\n\r\nPrivate Sub RestoreOriginalCursor()\r\n\r\n    hSwapCursor = SetClassLong(Me.hwnd, GCL_HCURSOR, hSwapCursor)\r\n\r\nEnd Sub\r\n","Declares":"Private Declare Function LoadCursorFromFile _\r\n    Lib \"user32\" Alias \"LoadCursorFromFileA\" _\r\n    (ByVal lpFileName As String) As Long\r\n    \r\nPrivate Declare Function SetClassLong _\r\n    Lib \"user32\" Alias \"SetClassLongA\" _\r\n    (ByVal hwnd As Long, ByVal nIndex As Long, _\r\n    ByVal dwNewLong As Long) As Long\r\n    \r\nPrivate Const GCL_HCURSOR = (-12)\r\nPrivate hSwapCursor As Long\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Cursor","Animated Cursor"]},{"RecordId":"353","Title":"Interface Implementation (Multiple Obj Interfaces)","Description":"Demonstrates multiple interfaces of an object","Code":"'-----------------------------------------------------------------------\r\n' I_One (Public Not Creatable)\r\n'-----------------------------------------------------------------------\r\nOption Explicit\r\n\r\nPublic Function Foo1(ByVal strParmIn As String) As String\r\nEnd Function\r\n\r\n\r\n'-----------------------------------------------------------------------\r\n' I_Two (Public Not Creatable)\r\n'-----------------------------------------------------------------------\r\nOption Explicit\r\n\r\nPublic Function Foo2(ByVal strParmIn As String) As String\r\nEnd Function\r\n\r\n\r\n'-----------------------------------------------------------------------\r\n' c_Main (Multi-Use)\r\n'-----------------------------------------------------------------------\r\nOption Explicit\r\n\r\nImplements I_One\r\nImplements I_Two\r\n\r\nPublic Function Foo_Main(ByVal strParmIn As String) As String\r\n    Foo_Main = \"Foo_Main-\" & strParmIn\r\nEnd Function\r\n\r\nPrivate Function I_One_Foo1(ByVal strParmIn As String) As String\r\n    I_One_Foo1 = \"I_One_Foo1-\" & strParmIn\r\nEnd Function\r\n\r\nPrivate Function I_Two_Foo2(ByVal strParmIn As String) As String\r\n    I_Two_Foo2 = \"I_Two_Foo2-\" & strParmIn\r\nEnd Function\r\n\r\n\r\n'-----------------------------------------------------------------------\r\n' Usage\r\n'-----------------------------------------------------------------------\r\nOption Explicit\r\n\r\nPrivate Sub Command1_Click()\r\n\r\n    Dim oMain As InterfaceDemo.c_Main\r\n    Dim oOne As InterfaceDemo.I_One\r\n    Dim oTwo As InterfaceDemo.I_Two\r\n\r\n    Set oMain = New InterfaceDemo.c_Main\r\n    Set oOne = oMain\r\n    Set oTwo = oMain\r\n    \r\n    Debug.Print oMain.Foo_Main(\"oMain.Foo_Main\")\r\n    Debug.Print oOne.Foo1(\"oOne.Foo1\")\r\n    Debug.Print oTwo.Foo2(\"oTwo.Foo2\")\r\n    \r\n    Set oOne = Nothing\r\n    Set oTwo = Nothing\r\n    Set oMain = Nothing\r\n\r\nEnd Sub","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Interfaces","COM","Implements"]},{"RecordId":"354","Title":"Directories - List all on drive","Description":"Lists all subdirectories on a drive.","Code":"'--------------------------------------------\r\n' Call the function this way\r\n'--------------------------------------------\r\n\r\nListSubDirs \"C:\\\"\r\n\r\n'--------------------------------------------\r\n' This is the function\r\n'--------------------------------------------\r\n\r\nSub ListSubDirs (Path As String)\r\n\r\n    On Error GoTo DirError\r\n\r\n    Dim Count As Integer, D() As String, I As Integer, DirName As String\r\n    \r\n    DirName = Dir(Path, ATTR_DIRECTORY) ' Get first directory name.\r\n    \r\n    'Iterate through PATH, caching all subdirectories in D()\r\n    Do While DirName <> \"\"\r\n        If DirName <> \".\" And DirName <> \"..\" Then\r\n            If (GetAttr(Path + DirName) And ATTR_DIRECTORY) = ATTR_DIRECTORY Then\r\n                If Err <> 53 And Err <> 76 And Err <> 5 Then\r\n                    If (Count Mod 10) = 0 Then\r\n                        ReDim Preserve D(Count + 10)    ' Resize the array.\r\n                    End If\r\n                    Count = Count + 1   ' Increment counter.\r\n                    D(Count) = DirName\r\n                End If\r\n            End If\r\n        End If\r\nNextDir:\r\n    DirName = Dir   ' Get another directory name.\r\n    Loop\r\n    \r\n    ' Now recursively iterate through each cached subdirectory.\r\n    For I = 1 To Count\r\n        List1.AddItem Path & D(I)   ' Put name in list box.\r\n        ListSubDirs Path & D(I) & \"\\\"\r\n    Next I\r\n    Exit Sub\r\n\r\nDirError:\r\n    \r\n    If Err = 53 Or Err = 76 Then\r\n        Resume Next\r\n    Else\r\n        If Err = 5 Then\r\n            Resume NextDir\r\n        Else\r\n            MsgBox Str$(Err) & \" - \" & Error$\r\n            Exit Sub\r\n    End If\r\n\r\nEnd Sub\r\n","Declares":"Const ATTR_DIRECTORY = 16","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Directory List"]},{"RecordId":"355","Title":"Listbox Item Pre-Selection","Description":"Preselects items in a listbox","Code":"Sub SelectListItem (lst As Control, Idx As String)\r\nDim i As Integer\r\n     i = SendMessage(lst.hWnd, LB_SELECTSTRING, -1, ByVal Idx)\r\nEnd Sub\r\n\r\n","Declares":"'Declares for SelectListItem\r\nDeclare Function SendMessage Lib \"User\" (ByVal hWnd As Integer, ByVal wMsg As Integer, ByVal wParam As Integer, lParam As Any) As Long\r\nGlobal Const WM_USER = &H400\r\nGlobal Const LB_SELECTSTRING = (WM_USER + 13)\r\n\r\n'End of declares\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Listbox Search","Search"]},{"RecordId":"357","Title":"Simulate Drag/Drop With The Clipboard","Description":"Emulates Windows Explorer drag/drop file move/copy using the clipboard","Code":"Public Function clipCopyFiles(Files() As String) As Boolean\r\n\r\n    Dim data As String\r\n    Dim df As DROPFILES\r\n    Dim hGlobal As Long\r\n    Dim lpGlobal As Long\r\n    Dim i As Long\r\n   \r\n    ' Open and clear existing crud off clipboard.\r\n    If OpenClipboard(0&) Then\r\n        Call EmptyClipboard\r\n      \r\n        ' Build double-null terminated list of files.\r\n        For i = LBound(Files) To UBound(Files)\r\n            data = data & Files(i) & vbNullChar\r\n        Next i\r\n        data = data & vbNullChar\r\n      \r\n        ' Allocate and get pointer to global memory,\r\n        ' then copy file list to it.\r\n        hGlobal = GlobalAlloc(GHND, Len(df) + Len(data))\r\n        If hGlobal Then\r\n            lpGlobal = GlobalLock(hGlobal)\r\n         \r\n            ' Build DROPFILES structure in global memory.\r\n            df.pFiles = Len(df)\r\n            Call CopyMem(ByVal lpGlobal, df, Len(df))\r\n            Call CopyMem(ByVal (lpGlobal + Len(df)), _\r\n                ByVal data, Len(data))\r\n            Call GlobalUnlock(hGlobal)\r\n         \r\n            ' Copy data to clipboard, and return success.\r\n            If SetClipboardData(CF_HDROP, hGlobal) Then\r\n                clipCopyFiles = True\r\n            End If\r\n        End If\r\n      \r\n        ' Clean up\r\n        Call CloseClipboard\r\n    End If\r\nEnd Function\r\n\r\nPublic Function clipPasteFiles(Files() As String) As Long\r\n\r\n    Dim hDrop As Long\r\n    Dim nFiles As Long\r\n    Dim i As Long\r\n    Dim desc As String\r\n    Dim filename As String\r\n    Dim pt As POINTAPI\r\n    Const MAX_PATH As Long = 260\r\n    Dim strFiles() As String\r\n   \r\n    ' Ensure desired format is there, and open clipboard.\r\n    If IsClipboardFormatAvailable(CF_HDROP) Then\r\n        If OpenClipboard(0&) Then\r\n         \r\n            ' Get handle to Dropped Filelist data, and\r\n            ' number of files.\r\n            hDrop = GetClipboardData(CF_HDROP)\r\n            nFiles = DragQueryFile(hDrop, -1&, \"\", 0)\r\n      \r\n            ' Allocate space for return and working\r\n            ' variables.\r\n            ReDim strFiles(0 To nFiles - 1) As String\r\n            filename = Space(MAX_PATH)\r\n         \r\n            ' Retrieve each filename in Dropped Filelist.\r\n            For i = 0 To nFiles - 1\r\n                Call DragQueryFile(hDrop, i, filename, _\r\n                    Len(filename))\r\n                strFiles(i) = TrimNull(filename)\r\n            Next i\r\n         \r\n            ' Clean up\r\n            Call CloseClipboard\r\n        End If\r\n      \r\n        ' Assign return value equal to number of\r\n        ' files dropped.\r\n        clipPasteFiles = nFiles\r\n    End If\r\nEnd Function\r\n\r\n\r\nPrivate Function TrimNull(ByVal strFileName As String) As String\r\n\r\n Dim intOffset As Integer\r\n\r\n intOffset = InStr(1, strFileName, vbNullChar)\r\n TrimNull = Left$(strFileName, intOffset - 1)\r\n\r\nEnd Function\r\n","Declares":"' Clipboard Manager Functions\r\nPrivate Declare Function EmptyClipboard Lib \"user32\" () As Long\r\nPrivate Declare Function OpenClipboard Lib \"user32\" (ByVal hWnd As Long) As Long\r\nPrivate Declare Function CloseClipboard Lib \"user32\" () As Long\r\nPrivate Declare Function SetClipboardData Lib \"user32\" (ByVal wFormat As Long, ByVal hMem As Long) As Long\r\nPrivate Declare Function GetClipboardData Lib \"user32\" (ByVal wFormat As Long) As Long\r\nPrivate Declare Function IsClipboardFormatAvailable Lib \"user32\" (ByVal wFormat As Long) As Long\r\n\r\n' Other required Win32 APIs\r\nPrivate Declare Function DragQueryFile Lib \"shell32.dll\" Alias \"DragQueryFileA\" (ByVal hDrop As Long, ByVal UINT As Long, ByVal lpStr As String, ByVal ch As Long) As Long\r\nPrivate Declare Function GlobalAlloc Lib \"kernel32\" (ByVal wFlags As Long, ByVal dwBytes As Long) As Long\r\nPrivate Declare Function GlobalFree Lib \"kernel32\" (ByVal hMem As Long) As Long\r\nPrivate Declare Function GlobalLock Lib \"kernel32\" (ByVal hMem As Long) As Long\r\nPrivate Declare Function GlobalUnlock Lib \"kernel32\" (ByVal hMem As Long) As Long\r\nPrivate Declare Sub CopyMem Lib \"kernel32\" Alias \"RtlMoveMemory\" (Destination As Any, Source As Any, ByVal Length As Long)\r\n\r\n' Predefined Clipboard Formats\r\nPrivate Const CF_HDROP = 15\r\n\r\n' Global Memory Flags\r\nPrivate Const GMEM_MOVEABLE = &H2\r\nPrivate Const GMEM_ZEROINIT = &H40\r\nPrivate Const GHND = (GMEM_MOVEABLE Or GMEM_ZEROINIT)\r\n\r\n' Required data structures\r\nPrivate Type POINTAPI\r\n    x As Long\r\n    y As Long\r\nEnd Type\r\n\r\nPrivate Type DROPFILES\r\n    pFiles As Long\r\n    pt As POINTAPI\r\n    fNC As Long\r\n    fWide As Long\r\nEnd Type","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Drag/Drop","Clipboard","Drop/Drag"]},{"RecordId":"358","Title":"Format Numeric Text","Description":"Various routines for formatting text for Date6, Date8, Time12h, Time24h, etc.","Code":"Public Function FormatNumericText(ByVal txtTextIn As Variant, txtFormat As Integer) As String\r\n\r\nConst TIME24H = 1\r\nConst TIME12H = 2\r\nConst TIMEAMPM = 3\r\nConst DATE6 = 4\r\nConst DATE8 = 5\r\n\r\nDim strTempString As String\r\nDim strTempChar As String\r\nDim i As Integer\r\nDim intColonCount As Integer\r\nDim intFirstSlash As Integer\r\nDim intSecondSlash As Integer\r\nDim strTempDate As String\r\n\r\n\r\ntxtTextIn = txtTextIn & \"\"\r\n\r\nintColonCount = 0\r\nstrTempString = \"\"\r\n\r\n\r\n'24 hour time format (00:00 to 24:00)\r\nIf txtFormat = TIME24H Then\r\n    \r\n    For i = 1 To Len(txtTextIn)\r\n        strTempChar = Mid$(txtTextIn, i, 1)\r\n        If strTempChar >= \"0\" And strTempChar <= \"9\" Then\r\n            strTempString = strTempString & strTempChar\r\n        End If\r\n    Next\r\n    \r\n    strTempString = Format$(strTempString, \"00:00\")\r\n\r\nEnd If\r\n\r\n\r\n'12 hour time format (00:00 to 12:00)\r\nIf txtFormat = TIME12H Then\r\n    \r\n    For i = 1 To Len(txtTextIn)\r\n        strTempChar = Mid$(txtTextIn, i, 1)\r\n        If strTempChar >= \"0\" And strTempChar <= \"9\" Then\r\n            strTempString = strTempString & strTempChar\r\n        End If\r\n    Next\r\n    \r\n    If Val(strTempString) > 1200 Then\r\n        strTempString = Val(strTempString) - 1200\r\n    End If\r\n    \r\n    strTempString = Format$(strTempString, \"00:00\")\r\n\r\nEnd If\r\n\r\n\r\n'12 hour am/pm (1:00 AM)\r\nIf txtFormat = TIMEAMPM Then\r\n    \r\n    For i = 1 To Len(txtTextIn)\r\n        strTempChar = Mid$(txtTextIn, i, 1)\r\n        If strTempChar >= \"0\" And strTempChar <= \"9\" Then\r\n            strTempString = strTempString & strTempChar\r\n        End If\r\n    Next\r\n    \r\n    strTempString = Format$(strTempString, \"00:00\")\r\n    strTempString = Format$(strTempString, \"h:mm AM/PM\")\r\n\r\nEnd If\r\n\r\n\r\n'6 byte date (01/01/97)\r\nIf txtFormat = DATE6 Then\r\n\r\n    intFirstSlash = 0\r\n    intSecondSlash = 0\r\n    \r\n    For i = 1 To Len(txtTextIn)\r\n        strTempChar = Mid$(txtTextIn, i, 1)\r\n        If (strTempChar >= \"0\" And strTempChar <= \"9\") Or (strTempChar = \"/\") Then\r\n            strTempString = strTempString & strTempChar\r\n        End If\r\n    Next\r\n\r\n    intFirstSlash = InStr(1, strTempString, \"/\")\r\n    If intFirstSlash <> 0 Then\r\n        intSecondSlash = InStr(intFirstSlash + 1, strTempString, \"/\")\r\n    End If\r\n    \r\n    'If slashes were found, break out date.\r\n    'Possibilities are:\r\n    ' m/d/yy    2,4\r\n    ' m/dd/yy   2,5\r\n    ' mm/d/yy   3,5\r\n    ' mm/dd/yy  3,6\r\n    \r\n    If (intFirstSlash <> 0) And (intSecondSlash <> 0) Then\r\n        If intFirstSlash = 2 And intSecondSlash = 4 Then\r\n            strTempString = \"0\" & Left$(strTempString, 1) & \"0\" & Mid$(strTempString, 3, 1) & Mid$(strTempString, 5, 2)\r\n        ElseIf intFirstSlash = 2 And intSecondSlash = 5 Then\r\n            strTempString = \"0\" & Left$(strTempString, 1) & Mid$(strTempString, 3, 2) & Mid$(strTempString, 6, 2)\r\n        ElseIf intFirstSlash = 3 And intSecondSlash = 5 Then\r\n            strTempString = Left$(strTempString, 2) & \"0\" & Mid$(strTempString, 4, 1) & Mid$(strTempString, 6, 2)\r\n        ElseIf intFirstSlash = 3 And intSecondSlash = 6 Then\r\n            strTempString = Left$(strTempString, 2) & Mid$(strTempString, 4, 2) & Mid$(strTempString, 7, 2)\r\n        End If\r\n    Else\r\n    \r\n        'No slashes found, so make some assumptions.\r\n        If Len(strTempString) = 4 Then\r\n            strTempString = \"0\" & Left$(strTempString, 1) & \"0\" & Mid$(strTempString, 2, 1) & Right$(strTempString, 2)\r\n        Else\r\n            If Len(strTempString) = 5 Then\r\n                strTempString = \"0\" & strTempString\r\n            End If\r\n        End If\r\n    End If\r\n    \r\n    strTempString = Format$(strTempString, \"00/00/00\")\r\n    \r\nEnd If\r\n\r\n\r\n'8 byte date (01/01/1997)\r\nIf txtFormat = DATE8 Then\r\n    \r\n    intFirstSlash = 0\r\n    intSecondSlash = 0\r\n    \r\n    For i = 1 To Len(txtTextIn)\r\n        strTempChar = Mid$(txtTextIn, i, 1)\r\n        If (strTempChar >= \"0\" And strTempChar <= \"9\") Or (strTempChar = \"/\") Then\r\n            strTempString = strTempString & strTempChar\r\n        End If\r\n    Next\r\n\r\n    intFirstSlash = InStr(1, strTempString, \"/\")\r\n    If intFirstSlash <> 0 Then\r\n        intSecondSlash = InStr(intFirstSlash + 1, strTempString, \"/\")\r\n    End If\r\n    \r\n    'If slashes were found, break out date.\r\n    'Possibilities are:\r\n    ' m/d/yyyy    2,4\r\n    ' m/dd/yyyy   2,5\r\n    ' mm/d/yyyy   3,5\r\n    ' mm/dd/yyyy  3,6\r\n    \r\n    If (intFirstSlash <> 0) And (intSecondSlash <> 0) Then\r\n    \r\n        'Assume two byte year enterred with slashes\r\n        If Len(strTempString) - intSecondSlash < 4 Then\r\n            If intFirstSlash = 2 And intSecondSlash = 4 Then\r\n                If Right$(strTempString, 2) > \"40\" Then\r\n                    strTempString = \"0\" & Left$(strTempString, 1) & \"0\" & Mid$(strTempString, 3, 1) & \"19\" & Mid$(strTempString, 5, 2)\r\n                Else\r\n                    strTempString = \"0\" & Left$(strTempString, 1) & \"0\" & Mid$(strTempString, 3, 1) & \"20\" & Mid$(strTempString, 5, 2)\r\n                End If\r\n            ElseIf intFirstSlash = 2 And intSecondSlash = 5 Then\r\n                If Right$(strTempString, 2) > \"40\" Then\r\n                    strTempString = \"0\" & Left$(strTempString, 1) & Mid$(strTempString, 3, 2) & \"19\" & Mid$(strTempString, 6, 2)\r\n                Else\r\n                    strTempString = \"0\" & Left$(strTempString, 1) & Mid$(strTempString, 3, 2) & \"20\" & Mid$(strTempString, 6, 2)\r\n                End If\r\n            ElseIf intFirstSlash = 3 And intSecondSlash = 5 Then\r\n                If Right$(strTempString, 2) > \"40\" Then\r\n                    strTempString = Left$(strTempString, 2) & \"0\" & Mid$(strTempString, 4, 1) & \"19\" & Mid$(strTempString, 6, 2)\r\n                Else\r\n                    strTempString = Left$(strTempString, 2) & \"0\" & Mid$(strTempString, 4, 1) & \"20\" & Mid$(strTempString, 6, 2)\r\n                End If\r\n            ElseIf intFirstSlash = 3 And intSecondSlash = 6 Then\r\n                If Right$(strTempString, 2) > \"40\" Then\r\n                    strTempString = Left$(strTempString, 2) & Mid$(strTempString, 4, 2) & \"19\" & Mid$(strTempString, 7, 2)\r\n                Else\r\n                    strTempString = Left$(strTempString, 2) & Mid$(strTempString, 4, 2) & \"20\" & Mid$(strTempString, 7, 2)\r\n                End If\r\n            End If\r\n            \r\n        'Assume four byte year enterred with slashes\r\n        Else\r\n            If intFirstSlash = 2 And intSecondSlash = 4 Then\r\n                strTempString = \"0\" & Left$(strTempString, 1) & \"0\" & Mid$(strTempString, 3, 1) & Mid$(strTempString, 5, 4)\r\n            ElseIf intFirstSlash = 2 And intSecondSlash = 5 Then\r\n                strTempString = \"0\" & Left$(strTempString, 1) & Mid$(strTempString, 3, 2) & Mid$(strTempString, 6, 4)\r\n            ElseIf intFirstSlash = 3 And intSecondSlash = 5 Then\r\n                strTempString = Left$(strTempString, 2) & \"0\" & Mid$(strTempString, 4, 1) & Mid$(strTempString, 6, 4)\r\n            ElseIf intFirstSlash = 3 And intSecondSlash = 6 Then\r\n                strTempString = Left$(strTempString, 2) & Mid$(strTempString, 4, 2) & Mid$(strTempString, 7, 4)\r\n            End If\r\n        End If\r\n    Else\r\n    \r\n        'No slashes found, so make some more assumptions.\r\n        If Len(strTempString) = 4 Then\r\n            If Right$(strTempString, 2) > \"40\" Then\r\n                strTempString = \"0\" & Left$(strTempString, 1) & \"0\" & Mid$(strTempString, 2, 1) & \"19\" & Right$(strTempString, 2)\r\n            Else\r\n                strTempString = \"0\" & Left$(strTempString, 1) & \"0\" & Mid$(strTempString, 2, 1) & \"20\" & Right$(strTempString, 2)\r\n            End If\r\n        ElseIf Len(strTempString) = 5 Then\r\n            If Right$(strTempString, 2) > \"40\" Then\r\n                strTempString = \"0\" & Left$(strTempString, 3) & \"19\" & Right$(strTempString, 2)\r\n            Else\r\n                strTempString = \"0\" & Left$(strTempString, 3) & \"20\" & Right$(strTempString, 2)\r\n            End If\r\n        ElseIf Len(strTempString) = 6 Then\r\n            If Right$(strTempString, 2) > \"40\" Then\r\n                strTempString = Left$(strTempString, 4) & \"19\" & Right$(strTempString, 2)\r\n            Else\r\n                strTempString = Left$(strTempString, 4) & \"20\" & Right$(strTempString, 2)\r\n            End If\r\n        ElseIf Len(strTempString) = 7 Then\r\n            strTempString = \"0\" & strTempString\r\n        End If\r\n    End If\r\n    \r\n    strTempString = Format$(strTempString, \"00/00/0000\")\r\n\r\nEnd If\r\n\r\nFormatNumericText = strTempString\r\n\r\nEnd Function\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Format","Numeric Text Formatting"]},{"RecordId":"359","Title":"Form No Resize","Description":"Once form is set to a certain size, this routine will keep it the same size, except when minimized","Code":"Sub Form_Resize ()\r\n\r\nStatic stnResizing%\r\nIf Me.WindowState = NORMAL And Not stnLoading And Not stnResizing Then\r\n   stnResizing = True\r\n   If Me.Height > mnHeight Then Me.Height = mnHeight\r\n   If Me.Width > mnWidth Then Me.Width = mnWidth\r\n   stnResizing = False\r\nEnd If\r\n\r\nEnd Sub\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Lock Form Size","Resize"]},{"RecordId":"360","Title":"LPRINT-Setting Properties By Arguments","Description":"Simulates the LPRINT in earlier versions of BASIC   \r\n","Code":"Sub Lprint (XPos%, YPos%, TextToPrint As Variant, SizetoPrint%, Bold%, Italics%)\r\n    Rem This routine does not make any changes to any properties of the printer\r\n    Rem object that are not passed as arguments.  Therefore, if underlining is\r\n    Rem desired for example, it must be set prior to calling this procedure.\r\n\r\n    printer.CurrentX = XPos%\r\n    printer.CurrentY = YPos%\r\n    printer.FontBold = Bold%\r\n    printer.FontItalic = Italics%\r\n    printer.FontSize = SizetoPrint%\r\n    printer.Print TextToPrint\r\n    \r\nEnd Sub\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Printing","LPRINT"]},{"RecordId":"361","Title":"Playing An AVI Or WAV File","Description":"Playing an AVI or WAV","Code":"'Use the following code to play the file:\r\nRet& = mciSendString(\"play filename.wav\", 0&, 0, 0)\r\nRet& = mciSendString(\"play filename.avi\", 0&, 0, 0)\r\n'In both cases, filename refers to both the path and file name of the desired multi-media file.\r\n'Use the following code as an example of setting up an error handler to trap any errors and display the error message in a 'message box:\r\n\r\nDim mciErrorText As String *255\r\nDim mciBuffer%\r\nmciBuffer% = 255\r\n\r\nIf Ret& <> 0 Then \r\n    ErrorRet% = mciGetErrorString(Ret&, mciErrorText, mciBuffer)\r\n    If ErrorRet% = 1 Then\r\n        Msg$ = mciErrorText\r\n        MsgBox Msg$, 48, \"MCI Error\"\r\n    Else\r\n        MsgBox \"An unknown error occured\", 16, \"Error\"\r\n    End If\r\n    Ret& = mciSendString(\"close all\", 0&, 0, 0)\r\nEnd If\r\n\r\n'This only covers the very basics.  It can get a lot more involved than just this.  You can also use the sndPlaySound API 'function to play wav files but not avi files.\r\n","Declares":"Declare Function mciSendString Lib \"mmsystem\" (ByVal lpstrCommand$, ByVal lpstrReturnStr As Any, ByVal wReturnLen%, ByVal hCallBack%) As Long\r\nDeclare Function mciGetErrorString Lib \"mmsystem\" (ByVal dwError&, ByVal lpstrBuffer As Any, ByVal wLength%) As Integer\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["AVI","WAV","Multimedia"]},{"RecordId":"362","Title":"Colors (16 or 256)","Description":"Determines if current video driver is 16 or 256 color","Code":"Function NumColors () As Integer\r\n\r\nDim hDC As Integer\r\nDim nDummy As Integer\r\nDim nBitsPerPixel As Integer\r\n\r\nhDC = GetDC(0)\r\nnBitsPerPixel = GetDeviceCaps(hDC, BITSPIXEL) * GetDeviceCaps(hDC, PLANES)\r\n\r\nnDummy = ReleaseDC(0, hDC)\r\nNumColors = 2& ^ nBitsPerPixel\r\n\r\nEnd Function\r\n","Declares":"Const PLANES = 14\r\nConst BITSPIXEL = 12\r\n\r\nDeclare Function GetDeviceCaps Lib \"GDI\" (ByVal hDC As Integer, ByVal nIndex As Integer) As Integer\r\nDeclare Function GetDC Lib \"User\" (ByVal hWnd As Integer) As Integer\r\nDeclare Function ReleaseDC Lib \"User\" (ByVal hWnd As Integer, ByVal hDC As Integer) As Integer\r\n\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Color","Hardware","System Info"]},{"RecordId":"363","Title":"Shell Sort Routines","Description":"Sorts arrays of various types (single, integer, etc) either ascending or descending\r\nNOTE:  Best overall compromise for a general sorting routine","Code":"\r\n' - - - To sort ascending, call with:             ShellSortAny Ar(), , False\r\n' - - - To sort descending, call with:           ShellSortAny Ar(), , True\r\n' - - - Replace \"ShellSortAny\" with \"ShellSortx\" where x is the array type for the specific sort routine\r\n\r\nAttribute VB_Name = \"ShellSort\"\r\nOption Explicit\r\n\r\nSub ShellSortAny(arr As Variant, Optional ByVal numEls As Variant, Optional ByVal descending As Variant)\r\n\r\n    '---------------------------------------\r\n    '  Shell Sort of an array of any type\r\n    '---------------------------------------\r\n\r\n    Dim index As Long, index2 As Long\r\n    Dim firstItem As Long\r\n    Dim inverseOrder As Boolean\r\n    Dim distance As Long\r\n    Dim value As Variant\r\n\r\n    ' exit if it is not an arr\r\n    If VarType(arr) < vbArray Then Exit Sub\r\n\r\n    ' account for optional arguments\r\n    If IsMissing(numEls) Then numEls = UBound(arr)\r\n    If IsMissing(descending) Then descending = False\r\n    inverseOrder = (descending <> False)\r\n    \r\n    firstItem = LBound(arr)\r\n    ' find the best value for distance\r\n    Do\r\n        distance = distance * 3 + 1\r\n    Loop Until distance > numEls\r\n    \r\n    Do\r\n        distance = distance \\ 3\r\n        For index = distance + 1 To numEls\r\n            value = arr(index)\r\n            index2 = index\r\n            Do While (arr(index2 - distance) > value) Xor inverseOrder\r\n                arr(index2) = arr(index2 - distance)\r\n                index2 = index2 - distance\r\n                If index2 <= distance Then Exit Do\r\n            Loop\r\n            arr(index2) = value\r\n        Next\r\n    Loop Until distance = 1\r\n    \r\nEnd Sub\r\n\r\nSub ShellSortI(arr() As Integer, Optional ByVal numEls As Variant, Optional ByVal descending As Variant)\r\n\r\n    '---------------------------------------\r\n    '  Shell Sort of an array of integers\r\n    '---------------------------------------\r\n\r\n    Dim index As Long, index2 As Long\r\n    Dim firstItem As Long\r\n    Dim inverseOrder As Boolean\r\n    Dim distance As Long\r\n    Dim value As Integer\r\n\r\n    ' account for optional arguments\r\n    If IsMissing(numEls) Then numEls = UBound(arr)\r\n    If IsMissing(descending) Then descending = False\r\n    inverseOrder = (descending <> False)\r\n    \r\n    firstItem = LBound(arr)\r\n    ' find the best value for distance\r\n    Do\r\n        distance = distance * 3 + 1\r\n    Loop Until distance > numEls\r\n    \r\n    Do\r\n        distance = distance \\ 3\r\n        For index = distance + 1 To numEls\r\n            value = arr(index)\r\n            index2 = index\r\n            Do While (arr(index2 - distance) > value) Xor inverseOrder\r\n                arr(index2) = arr(index2 - distance)\r\n                index2 = index2 - distance\r\n                If index2 <= distance Then Exit Do\r\n            Loop\r\n            arr(index2) = value\r\n        Next\r\n    Loop Until distance = 1\r\n    \r\nEnd Sub\r\n\r\nSub ShellSortL(arr() As Long, Optional ByVal numEls As Variant, Optional ByVal descending As Variant)\r\n\r\n    '---------------------------------------\r\n    '  Shell Sort of an array of Long\r\n    '---------------------------------------\r\n\r\n    Dim index As Long, index2 As Long\r\n    Dim firstItem As Long\r\n    Dim inverseOrder As Boolean\r\n    Dim distance As Long\r\n    Dim value As Long\r\n\r\n    ' account for optional arguments\r\n    If IsMissing(numEls) Then numEls = UBound(arr)\r\n    If IsMissing(descending) Then descending = False\r\n    inverseOrder = (descending <> False)\r\n    \r\n    firstItem = LBound(arr)\r\n    ' find the best value for distance\r\n    Do\r\n        distance = distance * 3 + 1\r\n    Loop Until distance > numEls\r\n    \r\n    Do\r\n        distance = distance \\ 3\r\n        For index = distance + 1 To numEls\r\n            value = arr(index)\r\n            index2 = index\r\n            Do While (arr(index2 - distance) > value) Xor inverseOrder\r\n                arr(index2) = arr(index2 - distance)\r\n                index2 = index2 - distance\r\n                If index2 <= distance Then Exit Do\r\n            Loop\r\n            arr(index2) = value\r\n        Next\r\n    Loop Until distance = 1\r\n    \r\nEnd Sub\r\n\r\nSub ShellSortS(arr() As Single, Optional ByVal numEls As Variant, Optional ByVal descending As Variant)\r\n\r\n    '---------------------------------------\r\n    '  Shell Sort of an array of Single\r\n    '---------------------------------------\r\n\r\n    Dim index As Long, index2 As Long\r\n    Dim firstItem As Long\r\n    Dim inverseOrder As Boolean\r\n    Dim distance As Long\r\n    Dim value As Single\r\n\r\n    ' account for optional arguments\r\n    If IsMissing(numEls) Then numEls = UBound(arr)\r\n    If IsMissing(descending) Then descending = False\r\n    inverseOrder = (descending <> False)\r\n    \r\n    firstItem = LBound(arr)\r\n    ' find the best value for distance\r\n    Do\r\n        distance = distance * 3 + 1\r\n    Loop Until distance > numEls\r\n    \r\n    Do\r\n        distance = distance \\ 3\r\n        For index = distance + 1 To numEls\r\n            value = arr(index)\r\n            index2 = index\r\n            Do While (arr(index2 - distance) > value) Xor inverseOrder\r\n                arr(index2) = arr(index2 - distance)\r\n                index2 = index2 - distance\r\n                If index2 <= distance Then Exit Do\r\n            Loop\r\n            arr(index2) = value\r\n        Next\r\n    Loop Until distance = 1\r\n    \r\nEnd Sub\r\n\r\nSub ShellSortD(arr() As Double, Optional ByVal numEls As Variant, Optional ByVal descending As Variant)\r\n\r\n    '---------------------------------------\r\n    '  Shell Sort of an array of Double\r\n    '---------------------------------------\r\n\r\n    Dim index As Long, index2 As Long\r\n    Dim firstItem As Long\r\n    Dim inverseOrder As Boolean\r\n    Dim distance As Long\r\n    Dim value As Double\r\n\r\n    ' account for optional arguments\r\n    If IsMissing(numEls) Then numEls = UBound(arr)\r\n    If IsMissing(descending) Then descending = False\r\n    inverseOrder = (descending <> False)\r\n    \r\n    firstItem = LBound(arr)\r\n    ' find the best value for distance\r\n    Do\r\n        distance = distance * 3 + 1\r\n    Loop Until distance > numEls\r\n    \r\n    Do\r\n        distance = distance \\ 3\r\n        For index = distance + 1 To numEls\r\n            value = arr(index)\r\n            index2 = index\r\n            Do While (arr(index2 - distance) > value) Xor inverseOrder\r\n                arr(index2) = arr(index2 - distance)\r\n                index2 = index2 - distance\r\n                If index2 <= distance Then Exit Do\r\n            Loop\r\n            arr(index2) = value\r\n        Next\r\n    Loop Until distance = 1\r\n    \r\nEnd Sub\r\n\r\nSub ShellSortC(arr() As Currency, Optional ByVal numEls As Variant, Optional ByVal descending As Variant)\r\n\r\n    '---------------------------------------\r\n    '  Shell Sort of an array of Currency\r\n    '---------------------------------------\r\n\r\n    Dim index As Long, index2 As Long\r\n    Dim firstItem As Long\r\n    Dim inverseOrder As Boolean\r\n    Dim distance As Long\r\n    Dim value As Currency\r\n\r\n    ' account for optional arguments\r\n    If IsMissing(numEls) Then numEls = UBound(arr)\r\n    If IsMissing(descending) Then descending = False\r\n    inverseOrder = (descending <> False)\r\n    \r\n    firstItem = LBound(arr)\r\n    ' find the best value for distance\r\n    Do\r\n        distance = distance * 3 + 1\r\n    Loop Until distance > numEls\r\n    \r\n    Do\r\n        distance = distance \\ 3\r\n        For index = distance + 1 To numEls\r\n            value = arr(index)\r\n            index2 = index\r\n            Do While (arr(index2 - distance) > value) Xor inverseOrder\r\n                arr(index2) = arr(index2 - distance)\r\n                index2 = index2 - distance\r\n                If index2 <= distance Then Exit Do\r\n            Loop\r\n            arr(index2) = value\r\n        Next\r\n    Loop Until distance = 1\r\n    \r\nEnd Sub\r\n\r\nSub ShellSortDate(arr() As Date, Optional ByVal numEls As Variant, Optional ByVal descending As Variant)\r\n\r\n    '---------------------------------------\r\n    '  Shell Sort of an array of Date\r\n    '---------------------------------------\r\n\r\n    Dim index As Long, index2 As Long\r\n    Dim firstItem As Long\r\n    Dim inverseOrder As Boolean\r\n    Dim distance As Long\r\n    Dim value As Date\r\n\r\n    ' account for optional arguments\r\n    If IsMissing(numEls) Then numEls = UBound(arr)\r\n    If IsMissing(descending) Then descending = False\r\n    inverseOrder = (descending <> False)\r\n    \r\n    firstItem = LBound(arr)\r\n    ' find the best value for distance\r\n    Do\r\n        distance = distance * 3 + 1\r\n    Loop Until distance > numEls\r\n    \r\n    Do\r\n        distance = distance \\ 3\r\n        For index = distance + 1 To numEls\r\n            value = arr(index)\r\n            index2 = index\r\n            Do While (arr(index2 - distance) > value) Xor inverseOrder\r\n                arr(index2) = arr(index2 - distance)\r\n                index2 = index2 - distance\r\n                If index2 <= distance Then Exit Do\r\n            Loop\r\n            arr(index2) = value\r\n        Next\r\n    Loop Until distance = 1\r\n    \r\nEnd Sub\r\n\r\nSub ShellSortStr(arr() As String, Optional ByVal numEls As Variant, Optional ByVal descending As Variant)\r\n\r\n    '---------------------------------------\r\n    '  Shell Sort of an array of String\r\n    '  Case-sensitive version\r\n    '---------------------------------------\r\n\r\n    Dim index As Long, index2 As Long\r\n    Dim firstItem As Long\r\n    Dim inverseOrder As Boolean\r\n    Dim distance As Long\r\n    Dim value As String\r\n\r\n    ' account for optional arguments\r\n    If IsMissing(numEls) Then numEls = UBound(arr)\r\n    If IsMissing(descending) Then descending = False\r\n    inverseOrder = (descending <> False)\r\n    \r\n    firstItem = LBound(arr)\r\n    ' find the best value for distance\r\n    Do\r\n        distance = distance * 3 + 1\r\n    Loop Until distance > numEls\r\n    \r\n    Do\r\n        distance = distance \\ 3\r\n        For index = distance + 1 To numEls\r\n            value = arr(index)\r\n            index2 = index\r\n            Do While (arr(index2 - distance) > value) Xor inverseOrder\r\n                arr(index2) = arr(index2 - distance)\r\n                index2 = index2 - distance\r\n                If index2 <= distance Then Exit Do\r\n            Loop\r\n            arr(index2) = value\r\n        Next\r\n    Loop Until distance = 1\r\n    \r\nEnd Sub\r\n\r\nSub ShellSortStrC(arr() As String, Optional ByVal numEls As Variant, Optional ByVal descending As Variant)\r\n\r\n    '---------------------------------------\r\n    '  Shell Sort of an array of String\r\n    '  Case-unsensitive version\r\n    '---------------------------------------\r\n\r\n    Dim index As Long, index2 As Long\r\n    Dim firstItem As Long\r\n    Dim inverseOrder As Boolean\r\n    Dim distance As Long\r\n    Dim value As String\r\n\r\n    ' account for optional arguments\r\n    If IsMissing(numEls) Then numEls = UBound(arr)\r\n    If IsMissing(descending) Then descending = False\r\n    inverseOrder = (descending <> False)\r\n    \r\n    firstItem = LBound(arr)\r\n    ' find the best value for distance\r\n    Do\r\n        distance = distance * 3 + 1\r\n    Loop Until distance > numEls\r\n    \r\n    Do\r\n        distance = distance \\ 3\r\n        For index = distance + 1 To numEls\r\n            value = arr(index)\r\n            index2 = index\r\n            Do While (StrComp(arr(index2 - distance), value, 1) = 1) Xor inverseOrder\r\n                arr(index2) = arr(index2 - distance)\r\n                index2 = index2 - distance\r\n                If index2 <= distance Then Exit Do\r\n            Loop\r\n            arr(index2) = value\r\n        Next\r\n    Loop Until distance = 1\r\n    \r\nEnd Sub\r\n\r\nSub ShellSortV(arr() As Variant, Optional ByVal numEls As Variant, Optional ByVal descending As Variant)\r\n\r\n    '---------------------------------------\r\n    '  Shell Sort of an array of Variant\r\n    '---------------------------------------\r\n\r\n    Dim index As Long, index2 As Long\r\n    Dim firstItem As Long\r\n    Dim inverseOrder As Boolean\r\n    Dim distance As Long\r\n    Dim value As Variant\r\n\r\n    ' account for optional arguments\r\n    If IsMissing(numEls) Then numEls = UBound(arr)\r\n    If IsMissing(descending) Then descending = False\r\n    inverseOrder = (descending <> False)\r\n    \r\n    firstItem = LBound(arr)\r\n    ' find the best value for distance\r\n    Do\r\n        distance = distance * 3 + 1\r\n    Loop Until distance > numEls\r\n    \r\n    Do\r\n        distance = distance \\ 3\r\n        For index = distance + 1 To numEls\r\n            value = arr(index)\r\n            index2 = index\r\n            Do While (arr(index2 - distance) > value) Xor inverseOrder\r\n                arr(index2) = arr(index2 - distance)\r\n                index2 = index2 - distance\r\n                If index2 <= distance Then Exit Do\r\n            Loop\r\n            arr(index2) = value\r\n        Next\r\n    Loop Until distance = 1\r\n    \r\nEnd Sub\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Sort","Shell Sort"]},{"RecordId":"365","Title":"Run Word via OLE (32 bit)","Description":"Run Word using OLE (32 bit)","Code":"'---------------------------------------------\r\n'To run this code, use \"TestOLEConnection\"\r\n'---------------------------------------------\r\n\r\nFunction LookForWord() As Long\r\n\r\n    Dim strAppName As String, hWnd As Long\r\n    Dim strWinTitle As String\r\n    Dim varRet As Long, intWordStarted As Long\r\n    Const GW_HWNDNEXT = 2\r\n    \r\n    LookForWord = False\r\n    strAppName = UCase$(\"Microsoft Word\")\r\n    hWnd = FindWindowByNum(0&, 0&)\r\n    \r\n    Do Until hWnd = 0\r\n        If GetParent(hWnd) = 0 Then\r\n            strWinTitle = Space$(255)\r\n            varRet = GetWindowText(hWnd, strWinTitle, Len(strWinTitle))\r\n            If varRet Then\r\n                strWinTitle = Left$(strWinTitle, varRet)\r\n                strWinTitle = UCase$(strWinTitle)\r\n                If InStr(strWinTitle, strAppName) = 1 Then\r\n                    LookForWord = True\r\n                    Exit Do\r\n                End If\r\n            End If\r\n        End If\r\n        hWnd = GetWindow(hWnd, GW_HWNDNEXT)\r\n    Loop\r\n    \r\n    If hWnd = 0 Then\r\n        intWordStarted = StartWord()\r\n        If intWordStarted Then LookForWord = True\r\n    End If\r\n\r\nEnd Function\r\nFunction MakeOLEConnectionToWord() As Long\r\n\r\n    Dim intLookForWord As Long\r\n    Dim strMsg As String, strTitle As String\r\n    \r\n    MakeOLEConnectionToWord = False\r\n    intLookForWord = LookForWord()\r\n    \r\n    If intLookForWord Then\r\n        Set objWord = CreateObject(\"Word.Basic\")\r\n        MakeOLEConnectionToWord = True\r\n    Else\r\n        strMsg = \"Could not establish OLE connection to Word\"\r\n        MsgBox strMsg, vbCritical, \"Error\"\r\n    End If\r\n    \r\nEnd Function\r\n\r\nFunction StartWord() As Long\r\n\r\n    Dim strSubKey As String, strValue As String\r\n    Dim intSuccess As Long, strExePath As String\r\n    Dim varRet\r\n    Dim intSpace As Long\r\n    \r\n    Const HKEY_CLASSES_ROOT = &H80000000\r\n    Const SW_SHOWMINNOACTIVE = 7\r\n    \r\n    StartWord = False\r\n    \r\n    strSubKey = \"Word.Document.6\\shell\\open\\command\"\r\n    strValue = Space$(255)\r\n    \r\n    intSuccess = RegQueryValue(HKEY_CLASSES_ROOT, strSubKey, strValue, Len(strValue))\r\n    \r\n    If intSuccess = 0 Then\r\n        intSpace = InStr(strValue, \" \") - 1\r\n        strExePath = Left$(strValue, intSpace)\r\n        varRet = Shell(strExePath, SW_SHOWMINNOACTIVE)\r\n    Else\r\n        strValue = \"Could not find info to start Word\"\r\n        MsgBox strValue, vbExclamation, \"Start Word\"\r\n    End If\r\n    \r\n    If varRet Then StartWord = True\r\n        \r\nEnd Function\r\n\r\nFunction SwitchToWord() As Long\r\n\r\n    Const strWordClass = \"OpusApp\"\r\n    Const SW_RESTORE = 9\r\n    Const SW_SHOWMAXIMIZED = 3\r\n    \r\n    Dim strTitle_barText As String\r\n    Dim hWnd As Long\r\n    Dim intSwitch As Long\r\n    \r\n    strTitle_barText = \"Microsoft Word\"\r\n    \r\n    If objWord.DocMaximize() Then\r\n        strTitle_barText = strTitle_barText & \" - \" & objWord.WindowName()\r\n    End If\r\n    \r\n    hWnd = FindWindowByString(strWordClass, strTitle_barText)\r\n    intSwitch = ShowWindow(hWnd, SW_RESTORE)\r\n    intSwitch = ShowWindow(hWnd, SW_SHOWMAXIMIZED)\r\n        \r\nEnd Function\r\n\r\n\r\nFunction TestOLEConnection() As Long\r\n    \r\n    Dim strDocPath As String\r\n    Dim intTest As Integer\r\n    \r\n    strDocPath = \"c:\\msoffice\\winword\\docs\\WordDoc1.doc\"\r\n    \r\n    intTest = MakeOLEConnectionToWord()\r\n    \r\n    If intTest Then\r\n        objWord.FileOpen strDocPath\r\n        intTest = MsgBox(\"Switch to Word?\", vbYesNo + vbQuestion, \"Switch?\")\r\n        If intTest = vbYes Then\r\n            intTest = SwitchToWord\r\n        Else\r\n            objWord.FilePrint\r\n            objWord.FileClose\r\n        End If\r\n    End If\r\n    \r\n    TestOLEConnection = intTest\r\n        \r\nEnd Function\r\n\r\n","Declares":"Declare Function FindWindowByNum Lib \"user32\"  Alias \"FindWindowA\" (ByVal lpClassName As Long, ByVal lpWindowName As Long) As Long\r\nDeclare Function GetParent Lib \"user32\" (ByVal hWnd As Long) As Long\r\nDeclare Function GetWindowText Lib \"user32\" Alias \"GetWindowTextA\" (ByVal hWnd As Long, ByVal lpString As String, ByVal cch As Long) As Long\r\nDeclare Function GetWindow Lib \"user32\" (ByVal hWnd As Long, ByVal wCmd As Long) As Long\r\nDeclare Function GetClassName Lib \"user32\" Alias \"GetClassNameA\" (ByVal hWnd As Long, ByVal lpClassName As String, ByVal nMaxCount As Long) As Long\r\nDeclare Function RegQueryValue Lib \"advapi32.dll\" Alias \"RegQueryValueA\" (ByVal hKey As Long, ByVal lpSubKey As String, ByVal lpValue As String,     lpcbValue As Long) As Long\r\nDeclare Function FindWindowByString Lib \"user32\" Alias \"FindWindowA\" (ByVal lpClassName As String, ByVal lpWindowName As String) As Long\r\nDeclare Function ShowWindow Lib \"user32\" (ByVal hWnd As Long, ByVal nCmdShow As Long) As Long\r\n    \r\nGlobal objWord As Object","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["OLE Automation","Word"]},{"RecordId":"366","Title":"File Version Info","Description":"Retrieves file version information","Code":"Function GetFileVersion (FileToCheck As String) As String\r\n    \r\n    On Error Resume Next\r\n\r\n    Dim lpdwHandle&\r\n    Dim VersionInfoSize&\r\n    Dim lpvdata$\r\n    Dim VersionInfo%\r\n    Dim lplpBuffer&\r\n    Dim lpcb%\r\n    Dim ptrFixed%\r\n    Dim TransString$\r\n    Dim ptrString%\r\n    Dim fixedstr$\r\n    Dim stringcopy&\r\n    Dim i As Integer\r\n    Dim char$\r\n    Dim nextchar$\r\n    Dim TransValue&\r\n    Dim TransTable$\r\n\r\n    VersionInfoSize& = GetFileVersionInfoSize(FileToCheck, lpdwHandle&)\r\n    If VersionInfoSize& = 0 Then\r\n        GetFileVersion = \"\"\r\n        Exit Function\r\n    End If\r\n    \r\n    lpvdata$ = String(VersionInfoSize&, Chr$(0))\r\n    VersionInfo% = GetFileVersionInfo(FileToCheck, lpdwHandle&, VersionInfoSize&, lpvdata$)\r\n    ptrFixed% = VerQueryValue(lpvdata$, \"\\FILEVERSION\", lplpBuffer&, lpcb%)\r\n    If ptrFixed% = 0 Then\r\n        ' Take a shot with the hardcoded TransString\r\n        TransString$ = \"040904E4\"\r\n        ptrString% = VerQueryValue(lpvdata$, \"\\StringFileInfo\\\" & TransString$ & \"\\CompanyName\", lplpBuffer&, lpcb%)\r\n        If ptrString% <> 0 Then GoTo GetValues\r\n        ptrFixed% = VerQueryValue(lpvdata$, \"\\\", lplpBuffer&, lpcb%)\r\n        If ptrFixed% = 0 Then\r\n            GetFileVersion = \"\"\r\n            Exit Function\r\n        Else\r\n            TransString$ = \"\"\r\n            fixedstr$ = String(lpcb% + 1, Chr(0))\r\n            stringcopy& = lstrcpyn(fixedstr$, lplpBuffer&, lpcb% + 1)\r\n            For i = lpcb% To 1 Step -1\r\n                char$ = Hex(Asc(Mid(fixedstr$, i, 1)))\r\n                If Len(char$) = 1 Then\r\n                    char$ = \"0\" + char$\r\n                End If\r\n                TransString$ = TransString$ + char$\r\n                If Len(TransString$ & nextchar$) Mod 8 = 0 Then\r\n                    TransString$ = \"&H\" & TransString$\r\n                    TransValue& = Val(TransString$)\r\n                    TransString$ = \"\"\r\n                End If\r\n            Next i\r\n        End If\r\n    End If\r\n    TransTable$ = String(lpcb% + 1, Chr(0))\r\n    TransString$ = String(0, Chr(0))\r\n    stringcopy& = lstrcpyn(TransTable$, lplpBuffer&, lpcb% + 1)\r\n    For i = 1 To lpcb%\r\n        char$ = Hex(Asc(Mid(TransTable$, i, 1)))\r\n        If Len(char$) = 1 Then\r\n            char$ = \"0\" + char$\r\n        End If\r\n        If Len(TransString$ & nextchar$) Mod 4 = 0 Then\r\n            nextchar$ = char$\r\n        Else\r\n            TransString$ = TransString$ + char$ + nextchar$\r\n            nextchar$ = \"\"\r\n            char$ = \"\"\r\n        End If\r\n    Next i\r\nGetValues:\r\n    ptrString% = VerQueryValue(lpvdata$, \"\\StringFileInfo\\\" & TransString$ & \"\\FileVersion\", lplpBuffer&, lpcb%)\r\n    If ptrString% = 1 Then\r\n        TransTable$ = String(lpcb%, Chr(0))\r\n        stringcopy& = lstrcpyn(TransTable$, lplpBuffer&, lpcb% + 1)\r\n        GetFileVersion = TransTable$\r\n    Else\r\n        GetFileVersion = \"\"\r\n    End If\r\nEnd Function\r\n","Declares":"Declare Function VerInstallFile& Lib \"ver.dll\" (ByVal Flags%, ByVal SrcFile$, ByVal DestFile$, ByVal SrcPath$, ByVal DestPath$, ByVal CurrDir$, ByVal TmpFile$, lpwTmpFileLen%)\r\nDeclare Function GetFileVersionInfoSize Lib \"ver.dll\" (ByVal lpszFileName As String, lpdwHandle As Long) As Long\r\nDeclare Function GetFileVersionInfo Lib \"ver.dll\" (ByVal lpszFileName As String, ByVal lpdwHandle As Long, ByVal cbbuf As Long, ByVal lpvdata As String) As Integer\r\nDeclare Function VerQueryValue Lib \"ver.dll\" (ByVal lpvBlock As String, ByVal lpszSubBlock As String, lplpBuffer As Long, lpcb As Integer) As Integer\r\nDeclare Function lstrcpyn Lib \"Kernel\" (ByVal lpszString1 As Any, ByVal lpszString2 As Long, ByVal cChars As Integer) As Long\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["File Info","Version Info"]},{"RecordId":"367","Title":"Get Windows Directory","Description":"Get Windows Directory","Code":"winDir$ = UCase$(GetWindowsDir$())\r\n\r\n'--------------------------------------------------\r\n' Calls the windows API to get the windows directory\r\n'--------------------------------------------------\r\nFunction GetWindowsDir () As String\r\n    temp$ = String$(145, 0)              ' Size Buffer\r\n    x = GetWindowsDirectory(temp$, 145)  ' Make API Call\r\n    temp$ = Left$(temp$, x)              ' Trim Buffer\r\n \r\n    If Right$(temp$, 1) <> \"\\\" Then      ' Add \\ if necessary\r\n        GetWindowsDir$ = temp$ + \"\\\"\r\n    Else\r\n        GetWindowsDir$ = temp$\r\n    End If\r\nEnd Function","Declares":"Declare Function GetWindowsDirectory Lib \"Kernel\" (ByVal lpBuffer As String, ByVal nSize As Integer) As Integer\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Windows Directory","System Info"]},{"RecordId":"368","Title":"Retrieve SQL Server Logged In User ID","Description":"Retrieves User ID from SQL Server","Code":"Issue the following sql statement (current database doesn't matter):\r\n\r\nSELECT User_Name","Declares":"","CodeCategory":{"CategoryId":"6","CategoryDescription":"T-SQL"},"Keywords":["SQL Server User Name","User ID"]},{"RecordId":"370","Title":"Constructing a Bitmap for a User Control","Description":"Design specs for creating the toolbox bitmap for a user control (ActiveX control)","Code":"The dimensions of the bitmap should be 16 pixels wide and 15 pixels tall.\r\n\r\nThe VB IDE uses the color of the pixel in the lower left corner of the bitmap to determine the transparent color for the toolbox bitmap.  All pixels in the bitmap that have this color will appear light grey in the toolbox.  Often, it's easiest to make this pixel light gray when you design the bitmap.  Then the light grey pixels in the bitmap are light gray in the toolbox, and what you see is what you get.\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["User Control","ActiveX","Bitmaps"]},{"RecordId":"372","Title":"DBList/DBCombo - Pointers","Description":"Setting record pointers on VB4 databound list & combo boxes","Code":"'DB List Box\r\nstrTemp = DBList1.BoundColumn\r\nDBList1.Text = Data1.Recordset.Fields(strTemp)\r\n\r\n'DB Combo Box\r\nstrTemp = DBCombo1.ListField\r\nDBCombo1.Text = Data1.Recordset.Fields(strTemp)","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["DB List","Bound Controls","Record Pointers"]},{"RecordId":"373","Title":"Multi_Thread (Synchronous)","Description":"Creates 4 threads that each call the same function that uses a Mutex to synchronize the operation.\r\n\r\nNOTE: This causes a GPF for some reason, but the code appears correct.","Code":"'---------------------------------------------------------------------\r\n' This starts 4 threads\r\n'---------------------------------------------------------------------\r\n\r\nPublic Sub StartSynchronousThreads()\r\n\r\nDim ahThread(4) As Long\r\nDim lThreadId As Long\r\nDim lMaxLimit As Long\r\nDim i As Long\r\n\r\nmCount = 0\r\nlMaxLimit = 25000\r\n\r\nmhMutex = CreateMutex(0, False, vbNullString)\r\n\r\nFor i = 0 To UBound(ahThread)\r\n    ahThread(i) = INVALID_HANDLE_VALUE\r\nNext\r\n\r\nFor i = 0 To UBound(ahThread)\r\n    ahThread(i) = CreateThread(0, 0, AddressOf CountThreadSync, lMaxLimit, 0, lThreadId)\r\nNext\r\n\r\nCall WaitForMultipleObjects(Count(ahThread()), ahThread(0), True, INFINITE)\r\n\r\nCloseHandle mhMutex\r\n\r\nMsgBox mCount\r\n\r\nEnd Sub\r\n\r\n'---------------------------------------------------------------------\r\n' This is the function that is shared by the 4 threads\r\n'---------------------------------------------------------------------\r\n\r\nPrivate Sub CountThreadSync(MaxLimit As Long)\r\n\r\nDim i As Long\r\nDim x As Long\r\n\r\nFor i = 0 To MaxLimit\r\n    WaitForSingleObject mhMutex, INFINITE\r\n    x = mCount\r\n    x = x + 1\r\n    mCount = x\r\n    ReleaseMutex mhMutex\r\nNext\r\n\r\nEnd Sub\r\n\r\n'---------------------------------------------------------------------\r\n' This is a support function\r\n'---------------------------------------------------------------------\r\n\r\nPrivate Function Count(ppahnotify() As Long) As Long\r\n\r\nDim i As Long\r\n\r\nFor i = 0 To UBound(ppahnotify)\r\n    If ppahnotify(i) = INVALID_HANDLE_VALUE Then\r\n        Exit For\r\n    End If\r\nNext\r\n\r\nCount = i\r\n\r\nEnd Function\r\n\r\n","Declares":"Declare Function CreateThread Lib \"kernel32\" (ByVal lpThreadAttributes As Long, ByVal dwStackSize As Long, ByVal lpStartAddress As Long, lpParameter As Long, ByVal dwCreationFlags As Long, lpThreadId As Long) As Long\r\nDeclare Function CloseHandle Lib \"kernel32\" (ByVal hObject As Long) As Long\r\nDeclare Function WaitForMultipleObjects Lib \"kernel32\" (ByVal nCount As Long, lpHandles As Long, ByVal bWaitAll As Long, ByVal dwMilliseconds As Long) As Long\r\nDeclare Function CreateMutex Lib \"kernel32\" Alias \"CreateMutexA\" (ByVal lpThreadAttributes As Long, ByVal initialOwner As Integer, ByVal lpMutexName As String) As Long\r\nDeclare Function WaitForSingleObject Lib \"kernel32\" (ByVal hHandle As Long, ByVal dwMilliseconds As Long) As Long\r\nDeclare Function ReleaseMutex Lib \"kernel32\" (ByVal hMutex As Long) As Long\r\n\r\nDim mCount As Long\r\nDim mhMutex As Long\r\n\r\nConst INVALID_HANDLE_VALUE = -1\r\nConst INFINITE = &HFFFF\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Threads","Multithreading"]},{"RecordId":"374","Title":"Save and Restore ADO Recordset Using XML","Description":"Persist and re-load an ADO recordset as an XML stream.","Code":"You can use ADO 2.1 and higher to write an ADO recordset to a by using this syntax:\r\nrs.Save \"c:\\temp\\myfile.xml\",adPersistXML\r\n\r\nYou can recreate the ADO recordset later by using this syntax with the Open method:\r\nrs.Open \"c:\\temp\\myfile.xml\",,adOpenForwardOnly,adLockReadOnly,adCmdFile\r\n","Declares":"","CodeCategory":{"CategoryId":"8","CategoryDescription":"XML"},"Keywords":["XML","ADO","Persist Data"]},{"RecordId":"375","Title":"INI File Manipulation - Profile Strings","Description":"Example routines of how to work with INI files.  Posted on Visual Basic Listserver/Newsgroup by Andrew O. Dennison.  You must add the calls to the FUNCTIONS to perform desired tasks.","Code":"' Reads integers from an ini file\r\n' Returns 0 if conversion failed\r\n'         nDefault if item not found\r\n' Just calls WIN API, but args order is a little more sensible\r\n' N.B. nDefault should be in the range 0..32767 accoding to WIN SDK doc.\r\n\r\n' removes the named entry from the named section\r\nFunction IniEntryDelete% (filePathName$, section$, entry$)\r\n    IniEntryDelete% = WritePrivateProfileString(section$, entry$, 0&, filePathName$) <> 0    ' ! 0 is success\r\nEnd Function\r\n\r\n' Calls GetPrivateProfileString\r\n' Reads ini files of the form:\r\n' [app name]\r\n' keyname = string   leading spaces are trimmed from string\r\n'\r\n' Args:\r\n' filePathName is win.ini, foo.ini, etc.\r\n'           if no path, then search windows dir\r\n' section - header for section of file\r\n' keyName - line to select\r\n' default - string to return, if keyName(or file) is not found\r\n'\r\n' Returns string found or default\r\n'\r\nFunction IniGet$ (filePathName$, section$, entry$, default$)\r\n    Dim retStr As String * 1024\r\n    Dim l%\r\n\r\n    'Debug.Print entry$\r\n    l% = GetPrivateProfileString(section$, entry$, default$, retStr$, Len(retStr$), filePathName$)\r\n    IniGet$ = Left$(retStr$, l%)\r\nEnd Function\r\n\r\nFunction IniIntGet% (filePathName$, section$, entry$, nDefault%)\r\n    IniIntGet% = GetPrivateProfileInt(section$, entry$, nDefault%, filePathName$)\r\nEnd Function\r\n\r\n' returns null chr(0) separated list of entry keys\r\nFunction IniKeys$ (filePathName$, section$)\r\n    Dim retStr As String * 1024\r\n    Dim l%\r\n\r\n    'Debug.Print entry$\r\n    l% = GetPrivateProfileString(section$, ByVal 0&, \"\", retStr$, Len(retStr$), filePathName$)\r\n    IniKeys$ = Left$(retStr$, l%)\r\nEnd Function\r\n\r\n' true for success\r\nFunction IniPut% (filePathName$, section$, entry$, value$)\r\n    Dim l%\r\n    \r\n    Debug.Print \"PutIni\", filePathName$, section$, entry$, value$\r\n    l% = WritePrivateProfileString(section$, entry$, value$, filePathName$)\r\n    Debug.Print \"IniPut% = \"; l% <> 0\r\n    IniPut% = l% <> 0         ' !0 is success\r\nEnd Function\r\n\r\nFunction IniSectionDelete% (filePathName$, section$)\r\n    IniSectionDelete% = WritePrivateProfileString(section$, 0&, 0&, filePathName$) <> 0   ' ! 0 is success\r\nEnd Function\r\n\r\n","Declares":"' INI.BAS -- get & put file.INI functions use windows API\r\nOption Explicit\r\n\r\nDeclare Function GetPrivateProfileString Lib \"Kernel\" (ByVal lpApplicationName As String, ByVal lpKeyName As Any, ByVal lpDefault As String, ByVal lpReturnedString As String, ByVal nSize As Integer, ByVal lpFileName As String) As Integer\r\nDeclare Function WritePrivateProfileString Lib \"Kernel\" (ByVal lpApplicationName As Any, ByVal lpKeyName As Any, ByVal lpString As Any, ByVal lplFileName As String) As Integer\r\nDeclare Function GetPrivateProfileInt Lib \"Kernel\" (ByVal lpApplicationName As String, ByVal lpKeyName As String, ByVal nDefault As Integer, ByVal lpFileName As String) As Integer\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["INI Files","INI"]},{"RecordId":"378","Title":"Determine Video Resolution","Description":"Determine video resolution mode","Code":"Dim xRes As Integer\r\nDim yRes As Integer\r\n\r\n'xRes=800 and yRes=640 on 800x640\r\nxRes = GetsystemMetrics(0)\r\nyRes = GetsystemMetrics(1)\r\n","Declares":"Declare Function GetsystemMetrics Lib \"User\" (ByVal nIndex As Integer) As Integer\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Video Resolution","Hardware","System Info"]},{"RecordId":"379","Title":"Create Win95/NT Shortcut","Description":"Creates Win95/NT shortcut.\r\nNOTE: See alternate \"Create Shortcut (Uses DDE)\" sample.  It is preferred over this one.","Code":"lResult = fCreateShellLink(\"..\\..\\Desktop\", \"Shortcut Title\", \"d:\\path\\appname.exe\", \"\")\r\n","Declares":"Declare Function fCreateShellLink Lib \"STKIT432.DLL\" (ByVal lpstrFolderName As String, ByVal lpstrLinkName As String, ByVal lpstrLinkPath As String, ByVal lpstrLinkArgs As String) As Long\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Shortcut","Installation","Setup"]},{"RecordId":"380","Title":"Get File Description","Description":"Determines file type description","Code":"Private Function GetFileType(lpStrFile As String) As String\r\n\r\n    Dim sfi As SHFILEINFO\r\n    If SHGetFileInfo(lpStrFile, 0, sfi, Len(sfi), SHGFI_TYPENAME) Then\r\n        GetFileType = Left$(sfi.szTypeName, InStr(sfi.szTypeName, vbNullChar) - 1)\r\n    Else\r\n        GetFileType = \"Unknown file\"\r\n    End If\r\n\r\nEnd Function\r\n\r\n\r\nPrivate Sub Form_Load()\r\n\r\n    Debug.Print GetFileType(\"c:\\a\\exposure.jpg\")\r\n\r\nEnd Sub\r\n","Declares":"Private Declare Function SHGetFileInfo Lib \"shell32.dll\" Alias \"SHGetFileInfoA\" (ByVal pszPath As String, ByVal dwFileAttributes As Long, psfi As SHFILEINFO, ByVal cbFileInfo As Long, ByVal uFlags As Long) As Long\r\n\r\nPrivate Const SHGFI_TYPENAME = &H400\r\nPrivate Const MAX_PATH = 260\r\n\r\nPrivate Type SHFILEINFO\r\n        hIcon As Long\r\n        iIcon As Long\r\n        dwAttributes As Long\r\n        szDisplayName As String * MAX_PATH\r\n        szTypeName As String * 80\r\nEnd Type\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["File Type","Mime Type","File Description"]},{"RecordId":"381","Title":"Register Un-register OCXs and DLLs Programatically","Description":"How to register OCXs and DLLs from a VB program.\r\nAll COM components export the DllRegisterServer and the DllUnregisterServer functions.\r\nCall these to register/unregister the component.\r\n","Code":"Sub Demo\r\n\r\n On Error GoTo Failure\r\n\r\n ' Register\r\n YourRegFunctionName\r\n\r\n ' Unregister\r\n YourUnregFunctionName\r\n\r\n Exit Sub\r\n\r\n\r\n Failure:\r\n If Err.Number = 429 Then\r\n   MsgBox \"Unable to register component\"\r\n   Exit Sub\r\n End If\r\n\r\nEnd Sub\r\n","Declares":"' NOTE:  You will need to create declarations for each component that you desire to\r\n' register/unregister.  \r\n\r\n' Replace YourRegFunctionName with a unique function name that you \r\n' desire to use for the particular component.\r\n' Replace YourDLL.DLL with the name of your component.\r\n\r\n' This works for DLLs and OCXs.  The function call for each one is still\r\n' DllRegisterServer and DllUnregisterServer even if the component is an OCX.\r\n\r\nDeclare Function YourRegFunctionName Lib \"YourDLL.DLL\" _\r\nAlias \"DllRegisterServer\"() As Long\r\n\r\nDeclare Function YourUnregFunctionName Lib \"YourDLL.DLL\" _\r\nAlias \"DllUnregisterServer\"() As Long","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Register","Unregister","Registering DLLs"]},{"RecordId":"382","Title":"Position Text in Control","Description":"Positions text inside of text box or label (left, center, right adjusted).","Code":"Call with \r\nmyfield = PositionTextInField(\"my text\", mycontrol, alignment)\r\nwhere alignment is 0 for left, 1 for center, 2 for right.\r\n\r\nPublic Function PositionTextInField(txtTextIn As String, ctlIn As Control, Optional intPosition As Variant) As String\r\n\r\nDim lngOneSpaceLength As Long\r\nDim lngCtlInWidth As Long\r\nDim lngTextInWidth As Long\r\nDim lngTotalSpaces As Long\r\nDim lngLeadingSpaces As Long\r\nDim txtTempText\r\n\r\nConst TEXTLEFT = 0\r\nConst TEXTCENTER = 1\r\nConst TEXTRIGHT = 2\r\n\r\ntxtTempText = Trim$(txtTextIn)\r\n\r\nIf TypeOf ctlIn Is TextBox Or TypeOf ctlIn Is Label Then\r\n\r\n    lngOneSpaceLength = TextWidth(\" \")\r\n    lngTextInWidth = TextWidth(txtTempText)\r\n    lngCtlInWidth = ctlIn.Width\r\n    \r\n    'Positions:  0=Left, 1=Center, 2=Right\r\n    If IsMissing(intPosition) Then\r\n        intPosition = TEXTLEFT\r\n    End If\r\n    \r\n    'Keep us honest\r\n    If Not IsNumeric(intPosition) Then\r\n        intPosition = TEXTLEFT\r\n    End If\r\n    \r\n    If (intPosition <> TEXTCENTER) And (intPosition <> TEXTRIGHT) Then\r\n        intPosition = TEXTLEFT\r\n    End If\r\n    \r\n    'Compute number of spaces required to fill remainder of control (not including text)\r\n    lngTotalSpaces = (lngCtlInWidth - lngTextInWidth) / lngOneSpaceLength\r\n    \r\n    \r\n    'Determine number of leading spaces required\r\n    Select Case intPosition\r\n        \r\n        Case TEXTLEFT\r\n            lngLeadingSpaces = 0\r\n                \r\n        Case TEXTCENTER\r\n            lngLeadingSpaces = (lngTotalSpaces / 2) - 1\r\n        \r\n        Case TEXTRIGHT\r\n            lngLeadingSpaces = lngTotalSpaces - 3\r\n    \r\n    End Select\r\n    \r\n    'Just to be safe...\r\n    If lngLeadingSpaces < 0 Then\r\n        lngLeadingSpaces = 0\r\n    End If\r\n            \r\n    PositionTextInField = Space$(lngLeadingSpaces) & txtTempText\r\n\r\nElse\r\n    PositionTextInField = txtTempText\r\nEnd If\r\n\r\nEnd Function","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Text alignment","Text box","Alignment"]},{"RecordId":"383","Title":"Resize Drop-down Combo Box","Description":"Resizes the list area of a drop-down combo box to other than the default 8 lines.","Code":"Public Sub Size_Combo(rForm As Form, rCbo As ComboBox)\r\n\r\nDim pt As POINTAPI\r\nDim rec As RECT\r\nDim iItemWidth As Integer\r\nDim iItemHeight As Integer\r\nDim iOldScaleMode As Integer\r\n\r\n'Change scalemode on form to pixels\r\niOldScaleMode = rForm.ScaleMode\r\nrForm.ScaleMode = 3\r\niItemWidth = rCbo.Width\r\n\r\n'Set new height of combo box\r\niItemHeight = rForm.ScaleHeight - rCbo.Top - 5\r\nrForm.ScaleMode = iOldScaleMode\r\n\r\n'Get coordinates relative to screen\r\nCall GetWindowRect(rCbo.hwnd, rec)\r\npt.x = rec.Left\r\npt.y = rec.Top\r\n\r\n'then relative to form\r\nCall ScreenToClient(rForm.hwnd, pt)\r\n\r\n'Resize combo box\r\nCall MoveWindow(rCbo.hwnd, pt.x, pt.y, iItemWidth, iItemHeight, 1)\r\n\r\nEnd Sub\r\n\r\n","Declares":"Declare Function MoveWindow Lib \"user32\" (ByVal hwnd As Long, ByVal x As Long, ByVal y As Long, ByVal nWidth As Long, ByVal nHeight As Long, ByVal bRepaint As Long) As Long\r\nDeclare Function GetWindowRect Lib \"user32\" (ByVal hwnd As Long, lpRect As RECT) As Long\r\nDeclare Function ScreenToClient Lib \"user32\" (ByVal hwnd As Long, lpPoint As POINTAPI) As Long\r\n\r\nType POINTAPI\r\n        x As Long\r\n        y As Long\r\nEnd Type\r\n\r\nType RECT\r\n        Left As Long\r\n        Top As Long\r\n        Right As Long\r\n        Bottom As Long\r\nEnd Type\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Combo box","Resize combo"]},{"RecordId":"384","Title":"Encrypt/Decrypt as String (Leon's Class)","Description":"Encrypts and decrypts a string.  The encrypt generates it's own seed each time, so a different encrypted string results.  The decrypt will always be able to reconstruct any one of the valid encrypted strings.","Code":"Const cBAD_INPUT = \"INVALID INPUT\"\r\n\r\nPublic Function Decrypt(ByVal StringToDecrypt As String) As String\r\n\tDecrypt = GetIt(StringToDecrypt)\r\nEnd Function\r\n\r\nPublic Function Encrypt(ByVal StringToEncrypt As String) As String\r\n\tEncrypt = SetIt(StringToEncrypt)\r\nEnd Function\r\n\r\nPrivate Function GetIt(iword As String) As String\r\n\t\r\n\tDim i As Integer\r\n\tDim buf As String\r\n\tDim seed As Integer\r\n\tDim slen As Integer\r\n\tDim nextchr As String\r\n\tDim oword As String\r\n\tDim ul As Integer\r\n\r\n\tIf iword = cBAD_INPUT Then\r\n    \tGetIt = cBAD_INPUT\r\n    \tExit Function\r\n\tEnd If\r\n\r\n\toword = \"\"\r\n\r\n\tIf Len(Trim(iword)) > 0 Then\r\n    \tseed = Asc(Left(iword, 1)) / 4\r\n    \tbuf = Mid(iword, 2)\r\n    \tslen = Len(buf)\r\n    \tFor i = slen To 1 Step -2\r\n        \tnextchr = Mid(buf, i - 1, 1)\r\n        \tul = Asc(Mid(buf, i, 1)) Mod 2\r\n        \tIf ul = 0 Then\r\n            \toword = oword & LCase(Chr(Int(((Asc(nextchr) * 2) / 2)) - seed))\r\n        \tElse\r\n            \toword = oword & Chr(Int(((Asc(nextchr) * 2) / 2)) - seed)\r\n        \tEnd If\r\n    \tNext\r\n\tElse\r\n    \toword = cBAD_INPUT\r\n\tEnd If\r\n\r\n\tGetIt = oword\r\n\toword = \"\"\r\n\r\nEnd Function\r\n\r\nPrivate Function SetIt(iword As String) As String\r\n\r\n\tDim i As Integer\r\n\tDim buf As String\r\n\tDim seed As Integer\r\n\tDim slen As Integer\r\n\tDim nextchr As String\r\n\tDim oword As String\r\n\tDim ul As Integer\r\n\r\n\tRandomize\r\n\tseed = Int(7 * Rnd + 25)\r\n\toword = \"\"\r\n\r\n\tIf Len(Trim(iword)) > 0 Then\r\n    \toword = Chr(seed * 4)\r\n    \tbuf = Trim(iword)\r\n    \tslen = Len(buf)\r\n    \tFor i = slen To 1 Step -1\r\n        \tnextchr = Mid(buf, i, 1)\r\n        \tIf Asc(nextchr) > 122 Then\r\n            \tSetIt = cBAD_INPUT\r\n            \tExit Function\r\n        \tEnd If\r\n\r\n        \tul = Int((240 - 200 + 1) * Rnd + 200) / 2\r\n        \tIf Asc(nextchr) >= 97 And Asc(nextchr) <= 122 Then\r\n            \tIf ul Mod 2 <> 0 Then ul = ul + 1\r\n        \tElse\r\n            \tIf ul Mod 2 = 0 Then ul = ul + 1\r\n        \tEnd If\r\n        \toword = oword & Chr(Asc(Chr((Asc(UCase(nextchr)) + seed) * 2)) / 2) & Chr(ul)\r\n    \tNext\r\n\tElse\r\n    \toword = cBAD_INPUT\r\n\tEnd If\r\n\r\n\tSetIt = oword\r\n\toword = \"\"\r\n\r\nEnd Function","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Encryption","Decryption"]},{"RecordId":"385","Title":"Hide Mouse Pointer","Description":"Hide Mouse Pointer.  Routine to show and/or hide the mouse pointer.","Code":"Do While ShowCursor(False) > -5: Loop:  ' Hide cursor\r\nDo While ShowCursor(True) < 5: Loop:    ' Show cursor\r\n","Declares":"Declare Sub ShowCursor Lib \"User\" (ByVal bShow%)\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Mouse Pointer","Cursor"]},{"RecordId":"386","Title":"Retrieve Registered Owner & Company From Registry","Description":"Retrieves registered Win95 or NT owner from the registry","Code":"Public Sub GetRegisteredUserInfo(strowner As String, strcompany As String)\r\n\r\nDim subkey As String\r\nDim key As Long\r\nDim res As Long\r\nDim owner As String\r\nDim company As String\r\nDim datalen As Long\r\nDim datatype As Long\r\n\r\nsubkey = \"SOFTWARE\\Microsoft\\\"\r\nIf OSVersion = \"Win95\" Then\r\n    subkey = subkey & \"Windows\\CurrentVersion\"\r\nElse\r\n    subkey = subkey & \"Windows NT\\CurrentVersion\"\r\nEnd If\r\n\r\nres = RegOpenKey(HKEY_LOCAL_MACHINE, subkey, key)\r\nIf res <> 0 Then\r\n    MsgBox \"Can't open key\"\r\n    strowner = \"\"\r\n    strcompany = \"\"\r\nEnd If\r\n\r\ndatalen = 255\r\nowner = String$(datalen, 0)\r\n\r\nres = RegQueryValueEx(key, \"RegisteredOwner\", 0, datatype, ByVal owner, datalen)\r\nstrowner = Left(owner, datalen - 1)\r\n\r\ndatalen = 255\r\ncompany = String$(datalen, 0)\r\n\r\nres = RegQueryValueEx(key, \"RegisteredOrganization\", 0, datatype, ByVal company, datalen)\r\nstrcompany = Left(company, datalen - 1)\r\n\r\nRegCloseKey key\r\n\r\n\r\nEnd Sub\r\n\r\n\r\n\r\n\r\n\r\n'-------------------------------------------------\r\nPublic Function OSVersion() As String\r\n\r\nDim OS As OSVERSIONINFO\r\n\r\nOS.dwOSVersionInfoSize = Len(OS)\r\nGetVersionEx OS\r\nIf OS.dwPlatformId <> VER_PLATFORM_WIN32_NT Then\r\n    OSVersion = \"Win95\"\r\nElse\r\n    OSVersion = \"NT\"\r\nEnd If\r\n\r\nEnd Function\r\n\r\n\r\n","Declares":"Declare Function GetVersionEx Lib \"kernel32\" Alias \"GetVersionExA\" (lpVersionInformation As OSVERSIONINFO) As Long\r\nDeclare Function RegOpenKey Lib \"advapi32.dll\" Alias \"RegOpenKeyA\" (ByVal hKey As Long, ByVal lpSubKey As String, phkResult As Long) As Long\r\nDeclare Function RegQueryValueEx Lib \"advapi32.dll\" Alias \"RegQueryValueExA\" (ByVal hKey As Long, ByVal lpValueName As String, ByVal lpReserved As Long, lpType As Long, lpData As Any, lpcbData As Long) As Long         ' Note that if you declare the lpData parameter as String, you must pass it By Value.\r\nDeclare Function RegCloseKey Lib \"advapi32.dll\" (ByVal hKey As Long) As Long\r\n\r\nType OSVERSIONINFO\r\n        dwOSVersionInfoSize As Long\r\n        dwMajorVersion As Long\r\n        dwMinorVersion As Long\r\n        dwBuildNumber As Long\r\n        dwPlatformId As Long\r\n        szCSDVersion As String * 128      '  Maintenance string for PSS usage\r\nEnd Type\r\n\r\nConst VER_PLATFORM_WIN32_NT = 2\r\nConst HKEY_LOCAL_MACHINE = &H80000002\r\n","CodeCategory":{"CategoryId":"7","CategoryDescription":"Misc"},"Keywords":["Owner Company","Registry","Registered owner"]},{"RecordId":"387","Title":"Mod 10 Check Digit","Description":"Generates a mod 10 check digit for any string inputted.","Code":"Public Function GetCheckDigit(strAcctIn As String) As String\r\n\r\nDim intSum As Integer\r\nDim intCharValue As Integer\r\nDim intMultiplier As Integer\r\nDim i As Integer\r\nDim strTempString As String\r\nDim strTempChar As String\r\n\r\nstrTempString = UCase$(Trim$(strAcctIn))\r\nintSum = 0\r\n\r\n\r\n'Determine multiplier based on length of string (if even, multiplier=1, if odd, multiplier=2)\r\n\r\nIf Len(strTempString) Mod 2 = 0 Then\r\n    intMultiplier = 1\r\nElse\r\n    intMultiplier = 2\r\nEnd If\r\n\r\nFor i = 1 To Len(strTempString)\r\n    \r\n    strTempChar = Mid$(strTempString, i, 1)\r\n    \r\n    \r\n    'Convert A-Z to numeric values (A=10, B=11, ... , Z=35)\r\n    \r\n    Select Case strTempChar\r\n        Case \"0\" To \"9\"\r\n            intCharValue = Val(strTempChar)\r\n        Case \"A\" To \"Z\"\r\n            intCharValue = Asc(strTempChar) - 55\r\n        Case Else\r\n            intCharValue = 0\r\n    End Select\r\n    \r\n    \r\n    'Accumulate sum of value of each digit\r\n    \r\n    intSum = intSum + ((intCharValue * intMultiplier) - (9 * ((intCharValue * intMultiplier) \\ 10)))\r\n\r\n    'Flip multiplier\r\n    \r\n    If intMultiplier = 1 Then\r\n        intMultiplier = 2\r\n    Else\r\n        intMultiplier = 1\r\n    End If\r\n    \r\nNext\r\n\r\n'If final sum is divisible by 10, check digit is 0, otherwise, check digit is 10 - (remainder of sum divided by 10)\r\n\r\nIf intSum Mod 10 = 0 Then\r\n    GetCheckDigit = \"0\"\r\nElse\r\n    GetCheckDigit = Val(10 - (intSum Mod 10))\r\nEnd If\r\n\r\nEnd Function\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Check Digit","Mod 10"]},{"RecordId":"388","Title":"Encryption/Decryption Routines (Preferred)","Description":"Encrypt/decrypt routines","Code":"Private Sub CryptFile (FileName As String, KeyValue As String, fEncrypt As Integer)\r\n\r\n\t'This subrouting encrypts/decrypts a file.  It calls\r\n\t'subrouting SimpleCrypt to en/decrypt each string read from the file.\r\n\t\r\n\tDim hFile As Integer, Buffer As String, Buffer2 As String\r\n\tDim LastBlockSize As Integer, Block As Integer\r\n\tDim Blocks As Long, Offset As Long\r\n\tConst BLOCKSIZE = 8192\r\n\t\r\n\tBuffer = Space(BLOCKSIZE)\r\n\t\r\n\thFile = FreeFile\r\n\tOpen FileName For Binary As fFile\r\n\tBlocks = (LOF(fFile) \\ BLOCKSIZE) + 1\r\n\tLastBlockSize = LOF(fFile) Mod BLOCKSIZE\r\n\t\r\n\tFor Block = 1 To Blocks\r\n\t    If Block = Blocks Then Buffer = Space(LastBlockSize)\r\n\t    Offset = Seek(fFile)\r\n\t    Get hFile, , Buffer\r\n\t    Buffer2 = \"\"\r\n\t\r\n\t    If fEncrypt Then\r\n\t        SimpleCrypt Buffer, Buffer2, KeyValue\r\n\t    Else\r\n\t        SimpleCrypt Buffer2, Buffer, KeyValue\r\n\t    End If\r\n\t    Put hFile, Offset, Buffer2\r\n\tNext Block\r\n\t\r\n\tClose hFile\r\n\r\nEnd Sub\r\n\r\nPrivate Sub SimpleCrypt(PlainText As String, CipherText As String, KeyValue As String)\r\n\r\n    'This fuction encrypts/decrypts a string\r\n    'To encrypt, call with blank CipherText parm\r\n    'To decript, call with blank PlainText parm\r\n    \r\n    Dim i As Long, Prev As Integer, Result As String\r\n    Dim Char As Integer, KeyIndex As Integer\r\n    Dim KeyLen As Integer, TextValue As String\r\n    Dim NewChar As Integer, fEncrypting As Integer\r\n    ReDim KeyChar(255) As Integer\r\n    \r\n    'Magic Values used for en/decryption\r\n    Const MAGIC1 = 42\r\n    Const MAGIC2 = 3\r\n    \r\n    'Are we encrypting or decrypting?\r\n    If Len(PlainText) Then\r\n        fEncrypting = True\r\n        TextValue = PlainText\r\n    Else\r\n        ' NOTE:  If you want to convert non-printable characters to printable characters,\r\n        ' use the line 1 below, otherwise use line 2 below.\r\n        'TextValue = HexBin(CipherText)  '(1)\r\n        TextValue = CipherText               '(2)\r\n    End If\r\n    \r\n    'Initialize previous character value, index into key string & length of key\r\n    Prev = MAGIC1\r\n    KeyIndex = 1\r\n    KeyLen = Len(KeyValue)\r\n    \r\n    'Convert key string to array\r\n    For i = 1 To Len(KeyValue)\r\n        KeyChar(i) = Asc(Mid(KeyValue, i, 1))\r\n    Next i\r\n    \r\n    \r\n    'En/decrypt loop\r\n    For i = 1 To Len(TextValue)\r\n        Char = Asc(Mid(TextValue, i, 1))\r\n        NewChar = Char Xor KeyChar(KeyIndex) Xor Prev Xor ((i / MAGIC2) Mod 255)\r\n        Result = Result & Chr(NewChar)\r\n        If fEncrypting Then\r\n            Prev = Char\r\n        Else\r\n            Prev = NewChar\r\n        End If\r\n        KeyIndex = KeyIndex + 1\r\n        If KeyIndex > KeyLen Then KeyIndex = 1\r\n    Next i\r\n    \r\n    If fEncrypting Then\r\n        ' NOTE:  If you want to convert non-printable characters to printable characters,\r\n        ' use line 1 below, otherwise use line 2 below.\r\n        'CipherText = BinHex(Result)   '(1)\r\n        CipherText = Result                '(2)\r\n    Else\r\n        PlainText = Result\r\n    End If\r\n\r\nEnd Sub\r\n\r\nFunction BinHex(BinStr As String) As String\r\n\r\n    ' This function converts non-printable characters into data that can\r\n    ' be viewed/printed (as in INI files)\r\n    \r\n    Dim Result As String, i As Integer\r\n    \r\n    For i = 1 To Len(BinStr)\r\n        Result = Result & Right(\"00\" & Hex(Asc(Mid(BinStr, i, 1))), 2)\r\n    Next i\r\n    \r\n    BinHex = Result\r\n\r\nEnd Function\r\n\r\nFunction HexBin(HexStr As String) As String\r\n\r\n    ' This function converts characters that can be viewed/printed\r\n    ' (as in INI files) back to original non-printable characters\r\n    \r\n    Dim Result As String, i As Integer\r\n    \r\n    For i = 1 To Len(HexStr) Step 2\r\n        Result = Result & Chr(Val(\"&H\" & Mid(HexStr, i, 2)))\r\n    Next i\r\n    \r\n    HexBin = Result\r\n\r\nEnd Function\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Encryption","Decryption"]},{"RecordId":"389","Title":"Determine VB5 Runtime mode","Description":"Determines whether you are running from VB development environment or not.","Code":"Function InRunMode(VBInst As VBIDE.VBE) As Boolean\r\nInRunMode = (VBInst.CommandBars(\"Run\").Controls(\"End\").Enabled = True)\r\nEnd Function","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Environment VB","EXE","Runtime"]},{"RecordId":"390","Title":"Remove Min/Max Buttons From MDI Form","Description":"An MDI form doesn't have min/max button design-time properties like a regular form does.  This code provides a means of disabling the min/max buttons on an MDI form.","Code":"----------------------------------------------------------------------------\r\nPlace the code in the MDI Form_Load event\r\n----------------------------------------------------------------------------\r\n\r\nDim lWnd As Long\r\n\r\nlWnd = GetWindowLong(Me.hwnd, GWL_STYLE)\r\nlWnd = lWnd And Not (WS_MINIMIZEBOX)\r\nlWnd = lWnd And Not (WS_MAXIMIZEBOX)\r\nlWnd = SetWindowLong(Me.hwnd, GWL_STYLE, lWnd)\r\n","Declares":"Declare Function SetWindowLong Lib \"user32\" Alias \"SetWindowLongA\" (ByVal hwnd As Long, ByVal nIndex As Long, ByVal dwNewLong As Long) As Long\r\nDeclare Function GetWindowLong Lib \"user32\" Alias \"GetWindowLongA\" (ByVal hwnd As Long, ByVal nIndex As Long) As Long\r\n\r\nPublic Const WS_MINIMIZEBOX = &H20000\r\nPublic Const WS_MAXIMIZEBOX = &H10000\r\nPublic Const GWL_STYLE = (-16)\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["MDI","Min/Max button"]},{"RecordId":"391","Title":"Saving Class Property Bag Data","Description":"Demonstrates how to convert property bag information to stream data that can be saved\r\nand retrieve from a file.\r\n\r\nNOTE:  This is a stripped down version of the Persisting Objects (In Classes) sample","Code":"'-----------------------------------------\r\n' Uses the Bag Handler class to convert property bag\r\n' data to streams and back again (Assumes a horse and bet object exists)\r\n'-----------------------------------------\r\n\r\nPrivate Sub cmdFileRead_Click()\r\n\r\n    Dim b() As Byte\r\n    Dim oHandler As New BagHandler\r\n    \r\n    b = oHandler.ReadFromFile(txtFileName.Text)\r\n    Set mBet = oHandler.UnStream(b)\r\n    displayBet mBet\r\n\r\nEnd Sub\r\n\r\nPrivate Sub cmdFileWrite_Click()\r\n\r\n    Dim b() As Byte\r\n    Dim oHandler As New BagHandler\r\n    \r\n    Set mBet = createBet()\r\n    If IsObject(mBet) Then\r\n       b = oHandler.Stream(mBet)\r\n       oHandler.writeToFile b, txtFileName.Text\r\n    End If\r\n\r\nEnd Sub\r\n\r\n'-----------------------------------------\r\n' Bag Handler Class (Assumes a horse and bet object exists)\r\n'-----------------------------------------\r\n\r\nOption Explicit\r\n\r\nPublic Function Stream(obj As Object) As Byte()\r\n    Dim oBag As New PropertyBag\r\n    oBag.WriteProperty \"MyObj\", obj\r\n    Stream = oBag.Contents\r\nEnd Function\r\n\r\nPublic Function UnStream(bStream() As Byte) As Object\r\n    Dim oBag As New PropertyBag\r\n    oBag.Contents = bStream()\r\n    Set UnStream = oBag.ReadProperty(\"MyObj\")\r\nEnd Function\r\n\r\nPublic Sub writeToFile(bStream() As Byte, sFileName As String)\r\n    \r\n    Dim iFile As Integer\r\n    Dim vStream As Variant\r\n    \r\n    vStream = bStream()\r\n    iFile = FreeFile\r\n    \r\n    Open \"C:\\\" & sFileName & \".bag\" For Binary As iFile\r\n    Put iFile, , vStream\r\n    Close iFile\r\n\r\nEnd Sub\r\n\r\nPublic Function readFromFile(sFileName As String) As Byte()\r\n\r\n    Dim iFile As Integer\r\n    Dim vData As Variant\r\n    \r\n    iFile = FreeFile\r\n    Open \"C:\\\" & sFileName & \".bag\" For Binary As iFile\r\n    Get iFile, , vData\r\n    Close iFile\r\n    readFromFile = vData\r\n\r\nEnd Function","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Property Bag","Persist"]},{"RecordId":"393","Title":"Remove Control Box Menu Items","Description":"Removes menu items from a forms Control Box menu","Code":"Sub RemoveSysMenufordialog (frm As Form)\r\n\r\n    'This routine expects the form passed to have a\r\n    'border style of fixed double and to have max and min buttons\r\n    'removed, it will work on other forms but will look stupid.\r\n    'A form of this style will leave just \"move\", \"close\" and \"Switch to\" in the system menu\r\n    'this routine just removes the \"switch to\" and seperator bars.\r\n\r\n    '***** Call this routine from the load event of the modal form *****\r\n\r\n    Dim hMenu As Integer\r\n    Dim ret As Integer\r\n\r\n    hMenu = GetSystemMenu(frm.hWnd, 0)\r\n    \r\n    'remove \"Switch to\"\r\n    ret = RemoveMenu(hMenu, 8, MF_BYPOSITION)\r\n    'remove 1st sep bar\r\n    ret = RemoveMenu(hMenu, 7, MF_BYPOSITION)\r\n    'remove 2nd sep bar\r\n    ret = RemoveMenu(hMenu, 5, MF_BYPOSITION)\r\n\r\nEnd Sub","Declares":"","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Menu","Control Box"]},{"RecordId":"394","Title":"Update Graph data Via A Timer","Description":"Changes graph data with timer.  To run it place a graph control and a timer on your form. Set timer interval e.g. to 1000.\r\n","Code":"'When setting AutoInc=1 use following\r\n \r\nSub Timer1_Timer ()\r\n   Dim i%\r\n   Graph1.DataReset = 1\r\n   Graph1.AutoInc = 1\r\n   For i% = 1 To (Graph1.NumSets * Graph1.NumPoints)\r\n      Graph1.GraphData = Rnd 'Put here your actual data\r\n   Next i%\r\n   Graph1.DrawMode = 2\r\nEnd Sub\r\n \r\n'If you don't use Autoinc then use following\r\n \r\nSub Timer1_Timer ()\r\n   Dim i%, j%\r\n   Graph1.ThisSet = 1\r\n   For i% = 1 To Graph1.NumSets\r\n      Graph1.ThisPoint = 1\r\n      For j% = 1 To Graph1.NumPoints\r\n         Graph1.GraphData = Rnd 'Put here your actual data\r\n      If Graph1.ThisPoint < Graph1.NumPoints Then\r\n         Graph1.ThisPoint = Graph1.ThisPoint + 1\r\n      End If\r\n      Next j%\r\n      If Graph1.ThisSet < Graph1.NumSets Then\r\n         Graph1.ThisSet = Graph1.ThisSet + 1\r\n      End If\r\n   Next i%\r\n   Graph1.DrawMode = 2\r\nEnd Sub\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Graph","Timer"]},{"RecordId":"395","Title":"Demonstrates Updatable Disconnected ADO Recordset","Description":"Demonstrates updatable disconnected ADO recordset that also saves pending changes to a  local disk file on the PC.","Code":"Private Sub cmdOpen_Click()\r\n\r\nDim rs As ADOR.Recordset\r\nDim oRemoteData As New clsRemoteData\r\n\r\n\r\n' Open a disconnected recordset\r\n\r\nSet rs = oRemoteData.GetData\r\nDo While Not rs.EOF\r\n    Debug.Print rs!Seq_Nbr_Key\r\n    \r\n    ' Change one record\r\n    \r\n    If rs!Seq_Nbr_Key = 4 Then\r\n        rs!Record_Data = \"NN\"\r\n    End If\r\n    \r\n    rs.MoveNext\r\nLoop\r\n\r\n\r\n' Save the recordset to local storage and close it down\r\n' (Remember, there is a pending change to one record that\r\n'  has not been applied yet. . .)\r\n\r\nrs.Save \"c:\\ted\\TedsData.adtg\", adPersistADTG\r\n\r\nrs.Close\r\nSet rs = Nothing\r\nSet oRemoteData = Nothing\r\n\r\nEnd Sub\r\n\r\n'************************************************************************\r\n\r\nPrivate Sub cmdUpdate_Click()\r\n\r\nDim rs As ADOR.Recordset\r\nDim oRemoteData As New clsRemoteData\r\n\r\n\r\n' Re-claim the locally stored data (which includes pending changes)\r\n\r\nSet rs = New ADOR.Recordset\r\nrs.Open \"c:\\ted\\TedsData.adtg\"\r\n\r\n\r\n' Apply the changes back to the table\r\n\r\nrs.MarshalOptions = adMarshalModifiedOnly\r\noRemoteData.SaveData rs\r\n\r\nSet rs = Nothing\r\nSet oRemoteData = Nothing\r\n\r\nEnd Sub\r\n\r\n'************************************************************************\r\nPublic Function GetData() As ADODB.Recordset\r\n\r\nDim cn As New ADODB.Connection\r\nDim rs As New ADODB.Recordset\r\n\r\ncn.Open \"Driver={SQL Server};Server=Develop2;uid=sa;pwd=;Database=PeriodicPay\"\r\n'cn.Open \"Provider=SQLOLEDB;Server=Develop2;uid=sa;pwd=;Database=PeriodicPay\"\r\n\r\nrs.CursorLocation = adUseClient\r\nrs.Open \"SELECT * FROM System_Control\", cn, adOpenKeyset, adLockBatchOptimistic\r\n\r\nSet GetData = rs\r\n\r\nSet rs.ActiveConnection = Nothing\r\ncn.Close\r\n\r\nEnd Function\r\n\r\n'************************************************************************\r\n\r\nPublic Sub SaveData(rsIn As Object)\r\n\r\nDim rs As New ADODB.Recordset\r\n\r\nrs.Open rsIn, \"Driver={SQL Server};Server=Develop2;uid=sa;pwd=;Database=PeriodicPay\"\r\nrs.UpdateBatch\r\n\r\nEnd Sub\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Disconnected Recordsets","ADO"]},{"RecordId":"397","Title":"Restore App","Description":"Restores the window whose handle you pass to it.","Code":"Sub RestoreApp (wHandle)\r\nWM_SYSCOMMAND = &H112\r\nSC_RESTORE = &HF120\r\n\r\nIf IsIconic(Instance) Then\r\nT = PostMessage(Instance, WM_SYSCOMMAND, SC_RESTORE, 0)\r\nWaitSecs 1\r\nEnd If\r\nEnd Sub\r\n","Declares":"Declare Function IsIconic Lib \"user\" (ByVal hWnd As Any)\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Activate Window","Restore Window","Find Window"]},{"RecordId":"398","Title":"Drive Types","Description":"Determine disk drive types on PC","Code":"Dim i As Integer\r\n'Drive 0 is the A drive, 1 is B, etc.\r\n\r\nFor i = 0 To 25\r\n    \r\n    If GetDriveType(i) = 2 Then\r\n        DriveType = \"Floppy\"\r\n    End If\r\n    \r\n    If GetDriveType(i) = 3 Then\r\n        DriveType = \"Fixed/Hard\"\r\n    End If\r\n    \r\n    If GetDriveType(i) = 4 Then\r\n        DriveType = \"Remote/Network/CD\"\r\n    End If\r\n    \r\nNext\r\n","Declares":"Declare Function GetDriveType% Lib \"Kernel\" (ByVal nDrive%)\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Drive Types","Hardware"]},{"RecordId":"399","Title":"Title Bar - Creating A Thin One","Description":"Creating a thin title bar on a form.","Code":"'Here is the source code for making a 'thin title bar'.\r\n'The easiest way to do it is to make a small label on top of the form and then do the following:\r\n'-------------------------------------------------------------------------------------------------\r\n'Place this code in the form load event of the toolbar form.\r\n'-------------------------------------------------------------------------------------------------\r\n  'Size & position the label to appear as a caption\r\n    Label1.Width = Me.Width\r\n    Label1.Top = 0\r\n    Label1.Caption = \"Toolbar demo\"\r\n    \r\n\r\n'-------------------------------------------------------------------------------------------------\r\n'Place this code in the mouse down load event of the toolbar form.\r\n'-------------------------------------------------------------------------------------------------\r\n    Dim i As Long\r\n    \r\n    'Allows Windows to drag the window as if it had a caption bar\r\n    If Button = 1 Then\r\n        Call ReleaseCapture\r\n        i = SendMessage(hWnd, WM_NCLBUTTONDOWN, HTCAPTION, ByVal 0&)\r\n    End If\r\n","Declares":"Declare Function SendMessage Lib \"User\" (ByVal hWnd As Integer, ByVal wMsg As Integer, ByVal wParam As Integer, lParam As Any) As Long\r\nDeclare Sub ReleaseCapture Lib \"User\" ()\r\n\r\nConst WM_NCLBUTTONDOWN = &HA1\r\nConst HTCAPTION = 2\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Title Bar","Caption Bar"]},{"RecordId":"400","Title":"Project Settings for ActiveX DLL & EXE Components","Description":"VB project settings for ActiveX DLL and EXE components","Code":"The 'Unattended Execution' and 'Retain in Memory' options must be checked for any DLL VB Project that will be running in a multi-threaded process, such as MTS or IIS.\r\n\r\nNote also, poolable objects (for use in COM+) must not be marked Apartment model.  They must run in the MultiThreaded Apartment or the Neutral Apartment.  Currently (Sept 99), the VB IDE can only create Apartment model components.  For this reason, VB components can not be pooled.\r\n\r\n\r\nPreferred VB Project Settings\r\n----------------------------------------------------------\r\nUnattended Execution:  Checked\r\nThreading Model:  Apartment\r\nRetained in Memory:  Checked\r\nProject Compatibility during development.\r\nBinary Compatibility after initial release.\r\n\r\n\r\n\r\nActiveX EXE Project Settings\r\n----------------------------------------------------------\r\nUnattended Execution:  Checked\r\nThreading Model:  Disabled by default\r\nEither select \"Thread Per Object\" or select \"Thread Pool\" and set to a number greater than 1.\r\nRetained in Memory:  Checked\r\nProject Compatibility during development.\r\nBinary Compatibility after initial release.\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["MTS","ActiveX","Project Settings"]},{"RecordId":"401","Title":"Multi-Thread (Non-synchronous)","Description":"Creates 4 threads that each call the same function and demonstrate impact on un-synchronized functions.  (Mutexes and Semaphores solve the synchronization problem.)","Code":"'---------------------------------------------------------------------\r\n' This starts 4 threads\r\n'---------------------------------------------------------------------\r\n\r\nPublic Sub StartNonSynchronousThreads()\r\n\r\nDim ahThread(4) As Long\r\nDim lThreadId As Long\r\nDim lMaxLimit As Long\r\nDim i As Long\r\n\r\nmCount = 0\r\nlMaxLimit = 25000\r\n\r\nFor i = 0 To UBound(ahThread)\r\n    ahThread(i) = INVALID_HANDLE_VALUE\r\nNext\r\n\r\nFor i = 0 To UBound(ahThread)\r\n    ahThread(i) = CreateThread(0, 0, AddressOf CountThreadNonSync, lMaxLimit, 0, lThreadId)\r\nNext\r\n\r\nCall WaitForMultipleObjects(Count(ahThread()), ahThread(0), True, INFINITE)\r\n\r\nMsgBox mCount\r\n\r\nEnd Sub\r\n\r\n'---------------------------------------------------------------------\r\n' This is the function that is called by the threads\r\n'---------------------------------------------------------------------\r\n\r\nPrivate Sub CountThreadNonSync(MaxLimit As Long)\r\n\r\nDim i As Long\r\nDim x As Long\r\n\r\nFor i = 0 To MaxLimit\r\n    x = mCount\r\n    x = x + 1\r\n    mCount = x\r\nNext\r\n\r\nEnd Sub\r\n\r\n'---------------------------------------------------------------------\r\n' This is a support function\r\n'---------------------------------------------------------------------\r\n\r\nPrivate Function Count(ppahnotify() As Long) As Long\r\n\r\nDim i As Long\r\n\r\nFor i = 0 To UBound(ppahnotify)\r\n    If ppahnotify(i) = INVALID_HANDLE_VALUE Then\r\n        Exit For\r\n    End If\r\nNext\r\n\r\nCount = i\r\n\r\nEnd Function\r\n\r\n","Declares":"Declare Function CreateThread Lib \"kernel32\" (ByVal lpThreadAttributes As Long, ByVal dwStackSize As Long, ByVal lpStartAddress As Long, lpParameter As Long, ByVal dwCreationFlags As Long, lpThreadId As Long) As Long\r\nDeclare Function CloseHandle Lib \"kernel32\" (ByVal hObject As Long) As Long\r\nDeclare Function WaitForMultipleObjects Lib \"kernel32\" (ByVal nCount As Long, lpHandles As Long, ByVal bWaitAll As Long, ByVal dwMilliseconds As Long) As Long\r\nDeclare Function CreateMutex Lib \"kernel32\" Alias \"CreateMutexA\" (ByVal lpThreadAttributes As Long, ByVal initialOwner As Integer, ByVal lpMutexName As String) As Long\r\nDeclare Function WaitForSingleObject Lib \"kernel32\" (ByVal hHandle As Long, ByVal dwMilliseconds As Long) As Long\r\nDeclare Function ReleaseMutex Lib \"kernel32\" (ByVal hMutex As Long) As Long\r\n\r\nDim mCount As Long\r\nDim mhMutex As Long\r\n\r\nConst INVALID_HANDLE_VALUE = -1\r\nConst INFINITE = &HFFFF\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Threads","Multithreading"]},{"RecordId":"402","Title":"Exit Windows (and Reboot) 32-bit","Description":"Exit windows and reboot the workstation (or server)","Code":"'---------------------------------------------------------------------------------------------\r\n' This is code to perform the shutdown\r\n'---------------------------------------------------------------------------------------------\r\nDim lngVersion As Long\r\n\r\n'Get operating system version\r\nlngVersion = GetVersion()\r\nIf ((lngVersion And &H80000000) = 0) Then\r\n   glngWhichWindows32 = mlngWindowsNT\r\nElse\r\n   glngWhichWindows32 = mlngWindows95\r\nEnd If\r\n\r\n'If NT, we have to set job priviledges\r\nIf glngWhichWindows32 = mlngWindowsNT Then\r\n    AdjustToken\r\nEnd If\r\n\r\n'Shut it down and reboot\r\nExitWindowsEx (EWX_FORCE Or EWX_REBOOT), &HFFFF\r\n           \r\nEnd\r\n\r\n'---------------------------------------------------------------------------------------------\r\n' This is a support function \r\n'---------------------------------------------------------------------------------------------\r\nPrivate Sub AdjustToken()\r\n      \r\n'********************************************************************\r\n'* This procedure sets the proper privileges to allow a log off or a\r\n'* shut down to occur under Windows NT.\r\n'********************************************************************\r\n\r\nDim hdlProcessHandle As Long\r\nDim hdlTokenHandle As Long\r\nDim tmpLuid As LUID\r\nDim tkp As TOKEN_PRIVILEGES\r\nDim tkpNewButIgnored As TOKEN_PRIVILEGES\r\nDim lBufferNeeded As Long\r\n\r\n'Set the error code of the last thread to zero using the\r\n'SetLast Error function. Do this so that the GetLastError\r\n'function does not return a value other than zero for no\r\n'apparent reason.\r\n\r\nSetLastError 0\r\n\r\n'Use the GetCurrentProcess function to set the hdlProcessHandle\r\n'variable.\r\nhdlProcessHandle = GetCurrentProcess()\r\nOpenProcessToken hdlProcessHandle, (TOKEN_ADJUST_PRIVILEGES Or TOKEN_QUERY), hdlTokenHandle\r\n\r\n'Get the LUID for shutdown privilege\r\nLookupPrivilegeValue \"\", \"SeShutdownPrivilege\", tmpLuid\r\n\r\ntkp.PrivilegeCount = 1    ' One privilege to set\r\ntkp.TheLuid = tmpLuid\r\ntkp.Attributes = SE_PRIVILEGE_ENABLED\r\n\r\n'Enable the shutdown privilege in the access token of this process\r\nAdjustTokenPrivileges hdlTokenHandle, False, tkp, Len(tkpNewButIgnored), tkpNewButIgnored, lBufferNeeded\r\n\r\nEnd Sub\r\n","Declares":"Private Declare Function ExitWindowsEx Lib \"user32\" (ByVal uFlags As Long, ByVal dwReserved As Long) As Long\r\nPrivate Declare Function GetCurrentProcess Lib \"kernel32\" () As Long\r\nPrivate Declare Function OpenProcessToken Lib \"advapi32\" (ByVal ProcessHandle As Long, ByVal DesiredAccess As Long, TokenHandle As Long) As Long\r\nPrivate Declare Function LookupPrivilegeValue Lib \"advapi32\" Alias \"LookupPrivilegeValueA\" (ByVal lpSystemName As String, ByVal lpName As String, lpLuid As LUID) As Long\r\nPrivate Declare Function AdjustTokenPrivileges Lib \"advapi32\" (ByVal TokenHandle As Long, ByVal DisableAllPrivileges As Long, NewState As TOKEN_PRIVILEGES, ByVal BufferLength As Long, PreviousState As TOKEN_PRIVILEGES, ReturnLength As Long) As Long\r\nPrivate Declare Sub SetLastError Lib \"kernel32\" (ByVal dwErrCode As Long)\r\nPrivate Declare Function GetLastError Lib \"kernel32\" () As Long\r\nPrivate Declare Function GetVersion Lib \"kernel32\" () As Long\r\n\r\nPrivate Const EWX_FORCE = 4\r\nPrivate Const EWX_LOGOFF = 0\r\nPrivate Const EWX_REBOOT = 2\r\nPrivate Const EWX_SHUTDOWN = 1\r\n\r\nPrivate Const TOKEN_ADJUST_PRIVILEGES = &H20\r\nPrivate Const TOKEN_QUERY = &H8\r\nPrivate Const SE_PRIVILEGE_ENABLED = &H2\r\n\r\nPrivate Const mlngWindows95 = 0\r\nPrivate Const mlngWindowsNT = 1\r\nPrivate glngWhichWindows32 As Long\r\n\r\nPrivate Type LUID\r\n  UsedPart As Long\r\n  IgnoredForNowHigh32BitPart As Long\r\nEnd Type\r\n\r\nPrivate Type LUID_AND_ATTRIBUTES\r\n  TheLuid As LUID\r\n  Attributes As Long\r\nEnd Type\r\n\r\nPrivate Type TOKEN_PRIVILEGES\r\n   PrivilegeCount As Long\r\n   TheLuid As LUID\r\n   Attributes As Long\r\nEnd Type","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Exit Windows","Reboot","Shut down"]},{"RecordId":"403","Title":"Wait for Shell Completion (32 bit)","Description":"Wait for shelled program to finished (32 bit)","Code":"TaskID = Shell(\"dosapp.exe\", vbNormalFocus)\r\nOn Error GoTo finished\r\nWhile True\r\n    DoEvents\r\n    AppActivate TaskID\r\nWend\r\nfinished:\r\nOn Error GoTo 0\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Wait","Shell"]},{"RecordId":"404","Title":"Determine VB Environment","Description":"Determines if an application is running as an .EXE or running in the VB environment.","Code":"Title$ = App.Title\r\nhw = FindWindow(\"ThunderRTMain\", Title$)\r\nIf hw Then\r\n    hInst=GetWindowWord(hw, GWW_HINSTANCE)\r\n    MsgBox \"Running as an EXE file.  hInstance = \" & Format$(hInst)\r\nElse\r\n    hw = FindWindow(\"ThunderMain\", \"Microsoft Basic\")\r\n    If hw Then\r\n         hInst = GetWindowWord(hw, GWW_HINSTANCE)\r\n         MsgBox \"We're in the VB environment.  hInstance = \" & Format$(hInst)\r\n    End If\r\nEnd If     \r\n\r\n","Declares":"Declare Function FindWindow Lib \"User\" (ByVal lpClassName As String,     ByVal lpWindowName As Any) As Integer\r\n\r\nDeclare Function GetWindowWord Lib \"User\" (ByVal hWnd As Integer,         ByVal nIndex As Integer) As Integer\r\n\r\nConst GWW_HINSTANCE=(-6)\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Environment VB","EXE","Runtime"]},{"RecordId":"406","Title":"Crystal Reports Sample","Description":"This code consists of 3 parts. #1 is the printer selection dialog, #2 is the form\r\nmodule, and #3 is the call to the whole thing.\r\n","Code":"'****************************\r\nSub GetPrinter (ReturnCode$, DriverName$, PrinterName$, PortName$, Specs$)\r\n\r\nReDim SelPrinters$(10, 3)\r\nDim di%, x%, libhnd%, bufsize%, listidx%\r\nDim dminstring$, dmoutstring$\r\nDim dminaddr&, dmoutaddr&\r\nDim devstring As String * 4096\r\nDim startpos%, endpos%, selpinc%, defpos%\r\nDim def$, temp$\r\n\r\nLoad frmPrintSelect\r\n\r\ndef$ = String$(128, 0)\r\ndi% = GetProfileString%(\"WINDOWS\", \"DEVICE\", \"\", def$, 127)\r\ndef$ = dwGetStringFromLPSTR$(def$)\r\ndi% = GetProfileString%(\"devices\", 0&, \"\", devstring, 4095)\r\n\r\nstartpos% = 1\r\nselpinc% = 0\r\ndefpos% = 0\r\n\r\nDo While (Asc(Mid$(devstring, startpos%, 1)) <> 0)\r\n    endpos% = InStr(startpos%, devstring, Chr$(0))\r\n    SelPrinters$(selpinc%, 0) = Mid$(devstring, startpos%, endpos% - startpos%)\r\n    If Len(Trim$(def$)) <> 0 Then\r\n        If SelPrinters$(selpinc%, 0) = Left$(def$, InStr(1, def$, \",\") - 1) Then\r\n            defpos% = selpinc%\r\n        End If\r\n    End If\r\n    startpos% = endpos% + 1\r\n    selpinc% = selpinc% + 1\r\nLoop\r\n\r\nselpinc% = 0\r\nDo While Len(Trim$(SelPrinters$(selpinc%, 0))) <> 0\r\n    devstring = String$(4095, 32)\r\n    di% = GetProfileString%(\"devices\", SelPrinters$(selpinc%, 0), \"GUH!\", devstring, 4095)\r\n    endpos% = InStr(1, devstring, \",\")\r\n    SelPrinters$(selpinc%, 1) = Left$(devstring, endpos% - 1)\r\n    SelPrinters$(selpinc%, 2) = Right$(Trim$(devstring), Len(Trim$(devstring)) - endpos%)\r\n    libhnd% = LoadLibrary(SelPrinters$(selpinc%, 1) + \".drv\")\r\n    If libhnd% = 0 Then Exit Sub\r\n    bufsize% = dwExtDeviceMode%(frmPrintSelect.hWnd, libhnd%, 0, SelPrinters$(selpinc%, 0), SelPrinters$(selpinc%, 2), 0, 0, 0)\r\n    dminstring$ = String$(bufsize%, 0)\r\n    dmoutstring$ = String$(bufsize%, 0)\r\n    dminaddr& = dwGetAddressForVBString&(dminstring$)\r\n    dmoutaddr& = dwGetAddressForVBString&(dmoutstring$)\r\n    di% = dwExtDeviceMode%(frmPrintSelect.hWnd, libhnd%, dmoutaddr&, SelPrinters$(selpinc%, 0), SelPrinters$(selpinc%, 2), dminaddr&, 0, DM_IN_BUFFER Or DM_OUT_BUFFER)\r\n    SelPrinters$(selpinc%, 3) = dmoutstring$\r\n    FreeLibrary (libhnd%)\r\n    frmPrintSelect!lstPrintList.AddItem SelPrinters$(selpinc%, 0) & \" at \" & SelPrinters$(selpinc%, 2)\r\n    selpinc% = selpinc% + 1\r\nLoop\r\n\r\nfrmPrintSelect!lstPrintList.ListIndex = defpos%\r\nfrmPrintSelect!lstPrintList.Tag = \"\"\r\n\r\nDo While frmPrintSelect!lstPrintList.Tag <> \"Print\"\r\n\r\n    frmPrintSelect.Show\r\n    DoEvents\r\n\r\n    listidx% = frmPrintSelect!lstPrintList.ListIndex\r\n\r\n    Select Case frmPrintSelect!lstPrintList.Tag\r\n        \r\n        Case \"Cancel\"\r\n            ReturnCode$ = \"Cancel\"\r\n            frmPrintSelect!lstPrintList.Tag = \"\"\r\n            Exit Do\r\n        \r\n        Case \"Select\"\r\n            libhnd% = LoadLibrary(SelPrinters$(listidx%, 1) + \".drv\")\r\n            If libhnd% = 0 Then Exit Sub\r\n            bufsize% = dwExtDeviceMode%(frmPrintSelect.hWnd, libhnd%, 0, SelPrinters$(listidx%, 0), SelPrinters$(listidx%, 2), 0, 0, 0)\r\n            If bufsize% = Len(SelPrinters$(listidx%, 3)) Then\r\n                dminstring$ = SelPrinters$(listidx%, 3)\r\n            Else\r\n                dminstring$ = String$(bufsize%, 0)\r\n            End If\r\n            dmoutstring$ = String$(bufsize%, 0)\r\n            dminaddr& = dwGetAddressForVBString&(dminstring$)\r\n            dmoutaddr& = dwGetAddressForVBString&(dmoutstring$)\r\n            di% = dwExtDeviceMode(frmPrintSelect.hWnd, libhnd%, dmoutaddr&, SelPrinters$(listidx%, 0), SelPrinters$(listidx%, 2), dminaddr&, 0, DM_IN_BUFFER Or DM_IN_PROMPT Or DM_OUT_BUFFER)\r\n            FreeLibrary (libhnd%)\r\n            If di% = IDOK Then\r\n                SelPrinters$(listidx%, 3) = dmoutstring$\r\n            End If\r\n            frmPrintSelect!lstPrintList.Tag = \"\"\r\n\r\n        Case \"Preview\"\r\n            libhnd% = LoadLibrary(SelPrinters$(listidx%, 1) + \".drv\")\r\n            If libhnd% <> 0 Then\r\n                bufsize% = dwExtDeviceMode%(frmPrintSelect.hWnd, libhnd%, 0, SelPrinters$(listidx%, 0), SelPrinters$(listidx%, 2), 0, 0, 0)\r\n                If bufsize% <> Len(SelPrinters$(listidx%, 3)) Then\r\n                    dminstring$ = SelPrinters$(listidx%, 3)\r\n                Else\r\n                    dminstring$ = String$(bufsize%, 0)\r\n                End If\r\n                dminaddr& = dwGetAddressForVBString&(dminstring$)\r\n                di% = dwExtDeviceMode%(frmPrintSelect.hWnd, libhnd%, 0, SelPrinters$(listidx%, 0), SelPrinters$(listidx%, 2), dminaddr&, 0, DM_IN_BUFFER)\r\n                ReturnCode$ = \"Preview\"\r\n                DriverName$ = SelPrinters$(listidx%, 1) & \".drv\" & Chr$(0)\r\n                PrinterName$ = SelPrinters$(listidx%, 0) & Chr$(0)\r\n                PortName$ = SelPrinters$(listidx, 2) & Chr$(0)\r\n                Specs$ = dminstring$\r\n                FreeLibrary libhnd%\r\n            End If\r\n            frmPrintSelect!lstPrintList.Tag = \"\"\r\n            Exit Do\r\n\r\n        Case \"Print\"\r\n            libhnd% = LoadLibrary(SelPrinters$(listidx%, 1) + \".drv\")\r\n            If libhnd% <> 0 Then\r\n                bufsize% = dwExtDeviceMode%(frmPrintSelect.hWnd, libhnd%, 0, SelPrinters$(listidx%, 0), SelPrinters$(listidx%, 2), 0, 0, 0)\r\n                If bufsize% <> Len(SelPrinters$(listidx%, 3)) Then\r\n                    dminstring$ = SelPrinters$(listidx%, 3)\r\n                Else\r\n                    dminstring$ = String$(bufsize%, 0)\r\n                End If\r\n                dminaddr& = dwGetAddressForVBString&(dminstring$)\r\n                di% = dwExtDeviceMode%(frmPrintSelect.hWnd, libhnd%, 0, SelPrinters$(listidx%, 0), SelPrinters$(listidx%, 2), dminaddr&, 0, DM_IN_BUFFER)\r\n                ReturnCode$ = \"Print\"\r\n                DriverName$ = SelPrinters$(listidx%, 1) & \".drv\" & Chr$(0)\r\n                PrinterName$ = SelPrinters$(listidx%, 0) & Chr$(0)\r\n                PortName$ = SelPrinters$(listidx, 2) & Chr$(0)\r\n                Specs$ = dminstring$\r\n                FreeLibrary libhnd%\r\n            End If\r\n        End Select\r\n    Loop\r\n    Unload frmPrintSelect\r\n\r\nEnd Sub\r\n\r\n'--------------------------------------------------------------------\r\n'Place the following code in a .frm module\r\n'--------------------------------------------------------------------\r\nVERSION 2.00\r\nBegin Form frmPrintSelect \r\n   Caption         =   \"Select Printer\"\r\n   ClientHeight    =   2055\r\n   ClientLeft      =   3135\r\n   ClientTop       =   2250\r\n   ClientWidth     =   5520\r\n   Height          =   2460\r\n   Left            =   3075\r\n   LinkTopic       =   \"Form1\"\r\n   ScaleHeight     =   2055\r\n   ScaleWidth      =   5520\r\n   Top             =   1905\r\n   Width           =   5640\r\n   Begin CommandButton cmdPrint \r\n      Caption         =   \"&Print\"\r\n      Height          =   375\r\n      Left            =   4140\r\n      TabIndex        =   4\r\n      Top             =   570\r\n      Width           =   1215\r\n   End\r\n   Begin CommandButton cmdPreview \r\n      Caption         =   \"Pre&view\"\r\n      Height          =   375\r\n      Left            =   4140\r\n      TabIndex        =   3\r\n      Top             =   1005\r\n      Width           =   1215\r\n   End\r\n   Begin CommandButton cmdCancel \r\n      Caption         =   \"&Cancel\"\r\n      Height          =   375\r\n      Left            =   4140\r\n      TabIndex        =   2\r\n      Top             =   1440\r\n      Width           =   1215\r\n   End\r\n   Begin CommandButton cmdSetup \r\n      Caption         =   \"&Setup\"\r\n      Height          =   375\r\n      Left            =   4140\r\n      TabIndex        =   1\r\n      Top             =   135\r\n      Width           =   1215\r\n   End\r\n   Begin ListBox lstPrintList \r\n      Height          =   1785\r\n      Left            =   60\r\n      TabIndex        =   0\r\n      Top             =   90\r\n      Width           =   3975\r\n   End\r\nEnd\r\nOption Explicit\r\n\r\nSub cmdCancel_Click ()\r\nlstPrintList.Tag = \"Cancel\"\r\nEnd Sub\r\n\r\nSub cmdPreview_Click ()\r\nlstPrintList.Tag = \"Preview\"\r\nEnd Sub\r\n\r\nSub cmdPrint_Click ()\r\nlstPrintList.Tag = \"Print\"\r\nEnd Sub\r\n\r\nSub cmdSetup_Click ()\r\nlstPrintList.Tag = \"Select\"\r\nEnd Sub\r\n\r\n'--------------------------------------------------------------------\r\n'Use the following code to call the Crystal Print Engine\r\n' This code calls the printer select dialog and also gets\r\n' the printer data structure (similar to DEVMODE) for Crystal Reports\r\n'----------------------------------------\r\nDim ReturnCode$, DriverName$, PrinterName$, PortName$, Specs$, result%, jobnum%, ReportLoc$, ReportName$\r\n\r\nGetPrinter ReturnCode$, DriverName$, PrinterName$, PortName$, Specs$\r\n\r\n    If ReturnCode$ <> \"Cancel\" Then\r\n    \r\n        result% = PEOpenEngine()\r\n        jobnum% = PEOpenPrintJob(ReportLoc$ & ReportName$ & \".RPT\")\r\n        \r\n        If ReturnCode$ = \"Preview\" Then\r\n            result% = PEOutputtoWindow(jobnum%, \"Crystal Report Preview\", CW_USEDEFAULT, CW_USEDEFAULT, CW_USEDEFAULT, CW_USEDEFAULT, 0, 0)\r\n        ElseIf ReturnCode$ = \"Print\" Then\r\n            result% = PEOutputtoPrinter(jobnum%, 1)\r\n            result% = PESelectPrinter(jobnum%, DriverName$, PrinterName$, PortName$, dwGetAddressForVBString&(Specs$))\r\n        End If\r\n    \r\n        result% = PEStartPrintJob(jobnum%, True)\r\n        If ReturnCode$ = \"Preview\" Then\r\n            result% = 1\r\n            Do While result% <> 0\r\n                result% = PEGetWindowHandle(jobnum%)\r\n                DoEvents\r\n            Loop\r\n        End If\r\n    \r\n        PEClosePrintJob jobnum%\r\n        PECloseEngine\r\n    \r\n    End If\r\n","Declares":"'Windows API declarations\r\nDeclare Function GetProfileString% Lib \"Kernel\" (ByVal lpAppName$, ByVal lpKeyName As Any, ByVal lpDefault$, ByVal lpReturnedString$, ByVal nSize%)\r\nDeclare Function LoadLibrary% Lib \"Kernel\" (ByVal lpLibFileName$)\r\nDeclare Sub FreeLibrary Lib \"Kernel\" (ByVal hLibModule%)\r\n\r\n'Spyworks declarations\r\nDeclare Function dwExtDeviceMode% Lib \"dwspydll.dll\" (ByVal hWnd%, ByVal hDriver%, ByVal lpdmOutput&, ByVal lpszDevice$, ByVal lpszPort$, ByVal lpdmInput&, ByVal lpszProfile&, ByVal fwMode%)\r\nDeclare Function dwGetAddressForVBString& Lib \"dwspydll.dll\" (vbstring$)\r\nDeclare Function dwGetStringFromLPSTR$ Lib \"dwspydll.dll\" (ByVal lpstring$)\r\n\r\nGlobal Const DM_IN_BUFFER = 8\r\nGlobal Const DM_OUT_BUFFER = 2\r\nGlobal Const DM_IN_PROMPT = 4\r\nGlobal Const IDOK = 1\r\n\r\nGlobal Const WS_MINIMIZE = &H20000000\r\nGlobal Const WS_VISIBLE = &H10000000\r\nGlobal Const WS_DISABLED = &H8000000\r\nGlobal Const WS_CLIPSIBLINGS = &H4000000\r\nGlobal Const WS_CLIPCHILDREN = &H2000000\r\nGlobal Const WS_MAXIMIZE = &H1000000\r\nGlobal Const WS_CAPTION = &HC00000\r\nGlobal Const WS_BORDER = &H800000\r\nGlobal Const WS_DLGFRAME = &H400000\r\nGlobal Const WS_VSCROLL = &H200000\r\nGlobal Const WS_HSCROLL = &H100000\r\nGlobal Const WS_SYSMENU = &H80000\r\nGlobal Const WS_THICKFRAME = &H40000\r\nGlobal Const WS_MINIMIZEBOX = &H20000\r\nGlobal Const WS_MAXIMIZEBOX = &H10000\r\nGlobal Const CW_USEDEFAULT = &H8000\r\n\r\n\r\nDeclare Function PEPrintReport Lib \"CRPE.DLL\" (ByVal RptName$, ByVal Printer%, ByVal Window%, ByVal Title$, ByVal Lft%, ByVal Top%, ByVal Wdth%, ByVal Height%, ByVal Style As Long, ByVal PWindow%) As Integer\r\nDeclare Function PEOpenEngine Lib \"CRPE.DLL\" () As Integer\r\nDeclare Sub PECloseEngine Lib \"CRPE.DLL\" ()\r\nDeclare Function PECanCloseEngine Lib \"CRPE.DLL\" () As Integer\r\nDeclare Function PEGetVersion Lib \"CRPE.DLL\" (ByVal version%) As Integer\r\nDeclare Function PEOpenPrintJob Lib \"CRPE.DLL\" (ByVal RptName$) As Integer\r\nDeclare Sub PEClosePrintJob Lib \"CRPE.DLL\" (ByVal PrintJob%)\r\nDeclare Function PEStartPrintJob Lib \"CRPE.DLL\" (ByVal PrintJob%, ByVal WaitOrNot%) As Integer\r\nDeclare Sub PECancelPrintJob Lib \"CRPE.DLL\" (ByVal PrintJob%)\r\nDeclare Function PEIsPrintJobFinished Lib \"CRPE.DLL\" (ByVal PrintJob%) As Integer\r\nDeclare Function PEGetJobStatus Lib \"CRPE.DLL\" (ByVal PrintJob%, JobInfo As PEJobInfo) As Integer\r\nDeclare Function PEGetErrorCode Lib \"CRPE.DLL\" (ByVal PrintJob%) As Integer\r\nDeclare Function PEGetErrorText Lib \"CRPE.DLL\" (ByVal PrintJob%, TextHandle%, TextLength%) As Integer\r\nDeclare Function PEGetHandleString Lib \"CRPE.DLL\" (ByVal TextHandle%, ByVal Buffer$, ByVal BufferLength%) As Integer\r\nDeclare Function PEGetPrintDate Lib \"CRPE.DLL\" (ByVal PrintJob%, Date_Year%, Date_Month%, Date_Day%) As Integer\r\nDeclare Function PESetPrintDate Lib \"CRPE.DLL\" (ByVal PrintJob%, ByVal Date_Year%, ByVal Date_Month%, ByVal Date_Day%) As Integer\r\nDeclare Function PESetGroupCondition Lib \"CRPE.DLL\" (ByVal PrintJob%, ByVal SectionCode%, ByVal ConditionField$, ByVal Condition%, ByVal SortDirection%) As Integer\r\nDeclare Function PEGetNGroups Lib \"CRPE.DLL\" (ByVal PrintJob%) As Integer\r\nDeclare Function PEGetGroupCondition Lib \"CRPE.DLL\" (ByVal PrintJob%, ByVal SectionCode%, ConditionFieldHandle%, ConditionFieldLength%, Condition%, SortDirection%) As Integer\r\nDeclare Function PEGetNFormulas Lib \"CRPE.DLL\" (ByVal PrintJob%) As Integer\r\nDeclare Function PEGetNthFormula Lib \"CRPE.DLL\" (ByVal PrintJob%, ByVal FormulaN%, NameHandle%, NameLength%, TextHandle%, TextLength%) As Integer\r\nDeclare Function PEGetFormula Lib \"CRPE.DLL\" (ByVal PrintJob%, ByVal FormulaName$, TextHandle%, TextLength%) As Integer\r\nDeclare Function PESetFormula Lib \"CRPE.DLL\" (ByVal PrintJob%, ByVal FormulaName$, ByVal FormulaString$) As Integer\r\nDeclare Function PECheckFormula Lib \"CRPE.DLL\" (ByVal PrintJob%, ByVal FormulaName$) As Integer\r\nDeclare Function PEGetSelectionFormula Lib \"CRPE.DLL\" (ByVal PrintJob%, TextHandle%, TextLength%) As Integer\r\nDeclare Function PESetSelectionFormula Lib \"CRPE.DLL\" (ByVal PrintJob%, ByVal FormulaString$) As Integer\r\nDeclare Function PECheckSelectionFormula Lib \"CRPE.DLL\" (ByVal PrintJob%) As Integer\r\nDeclare Function PEGetGroupSelectionFormula Lib \"CRPE.DLL\" (ByVal PrintJob%, TextHandle%, TextLength%) As Integer\r\nDeclare Function PESetGroupSelectionFormula Lib \"CRPE.DLL\" (ByVal PrintJob%, ByVal FormulaString$) As Integer\r\nDeclare Function PECheckGroupSelectionFormula Lib \"CRPE.DLL\" (ByVal PrintJob%) As Integer\r\nDeclare Function PEGetNSortFields Lib \"CRPE.DLL\" (ByVal PrintJob%) As Integer\r\nDeclare Function PEGetNthSortField Lib \"CRPE.DLL\" (ByVal PrintJob%, ByVal SortNumber%, NameHandle%, NameLength%, Direction%) As Integer\r\nDeclare Function PESetNthSortField Lib \"CRPE.DLL\" (ByVal PrintJob%, ByVal SortNumber%, ByVal SortFieldName$, ByVal Direction%) As Integer\r\nDeclare Function PEDeleteNthSortField Lib \"CRPE.DLL\" (ByVal PrintJob%, ByVal SortFieldN%) As Integer\r\nDeclare Function PEGetNGroupSortFields Lib \"CRPE.DLL\" (ByVal PrintJob%) As Integer\r\nDeclare Function PEGetNthGroupSortField Lib \"CRPE.DLL\" (ByVal PrintJob%, ByVal SortFieldN%, NameHandle%, NameLength%, Direction%) As Integer\r\nDeclare Function PESetNthGroupSortField Lib \"CRPE.DLL\" (ByVal PrintJob%, ByVal SortFieldN%, ByVal SortGroupName$, ByVal Direction%) As Integer\r\nDeclare Function PEDeleteNthGroupSortField Lib \"CRPE.DLL\" (ByVal PrintJob%, ByVal SortFieldN%) As Integer\r\nDeclare Function PEGetNTables Lib \"CRPE.DLL\" (ByVal PrintJob%) As Integer\r\nDeclare Function PEGetNthTableType Lib \"CRPE.DLL\" (ByVal PrintJob%, ByVal TableN%, TableType As PETableType) As Integer\r\nDeclare Function PEGetNthTableSessionInfo Lib \"CRPE.DLL\" (ByVal PrintJob%, ByVal TableN%, SessionInfo As PESessionInfo) As Integer\r\nDeclare Function PESetNthTableSessionInfo Lib \"CRPE.DLL\" (ByVal PrintJob%, ByVal TableN%, SessionInfo As PESessionInfo, ByVal PropagateAcrossTables%) As Integer\r\nDeclare Function PEGetNthTableLogOnInfo Lib \"CRPE.DLL\" (ByVal PrintJob%, ByVal TableN%, LogOnInfo As PELogOnInfo) As Integer\r\nDeclare Function PESetNthTableLogOnInfo Lib \"CRPE.DLL\" (ByVal PrintJob%, ByVal TableN%, LogOnInfo As PELogOnInfo, ByVal Propagate%) As Integer\r\nDeclare Function PEGetNthTableLocation Lib \"CRPE.DLL\" (ByVal PrintJob%, ByVal TableN%, Location As PETableLocation) As Integer\r\nDeclare Function PESetNthTableLocation Lib \"CRPE.DLL\" (ByVal PrintJob%, ByVal TableN%, Location As PETableLocation) As Integer\r\nDeclare Function PEGetNParams Lib \"CRPE.DLL\" (ByVal PrintJob%) As Integer\r\nDeclare Function PEGetNthParam Lib \"CRPE.DLL\" (ByVal PrintJob%, ByVal ParamN%, TextHandle%, TextLength%) As Integer\r\nDeclare Function PESetNthParam Lib \"CRPE.DLL\" (ByVal PrintJob%, ByVal ParamN%, ByVal ParamValue$) As Integer\r\nDeclare Function PETestNthTableConnectivity Lib \"CRPE.DLL\" (ByVal PrintJob%, ByVal TableN%) As Integer\r\nDeclare Function PELogOnServer Lib \"CRPE.DLL\" (ByVal DLLName$, LogOnInfo As PELogOnInfo) As Integer\r\nDeclare Function PELogOffServer Lib \"CRPE.DLL\" (ByVal DLLName$, LogOnInfo As PELogOnInfo) As Integer\r\nDeclare Function PELogOnSQLServerWithPrivateInfo Lib \"CRPE.DLL\" (ByVal DLLName$, PrivateInfo As Any) As Integer\r\nDeclare Function PEGetSQLQuery Lib \"CRPE.DLL\" (ByVal PrintJob%, TextHandle%, TextLength%) As Integer\r\nDeclare Function PESetSQLQuery Lib \"CRPE.DLL\" (ByVal PrintJob%, ByVal QueryString$) As Integer\r\nDeclare Function PEHasSavedData Lib \"CRPE.DLL\" (ByVal PrintJob%, HasSavedData%) As Integer\r\nDeclare Function PEDiscardSavedData Lib \"CRPE.DLL\" (ByVal PrintJob%) As Integer\r\nDeclare Function PEGetReportTitle Lib \"CRPE.DLL\" (ByVal PrintJob%, TitleHandle%, TitleLength%) As Integer\r\nDeclare Function PESetReportTitle Lib \"CRPE.DLL\" (ByVal PrintJob%, ByVal Title$) As Integer\r\nDeclare Function PEOutputtoWindow Lib \"CRPE.DLL\" (ByVal PrintJob%, ByVal Title$, ByVal Lft%, ByVal Top%, ByVal Wdth%, ByVal Height%, ByVal Style As Long, ByVal PWindow%) As Integer\r\nDeclare Function PEGetWindowHandle Lib \"CRPE.DLL\" (ByVal PrintJob%) As Integer\r\nDeclare Sub PECloseWindow Lib \"CRPE.DLL\" (ByVal PrintJob%)\r\nDeclare Function PEShowNextPage Lib \"CRPE.DLL\" (ByVal PrintJob%) As Integer\r\nDeclare Function PEShowFirstPage Lib \"CRPE.DLL\" (ByVal PrintJob%) As Integer\r\nDeclare Function PEShowPreviousPage Lib \"CRPE.DLL\" (ByVal PrintJob%) As Integer\r\nDeclare Function PEShowLastPage Lib \"CRPE.DLL\" (ByVal PrintJob%) As Integer\r\nDeclare Function PEZoomPreviewWindow Lib \"CRPE.DLL\" (ByVal PrintJob%, ByVal ZoomLevel%) As Integer\r\nDeclare Function PEShowPrintControls Lib \"CRPE.DLL\" (ByVal PrintJob%, ByVal ShowPrintControls%) As Integer\r\nDeclare Function PEPrintControlsShowing Lib \"CRPE.DLL\" (ByVal PrintJob%, ControlsShowing%) As Integer\r\nDeclare Function PEPrintWindow Lib \"CRPE.DLL\" (ByVal PrintJob%, ByVal WaitNoWait%) As Integer\r\nDeclare Function PEExportPrintWindow Lib \"CRPE.DLL\" (ByVal PrintJob%, ByVal ToMail%, ByVal WaitUntilDone%) As Integer\r\nDeclare Function PENextPrintWindowMagnification Lib \"CRPE.DLL\" (ByVal PrintJob%) As Integer\r\nDeclare Function PESelectPrinter Lib \"CRPE.DLL\" (ByVal PrintJob%, ByVal PrinterDriver$, ByVal PrinterName$, ByVal PortName$, ByVal DevMode As Long) As Integer\r\nDeclare Function PEGetSelectedPrinter Lib \"CRPE.DLL\" (ByVal PrintJob%, DriverHandle%, DriverLength%, PrinterHandle%, PrinterLength%, PortHandle%, PortLength%, DevMode As Long) As Integer\r\nDeclare Function PEOutputtoPrinter Lib \"CRPE.DLL\" (ByVal PrintJob%, ByVal NCopies%) As Integer\r\nDeclare Function PESetNDetailCopies Lib \"CRPE.DLL\" (ByVal PrintJob%, ByVal nDetailCopies%) As Integer\r\nDeclare Function PEGetNDetailCopies Lib \"CRPE.DLL\" (ByVal PrintJob%, nDetailCopies%) As Integer\r\nDeclare Function PESetPrintOptions Lib \"CRPE.DLL\" (ByVal PrintJob%, Options As PEPrintOptions) As Integer\r\nDeclare Function PEGetPrintOptions Lib \"CRPE.DLL\" (ByVal PrintJob%, Options As PEPrintOptions) As Integer\r\nDeclare Function PEOutputToFile Lib \"CRPE.DLL\" (ByVal PrintJob%, ByVal OutputFilePath$, ByVal FileType%, Options As Any) As Integer\r\nDeclare Function PEGetExportOptions Lib \"CRPE.DLL\" (ByVal PrintJob%, ExportOptions As PEExportOptions) As Integer\r\nDeclare Function PEExportTo Lib \"CRPE.DLL\" (ByVal PrintJob%, ExportOptions As PEExportOptions) As Integer\r\nDeclare Function PESetMargins Lib \"CRPE.DLL\" (ByVal PrintJob%, ByVal LeftMargin%, ByVal RightMargin%, ByVal TopMargin%, ByVal BottomMargin%) As Integer\r\nDeclare Function PEGetMargins Lib \"CRPE.DLL\" (ByVal PrintJob%, LeftMargin%, RightMargin%, TopMargin%, BottomMargin%) As Integer\r\nDeclare Function PESetMinimumSectionHeight Lib \"CRPE.DLL\" (ByVal PrintJob%, ByVal SectionCode%, ByVal MinimumHeight%) As Integer\r\nDeclare Function PEGetMinimumSectionHeight Lib \"CRPE.DLL\" (ByVal PrintJob%, ByVal SectionCode%, MinimumHeight%) As Integer\r\nDeclare Function PESetSectionFormat Lib \"CRPE.DLL\" (ByVal PrintJob%, ByVal SectionCode%, Options As PESectionOptions) As Integer\r\nDeclare Function PEGetSectionFormat Lib \"CRPE.DLL\" (ByVal PrintJob%, ByVal SectionCode%, Options As PESectionOptions) As Integer\r\nDeclare Function PESetLineHeight Lib \"CRPE.DLL\" (ByVal PrintJob%, ByVal SectionCode%, ByVal LineN%, ByVal Height%, ByVal Ascent%) As Integer\r\nDeclare Function PEGetLineHeight Lib \"CRPE.DLL\" (ByVal PrintJob%, ByVal SectionCode%, ByVal LineN%, Height%, Ascent%) As Integer\r\nDeclare Function PEGetNLinesInSection Lib \"CRPE.DLL\" (ByVal PrintJob%, ByVal SectionCode%) As Integer\r\nDeclare Function PESetFont Lib \"CRPE.DLL\" (ByVal PrintJob%, ByVal SectionCode%, ByVal ScopeCode%, ByVal FaceName$, ByVal FontFamily%, ByVal FontPitch%, ByVal CharSet%, ByVal PointSize%, ByVal isItalic%, ByVal isUnderlined%, ByVal isStruckOut%, ByVal Weight%) As Integer\r\nDeclare Function PEGetGraphType Lib \"CRPE.DLL\" (ByVal PrintJob%, ByVal SectionCode%, ByVal GraphN%, GraphType%) As Integer\r\nDeclare Function PEGetGraphData Lib \"CRPE.DLL\" (ByVal PrintJob%, ByVal SectionCode%, ByVal GraphN%, GraphDataInfo As PEGraphDataInfo) As Integer\r\nDeclare Function PEGetGraphText Lib \"CRPE.DLL\" (ByVal PrintJob%, ByVal SectionCode%, ByVal GraphN%, GraphTextInfo As PEGraphTextInfo) As Integer\r\nDeclare Function PEGetGraphOptions Lib \"CRPE.DLL\" (ByVal PrintJob%, ByVal SectionCode%, ByVal GraphN%, GraphOptions As PEGraphOptions) As Integer\r\nDeclare Function PESetGraphType Lib \"CRPE.DLL\" (ByVal PrintJob%, ByVal SectionCode%, ByVal GraphN%, GraphType%) As Integer\r\nDeclare Function PESetGraphData Lib \"CRPE.DLL\" (ByVal PrintJob%, ByVal SectionCode%, ByVal GraphN%, GraphDataInfo As PEGraphDataInfo) As Integer\r\nDeclare Function PESetGraphText Lib \"CRPE.DLL\" (ByVal PrintJob%, ByVal SectionCode%, ByVal GraphN%, GraphTextInfo As PEGraphTextInfo) As Integer\r\nDeclare Function PESetGraphOptions Lib \"CRPE.DLL\" (ByVal PrintJob%, ByVal SectionCode%, ByVal GraphN%, GraphOptions As PEGraphOptions) As Integer\r\n\r\nGlobal Const PE_SF_MAX_NAME_LENGTH = 50\r\nGlobal Const PE_SF_DESCENDING = 0\r\nGlobal Const PE_SF_ASCENDING = 1\r\nGlobal Const PE_ERR_NOERROR = 0\r\nGlobal Const PE_ERR_NOTENOUGHMEMORY = 500\r\nGlobal Const PE_ERR_INVALIDJOBNO = 501\r\nGlobal Const PE_ERR_INVALIDHANDLE = 502\r\nGlobal Const PE_ERR_STRINGTOOLONG = 503\r\nGlobal Const PE_ERR_NOSUCHREPORT = 504\r\nGlobal Const PE_ERR_NODESTINATION = 505\r\nGlobal Const PE_ERR_BADFILENUMBER = 506\r\nGlobal Const PE_ERR_BADFILENAME = 507\r\nGlobal Const PE_ERR_BADFIELDNUMBER = 508\r\nGlobal Const PE_ERR_BADFIELDNAME = 509\r\nGlobal Const PE_ERR_BADFORMULANAME = 510\r\nGlobal Const PE_ERR_BADSORTDIRECTION = 511\r\nGlobal Const PE_ERR_ENGINENOTOPEN = 512\r\nGlobal Const PE_ERR_INVALIDPRINTER = 513\r\nGlobal Const PE_ERR_PRINTFILEEXISTS = 514\r\nGlobal Const PE_ERR_BADFORMULATEXT = 515\r\nGlobal Const PE_ERR_BADGROUPSECTION = 516\r\nGlobal Const PE_ERR_ENGINEBUSY = 517\r\nGlobal Const PE_ERR_BADSECTION = 518\r\nGlobal Const PE_ERR_NOPRINTWINDOW = 519\r\nGlobal Const PE_ERR_JOBALREADYSTARTED = 520\r\nGlobal Const PE_ERR_BADSUMMARYFIELD = 521\r\nGlobal Const PE_ERR_NOTENOUGHSYSRES = 522\r\nGlobal Const PE_ERR_BADGROUPCONDITION = 523\r\nGlobal Const PE_ERR_JOBBUSY = 524\r\nGlobal Const PE_ERR_BADREPORTFILE = 525\r\nGlobal Const PE_ERR_NODEFAULTPRINTER = 526\r\nGlobal Const PE_ERR_SQLSERVERERROR = 527\r\nGlobal Const PE_ERR_BADLINENUMBER = 528\r\nGlobal Const PE_ERR_DISKFULL = 529\r\nGlobal Const PE_ERR_FILEERROR = 530\r\nGlobal Const PE_ERR_INCORRECTPASSWORD = 531\r\nGlobal Const PE_ERR_BADDATABASEDLL = 532\r\nGlobal Const PE_ERR_BADDATABASEFILE = 533\r\nGlobal Const PE_ERR_ERRORINDATABASEDLL = 534\r\nGlobal Const PE_ERR_DATABASESESSION = 535\r\nGlobal Const PE_ERR_DATABASELOGON = 536\r\nGlobal Const PE_ERR_DATABASELOCATION = 537\r\nGlobal Const PE_ERR_BADSTRUCTSIZE = 538\r\nGlobal Const PE_ERR_BADDATE = 539\r\nGlobal Const PE_ERR_BADEXPORTDLL = 540\r\nGlobal Const PE_ERR_ERRORINEXPORTDLL = 541\r\nGlobal Const PE_ERR_PREVATFIRSTPAGE = 542\r\nGlobal Const PE_ERR_NEXTATLASTPAGE = 543\r\nGlobal Const PE_ERR_CANNOTACCESSREPORT = 544\r\nGlobal Const PE_ERR_USERCANCELLED = 545\r\nGlobal Const PE_ERR_OLE2NOTLOADED = 546\r\nGlobal Const PE_ERR_BADCROSSTABGROUP = 547\r\nGlobal Const PE_ERR_NOCTSUMMARIZEDFIELD = 548\r\nGlobal Const PE_ERR_DESTINATIONNOTEXPORT = 549\r\nGlobal Const PE_ERR_INVALIDPAGENUMBER = 550\r\nGlobal Const PE_ERR_BADLABELNUMBER = 551\r\nGlobal Const PE_ERR_NOTSTOREDPROCEDURE = 552\r\nGlobal Const PE_ERR_INVALIDPARAMETER = 553\r\nGlobal Const PE_ERR_GRAPHNOTFOUND = 554\r\nGlobal Const PE_ERR_INVALIDGRAPHTYPE = 555\r\nGlobal Const PE_ERR_INVALIDGRAPHDATA = 556\r\nGlobal Const PE_ERR_CANNOTMOVEGRAPH = 557\r\nGlobal Const PE_ERR_INVALIDGRAPHTEXT = 558\r\nGlobal Const PE_ERR_INVALIDGRAPHOPT = 559\r\nGlobal Const PE_ERR_NOTIMPLEMENTED = 999\r\nGlobal Const PE_GV_DLL = 100      ' values for version parameter of PEGetVersion\r\nGlobal Const PE_GV_ENGINE = 200\r\nGlobal Const PE_JOBNOTSTARTED = 1\r\nGlobal Const PE_JOBINPROGRESS = 2\r\nGlobal Const PE_JOBCOMPLETED = 3\r\nGlobal Const PE_JOBFAILED = 4\r\nGlobal Const PE_JOBCANCELLED = 5\r\nGlobal Const PE_GC_ANYCHANGE = 0\r\nGlobal Const PE_GC_DAILY = 0\r\nGlobal Const PE_GC_WEEKLY = 1\r\nGlobal Const PE_GC_BIWEEKLY = 2\r\nGlobal Const PE_GC_SEMIMONTHLY = 3\r\nGlobal Const PE_GC_MONTHLY = 4\r\nGlobal Const PE_GC_QUARTERLY = 5\r\nGlobal Const PE_GC_SEMIANNUALLY = 6\r\nGlobal Const PE_GC_ANNUALLY = 7\r\nGlobal Const PE_GC_TOYES = 1\r\nGlobal Const PE_GC_TONO = 2\r\nGlobal Const PE_GC_EVERYYES = 3\r\nGlobal Const PE_GC_EVERYNO = 4\r\nGlobal Const PE_GC_NEXTISYES = 5\r\nGlobal Const PE_GC_NEXTISNO = 6\r\nGlobal Const PE_GC_CONDITIONMASK = &HFF\r\nGlobal Const PE_GC_TYPEMASK = &HF00\r\nGlobal Const PE_GC_TYPEOTHER = &H0\r\nGlobal Const PE_GC_TYPEDATE = &H200\r\nGlobal Const PE_GC_TYPEBOOLEAN = &H400\r\nGlobal Const PE_SF_MAXNAMELEN = 50  ' maximum length of a sort field name\r\nGlobal Const PE_SF_DESC = 0         ' values for the Direction parameter\r\nGlobal Const PE_SF_ASC = 1\r\nGlobal Const PE_DLL_NAME_LEN = 64\r\nGlobal Const PE_FULL_NAME_LEN = 256\r\nGlobal Const PE_SIZEOF_TABLE_TYPE = 324 ' # bytes in PETableType\r\nGlobal Const PE_DT_STANDARD = 1  ' values for DBType\r\nGlobal Const PE_DT_SQL = 2\r\nGlobal Const PE_SESS_USERID_LEN = 128\r\nGlobal Const PE_SESS_PASSWORD_LEN = 128\r\nGlobal Const PE_SIZEOF_SESSION_INFO = 262  ' # bytes in PESessionInfo\r\nGlobal Const PE_SERVERNAME_LEN = 128\r\nGlobal Const PE_DATABASENAME_LEN = 128\r\nGlobal Const PE_USERID_LEN = 128\r\nGlobal Const PE_PASSWORD_LEN = 128\r\nGlobal Const PE_SIZEOF_LOGON_INFO = 514  ' # bytes in PELogOnInfo\r\nGlobal Const PE_TABLE_LOCATION_LEN = 256\r\nGlobal Const PE_SIZEOF_TABLE_LOCATION = 258  ' # bytes in PETableLocation\r\nGlobal Const PE_ZOOM_FULL_SIZE = 0\r\nGlobal Const PE_ZOOM_SIZE_FIT_ONE_SIDE = 1\r\nGlobal Const PE_ZOOM_SIZE_FIT_BOTH_SIDES = 2\r\nGlobal Const PE_MAXPAGEN = 65535\r\nGlobal Const PE_UNCOLLATED = 0\r\nGlobal Const PE_COLLATED = 1\r\nGlobal Const PE_DEFAULTCOLLATION = 2\r\nGlobal Const PE_FT_RECORD = 0\r\nGlobal Const PE_FT_TABSEPARATED = 1\r\nGlobal Const PE_FT_TEXT = 2\r\nGlobal Const PE_FT_DIF = 3\r\nGlobal Const PE_FT_CSV = 4\r\nGlobal Const PE_FT_CHARSEPARATED = 5\r\nGlobal Const PE_FT_TABFORMATTED = 6\r\nGlobal Const PE_FIELDDELIMLEN = 17\r\nGlobal Const PE_SM_DEFAULT = &H8000\r\nGlobal Const PE_ALLSECTIONS = 0\r\nGlobal Const PE_TITLESECTION = 1000\r\nGlobal Const PE_HEADERSECTION = 2000\r\nGlobal Const PE_GROUPHEADER = 3000       ' outer group header is 3000, next is 3001, etc.\r\nGlobal Const PE_DETAILSECTION = 4000\r\nGlobal Const PE_GROUPFOOTER = 5000       ' outer group footer is 5000, next is 5001, etc.\r\nGlobal Const PE_GRANDTOTALSECTION = 6000\r\nGlobal Const PE_FOOTERSECTION = 7000\r\nGlobal Const PE_SUMMARYSECTION = 8000\r\nGlobal Const PE_ALLLINES = -1\r\nGlobal Const PE_FIELDS = 1\r\nGlobal Const PE_TEXT = 2\r\nGlobal Const PE_UNCHANGED = -1\r\nGlobal Const PE_SIDE_BY_SIDE_BAR_GRAPH = 0\r\nGlobal Const PE_STACKED_BAR_GRAPH = 2\r\nGlobal Const PE_PERCENT_BAR_GRAPH = 3\r\nGlobal Const PE_FAKED_3D_SIDE_BY_SIDE_BAR_GRAPH = 4\r\nGlobal Const PE_FAKED_3D_STACKED_BAR_GRAPH = 5\r\nGlobal Const PE_FAKED_3D_PERCENT_BAR_GRAPH = 6\r\nGlobal Const PE_PIE_GRAPH = 40\r\nGlobal Const PE_MULTIPLE_PIE_GRAPH = 42\r\nGlobal Const PE_PROPORTIONAL_MULTI_PIE_GRAPH = 43\r\nGlobal Const PE_LINE_GRAPH = 80\r\nGlobal Const PE_AREA_GRAPH = 120\r\nGlobal Const PE_THREED_BAR_GRAPH = 160\r\nGlobal Const PE_USER_DEFINED_GRAPH = 500\r\nGlobal Const PE_UNKNOWN_TYPE_GRAPH = 1000\r\nGlobal Const PE_GRAPH_ROWS_ONLY = 0\r\nGlobal Const PE_GRAPH_COLS_ONLY = 1\r\nGlobal Const PE_GRAPH_MIXED_ROW_COL = 2\r\nGlobal Const PE_GRAPH_MIXED_COL_ROW = 3\r\nGlobal Const PE_GRAPH_UNKNOWN_DIRECTION = 20\r\nGlobal Const PE_GRAPH_DATA_NULL_SELECTION = -1\r\nGlobal Const PE_GRAPH_TEXT_LEN = 128\r\n\r\nType PEJobInfo\r\n    StructSize As Integer  ' initialize to # of bytes in PEJobInfo\r\n\r\n    NumRecordsRead As Long\r\n    NumRecordsSelected As Long\r\n    NumRecordsPrinted As Long\r\n\r\n    DisplayPageN As Integer\r\n    LatestPageN As Integer\r\n    StartPageN As Integer\r\n\r\n    PrintEnded As Integer\r\nEnd Type\r\n\r\nType PETableType\r\n    StructSize As Integer   ' initialize to # bytes in PETableType\r\n    DLLName As String * PE_DLL_NAME_LEN\r\n    DescriptiveName  As String * PE_FULL_NAME_LEN\r\n    DBType As Integer\r\nEnd Type\r\n\r\nType PESessionInfo\r\n    StructSize As Integer\r\n    UserID As String * PE_SESS_USERID_LEN\r\n    Password As String * PE_SESS_PASSWORD_LEN\r\n    SessionHandle As Long\r\nEnd Type\r\n\r\nType PELogOnInfo\r\n    StructSize As Integer\r\n    ServerName As String * PE_SERVERNAME_LEN\r\n    DatabaseName  As String * PE_DATABASENAME_LEN\r\n    UserID As String * PE_USERID_LEN\r\n    Password  As String * PE_PASSWORD_LEN\r\nEnd Type\r\n\r\nType PETableLocation\r\n    StructSize As Integer\r\n    Location  As String * PE_TABLE_LOCATION_LEN\r\nEnd Type\r\n\r\nType PEPrintOptions\r\n    StructSize As Integer   ' initialize to # bytes in PEPrintOptions\r\n    StartPageN As Integer\r\n    stopPageN As Integer\r\n    nReportCopies As Integer\r\n    collation As Integer\r\nEnd Type\r\n\r\nType PEPrintFileOptions\r\n    StructSize As Integer   ' initialize to # of bytes in PEPrintFileOptions\r\n    UseReportNumberFmt As Integer\r\n    UseReportDateFormat As Integer\r\nEnd Type\r\n\r\nType PECharSepFileOptions\r\n    StructSize As Integer   ' initialize to # of bytes in PECharSepFileOptions\r\n    UseReportNumberFmt As Integer\r\n    UseReportDateFormat As Integer\r\n    StringDelimiter As String * 1\r\n    FieldDelimiter As String * PE_FIELDDELIMLEN\r\nEnd Type\r\n\r\nType PEExportOptions\r\n    StructSize As Integer   'initialize to # bytes in PEExportOptions\r\n    FormatDLLName As String * PE_DLL_NAME_LEN\r\n    FormatType As Long\r\n    FormatOptions As Long\r\n    DestinationDLLName As String * PE_DLL_NAME_LEN\r\n    DestinationType As Long\r\n    DestinationOptions As Long\r\n    NFormatOptionsBytes As Integer\r\n    NDestinationOptionsBytes As Integer\r\nEnd Type\r\n\r\nType PESectionOptions\r\n    StructSize As Integer   ' initialize to # bytes in PESectionOptions\r\n    Visible As Integer\r\n    NewPageBefore As Integer\r\n    NewPageAfter As Integer\r\n    KeepTogether As Integer\r\n    SuppressBlankLines As Integer\r\n    ResetPageNAfter As Integer\r\n    PrintAtBottomOfPage As Integer\r\nEnd Type\r\n\r\nType PEGraphDataInfo\r\n    StructSize        As Integer  ' initialize to # bytes in PEGraphDataInfo\r\n    RowGroupN         As Integer  ' group number in report.\r\n    ColGroupN         As Integer  ' group number in report.\r\n    SummarizedFieldN  As Integer  ' summarized field number for the group\r\n                                  ' where the graph stays.\r\n    GraphDirection    As Integer  ' For normal group/total report, the direction,\r\n                                  ' is always GRAPH_MIXED_ROW_COL.  For CrossTab\r\n                                  ' report all four options will change the\r\n                                  ' graph data.\r\nEnd Type\r\n\r\nType PEGraphTextInfo\r\n    StructSize        As Integer  ' initialize to # bytes in PEGraphTextInfo\r\n    GraphTitle        As String * PE_GRAPH_TEXT_LEN\r\n    GraphSubTitle     As String * PE_GRAPH_TEXT_LEN\r\n    GraphFootNote     As String * PE_GRAPH_TEXT_LEN\r\n    GraphGroupsTitle  As String * PE_GRAPH_TEXT_LEN\r\n    GraphSeriesTitle  As String * PE_GRAPH_TEXT_LEN\r\n    GraphXAxisTitle   As String * PE_GRAPH_TEXT_LEN\r\n    GraphYAxisTitle   As String * PE_GRAPH_TEXT_LEN\r\n    GraphZAxisTitle   As String * PE_GRAPH_TEXT_LEN\r\nEnd Type\r\n\r\nType PEGraphOptions\r\n    StructSize     As Integer  ' initialize to # bytes in PEGraphOptions\r\n    GraphMaxValue  As Double\r\n    GraphMinValue  As Double\r\n    ShowDataValue  As Integer  ' Show data values on risers.\r\n    ShowGridLine   As Integer\r\n    VerticalBars   As Integer\r\n    ShowLegend     As Integer\r\n    FontFaceName   As String * PE_GRAPH_TEXT_LEN\r\nEnd Type","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Crystal Reports"]},{"RecordId":"407","Title":"Monitor a Directory for Changes","Description":"Monitors a path and triggers an event when a change occurs.","Code":"Sub Main()\r\n\r\nDim hNotify As Long\r\nDim lStatus As Long\r\nDim strPath As String\r\n\r\n\r\n'Monitor a path for name changes\r\nstrPath = \"c:\\ted\"\r\nhNotify = FindFirstChangeNotification(strPath, False, FILE_NOTIFY_CHANGE_FILE_NAME)\r\nDo\r\n    'Re-check each 1000 milliseconds\r\n    lStatus = WaitForSingleObject(hNotify, 1000)\r\n    If lStatus = WAIT_OBJECT_0 Then\r\n        Debug.Print strPath & \" has changed\"\r\n        If FindNextChangeNotification(hNotify) = 0 Then\r\n            Exit Do\r\n        End If\r\n    End If\r\nLoop\r\n\r\nlStatus = FindCloseChangeNotification(hNotify)\r\n\r\nEnd Sub\r\n\r\n","Declares":"Const INFINITE = &HFFFF\r\nConst FILE_NOTIFY_CHANGE_FILE_NAME = &H1\r\nConst WAIT_OBJECT_0 = 0&\r\n\r\n\r\nDeclare Function FindFirstChangeNotification Lib \"kernel32\" Alias \"FindFirstChangeNotificationA\" (ByVal lpPathName As String, ByVal bWatchSubtree As Long, ByVal dwNotifyFilter As Long) As Long\r\nDeclare Function FindNextChangeNotification Lib \"kernel32\" (ByVal hChangeHandle As Long) As Long\r\nDeclare Function FindCloseChangeNotification Lib \"kernel32\" (ByVal hChangeHandle As Long) As Long\r\nDeclare Function WaitForSingleObject Lib \"kernel32\" (ByVal hHandle As Long, ByVal dwMilliseconds As Long) As Long\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Wait for file change","Directory change"]},{"RecordId":"408","Title":"Bubble Sort Routines","Description":"Sorts arrays of various types (single, integer, etc) either ascending or descending","Code":"\r\n' - - - To sort ascending, call with:             BubbleSortAny Ar(), , False\r\n' - - - To sort descending, call with:           BubbleSortAny Ar(), , True\r\n' - - - Replace \"BubbleSortAny\" with \"BubbleSortx\" where x is the array type for the specific sort routine\r\n\r\nAttribute VB_Name = \"BubbleSort\"\r\nOption Explicit\r\n\r\nSub BubbleSortAny(arr As Variant, Optional ByVal numEls As Variant, Optional ByVal descending As Variant)\r\n\r\n    '---------------------------------------\r\n    '  Bubble Sort of an array of any type\r\n    '---------------------------------------\r\n\r\n    Dim index As Long\r\n    Dim firstItem As Long\r\n    Dim indexLimit As Long, lastSwap As Long\r\n    Dim inverseOrder As Boolean\r\n    Dim value As Variant\r\n\r\n    ' exit if it is not an arr\r\n    If VarType(arr) < vbArray Then Exit Sub\r\n\r\n    ' account for optional arguments\r\n    If IsMissing(numEls) Then numEls = UBound(arr)\r\n    If IsMissing(descending) Then descending = False\r\n    inverseOrder = (descending <> False)\r\n    \r\n    firstItem = LBound(arr)\r\n\r\n    lastSwap = numEls\r\n    Do\r\n        indexLimit = lastSwap - 1\r\n        lastSwap = 0\r\n        For index = firstItem To indexLimit\r\n            value = arr(index)\r\n            If (value > arr(index + 1)) Xor inverseOrder Then\r\n                ' if the items are not in order, swap them\r\n                arr(index) = arr(index + 1)\r\n                arr(index + 1) = value\r\n                lastSwap = index\r\n            End If\r\n        Next\r\n    Loop While lastSwap\r\n\r\nEnd Sub\r\n\r\nSub BubbleSortI(arr() As Integer, Optional ByVal numEls As Variant, Optional ByVal descending As Variant)\r\n\r\n    '---------------------------------------\r\n    '  Bubble Sort of an array of integers\r\n    '---------------------------------------\r\n\r\n    Dim index As Long\r\n    Dim firstItem As Long\r\n    Dim indexLimit As Long, lastSwap As Long\r\n    Dim inverseOrder As Boolean\r\n    Dim value As Integer\r\n\r\n    ' account for optional arguments\r\n    If IsMissing(numEls) Then numEls = UBound(arr)\r\n    If IsMissing(descending) Then descending = False\r\n    inverseOrder = (descending <> False)\r\n    \r\n    firstItem = LBound(arr)\r\n\r\n    lastSwap = numEls\r\n    Do\r\n        indexLimit = lastSwap - 1\r\n        lastSwap = 0\r\n        For index = firstItem To indexLimit\r\n            value = arr(index)\r\n            If (value > arr(index + 1)) Xor inverseOrder Then\r\n                ' if the items are not in order, swap them\r\n                arr(index) = arr(index + 1)\r\n                arr(index + 1) = value\r\n                lastSwap = index\r\n            End If\r\n        Next\r\n    Loop While lastSwap\r\n\r\nEnd Sub\r\n\r\nSub BubbleSortL(arr() As Long, Optional ByVal numEls As Variant, Optional ByVal descending As Variant)\r\n\r\n    '---------------------------------------\r\n    '  Bubble Sort of an array of Long\r\n    '---------------------------------------\r\n\r\n    Dim index As Long\r\n    Dim firstItem As Long\r\n    Dim indexLimit As Long, lastSwap As Long\r\n    Dim inverseOrder As Boolean\r\n    Dim value As Long\r\n\r\n    ' account for optional arguments\r\n    If IsMissing(numEls) Then numEls = UBound(arr)\r\n    If IsMissing(descending) Then descending = False\r\n    inverseOrder = (descending <> False)\r\n    \r\n    firstItem = LBound(arr)\r\n\r\n    lastSwap = numEls\r\n    Do\r\n        indexLimit = lastSwap - 1\r\n        lastSwap = 0\r\n        For index = firstItem To indexLimit\r\n            value = arr(index)\r\n            If (value > arr(index + 1)) Xor inverseOrder Then\r\n                ' if the items are not in order, swap them\r\n                arr(index) = arr(index + 1)\r\n                arr(index + 1) = value\r\n                lastSwap = index\r\n            End If\r\n        Next\r\n    Loop While lastSwap\r\n\r\nEnd Sub\r\n\r\nSub BubbleSortS(arr() As Single, Optional ByVal numEls As Variant, Optional ByVal descending As Variant)\r\n\r\n    '---------------------------------------\r\n    '  Bubble Sort of an array of Single\r\n    '---------------------------------------\r\n\r\n    Dim index As Long\r\n    Dim firstItem As Long\r\n    Dim indexLimit As Long, lastSwap As Long\r\n    Dim inverseOrder As Boolean\r\n    Dim value As Single\r\n\r\n    ' account for optional arguments\r\n    If IsMissing(numEls) Then numEls = UBound(arr)\r\n    If IsMissing(descending) Then descending = False\r\n    inverseOrder = (descending <> False)\r\n    \r\n    firstItem = LBound(arr)\r\n\r\n    lastSwap = numEls\r\n    Do\r\n        indexLimit = lastSwap - 1\r\n        lastSwap = 0\r\n        For index = firstItem To indexLimit\r\n            value = arr(index)\r\n            If (value > arr(index + 1)) Xor inverseOrder Then\r\n                ' if the items are not in order, swap them\r\n                arr(index) = arr(index + 1)\r\n                arr(index + 1) = value\r\n                lastSwap = index\r\n            End If\r\n        Next\r\n    Loop While lastSwap\r\n\r\nEnd Sub\r\n\r\nSub BubbleSortD(arr() As Double, Optional ByVal numEls As Variant, Optional ByVal descending As Variant)\r\n\r\n    '---------------------------------------\r\n    '  Bubble Sort of an array of Double\r\n    '---------------------------------------\r\n\r\n    Dim index As Long\r\n    Dim firstItem As Long\r\n    Dim indexLimit As Long, lastSwap As Long\r\n    Dim inverseOrder As Boolean\r\n    Dim value As Double\r\n\r\n    ' account for optional arguments\r\n    If IsMissing(numEls) Then numEls = UBound(arr)\r\n    If IsMissing(descending) Then descending = False\r\n    inverseOrder = (descending <> False)\r\n    \r\n    firstItem = LBound(arr)\r\n\r\n    lastSwap = numEls\r\n    Do\r\n        indexLimit = lastSwap - 1\r\n        lastSwap = 0\r\n        For index = firstItem To indexLimit\r\n            value = arr(index)\r\n            If (value > arr(index + 1)) Xor inverseOrder Then\r\n                ' if the items are not in order, swap them\r\n                arr(index) = arr(index + 1)\r\n                arr(index + 1) = value\r\n                lastSwap = index\r\n            End If\r\n        Next\r\n    Loop While lastSwap\r\n\r\nEnd Sub\r\n\r\nSub BubbleSortC(arr() As Currency, Optional ByVal numEls As Variant, Optional ByVal descending As Variant)\r\n\r\n    '---------------------------------------\r\n    '  Bubble Sort of an array of Currency\r\n    '---------------------------------------\r\n\r\n    Dim index As Long\r\n    Dim firstItem As Long\r\n    Dim indexLimit As Long, lastSwap As Long\r\n    Dim inverseOrder As Boolean\r\n    Dim value As Currency\r\n\r\n    ' account for optional arguments\r\n    If IsMissing(numEls) Then numEls = UBound(arr)\r\n    If IsMissing(descending) Then descending = False\r\n    inverseOrder = (descending <> False)\r\n    \r\n    firstItem = LBound(arr)\r\n\r\n    lastSwap = numEls\r\n    Do\r\n        indexLimit = lastSwap - 1\r\n        lastSwap = 0\r\n        For index = firstItem To indexLimit\r\n            value = arr(index)\r\n            If (value > arr(index + 1)) Xor inverseOrder Then\r\n                ' if the items are not in order, swap them\r\n                arr(index) = arr(index + 1)\r\n                arr(index + 1) = value\r\n                lastSwap = index\r\n            End If\r\n        Next\r\n    Loop While lastSwap\r\n\r\nEnd Sub\r\n\r\nSub BubbleSortDate(arr() As Date, Optional ByVal numEls As Variant, Optional ByVal descending As Variant)\r\n\r\n    '---------------------------------------\r\n    '  Bubble Sort of an array of Date\r\n    '---------------------------------------\r\n\r\n    Dim index As Long\r\n    Dim firstItem As Long\r\n    Dim indexLimit As Long, lastSwap As Long\r\n    Dim inverseOrder As Boolean\r\n    Dim value As Date\r\n\r\n    ' account for optional arguments\r\n    If IsMissing(numEls) Then numEls = UBound(arr)\r\n    If IsMissing(descending) Then descending = False\r\n    inverseOrder = (descending <> False)\r\n    \r\n    firstItem = LBound(arr)\r\n\r\n    lastSwap = numEls\r\n    Do\r\n        indexLimit = lastSwap - 1\r\n        lastSwap = 0\r\n        For index = firstItem To indexLimit\r\n            value = arr(index)\r\n            If (value > arr(index + 1)) Xor inverseOrder Then\r\n                ' if the items are not in order, swap them\r\n                arr(index) = arr(index + 1)\r\n                arr(index + 1) = value\r\n                lastSwap = index\r\n            End If\r\n        Next\r\n    Loop While lastSwap\r\n\r\nEnd Sub\r\n\r\nSub BubbleSortStr(arr() As String, Optional ByVal numEls As Variant, Optional ByVal descending As Variant)\r\n\r\n    '---------------------------------------\r\n    '  Bubble Sort of an array of String\r\n    '---------------------------------------\r\n\r\n    Dim index As Long\r\n    Dim firstItem As Long\r\n    Dim indexLimit As Long, lastSwap As Long\r\n    Dim inverseOrder As Boolean\r\n    Dim value As String\r\n\r\n    ' account for optional arguments\r\n    If IsMissing(numEls) Then numEls = UBound(arr)\r\n    If IsMissing(descending) Then descending = False\r\n    inverseOrder = (descending <> False)\r\n    \r\n    firstItem = LBound(arr)\r\n\r\n    lastSwap = numEls\r\n    Do\r\n        indexLimit = lastSwap - 1\r\n        lastSwap = 0\r\n        For index = firstItem To indexLimit\r\n            value = arr(index)\r\n            If (value > arr(index + 1)) Xor inverseOrder Then\r\n                ' if the items are not in order, swap them\r\n                arr(index) = arr(index + 1)\r\n                arr(index + 1) = value\r\n                lastSwap = index\r\n            End If\r\n        Next\r\n    Loop While lastSwap\r\n\r\nEnd Sub\r\n\r\nSub BubbleSortStrC(arr() As String, Optional ByVal numEls As Variant, Optional ByVal descending As Variant)\r\n\r\n    '---------------------------------------\r\n    '  Bubble Sort of an array of String\r\n    '---------------------------------------\r\n\r\n    Dim index As Long\r\n    Dim firstItem As Long\r\n    Dim indexLimit As Long, lastSwap As Long\r\n    Dim inverseOrder As Boolean\r\n    Dim value As String\r\n\r\n    ' account for optional arguments\r\n    If IsMissing(numEls) Then numEls = UBound(arr)\r\n    If IsMissing(descending) Then descending = False\r\n    inverseOrder = (descending <> False)\r\n    \r\n    firstItem = LBound(arr)\r\n\r\n    lastSwap = numEls\r\n    Do\r\n        indexLimit = lastSwap - 1\r\n        lastSwap = 0\r\n        For index = firstItem To indexLimit\r\n            value = arr(index)\r\n            If (StrComp(value, arr(index + 1), 1) = 1) Xor inverseOrder Then\r\n                ' if the items are not in order, swap them\r\n                arr(index) = arr(index + 1)\r\n                arr(index + 1) = value\r\n                lastSwap = index\r\n            End If\r\n        Next\r\n    Loop While lastSwap\r\n\r\nEnd Sub\r\n\r\nSub BubbleSortV(arr() As Variant, Optional ByVal numEls As Variant, Optional ByVal descending As Variant)\r\n\r\n    '---------------------------------------\r\n    '  Bubble Sort of an array of Variant\r\n    '---------------------------------------\r\n\r\n    Dim index As Long\r\n    Dim firstItem As Long\r\n    Dim indexLimit As Long, lastSwap As Long\r\n    Dim inverseOrder As Boolean\r\n    Dim value As Variant\r\n\r\n    ' account for optional arguments\r\n    If IsMissing(numEls) Then numEls = UBound(arr)\r\n    If IsMissing(descending) Then descending = False\r\n    inverseOrder = (descending <> False)\r\n    \r\n    firstItem = LBound(arr)\r\n\r\n    lastSwap = numEls\r\n    Do\r\n        indexLimit = lastSwap - 1\r\n        lastSwap = 0\r\n        For index = firstItem To indexLimit\r\n            value = arr(index)\r\n            If (value > arr(index + 1)) Xor inverseOrder Then\r\n                ' if the items are not in order, swap them\r\n                arr(index) = arr(index + 1)\r\n                arr(index + 1) = value\r\n                lastSwap = index\r\n            End If\r\n        Next\r\n    Loop While lastSwap\r\n\r\nEnd Sub\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Sort","Bubble Sort"]},{"RecordId":"409","Title":"SQL Server Stored Procedures that operate ActiveX","Description":"The following SQL Server stored procedures allow you to execute methods in ActiveX components.","Code":"sp_OACreate           Creates an instance of a class\r\nsp_OADestroy         Destroys an instance of a class (similar to Set obj = Nothing)\r\nsp_OAGetErrorInfo  Retrieves last OLE error description\r\nsp_OAGetProperty  Returns the value of a class property\r\nsp_OASetProperty  Sets the value of a class property\r\nsp_OAMethod        Executes a class method\r\nsp_OAStop             Stops OLE automation environment on SQL Server\r\n\r\n\r\nDECLARE @ObjTok int\r\nDECLARE @RetVal int\r\nEXEC @RetVal = sp_OACreate 'MyApp.MyClass', @ObjTok OUT\r\nIF @RetVal = 0\r\n  BEGIN\r\n    Select @ValueToSet = 'Monday'\r\n    EXEC sp_OASetProperty @ObjTok, 'Day', @ValueToSet\r\n    EXEC sp_OAGetProperty @objTok, 'SerialNumber', @ValueToGet OUT\r\n    EXEC sp_OAMethod @objTok, 'Initialize'\r\n    EXEC sp_OAMethod @ObjTok, 'Name', NULL, 'James'\r\n    EXEC sp_OAMethod @ObjTok, 'Multiply', @Answer OUT, @x=3, @y=4\r\n    EXEC sp_OADestroy @ObjTok\r\n    EXEC sp_OAStop\r\n  END\r\n","Declares":"","CodeCategory":{"CategoryId":"6","CategoryDescription":"T-SQL"},"Keywords":["SQL Server","Stored Procedure"]},{"RecordId":"410","Title":"Get Volume Label","Description":"Retrieves Disk Volume Label","Code":"Const ATTR_VOLUME = 8\r\nVolName$ = Dir(\"c:\\\", ATTR_VOLUME)\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Disk Volume","Volume"]},{"RecordId":"411","Title":"FileSystemObject Example","Description":"Using the FileSystemObject to read a text file.\r\nYou can also get directory and file info.","Code":"' Requires a reference to the \"Microsoft Scripting Runtime\" library\r\n\r\nDim f As New FileSystemObject\r\nDim tx As TextStream\r\nDim strBuffer As String\r\n\r\nSet tx = f.OpenTextFile(\"\\\\jcbbloom\\dailytrades\\bbbatch\\ted.ted\", ForReading, False)\r\nDo While Not tx.AtEndOfStream\r\n    strBuffer = tx.ReadLine\r\n    Debug.Print strBuffer\r\nLoop\r\n\r\ntx.Close\r\nSet tx = Nothing\r\nSet f = Nothing\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["FileSystemObject"]},{"RecordId":"412","Title":"Disconnected Recordsets (Preferred)","Description":"Demo of how to open a disconnected ADO recordset","Code":"Private Sub Form_Load()\r\n\r\nDim rsin As ADODB.Recordset\r\n\r\nSet rsin = RS_Get\r\nDo While Not rsin.EOF\r\n    Debug.Print rsin!Account_Base\r\n    rsin.MoveNext\r\nLoop\r\nrsin.Close\r\n\r\nEnd Sub\r\n\r\n\r\n\r\nPublic Function RS_Get() As ADODB.Recordset\r\n\r\nDim cn As New ADODB.Connection\r\nDim rs As New ADODB.Recordset\r\nDim strSQL As String\r\n\r\nstrSQL = \"SELECT *\"\r\nstrSQL = strSQL & \" FROM v_Account\"\r\nstrSQL = strSQL & \" WHERE Account_Branch = '143'\"\r\nstrSQL = strSQL & \" AND Account_Base LIKE '00%'\"\r\n\r\ncn.Open \"Provider=SQLOLEDB;Server=Develop2;UID=sa;PWD=;Database=CorpDB\"\r\n\r\nrs.CursorLocation = adUseClient\r\nrs.Open strSQL, cn, adOpenForwardOnly, adLockReadOnly\r\nSet RS_Get = rs\r\n\r\nSet rs.ActiveConnection = Nothing\r\ncn.Close\r\n\r\nEnd Function\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["ADO","Disconnected Recordsets"]},{"RecordId":"415","Title":"Cookie Utilities (JavaScript)","Description":"JavaScript cookie utilities","Code":"//--------------------------------------------------------------------\r\n//  Including the code:\r\n//--------------------------------------------------------------------\r\n\r\n<script src=\"cookieutils.js\"></script>\r\n\r\n//--------------------------------------------------------------------\r\n//  Using the code:\r\n//--------------------------------------------------------------------\r\n\r\n<script language=\"JavaScript\">\r\n\r\n\tvar visitordata = new Cookie(document, \"name_color_count_state\", 240);\r\n\tif (!visitordata.load() || !visitordata.name || !visitordata.color) {\r\n\t\tvisitordata.name = prompt(\"What is your name:\",\"\");\r\n\t\tvisitordata.color = prompt(\"What is your favorite color:\",\"\");\r\n\t}\r\n\r\n\tif (visitordata.visits == null)\r\n\t\tvisitordata.visits = 0;\r\n\t\t\r\n\tvisitordata.visits++;\r\n\t\r\n\tvisitordata.store();\r\n\t\r\n\tdocument.write('<FONT Size=7 Color=\"' + visitordata.color + '\">' +\r\n\t\t'Welcome, ' + visitordata.name + '!' +\r\n\t\t'</FONT>' +\r\n\t\t'<p>You have visited ' + visitordata.visits + ' times.');\r\n\t\t\r\n</script>\r\n\r\n//--------------------------------------------------------------------\r\n//  The include file\r\n//--------------------------------------------------------------------\r\n\r\nfunction Cookie(document, name, hours, path, domain, secure) {\r\n\t\r\n\tthis.$document = document;\r\n\tthis.$name = name;\r\n\t\r\n\tif (hours)\r\n\t\tthis.$expiration = new Date((new Date()).getTime() + hours*3600000);\r\n\telse\r\n\t\tthis.$expiration = null;\r\n\r\n\tif (path) \r\n\t\tthis.$path = path;\r\n\telse\r\n\t\tthis.$path = null;\r\n\t\t\r\n\tif (domain) \r\n\t\tthis.$domain = domain;\r\n\telse\r\n\t\tthis.$domain = null;\r\n\r\n\tif (secure) \r\n\t\tthis.$secure = true;\r\n\telse\r\n\t\tthis.$secure = false;\r\n\r\n}\r\n\r\nfunction _Cookie_store() {\r\n\t\r\n\tvar cookieval = \"\";\r\n\t\r\n\tfor (var prop in this) {\r\n\t\tif ((prop.charAt(0) == '$') || ((typeof this[prop]) == 'function'))\r\n\t\t\tcontinue;\r\n\t\tif (cookieval != \"\") \r\n\t\t\tcookieval += '&';\r\n\t\tcookieval += prop + ':' + escape(this[prop]);\r\n\t}\r\n\r\n\tvar cookie = this.$name + '=' + cookieval;\r\n\tif (this.$expiration)\r\n\t\tcookie += '; expires=' + this.$expiration.toGMTString();\r\n\tif (this.$path)\r\n\t\tcookie += '; path=' + this.$path;\r\n\tif (this.$domain)\r\n\t\tcookie += '; domain=' + this.$domain;\r\n\tif (this.$secure)\r\n\t\tcookie += '; secure';\r\n\t\r\n\tthis.$document.cookie = cookie;\t\t\r\n\r\n}\r\n\r\nfunction _Cookie_load() {\r\n\r\n\tvar allcookies = this.$document.cookie;\r\n\t\r\n\tif (allcookies == \"\")\r\n\t\treturn false;\r\n\t\t\r\n\tvar start = allcookies.indexOf(this.$name + '=');\r\n\tif (start == -1) \r\n\t\treturn false;\r\n\tstart += this.$name.length + 1;\r\n\r\n\tvar end = allcookies.indexOf(';', start);\r\n\tif (end == -1) \r\n\t\tend = allcookies.length;\r\n\t\t\r\n\tvar cookieval = allcookies.substring(start,end);\r\n\t\r\n\tvar a = cookieval.split('&');\r\n\tfor (var i=0; i < a.length; i++) \r\n\t\ta[i] = a[i].split(':');\r\n\t\t\r\n\tfor(var i=0; i < a.length; i++) {\r\n\t\tthis[a[i][0]] = unescape(a[i][1]);\r\n\t}\r\n\r\n\treturn true;\t\r\n\r\n}\r\n\r\nfunction _Cookie_remove() {\r\n\r\n\tvar cookie;\r\n\t\r\n\tcookie = this.$name + \"=\";\r\n\tif (this.$path)\r\n\t\tcookie += '; path=' + this.$path;\r\n\t\t\r\n\tif (this.$domain)\r\n\t\tcookie += '; domain=' + this.$domain;\r\n\t\r\n\tcookie += '; expires=Fri, 02-Jan-1970 00:00:00 GMT';\r\n\r\n\tthis.$document.cookie = cookie;\t\r\n}\r\n\r\nnew Cookie();\r\nCookie.prototype.store = _Cookie_store;\r\nCookie.prototype.load = _Cookie_load;\r\nCookie.prototype.remove = _Cookie_remove;\r\n","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["Cookies"]},{"RecordId":"416","Title":"Use MTS to Access ASP Session Info","Description":"Uses MTS to access ASP Session, Response, and Request objects","Code":"'------------------------------------------------------------------------\r\n' ASP Code\r\n'------------------------------------------------------------------------\r\n\r\n<% \r\n\r\nDim oTest\r\n\r\nSet oTest = Server.CreateObject(\"MTS_ASP_Demo.Context\")\r\n\r\noTest.Test\r\n\r\nSet oTest = Nothing\r\n\r\n\r\nResponse.Write \"<p>\" & Session(\"MarksVariable\")\r\n\r\n\r\n%>\r\n\r\n<p>\r\nAin't this cool!!!\r\n\r\n'------------------------------------------------------------------------\r\n' MTS Code\r\n'------------------------------------------------------------------------\r\nOption Explicit\r\n\r\n'Private member variables\r\nPrivate m_objCtx As ObjectContext\r\n\r\n'Implementation of ObjectControl interface\r\nImplements ObjectControl\r\n\r\n\r\nPrivate Sub ObjectControl_Activate()\r\n    Set m_objCtx = GetObjectContext\r\n    If m_objCtx Is Nothing Then _\r\n        Err.Raise 91 'error if failed\r\nEnd Sub\r\n\r\n\r\nPrivate Function ObjectControl_CanBePooled() As Boolean\r\n    ObjectControl_CanBePooled = False  'don't pool for now\r\nEnd Function\r\n\r\n\r\nPrivate Sub ObjectControl_Deactivate()\r\n    Set m_objCtx = Nothing 'release\r\nEnd Sub\r\n\r\n\r\n\r\nPublic Function Test() As Variant        'sample mts function\r\n    On Error GoTo Error_Handler\r\n    \r\n    Dim strErrString As String\r\n    Dim objSession As Object\r\n    Dim objResponse As Object\r\n    Dim objRequest As Object\r\n    \r\n    Set objSession = m_objCtx.Item(\"Session\")\r\n    Set objResponse = m_objCtx.Item(\"Response\")\r\n    Set objRequest = m_objCtx.Item(\"Request\")\r\n    \r\n    objSession(\"MarksVariable\") = \"This text was set in MTS, but written in ASP.\"\r\n    \r\n    \r\n    With objResponse\r\n        .Write \"<p> Outputting from the MTS component </p>\"\r\n        .Write \"<p> Here Are Some Server Variables: </p>\"\r\n        .Write \"&nbsp;&nbsp;&nbsp;&nbsp;Server Name: \" & objRequest.ServerVariables(\"SERVER_NAME\") & \"<BR>\"\r\n        .Write \"&nbsp;&nbsp;&nbsp;&nbsp;Script Name: \" & objRequest.ServerVariables(\"SCRIPT_NAME\") & \"<BR>\"\r\n        .Write \"&nbsp;&nbsp;&nbsp;&nbsp;User Agent: \" & objRequest.ServerVariables(\"HTTP_USER_AGENT\") & \"<BR>\"\r\n    End With\r\n    \r\n    m_objCtx.SetComplete\r\n\r\nError_Handler:\r\n    m_objCtx.SetAbort\r\n\r\nEnd Function\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"14","CategoryDescription":"MTS"},"Keywords":["MTS","Session Objects","ASP Objects"]},{"RecordId":"418","Title":"Rollovers (Uses Clip Regions)","Description":"Creates rollovers with only two (large) images instead of individual GIFs.","Code":"<HEAD>\r\n.\r\n.\r\n.\r\n<STYLE TYPE=\"text/css\"> \r\n<!--\r\n\r\n    #elMenu { position: relative }\r\n\r\n    #elMenuUp { \r\n        position: absolute;\r\n        top: 0;\r\n        left: 0\r\n    }\r\n\r\n    #elMenuOver {\r\n        position: absolute;\r\n        visibility: hidden;\r\n        top: 0;\r\n        left: 0\r\n    }\r\n\r\n-->\r\n</STYLE>\r\n\r\n<SCRIPT LANGUAGE=\"JavaScript\">\r\n<!--\r\n\r\n    IE4 = (document.all) ? 1 : 0;\r\n    NS4 = (document.layers) ? 1 : 0;\r\n    ver4 = (IE4 || NS4) ? 1 : 0;\r\n\r\n    if (ver4) {\r\n        secondIm = \"<IMG SRC='menuover.gif' USEMAP='#mpMenu' WIDTH=468 HEIGHT=18 BORDER=0>\";\r\n        arPopups = new Array()\r\n    }\r\n    else { secondIm = \"\" }\r\n\r\n    function setBeginEnd(which,from,to) {\r\n        arPopups[which] = new Array();\r\n        arPopups[which][0] = from;\r\n        arPopups[which][1] = to;\r\n    }\r\n\r\n    if (ver4) {\r\n        setBeginEnd(1,0,116);\r\n        setBeginEnd(2,117,181);\r\n        setBeginEnd(3,182,222);\r\n        setBeginEnd(4,223,263);\r\n        setBeginEnd(5,264,339);\r\n        setBeginEnd(6,340,397);\r\n        setBeginEnd(7,398,468);\r\n    }\r\n\r\n    clTop = 0;\r\n    clBot = 18;\r\n\r\n    function mapOver(which,on) {\r\n        if (!ver4) { return }\r\n        if (IE4) { whichEl = document.all.elMenuOver.style }\r\n            else { whichEl = document.elMenu.document.elMenuOver };\r\n\r\n        if (!on) { whichEl.visibility = \"hidden\"; return }\r\n\r\n        clLeft = arPopups[which][0];\r\n        clRight = arPopups[which][1];\r\n\r\n\tif (NS4) {\r\n            whichEl.clip.left = clLeft;\r\n            whichEl.clip.right = clRight;\r\n\t}\r\n\telse {\r\n            whichEl.clip = \"rect(\" + clTop + \" \" + clRight + \" \" + clBot + \" \" + clLeft + \")\";\r\n\t}\r\n\r\n        whichEl.visibility = \"visible\" \r\n    }\r\n\r\n//-->\r\n</SCRIPT>\r\n.\r\n.\r\n.\r\n</HEAD>\r\n<BODY>\r\n.\r\n.\r\n.\r\n<DIV ID=\"elMenu\">\r\n    <DIV ID=\"elMenuUp\">\r\n        <IMG SRC=\"menu.gif\" USEMAP=\"#mpMenu\" WIDTH=468 HEIGHT=18 BORDER=0>\r\n    </DIV>\r\n    <DIV ID=\"elMenuOver\">\r\n        <SCRIPT LANGUAGE=\"JavaScript\">document.write(secondIm)</SCRIPT>\r\n    </DIV>\r\n</DIV>\r\n.\r\n.\r\n.\r\n<MAP NAME=\"mpMenu\">\r\n  <AREA SHAPE=\"RECT\" COORDS=\"0,0 116,18\" \r\n  \tHREF=\"/\" onMouseOver=\"mapOver(1,true)\" onMouseOut=\"mapOver(1,false)\">\r\n  <AREA SHAPE=\"RECT\" COORDS=\"117,0 181,18\" \r\n  \tHREF=\"/cgi-bin/suggest.cgi\" onMouseOver=\"mapOver(2,true)\" onMouseOut=\"mapOver(2,false)\">\r\n  <AREA SHAPE=\"RECT\" COORDS=\"182,0 222,18\" \r\n  \tHREF=\"http://www.coolcentral.com\" onMouseOver=\"mapOver(3,true)\" onMouseOut=\"mapOver(3,false)\">\r\n  <AREA SHAPE=\"RECT\" COORDS=\"223,0 263,18\" \r\n  \tHREF=\"/new/\" onMouseOver=\"mapOver(4,true)\" onMouseOut=\"mapOver(4,false)\">\r\n  <AREA SHAPE=\"RECT\" COORDS=\"264,0 339,18\" \r\n  \tHREF=\"/headlines/\" onMouseOver=\"mapOver(5,true)\" onMouseOut=\"mapOver(5,false)\">\r\n  <AREA SHAPE=\"RECT\" COORDS=\"340,0 397,18\" \r\n  \tHREF=\"/search.cgi\" onMouseOver=\"mapOver(6,true)\" onMouseOut=\"mapOver(6,false)\">\r\n  <AREA SHAPE=\"RECT\" COORDS=\"398,0 468,18\" \r\n  \tHREF=\"/index2.html\" onMouseOver=\"mapOver(7,true)\" onMouseOut=\"mapOver(7,false)\">\r\n</MAP>\r\n.\r\n.\r\n.\r\n","Declares":"","CodeCategory":{"CategoryId":"2","CategoryDescription":"Web"},"Keywords":["Rollover"]},{"RecordId":"419","Title":"Using MetaData to Include Type Library Constants","Description":"Use MetaData instead of Include files to import type library and DLL functions","Code":"One disadvantage of ASP is that when using a component, the component's constants aren't immediately avaialable. For example, if you want to use the ADO constant adOpenStatic you need to include adovbs.inc. While there is nothing wrong with this, wouldn't it be nice not to have to always be sure to include adovbs.inc each time that you wanted to use an ADO constant? \r\n\r\nYour days of including adovbs.inc are over! The METADATA tag can be used to automatically import the constants from a DLL or TBL file. For example, imagine that we wanted to crate a recordset object with a Keyset cursor. We'd have to use code similar to: \r\n\r\n<!--#include virtual=\"/adovbs.inc\"-->\r\n<%\r\n   Dim objConn, strSQL\r\n   Set objConn = Server.CreateObject(\"ADODB.Connection\")\r\n   objConn.Open \"DSN=Blah\"\r\n\r\n   strSQL = \"SELECT * FROM Table1\"\r\n\r\n   Dim objRS\r\n   Set objRS = Server.CreateObject(\"ADODB.Recordset\")\r\n   objRS.Open strSQL, objConn, adOpenKeyset\r\n\r\n   '...\r\n%>\r\n\r\nWe can use the METADATA tag in place of the <!--#include virtual=\"/adovbs.inc\"-->. The METADATA tag has the following form: \r\n\r\n<!--METADATA\r\n     TYPE=\"typelib\"\r\n     FILE=\"FileName\"\r\n     UUID=\"TyleLibraryUUID\"\r\n-->\r\n\r\nFirst off, you need to set TYPE=\"typelib\". Concerning the other two parameters, FILE and UUID, you need to only specify one. You can either specify the TBL or DLL file directly with the FILE property, or through the UUID. For example, on my machine, the following two statements would be identical: \r\n\r\n<!-- METADATA \r\n        TYPE=\"typelib\" \r\n        UUID=\"00000200-0000-0010-8000-00AA006D2EA4\"\r\n-->\r\n\r\nand \r\n\r\n<!-- METADATA \r\n        TYPE=\"typelib\" \r\n        FILE=\"C:\\Program Files\\Common Files\\System\\ADO\\msado20.tlb\"\r\n-->\r\n\r\nYou can then place this METADATA tag in place of the #include. For example, the first script we examined would be changed to: \r\n\r\n<!-- METADATA \r\n        TYPE=\"typelib\" \r\n        FILE=\"C:\\Program Files\\Common Files\\System\\ADO\\msado20.tlb\"\r\n-->\r\n\r\n<%\r\n   Dim objConn, strSQL\r\n   Set objConn = Server.CreateObject(\"ADODB.Connection\")\r\n   objConn.Open \"DSN=Blah\"\r\n\r\n   strSQL = \"SELECT * FROM Table1\"\r\n\r\n   Dim objRS\r\n   Set objRS = Server.CreateObject(\"ADODB.Recordset\")\r\n   objRS.Open strSQL, objConn, adOpenKeyset\r\n\r\n   '...\r\n%>\r\n\r\nNow, why would anyone want to use this longer METADATA tag on each page as opposed to the standard #include file=\"adovbs.inc\"? Well, no one probably would want to do that. However, you can place the METADATA tag in your Global.asa file, which will give every ASP page in your web application knowledge of the ADO constants! Pretty sweet, eh? The METADATA tag should come before the <SCRIPT ...> block in Global.asa. (It doesn't have to be placed there, but why not do that, just to make me happy?) \r\n\r\nAnyway, besides saving typing and having to include adovbs.inc in all of your pages that need to access ADO constants, using METADATA supposedly increases performance. At least according to Microsoft. \r\n\r\nA couple of caveats: first, from alert reader Daniel S., if you include adovbs.inc when using the METADATA tag in Global.asa, you will get a Name redefined error. Second, the METADATA tag will only work with IIS 4.0 and up.","Declares":"","CodeCategory":{"CategoryId":"5","CategoryDescription":"ASP"},"Keywords":["Include","MetaData"]},{"RecordId":"421","Title":"Combo Box Magic","Description":"Dynamically change combo box contents based on another combo box","Code":"<html>\r\n<head>\r\n\t<title>Untitled</title>\r\n</head>\r\n\r\n<SCRIPT Language=JavaScript>\r\n\r\n\tfunction ChangeCombo(theForm){\r\n\t\r\n\t\tvar indx = theForm.cboCombo1.selectedIndex;\r\n\r\n\t\tif (indx == 1) {\r\n\t\t\ttheForm.cboCombo2.options.length = 3;\r\n\t\t\ttheForm.cboCombo2.options[0].text = 'Option 1a';\r\n\t\t\ttheForm.cboCombo2.options[0].value = '1a';\r\n\t\t\ttheForm.cboCombo2.options[1].text = 'Option 2a';\r\n\t\t\ttheForm.cboCombo2.options[1].value = '2a';\r\n\t\t\ttheForm.cboCombo2.options[2].text = 'Option 3a';\r\n\t\t\ttheForm.cboCombo2.options[2].value = '3a';\r\n\t\t} else if (indx == 2) {\r\n\t\t\ttheForm.cboCombo2.options.length = 2;\r\n\t\t\ttheForm.cboCombo2.options[0].text = 'Option 1b';\r\n\t\t\ttheForm.cboCombo2.options[0].value = '1b';\r\n\t\t\ttheForm.cboCombo2.options[1].text = 'Option 2b';\r\n\t\t\ttheForm.cboCombo2.options[1].value = '2b';\r\n\t\t} else {\r\n\t\t\ttheForm.cboCombo2.options.length = 1;\r\n\t\t\ttheForm.cboCombo2.options[0].text = 'Select an item from list 1';\r\n\t\t\ttheForm.cboCombo2.options[0].value = '';\r\n\t\t}\r\n\t\t\r\n\t\ttheForm.cboCombo2.options[0].selected = true;\r\n\t}\r\n\r\n</script>\r\n\r\n<body>\r\n\r\n<Form name='frmMain' id='frmMain'>\r\n\t<select name='cboCombo1' onChange=\"ChangeCombo(frmMain)\">\r\n\t\t<option value='Item0' selected></option>\r\n\t\t<option value='Item1'>Item 1</option>\r\n\t\t<option value='Item2'>Item 2</option>\r\n\t</select>\r\n\t<select name='cboCombo2' >\r\n\t\t<option>Select an item from list 1</option>\r\n\t</select>\r\n</form>\r\n\r\n</body>\r\n</html>","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["Combo Box","Dynamic Combo Box"]},{"RecordId":"422","Title":"Maintaining State By Using a Database","Description":"Demonstrates how to maintain state in ASP by storing values in a database.","Code":"----------------------------------------------------------------------------\r\n- Table definitions (2 tables) NOTE: Requires SQL 7 due to use of \r\n- UniqueIdentifier field datatype and NewID() system function.\r\n----------------------------------------------------------------------------\r\n\r\nTABLE SESSIONS \r\nsessionid \tuniqueidentifier Primary Key  \r\ntime_stamp \tdatetime   \r\nsessionipaddr \tvarchar(50)   \r\n\r\n\r\nTABLE SESSIONVALUES \r\nsessionid  \tvarchar(50) \tPrimary Key  \r\nsessionvalname \tvarchar(100) \tPrimary Key  \r\nsessionvaldata \tvarchar(100)   \r\n\r\n\r\n----------------------------------------------------------------------------\r\n- Stored procedures (4 total) used by the ASP\r\n----------------------------------------------------------------------------\r\n\r\n(1)  Returns a GUID based on the incoming User's IP Address and stores it in the Sessions table\r\nCREATE Procedure newsession\r\n\t@USRIPADDR VARCHAR(50)\r\nAS\r\n\tDECLARE @SESSIONID UNIQUEIDENTIFIER\r\n\tSET @SESSIONID = NEWID()\r\n\tDECLARE @DT DATETIME\r\n\tSET @DT = getdate()\r\n\tINSERT INTO SESSIONS \r\n\t(SESSIONID, TIME_STAMP, SESSIONIPADDR)\r\n\tVALUES\r\n\t(@SESSIONID, @DT, @USRIPADDR)\r\n\tSELECT SESSIONID FROM SESSIONS WHERE SESSIONID = @SESSIONID\r\n\r\n\r\n(2)  Writes name/value pairs to the SessionValues table\r\nCREATE Procedure sessiondata\r\n\t@SESSIONID varchar (50),\r\n\t@SESSIONVALNAME Varchar(100),\r\n\t@SESSIONDATA Varchar(50)\r\nAS\r\n\tDeclare @CNTVALS int\r\n\tSelect @CNTVALS=Count(*) FROM SESSIONVALUES \r\n              WHERE SESSIONID = @SESSIONID AND SESSIONVALNAME = SESSIONVALNAME\r\n\t\r\n\tIF (@CNTVALS > 0) \r\n\tBEGIN\r\n\t--The Valname already Exisits, so simply update it\r\n\t\tUPDATE SESSIONVALUES\r\n\t\tSET SESSIONVALDATA = @SESSIONDATA\r\n\t\tWHERE SESSIONID = @SESSIONID AND SESSIONVALNAME = @SESSIONVALNAME\r\n\t\r\n\t\tRETURN 1 \r\n\r\n\tEND\r\n\tELSE\r\n\tBEGIN --there was no valname that corresponded to that session\r\n\t\tINSERT INTO SESSIONVALUES\r\n\t\t(SESSIONID, SESSIONVALNAME, SESSIONVALDATA)\r\n\t\tVALUES\r\n\t\t(@SESSIONID, @SESSIONVALNAME, @SESSIONDATA)\r\n\t\t\r\n\t\tRETURN 0 \r\n\tEND\r\n\r\n\t\r\n(3)  Retrieves a Value from the SessionValues table\t\r\nCREATE PROCEDURE retrievesession\r\n\t@SESSIONID varchar(50),\r\n\t@SESSIONVALNAME VARCHAR(100)\r\n AS\r\n\tSELECT SESSIONVALDATA FROM SESSIONVALUES \r\n              WHERE SESSIONID = @SESSIONID AND SESSIONVALNAME = @SESSIONVALNAME\r\n              \r\n             \r\n              \r\n(4)  Retrieves lost GUID for a user based in the User's IP Address.  If not found,\r\ncreates a new on and returns the new one.              \r\nCREATE PROCEDURE retrieve_GUID \r\n\t@USRIPADDR VARCHAR(50)\r\nAS\r\n\tDECLARE @CNTVALS INTEGER\r\n\t\r\n\t\r\n\tSELECT @CNTVALS=COUNT(*) FROM SESSIONS\r\n\tWHERE SESSIONIPADDR = @USRIPADDR AND \r\n\tDATEDIFF(MINUTE, TIME_STAMP, GETDATE()) <= 20 --within 20 Minutes\r\n\r\n\t\r\nIF (@CNTVALS = 1) --Only one value was returned, look up that GUID & return to user\r\n\t\tBEGIN\r\n\t\t\tSELECT SESSIONID FROM SESSIONS \r\n\t\t\tWHERE SESSIONIPADDR = @USRIPADDR AND  \r\n\t\t\tDATEDIFF(MINUTE, TIME_STAMP, GETDATE()) <= 20 --within 20 Minutes\r\n\t\tEND\r\nELSE\r\n\t\tBEGIN\r\n\t\tDECLARE @SESSIONID UNIQUEIDENTIFIER\r\n\t\tSET @SESSIONID = NEWID()\r\n\t\t\r\n\t\tINSERT INTO SESSIONS\r\n\t\t(SESSIONID, TIME_STAMP, SESSIONIPADDR)\r\n\t\tVALUES\r\n\t\t(@SESSIONID, getdate(), @USRIPADDR)\r\n\t\r\n\t\tSELECT SESSIONID FROM SESSIONS WHERE SESSIONID = @SESSIONID\r\n\r\n\t\tEND\r\n\t\t\r\n\t\t\r\n----------------------------------------------------------------------------\r\n- ASP Code that retrieves and stores session data in a database\r\n----------------------------------------------------------------------------\r\n\r\n<%\r\n\r\ndim ID\t'put the sessionid into this variable, get it from the QS, \r\n\t'if the QS isnt available we will retrieve the SessionID from \r\n\t'the database & put it into this variable\r\nID = Request.Querystring(\"$SESSIONID\") \r\n\r\n\r\nfunction create_new_session()    \r\n\tset conn = Server.CreateObject (\"ADODB.CONNECTION\")\r\n\tconn.Open \"dsn=DSN; uid=usrid; pwd=passwd\"\r\n\tdim usripaddr\r\n\tusripaddr = request.servervariables(\"REMOTE_ADDR\")\r\n\tMySQL = \"Execute newsession '\" & usripaddr & \"'\"\r\n\tSET oRS = conn.Execute (MySQL)\r\n\tnewsession = oRS(\"SESSIONID\")\r\n\toRS.Close\r\n\tset conn = nothing\r\nend function\r\n\r\n\r\nfunction checkqs(byVal sessionid)\r\n\tif sessionid = \"\" then\r\n\t\tset conn = server.createobject(\"ADODB.CONNECTION\")\r\n\t\tconn.Open \"dsn=DSN; uid=usrid; pwd=passwd\"\r\n\t\r\n\t\t'the sessionid is gone, we need to retrieve it from the DB\r\n\t\tdim ipAddr \r\n\t\tipAddr = Request.Servervariables(\"REMOTE_ADDR\")\r\n\t\tdim mySQL\r\n\t\tmySQL = \"Execute retrieve_GUID '\" & ipAddr & \"'\" \r\n\t\tset oRS = conn.execute (mySQL) \r\n\t\tID = oRS(\"SESSIONID\")\r\n\t\tcheckqs = ID\r\n\t\t\r\n\t\toRS.close\r\n\t\tset conn = nothing\r\n\tElse\r\n\t\tcheckqs = sessionid\r\n\tEnd If\r\n\t\r\nend function\r\n\r\n\r\nfunction save_session_data(byVal SessionID, byVal Dataname, ByVal Data)\r\n\tsessionid = checkqs(SessionID)'verify the session is active \r\n\tset conn = Server.CreateObject (\"ADODB.CONNECTION\")\r\n\tconn.Open \"dsn=DSN; uid=usrid; pwd=passwd\"\r\n\tsql = \"Execute sessiondata '\" & SessionID & \"','\" & Dataname & \"','\" & Data & \"'\"\r\n\tconn.execute (sql)\r\n\tset Conn = nothing\r\nEnd Function\r\n\r\n\r\nFunction retrieve_session_data(byVal Sessionid, ByVal Dataname)\r\n\tsessionid = checkqs(sessionid)'verify the session is active \r\n\tset conn = Server.createobject (\"ADODB.CONNECTION\")\r\n\tconn.Open \"dsn=DSN; uid=usrid; pwd=passwd\"\r\n\tsql = \"Execute retrievesession '\" & Sessionid & \"','\" & Dataname & \"'\"\r\n\tSet oRS = conn.execute (sql)\r\n\tretrieve_session = oRS(\"sessionvaldata\")\r\n\tors.close\r\n\tset conn = nothing\r\nEnd Function\r\n\r\n%>","Declares":"","CodeCategory":{"CategoryId":"2","CategoryDescription":"Web"},"Keywords":["State","Maintaining State","Stateless"]},{"RecordId":"423","Title":"Running Out of Process EXEs From ASP","Description":"Configuration that is necessary to allow IIS to call out of process ActiveX EXEs.","Code":"PRB: Server Object Error 'ASP 0178' Instantiating COM Object \r\n\r\n--------------------------------------------------------------------------------\r\nThe information in this article applies to:\r\nActive Server Pages \r\nMicrosoft Internet Information Server versions 4.0, 5.0\r\n--------------------------------------------------------------------------------\r\n\r\nSYMPTOMS\r\nWhen instantiating a COM component in an Out-Of-Process Server (EXE) from Active Server Pages (ASP), the following error may occur: \r\n\r\nServer object error 'ASP 0178 : 80070005'\r\nServer.CreateObject Access Error\r\ntestOOP.asp, line 12\r\nThe call to Server.CreateObject failed while checking permissions.\r\nAccess is denied to this object. \r\n\r\nCAUSE\r\nAppropriate permissions to access and launch the Out-Of-Process (OOP) COM object has not been set. \r\n\r\nRESOLUTION\r\nYou need to give the IUSR_<machine_name> account permissions to launch and access your OOP COM object using dcomcnfg by doing the following: \r\n\r\n1.  Launch DCOMCNFG by clicking the Start button, selecting Run, and typing \"Dcomcnfg\" in the Run dialog box. \r\n\r\n2.  In the Default Security tab, click the \"Edit Default\" in the \"Default Access Permissions\" frame. The Registry Value Permissions dialog box appears. \r\n\r\n3.  Add the IUSR_<machine_name>account and the INTERACTIVE account to the Registry Value Permissions dialog box, and click OK.\r\n\r\n4.  In the Default Security tab, click the Edit Default in the Default Launch Permissions frame. The Registry Value Permissions dialog box appears. \r\n\r\n5.  Add the IUSR_<machine_name> account to the Registry Value Permissions dialog box0, and click OK.","Declares":"","CodeCategory":{"CategoryId":"5","CategoryDescription":"ASP"},"Keywords":["IIS","Out of Process","EXE"]},{"RecordId":"424","Title":"Setting the Browser Home Page","Description":"Sets the home page for the browser","Code":"Set Home Page with DHTML \r\n\r\nDHTML intrinsic behavior gives advantage to changing the user's home page to the current page. \r\n\r\nThe style block, which goes in the <HEAD> of the document, associates the home page class with the built-in behavior. The inline STYLE on the <SPAN> tag simulates the look and feel of a hot link, but clicking the link doesn't cause a new page to be loaded (IE5 also provides a new feature, to use conditional comments to hide this link from lower browsers). \r\n\r\nThe style block goes in the page <HEAD>: \r\n\r\n<STYLE>\r\n<!--\r\n.homepage {behavior:url(#_IE_)}\r\n-->\r\n</STYLE> \r\nThis code can be placed anywhere in the page body: \r\n<!--#if IE 5#>\r\n<U><SPAN STYLE='color:blue;cursor:hand;'\r\nCLASS=homepage\r\nONCLICK='this.setHomePage(window.location);'>\r\nMake this your home page</SPAN></U>\r\n<!#endif#--> \r\n\r\nWe can also change the user's home page to a page other than the current page by replacing window.location in the above example with a specific URL. \r\nFor example, \r\nONCLICK=\"this.setHomePage('http://www.myhome.com')\"\r\n\r\nInternet Explorer first asks the user if they want to change their home page rather than setting it automatically.","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["HomePage","Home Page"]},{"RecordId":"425","Title":"Change Layer Contents Dynamically (NetScape)","Description":"How to dynamically change the contents of an element using Document.Write().","Code":"<script language=JavaScript>\r\n\r\n  function Foo() {\r\n    var el;\r\n    el=document.Layer1;\r\n    alert(\"HI\");\r\n    alert(el.name);\r\n    el.document.open();\r\n    el.document.write(\"Hello\");\r\n    el.document.close();\r\n  }\r\n\r\n</script>\r\n\r\n<html>\r\n<head>\r\n  <title>Untitled</title>\r\n</head>\r\n\r\n<body>\r\n<layer id='Layer1' name='Layer1'>\r\n this is a test\r\n</layer>\r\n\r\n<BR>\r\n\r\n<form id='form1' name='form1'>\r\n<input type=button onClick=Foo()>\r\n</form>\r\n\r\n</body>\r\n</html>","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["Layer","Dynamic Content","Netscape"]},{"RecordId":"426","Title":"EMail Sample","Description":"Demonstrates how to email a user their password","Code":"'----------------------------------------------------------------------------------------------\r\n' This is the form that requests the user's email\r\n'----------------------------------------------------------------------------------------------\r\n\r\n<html>\r\n<head>\r\n<title>Forgot Password</title>\r\n</head>\r\n<body>\r\nIf you forgot your login information,\r\nenter you email address below and it will be sent to you.\r\n<form method=\"POST\" action=\"sendit.asp\">\r\nYour email address:\r\n<input type=\"text\" name=\"email\" size=\"20\">\r\n<input type=\"submit\" value=\"Request information\">\r\n</form>\r\n</body>\r\n</html>\r\n\r\n'----------------------------------------------------------------------------------------------\r\n' This is the page that processes the request\r\n'----------------------------------------------------------------------------------------------\r\n\r\n<%@ LANGUAGE=\"VBSCRIPT\" %>\r\n<% Option Explicit %>\r\n<% \r\nDim DATA_PATH, objDC, objRS, email, user, pass, sendmail\r\n   'Maps to database.   Change to your database path.\r\nDATA_PATH=Server.Mappath(\"users.mdb\")\r\n   ' Create and establish data connection\r\nSet objDC = Server.CreateObject(\"ADODB.Connection\")\r\nobjDC.ConnectionTimeout = 15\r\nobjDC.CommandTimeout = 30\r\nobjDC.Open \"DBQ=\" & DATA_PATH & \";Driver={Microsoft Access Driver (*.mdb)};DriverId=25;MaxBufferSize=8192;Threads=20;\", \"admin\", \"password\"\r\nSet objRS = Server.CreateObject(\"ADODB.Recordset\")\r\nemail=request.form(\"email\")\r\n   'you may need to adjust this to suit your database\r\nobjRS.Open \"SELECT * FROM USERS WHERE email = '\" & email & \"'\", objDC, 0, 1\r\n%>\r\n\r\n\r\n<head>\r\n<title>Forgotten Password</title>\r\n</head>\r\n<body>\r\n<%\r\n   'checks if email address exists in the database before sending a message.\r\nif objrs.EOF then\r\n%>\r\n<B><font color=\"red\">\r\nThere is no account for <%=email%>.\r\n</font></B>\r\n<% Else %> \r\n\r\n\r\n<%\r\n   'sets variables\r\nemail = request.form(\"email\")\r\n   'chooses username and password from database that correspond to submitted email address.\r\nuser = objrs.Fields(\"username\")\r\npass = objrs.Fields(\"password\")\r\nSet sendmail = Server.CreateObject(\"CDONTS.NewMail\")\r\n   'put the webmaster address here\r\nsendmail.From = \"webmaster@yoursite.com\"\r\n   'The mail is sent to the address entered in the previous page.\r\nsendmail.To = email\r\n   'Enter the subject of your mail here\r\nsendmail.Subject = \"The Login Information You Requested\"\r\n   'This is the content of thr message.\r\nsendmail.Body = \"The login Information you requested.\" & vbCrlf & vbCrlf _\r\n& \"Username=\" & user & vbCrlf _\r\n& \"Password=\" & pass & vbCrlf\r\n   'this sets mail priority.... 0=low 1=normal 2=high\r\nsendmail.Importance = 2\r\nsendmail.Send\r\n%>\r\n\r\nYour login information has been mailed to <%=email%>.<br>\r\nYou should receive it shortly.\r\n<%\r\n   ' Close Data Access Objects and free DB variables\r\n\tobjDC.Close\r\n\tSet objRS =  Nothing\r\n\tSet objDC = Nothing\r\n\tSet sendmail = Nothing\r\n%>\r\n<%end if%>","Declares":"","CodeCategory":{"CategoryId":"2","CategoryDescription":"Web"},"Keywords":["EMail"]},{"RecordId":"427","Title":"Pick/Fling List (Add/Remove List Box Pairs)","Description":"HTML page that demonstrates how to implement a pick/fling (add/remove) pair of list boxes where items can be added from one to the other.","Code":"<HTML>\r\n<HEAD>\r\n<TITLE>Pick Fling List Test</TITLE>\r\n\r\n<style type=\"text/css\">\r\n  TD {font-family: Verdana,Arial;\r\n      font-size: 10pt;\r\n     }\r\n  TH {font-family: Verdana,Arial;\r\n      font-size: 10pt;\r\n     }\r\n</style>\r\n\r\n<script language=\"JavaScript\">\r\nvar ie4 = (document.all) ? 1 : 0;\r\n\r\nfunction cmdAdd_onClick()\r\n{\r\n  var elOption;\r\n  var source;\r\n  var target;\r\n  var store;\r\n  var count = 0;\r\n  var i = 0;\r\n  var str = \"\";\r\n  \r\n  source = document.frmPick.lstSource;\r\n  target = document.frmPick.lstTarget;\r\n  store = document.frmPick.txtSelected;\r\n  count = source.options.length;\r\n  \r\n  if (ie4)\r\n  {\r\n    for (i=count-1; i >=0; i--)\r\n    {\r\n      if (source.options[i].selected)\r\n      {\r\n        elOption = document.createElement(\"OPTION\");\r\n        elOption.value = source.options[i].value;\r\n        elOption.text = source.options[i].text;\r\n        target.add(elOption);\r\n        source.remove(i);\r\n      }\r\n    }\r\n  }\r\n  else\r\n  {\r\n    for (i=count-1; i>0; i--)\r\n    {\r\n      if (source.options[i].selected)\r\n      {\r\n        elOption = new Option(source.options[i].text, source.options[i].value);\r\n        target.options[target.options.length] = elOption;\r\n        source.options[i] = null;\r\n      }\r\n    }\r\n  }\r\n\r\n  count = target.options.length;\r\n  for (i=0; i<count; i++)\r\n  {\r\n\tif (i > 0)\r\n\t\tstr += \",\";\r\n\tstr += target.options[i].value;\r\n  }\r\n  store.value = str;\r\n}\r\n\r\nfunction cmdRemove_onClick()\r\n{\r\n  var elOption;\r\n  var source;\r\n  var target;\r\n  var store;\r\n  var count = 0;\r\n  var i = 0;\r\n  var str = \"\";\r\n  \r\n  source = document.frmPick.lstTarget;\r\n  target = document.frmPick.lstSource;\r\n  store = document.frmPick.txtSelected;\r\n  count = source.options.length;\r\n  \r\n  if (ie4)\r\n  {\r\n\tfor (i=count-1; i >=0; i--)\r\n\t{\r\n\t  if (source.options[i].selected)\r\n\t  {\r\n\t    elOption = document.createElement(\"OPTION\");\r\n\t    elOption.value = source.options[i].value;\r\n\t    elOption.text = source.options[i].text;\r\n\t    target.add(elOption);\r\n            source.remove(i);\r\n\t  }\r\n\t}\r\n  }\r\n  else\r\n  {\r\n    for (i=count-1; i>0; i--)\r\n    {\r\n      if (source.options[i].selected)\r\n      {\r\n        elOption = new Option(source.options[i].text, source.options[i].value);\r\n        target.options[target.options.length] = elOption;\r\n        source.options[i] = null;\r\n      }\r\n    }\r\n  }\r\n\r\n  count = source.options.length;\r\n  for (i=0; i<count; i++)\r\n  {\r\n\tif (i > 0)\r\n\t\tstr += \",\";\r\n\tstr += target.options[i].value;\r\n  }\r\n  store.value = str;\r\n}\r\n\r\n</script>\r\n</HEAD>\r\n<BODY>\r\n<form name=\"frmPick\" method=\"GET\" action=\"some.asp\">\r\n<table>\r\n  <tr>\r\n    <th>Source</th>\r\n    <th>&nbsp;</th>\r\n    <th class=\"label\">Target</th>\r\n  </tr>\r\n  <tr>\r\n    <td valign=\"top\">\r\n      <select name=\"lstSource\" size=\"6\" multiple width=\"150\">\r\n        <option value=\"1\">Item #1</option>\r\n        <option value=\"2\">Item #2</option>\r\n        <option value=\"3\">Item #3</option>\r\n        <option value=\"4\">Item #4</option>\r\n        <option value=\"5\">Item #5</option>\r\n      </select>\r\n    </td>\r\n    <td align=\"center\">\r\n\t  <input type=\"button\" onClick=\"cmdAdd_onClick();\" name=\"cmdAdd\" value=\"Add >\"><br><br>\r\n\t  <input type=\"button\" onClick=\"cmdRemove_onClick();\" name=\"cmdRemove\" value=\"&lt;&nbsp;Remove\">\r\n\t</td>\r\n\t<td valign=\"top\">\r\n\t  <select name=\"lstTarget\" size=\"6\" multiple width=\"150\">\r\n\t  \r\n      </select>\r\n    </td>\r\n  </tr>\r\n</table>\r\n<input type=\"hidden\" name=\"txtSelected\">\r\n</form>\r\n</BODY>\r\n</HTML>","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["Pick/Fling","Add/Remove","List Box"]},{"RecordId":"428","Title":"Using XMLHttpRequest to Post a Web Page","Description":"Demostrates how to use XMLHttpRequest to call an ASP from client side script and pass XML DOM.","Code":"The XMLHttpRequest object provides client-side protocol support for communication with HTTP servers. A client computer can use the XMLHttpRequest object (Microsoft.XMLHTTP) to send an HTTP request, to receive the response, and to have the Microsoft XML Document Object Model (XML DOM) parse that response. \r\n\r\nThis object is integrated with Microsoft's XML to support sending the request body directly from, and parsing the response directly into, the Microsoft XML DOM objects. This object allows us to post XML from a client application to an ASP page. \r\n\r\nHere is a client-side JScript code that shows how we can use this object. In this example, we initialize a request with the open method, specifying the HTTP method to use and the URL to connect to. We then use the send method to send the contents of the XML data island to the designated URL. \r\n\r\n\r\n<SCRIPT LANGUAGE=\"JScript\">\r\nfunction SendXmlOverHttp()\r\n{\r\n    var objXmlHttp;\r\n\r\n    objXmlHttp = new ActiveXObject(\"Microsoft.XMLHTTP\");\r\n    objXmlHttp.open(\"POST\", \"SampleAspPage.asp\", false);\r\n    objXmlHttp.send(\"<XML><Employee>Deepak Pant</Employee></XML>\");\r\n}\r\n</SCRIPT>","Declares":"","CodeCategory":{"CategoryId":"8","CategoryDescription":"XML"},"Keywords":["XML","HttpPost"]},{"RecordId":"429","Title":"Disable Password Caching in IE","Description":"Disable caching of passwords in IE","Code":"To disable password caching, create a DisablePasswordCaching value in the following registry key: \r\n\r\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings \r\nSet the data value of the new DisablePasswordCaching value to 0x00000001.\r\n\r\nPassword caching can also be disabled by using the Microsoft Internet Explorer Administration Kit to create an executable file and attach it as an add-on component. When you use this method, the addition to the registry is made during the installation process.\r\n\r\nNOTE: In some cases it may be useful to create a custom .adm file which modifies this registry key and then import it into the IEAK Wizard. Also, if you are attempting to disable password caching for forms input boxes (also known as Autocomplete), you can disable this option by changing the following registry key: \r\nHKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\Main \r\nSet the data of the FormSuggest Passwords string value to no. \r\n","Declares":"","CodeCategory":{"CategoryId":"2","CategoryDescription":"Web"},"Keywords":["IE","Password Caching"]},{"RecordId":"430","Title":"Response.Redirect to Display Images","Description":"Demonstrates how to use an ASP to dynamically display images using Response.Redirect.","Code":"First create an ASP page that is responsible for choosing what dynamic image needs to be displayed.  Assume that we have a directory named /PictureOfTheDay that contains a number of pictures in the format YYYYMMDD.gif, each representing a picture for a particular day.  For example, May 25th, 2000's \"Picture of the Day\" would be represented by the file: /PictureOfTheDay/20000525.gif.   Assume that this ASP page, which is responsible for selecting what picture to display, is named /scripts/ShowPictureOfTheDay.asp.\r\n\r\nNote that this ASP page that is responsible for displaying a dynamic image could perform any type of processing.  For example, if we wanted to show a random picture from a directory of pictures, we could use the FileSystemObject to randomly select an image.\r\n\r\nThe code for selecting the proper filename for the \"Picture of the Day\" is quite simple, and can be seen below:\r\n\r\n<% @LANGUAGE=\"VBScript\" %>\r\n<% Option Explicit %>\r\n<%\r\n  'The filename of the Picture of the Day\r\n  Dim strFileName\r\n  strFileName = \"/PictureOfTheDay/\" & Year(Date())\r\n\r\n  If Month(Date()) < 10 then\r\n    strFileName = strFileName & \"0\" & Month(Date())\r\n  Else\r\n    strFileName = strFileName & Month(Date())\r\n  End If\r\n\r\n  If Day(Date()) < 10 then\r\n    strFileName = strFileName & \"0\" & Day(Date())\r\n  Else\r\n    strFileName = strFileName & Day(Date())\r\n  End If\r\n\r\n  strFileName = strFileName & \".gif\"\r\n\r\n  Response.Redirect strFileName\r\n%>\r\n\r\nNote the Response.Redirect to the filename as the last line of code in /scripts/ShowPictureOfTheDay.asp.  Whatever image you need to dynamically display (be it a banner ad, a \"Picture of the Day,\" or a random image), you will always want a Response.Redirect at the end pointing to the image to display.\r\n\r\nNow, to display this dynamic \"Picture of the Day\" image from any page (either a static or dynamic page), simply use the IMG HTML tag like so:\r\n\r\n\t<IMG SRC=\"/scripts/ShowPictureOfTheDay.asp\">","Declares":"","CodeCategory":{"CategoryId":"5","CategoryDescription":"ASP"},"Keywords":["Dynamic Image","Response.Redirect"]},{"RecordId":"431","Title":"Password Protection","Description":"Forces the password entry box when a page loads","Code":"<%\r\nauthUser = TRIM( Request.ServerVariables(\"AUTH_USER\"))\r\nIF authUser = \"\" THEN\r\n  Response.Status = \"401 Not Authorized\"\r\n  Response.AddHeader \"WWW-Authenticate\", \"Basic Realm=\"\"SUPEREXPERT\"\"\"\r\n  Response.End\r\nEND IF\r\n%>\r\n\r\n<html>\r\n\r\n<head><title>Password Please</title></head>\r\n\r\n<body>\r\n\t<font face=\"Arial\" size=\"4\" color=\"blue\">\r\n\t\t<b>Welcome <%=authUser%>!<br>Feel free to view this page.</b>\r\n\t</font>\r\n</body>\r\n</html>","Declares":"","CodeCategory":{"CategoryId":"2","CategoryDescription":"Web"},"Keywords":["Password","Authentication"]},{"RecordId":"432","Title":"Create Word Document On The Fly","Description":"Demonstrates how to use ContentType to make the browser open a word document with text loaded into the document.","Code":"You can use the ContentType property to control the HTTP Content-Type header.  This header is used to specify the Media Type of the file being sent.  For example, you can use the ContentType property to send Microsoft Word documents, Microsoft Excel Spreadsheets, GIF or JPEG images, or just about any other type of file that you can think of. \r\n\r\nMedia Types are registered at IANA.\r\n\r\nThe following script shows how you can use the ContentType property to dynamically create a Microsoft Word document: \r\n\r\n<%\r\nResponse.ContentType = \"application/msword\"\r\nResponse.AddHeader \"content-disposition\", \"attachment; filename=\"\"fname.rtf\"\"\"\r\n%>\r\nHello World from Microsoft Word!","Declares":"","CodeCategory":{"CategoryId":"2","CategoryDescription":"Web"},"Keywords":["ContentType","Word"]},{"RecordId":"433","Title":"Don't Run Code Unless Document is Loaded","Description":"Demonstrates how to delay running code until the page is completely loaded","Code":"&lt;body onLoad=&quot;window.loaded=true;&quot;&gt;\r\n&lt;form&gt;\r\n  &lt;input type=&quot;button&quot; value=&quot;Press me&quot; onClick=&quot;if(window.loaded != true) return; doit();&quot;&gt;\r\n&lt;/form&gt;\r\n&lt;/body&gt;\r\n","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["Load","PageLoad","OnLoad"]},{"RecordId":"434","Title":"Trim a String With Regular Expressions","Description":"Uses Regular Expressions to trim leading and trailing whitespace from a string.","Code":"function trim(strStringIn) {\r\n    return strStringIn.replace(/(^\\s*)|(\\s*$)/g, \"\");\r\n}","Declares":"","CodeCategory":{"CategoryId":"15","CategoryDescription":"Regular Expressions"},"Keywords":["Trim"]},{"RecordId":"435","Title":"Display Icon in IE Address Bar","Description":"Demonstrates how to place in icon (.ico) in the address bar of IE.","Code":"IE-5 allows for the placement of an image in the address bar.  The image that you'll ultimately be displaying as a shortcut on a PC will have the arrow in the lower left hand corner and will be displayed much smaller in the address bar than in the image editor you choose.  The image must be in .ico (Windows Icon) format.\r\n\r\nAdd the following within the HEAD tags on your document:\r\n\r\n<head>\r\n<LINK REL=\"SHORTCUT ICON\" HREF=\"http://www.your-url.com/name of file.ico\">\r\n</head>\r\n\r\nThe working script at CodeAve.com looks like this\r\n<LINK REL=\"SHORTCUT ICON\" HREF=\"http://www.codeave.com/codeave.ico\">\r\n\r\nImages typically do not show up in the address bar until a page from that url has been saved locally on your PC and sometimes do not appear until after re-start, so be wary when creating your .ico\r\n\r\n\r\n\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"2","CategoryDescription":"Web"},"Keywords":["Icon","Address Bar"]},{"RecordId":"436","Title":"Write ADO 2.5 Recordset Directly to Response Obj","Description":"Example of how to write an ADO 2.5 recordset directly to the response object using XML","Code":"In IIS 5.0 (available with Windows 2000 Server), ADO Recordset objects can be directly persisted to or from the ASP Response and Request objects. Use ASP on Web servers to dynamically generate XML from ADO Recordsets. The following example shows how this can be done:\r\n\r\n<%@ codepage=\"65001\" %>\r\n\r\n<object id=\"rstCustomers\" progid=\"ADODB.Recordset\" runat=\"Server\">\r\n</object>\r\n\r\n<!--metadata name=\"Microsoft ActiveX Data Objects 2.5 Library\" \r\ntype=\"TypeLib\" uuid=\"{00000205-0000-0010-8000-00AA006D2EA4}\"-->\r\n\r\n<%\r\n    Option Explicit\r\n    Dim strSQL, strConnection\r\n    Response.ContentType = \"text/xml\"\r\n    \r\n    strSQL = \"SELECT CustomerID, CompanyName, ContactName FROM Customers ORDER By CompanyName\"\r\n    strConnection = \"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=\" & Server.MapPath(\"NWind.mdb\")\r\n\r\n    rstCustomers.CursorLocation = adUseClient  \r\n    rstCustomers.Open strSQL, strConnection, adOpenStatic, adLockOptimistic\r\n    \r\n    Response.Write \"<?xml version=\"1.0\" encoding=\"ISO-8859-1\"?>\" & vbCRLF\r\n    rstCustomers.save response, adPersistXML\r\n    rstCustomers.Close\r\n%>\r\n\r\nAs shown, the Recordset can be directly saved to the ASP Response object, thereby avoiding any expensive disk I/O operations. When this ASP page is opened in a users browser, the XML representing the ADO Recordset is sent and displayed directly in the browser. ASP has extended its response object to expose an IStream interface directly over the buffered stream.","Declares":"","CodeCategory":{"CategoryId":"5","CategoryDescription":"ASP"},"Keywords":["ADO","Response","XML"]},{"RecordId":"437","Title":"Passing XML Objects Between Client and Server","Description":"Demonstrates how to post XML data using XMLHTTP from a form to an ASP.","Code":"'----------------------------------------------------------------------------------------\r\n' This is the XML document that resides on the server\r\n' that gets updated.  (Customers.xml)\r\n'----------------------------------------------------------------------------------------\r\n<customers>\r\n\t<customer>\r\n\t\t<name>Luanne Vincent</name>\r\n\t\t<relation>Cousin</relation>\r\n\t\t<class>No Vision</class>\r\n\t</customer>\r\n\t<customer>\r\n\t\t<name>Mertle Matthews</name>\r\n\t\t<relation>Grandmother</relation>\r\n\t\t<class>No Vision</class>\r\n\t</customer>\r\n\t<customer>\r\n\t\t<name>Uncle Bud</name>\r\n\t\t<relation>Second Cousin</relation>\r\n\t\t<class>Dupe</class>\r\n\t</customer>\r\n\t<customer>\r\n\t\t<name>Cleo Heinemann</name>\r\n\t\t<relation>Nephew</relation>\r\n\t\t<class>Will Bite</class>\r\n\t</customer>\r\n</customers>\r\n\r\n'----------------------------------------------------------------------------------------\r\n' This is the posting html page\r\n'----------------------------------------------------------------------------------------\r\n<HTML>\r\n<BODY>\r\n\r\n<XML ID=\"template\">\r\n <customer>\r\n  <name/>\r\n  <relation/>\r\n  <class/>\r\n </customer>\r\n</XML>\r\n\r\n<SCRIPT>\r\nfunction submitInfo()   {\r\n var httpOb = new ActiveXObject(\"Microsoft.XMLHTTP\");\r\n\r\n httpOb.Open(\"POST\",\"http://per2devl064/extremertm/postCust.asp\", false);\r\n var customer = template.XMLDocument.documentElement;\r\n\r\n customer.childNodes.item(0).text = custName.value;\r\n customer.childNodes.item(1).text = custRelation.value;\r\n customer.childNodes.item(2).text = custClass.value;\r\n\r\n httpOb.send(template.XMLDocument);\r\n}\r\n</SCRIPT>\r\n\r\n<H1>Customer x List Builder</H1>\r\n<P>Enter Customer Name: <INPUT TYPE=TEXT NAME=custName><BR>\r\n      Enter Relation to Self: <INPUT TYPE=TEXT NAME=custRelation><BR>\r\n      Select Customer Classification: \r\n<SELECT NAME=\"custClass\" SIZE=1>\r\n  <OPTION SELECTED VALUE=\"No Vision\">No Vision</OPTION>\r\n  <OPTION VALUE=\"Will Bite\">Will Bite</OPTION>\r\n  <OPTION VALUE=\"Dupe\">Dupe</OPTION>\r\n</SELECT><BR>\r\n<INPUT TYPE=button Value=\"Post Customer Information\" onclick=\"submitInfo()\">\r\n</BODY>\r\n</HTML>\r\n\r\n'----------------------------------------------------------------------------------------\r\n' This is the ASP that gets called to update the XML document\r\n'----------------------------------------------------------------------------------------\r\n<%@LANGUAGE=VBScript%>\r\n<%\r\n\r\nSet NEWCUSTINFO = Server.CreateObject(\"Microsoft.XMLDOM\")\r\nSet CUSTLIST = Server.CreateObject(\"Microsoft.XMLDOM\")\r\n\r\nNEWCUSTINFO.async=false\r\nNEWCUSTINFO.load(Request)\r\n\r\nCUSTLIST.async = false\r\nCUSTLIST.load(Server.MapPath(\"customers.xml\"))\r\n \r\nSet CUSTROOT = CUSTLIST.documentElement\r\nSet CUSTOMERS = CUSTROOT.childNodes\r\nSet NEWCUSTROOT = NEWCUSTINFO.documentElement\r\nQUERY = \"./customer[name='\" & NEWCUSTROOT.childNodes.item(0).text & \"']\"\r\n\r\nSet CUSTDUP = CUSTROOT.selectSingleNode(QUERY)\r\n\r\nIf isNull(CUSTDUP) = False Then\r\n  CUSTROOT.removeChild(CUSTDUP)\r\nEnd If\r\n\r\nCUSTROOT.appendChild(NEWCUSTROOT)\r\nCUSTLIST.save(Server.MapPath(\"customers.xml\"))\r\n\r\n%>\r\n","Declares":"","CodeCategory":{"CategoryId":"8","CategoryDescription":"XML"},"Keywords":["XMLHTTP","XML","Post"]},{"RecordId":"438","Title":"Country Selection","Description":"Country Selection combo","Code":"<select name=\"txtCountry1\" size=\"1\">\r\n     <option value=\" \" selected>&nbsp;</option>\r\n     <option value=\"USA\">USA</option>  \r\n     <option value=\"Other\">---Other---</option>\r\n     <option value=\"Afghanistan\">Afghanistan</option>\r\n     <option value=\"Albania\">Albania</option>\r\n     <option value=\"Algeria\">Algeria</option>\r\n     <option value=\"American Samoa\">American Samoa</option>\r\n     <option value=\"Andorra\">Andorra</option>\r\n     <option value=\"Angola\">Angola</option>\r\n     <option value=\"Anguilla\">Anguilla</option>\r\n     <option value=\"Antigua\">Antigua</option>\r\n     <option value=\"Argentina\">Argentina</option>\r\n     <option value=\"Armenia\">Armenia</option>\r\n     <option value=\"Aruba\">Aruba</option>\r\n     <option value=\"Ascension Island\">Ascension Island</option>\r\n     <option value=\"Australia\">Australia</option>\r\n     <option value=\"Australian Antarctic Territory\">Australian Antarctic Territory</option>\r\n     <option value=\"Austria\">Austria</option>\r\n     <option value=\"Azerbaijan\">Azerbaijan</option>\r\n     <option value=\"Bahamas\">Bahamas</option>\r\n     <option value=\"Bahrain\">Bahrain</option>\r\n     <option value=\"Bangladesh\">Bangladesh</option>\r\n     <option value=\"Barbados\">Barbados</option>\r\n     <option value=\"Barbuda\">Barbuda</option>\r\n     <option value=\"Belarus\">Belarus</option>\r\n     <option value=\"Belgium\">Belgium</option>\r\n     <option value=\"Belize\">Belize</option>\r\n     <option value=\"Benin\">Benin</option>\r\n     <option value=\"Bermuda\">Bermuda</option>\r\n     <option value=\"Bhutan\">Bhutan</option>\r\n     <option value=\"Bolivia\">Bolivia</option>\r\n     <option value=\"Bosnia and Herzegovina\">Bosnia and Herzegovina</option>\r\n     <option value=\"Botswana\">Botswana</option>\r\n     <option value=\"Brazil\">Brazil</option>\r\n     <option value=\"British Virgin Islands\">British Virgin Islands</option>\r\n     <option value=\"Brunei\">Brunei</option>\r\n     <option value=\"Bulgaria\">Bulgaria</option>\r\n     <option value=\"Burkina Faso\">Burkina Faso</option>\r\n     <option value=\"Burundi\">Burundi</option>\r\n     <option value=\"Cambodia\">Cambodia</option>\r\n     <option value=\"Cameroon\">Cameroon</option>\r\n     <option value=\"Canada\">Canada</option>\r\n     <option value=\"Cape Verde Islands\">Cape Verde Islands</option>\r\n     <option value=\"Cayman Islands\">Cayman Islands</option>\r\n     <option value=\"Central African Republic\">Central African Republic</option>\r\n     <option value=\"Chad\">Chad</option>\r\n     <option value=\"Chile\">Chile</option>\r\n     <option value=\"China\">China</option>\r\n     <option value=\"Christmas Island\">Christmas Island</option>\r\n     <option value=\"Cocos-Keeling Islands\">Cocos-Keeling Islands</option>\r\n     <option value=\"Colombia\">Colombia</option>\r\n     <option value=\"Comoros\">Comoros</option>\r\n     <option value=\"Congo\">Congo</option>\r\n     <option value=\"Cook Islands\">Cook Islands</option>\r\n     <option value=\"Costa Rica\">Costa Rica</option>\r\n     <option value=\"Croatia\">Croatia</option>\r\n     <option value=\"Cuba\">Cuba</option>\r\n     <option value=\"Cyprus\">Cyprus</option>\r\n     <option value=\"Czech Republic\">Czech Republic</option>\r\n     <option value=\"Denmark\">Denmark</option>\r\n     <option value=\"Diego Garcia\">Diego Garcia</option>\r\n     <option value=\"Djibouti\">Djibouti</option>\r\n     <option value=\"Dominica\">Dominica</option>\r\n     <option value=\"Dominican Republic\">Dominican Republic</option>\r\n     <option value=\"Ecuador\">Ecuador</option>\r\n     <option value=\"Egypt\">Egypt</option>\r\n     <option value=\"El Salvador\">El Salvador</option>\r\n     <option value=\"Equatorial Guinea\">Equatorial Guinea</option>\r\n     <option value=\"Eritrea\">Eritrea</option>\r\n     <option value=\"Estonia\">Estonia</option>\r\n     <option value=\"Ethiopia\">Ethiopia</option>\r\n     <option value=\"Faeroe Islands\">Faeroe Islands</option>\r\n     <option value=\"Falkland Islands\">Falkland Islands</option>\r\n     <option value=\"Fiji Islands\">Fiji Islands</option>\r\n     <option value=\"Finland\">Finland</option>\r\n     <option value=\"France\">France</option>\r\n     <option value=\"French Antilles\">French Antilles</option>\r\n     <option value=\"French Guiana\">French Guiana</option>\r\n     <option value=\"French Polynesia\">French Polynesia</option>\r\n     <option value=\"Gabon\">Gabon</option>\r\n     <option value=\"Gambia\">Gambia</option>\r\n     <option value=\"Georgia\">Georgia</option>\r\n     <option value=\"Germany\">Germany</option>\r\n     <option value=\"Ghana\">Ghana</option>\r\n     <option value=\"Gibraltar\">Gibraltar</option>\r\n     <option value=\"Greece\">Greece</option>\r\n     <option value=\"Greenland\">Greenland</option>\r\n     <option value=\"Grenada\">Grenada</option>\r\n     <option value=\"Guadeloupe\">Guadeloupe</option>\r\n     <option value=\"Guam\">Guam</option>\r\n     <option value=\"Guantanamo Bay\">Guantanamo Bay</option>\r\n     <option value=\"Guatemala\">Guatemala</option>\r\n     <option value=\"Guinea\">Guinea</option>\r\n     <option value=\"Guinea-Bissau\">Guinea-Bissau</option>\r\n     <option value=\"Guyana\">Guyana</option>\r\n     <option value=\"Haiti\">Haiti</option>\r\n     <option value=\"Honduras\">Honduras</option>\r\n     <option value=\"Hong Kong\">Hong Kong</option>\r\n     <option value=\"Hungary\">Hungary</option>\r\n     <option value=\"Iceland\">Iceland</option>\r\n     <option value=\"India\">India</option>\r\n     <option value=\"Indonesia\">Indonesia</option>\r\n     <option value=\"Iran\">Iran</option>\r\n     <option value=\"Iraq\">Iraq</option>\r\n     <option value=\"Ireland\">Ireland</option>\r\n     <option value=\"Israel\">Israel</option>\r\n     <option value=\"Italy\">Italy</option>\r\n     <option value=\"Ivory Coast\">Ivory Coast</option>\r\n     <option value=\"Jamaica\">Jamaica</option>\r\n     <option value=\"Japan\">Japan</option>\r\n     <option value=\"Jordan\">Jordan</option>\r\n     <option value=\"Kazakhstan\">Kazakhstan</option>\r\n     <option value=\"Kenya\">Kenya</option>\r\n     <option value=\"Kiribati Republic\">Kiribati Republic</option>\r\n     <option value=\"Korea (North)\">Korea (North)</option>\r\n     <option value=\"Korea (Republic of)\">Korea (Republic of)</option>\r\n     <option value=\"Kuwait\">Kuwait</option>\r\n     <option value=\"Kyrgyz Republic\">Kyrgyz Republic</option>\r\n     <option value=\"Laos\">Laos</option>\r\n     <option value=\"Latvia\">Latvia</option>\r\n     <option value=\"Lebanon\">Lebanon</option>\r\n     <option value=\"Lesotho\">Lesotho</option>\r\n     <option value=\"Liberia\">Liberia</option>\r\n     <option value=\"Libya\">Libya</option>\r\n     <option value=\"Liechtenstein\">Liechtenstein</option>\r\n     <option value=\"Lithuania\">Lithuania</option>\r\n     <option value=\"Luxembourg\">Luxembourg</option>\r\n     <option value=\"Macau\">Macau</option>\r\n     <option value=\"Madagascar\">Madagascar</option>\r\n     <option value=\"Malawi\">Malawi</option>\r\n     <option value=\"Malaysia\">Malaysia</option>\r\n     <option value=\"Maldives\">Maldives</option>\r\n     <option value=\"Mali\">Mali</option>\r\n     <option value=\"Malta\">Malta</option>\r\n     <option value=\"Marshall Islands\">Marshall Islands</option>\r\n     <option value=\"Martinique\">Martinique</option>\r\n     <option value=\"Mauritania\">Mauritania</option>\r\n     <option value=\"Mauritius\">Mauritius</option>\r\n     <option value=\"Mayotte Island\">Mayotte Island</option>\r\n     <option value=\"Mexico\">Mexico</option>\r\n     <option value=\"Moldova\">Moldova</option>\r\n     <option value=\"Monaco\">Monaco</option>\r\n     <option value=\"Mongolia\">Mongolia</option>\r\n     <option value=\"Montserrat\">Montserrat</option>\r\n     <option value=\"Morocco\">Morocco</option>\r\n     <option value=\"Mozambique\">Mozambique</option>\r\n     <option value=\"Myanmar\">Myanmar</option>\r\n     <option value=\"Namibia\">Namibia</option>\r\n     <option value=\"Nauru\">Nauru</option>\r\n     <option value=\"Nepal\">Nepal</option>\r\n     <option value=\"Netherlands\">Netherlands</option>\r\n     <option value=\"Netherlands Antilles\">Netherlands Antilles</option>\r\n     <option value=\"Nevis\">Nevis</option>\r\n     <option value=\"New Caledonia\">New Caledonia</option>\r\n     <option value=\"New Zealand\">New Zealand</option>\r\n     <option value=\"Nicaragua\">Nicaragua</option>\r\n     <option value=\"Niger\">Niger</option>\r\n     <option value=\"Nigeria\">Nigeria</option>\r\n     <option value=\"Niue\">Niue</option>\r\n     <option value=\"Norfolk Island\">Norfolk Island</option>\r\n     <option value=\"Norway\">Norway</option>\r\n     <option value=\"Oman\">Oman</option>\r\n     <option value=\"Pakistan\">Pakistan</option>\r\n     <option value=\"Palau\">Palau</option>\r\n     <option value=\"Panama\">Panama</option>\r\n     <option value=\"Papua New Guinea\">Papua New Guinea</option>\r\n     <option value=\"Paraguay\">Paraguay</option>\r\n     <option value=\"Peru\">Peru</option>\r\n     <option value=\"Philippines\">Philippines</option>\r\n     <option value=\"Poland\">Poland</option>\r\n     <option value=\"Portugal\">Portugal</option>\r\n     <option value=\"Puerto Rico\">Puerto Rico</option>\r\n     <option value=\"Qatar\">Qatar</option>\r\n     <option value=\"Reunion Island\">Reunion Island</option>\r\n     <option value=\"Romania\">Romania</option>\r\n     <option value=\"Rota Island\">Rota Island</option>\r\n     <option value=\"Russia\">Russia</option>\r\n     <option value=\"Rwanda\">Rwanda</option>\r\n     <option value=\"Saint Lucia\">Saint Lucia</option>\r\n     <option value=\"Saipan Island\">Saipan Island</option>\r\n     <option value=\"San Marino\">San Marino</option>\r\n     <option value=\"Sao Tome and Principe\">Sao Tome and Principe</option>\r\n     <option value=\"Saudi Arabia\">Saudi Arabia</option>\r\n     <option value=\"Senegal Republic\">Senegal Republic</option>\r\n     <option value=\"Seychelle Islands\">Seychelle Islands</option>\r\n     <option value=\"Sierra Leone\">Sierra Leone</option>\r\n     <option value=\"Singapore\">Singapore</option>\r\n     <option value=\"Slovak Republic\">Slovak Republic</option>\r\n     <option value=\"Slovenia\">Slovenia</option>\r\n     <option value=\"Solomon Islands\">Solomon Islands</option>\r\n     <option value=\"Somalia\">Somalia</option>\r\n     <option value=\"South Africa\">South Africa</option>\r\n     <option value=\"Spain\">Spain</option>\r\n     <option value=\"Sri Lanka\">Sri Lanka</option>\r\n     <option value=\"St. Helena\">St. Helena</option>\r\n     <option value=\"St. Kitts\">St. Kitts</option>\r\n     <option value=\"St. Pierre and Miquelon\">St. Pierre and Miquelon</option>\r\n     <option value=\"Sudan\">Sudan</option>\r\n     <option value=\"Suriname\">Suriname</option>\r\n     <option value=\"Swaziland\">Swaziland</option>\r\n     <option value=\"Sweden\">Sweden</option>\r\n     <option value=\"Switzerland\">Switzerland</option>\r\n     <option value=\"Syria\">Syria</option>\r\n     <option value=\"Taiwan, Republic of China\">Taiwan, Republic of China</option>\r\n     <option value=\"Tajikistan\">Tajikistan</option>\r\n     <option value=\"Tanzania\">Tanzania</option>\r\n     <option value=\"Thailand\">Thailand</option>\r\n     <option value=\"Tinian Island\">Tinian Island</option>\r\n     <option value=\"Togo\">Togo</option>\r\n     <option value=\"Tokelau\">Tokelau</option>\r\n     <option value=\"Tonga\">Tonga</option>\r\n     <option value=\"Trinidad and Tobago\">Trinidad and Tobago</option>\r\n     <option value=\"Tunisia\">Tunisia</option>\r\n     <option value=\"Turkey\">Turkey</option>\r\n     <option value=\"Turkmenistan\">Turkmenistan</option>\r\n     <option value=\"Tuvalu\">Tuvalu</option>\r\n     <option value=\"Uganda\">Uganda</option>\r\n     <option value=\"Ukraine\">Ukraine</option>\r\n     <option value=\"United Arab Emirates\">United Arab Emirates</option>\r\n     <option value=\"United Kingdom\">United Kingdom</option>\r\n     <option value=\"United States Virgin Islands\">United States Virgin Islands</option>\r\n     <option value=\"Uruguay\">Uruguay</option>\r\n     <option value=\"Uzbekistan\">Uzbekistan</option>\r\n     <option value=\"Vanuatu\">Vanuatu</option>\r\n     <option value=\"Vatican City\">Vatican City</option>\r\n     <option value=\"Venezuela\">Venezuela</option>\r\n     <option value=\"Vietnam\">Vietnam</option>\r\n     <option value=\"Wallis and Futuna Islands\">Wallis and Futuna Islands</option>\r\n     <option value=\"Western Samoa\">Western Samoa</option>\r\n     <option value=\"Yemen\">Yemen</option>\r\n     <option value=\"Yugoslavia\">Yugoslavia</option>\r\n     <option value=\"Zaire\">Zaire</option>\r\n     <option value=\"Zambia\">Zambia</option>\r\n     <option value=\"Zimbabwe\">Zimbabwe </option>\r\n</select>","Declares":"","CodeCategory":{"CategoryId":"2","CategoryDescription":"Web"},"Keywords":["Country Selection"]},{"RecordId":"439","Title":"Redirect to Different Page Using HTTP Headers","Description":"Uses HTTP headers to redirect to a different page instead of Response.Redirect","Code":"<META HTTP-EQUIV=\"Refresh\" CONTENT=\"0; URL=../admin/logon.asp\">\r\n\r\nNOTE:  The \"0\" in CONTENT=\"0\" means do it with no delay.  To set a delay (such as 5 seconds), use CONTENT=\"5\".","Declares":"","CodeCategory":{"CategoryId":"2","CategoryDescription":"Web"},"Keywords":["Redirect","Response.Redirect"]},{"RecordId":"440","Title":"Prevent Page Caching","Description":"Header pragmas to prevent pages from being cached","Code":"Response.AddHeader \"expires\",\"0\"\r\nResponse.AddHeader \"pragma\", \"no-cache\"\r\nResponse.AddHeader \"cache-control\",\"private\"\r\n","Declares":"","CodeCategory":{"CategoryId":"2","CategoryDescription":"Web"},"Keywords":["Page Caching","Cache","Expire"]},{"RecordId":"441","Title":"isBlank and trim JavaScript Functions","Description":"Two string prototype functions to (1) trim a string and (2) test for blanks.","Code":"String.prototype.trim = function()\r\n{\r\n\t// Use a regular expression to replace leading and trailing \r\n\t// spaces with the empty string\r\n\treturn this.replace(/(^\\s*)|(\\s*$)/g, \"\");\r\n}\r\n\r\nString.prototype.isBlank = function()\r\n{\r\n\t// Use a regular expression to replace leading and trailing \r\n\t// spaces with the empty string and then see if what's left\r\n\t// is blank.\r\n\treturn this.trim().length == 0 ? true : false;\r\n}","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["isBlank","Trim","Prototype"]},{"RecordId":"442","Title":"Trim a String","Description":"JavaScript function to trim leading & trailing blanks from a variable","Code":"\tfunction sTrim (s) {\r\n\t\t\r\n\t\tvar sOut = \"\";\r\n\t\tvar iStart = -1;\r\n\t\tvar iEnd = -1;\t\r\n\t\t\r\n\t\t// First, search the string to find the first and last non-blank characters\r\n\t\tfor (var i = 0; i < s.length; i++) {\r\n\t\t\tvar c = s.charAt(i);\r\n\t\t\tif ((c != ' ') && (c != '\\n') && (c != '\\t')) {\r\n\t\t\t\tif (iStart == -1) iStart = i;\r\n\t\t\t\tiEnd = i;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t// Now, substring out the result\r\n\t\tif ((iStart != -1) && (iEnd != -1))\r\n\t\t\tsOut = s.substring(iStart, iEnd + 1);\r\n\t\treturn sOut;\r\n\t}","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["Trim"]},{"RecordId":"443","Title":"Select Text in a Text Box","Description":"Demonstrates how to select text (similar to VB sel.start=0, ...) in a text field.","Code":"The most useful method of the text object is the select() method. When you select a field via JavaScript, the entire text in the field is selected. Due to a bug in Internet Explorer, you must first give a focus and then a blur to a text field, before selecting it. \r\n\r\nSuch a sequence looks like this:\r\n\r\n  document.forms[0].elements[0].focus();\r\n  document.forms[0].elements[0].blur();\r\n  document.forms[0].elements[0].select();\r\n","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["Select Text","Set focus"]},{"RecordId":"444","Title":"Double Apostrophe/Quote Using Regular Expressions","Description":"The following regular expression will double up all single and double quotes.","Code":"The following regular expression will double up all single and double quotes. \r\n\r\nstrPwd = strPwd.replace(/([\\'\\\"])/g,\"$1$1\");","Declares":"","CodeCategory":{"CategoryId":"15","CategoryDescription":"Regular Expressions"},"Keywords":["Apostrophe"]},{"RecordId":"445","Title":"Filename Validation Using Regular Expressions","Description":"Demonstrates how to validate an inputted filename using Regular Expressions.","Code":"Requirements:\r\n\r\n1. One or more 0-9a-zA-Z or _ followed by\r\n2. One or more 0-9a-zA-Z, -, \\, / and _ followed by\r\n3. A period (.) followed by\r\n4. '', 'txt', 'jpg', 'jpeg', 'gif', 'htm', 'html', 'png', 'bmp', 'zip' \r\n\r\nEverything else is invalid. \r\nYou'll notice that the filename cannot start with a back slash because this is the root of the disk drive. Why would anyone other than an attacker want to start from the root of your drive? \r\nEvery attempt at file access should be relative to the root location of the Web site:\r\n\r\nvar strInput = Request.form(\"filename\");\r\nvar re = /^[\\w]{1,}[\\w\\-\\/\\\\]{1,}\\.(txt|jpg|jpeg|gif|htm|html|png|bmp|zip){0,1}$/i;\r\nvar fIsFilenameValid = (re.test(strInput)) ? true : false;","Declares":"","CodeCategory":{"CategoryId":"15","CategoryDescription":"Regular Expressions"},"Keywords":["Filename Validation","Validation"]},{"RecordId":"446","Title":"Browser Detection (Cookies, JavaScript, etc.)","Description":"Uses BrowseCap.ini to determine Tables, Frames, Java Applets, Cookies, ActiveX Controls, Brckground sounds, JavaScript and VBScript.","Code":"<%\r\n'----------------------------------------------------------------------------------------------------\r\n'  EXAMPLE USAGE\r\n'  bFrames = QueryBrowserCapability(\"Frames\")\r\n'  if bFrames = false then response.Redirect \"NoFrames.htm\"\r\n'----------------------------------------------------------------------------------------------------\r\nFunction QueryBrowserCapability(Capability)\r\n\r\ndim bAns\r\n\r\nset oBrowser = Server.CreateObject(\"MSWC.BrowserType\")\r\nSelect Case UCase(Capability)\r\n    Case \"TABLES\"\r\n        bAns = oBrowser.Tables\r\n    Case \"FRAMES\"\r\n        bAns = oBrowser.Frames\r\n    Case \"JAVA\"\r\n\tbAns = oBrowser.JavaApplets\r\n    Case \"COOKIES\"\r\n\tbAns = oBrowser.Cookies\r\n    Case \"ACTIVEXCONTROLS\"\r\n\tbAns = oBrowser.ActiveXControls\r\n    Case \"BACKGROUNDSOUNDS\"\r\n\tbAns = oBrowser.BackgroundSounds\r\n    Case \"JAVASCRIPT\"\r\n\tbAns = oBrowser.JavaScript\r\n    Case \"VBSCRIPT\"\r\n\tbAns = oBrowser.VBScript\r\n    Case Else\r\n\tbAns =  False\r\nEnd Select\r\n\r\nQueryBrowserCapability = bAns\r\nset oBrowser = Nothing\r\n\r\nEnd Function\r\n\r\n%>","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["Browser Detection","BrowseCap"]},{"RecordId":"447","Title":"Browser Detection (Ultimate)","Description":"JavaScript file to detect browsers.  Covers all of it.","Code":"<script LANGUAGE=\"JavaScript\">\r\n<!-- hide JavaScript from non-JavaScript browsers\r\n//\r\n// JavaScript Browser Sniffer\r\n// Eric Krok, Andy King, Michel Plungjan Jan. 31, 2002\r\n// see http://www.webreference.com/ for more information\r\n//\r\n// This program is free software; you can redistribute it and/or modify\r\n// it under the terms of the GNU General Public License as published by\r\n// the Free Software Foundation; either version 2 of the License, or\r\n// (at your option) any later version.\r\n//\r\n// Please send any improvements to aking@internet.com and we'll\r\n// roll the best ones in\r\n//\r\n// Adapted from Netscape's Ultimate client-side JavaScript client sniffer\r\n// and Andy King's sniffer\r\n// Revised May 7 99 to add is.nav5up and is.ie5up (see below). (see below).\r\n// Revised June 11 99 to add additional props, checks\r\n// Revised June 23 99 added screen props - gecko m6 doesn't support yet - abk\r\n//                    converted to var is_ from is object to work everywhere\r\n// 990624 - added cookie forms links frames checks - abk\r\n// 001031 - ie4 mod 5.0 -> 5. (ie5.5 mididentified - abk)\r\n//          is_ie4 mod tp work with ie6+ - abk\r\n// 001120 - ns6 released, document.layers false, put back in\r\n//        - is_nav6 test added - abk\r\n// 001121 - ns6+ added, used document.getElementById, better test, dom-compl\r\n// 010117 - actual version for ie3-5.5 by Michel Plungjan\r\n// 010118 - actual version for ns6 by Michel Plungjan\r\n// 010217 - netscape 6/mz 6 ie5.5 onload defer bug docs - abk\r\n// 011107 - added is_ie6 and is_ie6up variables - dmr\r\n// 020128 - added link to netscape's sniffer, on which this is based - abk\r\n//          updated sniffer for aol4-6, ie5mac = js1.4, TVNavigator, AOLTV,\r\n//          hotjava\r\n// 020131 - cleaned up links, added more links to example object detection\r\n// 020131 - a couple small problems with Opera detection. First, when Opera\r\n//          is set to be compatible with other browsers it will contain their\r\n//          information in the userAgent strings. Thus, to be sure we have \r\n//          Opera we should check for it before checking for the other bigs.\r\n//          (And make sure the others are !opera.) Also corrected a minor\r\n//          bug in the is_opera6up assignment.\r\n//\r\n// Everything you always wanted to know about your JavaScript client\r\n// but were afraid to ask. Creates \"is_\" variables indicating:\r\n// (1) browser vendor:\r\n//     is_nav, is_ie, is_opera\r\n// (2) browser version number:\r\n//     is_major (integer indicating major version number: 2, 3, 4 ...)\r\n//     is_minor (float   indicating full  version number: 2.02, 3.01, 4.04 ...)\r\n// (3) browser vendor AND major version number\r\n//     is_nav2, is_nav3, is_nav4, is_nav4up, is_nav5, is_nav5up, \r\n//     is_nav6, is_nav6up, is_ie3, is_ie4, is_ie4up, is_ie5up, is_ie6...\r\n// (4) JavaScript version number:\r\n//     is_js (float indicating full JavaScript version number: 1, 1.1, 1.2 ...)\r\n// (5) OS platform and version:\r\n//     is_win, is_win16, is_win32, is_win31, is_win95, is_winnt, is_win98\r\n//     is_os2\r\n//     is_mac, is_mac68k, is_macppc\r\n//     is_unix\r\n//        is_sun, is_sun4, is_sun5, is_suni86\r\n//        is_irix, is_irix5, is_irix6\r\n//        is_hpux, is_hpux9, is_hpux10\r\n//        is_aix, is_aix1, is_aix2, is_aix3, is_aix4\r\n//        is_linux, is_sco, is_unixware, is_mpras, is_reliant\r\n//        is_dec, is_sinix, is_freebsd, is_bsd\r\n//     is_vms\r\n//\r\n// Based in part on \r\n// http://www.mozilla.org/docs/web-developer/sniffer/browser_type.html\r\n// The Ultimate JavaScript Client Sniffer\r\n// and Andy King's object detection sniffer\r\n//\r\n// Note: you don't want your Nav4 or IE4 code to \"turn off\" or\r\n// stop working when Nav5 and IE5 (or later) are released, so\r\n// in conditional code forks, use is_nav4up (\"Nav4 or greater\")\r\n// and is_ie4up (\"IE4 or greater\") instead of is_nav4 or is_ie4\r\n// to check version in code which you want to work on future\r\n// versions. For DOM tests scripters commonly used the \r\n// is_getElementById test, but make sure you test your code as\r\n// filter non-compliant browsers (Opera 5-6 for example) as some \r\n// browsers return true for this test, and don't fully support\r\n// the W3C's DOM1.\r\n//\r\n\r\n    // convert all characters to lowercase to simplify testing\r\n    var agt=navigator.userAgent.toLowerCase();\r\n    var appVer = navigator.appVersion.toLowerCase();\r\n\r\n    // *** BROWSER VERSION ***\r\n\r\n    var is_minor = parseFloat(appVer);\r\n    var is_major = parseInt(is_minor);\r\n\r\n    // Note: On IE, start of appVersion return 3 or 4\r\n    // which supposedly is the version of Netscape it is compatible with.\r\n    // So we look for the real version further on in the string\r\n\r\n    var iePos  = appVer.indexOf('msie');\r\n    if (iePos !=-1) {\r\n       is_minor = parseFloat(appVer.substring(iePos+5,appVer.indexOf(';',iePos)))\r\n       is_major = parseInt(is_minor);\r\n    }\r\n\r\n    // Netscape6 is mozilla/5 + Netscape6/6.0!!!\r\n    // Mozilla/5.0 (Windows; U; Win98; en-US; m18) Gecko/20001108 Netscape6/6.0\r\n    var nav6Pos = agt.indexOf('netscape6');\r\n    if (nav6Pos !=-1) {\r\n       is_minor = parseFloat(agt.substring(nav6Pos+10))\r\n       is_major = parseInt(is_minor)\r\n    }\r\n\r\n    var is_getElementById   = (document.getElementById) ? \"true\" : \"false\"; // 001121-abk\r\n    var is_getElementsByTagName = (document.getElementsByTagName) ? \"true\" : \"false\"; // 001127-abk\r\n    var is_documentElement = (document.documentElement) ? \"true\" : \"false\"; // 001121-abk\r\n\r\n    var is_opera = (agt.indexOf(\"opera\") != -1);\r\n    var is_opera2 = (agt.indexOf(\"opera 2\") != -1 || agt.indexOf(\"opera/2\") != -1);\r\n    var is_opera3 = (agt.indexOf(\"opera 3\") != -1 || agt.indexOf(\"opera/3\") != -1);\r\n    var is_opera4 = (agt.indexOf(\"opera 4\") != -1 || agt.indexOf(\"opera/4\") != -1);\r\n    var is_opera5 = (agt.indexOf(\"opera 5\") != -1 || agt.indexOf(\"opera/5\") != -1);\r\n    var is_opera6 = (agt.indexOf(\"opera 6\") != -1 || agt.indexOf(\"opera/6\") != -1); // new 020128- abk\r\n    var is_opera5up = (is_opera && !is_opera2 && !is_opera3 && !is_opera4);\r\n    var is_opera6up = (is_opera && !is_opera2 && !is_opera3 && !is_opera4 && !is_opera5); // new020128\r\n\r\n    var is_nav  = ((agt.indexOf('mozilla')!=-1) && (agt.indexOf('spoofer')==-1)\r\n                && (agt.indexOf('compatible') == -1) && (agt.indexOf('opera')==-1)\r\n                && (agt.indexOf('webtv')==-1) && (agt.indexOf('hotjava')==-1));\r\n    var is_nav2 = (is_nav && (is_major == 2));\r\n    var is_nav3 = (is_nav && (is_major == 3));\r\n    var is_nav4 = (is_nav && (is_major == 4));\r\n    var is_nav4up = (is_nav && is_minor >= 4);  // changed to is_minor for\r\n                                                // consistency - dmr, 011001\r\n    var is_navonly      = (is_nav && ((agt.indexOf(\";nav\") != -1) ||\r\n                          (agt.indexOf(\"; nav\") != -1)) );\r\n\r\n    var is_nav6   = (is_nav && is_major==6);    // new 010118 mhp\r\n    var is_nav6up = (is_nav && is_minor >= 6) // new 010118 mhp\r\n\r\n    var is_nav5   = (is_nav && is_major == 5 && !is_nav6); // checked for ns6\r\n    var is_nav5up = (is_nav && is_minor >= 5);\r\n\r\n    var is_ie   = ((iePos!=-1) && (!is_opera));\r\n    var is_ie3  = (is_ie && (is_major < 4));\r\n\r\n    var is_ie4   = (is_ie && is_major == 4);\r\n    var is_ie4up = (is_ie && is_minor >= 4);\r\n    var is_ie5   = (is_ie && is_major == 5);\r\n    var is_ie5up = (is_ie && is_minor >= 5);\r\n    \r\n    var is_ie5_5  = (is_ie && (agt.indexOf(\"msie 5.5\") !=-1)); // 020128 new - abk\r\n    var is_ie5_5up =(is_ie && is_minor >= 5.5);                // 020128 new - abk\r\n\t\r\n    var is_ie6   = (is_ie && is_major == 6);\r\n    var is_ie6up = (is_ie && is_minor >= 6);\r\n\r\n// KNOWN BUG: On AOL4, returns false if IE3 is embedded browser\r\n    // or if this is the first browser window opened.  Thus the\r\n    // variables is_aol, is_aol3, and is_aol4 aren't 100% reliable.\r\n\r\n    var is_aol   = (agt.indexOf(\"aol\") != -1);\r\n    var is_aol3  = (is_aol && is_ie3);\r\n    var is_aol4  = (is_aol && is_ie4);\r\n    var is_aol5  = (agt.indexOf(\"aol 5\") != -1);\r\n    var is_aol6  = (agt.indexOf(\"aol 6\") != -1);\r\n\r\n    var is_webtv = (agt.indexOf(\"webtv\") != -1);\r\n    \r\n    // new 020128 - abk\r\n    \r\n    var is_TVNavigator = ((agt.indexOf(\"navio\") != -1) || (agt.indexOf(\"navio_aoltv\") != -1)); \r\n    var is_AOLTV = is_TVNavigator;\r\n\r\n    var is_hotjava = (agt.indexOf(\"hotjava\") != -1);\r\n    var is_hotjava3 = (is_hotjava && (is_major == 3));\r\n    var is_hotjava3up = (is_hotjava && (is_major >= 3));\r\n\r\n    // end new\r\n\t\r\n    // *** JAVASCRIPT VERSION CHECK ***\r\n    // Useful to workaround Nav3 bug in which Nav3\r\n    // loads <SCRIPT LANGUAGE=\"JavaScript1.2\">.\r\n    // updated 020131 by dragle\r\n    var is_js;\r\n    if (is_nav2 || is_ie3) is_js = 1.0;\r\n    else if (is_nav3) is_js = 1.1;\r\n    else if (is_opera6up) is_js = 1.4; // new 1.4? 020128 - abk\r\n    else if (is_opera5) is_js = 1.3;\r\n    else if (is_opera) is_js = 1.1;\r\n    else if ((is_nav4 && (is_minor <= 4.05)) || is_ie4) is_js = 1.2;\r\n    else if ((is_nav4 && (is_minor > 4.05)) || is_ie5) is_js = 1.3;\r\n    else if (is_nav5 && !(is_nav6)) is_js = 1.4;\r\n    else if (is_hotjava3up) is_js = 1.4; // new 020128 - abk\r\n    else if (is_nav6) is_js = 1.5;\r\n\r\n    // NOTE: In the future, update this code when newer versions of JS\r\n    // are released. For now, we try to provide some upward compatibility\r\n    // so that future versions of Nav and IE will show they are at\r\n    // *least* JS 1.x capable. Always check for JS version compatibility\r\n    // with > or >=.\r\n\r\n    else if (is_nav && (is_major > 5)) is_js = 1.4\r\n    else if (is_ie && (is_major > 5)) is_js = 1.3\r\n    \r\n    // what about ie6 and ie6up for js version? abk\r\n    \r\n    // HACK: no idea for other browsers; always check for JS version \r\n    // with > or >=\r\n    else is_js = 0.0;\r\n\t// HACK FOR IE5 MAC = js vers = 1.4 (if put inside if/else jumps out at 1.3)\r\n    if ((agt.indexOf(\"mac\")!=-1) && is_ie5up) is_js = 1.4; // 020128 - abk\r\n    \r\n    // *** PLATFORM ***\r\n    var is_win   = ( (agt.indexOf(\"win\")!=-1) || (agt.indexOf(\"16bit\")!=-1) );\r\n    // NOTE: On Opera 3.0, the userAgent string includes \"Windows 95/NT4\" on all\r\n    //        Win32, so you can't distinguish between Win95 and WinNT.\r\n    var is_win95 = ((agt.indexOf(\"win95\")!=-1) || (agt.indexOf(\"windows 95\")!=-1));\r\n\r\n    // is this a 16 bit compiled version?\r\n    var is_win16 = ((agt.indexOf(\"win16\")!=-1) ||\r\n               (agt.indexOf(\"16bit\")!=-1) || (agt.indexOf(\"windows 3.1\")!=-1) ||\r\n               (agt.indexOf(\"windows 16-bit\")!=-1) );\r\n\r\n    var is_win31 = ((agt.indexOf(\"windows 3.1\")!=-1) || (agt.indexOf(\"win16\")!=-1) ||\r\n                    (agt.indexOf(\"windows 16-bit\")!=-1));\r\n\t\r\n\tvar is_winme = ((agt.indexOf(\"win 9x 4.90\")!=-1));    // new 020128 - abk\r\n    var is_win2k = ((agt.indexOf(\"windows nt 5.0\")!=-1)); // new 020128 - abk\r\n\r\n    // NOTE: Reliable detection of Win98 may not be possible. It appears that:\r\n    //       - On Nav 4.x and before you'll get plain \"Windows\" in userAgent.\r\n    //       - On Mercury client, the 32-bit version will return \"Win98\", but\r\n    //         the 16-bit version running on Win98 will still return \"Win95\".\r\n    var is_win98 = ((agt.indexOf(\"win98\")!=-1) || (agt.indexOf(\"windows 98\")!=-1));\r\n    var is_winnt = ((agt.indexOf(\"winnt\")!=-1) || (agt.indexOf(\"windows nt\")!=-1));\r\n    var is_win32 = (is_win95 || is_winnt || is_win98 ||\r\n                    ((is_major >= 4) && (navigator.platform == \"Win32\")) ||\r\n                    (agt.indexOf(\"win32\")!=-1) || (agt.indexOf(\"32bit\")!=-1));\r\n\r\n    var is_os2   = ((agt.indexOf(\"os/2\")!=-1) ||\r\n                    (navigator.appVersion.indexOf(\"OS/2\")!=-1) ||\r\n                    (agt.indexOf(\"ibm-webexplorer\")!=-1));\r\n\r\n    var is_mac    = (agt.indexOf(\"mac\")!=-1);\r\n    var is_mac68k = (is_mac && ((agt.indexOf(\"68k\")!=-1) ||\r\n                               (agt.indexOf(\"68000\")!=-1)));\r\n    var is_macppc = (is_mac && ((agt.indexOf(\"ppc\")!=-1) ||\r\n                                (agt.indexOf(\"powerpc\")!=-1)));\r\n\r\n    var is_sun   = (agt.indexOf(\"sunos\")!=-1);\r\n    var is_sun4  = (agt.indexOf(\"sunos 4\")!=-1);\r\n    var is_sun5  = (agt.indexOf(\"sunos 5\")!=-1);\r\n    var is_suni86= (is_sun && (agt.indexOf(\"i86\")!=-1));\r\n    var is_irix  = (agt.indexOf(\"irix\") !=-1);    // SGI\r\n    var is_irix5 = (agt.indexOf(\"irix 5\") !=-1);\r\n    var is_irix6 = ((agt.indexOf(\"irix 6\") !=-1) || (agt.indexOf(\"irix6\") !=-1));\r\n    var is_hpux  = (agt.indexOf(\"hp-ux\")!=-1);\r\n    var is_hpux9 = (is_hpux && (agt.indexOf(\"09.\")!=-1));\r\n    var is_hpux10= (is_hpux && (agt.indexOf(\"10.\")!=-1));\r\n    var is_aix   = (agt.indexOf(\"aix\") !=-1);      // IBM\r\n    var is_aix1  = (agt.indexOf(\"aix 1\") !=-1);\r\n    var is_aix2  = (agt.indexOf(\"aix 2\") !=-1);\r\n    var is_aix3  = (agt.indexOf(\"aix 3\") !=-1);\r\n    var is_aix4  = (agt.indexOf(\"aix 4\") !=-1);\r\n    var is_linux = (agt.indexOf(\"inux\")!=-1);\r\n    var is_sco   = (agt.indexOf(\"sco\")!=-1) || (agt.indexOf(\"unix_sv\")!=-1);\r\n    var is_unixware = (agt.indexOf(\"unix_system_v\")!=-1);\r\n    var is_mpras    = (agt.indexOf(\"ncr\")!=-1);\r\n    var is_reliant  = (agt.indexOf(\"reliantunix\")!=-1);\r\n    var is_dec   = ((agt.indexOf(\"dec\")!=-1) || (agt.indexOf(\"osf1\")!=-1) ||\r\n           (agt.indexOf(\"dec_alpha\")!=-1) || (agt.indexOf(\"alphaserver\")!=-1) ||\r\n           (agt.indexOf(\"ultrix\")!=-1) || (agt.indexOf(\"alphastation\")!=-1));\r\n    var is_sinix = (agt.indexOf(\"sinix\")!=-1);\r\n    var is_freebsd = (agt.indexOf(\"freebsd\")!=-1);\r\n    var is_bsd = (agt.indexOf(\"bsd\")!=-1);\r\n    var is_unix  = ((agt.indexOf(\"x11\")!=-1) || is_sun || is_irix || is_hpux ||\r\n                 is_sco ||is_unixware || is_mpras || is_reliant ||\r\n                 is_dec || is_sinix || is_aix || is_linux || is_bsd || is_freebsd);\r\n\r\n    var is_vms   = ((agt.indexOf(\"vax\")!=-1) || (agt.indexOf(\"openvms\")!=-1));\r\n// additional checks, abk\r\n\tvar is_anchors = (document.anchors) ? \"true\":\"false\";\r\n\tvar is_regexp = (window.RegExp) ? \"true\":\"false\";\r\n\tvar is_option = (window.Option) ? \"true\":\"false\";\r\n\tvar is_all = (document.all) ? \"true\":\"false\";\r\n// cookies - 990624 - abk\r\n\tdocument.cookie = \"cookies=true\";\r\n\tvar is_cookie = (document.cookie) ? \"true\" : \"false\";\r\n\tvar is_images = (document.images) ? \"true\":\"false\";\r\n\tvar is_layers = (document.layers) ? \"true\":\"false\"; // gecko m7 bug?\r\n// new doc obj tests 990624-abk\r\n\tvar is_forms = (document.forms) ? \"true\" : \"false\";\r\n\tvar is_links = (document.links) ? \"true\" : \"false\";\r\n\tvar is_frames = (window.frames) ? \"true\" : \"false\";\r\n\tvar is_screen = (window.screen) ? \"true\" : \"false\";\r\n\r\n// java\r\n\tvar is_java = (navigator.javaEnabled());\r\n\r\n//--> end hide JavaScript\r\n</script>","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["Browser Detection","Browser Sniffer"]},{"RecordId":"448","Title":"Status Property Usage","Description":"You can use the Status property to send an HTTP status code and reason phrase. Common uses for the Status property are forcing a password dialog box to appear or automatically redirecting a user to a new page.","Code":"You can use the Status property to send an HTTP status code and reason phrase.  Common uses for the Status property are forcing a password dialog box to appear or automatically redirecting a user to a new page. \r\n\r\nThe following script demonstrates how you can use the Status property to send a \"Forbidden\" status: \r\n\r\n<%\r\nResponse.Status = \"403 Forbidden\"\r\n%>\r\nForbidden\r\n\r\nHere is the complete list of status codes and reason phrases that you can use with the Status property: \r\n\r\n\"101\" Switching Protocols \r\n\"200\" OK \r\n\"201\" Created \r\n\"202\" Accepted \r\n\"203\" Non-Authoritative Information \r\n\"204\" No Content \r\n\"205\" Reset Content \r\n\"206\" Partial Content \r\n\"300\" Multiple Choices \r\n\"301\" Moved Permanently \r\n\"302\" Found \r\n\"303\" See Other \r\n\"304\" Not Modified \r\n\"305\" Use Proxy \r\n\"307\" Temporary Redirect \r\n\"400\" Bad Request \r\n\"401\" Unauthorized \r\n\"402\" Payment Required \r\n\"403\" Forbidden \r\n\"404\" Not Found \r\n\"405\" Method Not Allowed \r\n\"406\" Not Acceptable \r\n\"407\" Proxy Authentication Required \r\n\"408\" Request Time-out \r\n\"409\" Conflict \r\n\"410\" Gone \r\n\"411\" Length Required \r\n\"412\" Precondition Failed \r\n\"413\" Request Entity Too Large \r\n\"414\" Request-URI Too Large \r\n\"415\" Unsupported Media Type \r\n\"416\" Requested range not satisfiable \r\n\"417\" Expectation Failed \r\n\"500\" Internal Server Error \r\n\"501\" Not Implemented \r\n\"502\" Bad Gateway \r\n\"503\" Service Unavailable \r\n\"504\" Gateway Time-out \r\n\"505\" HTTP Version not supported","Declares":"","CodeCategory":{"CategoryId":"2","CategoryDescription":"Web"},"Keywords":["Status","Password"]},{"RecordId":"451","Title":"Content Ratings","Description":"Content ratings sites and info","Code":"You can use the PICS property to assign a PICS label to your Web site.  Typically, a PICS label is used to rate the content of your Web site among a number of dimensions such as sexuality and violence.  The PICS standard was developed to help parents and teachers avoid pornographic Internet content.  However, PICS labels can be developed for other purposes as well. \r\n\r\nIf you want to give your Web site a PICS label, I would not suggest using the PICS property.  Instead, go to one of the following Web sites and fill out their questionnaire.  They will give you a label that you can embed in your HTML code: \r\n\r\nAdequate.com                                            http://www.adequate.com/ratings/\r\nItalian self-rating service (site in Italian)       http://www.csr.unibo.it/ra/\r\nRSACi                                                         http://www.icra.org/\r\nSafe For Kids                                              http://www.weburbia.com/safe/ratings.htm\r\nSafeSurf                                                      http://www.safesurf.com/\r\nVancouver Web Pages                              http://vancouver-webpages.com/VWP1.0/\r\n\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"2","CategoryDescription":"Web"},"Keywords":["Content Ratings","Ratings"]},{"RecordId":"452","Title":"Display Web Page Without Formatting (For Printing)","Description":"An ASP that uses a FileSystemObject to output the HTML so that it can be viewed in a browser without the HTML formatting.","Code":"Have you ever wanted to be able to print out the source code of your ASP page?  Perhaps you want to be able to show people your ASP source code, or you want to provide a way to view your own ASP pages from a remote machine.  This article will examine how to accomplish this task using a couple ServerVariables and the FileSystemObject.\r\n\r\nIt assumes that you call it with the URL of the page that you want to display.\r\n \r\n<%@ Language=VBScript %>\r\n<%Option Explicit %>\r\n<%\r\n    Dim strURL\r\n    strURL = Request.QueryString(\"URL\")\r\n    \r\n    Dim strDir, strFileName\r\n    strDir = Request.ServerVariables(\"APPL_PHYSICAL_PATH\")\r\n    \r\n    Response.Write strDir\r\n    \r\n    strFileName = Replace(strURL,\"/\",\"\\\")\r\n    strFileName = strDir & strFileName\r\n    \r\n\tConst ForReading = 1\r\n    Dim objFSO, objTextStream\r\n    Set objFSO = Server.CreateObject(\"Scripting.FileSystemObject\")\r\n    Set objTextStream = objFSO.OpenTextFile(strFileName, ForReading)\r\n\r\n    Response.Write \"<HTML><BODY>\"\r\n    Response.Write \"<XMP>\" &  objTextStream.ReadAll & \"</XMP>\"\r\n    Response.Write \"</BODY></HTML>\"\r\n\t\r\n    objTextStream.Close\r\n    Set objTextStream = Nothing\r\n    Set objFSO = Nothing\r\n    \r\n%>\r\n\r\nThe <XMP> tag ignores all HTML tags. It simply dumps the contents to the screen with ZERO formatting.","Declares":"","CodeCategory":{"CategoryId":"2","CategoryDescription":"Web"},"Keywords":["Printing"]},{"RecordId":"453","Title":"Open Excel, Word, PDF, etc. in IE Natively","Description":"Demonstrates how to open a document directly in IE.\r\nNOTE:  Uses BinaryWrite on an ASP that calls a VB component.\r\nNOTE:  Set response.buffer = true","Code":"'------------------------------------------------------------------------------------------------------------\r\n' This is the ASP\r\n'------------------------------------------------------------------------------------------------------------\r\n<%\r\n\r\n   Dim vntStream\r\n\r\n   Response.buffer = TRUE\r\n   Response.ContentType = \"application/x-msexcel\"\r\n   ' NOTE:  For list of common MIME types, search this database for MIME Types\r\n\r\n   Set oMyObject = Server.CreateObject(\"MyObject.BinRead\")\r\n   vntStream = oMyObject.readBinFile(\"c:\\ted\\tedtest.xls\")\r\n\r\n   Response.BinaryWrite(vntStream)\r\n\r\n   Set oMyObject = Nothing\r\n\r\n   Response.End\r\n\r\n%> \r\n\r\n'------------------------------------------------------------------------------------------------------------\r\n' This is the VB component\r\n'------------------------------------------------------------------------------------------------------------\r\nFunction readBinFile(ByVal bfilename As String)\r\n\r\n       Dim fl As Long\r\n       Dim binbyte() As Byte\r\n       Dim binfilestr As String\r\n\r\n       On Error GoTo errHandler\r\n\r\n       Open bfilename For Binary Access Read As #1\r\n\r\n       fl = FileLen(bfilename)\r\n       ReDim binbyte(fl)\r\n\r\n       Get #1, , binbyte\r\n\r\n       Close #1\r\n\r\n       readBinFile = binbyte\r\n       Exit Function\r\n\r\nerrHandler:\r\n\r\n       Exit Function\r\n\r\nEnd Function","Declares":"","CodeCategory":{"CategoryId":"2","CategoryDescription":"Web"},"Keywords":["BinaryWrite","MIME","Excel Word PDF"]},{"RecordId":"454","Title":"Display Image That Is Contained In Database Field","Description":"Displays an image that exists in a blob field in a database table","Code":"In Microsoft SQL Server, the &quot;image&quot; datatype can be used to save a binary object (such as an Employee's picture). In Access, use the &quot;OLE Object&quot; datatype. By placing the actual image in the database, however, there can be some efficiency concerns, especially if the images are large and/or the database resides on a different server than the Web server. \r\n\r\nIt is essential that we know the type of image being stored in the Picture column, whether it is a GIF, a JPG, a PNG, etc. For this example we'll assume all pictures are JPG. (In a scenario where there may be multiple file formats, a look-up table should be used to specify the filetype for each row.) \r\n\r\nTo display the image on a web page:\r\n\r\nPlace the following image tag on the page that displays the image\r\n&lt;IMG SRC=&quot;ShowEmployeePicture.asp?EmployeeID=007&quot;&gt; \r\n\r\n\r\nThis is the ASP Page &quot;ShowEmployeePicture.asp&quot; that generates the image\r\n&lt;%\r\n\r\n  'Step 1: Read in the employee ID from the querystring\r\n  Dim iEmployeeID\r\n  iEmployeeID = Request.QueryString(&quot;EmployeeID&quot;)\r\n  \r\n  \r\n  'Step 2: grab the picture from the database\r\n  Dim objConn, objRS, strSQL\r\n  strSQL = &quot;SELECT Picture FROM Employee WHERE EmployeeID = &quot; &amp; iEmployeeID\r\n  \r\n  Set objConn = Server.CreateObject(&quot;ADODB.Connection&quot;)\r\n  objConn.Open &quot;DSN=EmployeeDatabase&quot;\r\n  \r\n  Set objRS = Server.CreateObject(&quot;ADODB.Recordset&quot;)\r\n  objRS.Open strSQL, objConn\r\n  \r\n  \r\n  'Step 3: Set the ContentType to JPEG or GIF\r\n  Response.ContentType = &quot;image/jpg&quot;\r\n     - or -\r\n  Response.ContentType = &quot;image/gif&quot;\r\n  \r\n  \r\n  'Step 4: Use Response.BinaryWrite to output the image\r\n  Response.BinaryWrite objRS(&quot;Picture&quot;)\r\n  \r\n  \r\n  'Clean up...\r\n  objRS.Close\r\n  Set objRS = Nothing\r\n  \r\n  objConn.Close\r\n  Set objConn = Nothing\r\n\r\n%&gt;","Declares":"","CodeCategory":{"CategoryId":"5","CategoryDescription":"ASP"},"Keywords":["Image"]},{"RecordId":"455","Title":"XML/XSL Examples","Description":"Explanation of using XML and XSL on a web page","Code":"In this article, I will explain how to accomplish the second option,\r\ntransforming your data into HTML through XLS and ASP. First, the basics.\r\n\r\n***XML - What is it?***\r\nOk, by now most of us have read what XML is and how it will revolutionize\r\neverything including our toasters. Well, I'm going to very briefly explain\r\nwhat it is one more time.\r\n\r\nXML is a language that describes the data. It gives information like what\r\nthe data is, what it means, where it belongs in relation to other data, and\r\neven the data type. This means that it is not a markup language - it does\r\nnot tell the browser how it should be displayed. Here is an example of\r\nsimple XML\r\n\r\n<address id=\"83\">\r\n  <city>Taylor</city>\r\n  <state>AZ</state>\r\n</address>\r\n\r\nLovely piece of work if I do say so myself. What you see above is a XML\r\nblock that contains information about an address. You can make sense of what\r\nit is trying to get across just by looking at the code. Nothing fancy, just\r\nnormal information in a syntax that is like HTML. One note, you will\r\nprobably notice the id=\"83\". This is an attribute just like you find in\r\nHTML. There is more on attributes in the syntax section.\r\n\r\nObviously, not all XML documents are going to be this simple. But, they are\r\nall going to contain the basic idea of a root element that breaks down into\r\nsub elements that describe data.\r\n\r\nNow, before you worry about having to learn all of these new tags (such as\r\n<address> and <city>) you should realize that I made those up and so can\r\nyou. XML is Extensible, meaning, it is not restricted to a set of tags. You\r\nget to define the tags names as anything you would like. All that is\r\nnecessary is that you know what the tags are named when you go to parse the\r\nXML. So be free and creative when naming your tags (actually, more of a\r\nconstrained and structured approach is better but whatever). Also, there are\r\na number of rules you must follow when writing XML tags which leads us to\r\nsyntax.\r\n\r\nXML Syntax\r\nXML syntax is very, very similar the HTML. It has a beginning tag, <beg>,\r\nand an ending tag, </beg> specified by the forward slash: /. In between\r\nthese is the data as you have seen in the above example. In certain cases,\r\nyou will need to use attributes. Attributes are just more information tucked\r\ninto the XML tag. In reality, you wouldn't ever have to use attributes\r\nbecause you could just make it another element like such:\r\n\r\n<address>\r\n  <id>83</id>\r\n  <city>Taylor</city>\r\n  <state>AZ</state>\r\n</address>\r\n\r\nBut, for some reason, we have kept the attribute tag you will run into them\r\nconstantly in XML.  The differences between XML and HTML syntax are these:\r\n\t- XML is case sensitive\r\n\t- All XML tags must have a closing tag\r\n\t- All attributes must be in quotes\r\n\t- A XML document can only have one root\r\n\r\nThat's it! Those are the rules you need to write you first XML document.\r\nFor more information on XML be sure to read: Getting Started with XML\r\n(http://www.4guysfromrolla.com/webtech/051000-1.shtml) or visit the 4Guys\r\nXML Article Section (http://www.4guysfromrolla.com/webtech/XML.shtml).\r\n\r\n\r\n***XSL - What is it?***\r\nNow that you are comfortable because you know everything you need to know, I\r\nwill throw XSL at you. XSL is the style sheet language for XML. By using XSL\r\nyou can transfer XML documents into text, html, or new XML documents with\r\ndifferent structures. That said; let me say that XSL is really a breeze when\r\nusing it to transform XML into HTML. When doing this transfer the XSL file\r\nis mostly HTML with smattering of XSL command. But, we will get into that\r\nwhen the time comes.\r\n\r\n\r\n***Getting Started (You would think by now we were well on our way)***\r\nFirst off, we are going to be parsing our XML file by using the Microsoft\r\nDOM object. That means that you need to have it installed on your server. To\r\ninstall it, just install IE 5.0 or above. If you already have that browser,\r\nno worries, you are ready to go.\r\n\r\nNext, let's do a little asp coding. First thing we need to do is initiate\r\nthe DOM Object:\r\n\r\n<%\r\n  set xml = Server.CreateObject(\"Microsoft.XMLDOM\")\r\n%>\r\n\r\n\r\nWell that was easy. Next, we need to load our XML document into the DOM. To\r\ndo this simply call xml.load method like such:\r\n\r\n<%\r\n  set xml = Server.CreateObject(\"Microsoft.XMLDOM\")\r\n  xml.load(\"http://headlines.isyndicate.com/pages/cui/news.xml\")\r\n%>\r\n\r\n\r\nNow, notice that I am getting XML from an external website. I know that\r\nafter the abundance of information I gave you on creating XML documents you\r\nwill want to run out and build your own XML, but I suggest that for now we\r\nuse one that I know to be well formed (also, when we are done, you will have\r\na nice display of constantly updated news items). If you would like to pull\r\nfrom your own XML data, you will need to specify the physical path\r\n(C:\\Blah\\Whatever.xml). If the XML file is in the Web site directory\r\nstructure you can get the physical path by using\r\nServer.MapPath(\"/SomeWebDir/Whatever.xml\")\r\n\r\nTo see what this XML information looks like, go to it in IE 5 or greater at\r\nhttp://headlines.isyndicate.com/pages/cui/news.xml. You will see a layout of\r\nnews stories each with it's own headline, source, href, and more. Here is\r\nthe basic design:\r\n\r\n<newsfeed>\r\n  <channel cid=\"\" title=\"\" date=\"\" time=\"\">\r\n    <headline href=\"\" date=\"\" time=\"\">News Headline</headline>\r\n    <headline href=\"\" date=\"\" time=\"\">News Headline</headline>\r\n    <headline href=\"\" date=\"\" time=\"\">News Headline</headline>\r\n  </channel>\r\n  <channel cid=\"\" title=\"\" date=\"\" time=\"\">\r\n    <headline href=\"\" date=\"\" time=\"\">News Headline</headline>\r\n    <headline href=\"\" date=\"\" time=\"\">News Headline</headline>\r\n  </channel>\r\n</newsfeed>\r\n\r\nNote: this data feed is provided free from ISyndicate.com - if you would\r\nlike to use this feed or make your own, please follow their rules including\r\ndisplaying their logo.\r\n\r\nThis XML is pretty straight forward. The root element is <newsfeed> under\r\nwhich you have <channel> tags which have the channel (source) name and so\r\non. Under <channel> is the final element in the hierarchy, the <headline>\r\ntags.\r\n\r\nSo, we have loaded the external XML data into our DOM. The next step is to\r\nwrite the XSL document. So on to XSL syntax!\r\n\r\n\r\n***XSL Syntax***\r\nTo make HTML using XSL you simply write out the values of the XML in between\r\nthe HTML. This is very much akin to using ASP to write out the values from a\r\ndatabase in between HTML tags. Only the syntax is different. For example, if\r\nyou were to write a variable to a page and make it bold in ASP it would look\r\nlike:\r\n\r\n<b><%=yourVar%></b>\r\n\r\nIn XSL it would look like:\r\n\r\n<b><xsl:value-of select=\"elementName\"></b>\r\n\r\nNot really that difficult at all. A couple things to keep in mind - XSL is\r\nwritten in XML which means all of the syntax rules apply - Case Sensitive,\r\nQuotes around all attributes (including HTML), and all elements must have an\r\nending element (including HTML). This means that if you use <br> you must\r\nuse </br>.\r\n\r\nOK, so we have the basic ability to write the value of an element to a page.\r\nThis ability is useless until we have the ability to navigate the XML\r\nelements. For example, if you were to use <xsl:value-of select=\"headline\">\r\nwith no other code, you would get an error (or a blank screen). The reason\r\nfor this is that XML allows elements with the same name that mean different\r\nthings to co-exist in a document (as long as they are positioned\r\ndifferently). That translated means you need to specify the exact location\r\nof the element you are trying to print to the page. For example, the\r\nfollowing would be proper and would write out the headline value (assuming\r\nyou completed the header correctly which we will go into later):\r\n\r\n<xsl:value-of select=\"newsfeed/channel/headline\">\r\n\r\nYou can see that this works somewhat like a directory structure - you have\r\nto get the correct directory to get the value.  Another XLS tag we will be\r\nusing allows us to loop through the XML document so we get all of the\r\ninformation sent in the XML document. The syntax is simply this:\r\n\r\n<xsl:for-each select=\"loopingElement\">\r\n\r\nThis can easily be used in our example XML like the following:\r\n\r\n<xsl:for-each select=\"newsfeed/channel\">\r\n</xsl:for-each>\r\n\r\nThis will loop through each channel and we could write out the name of the\r\nchannel like so:\r\n\r\n<xsl:for-each select=\"newsfeed/channel\">\r\n  <br><b><xsl:value-of select=\"@title\"></xsl:value-of></b></br>\r\n</xsl:for-each>\r\n\r\nNotice a couple of things. First, note the @ in the value-of statement. This\r\nis the syntax for grabbing attribute values from an XML tag. The format is\r\nsimply <xsl:value-of select=\"@attributeName\">.\r\n\r\nThe second thing to notice is that we must have the ending tags even though\r\nit seems a little ridiculous. The designers of XML agree with us so they\r\ngive an easy way out; use a forward slash (/) at the end of the tag to\r\nspecify that the end tag would have been next anyway. Below is what our code\r\ncould look like:\r\n\r\n<xsl:for-each select=\"newsfeed/channel\">\r\n  <br/><b><xsl:value-of select=\"@title\"/></b>\r\n</xsl:for-each>\r\n\r\nAlso you might have noticed that our <xsl:value-of select=\"@title\"/> tag did\r\nnot contain any directory structure. That is, using the direction I gave\r\nabove, shouldn't it look like <xsl:value-of\r\nselect=\"newsfeed/channel/@title\"/>? The answer is no. Because you have\r\nalready navigated to the appropriate element with <xsl:for-each\r\nselect=\"newsfeed/channel\"> you only need to refer to the relative position\r\nof the data you choose to display.\r\n\r\nThis makes for an interesting syntax, the last you will need to learn for\r\nthis lesson. How can you get the value of that element when you have already\r\nnavigated to that element earlier on? For example:\r\n\r\n<xsl:for-each select=\"newsfeed/channel/headline\">\r\n  <xsl:value-of />\r\n</xsl:for-each>\r\n\r\nAs you can see above, we already navigated to our headline element inside\r\nthe loop statement. To then display the value of the headline tag, it is\r\nnecessary to use <xsl:value-of />. That will give the value of the current\r\nelement.\r\n\r\nOk, ok, there is one more smidgen of syntax you need to learn; how to create\r\na hyperlink from XML. Because XML tags can not be embedded in HTML (such as\r\n<a href=\"<xsl:value-of select=\"@href\"/>\">) it is necessary to have special\r\nsyntax to make links. That syntax is as follows:\r\n\r\n<A>\r\n  <xsl:attribute name=\"href\">\r\n  <xsl:value-of select=\"@href\"/>\r\n  </xsl:attribute>\r\n  <xsl:value-of />\r\n</A>\r\n\r\nSimply stated, use <A> then place the attribute of href and then print the\r\nvalue of the href and then print the value of the text you want to be in the\r\nhref and then close everything up. And then, it magically works!\r\n\r\nNow we have got the ability to loop through our XML, we can display all\r\nkinds of data and make hyperlinks. What more do you need to know? Here is\r\nthe finished XSL document using all of the information above (by the way,\r\nthe header, stylesheet, and template tags are all necessary for any XSL\r\ndocument transferring the HTML):\r\n\r\n<?xml version='1.0'?>\r\n<xsl:stylesheet xmlns:xsl=\"http://www.w3.org/TR/WD-xsl\">\r\n<xsl:template match=\"/\">\r\n\r\n<xsl:for-each select=\"newsfeed/channel\">\r\n  <table>\r\n    <tr>\r\n      <td colspan=\"2\">\r\n        <font face=\"arial\" size=\"1\">\r\n        <b>\r\n        <xsl:value-of select=\"@title\"/>\r\n        </b>\r\n        </font>\r\n      </td>\r\n    </tr>\r\n\r\n  <xsl:for-each select=\"headline\">\r\n    <tr>\r\n       <td valign=\"top\">\r\n         -\r\n       </td>\r\n       <td>\r\n         <font face=\"arial\" size=\"1\">\r\n         <A>\r\n         <xsl:attribute name=\"href\">\r\n         <xsl:value-of select=\"@href\"/>\r\n         </xsl:attribute>\r\n         <xsl:value-of />\r\n         </A>\r\n         </font>\r\n       </td>\r\n    </tr>\r\n  </xsl:for-each>\r\n  </table>\r\n</xsl:for-each>\r\n\r\n</xsl:template>\r\n</xsl:stylesheet>\r\n\r\nThis code will simply loop through the channels displaying the channel name,\r\nthen inside loop through the headlines in that channel giving the headline\r\nname and a link to the news. To see this XSL stylesheet in action be sure to\r\nview the live demo (http://www.4guysfromrolla.com/demos/XMLNews.asp)!\r\n\r\n\r\n***How do I Make it All Work?***\r\nFirst, take the above XSL code and save it to your server. I saved it as\r\nhome_News.xsl. Now that you have completed that, let's go back to the ASP.\r\n\r\n<%\r\n  set xml = Server.CreateObject(\"Microsoft.XMLDOM\")\r\n  xml.load(\"http://headlines.isyndicate.com/pages/cui/news.xml\")\r\n%>\r\n\r\nIn the above code we had initiated the XML DOM object and loaded the\r\nexternal XML document. Now let's instantiate the XSL DOM object and load our\r\nXSL document like such:\r\n\r\n<%\r\n  set xsl = Server.CreateObject(\"Microsoft.XMLDOM\")\r\n  xsl.load(Server.MapPath(\"home_News.xsl\"))\r\n%>\r\n\r\nNow we are almost finished. All we have to do is write the parsed XML to the\r\npage and clean up like such:\r\n\r\n<%\r\n  Response.Write(xml.transformNode(xsl))\r\n  xsl = nothing\r\n  xml = nothing\r\n%>\r\n\r\nThat's that. Your XML should be written to the page as a beautifully\r\nformatted block of news stories (html). More likely than not, you will get a\r\nblank screen. Here is how to fix that.\r\n\r\n\r\n***Debugging***\r\nXML and XSL are really easy to debug. Just grab the file and drag it to your\r\nIE 5 browser. If you made an error, it will tell you what you did wrong and\r\nwhere. Make the correction and refresh. Keep doing that until it display\r\nyour XSL and XML documents correctly. After that, give your ASP page a try\r\nagain. Hopefully it will work this time.\r\n\r\nThere are a couple of problems you may run into like not having the proper\r\nsettings on the server to let your program load a document from another\r\nsite. If you can't make it run on your server but you are sure you have the\r\ncode correct give it a try on PWS (PWS doesn't have the features of such\r\ncomplicated security and should run the page) or save the XML file to a\r\nlocal disk and give it a try.","Declares":"","CodeCategory":{"CategoryId":"8","CategoryDescription":"XML"},"Keywords":["XML","XSL"]},{"RecordId":"456","Title":"Using MTS in ASP","Description":"Demonstrates use of MTS object contexts in an ASP (without actually using an MTS component).","Code":"<% TRANSACTION = Required %>\r\n\r\n<%\r\n\r\nIf Result <> True Then \r\n  ObjectContext.SetAbort\r\nElse\r\n  ObjectContext.SetComplete\r\nEnd If\r\n\r\nSub OnTransactionCommit()\r\n . . .\r\nEnd sub\r\n\r\nSub OnTransactionAbort()\r\n . . .\r\nEnd Sub\r\n\r\n%>","Declares":"","CodeCategory":{"CategoryId":"14","CategoryDescription":"MTS"},"Keywords":["MTS"]},{"RecordId":"458","Title":"Clear Cache When Your Application Hosts WebBrowser","Description":"Clear Cache When Your Application Hosts a WebBrowser Control","Code":"Private Sub Command1_Click()\r\n\r\n    Dim sGroupID As Date\r\n    Dim hGroup As Long\r\n    Dim hFile As Long\r\n    Dim sEntryInfo As INTERNET_CACHE_ENTRY_INFO\r\n    Dim iSize As Long\r\n        \r\n    On Error Resume Next\r\n    \r\n    ' Delete the groups\r\n    hGroup = FindFirstUrlCacheGroup(0, 0, 0, 0, sGroupID, 0)\r\n    \r\n    ' To avoid error using it with IE4 as FindFirstUrlCacheGroup is not implemented\r\n    If Err.Number <> 453 Then\r\n        If (hGroup = 0) And (Err.LastDllError <> 2) Then\r\n            MsgBox \"An error occurred enumerating the cache groups\" & Err.LastDllError\r\n            Exit Sub\r\n        End If\r\n    Else\r\n        Err.Clear\r\n    End If\r\n    \r\n    If (hGroup <> 0) Then\r\n        'we succeeded in finding the first cache group.. enumerate and\r\n        'delete\r\n        Do\r\n            If (0 = DeleteUrlCacheGroup(sGroupID, CACHEGROUP_FLAG_FLUSHURL_ONDELETE, 0)) Then\r\n               \r\n               ' To avoid error using it with IE4 as FindFirstUrlCacheGroup is not implemented\r\n               If Err.Number <> 453 Then\r\n                 MsgBox \"Error deleting cache group \" & Err.LastDllError\r\n                 Exit Sub\r\n               Else\r\n                  Err.Clear\r\n               End If\r\n            End If\r\n            iSize = BUFFERSIZE\r\n            If (0 = FindNextUrlCacheGroup(hGroup, sGroupID, iSize)) And (Err.LastDllError <> 2) Then\r\n                MsgBox \"Error finding next url cache group! - \" & Err.LastDllError\r\n            End If\r\n        Loop Until Err.LastDllError = 2\r\n    End If\r\n  \r\n  ' Delete the files\r\n    sEntryInfo.dwStructSize = 80\r\n    iSize = BUFFERSIZE\r\n    hFile = FindFirstUrlCacheEntry(0, sEntryInfo, iSize)\r\n    If (hFile = 0) Then\r\n        If (Err.LastDllError = ERROR_NO_MORE_ITEMS) Then\r\n            GoTo done\r\n        End If\r\n        MsgBox \"ERROR: FindFirstUrlCacheEntry - \" & Err.LastDllError\r\n        Exit Sub\r\n    End If\r\n    Do\r\n        If (0 = DeleteUrlCacheEntry(sEntryInfo.szRestOfData(0))) _\r\n            And (Err.LastDllError <> 2) Then\r\n            Err.Clear\r\n        End If\r\n        iSize = BUFFERSIZE\r\n        If (0 = FindNextUrlCacheEntry(hFile, sEntryInfo, iSize)) And (Err.LastDllError <> ERROR_NO_MORE_ITEMS) Then\r\n            MsgBox \"Error:  Unable to find the next cache entry - \" & Err.LastDllError\r\n            Exit Sub\r\n        End If\r\n    Loop Until Err.LastDllError = ERROR_NO_MORE_ITEMS\r\ndone:\r\n    MsgBox \"cache cleared\"\r\n    Command1.Enabled = True\r\n\r\nEnd Sub","Declares":"Private Declare Function FindFirstUrlCacheGroup Lib \"wininet.dll\" ( _\r\n    ByVal dwFlags As Long, _\r\n    ByVal dwFilter As Long, _\r\n    ByRef lpSearchCondition As Long, _\r\n    ByVal dwSearchCondition As Long, _\r\n    ByRef lpGroupId As Date, _\r\n    ByRef lpReserved As Long) As Long\r\n\r\nPrivate Declare Function FindNextUrlCacheGroup Lib \"wininet.dll\" ( _\r\n    ByVal hFind As Long, _\r\n    ByRef lpGroupId As Date, _\r\n    ByRef lpReserved As Long) As Long\r\n    \r\nPrivate Declare Function DeleteUrlCacheGroup Lib \"wininet.dll\" ( _\r\n    ByVal sGroupID As Date, _\r\n    ByVal dwFlags As Long, _\r\n    ByRef lpReserved As Long) As Long\r\n    \r\nPrivate Declare Function FindFirstUrlCacheEntry Lib \"wininet.dll\" Alias \"FindFirstUrlCacheEntryA\" ( _\r\n    ByVal lpszUrlSearchPattern As String, _\r\n    ByRef lpFirstCacheEntryInfo As INTERNET_CACHE_ENTRY_INFO, _\r\n    ByRef lpdwFirstCacheEntryInfoBufferSize As Long) As Long\r\n    \r\nPrivate Type INTERNET_CACHE_ENTRY_INFO\r\n    dwStructSize As Long\r\n    szRestOfData(1024) As Long\r\nEnd Type\r\n\r\nPrivate Declare Function DeleteUrlCacheEntry Lib \"wininet.dll\" Alias \"DeleteUrlCacheEntryA\" ( _\r\n    ByVal lpszUrlName As Long) As Long\r\n\r\nPrivate Declare Function FindNextUrlCacheEntry Lib \"wininet.dll\" Alias \"FindNextUrlCacheEntryA\" ( _\r\n    ByVal hEnumHandle As Long, _\r\n    ByRef lpNextCacheEntryInfo As INTERNET_CACHE_ENTRY_INFO, _\r\n    ByRef lpdwNextCacheEntryInfoBufferSize As Long) As Long\r\n\r\nPrivate Const CACHGROUP_SEARCH_ALL = &H0\r\nPrivate Const ERROR_NO_MORE_FILES = 18\r\nPrivate Const ERROR_NO_MORE_ITEMS = 259\r\nPrivate Const CACHEGROUP_FLAG_FLUSHURL_ONDELETE = &H2\r\nPrivate Const BUFFERSIZE = 2048","CodeCategory":{"CategoryId":"2","CategoryDescription":"Web"},"Keywords":["Cache","Clear Cache"]},{"RecordId":"459","Title":"Iterating Through a Collection","Description":"VBScript and equivalent JavaScript sample for iterating through a collection","Code":"----------------------------------------------------------------------------------\r\nVBScript Version\r\n----------------------------------------------------------------------------------\r\n<% @LANGUAGE=\"VBScript\" %>\r\n<%\r\n\t'Reference the FileSystemObject\r\n\tset FSO = Server.CreateObject(\"Scripting.FileSystemObject\")\r\n\t\r\n\t'Reference the Text directory\r\n\tset Folder = FSO.GetFolder(\"C:\\Text\")\r\n\r\n\t'Reference the File collection of the Text directory\r\n  \tset FileCollection = Folder.Files\r\n\r\n\tResponse.Write(\"VBScript Method<BR>\")\r\n\r\n\t'Display the number of files within the Text directory\r\n\tResponse.Write(\"Number of files found: \" & FileCollection.Count & \"<BR>\")\r\n\r\n\t'Traverse through the FileCollection using the FOR EACH...NEXT loop\r\n\tFor Each FileName in FileCollection\r\n\r\n\t   strFileName = FileName.Name\r\n\t   Response.Write(strFileName & \"<BR>\")\r\n\r\n\tNext\r\n\r\n\t'De-reference all the objects\r\n\tset FileCollection = Nothing\r\n\tset Folder = Nothing\r\n\tset FSO = Nothing\r\n%> \r\n\r\n----------------------------------------------------------------------------------\r\nJavaScript Version\r\n----------------------------------------------------------------------------------\r\n<% @LANGUAGE=\"JScript\" %>\r\n<%\r\n\t// Reference the FileSystemObject\r\n\tvar FSO = Server.CreateObject(\"Scripting.FileSystemObject\");\r\n\t\r\n\t// Reference the Text directory\r\n\tvar Folder = FSO.GetFolder(\"c:\\\\Text\");\r\n\r\n\t// Reference the File collection of the Text directory\r\n  \tvar FileCollection = Folder.Files;\r\n\r\n\tResponse.Write(\"JScript Method<BR>\");\r\n\r\n\t// Display the number of files within the Text directory\r\n\tResponse.Write(\"Number of files found: \" + FileCollection.Count + \"<BR>\");\r\n\r\n\t// Traverse through the FileCollection using the FOR loop\r\n\tfor(var objEnum = new Enumerator(FileCollection); !objEnum.atEnd(); objEnum.moveNext()) {\r\n\t   strFileName = objEnum.item();\r\n\t   Response.Write(strFileName + \"<BR>\");\r\n\t}\r\n\r\n\t// Destroy and de-reference enumerator object\r\n\tdelete objEnum;\r\n\tobjEnum = null;\r\n\r\n\t// De-reference FileCollection and Folder object\r\n\tFileCollection = null;\r\n\tFolder = null;\r\n\r\n\t// Destroy and de-reference FileSystemObject\r\n\tdelete FSO;\r\n\tFSO = null;\r\n%>","Declares":"","CodeCategory":{"CategoryId":"2","CategoryDescription":"Web"},"Keywords":["Collection","Iterating","For..Each"]},{"RecordId":"460","Title":"Send eMail From ASP (CDONTS)","Description":"Uses SMTP service (and CDONTS) to send email from an ASP","Code":"Dim oCDONTS\r\n\r\nSET oCDONTS = Server.CreateObject(\"CDONTS.NewMail\")\r\n\r\noCDONTS.To = \"you@domain.com\"\r\noCDONTS.CC = \"youcopied@domain.com\"\r\noCDONTS.From = \"someemail@domain.com\"\r\noCDONTS.Value(\"Reply-To\") = \"me@mysite.com\"\r\noCDONTS.Subject = \"Some Subject\"\r\noCDONTS.Body = \"Some body text\"\r\noCDONTS.AttachFile \"c:\\mydocument.txt\"\r\noCDONTS.Send\r\n\r\nSET oCDONTS = Nothing","Declares":"","CodeCategory":{"CategoryId":"5","CategoryDescription":"ASP"},"Keywords":["CDONTS","EMail","SMTP"]},{"RecordId":"461","Title":"Cybercash Credit Card Sample","Description":"Demonstrates how to perform credit card validation with Cybercash","Code":"** Sample code is at end of article **\r\n\r\nCredit Card Processing\r\nBy Michael Gellis\r\n\r\nIf you haven't done electronic credit card processing yet, you may be asked to do it soon. Don't sweat, it's not as difficult as it sounds.  Actually it's quite simple. In this Solution, I will demonstrate how to process credit cards with a popular processing service called CyberCash using CyberCash's COM component CyberCashMCK. \r\nFirst the big picture. There are four players involved in an online credit card transaction: \r\n\r\nThe card holder making the purchase \r\nThe online store offering the product or service, aka the merchant \r\nA financial institution such as a bank that handles the financial transaction between the card holder and the merchant \r\nAn online credit card processing service such as CyberCash that mediates the transaction between the merchant and the financial institution by asking the financial institution to execute the transaction and informing the merchant as to whether the transaction was successful. \r\nThe first step in setting up an online credit card processing system is to set up a merchant account with a bank. Once you have your merchant account, you can become a CyberCash merchant at http://www.cybercash.com. The next step is to download and install the Merchant Connection Kit (MCK) that contains the CyberCashMCK component and configuration file. You cannot download the MCK from Cybercash without registering first, however, documentation is available to everyone at http://www.cybercash.com/support. \r\nThe CyberCashMCK component is a COM component and can be used either in a VB component or in an ASP script. CyberCashMCK has two objects, MessageBlock and Socket. MessageBlock is similar to a Dictionary object and is used to store information about the transaction such as credit card number, and price. The Socket object is used to execute the transaction by communicating with CyberCash's central processing service called CashRegister. \r\n\r\nThere are four steps you have to take to execute a transaction: \r\n\r\n1. Populate a Dictionary object with CyberCash configuration information\r\nThe MCK setup configures a configuration file called Merchant_Conf that contains parameters you will need to execute a CyberCash transaction, such as your CyberCash ID. The MCK comes with a file called CCMckLib.inc that includes a VBScript function called InitConfig that initializes a Dictionary object with all the configuration information. You should incorporate the function into your component or script. \r\n\r\n2. Populate the MessageBlock object with configuration and payment information\r\nThe MessageBlock requires two blocks of information. The cpi block that contains card information, and the mo block that contains configuration and price information. Each block is made up of a string containing several parameters. Each parameter is prefixed with the block identifier, mo or cpi. The parameters are concatenated with ampersands. An example of these blocks would be: \r\n\r\nmo.cybercash-id=123&mo.version=3.2.0.7&mo.signed-cpi=no&mo. _\r\norder-id=123&mo.price=usd12\r\n\r\ncpi.card-number=411111111111&cpi.card-exp=6/00&cpi.card-name=visa&cpi. _\r\ncard-address=123 Main Street&cpi.card-city=NY&cpi.card-state=NY&cpi. _\r\ncard-zip=11230&cpi.card-country=usa\r\n\r\nThe MessageBlock object has an Add method that takes name value pairs. Use the Add method to add each block as shown in the sample code below. \r\n3. Call Socket's SendCCServer to execute the transaction\r\nTo actually execute the transaction, call the Socket objects SendCCServer method. It takes three parameters (sPaymentURL, sConfigLoc, pArgs). \r\n\r\nsPaymentURL is the CashRegister URL that is supplied to you by CyberCash and found in your configuration file. \r\nsConfigLoc is the file path and name of the CyberCash configuration file Merchant_Conf. \r\npArgs is MessageBlock object populated with configuration and payment information. \r\n4. Check the MessageBlock object returned by the SendCCServer\r\nThe SendCCServer method returns a MessageBlock object that contains information about the transaction that was just executed. The pop.status key contains either \"success\" or \"fail\". \r\nCybercash has a merchant administration Web site in which you can view all your transactions. Cybercash also allows you to operate in test mode so that you can execute transactions during development. Transactions executed in test mode are not relayed to the bank but are visible on the administration site. That way you can check whether your code is working. \r\n\r\nSample Code\r\nHere is what your code should look like:\r\n\r\n\r\n'***************************************************\r\nFunction ExecutePayment() ' as CyberCashMCK.MessageBlock\r\n    \r\n   Dim objSock 'As CyberCashMCK.socket\r\n   Dim objResult 'As CyberCashMCK.MessageBlock\r\n   Dim objMsgBlock 'As CyberCashMCK.MessageBlock\r\n   \r\n   'initialize global dictionary object gDictConfig with configuration info\r\n   nStatus = InitConfig()\r\n   \r\n   Set objMsgBlock = CreateObject(\"CyberCashMCK.MessageBlock\")\r\n   \r\n   'retrieve CashRegister url from gDictConfig\r\n   sPaymentURL = gDictConfig.Item(\"CCPS_HOST\") & \"directcardpayment.cgi\"\r\n   \r\n   'populate MessageBlock\r\n   objMsgBlock.Add \"MO\", BuildString(\"mo\")\r\n   objMsgBlock.Add \"CPI\", BuildString(\"cpi\")\r\n  \r\n   'create Socket and execute transaction\r\n   Set SockObj = Server.CreateObject(\"CyberCashMCK.socket.1\")\r\n   Set objResult = SockObj.SendCCServer(sPaymentURL, sConfigLoc, Args)\r\n   \r\n   Set ExecutePayment = objResult\r\n\r\nEnd Function\r\n\r\n'*********************************************************\r\n'BuildString- encapsulates the creation of cpi and mo blocks\r\n'this procedure assumes the payment and credit card information\r\n'was posted to this page in an html form\r\n'with the form elements having the name required by the MessageBlock\r\n\r\nFunction BuildString(SType)\r\nSelect Case LCase(SType)\r\nCase \"mo\"\r\n    BuildString = \"\" & _\r\n    Server.urlencode(\"mo.cybercash-id\") & \"=\" &  _\r\n\tServer.urlencode(gDictConfig.Item(\"CYBERCASH_ID\")) & \"&\" & _\r\n    Server.urlencode(\"mo.version\") & \"=\" & Server.urlencode _\r\n\t(\"3.2.0.7\") & \"&\" & _\r\n    Server.urlencode(\"mo.signed-cpi\") & \"=\" & Server.urlencode _\r\n\t(\"no\") & \"&\" & _\r\n    Server.urlencode(\"mo.order-id\") & \"=\" & Server.urlencode _\r\n\t(request(\"mo.order-id\")) & \"&\" & _\r\n    Server.urlencode(\"mo.price\") & \"=\" & Server.urlencode _\r\n\t(\"usd \" & request(\"mo.price\"))\r\nCase \"cpi\"\r\n   BuildString = \"\" & _\r\n   Server.urlencode(\"cpi.card-number\") & \"=\" & Server.urlencode _\r\n   (request(\"cpi.card-number\")) & \"&\" & _\r\n   Server.urlencode(\"cpi.card-exp\") & \"=\" & Server.urlencode _\r\n   (request(\"cpi.card-exp\")) & \"&\" & _\r\n   Server.urlencode(\"cpi.card-name\") & \"=\" & Server.urlencode _\r\n   (request(\"cpi.card-name\")) & \"&\" & _\r\n   Server.urlencode(\"cpi.card-address\") & \"=\" & Server.urlencode _\r\n   (request(\"cpi.card-address\")) & \"&\" & _\r\n   Server.urlencode(\"cpi.card-city\") & \"=\" & Server.urlencode _\r\n   (request(\"cpi.card-city\")) & \"&\" & _\r\n   Server.urlencode(\"cpi.card-state\") & \"=\" & Server.urlencode _\r\n   (request(\"cpi.card-state\")) & \"&\" & _\r\n   Server.urlencode(\"cpi.card-zip\") & \"=\" & Server.urlencode _\r\n   (request(\"cpi.card-zip\")) & \"&\" & _\r\n   Server.urlencode(\"cpi.card-country\") & \"=\" & Server.urlencode _\r\n   (request(\"cpi.card-country\"))\r\nEnd Select\r\nEnd Function","Declares":"","CodeCategory":{"CategoryId":"2","CategoryDescription":"Web"},"Keywords":["Cybercash","Credit Card"]},{"RecordId":"462","Title":"Accessing ASP Objects In VB","Description":"Demonstrates how to access ASP objects (Session, Request, Response, etc) in VB.","Code":"Requires setting VB project reference to Microsoft Active Server Pages Object Library.\r\n\r\nDim objASPApplication As ASPTypeLibrary.Application\r\nDim objASPRequest As ASPTypeLibrary.Request\r\nDim objASPResponse As ASPTypeLibrary.Response\r\nDim objASPScriptingContext As ASPTypeLibrary.ScriptingContext\r\nDim objASPServer As ASPTypeLibrary.Server\r\nDim objASPSession As ASPTypeLibrary.Session\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"5","CategoryDescription":"ASP"},"Keywords":["ASP Objects","Session Variables","Request Response"]},{"RecordId":"463","Title":"CDO - Send Mail as HTML","Description":"By default, CDO uses plain text.  This shows how to change the format to HTML.","Code":"By default Collaboration Data Objects for NT (CDONTS)\r\n        sends email messages as Plain Text. To send email\r\n        containing HTML we have to set two properties, MailFormat\r\n        and BodyFormat, of the NewMail object to zero.\r\n\r\n        The following piece of code demonstrates sending email\r\n        messages in HTML format using CDONTS\r\n\r\n        <%\r\n         Dim mailobj, htmlstr\r\n         Set mailobj = Server.CreateObject(\"CDONTS.NewMail\")\r\n         htmlstr = \"<center><h1>visit www.asptoday.com for good\" _\r\n                 & \" ASP tips</h1></center>\"\r\n\r\n         'specify the mail to be sent in html format by setting\r\n         'the following properties to zero\r\n         mailobj.mailFormat = 0\r\n         mailobj.bodyFormat = 0\r\n\r\n         mailobj.from = \"abc@xyz.com\"\r\n         mailobj.to = \"cde@ghi.com\"\r\n         mailobj.subject = \"info mail\"\r\n         mailobj.body = htmlstr\r\n         mailobj.send\r\n\r\n         Set mailobj = Nothing\r\n        %>\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"2","CategoryDescription":"Web"},"Keywords":["CDO"]},{"RecordId":"464","Title":"Mail This Page To A Friend","Description":"Demonstrates how to create a Mail This Page to a Friend link","Code":"To make the message attractive, decorate both its subject and its body with the current page's title, document.title. The following mailpage() function assembles the mail message and posts it to the browser's Address field:\r\n\r\n<script language=\"javascript\">\r\nfunction mailpage()\r\n{\r\n  mail_str = \"mailto:?subject= Doc JavaScript: \" + document.title;\r\n  mail_str += \"&body= I recommend Doc JavaScript's (docjavascript.com) tip -- \" + document.title;\r\n  mail_str += \". You should check this out at, \" + location.href; \r\n  location.href = mail_str;\r\n}\r\n</script>\r\n\r\nSomewhere on the page you need to provide a link that calls the above function, like this:\r\n<A HREF = \"javascript:mailpage()\">E-mail This Page</A> E-mail This Page\r\n","Declares":"","CodeCategory":{"CategoryId":"2","CategoryDescription":"Web"},"Keywords":["Mail To","Mail this page to a friend"]},{"RecordId":"465","Title":"Display Excel Chart in ASP","Description":"Uses ASP to automate Excel to generate chart that is then displayed in the ASP.  \r\n  NOTE:  This is for light traffic sites only.","Code":"NOTE:  There is an explanation at the end of the code that explaines the arguments for Excel's Chart Wizard.\r\n\r\n\r\n<%\r\nSub HandleRepeatVisit()\r\n\r\n    Dim xlapp \t' Our Excel App\r\n    Dim wb \t' Our Workbook within the Excel App\r\n    Dim ws \t' Our Worksheet within the Workbook\t\r\n    Dim crt \t' The chart object\r\n    Dim SourceRange ' The Source Range for the chart object\r\n\r\n    Const xlWorkSheet = -4167 \r\n    Const xlLineMarkers = 65\r\n\t\r\n    ' -- Create an instance of Excel Application\r\n    Set xlapp = Server.CreateObject(\"Excel.Application\")\r\n\r\n    ' -- Create a new workbook\r\n    Set wb = xlapp.Workbooks.Add(xlWorksheet)\r\n\r\n    ' -- Grab the first worksheet of the new workbook\r\n    Set ws = wb.Worksheets(1)\r\n\r\n    ' -- Insert the data the user requested\r\n    ' -- First, the title\r\n    ws.Range(\"A1\").Value = Request(\"co\") ' -- defaults to \"Microsoft\"\r\n\r\n    ' -- Then the data in two vertical columns\r\n    For i = 1 To 12\r\n        ws.Range(\"A\" & i + 1).Value = FormatDateTime(i & \"/01/99\", 2)\r\n        ws.Range(\"B\" & i + 1).Formula = \"=\" & Request(\"v\" & i) \r\n    Next\r\n\r\n    ' -- Set our source range\t    \r\n    Set SourceRange = ws.Range(\"A2:B13\")\r\n\r\n    ' -- Create a new Chart Object\r\n    Set crt = ws.ChartObjects.Add(20, 20, 300, 200)\r\n\r\n    ' -- Generate the Chart using the ChartWizard\r\n    ' -- Syntax is: \r\n    ' -- crt.Chart.ChartWizard Source:=SourceRange, gallery:=xlLine(4), PlotBy:=xlColumns(default), _\r\n    ' -- categorylabels:=1, serieslabels:=0, HasLegend:=2, Title:=\"Company Stock Value\"\r\n    crt.Chart.ChartWizard SourceRange, 4, , 2, 1, 0, 2, Request(\"co\") & \" Stock Value\"\r\n\r\n    ' -- Configure the Chart \r\n    crt.Chart.ChartType = xlLineMarkers\r\n    crt.Chart.SeriesCollection(1).Name = \"=Sheet1!R1C1\"\r\n    crt.Chart.HasTitle = True\r\n    crt.Chart.Axes(1, 1).HasTitle = True\r\n    crt.Chart.Axes(1, 1).AxisTitle.Characters.Text = \"Months\"\r\n    crt.Chart.Axes(2, 1).HasTitle = True\r\n    crt.Chart.Axes(2, 1).AxisTitle.Characters.Text = \"Stock Price\"\r\n\t\r\n    ' -- Determine the name to save this chart as. Use the current Seconds value, overwriting previous ones\t\r\n    mstrFileName =  \"junk\" & Second(Now()) & \".jpg\"\r\n\r\n    ' -- Save the chart on web server \r\n    crt.Chart.Export Server.Mappath(\"/asppro/junk/\") & \"\\\" & mstrFileName, \"jpg\"\r\n\r\n    ' -- Fool Excel into thinking the Workbook is saved\r\n    wb.Saved = True\r\n\r\n    ' -- Set all objects back to nothing\r\n    Set crt = Nothing\r\n    Set wb = Nothing\r\n\r\n    ' -- Quit Excel to conserve resources\r\n    xlapp.Quit\r\n    Set xlapp = Nothing\r\n\t\r\n    ' -- Make sure the Image is not cached but is loaded fresh from the web server\r\n    Response.AddHeader \"expires\",\"0\"\r\n    Response.AddHeader \"pragma\", \"no-cache\"\r\n    Response.AddHeader \"cache-control\",\"no-cache\"\r\n\t\r\nEnd Sub\r\n%>\r\n\r\n'----------------------------------------------------------------------------------------\r\nThe \"Arguments\" for the ChartWizard method are as follows: \r\n    expression.ChartWizard(Source, Gallery, Format, PlotBy, CategoryLabels, SeriesLabels,\r\n                                          HasLegend, Title, CategoryTitle, ValueTitle, ExtraTitle) \r\nWhere: \r\n 1.  expression: Required. An expression that returns a Chart object. \r\n 2.  Source: Optional Variant. The range that contains the source data for the new chart. If this argument is omitted, Microsoft Excel edits the active chart sheet or the selected chart on the active worksheet. \r\n 3.  Gallery: Optional Variant. The chart type. Can be one of the following XlChartType constants: xlArea, xlBar, xlColumn, xlLine, xlPie, xlRadar, xlXYScatter, xlCombination, xl3DArea, xl3DBar, xl3DColumn, xl3DLine, xl3DPie, xl3DSurface, xlDoughnut, or xlDefaultAutoFormat. \r\n 4.  Format: Optional Variant. The option number for the built-in autoformats. Can be a number from 1 through 10, depending on the gallery type. If this argument is omitted, Microsoft Excel chooses a default value based on the gallery type and data source. \r\n 5.  PlotBy: Optional Variant. Specifies whether the data for each series is in rows or columns. Can be one of the following XlRowCol constants: xlRows or xlColumns. \r\n 6.  CategoryLabels: Optional Variant. An integer specifying the number of rows or columns within the source range that contain category labels. Legal values are from 0 (zero) through one less than the maximum number of the corresponding categories or series. \r\n 7.  SeriesLabels: Optional Variant. An integer specifying the number of rows or columns within the source range that contain series labels. Legal values are from 0 (zero) through one less than the maximum number of the corresponding categories or series. \r\n 8.  HasLegend: Optional Variant. True to include a legend. \r\n 9.  Title: Optional Variant. The chart title text. \r\n10.  CategoryTitle: Optional Variant. The category axis title text. \r\n11.  ValueTitle: Optional Variant. The value axis title text. \r\n12.  ExtraTitle: Optional Variant. The series axis title for 3-D charts or the second value axis title for 2-D charts. \r\n\r\nPay special attention to Item 2. If Source is omitted and either the selection isn't an embedded chart on the active worksheet or the active sheet isn't an existing chart, this method fails and an error occurs. \r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"5","CategoryDescription":"ASP"},"Keywords":["Chart","Excel"]},{"RecordId":"466","Title":"Raise a File Download Dialog for a Known MIME Type","Description":"Displays a file download dialog box instead of displaying the document inside of the browser","Code":"When you serve a document from a Web server, you might want to immediately prompt the user to save the file directly to the user's disk, without opening it in the browser. However, for known MIME (Multipurpose Internet Mail Extensions) types such as Microsoft Word (\"application/ms-word\"), the default behavior is to open the document in Internet Explorer.\r\n\r\nYou can use the content-disposition header to override this default behavior. Its format is: \r\n  Content-disposition: attachment; filename=fname.ext \r\n\r\nContent-disposition is an extension to the MIME protocol that instructs a MIME user agent on how it should display an attached file. The range of valid values for content-disposition are discussed in Request for Comment (RFC) 1806 (see the \"References\" section of this article). This article focuses on the \"attachment\" argument, which instructs a user agent (in this case, Internet Explorer) to save a file to disk instead of saving it inline.\r\n\r\nWhen Internet Explorer receives the header, it raises a File Download dialog box whose file name box is automatically populated with the file name that is specified in the header. (Note that this is by design; there is no way to use this feature to save a document to the user's computer without prompting him or her for a save location.)\r\n\r\nThere are two ways that you can use Internet Explorer to specify a content-disposition header for a file: dynamically and statically.\r\n\r\nTo apply the header dynamically, create an Active Server Pages (ASP) file that writes the document out to the browser. Use the Response.AddHeader method to add the content-disposition header. For example: \r\n\r\nResponse.AddHeader \"content-disposition\",\"attachment; filename=fname.ext\" \r\nInstructions on how to perform a binary write for nontext documents are available in the following Microsoft Knowledge Base article: \r\n     Q193998 HOWTO: Read and Display Binary Data in ASP \r\nThis technique is ideal when you want to protect a document store on your server, especially one that exists outside of the Web root.\r\n\r\nTo apply the header statically, right-click the document in the Internet Service Manager, and then select Properties. Select the HTTP Headers tab and enter the content-disposition header there. This works best when you only want to apply content-disposition to a few files on your system and don't require the overhead of ASP.\r\n\r\nPlease note that this solution will not work in Internet Explorer 4.01 due to a bug.","Declares":"","CodeCategory":{"CategoryId":"2","CategoryDescription":"Web"},"Keywords":["Content Disposition","MIME","File Download"]},{"RecordId":"467","Title":"Confirm Form Submit With Message Box","Description":"Displays a confirmation msgbox to ask if the user really wants to submit the form","Code":"----------------------------------------------------------------------------------\r\nSUBMIT BUTTON\r\n----------------------------------------------------------------------------------\r\n<INPUT TYPE=\"Submit\" \r\n              VALUE=\"Save Data\" \r\n              onClick=\"if (confirm('Are you sure you want to post this item?')) {return (true);} else {return (false);}\">\r\n\r\n\r\n----------------------------------------------------------------------------------\r\nFORM\r\n----------------------------------------------------------------------------------\r\n<form action=\"faq_admin_savedata.asp\" method=\"post\" name=\"frm\" onsubmit=\"return Validate_Form(this)\">\r\n","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["Submit","Confirm","Form Post"]},{"RecordId":"468","Title":"Upload File To Web Server","Description":"Demonstrates how to upload a file from the browser to the web server.","Code":"'-------------------------------------------------------------------------------------------\r\n'  NOTE:  This sample consists of 5 files.\r\n'      1.  uploadForm.htm - The form that the upload request comes from.\r\n'      2.  upload.asp - Shared code for the following 3 asp files.\r\n'      3.  outputFile.asp - Uploads the file to the webserver.  This is one that actually\r\n'                                    creates the file on the web server.\r\n'      4.  outputClient.asp - Reads information about the file and returns it to the client.\r\n'                                       No actual file creation on the web server occurs.\r\n'      5.  binaryOutputClient.asp - Similar to outputClient.asp, except it displays the file to \r\n'                                       the client.  No actual file creation on the web server occurs.\r\n'-------------------------------------------------------------------------------------------\r\n\r\n'-------------------------------------------------------------------------------------------\r\n' 1. uploadForm.htm\r\n'-------------------------------------------------------------------------------------------\r\n<HTML>\r\n<HEAD>\r\n\t<TITLE>Upload Form</TITLE>\r\n</HEAD>\r\n\r\n<BODY>\r\n\r\n<B>Output to client</b>\r\n<FORM METHOD=\"Post\" ENCTYPE=\"multipart/form-data\" ACTION=\"outputClient.asp\">\r\n\tEmail : <INPUT TYPE=\"Text\" NAME=\"email\" VALUE=\"PhCollignon@email.com\"><BR>\r\n\tPicture : <INPUT TYPE=\"file\" NAME=\"blob\"><BR>\r\n\t<INPUT TYPE=\"submit\" NAME=\"Enter\">\r\n</FORM>\r\n\r\n<B>Binary output to client</b>\r\n<FORM METHOD=\"Post\" ENCTYPE=\"multipart/form-data\" ACTION=\"binaryOutputClient.asp\">\r\n\tEmail : <INPUT TYPE=\"Text\" NAME=\"email\" VALUE=\"PhCollignon@email.com\"><BR>\r\n\tPicture : <INPUT TYPE=\"file\" NAME=\"blob\"><BR>\r\n\t<INPUT TYPE=\"submit\" NAME=\"Enter\">\r\n</FORM>\r\n\r\n<B>Output to file system</b>\r\n<FORM METHOD=\"Post\" ENCTYPE=\"multipart/form-data\" ACTION=\"outputFile.asp\">\r\n\tEmail : <INPUT TYPE=\"Text\" NAME=\"email\" VALUE=\"PhCollignon@email.com\"><BR>\r\n\tPicture : <INPUT TYPE=\"file\" NAME=\"blob\"><BR>\r\n\t<INPUT TYPE=\"submit\" NAME=\"Enter\">\r\n</FORM>\r\n\r\n</BODY>\r\n</HTML>\r\n\r\n'-------------------------------------------------------------------------------------------\r\n' 2. upload.asp\r\n'-------------------------------------------------------------------------------------------\r\n<%\r\n\r\nSub BuildUploadRequest(RequestBin)\r\n\t'Get the boundary\r\n\tPosBeg = 1\r\n\tPosEnd = InstrB(PosBeg,RequestBin,getByteString(chr(13)))\r\n\tboundary = MidB(RequestBin,PosBeg,PosEnd-PosBeg)\r\n\tboundaryPos = InstrB(1,RequestBin,boundary)\r\n\t'Get all data inside the boundaries\r\n\tDo until (boundaryPos=InstrB(RequestBin,boundary & getByteString(\"--\")))\r\n\t\t'Members variable of objects are put in a dictionary object\r\n\t\tDim UploadControl\r\n\t\tSet UploadControl = CreateObject(\"Scripting.Dictionary\")\r\n\t\t'Get an object name\r\n\t\tPos = InstrB(BoundaryPos,RequestBin,getByteString(\"Content-Disposition\"))\r\n\t\tPos = InstrB(Pos,RequestBin,getByteString(\"name=\"))\r\n\t\tPosBeg = Pos+6\r\n\t\tPosEnd = InstrB(PosBeg,RequestBin,getByteString(chr(34)))\r\n\t\tName = getString(MidB(RequestBin,PosBeg,PosEnd-PosBeg))\r\n\t\tPosFile = InstrB(BoundaryPos,RequestBin,getByteString(\"filename=\"))\r\n\t\tPosBound = InstrB(PosEnd,RequestBin,boundary)\r\n\t\t'Test if object is of file type\r\n\t\tIf  PosFile<>0 AND (PosFile<PosBound) Then\r\n\t\t\t'Get Filename, content-type and content of file\r\n\t\t\tPosBeg = PosFile + 10\r\n\t\t\tPosEnd =  InstrB(PosBeg,RequestBin,getByteString(chr(34)))\r\n\t\t\tFileName = getString(MidB(RequestBin,PosBeg,PosEnd-PosBeg))\r\n\t\t\t'Add filename to dictionary object\r\n\t\t\tUploadControl.Add \"FileName\", FileName\r\n\t\t\tPos = InstrB(PosEnd,RequestBin,getByteString(\"Content-Type:\"))\r\n\t\t\tPosBeg = Pos+14\r\n\t\t\tPosEnd = InstrB(PosBeg,RequestBin,getByteString(chr(13)))\r\n\t\t\t'Add content-type to dictionary object\r\n\t\t\tContentType = getString(MidB(RequestBin,PosBeg,PosEnd-PosBeg))\r\n\t\t\tUploadControl.Add \"ContentType\",ContentType\r\n\t\t\t'Get content of object\r\n\t\t\tPosBeg = PosEnd+4\r\n\t\t\tPosEnd = InstrB(PosBeg,RequestBin,boundary)-2\r\n\t\t\tValue = MidB(RequestBin,PosBeg,PosEnd-PosBeg)\r\n\t\t\tElse\r\n\t\t\t'Get content of object\r\n\t\t\tPos = InstrB(Pos,RequestBin,getByteString(chr(13)))\r\n\t\t\tPosBeg = Pos+4\r\n\t\t\tPosEnd = InstrB(PosBeg,RequestBin,boundary)-2\r\n\t\t\tValue = getString(MidB(RequestBin,PosBeg,PosEnd-PosBeg))\r\n\t\tEnd If\r\n\t\t'Add content to dictionary object\r\n\tUploadControl.Add \"Value\" , Value\t\r\n\t\t'Add dictionary object to main dictionary\r\n\tUploadRequest.Add name, UploadControl\t\r\n\t\t'Loop to next object\r\n\t\tBoundaryPos=InstrB(BoundaryPos+LenB(boundary),RequestBin,boundary)\r\n\tLoop\r\n\r\nEnd Sub\r\n\r\n'String to byte string conversion\r\nFunction getByteString(StringStr)\r\n For i = 1 to Len(StringStr)\r\n \tchar = Mid(StringStr,i,1)\r\n\tgetByteString = getByteString & chrB(AscB(char))\r\n Next\r\nEnd Function\r\n\r\n'Byte string to string conversion\r\nFunction getString(StringBin)\r\n getString =\"\"\r\n For intCount = 1 to LenB(StringBin)\r\n\tgetString = getString & chr(AscB(MidB(StringBin,intCount,1))) \r\n Next\r\nEnd Function\r\n\r\n%>\r\n\r\n'-------------------------------------------------------------------------------------------\r\n' 3. outputFile.asp\r\n'-------------------------------------------------------------------------------------------\r\n<%\r\n\r\nResponse.Expires=0\r\nResponse.Buffer = TRUE\r\nResponse.Clear\r\n\r\nbyteCount = Request.TotalBytes\r\n\r\nRequestBin = Request.BinaryRead(byteCount)\r\nDim UploadRequest\r\nSet UploadRequest = CreateObject(\"Scripting.Dictionary\")\r\n\r\nBuildUploadRequest  RequestBin\r\n\r\nemail = UploadRequest.Item(\"email\").Item(\"Value\")\r\n\r\ncontentType = UploadRequest.Item(\"blob\").Item(\"ContentType\")\r\nfilepathname = UploadRequest.Item(\"blob\").Item(\"FileName\")\r\nfilename = Right(filepathname,Len(filepathname)-InstrRev(filepathname,\"\\\"))\r\nvalue = UploadRequest.Item(\"blob\").Item(\"Value\")\r\n\r\n'Create FileSytemObject Component\r\n Set ScriptObject = Server.CreateObject(\"Scripting.FileSystemObject\")\r\n\r\n'Create and Write to a File\r\n pathEnd = Len(Server.mappath(Request.ServerVariables(\"PATH_INFO\")))-14\r\n Set MyFile = ScriptObject.CreateTextFile(Left(Server.mappath(Request.ServerVariables(\"PATH_INFO\")),pathEnd)&\"uploaded\"&filename)\r\n \r\n For i = 1 to LenB(value)\r\n\t MyFile.Write chr(AscB(MidB(value,i,1)))\r\n Next\r\n \r\n MyFile.Close\r\n%>\r\n<b>Uploaded file : </b><%=\"uploaded\"&filename%><BR>\r\n<img src=\"<%=\"uploaded\"&filename%>\">\r\n<!--#include file=\"upload.asp\"-->\r\n\r\n'-------------------------------------------------------------------------------------------\r\n' 4. outputClient.asp\r\n'-------------------------------------------------------------------------------------------\r\n<%\r\n\r\nResponse.Buffer = TRUE\r\nResponse.Clear\r\n\r\nbyteCount = Request.TotalBytes\r\n\r\nRequestBin = Request.BinaryRead(byteCount)\r\nDim UploadRequest\r\nSet UploadRequest = CreateObject(\"Scripting.Dictionary\")\r\n\r\nBuildUploadRequest  RequestBin\r\n\r\nemail = UploadRequest.Item(\"email\").Item(\"Value\")\r\n\r\ncontentType = UploadRequest.Item(\"blob\").Item(\"ContentType\")\r\nfilepathname = UploadRequest.Item(\"blob\").Item(\"FileName\")\r\nfilename = Right(filepathname,Len(filepathname)-InstrRev(filepathname,\"\\\"))\r\nvalue = UploadRequest.Item(\"blob\").Item(\"Value\")\r\n%>\r\n\r\nYour email is : <%= email %><BR>\r\nFile name of you picture is <%=filepathname%><BR>\r\nFile type of your picture is <%=contentType%><BR>\r\n\r\n<!--#include file=\"upload.asp\"-->\r\n\r\n'-------------------------------------------------------------------------------------------\r\n' 5. binaryOutputClient.asp\r\n'-------------------------------------------------------------------------------------------\r\n<%\r\n\r\nResponse.Buffer = TRUE\r\nResponse.Clear\r\nbyteCount = Request.TotalBytes\r\n\r\nRequestBin = Request.BinaryRead(byteCount)\r\nDim UploadRequest\r\nSet UploadRequest = CreateObject(\"Scripting.Dictionary\")\r\n\r\nBuildUploadRequest  RequestBin\r\n\r\nemail = UploadRequest.Item(\"email\").Item(\"Value\")\r\n\r\ncontentType =  UploadRequest.Item(\"blob\").Item(\"ContentType\")\r\nfilepathname = UploadRequest.Item(\"blob\").Item(\"FileName\")\r\nfilename = Right(filepathname,Len(filepathname)-InstrRev(filepathname,\"\\\"))\r\npicture = UploadRequest.Item(\"blob\").Item(\"Value\")\r\n\r\nResponse.ContentType = contentType\r\nResponse.binaryWrite picture\r\n\r\n%>\r\n<!--#include file=\"upload.asp\"-->\r\n","Declares":"","CodeCategory":{"CategoryId":"5","CategoryDescription":"ASP"},"Keywords":["File Upload","Upload"]},{"RecordId":"469","Title":"Date Selection Combo Box","Description":"Uses 3 combo boxes for mm dd yyyy entry and dynamically re-populates dd combo based on mm or yyyy selection.","Code":"---------------------------------------------------------------------------------------\r\nNOTE:  There are 3 parts to this sample.  \r\n             1.  The first part is the sample that creates the date selection combo.  \r\n             2.  The second part is the JavaScript code that dynamically changes \r\n                   the day combo based on either the month or year changing.\r\n             3.  The third part is the JavaScript code to insure that the enddate is after \r\n                  the start date.\r\n---------------------------------------------------------------------------------------\r\nPart 1:  \r\nSet up date selection combo boxes, 1 for mm, 1 for dd, and 1 for yyyy.\r\n----------------------------------------------------------------------------------------\r\n<select name=\"optStartMonth\" size=\"1\" onChange=\"ChangeCombo('frm','optStartMonth','optStartDay','optStartYear')\">\r\n\r\n\t<% for i = 1 to 12\r\n\t\tif i < 10 then\r\n\t\t\tsMM = \"0\" & cstr(i)\r\n\t\telse\r\n\t\t\tsMM = cstr(i)\r\n\t\tend if\r\n\t\tresponse.write \"<option value=\" & sMM \r\n\t\tif strStartMM = i then\r\n\t\t\tresponse.write \" SELECTED\"\r\n\t\tend if\r\n\t\tresponse.write \">\" & sMM\r\n\t   next\r\n\t%> \r\n</select>\r\n/\r\n<select name=\"optStartDay\" size=\"1\">\r\n\t<% for i = 1 to 31\r\n\t\tif i < 10 then\r\n\t\t\tsDD = \"0\" & cstr(i)\r\n\t\telse\r\n\t\t\tsDD = cstr(i)\r\n\t\tend if\r\n\t\tresponse.write \"<option value=\" & sDD \r\n\t\tif strStartDD = i then\r\n\t\t\tresponse.write \" SELECTED\"\r\n\t\tend if\r\n\t\tresponse.write \">\" & sDD\r\n\t   next\r\n\t%> \r\n</select>\r\n/\r\n<select name=\"optStartYear\" size=\"1\" onChange=\"ChangeCombo('frm','optStartMonth','optStartDay','optStartYear')\">\r\n\t<% \r\n\t\r\n\tsYYYY = cstr(Year(Date))\r\n\tif (trim(strStartYYYY) <> \"\") and (cint(strStartYYYY) < cint(sYYYY)) then\r\n\t\tsYYYY = strStartYYYY\r\n\tend if\r\n\r\n\tfor i = sYYYY to Year(Date) + 3\r\n\t\tresponse.write \"<option value=\" & cstr(i)\r\n\t\tif i = strStartYYYY then\r\n\t\t\tresponse.write \" SELECTED\"\r\n\t\tend if\r\n\t\tresponse.write \">\" & cstr(i)\r\n\tnext\r\n\t%> \r\n</select>\r\n\r\n---------------------------------------------------------------------------------------\r\nPart 2:  \r\n ChangeCombo function:\r\n Recreates the \"day\" combo box after the user selects either a new year or month.  \r\n This repopulates the \"day\" combo with the correct number of days for the selected month.\r\n---------------------------------------------------------------------------------------\r\nfunction ChangeCombo(frm1,optMM,optDD,optYY){\r\n\r\n\tvar iEnd;\r\n\tvar i;\r\n\tvar strDay;\r\n\tvar iYear = parseInt(eval(frm1+'.'+optYY).value);\r\n\tvar iMonth = parseInt(eval(frm1+'.'+optMM).value);\r\n\r\n\t// Leap year?\r\n\tvar blnLeapYear = false;\r\n\tif (iYear % 4 == 0){\r\n\t\tblnLeapYear = true;\r\n\t} else {\r\n\t\tblnLeapYear = false;\r\n\t}\r\n\t\r\n\t// Determine number of days in the selected month\r\n\tswitch(iMonth) {\r\n\t\tcase 2:\r\n\t\t\tif (blnLeapYear) {\r\n\t\t\t\tiEnd = 29;\r\n\t\t\t}else{\r\n\t\t\t\tiEnd = 28;\r\n\t\t\t}\r\n\t\t\tbreak;\r\n\t\tcase 4:\r\n\t\tcase 6:\r\n\t\tcase 9:\r\n\t\tcase 11:\r\n\t\t\tiEnd = 30;\r\n\t\t\tbreak;\r\n\t\tdefault:\r\n\t\t\tiEnd = 31;\r\n\t\t\tbreak;\r\n\t}\r\n\t\r\n\t// Re-create the day list box\r\n\tvar frmEl = eval(frm1+'.'+optDD);\r\n\tfrmEl.options.length=iEnd;\r\n\t\r\n\tfor (i=0; i< iEnd; i++) {\r\n\t\tif (i < 9) {\r\n\t\t\tstrDay = '0' + (i+1);\r\n\t\t} else {\r\n\t\t\tstrDay = i+1;\r\n\t\t}\r\n\t\tfrmEl.options[i].value = strDay;\r\n\t\tfrmEl.options[i].text = strDay;\r\n\t}\r\n}\r\n\r\n---------------------------------------------------------------------------------------\r\nPart 3:  \r\n Validation code to insure that end date is after start date.\r\n---------------------------------------------------------------------------------------\r\n\r\n// Start Date must be before End Date\r\nvar sMonth = f.optEndMonth.value;\r\nvar sDay = f.optEndDay.value;\r\nvar sYear = f.optEndYear.value;\r\nvar sDate=sMonth+'/'+sDay+'/'+sYear;\r\nvar dEndDate = Date.parse(sMonth+'/'+sDay+'/'+sYear);\r\n\r\nvar sMonth = f.optStartMonth.value;\r\nvar sDay = f.optStartDay.value;\r\nvar sYear = f.optStartYear.value;\r\nvar sDate=sMonth+'/'+sDay+'/'+sYear;\r\nvar dStart = Date.parse(sMonth+'/'+sDay+'/'+sYear);\r\n\t\t\r\nif (dStart >= dEndDate) {\r\n\tstrError = 'Y';\r\n\talert(\"End Date must be later than Start Date.\");\r\n\tf.optEndYear.focus();\r\n}","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["Date Combo","Date","Date Selection"]},{"RecordId":"470","Title":"ADO Includes","Description":"ADO constants","Code":"rs.Open strSQL, oConn, CursorType, LockType\r\n\r\n<%\r\n'--------------------------------------------------------------------\r\n' Microsoft ADO\r\n'\r\n' (c) 1996 Microsoft Corporation.  All Rights Reserved.\r\n'\r\n' ADO constants include file for VBScript\r\n'\r\n'--------------------------------------------------------------------\r\n\r\n'---- CursorTypeEnum Values ----\r\nConst adOpenForwardOnly = 0\r\nConst adOpenKeyset = 1\r\nConst adOpenDynamic = 2\r\nConst adOpenStatic = 3\r\n\r\n'---- CursorOptionEnum Values ----\r\nConst adHoldRecords = &H00000100\r\nConst adMovePrevious = &H00000200\r\nConst adAddNew = &H01000400\r\nConst adDelete = &H01000800\r\nConst adUpdate = &H01008000\r\nConst adBookmark = &H00002000\r\nConst adApproxPosition = &H00004000\r\nConst adUpdateBatch = &H00010000\r\nConst adResync = &H00020000\r\nConst adNotify = &H00040000\r\n\r\n'---- LockTypeEnum Values ----\r\nConst adLockReadOnly = 1\r\nConst adLockPessimistic = 2\r\nConst adLockOptimistic = 3\r\nConst adLockBatchOptimistic = 4\r\n\r\n'---- ExecuteOptionEnum Values ----\r\nConst adRunAsync = &H00000010\r\n\r\n'---- ObjectStateEnum Values ----\r\nConst adStateClosed = &H00000000\r\nConst adStateOpen = &H00000001\r\nConst adStateConnecting = &H00000002\r\nConst adStateExecuting = &H00000004\r\n\r\n'---- CursorLocationEnum Values ----\r\nConst adUseServer = 2\r\nConst adUseClient = 3\r\n\r\n'---- DataTypeEnum Values ----\r\nConst adEmpty = 0\r\nConst adTinyInt = 16\r\nConst adSmallInt = 2\r\nConst adInteger = 3\r\nConst adBigInt = 20\r\nConst adUnsignedTinyInt = 17\r\nConst adUnsignedSmallInt = 18\r\nConst adUnsignedInt = 19\r\nConst adUnsignedBigInt = 21\r\nConst adSingle = 4\r\nConst adDouble = 5\r\nConst adCurrency = 6\r\nConst adDecimal = 14\r\nConst adNumeric = 131\r\nConst adBoolean = 11\r\nConst adError = 10\r\nConst adUserDefined = 132\r\nConst adVariant = 12\r\nConst adIDispatch = 9\r\nConst adIUnknown = 13\r\nConst adGUID = 72\r\nConst adDate = 7\r\nConst adDBDate = 133\r\nConst adDBTime = 134\r\nConst adDBTimeStamp = 135\r\nConst adBSTR = 8\r\nConst adChar = 129\r\nConst adVarChar = 200\r\nConst adLongVarChar = 201\r\nConst adWChar = 130\r\nConst adVarWChar = 202\r\nConst adLongVarWChar = 203\r\nConst adBinary = 128\r\nConst adVarBinary = 204\r\nConst adLongVarBinary = 205\r\n\r\n'---- FieldAttributeEnum Values ----\r\nConst adFldMayDefer = &H00000002\r\nConst adFldUpdatable = &H00000004\r\nConst adFldUnknownUpdatable = &H00000008\r\nConst adFldFixed = &H00000010\r\nConst adFldIsNullable = &H00000020\r\nConst adFldMayBeNull = &H00000040\r\nConst adFldLong = &H00000080\r\nConst adFldRowID = &H00000100\r\nConst adFldRowVersion = &H00000200\r\nConst adFldCacheDeferred = &H00001000\r\n\r\n'---- EditModeEnum Values ----\r\nConst adEditNone = &H0000\r\nConst adEditInProgress = &H0001\r\nConst adEditAdd = &H0002\r\nConst adEditDelete = &H0004\r\n\r\n'---- RecordStatusEnum Values ----\r\nConst adRecOK = &H0000000\r\nConst adRecNew = &H0000001\r\nConst adRecModified = &H0000002\r\nConst adRecDeleted = &H0000004\r\nConst adRecUnmodified = &H0000008\r\nConst adRecInvalid = &H0000010\r\nConst adRecMultipleChanges = &H0000040\r\nConst adRecPendingChanges = &H0000080\r\nConst adRecCanceled = &H0000100\r\nConst adRecCantRelease = &H0000400\r\nConst adRecConcurrencyViolation = &H0000800\r\nConst adRecIntegrityViolation = &H0001000\r\nConst adRecMaxChangesExceeded = &H0002000\r\nConst adRecObjectOpen = &H0004000\r\nConst adRecOutOfMemory = &H0008000\r\nConst adRecPermissionDenied = &H0010000\r\nConst adRecSchemaViolation = &H0020000\r\nConst adRecDBDeleted = &H0040000\r\n\r\n'---- GetRowsOptionEnum Values ----\r\nConst adGetRowsRest = -1\r\n\r\n'---- PositionEnum Values ----\r\nConst adPosUnknown = -1\r\nConst adPosBOF = -2\r\nConst adPosEOF = -3\r\n\r\n'---- enum Values ----\r\nConst adBookmarkCurrent = 0\r\nConst adBookmarkFirst = 1\r\nConst adBookmarkLast = 2\r\n\r\n'---- MarshalOptionsEnum Values ----\r\nConst adMarshalAll = 0\r\nConst adMarshalModifiedOnly = 1\r\n\r\n'---- AffectEnum Values ----\r\nConst adAffectCurrent = 1\r\nConst adAffectGroup = 2\r\nConst adAffectAll = 3\r\n\r\n'---- FilterGroupEnum Values ----\r\nConst adFilterNone = 0\r\nConst adFilterPendingRecords = 1\r\nConst adFilterAffectedRecords = 2\r\nConst adFilterFetchedRecords = 3\r\nConst adFilterPredicate = 4\r\n\r\n'---- SearchDirection Values ----\r\nConst adSearchForward = 1\r\nConst adSearchBackward = -1\r\n\r\n'---- ConnectPromptEnum Values ----\r\nConst adPromptAlways = 1\r\nConst adPromptComplete = 2\r\nConst adPromptCompleteRequired = 3\r\nConst adPromptNever = 4\r\n\r\n'---- ConnectModeEnum Values ----\r\nConst adModeUnknown = 0\r\nConst adModeRead = 1\r\nConst adModeWrite = 2\r\nConst adModeReadWrite = 3\r\nConst adModeShareDenyRead = 4\r\nConst adModeShareDenyWrite = 8\r\nConst adModeShareExclusive = &Hc\r\nConst adModeShareDenyNone = &H10\r\n\r\n'---- IsolationLevelEnum Values ----\r\nConst adXactUnspecified = &Hffffffff\r\nConst adXactChaos = &H00000010\r\nConst adXactReadUncommitted = &H00000100\r\nConst adXactBrowse = &H00000100\r\nConst adXactCursorStability = &H00001000\r\nConst adXactReadCommitted = &H00001000\r\nConst adXactRepeatableRead = &H00010000\r\nConst adXactSerializable = &H00100000\r\nConst adXactIsolated = &H00100000\r\n\r\n'---- XactAttributeEnum Values ----\r\nConst adXactCommitRetaining = &H00020000\r\nConst adXactAbortRetaining = &H00040000\r\n\r\n'---- PropertyAttributesEnum Values ----\r\nConst adPropNotSupported = &H0000\r\nConst adPropRequired = &H0001\r\nConst adPropOptional = &H0002\r\nConst adPropRead = &H0200\r\nConst adPropWrite = &H0400\r\n\r\n'---- ErrorValueEnum Values ----\r\nConst adErrInvalidArgument = &Hbb9\r\nConst adErrNoCurrentRecord = &Hbcd\r\nConst adErrIllegalOperation = &Hc93\r\nConst adErrInTransaction = &Hcae\r\nConst adErrFeatureNotAvailable = &Hcb3\r\nConst adErrItemNotFound = &Hcc1\r\nConst adErrObjectInCollection = &Hd27\r\nConst adErrObjectNotSet = &Hd5c\r\nConst adErrDataConversion = &Hd5d\r\nConst adErrObjectClosed = &He78\r\nConst adErrObjectOpen = &He79\r\nConst adErrProviderNotFound = &He7a\r\nConst adErrBoundToCommand = &He7b\r\nConst adErrInvalidParamInfo = &He7c\r\nConst adErrInvalidConnection = &He7d\r\nConst adErrStillExecuting = &He7f\r\nConst adErrStillConnecting = &He81\r\n\r\n'---- ParameterAttributesEnum Values ----\r\nConst adParamSigned = &H0010\r\nConst adParamNullable = &H0040\r\nConst adParamLong = &H0080\r\n\r\n'---- ParameterDirectionEnum Values ----\r\nConst adParamUnknown = &H0000\r\nConst adParamInput = &H0001\r\nConst adParamOutput = &H0002\r\nConst adParamInputOutput = &H0003\r\nConst adParamReturnValue = &H0004\r\n\r\n'---- CommandTypeEnum Values ----\r\nConst adCmdUnknown = &H0008\r\nConst adCmdText = &H0001\r\nConst adCmdTable = &H0002\r\nConst adCmdStoredProc = &H0004\r\n\r\n'---- SchemaEnum Values ----\r\nConst adSchemaProviderSpecific = -1\r\nConst adSchemaAsserts = 0\r\nConst adSchemaCatalogs = 1\r\nConst adSchemaCharacterSets = 2\r\nConst adSchemaCollations = 3\r\nConst adSchemaColumns = 4\r\nConst adSchemaCheckConstraints = 5\r\nConst adSchemaConstraintColumnUsage = 6\r\nConst adSchemaConstraintTableUsage = 7\r\nConst adSchemaKeyColumnUsage = 8\r\nConst adSchemaReferentialContraints = 9\r\nConst adSchemaTableConstraints = 10\r\nConst adSchemaColumnsDomainUsage = 11\r\nConst adSchemaIndexes = 12\r\nConst adSchemaColumnPrivileges = 13\r\nConst adSchemaTablePrivileges = 14\r\nConst adSchemaUsagePrivileges = 15\r\nConst adSchemaProcedures = 16\r\nConst adSchemaSchemata = 17\r\nConst adSchemaSQLLanguages = 18\r\nConst adSchemaStatistics = 19\r\nConst adSchemaTables = 20\r\nConst adSchemaTranslations = 21\r\nConst adSchemaProviderTypes = 22\r\nConst adSchemaViews = 23\r\nConst adSchemaViewColumnUsage = 24\r\nConst adSchemaViewTableUsage = 25\r\nConst adSchemaProcedureParameters = 26\r\nConst adSchemaForeignKeys = 27\r\nConst adSchemaPrimaryKeys = 28\r\nConst adSchemaProcedureColumns = 29\r\n%>","Declares":"","CodeCategory":{"CategoryId":"3","CategoryDescription":"Database"},"Keywords":["ADO","Includes"]},{"RecordId":"472","Title":"Dialog - Modal/Modeless","Description":"Demonstrates modal and modeless dialogs and communicating between windows.","Code":"---------------------------------------------------------------------------------------------------------------\r\n This sample consists of 2 files:\r\n    dialog3.htm - Main page\r\n    dcontent3.htm - Modeless dialog\r\n---------------------------------------------------------------------------------------------------------------\r\n---------------------------------------------------------------------------------------------------------------\r\n-- dialog3.htm --\r\n---------------------------------------------------------------------------------------------------------------\r\n<HTML>\r\n<HEAD>\r\n</HEAD>\r\n<SCRIPT>\r\nvar dWin=null;\r\nfunction doDialog()\r\n{\r\ndWin=showModelessDialog('dcontent3.htm',window,'status:no;resizable:yes');\r\n}\r\n\r\nfunction setDialogValue()\r\n{\r\n  if (dWin != null)\r\n  {\r\n   dWin.d1.innerHTML=ip1.value;\r\n  }\r\n}\r\n</SCRIPT>\r\n<BODY>\r\nThis page will invoke my DHTML dialog box when the button is clicked.\r\n<BR><BR>\r\n<INPUT type=text id=ip1 value='input content'>\r\n<BR><BR>\r\n<input type='button' onclick=\"setDialogValue();\" value=\"Set Dialog Value\">\r\n<BR><BR>\r\n<input type='button' onclick=\"doDialog();\" value=\"Create Dialog\">\r\n<BR><BR>\r\n<DIV id=d1></DIV>\r\n</BODY>\r\n</HTML>\r\n\r\n---------------------------------------------------------------------------------------------------------------\r\n-- dcontent3.htm --\r\n---------------------------------------------------------------------------------------------------------------\r\n<HTML>\r\n<SCRIPT>\r\nfunction window.onunload()\r\n{\r\n  dialogArguments.dWin=null;\r\n}\r\n</SCRIPT>\r\n\r\n<BODY style=\"background-color:lightblue;margin:10;\">\r\nThis is some content for my DHTML dialog box.\r\n<BR><BR>\r\n<DIV id=d1></DIV>\r\n<BR><BR>\r\n<input type='text' id=ip1 onclick='dialogArguments.d1.innerHTML=ip1.value;'>\r\n<BR><BR>\r\n<input type='button' onclick=\"dialogArguments.d1.innerHTML=ip1.value;\" value=\" Apply \"> &nbsp&nbsp&nbsp\r\n<input type='button' onclick=\"dialogArguments.d1.innerHTML=ip1.value;window.close();\" value=\" OK \">\r\n&nbsp&nbsp&nbsp\r\n<input type='button' onclick=\"window.close();\" value=\" Cancel \">\r\n\r\n</BODY>\r\n</HTML>","Declares":"","CodeCategory":{"CategoryId":"2","CategoryDescription":"Web"},"Keywords":["Modal","Modeless","Dialog"]},{"RecordId":"473","Title":"State Selection","Description":"State Selection combo box","Code":"<select name=\"txtUSstate\" size=\"1\">\r\n  <option value=\"  \" selected> </option>\r\n  <option value=\"AK\">AK</option>\r\n  <option value=\"AL\">AL</option>\r\n  <option value=\"AR\">AR</option>\r\n  <option value=\"AS\">AS</option>\r\n  <option value=\"AZ\">AZ</option>\r\n  <option value=\"CA\">CA</option>\r\n  <option value=\"CO\">CO</option>\r\n  <option value=\"CT\">CT</option>\r\n  <option value=\"DC\">DC</option>\r\n  <option value=\"DE\">DE</option>\r\n  <option value=\"FL\">FL</option>\r\n  <option value=\"FM\">FM</option>\r\n  <option value=\"GA\">GA</option>\r\n  <option value=\"GU\">GU</option>\r\n  <option value=\"HI\">HI</option>\r\n  <option value=\"IA\">IA</option>\r\n  <option value=\"ID\">ID</option>\r\n  <option value=\"IL\">IL</option>\r\n  <option value=\"IN\">IN</option>\r\n  <option value=\"KS\">KS</option>\r\n  <option value=\"KY\">KY</option>\r\n  <option value=\"LA\">LA</option>\r\n  <option value=\"MA\">MA</option>\r\n  <option value=\"MD\">MD</option>\r\n  <option value=\"ME\">ME</option>\r\n  <option value=\"MH\">MH</option>\r\n  <option value=\"MI\">MI</option>\r\n  <option value=\"MN\">MN</option>\r\n  <option value=\"MO\">MO</option>\r\n  <option value=\"MP\">MP</option>\r\n  <option value=\"MS\">MS</option>\r\n  <option value=\"MT\">MT</option>\r\n  <option value=\"NC\">NC</option>\r\n  <option value=\"ND\">ND</option>\r\n  <option value=\"NE\">NE</option>\r\n  <option value=\"NH\">NH</option>\r\n  <option value=\"NJ\">NJ</option>\r\n  <option value=\"NH\">NM</option>\r\n  <option value=\"NV\">NV</option>\r\n  <option value=\"NY\">NY</option>\r\n  <option value=\"OK\">OK</option>\r\n  <option value=\"OH\">OH</option>\r\n  <option value=\"OR\">OR</option>\r\n  <option value=\"PA\">PA</option>\r\n  <option value=\"PR\">PR</option>\r\n  <option value=\"PW\">PW</option>\r\n  <option value=\"RI\">RI</option>\r\n  <option value=\"SC\">SC</option>\r\n  <option value=\"SD\">SD</option>\r\n  <option value=\"TN\">TN</option>\r\n  <option value=\"TX\">TX</option>\r\n  <option value=\"UT\">UT</option>\r\n  <option value=\"VA\">VA</option>\r\n  <option value=\"VI\">VI</option>\r\n  <option value=\"VT\">VT</option>\r\n  <option value=\"WA\">WA</option>\r\n  <option value=\"WI\">WI</option>\r\n  <option value=\"WV\">WV</option>\r\n  <option value=\"WY\">WY</option>\r\n</select>","Declares":"","CodeCategory":{"CategoryId":"2","CategoryDescription":"Web"},"Keywords":["State Selection"]},{"RecordId":"474","Title":"Phone, Zip, Credit Card, EMail, etc. Validation","Description":"Validation routines for email, phone, credit card, blank, numeric fields.","Code":"/*---------------------------------------------------------------------------------------\r\n isBlank function:\r\n Determines if the incoming string is blank (since this doesn't exist in JavaScript).\r\n----------------------------------------------------------------------------------------*/\r\nfunction isBlank (s) {\r\n\tfor (var i = 0; i < s.length; i++) {\r\n\t\tvar c = s.charAt(i);\r\n\t\tif ((c != ' ') && (c != '\\n') && (c != '\\t')) return false;\r\n\t} \r\n\treturn true;\r\n}\r\n\r\n/*---------------------------------------------------------------------------------------\r\n isNumeric function:\r\n Determines if the incoming string contains only numbers 0 - 9.\r\n----------------------------------------------------------------------------------------*/\r\nfunction isNumeric (s) {\r\n\r\n\tvar checkOK = \"0123456789\";\r\n  \tvar allValid = true;\r\n\tvar i, j, ch;\r\n\t\r\n  \tfor (i = 0;  i < s.length;  i++) {\r\n   \t    ch = s.charAt(i);\r\n   \t\tfor (j = 0;  j < checkOK.length;  j++) {\r\n   \t\t\tif (ch == checkOK.charAt(j))\r\n     \t\t\tbreak;\r\n\t\t}\r\n   \t\tif (j == checkOK.length) {\r\n\t\t\tallValid = false;\r\n\t\t\tbreak;\r\n   \t\t}\r\n\t} // for\r\n\r\n\tif (!allValid) {\r\n   \t\treturn (false);\r\n  \t} else {\r\n\t\treturn (true);\r\n\t}\r\n}\r\n\r\n/*---------------------------------------------------------------------------------------\r\n isValidZip function:\r\n Determines if the incoming string is a proper formatted zip code (xxxxx or xxxxx-xxxx).\r\n----------------------------------------------------------------------------------------*/\r\nfunction isValidZip(s) {\r\n\r\n  \tvar checkStr = s;\r\n\tvar i, j, ch;\r\n\tvar checkOK = \"0123456789\";\r\n\t\r\n\tif (isBlank(s)) {\r\n\t\treturn (false);\r\n\t}\r\n\r\n\t// Must be 5 or 10 chars in length\r\n  \tif (checkStr.length != 5 && checkStr.length != 10) {\r\n   \t\treturn (false);\r\n  \t}\r\n\r\n\t// 6th char must be a \"-\"\r\n\tif (checkStr.length == 10 && checkStr.charAt(5) != \"-\") {\r\n   \t\treturn (false);\r\n\t}\r\n\r\n\t// Must contain numbers only (except \"-\" in 6th position)\r\n  \tvar allValid = true;\r\n  \tfor (i = 0;  i < checkStr.length;  i++) {\r\n   \t    ch = checkStr.charAt(i);\r\n\t    if (i != 5) {\r\n    \t\tfor (j = 0;  j < checkOK.length;  j++) {\r\n      \t\t\tif (ch == checkOK.charAt(j))\r\n        \t\t\tbreak;\r\n\t\t\t}\r\n    \t\tif (j == checkOK.length) {\r\n      \t\t\tallValid = false;\r\n      \t\t\tbreak;\r\n    \t\t}\r\n    \t} // if\r\n\t} // for\r\n\r\n\tif (!allValid) {\r\n   \t\treturn (false);\r\n  \t}\r\n\r\n\treturn (true);\r\n}\r\n\r\n\r\n/*---------------------------------------------------------------------------------------\r\n isValidCreditCardNumber function:\r\n Determines if the incoming string is a proper formatted credit card number\r\n----------------------------------------------------------------------------------------*/\r\nfunction isValidCreditCardNumber (sCCType, sCCNumber) {\r\n\r\n\tvar firstdig;\r\n\tvar seconddig;\r\n\tvar first4digs;\r\n\t\r\n\t// Valid card types are M=MasterCard, V=Visa, D=Discover, DC=DinersClub, A=AmericanExpress\r\n\tif ((sCCType != 'M') && (sCCType != 'V') && (sCCType != 'D') && (sCCType != 'DC') && (sCCType != 'A')) {\r\n\t\treturn (false);\r\n\t}\r\n\t\r\n\t// Blank?\r\n\tif (isBlank(sCCNumber))  {\r\n\t\treturn (false);\r\n\t}\r\n\t\r\n\t// All bytes must be numeric\r\n\tif (!isNumeric(sCCNumber)) {\r\n\t\treturn (false);\r\n\t}\r\n\r\n\t// Mastercard\r\n\tif (sCCType == 'M') {\r\n\r\n\t\tif (sCCNumber.length != 16) {\r\n\t\t\treturn (false);\r\n\t\t}\r\n\r\n\t\t// MasterCard first byte must be 5 and second byte must be 1-5\r\n\t\tfirstdig = sCCNumber.substring(0,1);\r\n\t\tseconddig = sCCNumber.substring(1,2);\r\n\t\tif ((firstdig != 5) || (seconddig < 1) || (seconddig > 5)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\t\r\n\t// Visa\r\n\tif (sCCType == 'V') {\r\n\r\n\t\tif ((sCCNumber.length != 16) && (sCCNumber.length != 13)) {\r\n\t\t\treturn (false);\r\n\t\t}\r\n\t\r\n\t\t// Visa first byte must be 4\r\n\t\tfirstdig = sCCNumber.substring(0,1);\r\n\t\tif (firstdig != 4) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\t// Amex must be 15 bytes long\r\n\tif (sCCType == 'A') {\r\n\t\tif (sCCNumber.length != 15) {\r\n\t\t\treturn (false);\r\n\t\t}\r\n\r\n\t\t// Amex first byte must be 3 and second byte must be 4 or 7\r\n\t\tfirstdig = sCCNumber.substring(0,1);\r\n\t\tseconddig = sCCNumber.substring(1,2);\r\n\t\tif ((firstdig != 3) && (seconddig != 4) && (seconddig != 7)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\t// Diners club\r\n\tif (sCCType == 'DC') {\r\n\t\tif (sCCNumber.length != 14) {\r\n\t\t\treturn (false);\r\n\t\t}\r\n\r\n\t\t// Diners club first byte must be 3 and second byte must be 0, 6, or 8\r\n\t\tfirstdig = sCCNumber.substring(0,1);\r\n\t\tseconddig = sCCNumber.substring(1,2);\r\n\t\tif ((firstdig != 3) && (seconddig != 0) && (seconddig != 6) && (seconddig != 8)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\t// Discover\r\n\tif (sCCType == 'D') {\r\n\r\n\t\tif (sCCNumber.length != 16) {\r\n\t\t\treturn (false);\r\n\t\t}\r\n\t\r\n\t\t// Discover first 4 bytes must be 6011\r\n\t\tfirst4digs = sCCNumber.substring(0,4);\r\n\t\tif (first4digs != 6011) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\treturn (true);\r\n}\r\n\r\n\r\n\r\n/*---------------------------------------------------------------------------------------\r\n isValidAreaCode function:\r\n Determines if the incoming string is a proper formatted area code (###)\r\n----------------------------------------------------------------------------------------*/\r\nfunction isValidAreaCode (sAreaCode, blnAllowBlanks) {\r\n\r\n\t// Blank?\r\n\tif (isBlank(sAreaCode))  {\r\n\t\tif (blnAllowBlanks) {\r\n\t\t\treturn (true);\r\n\t\t} else {\r\n\t\t\treturn (false);\r\n\t\t}\r\n\t}\r\n\t\r\n\t// Must be 3 bytes long\r\n\tif (sAreaCode.length != 3) {\r\n\t\treturn (false);\r\n\t}\r\n\t\r\n\t// All 3 bytes must be numeric\r\n\tif (isNumeric(sAreaCode)) {\r\n\t\treturn (true);\r\n\t} else {\r\n\t\treturn (false);\r\n\t}\r\n}\r\n\r\n/*---------------------------------------------------------------------------------------\r\n isValidPhonePrefix function:\r\n Determines if the incoming string is a proper formatted prefix (###)\r\n----------------------------------------------------------------------------------------*/\r\nfunction isValidPhonePrefix (sPrefix, blnAllowBlanks) {\r\n\r\n\t// Blank?\r\n\tif (isBlank(sPrefix))  {\r\n\t\tif (blnAllowBlanks) {\r\n\t\t\treturn (true);\r\n\t\t} else {\r\n\t\t\treturn (false);\r\n\t\t}\r\n\t}\r\n\t\r\n\t// Must be 3 bytes long\r\n\tif (sPrefix.length != 3) {\r\n\t\treturn (false);\r\n\t}\r\n\t\r\n\t// All 3 bytes must be numeric\r\n\tif (isNumeric(sPrefix)) {\r\n\t\treturn (true);\r\n\t} else {\r\n\t\treturn (false);\r\n\t}\r\n}\r\n\r\n\r\n/*---------------------------------------------------------------------------------------\r\n isValidPhoneSuffix function:\r\n Determines if the incoming string is a proper formatted phone suffix (####)\r\n----------------------------------------------------------------------------------------*/\r\nfunction isValidPhoneSuffix (sSuffix, blnAllowBlanks) {\r\n\r\n\t// Blank?\r\n\tif (isBlank(sSuffix))  {\r\n\t\tif (blnAllowBlanks) {\r\n\t\t\treturn (true);\r\n\t\t} else {\r\n\t\t\treturn (false);\r\n\t\t}\r\n\t}\r\n\t\r\n\t// Must be 4 bytes long\r\n\tif (sSuffix.length != 4) {\r\n\t\treturn (false);\r\n\t}\r\n\t\r\n\t// All 4 bytes must be numeric\r\n\tif (isNumeric(sSuffix)) {\r\n\t\treturn (true);\r\n\t} else {\r\n\t\treturn (false);\r\n\t}\r\n}\r\n\r\n\r\n/*---------------------------------------------------------------------------------------\r\n isValidPhoneNumber function:\r\n Determines if the incoming string is a proper formatted phone number (###-###-####).\r\n----------------------------------------------------------------------------------------*/\r\nfunction isValidPhoneNumber(sPhoneNumber, blnAllowBlanks) {\r\n\r\n\tvar ch, strAreaCode, strPrefix, strSuffix;\r\n\r\n\t// Blank?\r\n\tif (isBlank(sPhoneNumber))  {\r\n\t\tif (blnAllowBlanks) {\r\n\t\t\treturn (true);\r\n\t\t} else {\r\n\t\t\treturn (false);\r\n\t\t}\r\n\t}\r\n\t\r\n\t// Must be 12 bytes long\r\n\tif (sPhoneNumber.length != 12) {\r\n\t\treturn (false);\r\n\t}\r\n\r\n\t// Must have '-' between area code and prefix and between prefix and suffix.\r\n\tif ((sPhoneNumber.charAt(3) != '-') || (sPhoneNumber.charAt(7) != '-')) {\r\n\t\treturn (false);\r\n\t}\r\n\r\n\t// Each part of number must be numeric\r\n\tstrAreaCode = sPhoneNumber.substr(0,3)\r\n\tstrPrefix = sPhoneNumber.substr(4,3)\r\n\tstrSuffix = sPhoneNumber.substr(8)\r\n\tif ((isNumeric(strAreaCode) == false) || (isNumeric(strPrefix) == false) || (isNumeric(strSuffix) == false)) {\r\n\t\treturn (false);\r\n\t}\r\n\r\n\treturn (true);\r\n}\r\n\r\n\r\n/*---------------------------------------------------------------------------------------\r\n isValidEMail function:\r\n Determines if the incoming string is a proper formatted email.\r\n----------------------------------------------------------------------------------------*/\r\nfunction isValidEMail(s) {\r\n\r\n    var checkStr = s;\r\n    var NoAtSignFound = true;\r\n    var NoDotFound = true;\r\n    var NoEmbeddedSpaces = true;\r\n    var NoMultipleAtSigns = true;\r\n    var NoDotsInARow = true;\r\n\t\r\n\t// Can't be blank\r\n\tif (isBlank(s)) {\r\n\t\treturn (false);\r\n\t}\r\n\r\n\t// Can't begin with \"@\"\r\n    if (checkStr.charAt(0) == \"@\") {\r\n      return (false);\r\n    }\r\n\r\n\t// Check other bogus characters\r\n\tif (checkStr.indexOf('%') >= 0) return (false);\r\n\tif (checkStr.indexOf(';') >= 0) return (false);\r\n\tif (checkStr.indexOf(' ') >= 0) return (false);\r\n\tif (checkStr.indexOf(\"'\") >= 0) return (false);\r\n\tif (checkStr.indexOf('\"') >= 0) return (false);\r\n\tif (checkStr.indexOf('\\\\') >= 0) return (false);\r\n\tif (checkStr.indexOf('/') >= 0) return (false);\r\n\tif (checkStr.indexOf(':') >= 0) return (false);\r\n\tif (checkStr.indexOf('&') >= 0) return (false);\r\n\tif (checkStr.indexOf('!') >= 0) return (false);\r\n\tif (checkStr.indexOf('?') >= 0) return (false);\r\n\tif (checkStr.indexOf('*') >= 0) return (false);\r\n\tif (checkStr.indexOf('#') >= 0) return (false);\r\n\r\n\t// Must contain \"@\" and \".\"\r\n    var AtSignPos = 0;\r\n  \tvar DotPos = 0;\r\n\r\n\tfor (i = 0;  i < checkStr.length;  i++) {\r\n\t\tch = checkStr.charAt(i);\r\n\t\tif (ch == \"@\") {\r\n\t\t\tif (NoAtSignFound) {\r\n\t\t\t\tNoAtSignFound = false;\r\n\t\t\t\tAtSignPos = i;\r\n\t\t\t} else {\r\n\t\t\t\tNoMultipleAtSigns = false;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (ch == \" \") {\r\n\t\t\tNoEmbeddedSpaces = false;\r\n\t\t}\r\n\r\n\t\tif (!NoAtSignFound && ch == \".\") {\r\n\t\t\tif (NoDotFound){\r\n\t\t\t\tNoDotFound = false;\r\n\t\t\t\tDotPos = i;\r\n\t\t\t} else {\r\n\t\t\t\tif (DotPos == (i - 1))\r\n\t\t\t\t\tNoDotsInARow = false;\r\n\t\t\t}\r\n\t\t}\r\n\t} // for\r\n\r\n\tif (NoAtSignFound)  {\r\n\t\treturn (false);\r\n\t}\r\n\t\r\n\tif (!NoMultipleAtSigns) {\r\n\t\treturn (false);\r\n\t}\r\n\t\r\n\t// Must be at least two chars after the \"@\" symbol\r\n\tif (!NoDotFound && DotPos == (AtSignPos + 1)) { \r\n\t\treturn (false);\r\n\t}\r\n\t\r\n\tif (NoDotFound) {\r\n\t\treturn (false);\r\n\t}\r\n\r\n\tif (!NoDotsInARow) {\r\n\t\treturn (false);\r\n\t}\r\n\t\r\n\tif (!NoEmbeddedSpaces) {\r\n\t\treturn (false);\r\n\t}\r\n\t\r\n\t// Can not end in \".\"\r\n\tif (checkStr.charAt(checkStr.length - 1) == \".\") {\r\n\t\treturn (false);\r\n\t}\r\n\r\n\t// Must have 2 or 3 bytes after last period\r\n\tvar intLastPeriod = checkStr.lastIndexOf('.');\r\n\tvar intRemaining = checkStr.length - intLastPeriod -1;\r\n\tif (intRemaining != 2 && intRemaining != 3) {\r\n\t\treturn(false);\r\n\t}\r\n\t\r\n\treturn (true);\r\n}","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["Validation","Field validation","Form validation"]},{"RecordId":"475","Title":"Submitting a Form With an Image Button","Description":"Demonstrates how to validate and submit a form with an image button instead of a submit button.","Code":"/*---------------------------------------------------------------------------------------\r\n Validate_Form function:\r\n Validates input form before calling next page.\r\n----------------------------------------------------------------------------------------*/\r\nfunction Validate_Form() {\r\n\r\n\tvar strError = ''\r\n\tvar theForm = document.frm;\r\n\t\r\n\t// Full name\r\n\tif (isBlank(theForm.txtFullName.value + '')) {\r\n\t\tstrError += 'Full Name\\n';\r\n\t}\r\n\r\n\t// Address 1\r\n\tif (isBlank(theForm.txtAddr1.value + '')) {\r\n\t\tstrError += 'Address\\n';\r\n\t}\r\n\r\n\t// City\r\n\tif (isBlank(theForm.txtCity.value + '')) {\r\n\t\tstrError += 'City\\n';\r\n\t}\r\n\t\t\r\n\t// If no errors, submit the form\r\n\tif (strError != '') {\r\n\t\tstrError = 'Please enter the following missing information:\\n' + strError;\r\n\t\talert(strError);\r\n\t} else {\r\n\t\ttheForm.submit();\r\n\t\t//return true;\t\r\n\t}\r\n}\r\n\r\n'------------------------------------------------------------------------------------------------\r\n' Define the form like this.  NOTE:  No onSubit function\r\n'------------------------------------------------------------------------------------------------\r\n<form name=\"frm\" method=\"post\" action=\"page3new.asp\">\r\n\r\n'------------------------------------------------------------------------------------------------\r\n' Create the image button like this.\r\n'------------------------------------------------------------------------------------------------\r\n<a href=\"JAVASCRIPT:Validate_Form();\" \r\n\tonmouseover=\"ToggleNextButton('1')\" \r\n\tonmouseout=\"ToggleNextButton('0')\">\r\n\t<img name=\"btnNext\" src=\"images/btnNext.gif\" border=\"0\" width=\"75\">\r\n</a>\r\n","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["Submit","Form"]},{"RecordId":"476","Title":"JavaScript Field Validation (Ultimate)","Description":"Zillions of JavaScript routines to validate any type of form field.","Code":"// FormChek.js\r\n//\r\n// SUMMARY\r\n//\r\n// This is a set of JavaScript functions for validating input on \r\n// an HTML form.  Functions are provided to validate:\r\n//\r\n//      - U.S. and international phone/fax numbers\r\n//      - U.S. ZIP codes (5 or 9 digit postal codes)\r\n//      - U.S. Postal Codes (2 letter abbreviations for names of states)\r\n//      - U.S. Social Security Numbers (abbreviated as SSNs)\r\n//      - email addresses\r\n//\t- dates (entry of year, month, and day and validity of combined date)\r\n//\t- credit card numbers\r\n//\r\n// Supporting utility functions validate that:\r\n//\r\n//      - characters are Letter, Digit, or LetterOrDigit\r\n//      - strings are a Signed, Positive, Negative, Nonpositive, or\r\n//        Nonnegative integer\r\n//      - strings are a Float or a SignedFloat\r\n//      - strings are Alphabetic, Alphanumeric, or Whitespace\r\n//      - strings contain an integer within a specified range\r\n//\r\n// Functions are also provided to interactively check the\r\n// above kinds of data and prompt the user if they have\r\n// been entered incorrectly.\r\n//\r\n// Other utility functions are provided to:\r\n//\r\n// \t- remove from a string characters which are/are not \r\n//\t  in a \"bag\" of selected characters\t\r\n// \t- reformat a string, adding delimiter characters\r\n//\t- strip whitespace/leading whitespace from a string\r\n//      - reformat U.S. phone numbers, ZIP codes, and Social\r\n//        Security numbers\r\n//\r\n//\r\n// Many of the below functions take an optional parameter eok (for \"emptyOK\")\r\n// which determines whether the empty string will return true or false.\r\n// Default behavior is controlled by global variable defaultEmptyOK.\r\n//\r\n// BASIC DATA VALIDATION FUNCTIONS:\r\n//\r\n// isWhitespace (s)                    Check whether string s is empty or whitespace.\r\n// isLetter (c)                        Check whether character c is an English letter \r\n// isDigit (c)                         Check whether character c is a digit \r\n// isLetterOrDigit (c)                 Check whether character c is a letter or digit.\r\n// isInteger (s [,eok])                True if all characters in string s are numbers.\r\n// isSignedInteger (s [,eok])          True if all characters in string s are numbers; leading + or - allowed.\r\n// isPositiveInteger (s [,eok])        True if string s is an integer > 0.\r\n// isNonnegativeInteger (s [,eok])     True if string s is an integer >= 0.\r\n// isNegativeInteger (s [,eok])        True if s is an integer < 0.\r\n// isNonpositiveInteger (s [,eok])     True if s is an integer <= 0.\r\n// isFloat (s [,eok])                  True if string s is an unsigned floating point (real) number. (Integers also OK.)\r\n// isSignedFloat (s [,eok])            True if string s is a floating point number; leading + or - allowed. (Integers also OK.)\r\n// isAlphabetic (s [,eok])             True if string s is English letters \r\n// isAlphanumeric (s [,eok])           True if string s is English letters and numbers only.\r\n// \r\n// isSSN (s [,eok])                    True if string s is a valid U.S. Social Security Number.\r\n// isUSPhoneNumber (s [,eok])          True if string s is a valid U.S. Phone Number. \r\n// isInternationalPhoneNumber (s [,eok]) True if string s is a valid international phone number.\r\n// isZIPCode (s [,eok])                True if string s is a valid U.S. ZIP code.\r\n// isStateCode (s [,eok])              True if string s is a valid U.S. Postal Code\r\n// isEmail (s [,eok])                  True if string s is a valid email address.\r\n// isYear (s [,eok])                   True if string s is a valid Year number.\r\n// isIntegerInRange (s, a, b [,eok])   True if string s is an integer between a and b, inclusive.\r\n// isMonth (s [,eok])                  True if string s is a valid month between 1 and 12.\r\n// isDay (s [,eok])                    True if string s is a valid day between 1 and 31.\r\n// daysInFebruary (year)               Returns number of days in February of that year.\r\n// isDate (year, month, day)           True if string arguments form a valid date.\r\n\r\n\r\n// FUNCTIONS TO REFORMAT DATA:\r\n//\r\n// stripCharsInBag (s, bag)            Removes all characters in string bag from string s.\r\n// stripCharsNotInBag (s, bag)         Removes all characters NOT in string bag from string s.\r\n// stripWhitespace (s)                 Removes all whitespace characters from s.\r\n// stripInitialWhitespace (s)          Removes initial (leading) whitespace characters from s.\r\n// reformat (TARGETSTRING, STRING,     Function for inserting formatting characters or\r\n//   INTEGER, STRING, INTEGER ... )       delimiters into TARGETSTRING.                                       \r\n// reformatZIPCode (ZIPString)         If 9 digits, inserts separator hyphen.\r\n// reformatSSN (SSN)                   Reformats as 123-45-6789.\r\n// reformatUSPhone (USPhone)           Reformats as (123) 456-789.\r\n\r\n\r\n// FUNCTIONS TO PROMPT USER:\r\n//\r\n// prompt (s)                          Display prompt string s in status bar.\r\n// promptEntry (s)                     Display data entry prompt string s in status bar.\r\n// warnEmpty (theField, s)             Notify user that required field theField is empty.\r\n// warnInvalid (theField, s)           Notify user that contents of field theField are invalid.\r\n\r\n\r\n// FUNCTIONS TO INTERACTIVELY CHECK FIELD CONTENTS:\r\n//\r\n// checkString (theField, s [,eok])    Check that theField.value is not empty or all whitespace.\r\n// checkStateCode (theField)           Check that theField.value is a valid U.S. state code.\r\n// checkZIPCode (theField [,eok])      Check that theField.value is a valid ZIP code.\r\n// checkUSPhone (theField [,eok])      Check that theField.value is a valid US Phone.\r\n// checkInternationalPhone (theField [,eok])  Check that theField.value is a valid International Phone.\r\n// checkEmail (theField [,eok])        Check that theField.value is a valid Email.\r\n// checkSSN (theField [,eok])          Check that theField.value is a valid SSN.\r\n// checkYear (theField [,eok])         Check that theField.value is a valid Year.\r\n// checkMonth (theField [,eok])        Check that theField.value is a valid Month.\r\n// checkDay (theField [,eok])          Check that theField.value is a valid Day.\r\n// checkDate (yearField, monthField, dayField, labelString, OKtoOmitDay)\r\n//                                     Check that field values form a valid date.\r\n// getRadioButtonValue (radio)         Get checked value from radio button.\r\n// checkCreditCard (radio, theField)   Validate credit card info.\r\n\r\n\r\n// CREDIT CARD DATA VALIDATION FUNCTIONS\r\n// \r\n// isCreditCard (st)              True if credit card number passes the Luhn Mod-10 test.\r\n// isVisa (cc)                    True if string cc is a valid VISA number.\r\n// isMasterCard (cc)              True if string cc is a valid MasterCard number.\r\n// isAmericanExpress (cc)         True if string cc is a valid American Express number.\r\n// isDinersClub (cc)              True if string cc is a valid Diner's Club number.\r\n// isCarteBlanche (cc)            True if string cc is a valid Carte Blanche number.\r\n// isDiscover (cc)                True if string cc is a valid Discover card number.\r\n// isEnRoute (cc)                 True if string cc is a valid enRoute card number.\r\n// isJCB (cc)                     True if string cc is a valid JCB card number.\r\n// isAnyCard (cc)                 True if string cc is a valid card number for any of the accepted types.\r\n// isCardMatch (Type, Number)     True if Number is valid for credic card of type Type.\r\n//\r\n// Other stub functions are retained for backward compatibility with LivePayment code.\r\n// See comments below for details.\r\n//\r\n// Performance hint: when you deploy this file on your website, strip out the\r\n// comment lines from the source code as well as any of the functions which\r\n// you don't need.  This will give you a smaller .js file and achieve faster\r\n// downloads.\r\n//\r\n// 18 Feb 97 created Eric Krock\r\n//\r\n// (c) 1997 Netscape Communications Corporation\r\n\r\n\r\n\r\n// VARIABLE DECLARATIONS\r\n\r\nvar digits = \"0123456789\";\r\n\r\nvar lowercaseLetters = \"abcdefghijklmnopqrstuvwxyz\"\r\n\r\nvar uppercaseLetters = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\"\r\n\r\n\r\n// whitespace characters\r\nvar whitespace = \" \\t\\n\\r\";\r\n\r\n\r\n// decimal point character differs by language and culture\r\nvar decimalPointDelimiter = \".\"\r\n\r\n\r\n// non-digit characters which are allowed in phone numbers\r\nvar phoneNumberDelimiters = \"()- \";\r\n\r\n\r\n// characters which are allowed in US phone numbers\r\nvar validUSPhoneChars = digits + phoneNumberDelimiters;\r\n\r\n\r\n// characters which are allowed in international phone numbers\r\n// (a leading + is OK)\r\nvar validWorldPhoneChars = digits + phoneNumberDelimiters + \"+\";\r\n\r\n\r\n// non-digit characters which are allowed in \r\n// Social Security Numbers\r\nvar SSNDelimiters = \"- \";\r\n\r\n\r\n\r\n// characters which are allowed in Social Security Numbers\r\nvar validSSNChars = digits + SSNDelimiters;\r\n\r\n\r\n\r\n// U.S. Social Security Numbers have 9 digits.\r\n// They are formatted as 123-45-6789.\r\nvar digitsInSocialSecurityNumber = 9;\r\n\r\n\r\n\r\n// U.S. phone numbers have 10 digits.\r\n// They are formatted as 123 456 7890 or (123) 456-7890.\r\nvar digitsInUSPhoneNumber = 10;\r\n\r\n\r\n\r\n// non-digit characters which are allowed in ZIP Codes\r\nvar ZIPCodeDelimiters = \"-\";\r\n\r\n\r\n\r\n// our preferred delimiter for reformatting ZIP Codes\r\nvar ZIPCodeDelimeter = \"-\"\r\n\r\n\r\n// characters which are allowed in Social Security Numbers\r\nvar validZIPCodeChars = digits + ZIPCodeDelimiters\r\n\r\n\r\n\r\n// U.S. ZIP codes have 5 or 9 digits.\r\n// They are formatted as 12345 or 12345-6789.\r\nvar digitsInZIPCode1 = 5\r\nvar digitsInZIPCode2 = 9\r\n\r\n\r\n// non-digit characters which are allowed in credit card numbers\r\nvar creditCardDelimiters = \" \"\r\n\r\n\r\n// CONSTANT STRING DECLARATIONS\r\n// (grouped for ease of translation and localization)\r\n\r\n// m is an abbreviation for \"missing\"\r\n\r\nvar mPrefix = \"You did not enter a value into the \"\r\nvar mSuffix = \" field. This is a required field. Please enter it now.\"\r\n\r\n// s is an abbreviation for \"string\"\r\n\r\nvar sUSLastName = \"Last Name\"\r\nvar sUSFirstName = \"First Name\"\r\nvar sWorldLastName = \"Family Name\"\r\nvar sWorldFirstName = \"Given Name\"\r\nvar sTitle = \"Title\"\r\nvar sCompanyName = \"Company Name\"\r\nvar sUSAddress = \"Street Address\"\r\nvar sWorldAddress = \"Address\"\r\nvar sCity = \"City\"\r\nvar sStateCode = \"State Code\"\r\nvar sWorldState = \"State, Province, or Prefecture\"\r\nvar sCountry = \"Country\"\r\nvar sZIPCode = \"ZIP Code\"\r\nvar sWorldPostalCode = \"Postal Code\"\r\nvar sPhone = \"Phone Number\"\r\nvar sFax = \"Fax Number\"\r\nvar sDateOfBirth = \"Date of Birth\"\r\nvar sExpirationDate = \"Expiration Date\"\r\nvar sEmail = \"Email\"\r\nvar sSSN = \"Social Security Number\"\r\nvar sCreditCardNumber = \"Credit Card Number\"\r\nvar sOtherInfo = \"Other Information\"\r\n\r\n\r\n\r\n\r\n// i is an abbreviation for \"invalid\"\r\n\r\nvar iStateCode = \"This field must be a valid two character U.S. state abbreviation (like CA for California). Please reenter it now.\"\r\nvar iZIPCode = \"This field must be a 5 or 9 digit U.S. ZIP Code (like 94043). Please reenter it now.\"\r\nvar iUSPhone = \"This field must be a 10 digit U.S. phone number (like 415 555 1212). Please reenter it now.\"\r\nvar iWorldPhone = \"This field must be a valid international phone number. Please reenter it now.\"\r\nvar iSSN = \"This field must be a 9 digit U.S. social security number (like 123 45 6789). Please reenter it now.\"\r\nvar iEmail = \"This field must be a valid email address (like foo@bar.com). Please reenter it now.\"\r\nvar iCreditCardPrefix = \"This is not a valid \"\r\nvar iCreditCardSuffix = \" credit card number. (Click the link on this form to see a list of sample numbers.) Please reenter it now.\"\r\nvar iDay = \"This field must be a day number between 1 and 31.  Please reenter it now.\"\r\nvar iMonth = \"This field must be a month number between 1 and 12.  Please reenter it now.\"\r\nvar iYear = \"This field must be a 2 or 4 digit year number.  Please reenter it now.\"\r\nvar iDatePrefix = \"The Day, Month, and Year for \"\r\nvar iDateSuffix = \" do not form a valid date.  Please reenter them now.\"\r\n\r\n\r\n\r\n// p is an abbreviation for \"prompt\"\r\n\r\nvar pEntryPrompt = \"Please enter a \"\r\nvar pStateCode = \"2 character code (like CA).\"\r\nvar pZIPCode = \"5 or 9 digit U.S. ZIP Code (like 94043).\"\r\nvar pUSPhone = \"10 digit U.S. phone number (like 415 555 1212).\"\r\nvar pWorldPhone = \"international phone number.\"\r\nvar pSSN = \"9 digit U.S. social security number (like 123 45 6789).\"\r\nvar pEmail = \"valid email address (like foo@bar.com).\"\r\nvar pCreditCard = \"valid credit card number.\"\r\nvar pDay = \"day number between 1 and 31.\"\r\nvar pMonth = \"month number between 1 and 12.\"\r\nvar pYear = \"2 or 4 digit year number.\"\r\n\r\n\r\n// Global variable defaultEmptyOK defines default return value \r\n// for many functions when they are passed the empty string. \r\n// By default, they will return defaultEmptyOK.\r\n//\r\n// defaultEmptyOK is false, which means that by default, \r\n// these functions will do \"strict\" validation.  Function\r\n// isInteger, for example, will only return true if it is\r\n// passed a string containing an integer; if it is passed\r\n// the empty string, it will return false.\r\n//\r\n// You can change this default behavior globally (for all \r\n// functions which use defaultEmptyOK) by changing the value\r\n// of defaultEmptyOK.\r\n//\r\n// Most of these functions have an optional argument emptyOK\r\n// which allows you to override the default behavior for \r\n// the duration of a function call.\r\n//\r\n// This functionality is useful because it is possible to\r\n// say \"if the user puts anything in this field, it must\r\n// be an integer (or a phone number, or a string, etc.), \r\n// but it's OK to leave the field empty too.\"\r\n// This is the case for fields which are optional but which\r\n// must have a certain kind of content if filled in.\r\n\r\nvar defaultEmptyOK = false\r\n\r\n\r\n\r\n\r\n// Attempting to make this library run on Navigator 2.0,\r\n// so I'm supplying this array creation routine as per\r\n// JavaScript 1.0 documentation.  If you're using \r\n// Navigator 3.0 or later, you don't need to do this;\r\n// you can use the Array constructor instead.\r\n\r\nfunction makeArray(n) {\r\n//*** BUG: If I put this line in, I get two error messages:\r\n//(1) Window.length can't be set by assignment\r\n//(2) daysInMonth has no property indexed by 4\r\n//If I leave it out, the code works fine.\r\n//   this.length = n;\r\n   for (var i = 1; i <= n; i++) {\r\n      this[i] = 0\r\n   } \r\n   return this\r\n}\r\n\r\n\r\n\r\nvar daysInMonth = makeArray(12);\r\ndaysInMonth[1] = 31;\r\ndaysInMonth[2] = 29;   // must programmatically check this\r\ndaysInMonth[3] = 31;\r\ndaysInMonth[4] = 30;\r\ndaysInMonth[5] = 31;\r\ndaysInMonth[6] = 30;\r\ndaysInMonth[7] = 31;\r\ndaysInMonth[8] = 31;\r\ndaysInMonth[9] = 30;\r\ndaysInMonth[10] = 31;\r\ndaysInMonth[11] = 30;\r\ndaysInMonth[12] = 31;\r\n\r\n\r\n\r\n\r\n// Valid U.S. Postal Codes for states, territories, armed forces, etc.\r\n// See http://www.usps.gov/ncsc/lookups/abbr_state.txt.\r\n\r\nvar USStateCodeDelimiter = \"|\";\r\nvar USStateCodes = \"AL|AK|AS|AZ|AR|CA|CO|CT|DE|DC|FM|FL|GA|GU|HI|ID|IL|IN|IA|KS|KY|LA|ME|MH|MD|MA|MI|MN|MS|MO|MT|NE|NV|NH|NJ|NM|NY|NC|ND|MP|OH|OK|OR|PW|PA|PR|RI|SC|SD|TN|TX|UT|VT|VI|VA|WA|WV|WI|WY|AE|AA|AE|AE|AP\"\r\n\r\n\r\n\r\n\r\n// Check whether string s is empty.\r\n\r\nfunction isEmpty(s)\r\n{   return ((s == null) || (s.length == 0))\r\n}\r\n\r\n\r\n\r\n// Returns true if string s is empty or \r\n// whitespace characters only.\r\n\r\nfunction isWhitespace (s)\r\n\r\n{   var i;\r\n\r\n    // Is s empty?\r\n    if (isEmpty(s)) return true;\r\n\r\n    // Search through string's characters one by one\r\n    // until we find a non-whitespace character.\r\n    // When we do, return false; if we don't, return true.\r\n\r\n    for (i = 0; i < s.length; i++)\r\n    {   \r\n        // Check that current character isn't whitespace.\r\n        var c = s.charAt(i);\r\n\r\n        if (whitespace.indexOf(c) == -1) return false;\r\n    }\r\n\r\n    // All characters are whitespace.\r\n    return true;\r\n}\r\n\r\n\r\n\r\n// Removes all characters which appear in string bag from string s.\r\n\r\nfunction stripCharsInBag (s, bag)\r\n\r\n{   var i;\r\n    var returnString = \"\";\r\n\r\n    // Search through string's characters one by one.\r\n    // If character is not in bag, append to returnString.\r\n\r\n    for (i = 0; i < s.length; i++)\r\n    {   \r\n        // Check that current character isn't whitespace.\r\n        var c = s.charAt(i);\r\n        if (bag.indexOf(c) == -1) returnString += c;\r\n    }\r\n\r\n    return returnString;\r\n}\r\n\r\n\r\n\r\n// Removes all characters which do NOT appear in string bag \r\n// from string s.\r\n\r\nfunction stripCharsNotInBag (s, bag)\r\n\r\n{   var i;\r\n    var returnString = \"\";\r\n\r\n    // Search through string's characters one by one.\r\n    // If character is in bag, append to returnString.\r\n\r\n    for (i = 0; i < s.length; i++)\r\n    {   \r\n        // Check that current character isn't whitespace.\r\n        var c = s.charAt(i);\r\n        if (bag.indexOf(c) != -1) returnString += c;\r\n    }\r\n\r\n    return returnString;\r\n}\r\n\r\n\r\n\r\n// Removes all whitespace characters from s.\r\n// Global variable whitespace (see above)\r\n// defines which characters are considered whitespace.\r\n\r\nfunction stripWhitespace (s)\r\n\r\n{   return stripCharsInBag (s, whitespace)\r\n}\r\n\r\n\r\n\r\n\r\n// WORKAROUND FUNCTION FOR NAVIGATOR 2.0.2 COMPATIBILITY.\r\n//\r\n// The below function *should* be unnecessary.  In general,\r\n// avoid using it.  Use the standard method indexOf instead.\r\n//\r\n// However, because of an apparent bug in indexOf on \r\n// Navigator 2.0.2, the below loop does not work as the\r\n// body of stripInitialWhitespace:\r\n//\r\n// while ((i < s.length) && (whitespace.indexOf(s.charAt(i)) != -1))\r\n//   i++;\r\n//\r\n// ... so we provide this workaround function charInString\r\n// instead.\r\n//\r\n// charInString (CHARACTER c, STRING s)\r\n//\r\n// Returns true if single character c (actually a string)\r\n// is contained within string s.\r\n\r\nfunction charInString (c, s)\r\n{   for (i = 0; i < s.length; i++)\r\n    {   if (s.charAt(i) == c) return true;\r\n    }\r\n    return false\r\n}\r\n\r\n\r\n\r\n// Removes initial (leading) whitespace characters from s.\r\n// Global variable whitespace (see above)\r\n// defines which characters are considered whitespace.\r\n\r\nfunction stripInitialWhitespace (s)\r\n\r\n{   var i = 0;\r\n\r\n    while ((i < s.length) && charInString (s.charAt(i), whitespace))\r\n       i++;\r\n    \r\n    return s.substring (i, s.length);\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// Returns true if character c is an English letter \r\n// (A .. Z, a..z).\r\n//\r\n// NOTE: Need i18n version to support European characters.\r\n// This could be tricky due to different character\r\n// sets and orderings for various languages and platforms.\r\n\r\nfunction isLetter (c)\r\n{   return ( ((c >= \"a\") && (c <= \"z\")) || ((c >= \"A\") && (c <= \"Z\")) )\r\n}\r\n\r\n\r\n\r\n// Returns true if character c is a digit \r\n// (0 .. 9).\r\n\r\nfunction isDigit (c)\r\n{   return ((c >= \"0\") && (c <= \"9\"))\r\n}\r\n\r\n\r\n\r\n// Returns true if character c is a letter or digit.\r\n\r\nfunction isLetterOrDigit (c)\r\n{   return (isLetter(c) || isDigit(c))\r\n}\r\n\r\n\r\n\r\n// isInteger (STRING s [, BOOLEAN emptyOK])\r\n// \r\n// Returns true if all characters in string s are numbers.\r\n//\r\n// Accepts non-signed integers only. Does not accept floating \r\n// point, exponential notation, etc.\r\n//\r\n// We don't use parseInt because that would accept a string\r\n// with trailing non-numeric characters.\r\n//\r\n// By default, returns defaultEmptyOK if s is empty.\r\n// There is an optional second argument called emptyOK.\r\n// emptyOK is used to override for a single function call\r\n//      the default behavior which is specified globally by\r\n//      defaultEmptyOK.\r\n// If emptyOK is false (or any value other than true), \r\n//      the function will return false if s is empty.\r\n// If emptyOK is true, the function will return true if s is empty.\r\n//\r\n// EXAMPLE FUNCTION CALL:     RESULT:\r\n// isInteger (\"5\")            true \r\n// isInteger (\"\")             defaultEmptyOK\r\n// isInteger (\"-5\")           false\r\n// isInteger (\"\", true)       true\r\n// isInteger (\"\", false)      false\r\n// isInteger (\"5\", false)     true\r\n\r\nfunction isInteger (s)\r\n\r\n{   var i;\r\n\r\n    if (isEmpty(s)) \r\n       if (isInteger.arguments.length == 1) return defaultEmptyOK;\r\n       else return (isInteger.arguments[1] == true);\r\n\r\n    // Search through string's characters one by one\r\n    // until we find a non-numeric character.\r\n    // When we do, return false; if we don't, return true.\r\n\r\n    for (i = 0; i < s.length; i++)\r\n    {   \r\n        // Check that current character is number.\r\n        var c = s.charAt(i);\r\n\r\n        if (!isDigit(c)) return false;\r\n    }\r\n\r\n    // All characters are numbers.\r\n    return true;\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// isSignedInteger (STRING s [, BOOLEAN emptyOK])\r\n// \r\n// Returns true if all characters are numbers; \r\n// first character is allowed to be + or - as well.\r\n//\r\n// Does not accept floating point, exponential notation, etc.\r\n//\r\n// We don't use parseInt because that would accept a string\r\n// with trailing non-numeric characters.\r\n//\r\n// For explanation of optional argument emptyOK,\r\n// see comments of function isInteger.\r\n//\r\n// EXAMPLE FUNCTION CALL:          RESULT:\r\n// isSignedInteger (\"5\")           true \r\n// isSignedInteger (\"\")            defaultEmptyOK\r\n// isSignedInteger (\"-5\")          true\r\n// isSignedInteger (\"+5\")          true\r\n// isSignedInteger (\"\", false)     false\r\n// isSignedInteger (\"\", true)      true\r\n\r\nfunction isSignedInteger (s)\r\n\r\n{   if (isEmpty(s)) \r\n       if (isSignedInteger.arguments.length == 1) return defaultEmptyOK;\r\n       else return (isSignedInteger.arguments[1] == true);\r\n\r\n    else {\r\n        var startPos = 0;\r\n        var secondArg = defaultEmptyOK;\r\n\r\n        if (isSignedInteger.arguments.length > 1)\r\n            secondArg = isSignedInteger.arguments[1];\r\n\r\n        // skip leading + or -\r\n        if ( (s.charAt(0) == \"-\") || (s.charAt(0) == \"+\") )\r\n           startPos = 1;    \r\n        return (isInteger(s.substring(startPos, s.length), secondArg))\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n// isPositiveInteger (STRING s [, BOOLEAN emptyOK])\r\n// \r\n// Returns true if string s is an integer > 0.\r\n//\r\n// For explanation of optional argument emptyOK,\r\n// see comments of function isInteger.\r\n\r\nfunction isPositiveInteger (s)\r\n{   var secondArg = defaultEmptyOK;\r\n\r\n    if (isPositiveInteger.arguments.length > 1)\r\n        secondArg = isPositiveInteger.arguments[1];\r\n\r\n    // The next line is a bit byzantine.  What it means is:\r\n    // a) s must be a signed integer, AND\r\n    // b) one of the following must be true:\r\n    //    i)  s is empty and we are supposed to return true for\r\n    //        empty strings\r\n    //    ii) this is a positive, not negative, number\r\n\r\n    return (isSignedInteger(s, secondArg)\r\n         && ( (isEmpty(s) && secondArg)  || (parseInt (s) > 0) ) );\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n// isNonnegativeInteger (STRING s [, BOOLEAN emptyOK])\r\n// \r\n// Returns true if string s is an integer >= 0.\r\n//\r\n// For explanation of optional argument emptyOK,\r\n// see comments of function isInteger.\r\n\r\nfunction isNonnegativeInteger (s)\r\n{   var secondArg = defaultEmptyOK;\r\n\r\n    if (isNonnegativeInteger.arguments.length > 1)\r\n        secondArg = isNonnegativeInteger.arguments[1];\r\n\r\n    // The next line is a bit byzantine.  What it means is:\r\n    // a) s must be a signed integer, AND\r\n    // b) one of the following must be true:\r\n    //    i)  s is empty and we are supposed to return true for\r\n    //        empty strings\r\n    //    ii) this is a number >= 0\r\n\r\n    return (isSignedInteger(s, secondArg)\r\n         && ( (isEmpty(s) && secondArg)  || (parseInt (s) >= 0) ) );\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n// isNegativeInteger (STRING s [, BOOLEAN emptyOK])\r\n// \r\n// Returns true if string s is an integer < 0.\r\n//\r\n// For explanation of optional argument emptyOK,\r\n// see comments of function isInteger.\r\n\r\nfunction isNegativeInteger (s)\r\n{   var secondArg = defaultEmptyOK;\r\n\r\n    if (isNegativeInteger.arguments.length > 1)\r\n        secondArg = isNegativeInteger.arguments[1];\r\n\r\n    // The next line is a bit byzantine.  What it means is:\r\n    // a) s must be a signed integer, AND\r\n    // b) one of the following must be true:\r\n    //    i)  s is empty and we are supposed to return true for\r\n    //        empty strings\r\n    //    ii) this is a negative, not positive, number\r\n\r\n    return (isSignedInteger(s, secondArg)\r\n         && ( (isEmpty(s) && secondArg)  || (parseInt (s) < 0) ) );\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n// isNonpositiveInteger (STRING s [, BOOLEAN emptyOK])\r\n// \r\n// Returns true if string s is an integer <= 0.\r\n//\r\n// For explanation of optional argument emptyOK,\r\n// see comments of function isInteger.\r\n\r\nfunction isNonpositiveInteger (s)\r\n{   var secondArg = defaultEmptyOK;\r\n\r\n    if (isNonpositiveInteger.arguments.length > 1)\r\n        secondArg = isNonpositiveInteger.arguments[1];\r\n\r\n    // The next line is a bit byzantine.  What it means is:\r\n    // a) s must be a signed integer, AND\r\n    // b) one of the following must be true:\r\n    //    i)  s is empty and we are supposed to return true for\r\n    //        empty strings\r\n    //    ii) this is a number <= 0\r\n\r\n    return (isSignedInteger(s, secondArg)\r\n         && ( (isEmpty(s) && secondArg)  || (parseInt (s) <= 0) ) );\r\n}\r\n\r\n\r\n\r\n\r\n\r\n// isFloat (STRING s [, BOOLEAN emptyOK])\r\n// \r\n// True if string s is an unsigned floating point (real) number. \r\n//\r\n// Also returns true for unsigned integers. If you wish\r\n// to distinguish between integers and floating point numbers,\r\n// first call isInteger, then call isFloat.\r\n//\r\n// Does not accept exponential notation.\r\n//\r\n// For explanation of optional argument emptyOK,\r\n// see comments of function isInteger.\r\n\r\nfunction isFloat (s)\r\n\r\n{   var i;\r\n    var seenDecimalPoint = false;\r\n\r\n    if (isEmpty(s)) \r\n       if (isFloat.arguments.length == 1) return defaultEmptyOK;\r\n       else return (isFloat.arguments[1] == true);\r\n\r\n    if (s == decimalPointDelimiter) return false;\r\n\r\n    // Search through string's characters one by one\r\n    // until we find a non-numeric character.\r\n    // When we do, return false; if we don't, return true.\r\n\r\n    for (i = 0; i < s.length; i++)\r\n    {   \r\n        // Check that current character is number.\r\n        var c = s.charAt(i);\r\n\r\n        if ((c == decimalPointDelimiter) && !seenDecimalPoint) seenDecimalPoint = true;\r\n        else if (!isDigit(c)) return false;\r\n    }\r\n\r\n    // All characters are numbers.\r\n    return true;\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// isSignedFloat (STRING s [, BOOLEAN emptyOK])\r\n// \r\n// True if string s is a signed or unsigned floating point \r\n// (real) number. First character is allowed to be + or -.\r\n//\r\n// Also returns true for unsigned integers. If you wish\r\n// to distinguish between integers and floating point numbers,\r\n// first call isSignedInteger, then call isSignedFloat.\r\n//\r\n// Does not accept exponential notation.\r\n//\r\n// For explanation of optional argument emptyOK,\r\n// see comments of function isInteger.\r\n\r\nfunction isSignedFloat (s)\r\n\r\n{   if (isEmpty(s)) \r\n       if (isSignedFloat.arguments.length == 1) return defaultEmptyOK;\r\n       else return (isSignedFloat.arguments[1] == true);\r\n\r\n    else {\r\n        var startPos = 0;\r\n        var secondArg = defaultEmptyOK;\r\n\r\n        if (isSignedFloat.arguments.length > 1)\r\n            secondArg = isSignedFloat.arguments[1];\r\n\r\n        // skip leading + or -\r\n        if ( (s.charAt(0) == \"-\") || (s.charAt(0) == \"+\") )\r\n           startPos = 1;    \r\n        return (isFloat(s.substring(startPos, s.length), secondArg))\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n// isAlphabetic (STRING s [, BOOLEAN emptyOK])\r\n// \r\n// Returns true if string s is English letters \r\n// (A .. Z, a..z) only.\r\n//\r\n// For explanation of optional argument emptyOK,\r\n// see comments of function isInteger.\r\n//\r\n// NOTE: Need i18n version to support European characters.\r\n// This could be tricky due to different character\r\n// sets and orderings for various languages and platforms.\r\n\r\nfunction isAlphabetic (s)\r\n\r\n{   var i;\r\n\r\n    if (isEmpty(s)) \r\n       if (isAlphabetic.arguments.length == 1) return defaultEmptyOK;\r\n       else return (isAlphabetic.arguments[1] == true);\r\n\r\n    // Search through string's characters one by one\r\n    // until we find a non-alphabetic character.\r\n    // When we do, return false; if we don't, return true.\r\n\r\n    for (i = 0; i < s.length; i++)\r\n    {   \r\n        // Check that current character is letter.\r\n        var c = s.charAt(i);\r\n\r\n        if (!isLetter(c))\r\n        return false;\r\n    }\r\n\r\n    // All characters are letters.\r\n    return true;\r\n}\r\n\r\n\r\n\r\n\r\n// isAlphanumeric (STRING s [, BOOLEAN emptyOK])\r\n// \r\n// Returns true if string s is English letters \r\n// (A .. Z, a..z) and numbers only.\r\n//\r\n// For explanation of optional argument emptyOK,\r\n// see comments of function isInteger.\r\n//\r\n// NOTE: Need i18n version to support European characters.\r\n// This could be tricky due to different character\r\n// sets and orderings for various languages and platforms.\r\n\r\nfunction isAlphanumeric (s)\r\n\r\n{   var i;\r\n\r\n    if (isEmpty(s)) \r\n       if (isAlphanumeric.arguments.length == 1) return defaultEmptyOK;\r\n       else return (isAlphanumeric.arguments[1] == true);\r\n\r\n    // Search through string's characters one by one\r\n    // until we find a non-alphanumeric character.\r\n    // When we do, return false; if we don't, return true.\r\n\r\n    for (i = 0; i < s.length; i++)\r\n    {   \r\n        // Check that current character is number or letter.\r\n        var c = s.charAt(i);\r\n\r\n        if (! (isLetter(c) || isDigit(c) ) )\r\n        return false;\r\n    }\r\n\r\n    // All characters are numbers or letters.\r\n    return true;\r\n}\r\n\r\n\r\n\r\n\r\n// reformat (TARGETSTRING, STRING, INTEGER, STRING, INTEGER ... )       \r\n//\r\n// Handy function for arbitrarily inserting formatting characters\r\n// or delimiters of various kinds within TARGETSTRING.\r\n//\r\n// reformat takes one named argument, a string s, and any number\r\n// of other arguments.  The other arguments must be integers or\r\n// strings.  These other arguments specify how string s is to be\r\n// reformatted and how and where other strings are to be inserted\r\n// into it.\r\n//\r\n// reformat processes the other arguments in order one by one.\r\n// * If the argument is an integer, reformat appends that number \r\n//   of sequential characters from s to the resultString.\r\n// * If the argument is a string, reformat appends the string\r\n//   to the resultString.\r\n//\r\n// NOTE: The first argument after TARGETSTRING must be a string.\r\n// (It can be empty.)  The second argument must be an integer.\r\n// Thereafter, integers and strings must alternate.  This is to\r\n// provide backward compatibility to Navigator 2.0.2 JavaScript\r\n// by avoiding use of the typeof operator.\r\n//\r\n// It is the caller's responsibility to make sure that we do not\r\n// try to copy more characters from s than s.length.\r\n//\r\n// EXAMPLES:\r\n//\r\n// * To reformat a 10-digit U.S. phone number from \"1234567890\"\r\n//   to \"(123) 456-7890\" make this function call:\r\n//   reformat(\"1234567890\", \"(\", 3, \") \", 3, \"-\", 4)\r\n//\r\n// * To reformat a 9-digit U.S. Social Security number from\r\n//   \"123456789\" to \"123-45-6789\" make this function call:\r\n//   reformat(\"123456789\", \"\", 3, \"-\", 2, \"-\", 4)\r\n//\r\n// HINT:\r\n//\r\n// If you have a string which is already delimited in one way\r\n// (example: a phone number delimited with spaces as \"123 456 7890\")\r\n// and you want to delimit it in another way using function reformat,\r\n// call function stripCharsNotInBag to remove the unwanted \r\n// characters, THEN call function reformat to delimit as desired.\r\n//\r\n// EXAMPLE:\r\n//\r\n// reformat (stripCharsNotInBag (\"123 456 7890\", digits),\r\n//           \"(\", 3, \") \", 3, \"-\", 4)\r\n\r\nfunction reformat (s)\r\n\r\n{   var arg;\r\n    var sPos = 0;\r\n    var resultString = \"\";\r\n\r\n    for (var i = 1; i < reformat.arguments.length; i++) {\r\n       arg = reformat.arguments[i];\r\n       if (i % 2 == 1) resultString += arg;\r\n       else {\r\n           resultString += s.substring(sPos, sPos + arg);\r\n           sPos += arg;\r\n       }\r\n    }\r\n    return resultString;\r\n}\r\n\r\n\r\n\r\n\r\n// isSSN (STRING s [, BOOLEAN emptyOK])\r\n// \r\n// isSSN returns true if string s is a valid U.S. Social\r\n// Security Number.  Must be 9 digits.\r\n//\r\n// NOTE: Strip out any delimiters (spaces, hyphens, etc.)\r\n// from string s before calling this function.\r\n//\r\n// For explanation of optional argument emptyOK,\r\n// see comments of function isInteger.\r\n\r\nfunction isSSN (s)\r\n{   if (isEmpty(s)) \r\n       if (isSSN.arguments.length == 1) return defaultEmptyOK;\r\n       else return (isSSN.arguments[1] == true);\r\n    return (isInteger(s) && s.length == digitsInSocialSecurityNumber)\r\n}\r\n\r\n\r\n\r\n\r\n// isUSPhoneNumber (STRING s [, BOOLEAN emptyOK])\r\n// \r\n// isUSPhoneNumber returns true if string s is a valid U.S. Phone\r\n// Number.  Must be 10 digits.\r\n//\r\n// NOTE: Strip out any delimiters (spaces, hyphens, parentheses, etc.)\r\n// from string s before calling this function.\r\n//\r\n// For explanation of optional argument emptyOK,\r\n// see comments of function isInteger.\r\n\r\nfunction isUSPhoneNumber (s)\r\n{   if (isEmpty(s)) \r\n       if (isUSPhoneNumber.arguments.length == 1) return defaultEmptyOK;\r\n       else return (isUSPhoneNumber.arguments[1] == true);\r\n    return (isInteger(s) && s.length == digitsInUSPhoneNumber)\r\n}\r\n\r\n\r\n\r\n\r\n// isInternationalPhoneNumber (STRING s [, BOOLEAN emptyOK])\r\n// \r\n// isInternationalPhoneNumber returns true if string s is a valid \r\n// international phone number.  Must be digits only; any length OK.\r\n// May be prefixed by + character.\r\n//\r\n// NOTE: A phone number of all zeros would not be accepted.\r\n// I don't think that is a valid phone number anyway.\r\n//\r\n// NOTE: Strip out any delimiters (spaces, hyphens, parentheses, etc.)\r\n// from string s before calling this function.  You may leave in \r\n// leading + character if you wish.\r\n//\r\n// For explanation of optional argument emptyOK,\r\n// see comments of function isInteger.\r\n\r\nfunction isInternationalPhoneNumber (s)\r\n{   if (isEmpty(s)) \r\n       if (isInternationalPhoneNumber.arguments.length == 1) return defaultEmptyOK;\r\n       else return (isInternationalPhoneNumber.arguments[1] == true);\r\n    return (isPositiveInteger(s))\r\n}\r\n\r\n\r\n\r\n\r\n// isZIPCode (STRING s [, BOOLEAN emptyOK])\r\n// \r\n// isZIPCode returns true if string s is a valid \r\n// U.S. ZIP code.  Must be 5 or 9 digits only.\r\n//\r\n// NOTE: Strip out any delimiters (spaces, hyphens, etc.)\r\n// from string s before calling this function.  \r\n//\r\n// For explanation of optional argument emptyOK,\r\n// see comments of function isInteger.\r\n\r\nfunction isZIPCode (s)\r\n{  if (isEmpty(s)) \r\n       if (isZIPCode.arguments.length == 1) return defaultEmptyOK;\r\n       else return (isZIPCode.arguments[1] == true);\r\n   return (isInteger(s) && \r\n            ((s.length == digitsInZIPCode1) ||\r\n             (s.length == digitsInZIPCode2)))\r\n}\r\n\r\n\r\n\r\n\r\n\r\n// isStateCode (STRING s [, BOOLEAN emptyOK])\r\n// \r\n// Return true if s is a valid U.S. Postal Code \r\n// (abbreviation for state).\r\n//\r\n// For explanation of optional argument emptyOK,\r\n// see comments of function isInteger.\r\n\r\nfunction isStateCode(s)\r\n{   if (isEmpty(s)) \r\n       if (isStateCode.arguments.length == 1) return defaultEmptyOK;\r\n       else return (isStateCode.arguments[1] == true);\r\n    return ( (USStateCodes.indexOf(s) != -1) &&\r\n             (s.indexOf(USStateCodeDelimiter) == -1) )\r\n}\r\n\r\n\r\n\r\n\r\n// isEmail (STRING s [, BOOLEAN emptyOK])\r\n// \r\n// Email address must be of form a@b.c -- in other words:\r\n// * there must be at least one character before the @\r\n// * there must be at least one character before and after the .\r\n// * the characters @ and . are both required\r\n//\r\n// For explanation of optional argument emptyOK,\r\n// see comments of function isInteger.\r\n\r\nfunction isEmail (s)\r\n{   if (isEmpty(s)) \r\n       if (isEmail.arguments.length == 1) return defaultEmptyOK;\r\n       else return (isEmail.arguments[1] == true);\r\n   \r\n    // is s whitespace?\r\n    if (isWhitespace(s)) return false;\r\n    \r\n    // there must be >= 1 character before @, so we\r\n    // start looking at character position 1 \r\n    // (i.e. second character)\r\n    var i = 1;\r\n    var sLength = s.length;\r\n\r\n    // look for @\r\n    while ((i < sLength) && (s.charAt(i) != \"@\"))\r\n    { i++\r\n    }\r\n\r\n    if ((i >= sLength) || (s.charAt(i) != \"@\")) return false;\r\n    else i += 2;\r\n\r\n    // look for .\r\n    while ((i < sLength) && (s.charAt(i) != \".\"))\r\n    { i++\r\n    }\r\n\r\n    // there must be at least one character after the .\r\n    if ((i >= sLength - 1) || (s.charAt(i) != \".\")) return false;\r\n    else return true;\r\n}\r\n\r\n\r\n\r\n\r\n\r\n// isYear (STRING s [, BOOLEAN emptyOK])\r\n// \r\n// isYear returns true if string s is a valid \r\n// Year number.  Must be 2 or 4 digits only.\r\n// \r\n// For Year 2000 compliance, you are advised\r\n// to use 4-digit year numbers everywhere.\r\n//\r\n// And yes, this function is not Year 10000 compliant, but \r\n// because I am giving you 8003 years of advance notice,\r\n// I don't feel very guilty about this ...\r\n//\r\n// For B.C. compliance, write your own function. ;->\r\n//\r\n// For explanation of optional argument emptyOK,\r\n// see comments of function isInteger.\r\n\r\nfunction isYear (s)\r\n{   if (isEmpty(s)) \r\n       if (isYear.arguments.length == 1) return defaultEmptyOK;\r\n       else return (isYear.arguments[1] == true);\r\n    if (!isNonnegativeInteger(s)) return false;\r\n    return ((s.length == 2) || (s.length == 4));\r\n}\r\n\r\n\r\n\r\n// isIntegerInRange (STRING s, INTEGER a, INTEGER b [, BOOLEAN emptyOK])\r\n// \r\n// isIntegerInRange returns true if string s is an integer \r\n// within the range of integer arguments a and b, inclusive.\r\n// \r\n// For explanation of optional argument emptyOK,\r\n// see comments of function isInteger.\r\n\r\n\r\nfunction isIntegerInRange (s, a, b)\r\n{   if (isEmpty(s)) \r\n       if (isIntegerInRange.arguments.length == 1) return defaultEmptyOK;\r\n       else return (isIntegerInRange.arguments[1] == true);\r\n\r\n    // Catch non-integer strings to avoid creating a NaN below,\r\n    // which isn't available on JavaScript 1.0 for Windows.\r\n    if (!isInteger(s, false)) return false;\r\n\r\n    // Now, explicitly change the type to integer via parseInt\r\n    // so that the comparison code below will work both on \r\n    // JavaScript 1.2 (which typechecks in equality comparisons)\r\n    // and JavaScript 1.1 and before (which doesn't).\r\n    var num = parseInt (s);\r\n    return ((num >= a) && (num <= b));\r\n}\r\n\r\n\r\n\r\n// isMonth (STRING s [, BOOLEAN emptyOK])\r\n// \r\n// isMonth returns true if string s is a valid \r\n// month number between 1 and 12.\r\n//\r\n// For explanation of optional argument emptyOK,\r\n// see comments of function isInteger.\r\n\r\nfunction isMonth (s)\r\n{   if (isEmpty(s)) \r\n       if (isMonth.arguments.length == 1) return defaultEmptyOK;\r\n       else return (isMonth.arguments[1] == true);\r\n    return isIntegerInRange (s, 1, 12);\r\n}\r\n\r\n\r\n\r\n// isDay (STRING s [, BOOLEAN emptyOK])\r\n// \r\n// isDay returns true if string s is a valid \r\n// day number between 1 and 31.\r\n// \r\n// For explanation of optional argument emptyOK,\r\n// see comments of function isInteger.\r\n\r\nfunction isDay (s)\r\n{   if (isEmpty(s)) \r\n       if (isDay.arguments.length == 1) return defaultEmptyOK;\r\n       else return (isDay.arguments[1] == true);   \r\n    return isIntegerInRange (s, 1, 31);\r\n}\r\n\r\n\r\n\r\n// daysInFebruary (INTEGER year)\r\n// \r\n// Given integer argument year,\r\n// returns number of days in February of that year.\r\n\r\nfunction daysInFebruary (year)\r\n{   // February has 29 days in any year evenly divisible by four,\r\n    // EXCEPT for centurial years which are not also divisible by 400.\r\n    return (  ((year % 4 == 0) && ( (!(year % 100 == 0)) || (year % 400 == 0) ) ) ? 29 : 28 );\r\n}\r\n\r\n\r\n\r\n// isDate (STRING year, STRING month, STRING day)\r\n//\r\n// isDate returns true if string arguments year, month, and day \r\n// form a valid date.\r\n// \r\n\r\nfunction isDate (year, month, day)\r\n{   // catch invalid years (not 2- or 4-digit) and invalid months and days.\r\n    if (! (isYear(year, false) && isMonth(month, false) && isDay(day, false))) return false;\r\n\r\n    // Explicitly change type to integer to make code work in both\r\n    // JavaScript 1.1 and JavaScript 1.2.\r\n    var intYear = parseInt(year);\r\n    var intMonth = parseInt(month);\r\n    var intDay = parseInt(day);\r\n\r\n    // catch invalid days, except for February\r\n    if (intDay > daysInMonth[intMonth]) return false; \r\n\r\n    if ((intMonth == 2) && (intDay > daysInFebruary(intYear))) return false;\r\n\r\n    return true;\r\n}\r\n\r\n\r\n\r\n\r\n/* FUNCTIONS TO NOTIFY USER OF INPUT REQUIREMENTS OR MISTAKES. */\r\n\r\n\r\n// Display prompt string s in status bar.\r\n\r\nfunction prompt (s)\r\n{   window.status = s\r\n}\r\n\r\n\r\n\r\n// Display data entry prompt string s in status bar.\r\n\r\nfunction promptEntry (s)\r\n{   window.status = pEntryPrompt + s\r\n}\r\n\r\n\r\n\r\n\r\n// Notify user that required field theField is empty.\r\n// String s describes expected contents of theField.value.\r\n// Put focus in theField and return false.\r\n\r\nfunction warnEmpty (theField, s)\r\n{   theField.focus()\r\n    alert(mPrefix + s + mSuffix)\r\n    return false\r\n}\r\n\r\n\r\n\r\n// Notify user that contents of field theField are invalid.\r\n// String s describes expected contents of theField.value.\r\n// Put select theField, pu focus in it, and return false.\r\n\r\nfunction warnInvalid (theField, s)\r\n{   theField.focus()\r\n    theField.select()\r\n    alert(s)\r\n    return false\r\n}\r\n\r\n\r\n\r\n\r\n/* FUNCTIONS TO INTERACTIVELY CHECK VARIOUS FIELDS. */\r\n\r\n// checkString (TEXTFIELD theField, STRING s, [, BOOLEAN emptyOK==false])\r\n//\r\n// Check that string theField.value is not all whitespace.\r\n//\r\n// For explanation of optional argument emptyOK,\r\n// see comments of function isInteger.\r\n\r\nfunction checkString (theField, s, emptyOK)\r\n{   // Next line is needed on NN3 to avoid \"undefined is not a number\" error\r\n    // in equality comparison below.\r\n    if (checkString.arguments.length == 2) emptyOK = defaultEmptyOK;\r\n    if ((emptyOK == true) && (isEmpty(theField.value))) return true;\r\n    if (isWhitespace(theField.value)) \r\n       return warnEmpty (theField, s);\r\n    else return true;\r\n}\r\n\r\n\r\n\r\n// checkStateCode (TEXTFIELD theField [, BOOLEAN emptyOK==false])\r\n//\r\n// Check that string theField.value is a valid U.S. state code.\r\n//\r\n// For explanation of optional argument emptyOK,\r\n// see comments of function isInteger.\r\n\r\nfunction checkStateCode (theField, emptyOK)\r\n{   if (checkStateCode.arguments.length == 1) emptyOK = defaultEmptyOK;\r\n    if ((emptyOK == true) && (isEmpty(theField.value))) return true;\r\n    else\r\n    {  theField.value = theField.value.toUpperCase();\r\n       if (!isStateCode(theField.value, false)) \r\n          return warnInvalid (theField, iStateCode);\r\n       else return true;\r\n    }\r\n}\r\n\r\n\r\n\r\n// takes ZIPString, a string of 5 or 9 digits;\r\n// if 9 digits, inserts separator hyphen\r\n\r\nfunction reformatZIPCode (ZIPString)\r\n{   if (ZIPString.length == 5) return ZIPString;\r\n    else return (reformat (ZIPString, \"\", 5, \"-\", 4));\r\n}\r\n\r\n\r\n\r\n\r\n// checkZIPCode (TEXTFIELD theField [, BOOLEAN emptyOK==false])\r\n//\r\n// Check that string theField.value is a valid ZIP code.\r\n//\r\n// For explanation of optional argument emptyOK,\r\n// see comments of function isInteger.\r\n\r\nfunction checkZIPCode (theField, emptyOK)\r\n{   if (checkZIPCode.arguments.length == 1) emptyOK = defaultEmptyOK;\r\n    if ((emptyOK == true) && (isEmpty(theField.value))) return true;\r\n    else\r\n    { var normalizedZIP = stripCharsInBag(theField.value, ZIPCodeDelimiters)\r\n      if (!isZIPCode(normalizedZIP, false)) \r\n         return warnInvalid (theField, iZIPCode);\r\n      else \r\n      {  // if you don't want to insert a hyphen, comment next line out\r\n         theField.value = reformatZIPCode(normalizedZIP)\r\n         return true;\r\n      }\r\n    }\r\n}\r\n\r\n\r\n\r\n// takes USPhone, a string of 10 digits\r\n// and reformats as (123) 456-789\r\n\r\nfunction reformatUSPhone (USPhone)\r\n{   return (reformat (USPhone, \"(\", 3, \") \", 3, \"-\", 4))\r\n}\r\n\r\n\r\n\r\n// checkUSPhone (TEXTFIELD theField [, BOOLEAN emptyOK==false])\r\n//\r\n// Check that string theField.value is a valid US Phone.\r\n//\r\n// For explanation of optional argument emptyOK,\r\n// see comments of function isInteger.\r\n\r\nfunction checkUSPhone (theField, emptyOK)\r\n{   if (checkUSPhone.arguments.length == 1) emptyOK = defaultEmptyOK;\r\n    if ((emptyOK == true) && (isEmpty(theField.value))) return true;\r\n    else\r\n    {  var normalizedPhone = stripCharsInBag(theField.value, phoneNumberDelimiters)\r\n       if (!isUSPhoneNumber(normalizedPhone, false)) \r\n          return warnInvalid (theField, iUSPhone);\r\n       else \r\n       {  // if you don't want to reformat as (123) 456-789, comment next line out\r\n          theField.value = reformatUSPhone(normalizedPhone)\r\n          return true;\r\n       }\r\n    }\r\n}\r\n\r\n\r\n\r\n// checkInternationalPhone (TEXTFIELD theField [, BOOLEAN emptyOK==false])\r\n//\r\n// Check that string theField.value is a valid International Phone.\r\n//\r\n// For explanation of optional argument emptyOK,\r\n// see comments of function isInteger.\r\n\r\nfunction checkInternationalPhone (theField, emptyOK)\r\n{   if (checkInternationalPhone.arguments.length == 1) emptyOK = defaultEmptyOK;\r\n    if ((emptyOK == true) && (isEmpty(theField.value))) return true;\r\n    else\r\n    {  if (!isInternationalPhoneNumber(theField.value, false)) \r\n          return warnInvalid (theField, iWorldPhone);\r\n       else return true;\r\n    }\r\n}\r\n\r\n\r\n\r\n// checkEmail (TEXTFIELD theField [, BOOLEAN emptyOK==false])\r\n//\r\n// Check that string theField.value is a valid Email.\r\n//\r\n// For explanation of optional argument emptyOK,\r\n// see comments of function isInteger.\r\n\r\nfunction checkEmail (theField, emptyOK)\r\n{   if (checkEmail.arguments.length == 1) emptyOK = defaultEmptyOK;\r\n    if ((emptyOK == true) && (isEmpty(theField.value))) return true;\r\n    else if (!isEmail(theField.value, false)) \r\n       return warnInvalid (theField, iEmail);\r\n    else return true;\r\n}\r\n\r\n\r\n\r\n// takes SSN, a string of 9 digits\r\n// and reformats as 123-45-6789\r\n\r\nfunction reformatSSN (SSN)\r\n{   return (reformat (SSN, \"\", 3, \"-\", 2, \"-\", 4))\r\n}\r\n\r\n\r\n// Check that string theField.value is a valid SSN.\r\n//\r\n// For explanation of optional argument emptyOK,\r\n// see comments of function isInteger.\r\n\r\nfunction checkSSN (theField, emptyOK)\r\n{   if (checkSSN.arguments.length == 1) emptyOK = defaultEmptyOK;\r\n    if ((emptyOK == true) && (isEmpty(theField.value))) return true;\r\n    else\r\n    {  var normalizedSSN = stripCharsInBag(theField.value, SSNDelimiters)\r\n       if (!isSSN(normalizedSSN, false)) \r\n          return warnInvalid (theField, iSSN);\r\n       else \r\n       {  // if you don't want to reformats as 123-456-7890, comment next line out\r\n          theField.value = reformatSSN(normalizedSSN)\r\n          return true;\r\n       }\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n// Check that string theField.value is a valid Year.\r\n//\r\n// For explanation of optional argument emptyOK,\r\n// see comments of function isInteger.\r\n\r\nfunction checkYear (theField, emptyOK)\r\n{   if (checkYear.arguments.length == 1) emptyOK = defaultEmptyOK;\r\n    if ((emptyOK == true) && (isEmpty(theField.value))) return true;\r\n    if (!isYear(theField.value, false)) \r\n       return warnInvalid (theField, iYear);\r\n    else return true;\r\n}\r\n\r\n\r\n// Check that string theField.value is a valid Month.\r\n//\r\n// For explanation of optional argument emptyOK,\r\n// see comments of function isInteger.\r\n\r\nfunction checkMonth (theField, emptyOK)\r\n{   if (checkMonth.arguments.length == 1) emptyOK = defaultEmptyOK;\r\n    if ((emptyOK == true) && (isEmpty(theField.value))) return true;\r\n    if (!isMonth(theField.value, false)) \r\n       return warnInvalid (theField, iMonth);\r\n    else return true;\r\n}\r\n\r\n\r\n// Check that string theField.value is a valid Day.\r\n//\r\n// For explanation of optional argument emptyOK,\r\n// see comments of function isInteger.\r\n\r\nfunction checkDay (theField, emptyOK)\r\n{   if (checkDay.arguments.length == 1) emptyOK = defaultEmptyOK;\r\n    if ((emptyOK == true) && (isEmpty(theField.value))) return true;\r\n    if (!isDay(theField.value, false)) \r\n       return warnInvalid (theField, iDay);\r\n    else return true;\r\n}\r\n\r\n\r\n\r\n// checkDate (yearField, monthField, dayField, STRING labelString [, OKtoOmitDay==false])\r\n//\r\n// Check that yearField.value, monthField.value, and dayField.value \r\n// form a valid date.\r\n//\r\n// If they don't, labelString (the name of the date, like \"Birth Date\")\r\n// is displayed to tell the user which date field is invalid.\r\n//\r\n// If it is OK for the day field to be empty, set optional argument\r\n// OKtoOmitDay to true.  It defaults to false.\r\n\r\nfunction checkDate (yearField, monthField, dayField, labelString, OKtoOmitDay)\r\n{   // Next line is needed on NN3 to avoid \"undefined is not a number\" error\r\n    // in equality comparison below.\r\n    if (checkDate.arguments.length == 4) OKtoOmitDay = false;\r\n    if (!isYear(yearField.value)) return warnInvalid (yearField, iYear);\r\n    if (!isMonth(monthField.value)) return warnInvalid (monthField, iMonth);\r\n    if ( (OKtoOmitDay == true) && isEmpty(dayField.value) ) return true;\r\n    else if (!isDay(dayField.value)) \r\n       return warnInvalid (dayField, iDay);\r\n    if (isDate (yearField.value, monthField.value, dayField.value))\r\n       return true;\r\n    alert (iDatePrefix + labelString + iDateSuffix)\r\n    return false\r\n}\r\n\r\n\r\n\r\n// Get checked value from radio button.\r\n\r\nfunction getRadioButtonValue (radio)\r\n{   for (var i = 0; i < radio.length; i++)\r\n    {   if (radio[i].checked) { break }\r\n    }\r\n    return radio[i].value\r\n}\r\n\r\n\r\n\r\n\r\n// Validate credit card info.\r\n\r\nfunction checkCreditCard (radio, theField)\r\n{   var cardType = getRadioButtonValue (radio)\r\n    var normalizedCCN = stripCharsInBag(theField.value, creditCardDelimiters)\r\n    if (!isCardMatch(cardType, normalizedCCN)) \r\n       return warnInvalid (theField, iCreditCardPrefix + cardType + iCreditCardSuffix);\r\n    else \r\n    {  theField.value = normalizedCCN\r\n       return true\r\n    }\r\n}\r\n\r\n\r\n\r\n/*  ================================================================\r\n    Credit card verification functions\r\n    Originally included as Starter Application 1.0.0 in LivePayment.\r\n    20 Feb 1997 modified by egk:\r\n           changed naming convention to initial lowercase\r\n                  (isMasterCard instead of IsMasterCard, etc.)\r\n           changed isCC to isCreditCard\r\n           retained functions named with older conventions from\r\n                  LivePayment as stub functions for backward \r\n                  compatibility only\r\n           added \"AMERICANEXPRESS\" as equivalent of \"AMEX\" \r\n                  for naming consistency \r\n    ================================================================ */\r\n\r\n\r\n/*  ================================================================\r\n    FUNCTION:  isCreditCard(st)\r\n \r\n    INPUT:     st - a string representing a credit card number\r\n\r\n    RETURNS:  true, if the credit card number passes the Luhn Mod-10\r\n\t\t    test.\r\n\t      false, otherwise\r\n    ================================================================ */\r\n\r\nfunction isCreditCard(st) {\r\n  // Encoding only works on cards with less than 19 digits\r\n  if (st.length > 19)\r\n    return (false);\r\n\r\n  sum = 0; mul = 1; l = st.length;\r\n  for (i = 0; i < l; i++) {\r\n    digit = st.substring(l-i-1,l-i);\r\n    tproduct = parseInt(digit ,10)*mul;\r\n    if (tproduct >= 10)\r\n      sum += (tproduct % 10) + 1;\r\n    else\r\n      sum += tproduct;\r\n    if (mul == 1)\r\n      mul++;\r\n    else\r\n      mul--;\r\n  }\r\n// Uncomment the following line to help create credit card numbers\r\n// 1. Create a dummy number with a 0 as the last digit\r\n// 2. Examine the sum written out\r\n// 3. Replace the last digit with the difference between the sum and\r\n//    the next multiple of 10.\r\n\r\n//  document.writeln(\"<BR>Sum      = \",sum,\"<BR>\");\r\n//  alert(\"Sum      = \" + sum);\r\n\r\n  if ((sum % 10) == 0)\r\n    return (true);\r\n  else\r\n    return (false);\r\n\r\n} // END FUNCTION isCreditCard()\r\n\r\n\r\n\r\n/*  ================================================================\r\n    FUNCTION:  isVisa()\r\n \r\n    INPUT:     cc - a string representing a credit card number\r\n\r\n    RETURNS:  true, if the credit card number is a valid VISA number.\r\n\t\t    \r\n\t      false, otherwise\r\n\r\n    Sample number: 4111 1111 1111 1111 (16 digits)\r\n    ================================================================ */\r\n\r\nfunction isVisa(cc)\r\n{\r\n  if (((cc.length == 16) || (cc.length == 13)) &&\r\n      (cc.substring(0,1) == 4))\r\n    return isCreditCard(cc);\r\n  return false;\r\n}  // END FUNCTION isVisa()\r\n\r\n\r\n\r\n\r\n/*  ================================================================\r\n    FUNCTION:  isMasterCard()\r\n \r\n    INPUT:     cc - a string representing a credit card number\r\n\r\n    RETURNS:  true, if the credit card number is a valid MasterCard\r\n\t\t    number.\r\n\t\t    \r\n\t      false, otherwise\r\n\r\n    Sample number: 5500 0000 0000 0004 (16 digits)\r\n    ================================================================ */\r\n\r\nfunction isMasterCard(cc)\r\n{\r\n  firstdig = cc.substring(0,1);\r\n  seconddig = cc.substring(1,2);\r\n  if ((cc.length == 16) && (firstdig == 5) &&\r\n      ((seconddig >= 1) && (seconddig <= 5)))\r\n    return isCreditCard(cc);\r\n  return false;\r\n\r\n} // END FUNCTION isMasterCard()\r\n\r\n\r\n\r\n\r\n\r\n/*  ================================================================\r\n    FUNCTION:  isAmericanExpress()\r\n \r\n    INPUT:     cc - a string representing a credit card number\r\n\r\n    RETURNS:  true, if the credit card number is a valid American\r\n\t\t    Express number.\r\n\t\t    \r\n\t      false, otherwise\r\n\r\n    Sample number: 340000000000009 (15 digits)\r\n    ================================================================ */\r\n\r\nfunction isAmericanExpress(cc)\r\n{\r\n  firstdig = cc.substring(0,1);\r\n  seconddig = cc.substring(1,2);\r\n  if ((cc.length == 15) && (firstdig == 3) &&\r\n      ((seconddig == 4) || (seconddig == 7)))\r\n    return isCreditCard(cc);\r\n  return false;\r\n\r\n} // END FUNCTION isAmericanExpress()\r\n\r\n\r\n\r\n\r\n/*  ================================================================\r\n    FUNCTION:  isDinersClub()\r\n \r\n    INPUT:     cc - a string representing a credit card number\r\n\r\n    RETURNS:  true, if the credit card number is a valid Diner's\r\n\t\t    Club number.\r\n\t\t    \r\n\t      false, otherwise\r\n\r\n    Sample number: 30000000000004 (14 digits)\r\n    ================================================================ */\r\n\r\nfunction isDinersClub(cc)\r\n{\r\n  firstdig = cc.substring(0,1);\r\n  seconddig = cc.substring(1,2);\r\n  if ((cc.length == 14) && (firstdig == 3) &&\r\n      ((seconddig == 0) || (seconddig == 6) || (seconddig == 8)))\r\n    return isCreditCard(cc);\r\n  return false;\r\n}\r\n\r\n\r\n\r\n/*  ================================================================\r\n    FUNCTION:  isCarteBlanche()\r\n \r\n    INPUT:     cc - a string representing a credit card number\r\n\r\n    RETURNS:  true, if the credit card number is a valid Carte\r\n\t\t    Blanche number.\r\n\t\t    \r\n\t      false, otherwise\r\n    ================================================================ */\r\n\r\nfunction isCarteBlanche(cc)\r\n{\r\n  return isDinersClub(cc);\r\n}\r\n\r\n\r\n\r\n\r\n/*  ================================================================\r\n    FUNCTION:  isDiscover()\r\n \r\n    INPUT:     cc - a string representing a credit card number\r\n\r\n    RETURNS:  true, if the credit card number is a valid Discover\r\n\t\t    card number.\r\n\t\t    \r\n\t      false, otherwise\r\n\r\n    Sample number: 6011000000000004 (16 digits)\r\n    ================================================================ */\r\n\r\nfunction isDiscover(cc)\r\n{\r\n  first4digs = cc.substring(0,4);\r\n  if ((cc.length == 16) && (first4digs == \"6011\"))\r\n    return isCreditCard(cc);\r\n  return false;\r\n\r\n} // END FUNCTION isDiscover()\r\n\r\n\r\n\r\n\r\n\r\n/*  ================================================================\r\n    FUNCTION:  isEnRoute()\r\n \r\n    INPUT:     cc - a string representing a credit card number\r\n\r\n    RETURNS:  true, if the credit card number is a valid enRoute\r\n\t\t    card number.\r\n\t\t    \r\n\t      false, otherwise\r\n\r\n    Sample number: 201400000000009 (15 digits)\r\n    ================================================================ */\r\n\r\nfunction isEnRoute(cc)\r\n{\r\n  first4digs = cc.substring(0,4);\r\n  if ((cc.length == 15) &&\r\n      ((first4digs == \"2014\") ||\r\n       (first4digs == \"2149\")))\r\n    return isCreditCard(cc);\r\n  return false;\r\n}\r\n\r\n\r\n\r\n/*  ================================================================\r\n    FUNCTION:  isJCB()\r\n \r\n    INPUT:     cc - a string representing a credit card number\r\n\r\n    RETURNS:  true, if the credit card number is a valid JCB\r\n\t\t    card number.\r\n\t\t    \r\n\t      false, otherwise\r\n    ================================================================ */\r\n\r\nfunction isJCB(cc)\r\n{\r\n  first4digs = cc.substring(0,4);\r\n  if ((cc.length == 16) &&\r\n      ((first4digs == \"3088\") ||\r\n       (first4digs == \"3096\") ||\r\n       (first4digs == \"3112\") ||\r\n       (first4digs == \"3158\") ||\r\n       (first4digs == \"3337\") ||\r\n       (first4digs == \"3528\")))\r\n    return isCreditCard(cc);\r\n  return false;\r\n\r\n} // END FUNCTION isJCB()\r\n\r\n\r\n\r\n/*  ================================================================\r\n    FUNCTION:  isAnyCard()\r\n \r\n    INPUT:     cc - a string representing a credit card number\r\n\r\n    RETURNS:  true, if the credit card number is any valid credit\r\n\t\t    card number for any of the accepted card types.\r\n\t\t    \r\n\t      false, otherwise\r\n    ================================================================ */\r\n\r\nfunction isAnyCard(cc)\r\n{\r\n  if (!isCreditCard(cc))\r\n    return false;\r\n  if (!isMasterCard(cc) && !isVisa(cc) && !isAmericanExpress(cc) && !isDinersClub(cc) &&\r\n      !isDiscover(cc) && !isEnRoute(cc) && !isJCB(cc)) {\r\n    return false;\r\n  }\r\n  return true;\r\n\r\n} // END FUNCTION isAnyCard()\r\n\r\n\r\n\r\n/*  ================================================================\r\n    FUNCTION:  isCardMatch()\r\n \r\n    INPUT:    cardType - a string representing the credit card type\r\n\t      cardNumber - a string representing a credit card number\r\n\r\n    RETURNS:  true, if the credit card number is valid for the particular\r\n\t      credit card type given in \"cardType\".\r\n\t\t    \r\n\t      false, otherwise\r\n    ================================================================ */\r\n\r\nfunction isCardMatch (cardType, cardNumber)\r\n{\r\n\r\n\tcardType = cardType.toUpperCase();\r\n\tvar doesMatch = true;\r\n\r\n\tif ((cardType == \"VISA\") && (!isVisa(cardNumber)))\r\n\t\tdoesMatch = false;\r\n\tif ((cardType == \"MASTERCARD\") && (!isMasterCard(cardNumber)))\r\n\t\tdoesMatch = false;\r\n\tif ( ( (cardType == \"AMERICANEXPRESS\") || (cardType == \"AMEX\") )\r\n                && (!isAmericanExpress(cardNumber))) doesMatch = false;\r\n\tif ((cardType == \"DISCOVER\") && (!isDiscover(cardNumber)))\r\n\t\tdoesMatch = false;\r\n\tif ((cardType == \"JCB\") && (!isJCB(cardNumber)))\r\n\t\tdoesMatch = false;\r\n\tif ((cardType == \"DINERS\") && (!isDinersClub(cardNumber)))\r\n\t\tdoesMatch = false;\r\n\tif ((cardType == \"CARTEBLANCHE\") && (!isCarteBlanche(cardNumber)))\r\n\t\tdoesMatch = false;\r\n\tif ((cardType == \"ENROUTE\") && (!isEnRoute(cardNumber)))\r\n\t\tdoesMatch = false;\r\n\treturn doesMatch;\r\n\r\n}  // END FUNCTION CardMatch()\r\n\r\n\r\n\r\n\r\n/*  ================================================================\r\n    The below stub functions are retained for backward compatibility\r\n    with the original LivePayment code so that it should be possible\r\n    in principle to swap in this new module as a replacement for the  \r\n    older module without breaking existing code.  (There are no\r\n    guarantees, of course, but it should work.)\r\n\r\n    When writing new code, do not use these stub functions; use the\r\n    functions defined above.\r\n    ================================================================ */\r\n\r\nfunction IsCC (st) {\r\n    return isCreditCard(st);\r\n}\r\n\r\nfunction IsVisa (cc)  {\r\n  return isVisa(cc);\r\n}\r\n\r\nfunction IsVISA (cc)  {\r\n  return isVisa(cc);\r\n}\r\n\r\nfunction IsMasterCard (cc)  {\r\n  return isMasterCard(cc);\r\n}\r\n\r\nfunction IsMastercard (cc)  {\r\n  return isMasterCard(cc);\r\n}\r\n\r\nfunction IsMC (cc)  {\r\n  return isMasterCard(cc);\r\n}\r\n\r\nfunction IsAmericanExpress (cc)  {\r\n  return isAmericanExpress(cc);\r\n}\r\n\r\nfunction IsAmEx (cc)  {\r\n  return isAmericanExpress(cc);\r\n}\r\n\r\nfunction IsDinersClub (cc)  {\r\n  return isDinersClub(cc);\r\n}\r\n\r\nfunction IsDC (cc)  {\r\n  return isDinersClub(cc);\r\n}\r\n\r\nfunction IsDiners (cc)  {\r\n  return isDinersClub(cc);\r\n}\r\n\r\nfunction IsCarteBlanche (cc)  {\r\n  return isCarteBlanche(cc);\r\n}\r\n\r\nfunction IsCB (cc)  {\r\n  return isCarteBlanche(cc);\r\n}\r\n\r\nfunction IsDiscover (cc)  {\r\n  return isDiscover(cc);\r\n}\r\n\r\nfunction IsEnRoute (cc)  {\r\n  return isEnRoute(cc);\r\n}\r\n\r\nfunction IsenRoute (cc)  {\r\n  return isEnRoute(cc);\r\n}\r\n\r\nfunction IsJCB (cc)  {\r\n  return isJCB(cc);\r\n}\r\n\r\nfunction IsAnyCard(cc)  {\r\n  return isAnyCard(cc);\r\n}\r\n\r\nfunction IsCardMatch (cardType, cardNumber)  {\r\n  return isCardMatch (cardType, cardNumber);\r\n}","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["Field validation","Form validation","Validation"]},{"RecordId":"477","Title":"Create Excel File Download (Prefered)","Description":"Creates Excel file download without going through external file creation.  Creates a tab delimited text stream.\r\n\r\nNOTE:  Set response.buffer = true","Code":"NOTE:  There are 5 key points to this sample.  Each is identified with \"<-- This is trick x\".\r\n\r\n<%@Language=VBScript%>\r\n\r\n<%\r\noption explicit\r\nresponse.expires= 0\r\n\r\nResponse.buffer = true                                                                                   '<-- This is trick 1\r\nResponse.ContentType = \"application/vnd.ms-excel\"                                   '<-- This is trick 2\r\nResponse.AddHeader \"content-disposition\", \"inline; filename=dynamic.xls\"  '<-- This is trick 3\r\n\r\n%>\r\n\r\n<!--#include file=\"../dsn.asp\"-->\r\n\r\n<%\r\n\r\ndim oCN\r\ndim oRS\r\ndim strSQL\r\ndim strStartDate\r\ndim strEndDate\r\ndim strOut\r\ndim i\r\n\r\nstrStartDate = request.form(\"optStartMonth\") & \"/\" & request.form(\"optStartDay\") & \"/\" & request.form(\"optStartYear\")\r\nstrEndDate = request.form(\"optEndMonth\") & \"/\" & request.form(\"optEndDay\") & \"/\" & request.form(\"optEndYear\")\r\n\r\nstrSQL = \"SELECT * FROM CEO_Summit_Reg_2001 \"\r\nstrSQL = strsql & \" WHERE RegistrationDate BETWEEN '\" & strStartDate & \"' AND '\" & strEndDate & \"'\"\r\n\r\nset oCN = Server.CreateObject(\"ADODB.Connection\")\r\nset oRS = Server.CreateObject(\"ADODB.Recordset\")\r\n\r\noCN.Open strConnect\r\noRS.Open strSQL, oCN, 0, 1\r\nif not oRS.EOF Then\r\n\r\n\tstrOut = \"\"\r\n\tfor i = 0 to oRS.Fields.Count-1\r\n\t\tstrOut = strOut & oRS.Fields(i).Name & vbtab\r\n\tnext\r\n\tstrOut = left(strOut,len(strOut)-1) & vbCrLf\r\n\tresponse.write strOut\r\n\r\n\tdo while not oRS.EOF\r\n\t\tstrOut = \"\"\r\n\t\tfor i = 0 to oRS.Fields.Count-1\r\n\t\t\tstrOut = strOut & oRS.Fields(i).Value & vbtab\r\n\t\tnext\r\n\t\tstrOut = left(strOut,len(strOut)-1) & vbCrLf\r\n\t\tresponse.write strOut\r\n\t\toRS.movenext\r\n\tloop\r\nend if\r\n\r\noRS.close\r\noCN.close\r\nset oRS=nothing\r\nset oCN=nothing\r\n\r\nResponse.flush        '<-- This is trick 4\r\nResponse.end         '<-- This is trick 5\r\n\r\n%>","Declares":"","CodeCategory":{"CategoryId":"5","CategoryDescription":"ASP"},"Keywords":["Excel","Download","Content Type"]},{"RecordId":"478","Title":"HTTP Meta Tags","Description":"Listing of META HTTP-EQUIV tags.","Code":"Placement of META tags\r\nMETA tags should always be placed in the head of the HTML document between the actual <HEAD> tags, before the BODY tag. This is very important with framed pages, as a lot of developers tend to forget to include them on individual framed pages. Remember, if you only use META tags on the frameset pages, you'll be missing a large number of potential hits.\r\n\r\nExpires\r\nThis tells the browser the date and time when the document will be considered \"expired.\" If a user is using Netscape Navigator, a request for a document whose time has \"expired\" will initiate a new network request for the document. An illegal Expires date such as \"0\" is interpreted by the browser as \"immediately.\" Dates must be in the RFC850 format, (GMT format): \r\n<META HTTP-EQUIV=\"expires\" CONTENT=\"Wed, 26 Feb 1997 08:21:57 GMT\"> \r\n\r\nPragma\r\nThis is another way to control browser caching. To use this tag, the value must be \"no-cache\". When this is included in a document, it prevents Netscape Navigator from caching a page locally.\r\n<META HTTP-EQUIV=\"Pragma\" CONTENT=\"no-cache\"> \r\n\r\nThese two tags can be used as together as shown to keep your content current, but beware. Many users have reported that Microsofts Internet Explorer refuses the META tag instructions, and caches the files anyway. So far, nobody has been able to supply a fix to this \"bug.\" As of the release of MSIE 4.01, this problem still existed. \r\n\r\nRefresh\r\nThis tag specifies the time in seconds before the Web browser reloads the document automatically. Alternatively, it can specify a different URL for the browser to load. \r\n<META HTTP-EQUIV=\"Refresh\" CONTENT=\"0;URL=http://www.newurl.com\">\r\n\r\nSet-Cookie\r\nThis is one method of setting a \"cookie\" in the users Web browser. If you use an expiration date, the cookie is considered permanent and will be saved to disk (until it expires), otherwise it will be considered valid only for the current session and will be erased upon closing the Web browser.\r\n<META HTTP-EQUIV=\"Set-Cookie\" CONTENT=\"cookievalue=xxx;expires=Wednesday, 21-Oct-98 16:14:21 GMT; path=/\"> \r\n\r\nWindow-target\r\nThis one specifies the \"named window\" of the current page, and can be used to prevent a page from appearing inside another framed page. Usually this means that the Web browser will force the page to go the top frameset.\r\n<META HTTP-EQUIV=\"Window-target\" CONTENT=\"_top\"> \r\n\r\nPICS-Label\r\nAlthough you may not have heard of PICS-Label (PICS stands for Platform for Internet Content Selection), you probably will soon. At the same time that the Communications Decency Act was struck down, the World Wide Web Consortium (W3C) was working to develop a standard for labeling online content (see www.w3.org/PICS/ ). This standard became the Platform for Internet Content Selection (PICS). The W3Cs standard left the actual creation of labels to the \"labeling services.\" Anything which has a URL can be labeled, and labels can be assigned in two ways. First, a third party labeling service may rate the site, and the labels are stored at the actual labeling bureau which resides on the Web server of the labeling service. The second method involves the developer or Web site host contacting a rating service, filling out the proper forms, and using the HTML META tag information that the service provides on their pages. One such free service is the PICS-Label generator that Vancouver-Webpages provides. It is based on the Vancouver Webpages Canadian PICS ratings, version 1.0, and can be used as a guideline for creating your own PICS-Label META tag. \r\n\r\nAlthough PICS-Label was designed as a ratings label, it also has other uses, including code signing, privacy, and intellectual property rights management. PICS uses what is called generic and specific labels. Generic labels apply to each document whose URL begins with a specific string of characters, while specific labels apply only to a given file. A typical PICS-Label for an entire site would look like this:\r\n<META http-equiv=\"PICS-Label\" content='(PICS-1.1 \"http://vancouver-webpages.com/VWP1.0/\" l gen true comment \"VWP1.0\" by \"scott@hisdomain.com\" on \"1997.10.28T12:34-0800\" for \"http://www.hisdomain.com/\" r (P 2 S 0 SF -2 V 0 Tol -2 Com 0 Env -2 MC -3 Gam -1 Can 0 Edu -1 ))'> \r\n\r\nKeyword and Description attributes\r\nChances are that if you manually code your Web pages, youre aware of the \"keyword\" and \"description\" attributes. These allow the search engines to easily index your page using the keywords you specifically tell it, along with a description of the site that you yourself get to write. Couldnt be simpler, right? You use the keywords attribute to tell the search engines which keywords to use, like this:\r\n<META NAME =\"keywords\" CONTENT=\"life, universe, mankind, plants, relationships, the meaning of life, science\"> \r\n\r\nBy the way, dont think you can spike the keywords by using the same word repeated over and over, as most search engines have refined their spiders to ignore such spam. Using the META description attribute, you add your own description for your page:\r\n<META NAME=\"description\" CONTENT=\"This page is about the meaning of life, the universe, mankind and plants.\"> \r\n\r\nMake sure that you use several of your keywords in your description. While you are at it, you may want to include the same description enclosed in comment tags, just for the spiders that do not look at META tags. To do that, just use the regular comment tags, like this:\r\n<!--// This page is about the meaning of life, the universe, mankind and plants. //--!> \r\n\r\nROBOTs in the mist\r\nOn the other hand, there are probably some of you who do not wish your pages to be indexed by the spiders at all. Worse yet, you may not have access to the robots.txt file. The robots META attribute was designed with this problem in mind. \r\n<META NAME=\"robots\" CONTENT=\"all | none | index | noindex | follow | nofollow\"> \r\n\r\nThe default for the robot attribute is \"all\". This would allow all of the files to be indexed. \"None\" would tell the spider not to index any files, and not to follow the hyperlinks on the page to other pages. \"Index\" indicates that this page may be indexed by the spider, while \"follow\" would mean that the spider is free to follow the links from this page to other pages. The inverse is also true, thus this META tag:\r\n<META NAME=\"robots\" CONTENT=\" noindex\"> \r\n\r\nwould tell the spider not to index this page, but would allow it to follow subsidiary links and index those pages. \"nofollow\" would allow the page itself to be indexed, but the links could not be followed. As you can see, the robots attribute can be very useful for Web developers. For more information about the robot attribute, visit the W3Cs robot paper.","Declares":"","CodeCategory":{"CategoryId":"2","CategoryDescription":"Web"},"Keywords":["Meta Tags","HTTP-EQUIV","HTTP Meta Tags"]},{"RecordId":"479","Title":"Use ADO Stream Object to Write Binary Data","Description":"Uses ADO Stream object to write binary data to the response object","Code":"<%\r\n'Set the content type to the specific type that you are sending.\r\nResponse.ContentType = \"application/x-msexcel\"\r\n\r\nConst adTypeBinary = 1\r\nDim strFilePath\r\n\r\nstrFilePath = \"C:\\ExcelFiles\\Excel1.xls\" 'This is the path to the file on disk. \r\n\r\nSet objStream = Server.CreateObject(\"ADODB.Stream\")\r\nobjStream.Open\r\nobjStream.Type = adTypeBinary\r\nobjStream.LoadFromFile strFilePath\r\n\r\nResponse.BinaryWrite objStream.Read\r\n\r\nobjStream.Close\r\nSet objStream = Nothing\r\n%> \r\n","Declares":"","CodeCategory":{"CategoryId":"5","CategoryDescription":"ASP"},"Keywords":["BinaryWrite","MIME","Stream"]},{"RecordId":"481","Title":"Display Page 1 to N Pages With Next/Prev Buttons","Description":"Demonstrates how to display 10 records per page with next/previous buttons.","Code":"<%@Language=VBScript%>\r\n<%\r\noption explicit\r\nresponse.expires= 0\r\n%>\r\n\r\n<!--#include file=\"../dsn.asp\"-->\r\n\r\n<%\r\n\r\nIf Request.Cookies(\"Fast500CeoSummitAdmin\")(\"authenticated\") <> \"1\" Then\r\n\tResponse.Redirect(\"default.asp\")\r\nEnd If\r\n\r\ndim oCN\r\ndim oRS\r\ndim strSQL\r\ndim intPageSize\r\ndim intRecs\r\n\r\ndim lngConfirmationNumber\r\n\r\ndim strFullName\r\ndim strCompanyName\r\ndim datInvoiceDate\r\ndim datRegistrationDate\r\n\r\ndim strSortBy\r\ndim strSearchBy\r\ndim strSearchArg\r\ndim strWhere\r\n\r\nstrSearchBy = trim(Request.Form(\"txtSearchBy\"))\r\nstrSearchArg = trim(Request.Form(\"txtSearchArg\"))\r\nstrSortBy = trim(Request.Form(\"txtSortBy\"))\r\nintPageSize=10\r\n\r\nstrWhere = \"\"\r\nif strSearchBy = \"0\" Then\r\n\tstrSearchArg = \"\"\r\nend if\r\n\r\n\r\n\r\nIf strSearchBy <> \"\" and strSearchBy <> \"0\" and strSearchArg <> \"\" Then\r\n  select case strSearchBy\r\n    case \"1\":\r\n      strWhere = \"WHERE ConfirmationNumber = \" & replace(strSearchArg,\"'\",\"\")\r\n    case \"2\":\r\n      strWhere = \"WHERE AttendeeCompany LIKE '%\" & replace(strSearchArg,\"'\",\"''\") & \"%'\"\r\n    case \"3\":\r\n      strWhere = \"WHERE AttendeeFullName LIKE '%\" &  replace(strSearchArg,\"'\",\"''\") & \"%'\"\r\n    end select\r\nEnd If\r\n\r\nstrSQL = \"SELECT * FROM CEO_Summit_Reg_2001 \"\r\nif strWhere <> \"\" Then\r\n  strsql = strsql & strWhere\r\nend if\r\n\r\nif strSortBy <> \"\" then\r\n  strsql=strsql & \" ORDER BY \" & strSortBy\r\nend if\r\n\r\nset oCN = Server.CreateObject(\"ADODB.Connection\")\r\nset oRS = Server.CreateObject(\"ADODB.Recordset\")\r\n\r\noRS.PageSize = intPageSize\r\n\r\noCN.Open strConnect\r\n'oRS.Open strSQL, oCN, 0, 1\r\noRS.Open strSQL, oCN, 3, 1\r\n\r\nif request.form(\"txtPageNumber\") <> \"\" then\r\n  oRS.AbsolutePage = request.form(\"txtPageNumber\")\r\nend if\r\n\r\n%>\r\n\r\n<html>\r\n<head>\r\n<title>Fast 500 2001 CEO Summit Registration Administration</title>\r\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=iso-8859-1\">\r\n\r\n<script language=\"JavaScript\" src=\"../jsUtils.js\">\r\n</script>\r\n\r\n<script language=\"JavaScript\" type=\"text/javascript\">\r\n\r\nfunction ToggleBackButton(strFlag) {\r\n  if (strFlag == '1') {\r\n    document.btnBack.src=\"../images/btnBackOver.gif\"\r\n  } else {\r\n    document.btnBack.src=\"../images/btnBack.gif\"\r\n  }\r\n}\r\n\r\nfunction ToggleSearchButton(strFlag) {\r\n  if (strFlag == '1') {\r\n    document.btnSearch.src=\"../images/btnSearchOver.gif\"\r\n  } else {\r\n    document.btnSearch.src=\"../images/btnSearch.gif\"\r\n  }\r\n}\r\n\r\nfunction TriggerSort(strSortColumn){\r\n  document.frm.txtSortBy.value = strSortColumn;\r\n  document.frm.submit();\r\n}\t\t\r\n\r\nfunction GoToPage(strPageNumber){\r\n  document.frm.txtPageNumber.value = strPageNumber;\r\n  document.frm.submit();\r\n}\t\t\r\n\r\nfunction Validate2(){\r\n\r\n  var f = document.frm;\r\n  var strError = false;\r\n\r\n  // If search argument is not blank, search by must be \"all\"\r\n  if (!isBlank(f.txtSearchArg.value) && (f.txtSearchBy.selectedIndex == 0)) {\r\n    alert('If there is no Search For value, you must select ALL as the Search By value.')\r\n    f.txtSearchArg.focus();\r\n    strError = true;\r\n  }\r\n\r\n  // If searching by conf#, value must be numeric and not greater than 10 bytes\r\n  if (f.txtSearchBy.selectedIndex == 1) {\r\n    if (!isNumeric(f.txtSearchArg.value)) {\r\n      alert('If searching by Confirmation Number, the number that you enter to find must be numeric.')\r\n      f.txtSearchArg.focus();\r\n      strError = true;\r\n    }\r\n\r\n    if (f.txtSearchArg.value.length > 10) {\r\n      alert('A confirmation number can only by 10 bytes in length.')\r\n      f.txtSearchArg.focus();\r\n      strError = true;\r\n    }\r\n  }\r\n\r\n  if (strError) {\r\n    return(false)\r\n  } else {\r\n    return(true)\r\n  };\r\n}\r\n\r\nfunction ValidateForm(){\r\n\r\n  var f = document.frm;\r\n  var strSubmit = Validate2();\r\n\r\n  if (strSubmit){\r\n    f.submit();\r\n  }\r\n}\r\n\r\n</SCRIPT>\r\n\r\n\r\n<style type=\"text/css\">\r\n\r\nA:LINK, A:VISITED, A:ACTIVE {\r\n  font : 8pt Arial, Helvetica, sans-serif;\r\n  color : #000000;\r\n}\r\n\r\nA:HOVER {\r\n  font : 8pt Arial, Helvetica, sans-serif;\r\n  color : #FF0000;\r\n}\r\n\r\nA.TableHdr:LINK, A.TableHdr:VISITED,A.TableHdr:ACTIVE{\r\n  font : bold 8pt Arial, Helvetica, sans-serif;\r\n  color : #FFFFFF;\r\n  }\r\n\r\nA.TableHdr:HOVER{\r\n  font : bold 8pt Arial, Helvetica, sans-serif;\r\n  color : #FF0000;\r\n}\r\n\t\r\n.TableHdr{\r\n  font : bold 8pt Arial, Helvetica, sans-serif;\r\n  color : #FFFFFF;\r\n}\r\n\t\r\n.TableRow{\r\n  font : 8pt Arial, Helvetica, sans-serif;\r\n  color : #000000;\r\n}\r\n\r\n.TextLabels{\r\n  font : bold 8pt Arial, Helvetica, sans-serif;\r\n  color : #000000;\r\n}\r\n\r\n</style>\r\n\t\r\n</head>\r\n\r\n<body bgcolor=\"#9999cc\" topmargin=\"0\" bottommargin=\"0\" leftmargin=\"0\" rightmargin=\"0\">\r\n\r\n<Form name=\"frm\" method=\"post\" action=\"ReservationSearch.asp\" onsubmit=\"return Validate2()\">\r\n<input type=\"hidden\" name=\"txtSortBy\" value=\"<% =strSortBy %>\">\r\n<input type=\"hidden\" name=\"txtPageNumber\">\r\n\r\n<table width=\"575\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\r\n  <tr>\r\n    <td><img src=\"../images/1px.gif\" height=\"1\" width=\"40\"></td>\r\n    <td><img src=\"../images/1px.gif\" height=\"1\" width=\"530\"></td>\r\n  </tr>\r\n  <tr> \r\n    <td colspan=\"2\" align=\"center\">&nbsp;</td>\r\n  </tr>\r\n  <tr> \r\n    <td colspan=\"2\" align=\"center\"><img src=\"../Images/RegSearch_Header.gif\" border=\"0\"></td>\r\n  </tr>\r\n  <tr> \r\n    <td colspan=\"2\" align=\"center\">&nbsp;</td>\r\n  </tr>\r\n  <tr>\r\n    <td>&nbsp;</td>\r\n    <td>\r\n\t\t\r\n      <table width=\"570\" border=\"0\" cellpadding=\"3\" cellspacing=\"0\">\r\n\t\t\t\r\n        <tr class=\"TextLabels\">\r\n          <td colspan=\"2\">\r\nTo search, select the column that you wish to search in the Search By field and enter a phrase to match in the Search For field.\r\n          </td>\r\n        </tr>\r\n        <tr class=\"TextLabels\">\r\n          <td valign=\"middle\">\r\nSearch by:&nbsp;&nbsp;\r\n<select name=\"txtSearchBy\" size=\"1\">\r\n  <option value=\"0\" <% if strSearchBy = \"\" or strSearchBy = \"0\" then response.write \"SELECTED\" %>>All</option>\r\n  <option value=\"1\" <% if strSearchBy = \"1\" then response.write \"SELECTED\" %>>Confirmation Number</option>\r\n  <option value=\"2\" <% if strSearchBy = \"2\" then response.write \"SELECTED\" %>>Company</option>\r\n  <option value=\"3\" <% if strSearchBy = \"3\" then response.write \"SELECTED\" %>>Attendee Name</option>\r\n</select>\r\n\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Search for:&nbsp;&nbsp;\r\n<input type=\"Text\" name=\"txtSearchArg\" size=\"20\" maxlength=\"20\" value=\"<%= strSearchArg%>\">\r\n          </td>\r\n          <td valign=\"middle\">\r\n<a href=\"JAVASCRIPT:ValidateForm();\"><img src=\"../images/btnSearch.gif\" border=\"0\" vspace=\"0\" hspace=\"0\" name=\"btnSearch\" onmouseover=\"ToggleSearchButton('1');\" onmouseout=\"ToggleSearchButton('0');\"></a>\r\n          </td>\r\n          </tr>\r\n\r\n        <tr class=\"TextLabels\"><td colspan=\"2\">&nbsp;</td></tr>\r\n\r\n          <% if not oRS.EOF then %>\r\n\r\n          <tr class=\"TextLabels\">\r\n            <td align=\"left\" colspan=\"2\">\r\n              <% if oRS.AbsolutePage <> 1 Then %>\r\n<a href=\"JAVASCRIPT:GoToPage('<% = oRS.AbsolutePage-1 %>');\" class=\"TableHdr\">Previous page</a>\r\n\t\t\t\t\t\t\t\t&nbsp;&nbsp;&nbsp;\r\n              <% end if %>\r\n\t\t\t\t\t\t\t\r\n<% \r\n' Records x to y of z total \r\nresponse.write \"Records \"\r\n\r\nif oRS.AbsolutePage = 1 Then\r\n  Response.write \"1\"\r\nelse\r\n  Response.write (((oRS.AbsolutePage - 1) * intPageSize) + 1)\r\nend if\r\n\t\t\t\t\t\t\t   \r\nresponse.write \" to \"\t\r\n\t\t\t\t\t\t\t\r\nif oRS.AbsolutePage = oRs.PageCount Then\r\n  Response.write oRS.RecordCount\r\nelse\r\n  Response.write (oRS.AbsolutePage * intPageSize)\r\nend if\r\n\t\t\t\t\t\t\t    \r\nresponse.write \" of \" & oRS.RecordCount & \" total\"\r\n%>\r\n\r\n&nbsp;&nbsp;&nbsp;\r\n\t\t\t\t\t\r\n<% if oRS.AbsolutePage <> oRs.PageCount Then %>\r\n<a href=\"JAVASCRIPT:GoToPage('<% = oRS.AbsolutePage+1 %>');\" class=\"TableHdr\">Next page</a>\r\n<% end if %>\r\n</td>\r\n</tr>\r\n\t\r\n<tr class=\"TextLabels\"><td colspan=\"2\">&nbsp;</td></tr>\r\n\r\n<tr class=\"TextLabels\">\r\n<td colspan=\"2\">\r\nTo sort on a specific column, click on the column header of the column that you desire to sort by.\r\n</td>\r\n</tr>\r\n<% end if %>\r\n\r\n</table>\r\n\r\n<table width=\"100%\" border=\"1\" cellpadding=\"2\" cellspacing=\"0\" bordercolor=\"#FFFFFF\">\r\n\t\t\t\t\t\r\n<% if not oRS.EOF then %>\r\n\r\n<tr bgcolor=\"#330066\">\r\n<td align=\"center\" class=\"TableHdr\"><a href=\"JAVASCRIPT:TriggerSort('ConfirmationNumber');\" class=\"TableHdr\">Conf<br>Number</a></td>\r\n<td class=\"TableHdr\"><a href=\"JAVASCRIPT:TriggerSort('AttendeeCompany');\" class=\"TableHdr\">Company</a></td>\r\n<td class=\"TableHdr\"><a href=\"JAVASCRIPT:TriggerSort('AttendeeFullName');\" class=\"TableHdr\">Attendee Name</a></td>\r\n<td align=\"center\" class=\"TableHdr\"><a href=\"JAVASCRIPT:TriggerSort('RegistrationDate');\" class=\"TableHdr\">Reg<br>Date</a></td>\r\n<td align=\"center\" class=\"TableHdr\"><a href=\"JAVASCRIPT:TriggerSort('InvoiceDate');\" class=\"TableHdr\">Invoice<br>Date</a></td>\r\n<td align=\"center\" colspan=\"4\" class=\"TableHdr\">View-Edit-Delete-Invoice</td>\r\n</tr>\r\n\r\n<% \r\nintRecs = 0\r\ndo while not oRS.EOF and intRecs < intPageSize %>\r\n\t\t\t\t\t\r\n<tr bgcolor=\"#CCCCFF\" class=\"TableRow\"> \r\n<td align=\"center\"><%= trim(oRS(\"ConfirmationNumber\") & \"\")%></td>\r\n<td><%= trim(oRS(\"AttendeeCompany\") & \"\")%></td>\r\n<td><%= trim(oRS(\"AttendeeFullName\") & \"\")%></td>\r\n<td align=\"center\"><%= formatdatetime(oRS(\"RegistrationDate\"),vbshortdate)%></td>\r\n<% if not isnull(oRS(\"InvoiceDate\")) Then %>\r\n<td align=\"center\"><%= formatdatetime(oRS(\"InvoiceDate\"),vbshortdate)%></td>\r\n<% else \r\n  response.write \"<td>&nbsp;</td>\"\r\nend if %>\r\n<td align=\"center\">&nbsp;<a href=\"ReservationView.asp?ConfirmationNumber=<%=oRS(\"ConfirmationNumber\") %>\">View</a>&nbsp;</td>\r\n<td align=\"center\">&nbsp;&nbsp;<a href=\"ReservationEdit2.asp?ConfirmationNumber=<%=oRS(\"ConfirmationNumber\") %>\">Edit</a>&nbsp;&nbsp;</td>\r\n<td align=\"center\"><a href=\"ReservationDelete.asp?ConfirmationNumber=<%=oRS(\"ConfirmationNumber\") %>\"onClick=\"if (confirm('Are you sure you want to delete this item?')) {return (true);} else {return (false);}\">Delete</a></td>\r\n<% if isnull(oRS(\"InvoiceDate\")) then %>\r\n<td align=\"center\"><a href=\"ReservationInvoice.asp?ConfirmationNumber=<%=oRS(\"ConfirmationNumber\") %>\"onClick=\"if (confirm('Are you sure you want to invoice this item?')) {return (true);} else {return (false);}\">Invoice</a></td>\r\n<% else\r\n  response.write \"<td>&nbsp;</td>\"\r\nend if%>\r\n</tr>\r\n<% \r\nintRecs = intRecs + 1\r\nif intRecs < intPageSize then\r\n  oRS.Movenext\r\nend if\r\nLoop\r\nelse %>\r\n\r\n<tr bgcolor=\"#330066\">\r\n  <td align=\"center\" class=\"TableHdr\">No records were found that matched your search criteria.</td>\r\n</tr>\r\n\r\n<%\r\nend if\r\n\r\noRS.Close\r\nset oRS=Nothing\r\noCN.close\r\nset oCN=Nothing %>\r\n\t\t\t\r\n</table>\r\n</td>\r\n</tr>\r\n\r\n<tr> \r\n  <td colspan=\"2\" align=\"center\">&nbsp;</td>\r\n</tr>\r\n\r\n<tr>\r\n  <td>&nbsp;</td>\r\n  <td align=\"left\"><a  href=\"JAVASCRIPT:document.location='MainMenu.asp';\" onmouseover=\"ToggleBackButton('1')\" onmouseout=\"ToggleBackButton('0')\"><img  name=\"btnBack\" src=\"../images/btnBack.gif\" border=\"0\" width=\"75\"></a>\r\n  </td>\r\n</tr>\r\n\r\n<tr><td colspan=\"2\" align=\"center\">&nbsp;</td></tr>\r\n<tr><td colspan=\"2\" align=\"center\">&nbsp;</td></tr>\r\n\t\r\n</table>\r\n\r\n</form>\r\n</body>\r\n</html>","Declares":"","CodeCategory":{"CategoryId":"5","CategoryDescription":"ASP"},"Keywords":["Paging","Page Size","Next Previous"]},{"RecordId":"483","Title":"Creating a GUID Using SQL Server","Description":"Uses the T-SQL function NEWID() to retrieve a GUID from SQL Server.","Code":"If you have a SQL Server installed on your network, you can easily create a new GUID by calling the T-SQL function named NEWID().\r\n\r\nFunction CreateGUID()\r\n    Dim cn\r\n    Dim rs\r\n\r\n    Set cn = Server.CreateObject(\"ADODB.Connection\")\r\n    cn.Open \"Provider=SQLOLEDB.1;Persist Security Info=False;User ID=sa;Data\r\nSource=(local)\"\r\n    Set rs = cn.Execute(\"SELECT NEWID()\")\r\n    If Not rs.EOF Then \r\n        CreateGUID = rs(0)\r\n    End If\r\n\r\n    rs.Close\r\n    cn.Close\r\nEnd Function\r\n\r\nNote that the connection string doesn't need to point to a specific database, and that the query string passed as an argument to the Connection's Execute method doesn't have to refer to a specific table. Of course, if you already have a connection open, you can skip the statements that create and open the Connection object.\r\n","Declares":"","CodeCategory":{"CategoryId":"6","CategoryDescription":"T-SQL"},"Keywords":["GUID","Uniquie ID"]},{"RecordId":"484","Title":"Change IE ViewSource Editor","Description":"Registry entry that changes the ViewSource editor in IE from Notepad to something else.","Code":"REGEDIT4\r\n\r\n[HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Internet Explorer\\View Source Editor\\Editor Name]\r\nC:\\Utilities\\ULTRAEDIT\\Uedit32.exe\r\n","Declares":"","CodeCategory":{"CategoryId":"7","CategoryDescription":"Misc"},"Keywords":["ViewSource","IE Editor"]},{"RecordId":"486","Title":"Determine Image Height, Width, Color Depth, Type","Description":"Routine to determine height, width, color depth, and image type of an image.\r\nAlso, a routine to proportionally resize an image on an ASP by generating the HEIGHT & WIDTH attributes of the image <IMG> tag.","Code":"USAGE 1:\r\n\r\nxxx = gfxSpex(strFlnm, lngWidth, lngHeight, lngDepth, strImageType)\r\n\r\nwhere:\tstrFlnm => Filespec of file to read\r\n\tlngWidth => width of image\r\n\tlngHeight => height of image\r\n\tlngDepth => color depth (in number of colors)\r\n\tstrImageType => type of image (e.g. GIF, BMP, etc.)\r\n\r\nReturns FALSE if the file was not recognized as a valid image\r\ntype, and TRUE if it is 'probably' a valid image file.\r\n\r\n\r\nUSAGE 2:\r\n\r\n<img src=\"graphic.gif\" <%= ImageResize(strImageName, lngWidth, lngHeight) %> border=\"0\">\r\n\r\nwhere:\tstrImageName => Filespec of image file\r\n\tlngWidth => Maximum allowable width of image\r\n\tlngHeight => Maximum allowable height of image\r\n\r\nReturns WIDTH='xxx' or HEIGHT='yyy' for direct use in an IMG tag.\r\n\r\n\r\n<%\r\n\r\n  ':::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::\r\n  ':::\r\n  ':::  This routine will return the HEIGHT and WIDTH attributes\r\n  ':::  for an IMG tag to proportinally resize an image.\r\n  ':::  work with BMP, GIF, JPG and PNG files.\r\n  ':::\r\n  ':::  Pass in the file with the fully qualified path, the maximum\r\n  ':::  height and width that you want to allow.  The function\r\n  ':::  will return 'WIDTH=\"XXX\" HEIGHT=\"YYY\"' which can then be\r\n  ':::  called directly from an ASP as follows:\r\n  ':::\r\n  ':::  <img src=\"graphic.gif\" <%= ImageResize(strImageName, 100, 75) %> border=\"0\">\r\n  ':::\r\n  ':::  Passed:\r\n  ':::       strImageName     => Image path and filename\r\n  ':::       intDesiredWidth  => Max width that you want to allow\r\n  ':::       intDesiredHeight => Max height that you want to allow\r\n  ':::\r\n  ':::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::\r\n   function ImageResize(strImageName, intDesiredWidth, intDesiredHeight)\r\n\r\n      dim TargetRatio\r\n      dim CurrentRatio\r\n      dim strResize\r\n      dim w, h, c, strType\r\n\r\n      if gfxSpex(strImageName, w, h, c, strType) = true then\r\n         TargetRatio = intDesiredWidth / intDesiredHeight\r\n         CurrentRatio = w / h\r\n         if CurrentRatio > TargetRatio then                       ' We'll scale height\r\n            strResize = \"width='\" & intDesiredWidth & \"'\"\r\n         else\r\n            strResize = \"height='\" & intDesiredHeight & \"'\"     ' We'll scale width\r\n         end if\r\n      else\r\n         strResize = \"\"\r\n      end if\r\n\r\n      ImageResize = strResize\r\n\r\n   end Function\r\n\r\n\r\n  ':::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::\r\n  ':::\r\n  ':::  This function does most of the real work. It will attempt\r\n  ':::  to read any file, regardless of the extension, and will\r\n  ':::  identify if it is a graphical image.\r\n  ':::\r\n  ':::  Returns TRUE if the file is an image.  Also, returns the\r\n  ':::  width, height, color depth, and image type.\r\n  ':::\r\n  ':::  Passed:\r\n  ':::       flnm        => Filespec of file to read\r\n  ':::       width       => width of image\r\n  ':::       height      => height of image\r\n  ':::       depth       => color depth (in number of colors)\r\n  ':::       strImageType=> type of image (e.g. GIF, BMP, etc.)\r\n  ':::\r\n  ':::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::\r\n  function gfxSpex(flnm, width, height, depth, strImageType)\r\n\r\n     dim strPNG \r\n     dim strGIF\r\n     dim strBMP\r\n     dim strType\r\n     dim strBuff\r\n     dim lngSize\r\n     dim flgFound\r\n     dim strTarget\r\n\t \r\n     strType = \"\"\r\n     strImageType = \"(unknown)\"\r\n\r\n     gfxSpex = False\r\n\r\n     strPNG = chr(137) & chr(80) & chr(78)\r\n     strGIF = \"GIF\"\r\n     strBMP = chr(66) & chr(77)\r\n\r\n     strType = GetBytes(flnm, 0, 3)\r\n\r\n     if strType = strGIF then\t\t\t\t' is GIF\r\n\r\n        strImageType = \"GIF\"\r\n        Width = lngConvert(GetBytes(flnm, 7, 2))\r\n        Height = lngConvert(GetBytes(flnm, 9, 2))\r\n        Depth = 2 ^ ((asc(GetBytes(flnm, 11, 1)) and 7) + 1)\r\n        gfxSpex = True\r\n\r\n     elseif left(strType, 2) = strBMP then\t\t' is BMP\r\n\r\n        strImageType = \"BMP\"\r\n        Width = lngConvert(GetBytes(flnm, 19, 2))\r\n        Height = lngConvert(GetBytes(flnm, 23, 2))\r\n        Depth = 2 ^ (asc(GetBytes(flnm, 29, 1)))\r\n        gfxSpex = True\r\n\r\n     elseif strType = strPNG then\t\t\t' Is PNG\r\n\r\n        strImageType = \"PNG\"\r\n        Width = lngConvert2(GetBytes(flnm, 19, 2))\r\n        Height = lngConvert2(GetBytes(flnm, 23, 2))\r\n        Depth = getBytes(flnm, 25, 2)\r\n\r\n        select case asc(right(Depth,1))\r\n           case 0\r\n              Depth = 2 ^ (asc(left(Depth, 1)))\r\n              gfxSpex = True\r\n           case 2\r\n              Depth = 2 ^ (asc(left(Depth, 1)) * 3)\r\n              gfxSpex = True\r\n           case 3\r\n              Depth = 2 ^ (asc(left(Depth, 1)))  '8\r\n              gfxSpex = True\r\n           case 4\r\n              Depth = 2 ^ (asc(left(Depth, 1)) * 2)\r\n              gfxSpex = True\r\n           case 6\r\n              Depth = 2 ^ (asc(left(Depth, 1)) * 4)\r\n              gfxSpex = True\r\n           case else\r\n              Depth = -1\r\n        end select\r\n\r\n     else\r\n\r\n        strBuff = GetBytes(flnm, 0, -1)\t\t' Get all bytes from file\r\n        lngSize = len(strBuff)\r\n        flgFound = 0\r\n\r\n        strTarget = chr(255) & chr(216) & chr(255)\r\n        flgFound = instr(strBuff, strTarget)\r\n\r\n        if flgFound = 0 then\r\n           exit function\r\n        end if\r\n\r\n        strImageType = \"JPG\"\r\n        lngPos = flgFound + 2\r\n        ExitLoop = false\r\n\r\n        do while ExitLoop = False and lngPos < lngSize\r\n\r\n           do while asc(mid(strBuff, lngPos, 1)) = 255 and lngPos < lngSize\r\n              lngPos = lngPos + 1\r\n           loop\r\n\r\n           if asc(mid(strBuff, lngPos, 1)) < 192 or asc(mid(strBuff, lngPos, 1)) > 195 then\r\n              lngMarkerSize = lngConvert2(mid(strBuff, lngPos + 1, 2))\r\n              lngPos = lngPos + lngMarkerSize  + 1\r\n           else\r\n              ExitLoop = True\r\n           end if\r\n\r\n       loop\r\n       '\r\n       if ExitLoop = False then\r\n\r\n          Width = -1\r\n          Height = -1\r\n          Depth = -1\r\n\r\n       else\r\n\r\n          Height = lngConvert2(mid(strBuff, lngPos + 4, 2))\r\n          Width = lngConvert2(mid(strBuff, lngPos + 6, 2))\r\n          Depth = 2 ^ (asc(mid(strBuff, lngPos + 8, 1)) * 8)\r\n          gfxSpex = True\r\n\r\n       end if\r\n                   \r\n     end if\r\n\r\n  end function\r\n\r\n\r\n  ':::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::\r\n  ':::\r\n  ':::  This routine will attempt to identify any filespec passed\r\n  ':::  as a graphic file (regardless of the extension). This will\r\n  ':::  work with BMP, GIF, JPG and PNG files.\r\n  ':::\r\n  ':::  This function gets a specified number of bytes from any\r\n  ':::  file, starting at the offset (base 1)\r\n  ':::\r\n  ':::  Passed:\r\n  ':::       flnm        => Filespec of file to read\r\n  ':::       offset      => Offset at which to start reading\r\n  ':::       bytes       => How many bytes to read\r\n  ':::\r\n  ':::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::\r\n  function GetBytes(flnm, offset, bytes)\r\n\r\n     Dim objFSO\r\n     Dim objFTemp\r\n     Dim objTextStream\r\n     Dim lngSize\r\n     Dim fsoForReading\r\n\t\r\n     on error resume next\r\n\r\n     Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\r\n     \r\n     ' First, we get the filesize\r\n     Set objFTemp = objFSO.GetFile(flnm)\r\n     lngSize = objFTemp.Size\r\n     set objFTemp = nothing\r\n\r\n     fsoForReading = 1\r\n     Set objTextStream = objFSO.OpenTextFile(flnm, fsoForReading)\r\n\r\n     if offset > 0 then\r\n        strBuff = objTextStream.Read(offset - 1)\r\n     end if\r\n\r\n     if bytes = -1 then\t\t' Get All!\r\n        GetBytes = objTextStream.Read(lngSize)  'ReadAll\r\n     else\r\n        GetBytes = objTextStream.Read(bytes)\r\n     end if\r\n\t \r\n     objTextStream.Close\r\n     set objTextStream = nothing\r\n     set objFSO = nothing\r\n\t \r\n  end function\r\n\r\n\r\n  ':::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::\r\n  ':::\r\n  ':::  Functions to convert two bytes to a numeric value (long)\r\n  ':::  (both little-endian and big-endian)\r\n  ':::\r\n  ':::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::\r\n  function lngConvert(strTemp)\r\n     lngConvert = clng(asc(left(strTemp, 1)) + ((asc(right(strTemp, 1)) * 256)))\r\n  end function\r\n\r\n  function lngConvert2(strTemp)\r\n     lngConvert2 = clng(asc(right(strTemp, 1)) + ((asc(left(strTemp, 1)) * 256)))\r\n  end function\r\n\r\n%>","Declares":"","CodeCategory":{"CategoryId":"2","CategoryDescription":"Web"},"Keywords":["Image Resize","Proportional Image Sizing","Image Properties"]},{"RecordId":"487","Title":"EMail Validation (Restricts Repeated Form Submission)","Description":"EMail validation routine that restricts repeated form submission for 30 minutes.","Code":"'---------------------------------------------------------------------------------------------------------\r\n'  This code goes in the ASP to verify that the user did not already submit\r\n'  this page within the past 30 minutes.\r\n'---------------------------------------------------------------------------------------------------------\r\n\r\nIf Not (len(Request.Cookies(\"Fast500_2001CEOSummitForm\"))) > 0 Then\r\n  .....  Put normal processes here ...\r\n  Response.Cookies(\"Fast500_2001CEOSummitForm\") = \"Form has been submitted\"\r\n  Response.Cookies(\"Fast500_2001CEOSummitForm\").Path = \"/\"\r\n  Response.Cookies(\"Fast500_2001CEOSummitForm\").Expires = DateAdd(\"n\", 30, Now())\r\nEnd If\r\n\r\n'---------------------------------------------------------------------------------------------------------\r\n'  This is the Client-side code to validate an email text field.\r\n'\r\n'  Call with:\r\n'\r\n'  if (!checkValidEmail(theForm.txtEmail.value + '')) {\r\n'    if (strError == '') {\r\n'    alert('Please enter a valid email address');\r\n'    theForm.txtEmail.focus();\r\n'  }\r\n'    strError += 'EMail address\\n';\r\n'  }\r\n'\r\n'---------------------------------------------------------------------------------------------------------\r\n\r\nfunction checkValidEmail(strEmailAddress) {\r\n\r\n\tvar tmpBool;\r\n\tvar tmp1;\r\n\tvar tmp2;\r\n\r\n\t/* Remove extraneous white space */\r\n\tstrEmailAddress = strEmailAddress.trim();\r\n\r\n\t/* Break the input field into two parts based at the @ sign. The first part is the text to the left of the @ sign in the email address and is the username portion of an email address. The second part is the text to the right of the @ sign in the email address and is the domain where the email should be routed. */\r\n\tvar strTmp = strEmailAddress.split('@');\r\n\tvar strUser = strTmp[0] + \"\";\r\n\tvar strDomain = strTmp[1] + \"\"; \r\n\r\n\t/* Ensure the username is at least one character and that the domain name is at least 3 characters. */\r\n\ttmpBool = (strUser.length > 1) & (strDomain.length > 3);\r\n\r\n\t/* Ensure that the domain does not contain an underscore (_) and that it does contain a period (.) that is not the last character of the domain name */\r\n\ttmp1 = strDomain.indexOf('_') < 0;\r\n\ttmp2 = strDomain.indexOf('.') > 0 & (strDomain.lastIndexOf('.') + 1 < strDomain.length);\r\n\ttmpBool = tmp1 & tmp2 & tmpBool;\r\n\r\n\t/* Ensure that the entire email address does not contain percentage signs (%) nor semi-colons (;) */\r\n\ttmp1 = strEmailAddress.indexOf('%') < 0;\r\n\ttmp2 = strEmailAddress.indexOf(';') < 0;\r\n\ttmpBool = tmp1 & tmp2 & tmpBool;\r\n\r\n\t/* Ensure that the entire email address does not contain spaces ( ) nor single qoutes () */\r\n\ttmp1 = strEmailAddress.indexOf(' ') < 0;\r\n\ttmp2 = strEmailAddress.indexOf(\"'\") < 0;\r\n\ttmpBool = tmp1 & tmp2 & tmpBool;\r\n\r\n\t/* Ensure that the entire email address does not contain double quotes () nor spaces ( ) */\r\n\ttmp1 = strEmailAddress.indexOf('\"') < 0;\r\n\ttmp2 = strEmailAddress.indexOf(' ') < 0;\r\n\ttmpBool = tmp1 & tmp2 & tmpBool;\r\n\r\n\t/* Ensure that the entire email address does not contain back slashes (\\) nor forward slashes (/) */\r\n\ttmp1 = strEmailAddress.indexOf('\\\\') < 0;\r\n\ttmp2 = strEmailAddress.indexOf('/') < 0;\r\n\ttmpBool = tmp1 & tmp2 & tmpBool;\r\n\r\n\t/* Ensure that the entire email address does not contain colons (:) nor ampersands (&) */\r\n\ttmp1 = strEmailAddress.indexOf(':') < 0;\r\n\ttmp2 = strEmailAddress.indexOf('&') < 0;\r\n\ttmpBool = tmp1 & tmp2 & tmpBool;\r\n\r\n\t/* Ensure that the entire email address does not contain exclamation points (!) nor question marks (?) */\r\n\ttmp1 = strEmailAddress.indexOf('!') < 0;\r\n\ttmp2 = strEmailAddress.indexOf('?') < 0;\r\n\ttmpBool = tmp1 & tmp2 & tmpBool;\r\n\r\n\t/* Ensure that the entire email address does not contain asterisks (*) nor pound signs (#) */\r\n\ttmp1 = strEmailAddress.indexOf('*') < 0;\r\n\ttmp2 = strEmailAddress.indexOf('#') < 0;\r\n\ttmpBool = tmp1 & tmp2 & tmpBool;\r\n\r\n\treturn(tmpBool);\r\n}\r\n\r\n\r\nString.prototype.trim = function()\r\n{\r\n\t// Use a regular expression to replace leading and trailing \r\n\t// spaces with the empty string\r\n\treturn this.replace(/(^\\s*)|(\\s*$)/g, \"\");\r\n}","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["Field Validation","Validation","EMail Validation"]},{"RecordId":"488","Title":"CreateObject In JavaScript (and ADO Sample)","Description":"Demonstration of using JavaScript to perform CreateObject.  Also demonstrates how to open an ADO connection and recordset in JavaScript.","Code":"<%@language=javascript%>\r\n<%\r\nif (isPasswordOK(Request.form(\"name\"),Request.form(\"pwd\"))) {\r\n\tResponse.write(\"Authenicated!\");\r\n\t// Do stuff\r\n} else {\r\n\tResponse.write(\"Access Denied\");\r\n}\r\nfunction isPasswordOK(strName, strPwd) {\r\n\tvar fAllowLogon = false;\r\n\ttry {\r\n\t\tvar oConn = new ActiveXObject(\"ADODB.Connection\");\r\n\t\tvar strConnection=\"Provider=Microsoft.Jet.OLEDB.4.0;\r\n                                                                  Data Source=c:\\\\auth\\\\auth.mdb;\"\r\n\t\toConn.Open(strConnection);\r\n\t\tvar strSQL = \"SELECT count(*) FROM client WHERE \" +\r\n\t\t\t\t\"(name='\" + strName + \"') \" + \r\n\t\t\t\t\" and \" +\r\n\t\t\t\t\"(pwd='\" + strPwd + \"')\";\r\n\t\tvar oRS = new ActiveXObject(\"ADODB.RecordSet\");\r\n\t\toRS.Open(strSQL,oConn);\r\n\t\tfAllowLogon = (oRS(0).Value > 0) ? true : false;\r\n\t\toRS.Close();\r\n\t\tdelete oRS;\r\n\t\toConn.Close();\r\n\t\tdelete oConn;\r\n\t} catch(e) {\r\n\t\tfAllowLogon = false;\r\n\t}\r\n\r\n\treturn fAllowLogon;\r\n}\r\n%>","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["ADO","CreateObject","ActiveXObject"]},{"RecordId":"489","Title":"Connect Strings (Named Pipes & TCP/IP)","Description":"Demonstrates how to use network libraries to specify use of either Named Pipes or TCP/IP in a connect string.","Code":"SQL Server allows you to use the following network libraries when establishing a connection. \r\n\r\nThey are: \r\n dbnmpntw - Win32 Named Pipes\r\n dbmssocn - Win32 Winsock TCP/IP\r\n dbmsspxn - Win32 SPX/IPX\r\n dbmsvinn - Win32 Banyan Vines\r\n dbmsrpcn - Win32 Multi-Protocol (Windows RPC)\r\n\r\nWhen connecting to SQL Server through ADO the NETWORK parameter in the connection string can be used to specify which of these libraries to use when connecting to the database. The NETWORK parameter is the name of the Net-Library module to use, without the .dll suffix (for example, Dbmssocn, not Dbmssocn.dll). \r\n\r\nHere are some examples of connection strings that specify this parameter:\r\n\r\nThe connection string:\r\n    Provider=SQLOLEDB.1;Persist Security Info=False;User ID=sa;Initial Catalog=pubs;\r\n    Data Source=YourDataSourceName;Network Library=dbnmpntw\r\nattempts to connect to SQL Server through the SQLOLEDB provider using the Named Pipes network library.\r\n\r\n\r\nThe connection string:\r\n    Provider=MSDASQL;Persist Security Info=False;User ID=sa;\r\n    Extended Properties=DSN=yourdatasourcename;UID=sa;DATABASE=pubs;\r\n    Network=dbmssocn;Initial Catalog=pubs\r\nconnects to SQL Server through the MSDASQL provider using the TCP/IP network library.\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"3","CategoryDescription":"Database"},"Keywords":["Connect Strings","ADO","Named Pipes TCP/IP"]},{"RecordId":"491","Title":"Numeric Text Entry Only And Shift Focus To Next","Description":"Allows numeric values only and shift focus to next text box when max number of characters is entered.","Code":"<html>\r\n<head>\r\n\r\n<script LANGUAGE=\"JavaScript\">\r\n\r\n  function CheckFieldLength() {\r\n    if (document.form_name.textbox_name1.value.length == 4) {\r\n      document.form_name.textbox_name2.focus();\r\n    }\r\n  }\r\n\t\r\n  function CheckKeyPress() {\r\n    if (String.fromCharCode(event.keyCode) < '0' || String.fromCharCode(event.keyCode) > '9') {\r\n      event.returnValue=false;\r\n    }\r\n  }\r\n\r\n</script>\r\n\t\t\r\n</head>\r\n\r\n<body>\r\n  <form NAME=\"form_name\">\t\t\r\n    This field allows only numbers, with a max of 4:\r\n      <INPUT TYPE=\"text\" NAME=\"textbox_name1\" VALUE=\"\" SIZE=4 MAXLENGTH=4               onkeyup=\"CheckFieldLength();\" ONKEYPRESS=\"CheckKeyPress();\">\r\n      <INPUT TYPE=\"text\" NAME=\"textbox_name2\" VALUE=\"\" SIZE=4 MAXLENGTH=4>\r\n  </form>\r\n</body>\r\n</html>\r\n","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["Numeric Text","Focus","Keypress"]},{"RecordId":"492","Title":"Prevent Page Caching (Prefered 1)","Description":"Best way to expire a page.  Works even if user hits BACK button.","Code":"<%\r\nResponse.ExpiresAbsolute = #1/1/1980#\r\nResponse.AddHeader \"cache-control\", \"no-store, must-revalidate, private\" \r\nResponse.AddHeader \"Pragma\", \"no-cache\"\r\n%>\r\n\r\nOne other consideration. If you want the page to automatically refresh when they hit BACK, the page that is in the history also must NOT have been created as a result of a POST operation. Otherwise the user will receive an error before it reposts the information. Therefore, you should try not to use POST on the previous page for any pages you want the user to be able to move back to. \r\n\r\nWork around: \r\n\r\nPage 1 (post back to page 1 then redirect to page 2) ==> Page 2 (not cached)\r\n==> Page 3 \r\n\r\nWhen the user presses back here, it acts the same as using the GET method above. The disadvantage is that it requires two trips between page 1 and page 2.","Declares":"","CodeCategory":{"CategoryId":"2","CategoryDescription":"Web"},"Keywords":["Page Caching","Cache","Expire"]},{"RecordId":"493","Title":"Retrieve ADO Recordset As XML Stream","Description":"Converts ADO recordset to an XML stream","Code":"Function GetXMLDocument() As String\r\n\r\n   Dim rstADO As ADODB.Recordset\r\n   Dim sADO As ADODB.Stream\r\n   \r\n   'create recordset object\r\n   Set rstADO = New ADODB.Recordset\r\n   Set sADO = New ADODB.Stream\r\n\r\n   'set recordset parameters (for disconnected)\r\n   rstADO.ActiveConnection = \"DSN=Northwind\"\r\n   rstADO.Source = \"Select * FROM Orders\"\r\n   rstADO.CursorLocation = adUseServer\r\n   rstADO.CursorType = adOpenForwardOnly\r\n   rstADO.LockType = adLockReadOnly\r\n\r\n   'open recordset\r\n   rstADO.Open\r\n      \r\n   'extract results as XML text string\r\n   rstADO.Save sADO, adPersistXML\r\n   GetXMLDocument = sADO.ReadText\r\n\r\n   'cleanup\r\n   rstADO.Close\r\n   Set rstADO = Nothing\r\n\r\nEnd Function\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"8","CategoryDescription":"XML"},"Keywords":["ADO","XML"]},{"RecordId":"494","Title":"Passing UserID and Password On The URL","Description":"Demonstrates how to pass a UserID and Password on an HTTP request.","Code":"http://YourUserID:YourPassword@www.someplace.com?SomeParm=69","Declares":"","CodeCategory":{"CategoryId":"2","CategoryDescription":"Web"},"Keywords":["User","Authentication","Password"]},{"RecordId":"495","Title":"Style Sheets - Named Anchor Tag Appearance","Description":"Demonstrates how to use named anchor tag styles","Code":"// Regular anchor styles\r\n\r\nA:LINK, A:VISITED, A:ACTIVE {\r\n\ttext-decoration : none;\r\n\tcolor : #000000;\r\n}\r\n\t\t\r\nA:HOVER {\r\n\ttext-decoration : none;\r\n\tcolor : #99FFCC;\r\n}\r\n\r\n// Named anchor styles   NOTE:  Attach the class to the <A> tag, not a <DIV> tag\t\r\n\r\nA.Search:LINK, A.Search:VISITED, A.Search:ACTIVE {\r\n\tcolor : #000000;\r\n\ttext-decoration:underline;\r\n\tfont : 7pt Arial, Helvetica, sans-serif;\r\n}\r\n\t\r\nA.Search:HOVER {\r\n\tcolor : #99FFCC;\r\n\ttext-decoration:underline;\r\n\tfont : 7pt Arial, Helvetica, sans-serif;\r\n}\r\n\r\n\r\n// Named anchor styles (alternate way of doing it)   NOTE:  Attach the class to the <A> tag, not a <DIV> tag\t\r\n\r\n.Search:link, .Search:active, .Search:visited {\r\n\tcolor : orange;\r\n\tfont:10pt Arial;\r\n}\r\n\t\r\n.Search:hover {\r\n\tcolor : Green;\r\n\tfont:10pt Arial;\r\n}\r\n","Declares":"","CodeCategory":{"CategoryId":"13","CategoryDescription":"CSS"},"Keywords":["Anchor Tags","CSS","Hover"]},{"RecordId":"496","Title":"Using VBScript Class Modules In ASP","Description":"Shows how to create a class module in VBScript and use it on an ASP.","Code":"'----------------------------------------------------------------------------------------------------\r\n'  This samples consists of 2 parts.  \r\n'  Part 1 demonstrates how to use the class object\r\n'  Part 2 is the VBScript Class module\r\n'----------------------------------------------------------------------------------------------------\r\n<!-- #include file=\"C_User.inc\" -->\r\n%\r\n\r\n  '-------------------------------------\r\n  ' here run your commands to pull the data from the database and set your\r\n  ' Session variables (we're only hiding them not eliminating them!)\r\n  '-------------------------------------\r\n  Dim objUser\r\n  Set objUser = New C_User\r\n  Response.Write (\"Welcome back, \" objUser.FullName & \"! It has been \" & _\r\n     objUser.DaysSincePrevLogon & \" days since your last logon on \" & _\r\n     objUser.PrevLogonDate & \".\")\r\n%>\r\n\r\n'----------------------------------------------------------------------------------------------------\r\n\r\n<%\r\n  '----------------------------------------------------\r\n  ' C_User.inc\r\n  ' A simple VBscript class file to help organize and maintain Session \r\n  ' variables pertaining to the current system user.\r\n  '----------------------------------------------------\r\n\r\n  Class C_User\r\n\r\n     '--- Read-only Properties --------------------\r\n\r\n     Public Property Get FirstName()\r\n        FirstName = Session(\"UserFirstName\")\r\n     End Property\r\n\r\n     Public Property Get LastName()\r\n        LastName = Session(\"UserLastName\")\r\n     End Property\r\n\r\n     Public Property Get Honorific()\r\n        Honorific = Session(\"UserHonorific\")\r\n     End Property\r\n\r\n     Public Property Get FullName()\r\n        FullName = & Session(\"UserFirstName\") & \" \" & Session(\"UserLastName\")\r\n     End Property\r\n\r\n     Public Property Get NameAndTitle()\r\n        NameAndTitle = Session(\"UserHonorific\") & \" \" & _\r\n          Session(\"UserFirstName\") & \"\" & Session(\"UserLastName\")\r\n     End Property\r\n\r\n     Public Property Get Email()\r\n        Email = Session(\"UserEmail\")\r\n     End Property\r\n\r\n     Public Property Get UserID()\r\n        UserID = Session(\"UserID\")\r\n     End Property\r\n\r\n    Public Property Get UserType()\r\n        UserType = Session(\"UserType\")\r\n     End Property\r\n\r\n     Public Property Get PrevLogonDate()\r\n        PrevLogonDate = Session(\"PrevLogonDate\")\r\n     End Property\r\n\r\n     Public Property Get DaysSincePrevLogon()\r\n        DaysSincePrevLogon = DateDiff(\"d\", Session(\"PrevLogonDate\"), Date() )\r\n     End Property\r\n\r\n     '--- Read/Write Properties --------------------\r\n\r\n     Public Property Let ActivePatientID(ByVal vData)\r\n        Session(\"ActivePatientID\") = CLng( vData )\r\n     End Property\r\n\r\n     Public Property Get ActivePatientID ()\r\n        ActivePatientID = Session(\"ActivePatientID\")\r\n     End Property\r\n\r\n  End Class\r\n\r\n%>","Declares":"","CodeCategory":{"CategoryId":"5","CategoryDescription":"ASP"},"Keywords":["VBScript","Classes","Objects"]},{"RecordId":"497","Title":"Maximize Browser Window","Description":"Maximizes browser window (but does not click the Maximize button however).","Code":"<script language=\"JavaScript1.2\">\r\n<!--\r\n\r\n/*\r\nAuto Maximize Window Script- By Nick Lowe (nicklowe@ukonline.co.uk)\r\nFor full source code, 100's more free DHTML scripts, and Terms Of Use\r\nVisit http://www.dynamicdrive.com\r\n*/\r\n\r\nwindow.moveTo(0,0);\r\nif (document.all) {\r\n  top.window.resizeTo(screen.availWidth,screen.availHeight);\r\n}\r\nelse if (document.layers||document.getElementById) {\r\n  if (top.window.outerHeight<screen.availHeight||top.window.outerWidth<screen.availWidth){\r\n    top.window.outerHeight = screen.availHeight;\r\n    top.window.outerWidth = screen.availWidth;\r\n  }\r\n}\r\n//-->\r\n</script>","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["Maximize","Window.Open"]},{"RecordId":"498","Title":"How To Use DOS Command FindStr To Search Files","Description":"Syntax for searching files for strings","Code":"findstr /S /N /I /C:\"208.\" *.asp *.asa *.htm *.shtm *.inc *.js *.txt *.html *.shtml > search208.txt\r\n\r\n/S  = Include Subdirectories\r\n/N  = Display line numbers\r\n/I    = Ignore case\r\n/C:  = What to look for\r\n\r\nLooks in .asp, .htm. .shtm, .inc., .js, .txt, .html, and .shtml files\r\nWrites output to \"search208.txt\"\r\n\r\n\r\nFINDSTR [/B] [/E] [/L] [/R] [/S] [/I] [/X] [/V] [/N] [/M] [/O] [/F:file]\r\n        [/C:string] [/G:file] [strings] [[drive:][path]filename[ ...]]\r\n\r\n  /B        Matches pattern if at the beginning of a line.\r\n  /E        Matches pattern if at the end of a line.\r\n  /L        Uses search strings literally.\r\n  /R        Uses search strings as regular expressions.\r\n  /S        Searches for matching files in the current directory and all subdirectories.\r\n  /I        Specifies that the search is not to be case-sensitive.\r\n  /X        Prints lines that match exactly.\r\n  /V        Prints only lines that do not contain a match.\r\n  /N        Prints the line number before each line that matches.\r\n  /M        Prints only the filename if a file contains a match.\r\n  /O        Prints character offset before each matching line.\r\n  /P        Skip files with non-printable characters\r\n  /F:file   Reads file list from the specified file(/ stands for console).\r\n  /C:string Uses specified string as a literal search string.\r\n  /G:file   Gets search strings from the specified file(/ stands for console).\r\n  strings   Text to be searched for.\r\n  [drive:][path]filename\tSpecifies a file or files to search.\r\n\r\nUse spaces to separate multiple search strings unless the argument is prefixed\r\nwith /C.  For example, 'FINDSTR \"hello there\" x.y' searches for \"hello\" or\r\n\"there\" in file x.y.  'FINDSTR /C:\"hello there\" x.y' searches for\r\n\"hello there\" in file x.y.\r\n\r\nFor information on FINDSTR regular expressions refer to the online Command\r\nReference.","Declares":"","CodeCategory":{"CategoryId":"7","CategoryDescription":"Misc"},"Keywords":["Search","findstr","String Search"]},{"RecordId":"499","Title":"Disable Right-Click To View Source (IE Only)","Description":"Captures the context menu that allows View Source and blocks it.","Code":"<BODY oncontextmenu=\"alert('You are not authorized to see the code');return false\">\r\n","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["View Source","Capture Mouse","Disable Right-Click"]},{"RecordId":"501","Title":"Create an Export File (Uses BCP)","Description":"Run system (DOS) commands (such as BCP) from SQL Server using xp_cmdshell","Code":"<%\r\n shortfile = \"authors\" & Session.SessionID & \".xls\"\r\n file = Server.MapPath(\"/virtualpath\") & Session.SessionID & \".xls\"\r\n\r\n strSQL = \"EXEC xp_cmdshell '\" & _\r\n\t  \"bcp pubs..authors out \" & file & \" -c -Sservernameorip -Ppassword'\"\r\n\r\n strConn = \"Provider=SQLOLEDB;\r\n                   Data Source=sqlnameorip;\r\n                   User ID=userid;\r\n                   Password=password\"\r\n Set objConn = Server.CreateObject(\"ADODB.Connection\")\r\n objConn.Open strConn\r\n objConn.Execute(strSQL)\r\n objConn.Close\r\n Set objConn = Nothing\r\n\r\n Set objFS = Server.CreateObject(\"Scripting.FileSystemObject\")\r\n If objFS.FileExists(file) Then %>\r\n    <a href=\"/<%=shortfile%>\"%>It's Ready - Click HERE!\r\n <% End If\r\n Set objFS = Nothing\r\n\r\n%>\r\n","Declares":"","CodeCategory":{"CategoryId":"6","CategoryDescription":"T-SQL"},"Keywords":["xp_cmdshell","SQL Server","BCP"]},{"RecordId":"502","Title":"Send Mail When User Clicks Button","Description":"Mail someone when a user clicks a form submit button.","Code":"Many times you wanted to send mail to yourself whenever a user clicks a button. The way to do it is by assigning the proper action to the form. The ACTION attribute usually holds the URL of a CGI or LiveWire application on the server which needs to execute upon submission of the form. Instead of using CGI or LiveWire application, you can send a mail:\r\n\r\n<FORM METHOD=\"post\" ACTION=\"mailto:tomer@internet.com\" \r\n      ENCTYPE=\"text/plain\" onSubmit=\"return proceedSubmission()\">\r\n  <TEXTAREA NAME=\"inputField\" COLS=\"40\" ROWS=\"10\"></TEXTAREA><BR>\r\n  <A HREF=\"thanks.htm\" onClick=\"submitForm()\">Mail It!</A>\r\n</FORM>\r\n\r\nYou invoke the following method when the user hits the link:\r\n\r\n<SCRIPT LANGUAGE=\"JavaScript\">\r\n<!--\r\nfunction submitForm(sub) {\r\n  document.forms[sub].submit();\r\n}\r\n\r\nfunction proceedSubmission() {\r\n  return confirm(\"Click OK to mail this information\");\r\n}\r\n// -->\r\n</SCRIPT>\r\n","Declares":"","CodeCategory":{"CategoryId":"2","CategoryDescription":"Web"},"Keywords":["Mail"]},{"RecordId":"504","Title":"MIME Types (ContentTypes)","Description":"Common MIME types","Code":"Common MIME Types and File Extensions\r\n\r\nMIME Type\t\tDescription\t\tFile Extension\r\napplication/acad\t \tAutoCAD drawing files\tdwg\r\napplication/clariscad\tClarisCAD files\t \tccad\r\napplication/dxf\t\tDXF (AutoCAD)\t\tdxf\r\napplication/msaccess\tMicrosoft Access file\tmdb\r\napplication/msword\t \tMicrosoft Word file\t \tdoc\r\napplication/octet-stream \tUninterpreted binary\t \tbin\r\napplication/pdf\t\tPDF (Adobe Acrobat)\tpdf\r\napplication/postscript\tPostScript\t\tps\r\napplication/postscript\tEncapsulated PostScript\teps\r\napplication/postscript\tAdobe Illustrator\t\tai\r\napplication/rtf\t\tRich Text Format file\trtf\r\napplication/vnd.ms-excel \tMicrosoft Excel file\t \txls\r\napplication/vnd.ms-powerpoint Microsoft PowerPoint file\tppt\r\napplication/x-cdf\t \tChannel Definition Format file\tcdf\r\napplication/x-csh\t \tC-shell script\t\tcsh\r\napplication/x-dvi\t\tTeX\t\t\tdvi\r\napplication/x-javascript\tJavaScript source file\tjs\r\napplication/x-latex\t\tLaTeX source file\t\tlatex\r\napplication/x-mif\t\tFrameMaker MIF format\tmif\r\napplication/x-msexcel\tMicrosoft Excel file\t\txls\r\napplication/x-mspowerpoint\tMicrosoft PowerPoint file\tppt\r\napplication/x-tcl\t\tTCL script\t\ttcl\r\napplication/x-tex\t\tTeX source file\t\ttex\r\napplication/x-texinfo\t\tTexinfo (emacs)\t\ttexinfo, texi \r\napplication/x-troff\t\ttroff file\t\t\tt, tr, roff t, tr, roff\r\napplication/x-troff-man\ttroff with MAN macros\tman \r\napplication/x-troff-me\ttroff with ME macros\tme\r\napplication/x-troff-ms\ttroff with MS macros\tms\r\napplication/x-wais-source\tWAIS source file\t\tsrc\r\napplication/zip\t\tZIP archive\t\tzip\r\naudio/basic\t\tBasic audio (usually m-law)\tau, snd\r\naudio/x-aiff\t\tAIFF audio\t\taif, aiff, aifc\r\naudio/x-wav\t\tWindows WAVE audio\twav \r\nimage/gif\t\t\tGIF image\t\tgif\r\nimage/ief\t\t\tImage Exchange Format file\tief\r\nimage/jpeg\t\tJPEG image\t\tjpeg, jpg jpe \r\nimage/tiff\t\t\tTIFF image\t\ttiff, tif\r\nimage/x-cmu-raster\t\tCMU Raster image\t\tras\r\nimage/x-portable-anymap\tPBM Anymap image format\tpnm\r\nimage/x-portable-bitmap\tPBM Bitmap image format\tpbm\r\nimage/x-portable-graymap\tPBM Graymap image format\tpgm\r\nimage/x-portable-pixmap\tPBM Pixmap image format\tppm\r\nimage/x-rgb\t\tRGB image format\t\trgb\r\nimage/x-xbitmap\t\tX Bitmap image\t\txbm\r\nimage/x-xpixmap\t\tX Pixmap image\t\txpm\r\nimage/x-xwindowdump\tX Windows Dump (xwd) \txwd\r\nmultipart/x-gzip\t\tGNU ZIP archive\t\tgzip\r\nmultipart/x-zip\t\tPKZIP archive\t\tzip\r\ntext/css\t\t\tCascading style sheet \tcss\r\ntext/html\t\t\tHTML file\t\t\thtml, htm\r\ntext/plain\t\t\tPlain text\t\t\ttxt \r\ntext/richtext\t\tMIME Rich Text\t\trtx\r\ntext/tab-separated- values\tText with tab-separated values tsv\r\ntext/xml\t\t\tXML document\t\txml\r\ntext/x-setext\t\tStruct-Enhanced text \tetx\r\ntext/xsl\t\t\tXSL style sheet\t\txsl\r\nvideo/mpeg\t\tMPEG video\t\tmpeg, mpg, mpe \r\nvideo/quicktime\t\tQuickTime video\t\tqt, mov\r\nvideo/x-msvideo\t\tMicrosoft Windows video\tavi\r\nvideo/x-sgi-movie\t\tSGI movie player format\tmovie","Declares":"","CodeCategory":{"CategoryId":"2","CategoryDescription":"Web"},"Keywords":["MIMETypes","ContentType"]},{"RecordId":"505","Title":"isBlank JavaScript Function","Description":"JavaScript function to test to see if a variable is blank","Code":"function isBlank (s) {\r\n\tfor (var i = 0; i < s.length; i++) {\r\n\t\tvar c = s.charAt(i);\r\n\t\tif ((c != ' ') && (c != '\\n')  && (c != '\\r') && (c != '\\t')) return false;\r\n\t} \r\n\treturn true;\r\n}","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["IsBlank","Blank"]},{"RecordId":"507","Title":"Resize IFrame To The Size Of Its Contents","Description":"Resize an IFrame to the size of its contents so that scroll bars do not appear.","Code":"To determine the size of the IFrame's contents, you must access the height and width properties of the underlying IFrame document. Because you only have scripting access to pages that are hosted in the same domain, you can only access the properties to the pages that are hosted within the same domain (for example, Cross Frame Scripting). Therefore, the source document of the IFrame must be from the same domain as the page that contains the IFrame.\r\n\r\nThe following code demonstrates how to resize an IFrame in this way.  In the SRC attribute for the IFrame, you must supply an HTML page from the same domain that the IFrame loads.\r\n\r\nNOTE: This technique may not work correctly if there are absolutely positioned elements that are residing within the IFrame. \r\n\r\n<HTML>\r\n<HEAD>\r\n<SCRIPT LANGUAGE=javascript>\r\n<!--\r\nfunction reSize()\r\n{\r\n  try{\t\r\n    var oBody = ifrm.document.body;\r\n    var oFrame = document.all(\"ifrm\");\r\n    oFrame.style.height = oBody.scrollHeight + (oBody.offsetHeight - oBody.clientHeight);\r\n    oFrame.style.width = oBody.scrollWidth + (oBody.offsetWidth - oBody.clientWidth);\r\n  }\r\n  //An error is raised if the IFrame domain != its container's domain\r\n  catch(e)  {\r\n    window.status = 'Error: ' + e.number + '; ' + e.description;\r\n    }\r\n}\r\n//-->\r\n</SCRIPT>\r\n</HEAD>\r\n<BODY onload=reSize()>\r\n  <iframe onresize=reSize() id=ifrm src=YOUR_PAGE_HERE></iframe>\r\n</BODY>\r\n</HTML>","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["IFrame","Resize IFrame"]},{"RecordId":"508","Title":"Popup A New Browser Window And Set Focus To It","Description":"Opens a new browser window and sets focus.  If it is already open, it brings it to the forefront.\r\nNOTE:  Also centers the window.","Code":"NOTE:  The following must be declared at the page level, not the function level.\r\n\r\nvar popUp;\r\n\r\n\r\n\r\nThis is the function that opens the window and makes it come to the forefront.\r\n\r\nfunction showQuiz(){\r\n  if(document.layers || document.all) {\r\n    var window_left = (screen.width-300)/2;\r\n    var window_top = (screen.height-400)/2;\r\n    popUp = window.open('quiz.shtm', 'wQuiz',\r\n                                         'height=400,width=350,left=' + window_left + ',top=' + window_top + '')\r\n    popUp.focus();\r\n  }\r\n}\r\n\r\n\r\n\r\nCall it with this:\r\n\r\nHREF=\"JAVASCRIPT:showQuiz();\"","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["Window.open","Popup"]},{"RecordId":"509","Title":"Read/Write Cookies In ASP","Description":"Demonstrates how to read and write cookies in ASP","Code":"'-----------------------------------------------------------------------------\r\n' To read the value of a cookie\r\n'-----------------------------------------------------------------------------\r\n<%\r\nIf Request.Cookies(\"F50\")(\"authenticated\") <> \"1\" Then\r\n\tResponse.Redirect(\"default.asp\")\r\nEnd If\r\n%>\r\n\r\n'-----------------------------------------------------------------------------\r\n' To set the value of a cookie\r\n'-----------------------------------------------------------------------------\r\n<%\r\nResponse.Cookies(\"F50\")(\"authenticated\") = \"1\"\r\nResponse.Cookies(\"F50\")(\"user\") = strUser\r\nResponse.Cookies(\"F50\").Path = \"/\"      '<-- Note that we don't use the 2nd dimension here\r\nResponse.Redirect(\"main_menu.asp\")\r\n%>","Declares":"","CodeCategory":{"CategoryId":"5","CategoryDescription":"ASP"},"Keywords":["Cookies"]},{"RecordId":"510","Title":"IIS/MTS Nice To Know Stuff (Setup)","Description":"Stuff to do when setting up IIS for the first time.","Code":"MTS Info\r\nRemove local MTS_User account from \"users\" group.  Add a local group named (for example) MTS_Web_Group.  Set the group to allow \"Log on as batch job\" permissions in local policy manager.  Add MTS_User to that group.\r\n\r\nApplications talk to SQL Server using port 1433.\r\n\r\nIISReset\r\nDOS command that stops and restarts IIS.\r\n\r\nCOM+\r\nIIS Out-of-process component service package identity determines what account ASP pages run under.  This user must have \"Log on as batch job\" permissions in local policy manager.  NOTE:  Typically, group \"Users\" is set to \"deny logon as batch job\", which over-rides the \"Allow log on as batch job\" setting.  Therefore, uncheck the check box for group \"Users\".","Declares":"","CodeCategory":{"CategoryId":"7","CategoryDescription":"Misc"},"Keywords":["IIS","MTS","SQL Server"]},{"RecordId":"511","Title":"Show the Standard BrowseForFolder Dialog","Description":"Show the standard BrowseForFolder dialog to select a folder.","Code":"Option Explicit\r\n\r\nPrivate Declare Function SHGetPathFromIDList Lib \"shell32.dll\" Alias _\r\n    \"SHGetPathFromIDListA\" (ByVal pidl As Long, ByVal pszPath As String) As Long\r\nPrivate Declare Function SHGetSpecialFolderLocation Lib \"shell32.dll\" (ByVal _\r\n    hwndOwner As Long, ByVal nFolder As Long, pidl As ITEMIDLIST) As Long\r\nPrivate Declare Function SHBrowseForFolder Lib \"shell32.dll\" Alias _\r\n    \"SHBrowseForFolderA\" (lpBrowseInfo As BROWSEINFO) As Long\r\n\r\nPrivate Type BROWSEINFO\r\n    hOwner As Long\r\n    pidlRoot As Long\r\n    pszDisplayName As String\r\n    lpszTitle As String\r\n    ulFlags As Long\r\n    lpfn As Long\r\n    lParam As Long\r\n    iImage As Long\r\nEnd Type\r\n\r\nPrivate Type SHITEMID\r\n    cb As Long\r\n    abID As Byte\r\nEnd Type\r\n\r\nPrivate Type ITEMIDLIST\r\n    mkid As SHITEMID\r\nEnd Type\r\n\r\nPrivate Const BIF_RETURNONLYFSDIRS = &H1\r\nPrivate Const BIF_DONTGOBELOWDOMAIN = &H2\r\nPrivate Const BIF_STATUSTEXT = &H4\r\nPrivate Const BIF_RETURNFSANCESTORS = &H8\r\nPrivate Const BIF_BROWSEFORCOMPUTER = &H1000\r\nPrivate Const BIF_BROWSEFORPRINTER = &H2000\r\n\r\n\r\n' Show the standard \"BrowseForFolder\" dialog to select a folder.\r\n' hWnd is the handle of the parent form\r\n' DialogText is an optional message to show on the dialog\r\n'\r\n' Example: MsgBox \"You selected \" & BrowseFolders(Me.hwnd,\r\n'  \"Select your favourite folder\")\r\n\r\nFunction BrowseFolders(ByVal hwnd As Long, Optional ByVal DialogText As String = _\r\n    \"@@@\") As String\r\n    Dim BI As BROWSEINFO\r\n    Dim lID As Long\r\n    Dim szPath As String\r\n    \r\n    BI.hOwner = hwnd\r\n    ' if specified, set the dialog's descriptive text\r\n    If DialogText <> \"@@@\" Then BI.lpszTitle = DialogText\r\n    ' return physical folders only\r\n    BI.ulFlags = BIF_RETURNONLYFSDIRS\r\n    szPath = Space$(1024)\r\n    ' show the dialog\r\n    lID = SHBrowseForFolder(BI)\r\n    \r\n    ' get the path from the returned ID, otherwise return a null string\r\n    If SHGetPathFromIDList(ByVal lID, ByVal szPath) Then\r\n        BrowseFolders = Left$(szPath, InStr(szPath, vbNullChar) - 1)\r\n    End If\r\nEnd Function\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["BrowseForFolder","Folder Selection"]},{"RecordId":"512","Title":"Show the Dialog to Connect/Disconnect Netwrk Prntr","Description":"Show the dialog to connect/disconnect a network printer","Code":"Private Declare Function WNetConnectionDialog Lib \"mpr.dll\" (ByVal hwnd As Long, _\r\n    ByVal dwType As Long) As Long\r\n\r\nPrivate Declare Function WNetDisconnectDialog Lib \"mpr.dll\" (ByVal hwnd As Long, _\r\n    ByVal dwType As Long) As Long\r\n \r\n' Show the dialog to connect/disconnect a network printer\r\n' If the argument is True it shows the ConnectDialog,\r\n'  otherwise it shows the Disconnect dialog\r\n' the second argument is the hWnd of the parent dialog\r\n'\r\n' The function returns False if the dialog is canceled, True otherwise.\r\n\r\nFunction ShowNetworkPrinterConnectionDialog(ByVal ConnectDialog As Boolean, _\r\n    Optional ByVal hwnd As Long) As Boolean\r\n    Const RESOURCETYPE_PRINT = &H2\r\n    If ConnectDialog Then\r\n        ShowNetworkPrinterConnectionDialog = (WNetConnectionDialog(hwnd, _\r\n            RESOURCETYPE_PRINT) = 0)\r\n    Else\r\n        ShowNetworkPrinterConnectionDialog = (WNetDisconnectDialog(hwnd, _\r\n            RESOURCETYPE_PRINT) = 0)\r\n    End If\r\nEnd Function","Declares":"","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Network Printer","Printer"]},{"RecordId":"514","Title":"CSS Sample - Font Family, Font Size, Bold, & Links","Description":"The correct way of specifying a font family, a point size, and bold with mouse-over effect.","Code":".QuizLink {\r\n\tfont-family: Arial, Helvetica, sans-serif;\r\n\tfont-size: 16pt;\r\n\tfont-weight: bold;\r\n\tcolor : #FF7B00;\r\n}\r\n\r\n\t\r\nA.QuizLink:link,A.QuizLink:visited,A.QuizLink:active {\r\n\tfont-family: Arial, Helvetica, sans-serif;\r\n\tfont-size: 16pt;\r\n\tfont-weight: bold;\r\n\tcolor : #FF7B00;\r\n}\r\n\t\r\nA.QuizLink:hover {\r\n\tfont-family: Arial, Helvetica, sans-serif;\r\n\tfont-size: 16pt;\r\n\tfont-weight: bold;\r\n\tcolor : White;\r\n}\r\n","Declares":"","CodeCategory":{"CategoryId":"13","CategoryDescription":"CSS"},"Keywords":["Mouse Over","Bold","Font Family"]},{"RecordId":"516","Title":"Download A File And Save To User's Local Drive","Description":"Uses INet control to download a file and save it to the user's hard drive","Code":"Private Function DownloadFile(ByVal strURL As String, ByVal strDestinationDir As String) As Boolean\r\n\r\n    Dim strFile As String\r\n    Dim bytFile() As String\r\n    Dim intFF As Integer\r\n    Dim strFileInfo As String\r\n    Dim strFullPath() As String\r\n    \r\n    ' Split filename from url\r\n    strFullPath() = Split(strURL, \"/\")\r\n    strFile = strFullPath(UBound(strFullPath))\r\n    \r\n    With Form1.Inet1\r\n        ' Download the file\r\n        bytFile() = .OpenURL(strURL, icByteArray)\r\n        \r\n        ' Wait until done downloading\r\n        Do Until .StillExecuting = False\r\n            DoEvents\r\n        Loop\r\n        \r\n    End With\r\n    \r\n    ' Make sure file doesnt' already exist\r\n    If Len(Dir(strDestinationDir & strFile)) Then\r\n        Kill strDestinationDir & strFile\r\n    End If\r\n    \r\n    ' Save downloaded file\r\n    intFF = FreeFile\r\n    Open strDestinationDir & strFile For Binary Access Write As #intFF\r\n    Put #intFF, , bytFile()\r\n    DoEvents\r\n    Close #intFF\r\n    \r\n    ' Clear memory\r\n    Erase bytFile()\r\n    \r\nEnd Function","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["INet","Download File","FTP"]},{"RecordId":"517","Title":"Trim a String And Replace Multiple Occurances of Spaces With a Single Space","Description":"With regular expressions we can say, Find occurrences of two of more white\r\nspace characters (tabs, spaces, etc.) and replace it with a single\r\nspace.","Code":"Dim regEx\r\nSet regEx = New RegExp\r\nregEx.Global = true\r\nregEx.IgnoreCase = True\r\n\r\n'Match two or more white space characters\r\nregEx.Pattern = \"\\s{2,}\"\r\n\r\n'Replace all matches with a sigle space (and remove leading and trailing spaces)\r\nstr = Trim(regEx.Replace(str, \" \"))\r\n","Declares":"","CodeCategory":{"CategoryId":"15","CategoryDescription":"Regular Expressions"},"Keywords":["Trim","Space Cleanup"]},{"RecordId":"518","Title":"Up/Down List Box Magic","Description":"Demonstrates how to move list items up/down by clicking the up/down button","Code":"<HTML>\r\n\t\r\n<HEAD>\r\n\t\r\n<SCRIPT LANGUAGE=\"JAVASCRIPT\">\r\n    \r\n    \r\n      function moveDown(){\r\n            \r\n            var i = frm.myList.selectedIndex;\r\n            \r\n            if (i >= 0) {\r\n\t\t\t\t\r\n                if (i < frm.myList.length - 1) {\r\n                    \r\n                    var nOption = new Option();\r\n                    nOption.value = frm.myList.options[i].value;\r\n    \t    nOption.text = frm.myList.options[i].text;\r\n    \r\n                    frm.myList.options[i].text = frm.myList.options[i+1].text;\r\n                    frm.myList.options[i].value = frm.myList.options[i+1].value;\r\n                    frm.myList.options[i+1].text = nOption.text;\r\n                    frm.myList.options[i+1].value = nOption.value;\r\n                    frm.myList.selectedIndex=i+1\r\n                }\r\n            }\r\n        }\r\n    \r\n        function moveUp(){\r\n\t\t\t\r\n            var i = frm.myList.selectedIndex;\r\n\t\t\t\r\n            if (i > 0) {\r\n                \r\n                var nOption = new Option();\r\n\tnOption.value = frm.myList.options[i].value;\r\n\tnOption.text = frm.myList.options[i].text;\r\n\r\n                frm.myList.options[i].text = frm.myList.options[i-1].text;\r\n                frm.myList.options[i].value = frm.myList.options[i-1].value;\r\n                frm.myList.options[i-1].text = nOption.text;\r\n                frm.myList.options[i-1].value = nOption.value;\r\n\tfrm.myList.selectedIndex=i-1\r\n            }\r\n       }\r\n\r\n     function showValues(){\r\n\t\t\t\r\n            var i;\r\n            var s = '';\r\n            for (i = 0; i < frm.myList.length; i++) {\r\n                s += 'Text: ' + frm.myList.options[i].text + '\\tValue: ' + frm.myList.options[i].value + '\\n';\r\n            }\r\n            alert(s);\r\n       }\r\n    \r\n    </script>\r\n</HEAD>\r\n\t\t\r\n<BODY>\r\n  <FORM NAME=\"frm\">\r\n\t<select NAME=\"myList\" SIZE=\"10\" MULTIPLE>\r\n\t\t<OPTION VALUE=\"1\">Item 1</option>\r\n\t\t<OPTION VALUE=\"2\">Item 2</option>\r\n\t\t<OPTION VALUE=\"3\">Item 3</option>\r\n\t\t<OPTION VALUE=\"4\">Item 4</option>\r\n\t\t<OPTION VALUE=\"5\">Item 5</option>\r\n\t\t<OPTION VALUE=\"6\">Item 6</option>\r\n\t\t<OPTION VALUE=\"7\">Item 7</option>\r\n\t\t<OPTION VALUE=\"8\">Item 8</option>\r\n\t\t<OPTION VALUE=\"9\">Item 9</option>\r\n\t\t<OPTION VALUE=\"10\">Item 10</option>\r\n\t\t<OPTION VALUE=\"11\">Item 11</option>\r\n\t\t<OPTION VALUE=\"12\">Item 12</option>\r\n\t</select>  \r\n\t<input type=\"button\" onclick=\"moveUp()\" value=\"move up\"> \t\t\r\n\t<input type=\"button\" onclick=\"moveDown()\" value=\"move down\"> \t\t\r\n\t<input type=\"button\" onclick=\"showValues()\" value=\"show values\"> \t\t\r\n  </FORM>\r\n</BODY>\r\n</HTML>","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["Up/Down"]},{"RecordId":"519","Title":"Up/Down List Box Magic (Multi-select)","Description":"Demonstrates how to move list items up/down by clicking the up/down button (but allows multiple selection of list items)","Code":"<LANGUAGE=javascript>\r\n<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 3.2 Final//EN\">\r\n\r\n<HTML>\r\n<HEAD>\r\n<TITLE>Up/Down Select Box Demo</TITLE>\r\n\r\n<script language=javascript runat=server>\r\n// script from http://javascript.internet.com/forms/menu-swapper.htm\r\n\r\nsortitems = 0;  // Automatically sort items within lists? (1 or 0)\r\n\r\nfunction upshift(tbox) {\r\n// This function moves the highlighted lines up the current list.\r\n// The cont variable allows us to move multiple highlighted lines as a unit. However, if\r\n// the first highlighted line is the first line in the list, then we will not move any of the data.\r\n    var swap, cont = 1;\r\n\r\n    for(var i=0; i<tbox.options.length && cont; i++) {\r\n    \t\r\n        swap = i - 1;\r\n        if(tbox.options[i].selected && tbox.options[i].value != \"\") {\r\n\t        \r\n            if (swap >= 0) { \r\n                // if the previous line is before the first line in the list, then move the data \r\n                var no = new Option();\r\n\tno.value = tbox.options[i].value;\r\n\tno.text = tbox.options[i].text;\r\n\r\n\ttbox.options[i].value = tbox.options[swap].value;\r\n\ttbox.options[i].text = tbox.options[swap].text;\r\n\ttbox.options[i].selected = false;\r\n\r\n\ttbox.options[swap].value = no.value;\r\n\ttbox.options[swap].text = no.text;\r\n\ttbox.options[swap].selected = true;\r\n            } else {\r\n\t cont = 0;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nfunction downshift(tbox) {\r\n// This function moves the highlighted lines down the current list\r\n// The cont variable allows us to move multiple highlighted lines as a unit. However, if\r\n// the last highlighted line is the last line in the list, then we will not move any of the data.\r\n    var swap, cont = 1;\r\n\r\n    for(var i=(tbox.options.length-1); i>=0 && cont; i--) {\r\n\t\r\n        swap = i + 1;\r\n        if(tbox.options[i].selected && tbox.options[i].value != \"\") {\r\n            \r\n            if (swap < tbox.options.length) {\r\n \t// if the next line available is not past the last line in the list, then move the data \r\n                var no = new Option();\r\n\tno.value = tbox.options[i].value;\r\n\tno.text = tbox.options[i].text;\r\n\r\n\ttbox.options[i].value = tbox.options[swap].value;\r\n\ttbox.options[i].text = tbox.options[swap].text;\r\n\ttbox.options[i].selected = false;\r\n\r\n\ttbox.options[swap].value = no.value;\r\n\ttbox.options[swap].text = no.text;\r\n\ttbox.options[swap].selected = true;\r\n           } else {\r\n\tcont = 0;\r\n           }\r\n        }\r\n    }\r\n}\r\n\r\n</script>\r\n</HEAD>\r\n\r\n<BODY>\r\n\r\n<table width=\"780\" BORDER=0 cellpadding=0 cellspacing=0>\r\n\t<tr>\r\n  \t  <td valign=top width=600>\r\n\t      <dir>\r\n\t      <font face=arial size=2>\r\n\t      <font size=3><b>Javascript simulation of the typical VB Selection Screen with Re-order functionality</b></font><br>\r\n\t      <p>This is a prototype that allows you to reorder the items in the selection box by highlighting the lines you wish to reorder and hitting either the <b>/\\</b> or <b>\\/</b> buttons. You can reorder multiple lines as a group, even selected lines with unselected lines in between them!\r\n\t      <p>I have seen examples where items are automatically removed from one list when it is added into another list, but this was not desirable for what we needed for this prototype.\r\n\r\n\t      <p>\r\n\t      <form method=get  action=\"search.asp\" name=\"MultiOp\" onSubmit=\"\r\n\t\t//This is added to make it work on IE4.0.  It wouldn't pass the <select> object when calling the magic() function.\r\n\t\t//  This routine deselects the Available box and selects all of the Select box elements.  -KMW\r\n\t      for(var i=0; i<ct.options.length; i++) {\r\n\t        ct.options[i].selected = true;\r\n\t      }\r\n\t      for(var i=0; i<lstAvailable.options.length; i++) {\r\n\t        lstAvailable.options[i].selected = false;\r\n\t      }\">\t\r\n\t      <p>Select the sites that you want to search:<br>\r\n\t      \r\n<table cellpadding=0  CELLSPACING=0 border=0>\r\n<tr valign=top>\r\n<td width=45% valign=top>\r\n<nobr><b>Available Sites:&nbsp;</b></nobr><br>\r\n<select multiple size=15 name=\"ct\" ondblclick=\"move(this.form.lstAvailable,this.form.ct,0)\">\t\r\n  <option value=\"category\">Questions: \r\n  <option value=\"6\">What color is the sky?\r\n  <option value=\"7\">In the next 6 months, do you plan to buy a competitor?\r\n  <option value=\"8\">Have you ever sought venture capital?\t\t\r\n  <option value=\"9\">What was your last year's revenue?\r\n  <option value=\"10\">Are there any plans to merge with another company?\r\n  <option value=\"11\">Do you like rain?\r\n  <option value=\"12\">How old are you?\r\n  <option value=\"13\">What kind of car do you drive?\r\n  <option value=\"14\">Do you own a pet?\t\r\n  <option value=\"15\">Are you employed?\t\r\n  <option value=\"16\">Did you attend college?\r\n  <option value=\"17\">Where?\t\r\n  <option value=\"18\">Name?\r\n  <option value=\"19\">Years?\r\n  <option value=\"20\">Degree?\r\n</select>                         \r\n</td>\r\n<td width=10% valign=middle align=center>\r\n  <input type=\"button\" value=\" /\\ \" onclick=\"upshift(this.form.ct)\" name=\"B0\"><br>\r\n  <input type=\"button\" value=\" \\/ \" onclick=\"downshift(this.form.ct)\" name=\"B3\"><br>\r\n</td>\r\n</tr>\r\n</table>\r\n</form>\r\n</td>\r\n</tr>\r\n</table> \r\n</body>\r\n</HTML>","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["Up/Down"]},{"RecordId":"523","Title":"Date Picker #1","Description":"A popup window appears allowing the user to select a date simply by a clicking it. The user can navigate to previous and future dates, and the selected date is displayed in your form. Great! Uses a .js file so it's easy to re-use this code on your pages.","Code":"<!-- THREE STEPS TO INSTALL POPUP DATE PICKER:\r\n\r\n  1.  Copy the code into a new file, save as date-picker.js\r\n  2.  Add the script source tag to the HEAD of your HTML document\r\n  2.  Add the last code into the BODY of your HTML document  -->\r\n\r\n\r\n<!-- STEP ONE: Copy this code into a new file, save as date-picker.js  -->\r\n\r\n<!-- Original:  Kedar R. Bhave (softricks@hotmail.com) -->\r\n<!-- Web Site:  http://www.softricks.com -->\r\n\r\n<!-- This script and many more are available free online at -->\r\n<!-- The JavaScript Source!! http://javascript.internet.com -->\r\n\r\nvar weekend = [0,6];\r\nvar weekendColor = \"#e0e0e0\";\r\nvar fontface = \"Verdana\";\r\nvar fontsize = 2;\r\n\r\nvar gNow = new Date();\r\nvar ggWinCal;\r\nisNav = (navigator.appName.indexOf(\"Netscape\") != -1) ? true : false;\r\nisIE = (navigator.appName.indexOf(\"Microsoft\") != -1) ? true : false;\r\n\r\nCalendar.Months = [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\",\r\n\"July\", \"August\", \"September\", \"October\", \"November\", \"December\"];\r\n\r\n// Non-Leap year Month days..\r\nCalendar.DOMonth = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];\r\n// Leap year Month days..\r\nCalendar.lDOMonth = [31, 29, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];\r\n\r\nfunction Calendar(p_item, p_WinCal, p_month, p_year, p_format) {\r\n\tif ((p_month == null) && (p_year == null))\treturn;\r\n\r\n\tif (p_WinCal == null)\r\n\t\tthis.gWinCal = ggWinCal;\r\n\telse\r\n\t\tthis.gWinCal = p_WinCal;\r\n\t\r\n\tif (p_month == null) {\r\n\t\tthis.gMonthName = null;\r\n\t\tthis.gMonth = null;\r\n\t\tthis.gYearly = true;\r\n\t} else {\r\n\t\tthis.gMonthName = Calendar.get_month(p_month);\r\n\t\tthis.gMonth = new Number(p_month);\r\n\t\tthis.gYearly = false;\r\n\t}\r\n\r\n\tthis.gYear = p_year;\r\n\tthis.gFormat = p_format;\r\n\tthis.gBGColor = \"white\";\r\n\tthis.gFGColor = \"black\";\r\n\tthis.gTextColor = \"black\";\r\n\tthis.gHeaderColor = \"black\";\r\n\tthis.gReturnItem = p_item;\r\n}\r\n\r\nCalendar.get_month = Calendar_get_month;\r\nCalendar.get_daysofmonth = Calendar_get_daysofmonth;\r\nCalendar.calc_month_year = Calendar_calc_month_year;\r\nCalendar.print = Calendar_print;\r\n\r\nfunction Calendar_get_month(monthNo) {\r\n\treturn Calendar.Months[monthNo];\r\n}\r\n\r\nfunction Calendar_get_daysofmonth(monthNo, p_year) {\r\n\t/* \r\n\tCheck for leap year ..\r\n\t1.Years evenly divisible by four are normally leap years, except for... \r\n\t2.Years also evenly divisible by 100 are not leap years, except for... \r\n\t3.Years also evenly divisible by 400 are leap years. \r\n\t*/\r\n\tif ((p_year % 4) == 0) {\r\n\t\tif ((p_year % 100) == 0 && (p_year % 400) != 0)\r\n\t\t\treturn Calendar.DOMonth[monthNo];\r\n\t\r\n\t\treturn Calendar.lDOMonth[monthNo];\r\n\t} else\r\n\t\treturn Calendar.DOMonth[monthNo];\r\n}\r\n\r\nfunction Calendar_calc_month_year(p_Month, p_Year, incr) {\r\n\t/* \r\n\tWill return an 1-D array with 1st element being the calculated month \r\n\tand second being the calculated year \r\n\tafter applying the month increment/decrement as specified by 'incr' parameter.\r\n\t'incr' will normally have 1/-1 to navigate thru the months.\r\n\t*/\r\n\tvar ret_arr = new Array();\r\n\t\r\n\tif (incr == -1) {\r\n\t\t// B A C K W A R D\r\n\t\tif (p_Month == 0) {\r\n\t\t\tret_arr[0] = 11;\r\n\t\t\tret_arr[1] = parseInt(p_Year) - 1;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tret_arr[0] = parseInt(p_Month) - 1;\r\n\t\t\tret_arr[1] = parseInt(p_Year);\r\n\t\t}\r\n\t} else if (incr == 1) {\r\n\t\t// F O R W A R D\r\n\t\tif (p_Month == 11) {\r\n\t\t\tret_arr[0] = 0;\r\n\t\t\tret_arr[1] = parseInt(p_Year) + 1;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tret_arr[0] = parseInt(p_Month) + 1;\r\n\t\t\tret_arr[1] = parseInt(p_Year);\r\n\t\t}\r\n\t}\r\n\t\r\n\treturn ret_arr;\r\n}\r\n\r\nfunction Calendar_print() {\r\n\tggWinCal.print();\r\n}\r\n\r\nfunction Calendar_calc_month_year(p_Month, p_Year, incr) {\r\n\t/* \r\n\tWill return an 1-D array with 1st element being the calculated month \r\n\tand second being the calculated year \r\n\tafter applying the month increment/decrement as specified by 'incr' parameter.\r\n\t'incr' will normally have 1/-1 to navigate thru the months.\r\n\t*/\r\n\tvar ret_arr = new Array();\r\n\t\r\n\tif (incr == -1) {\r\n\t\t// B A C K W A R D\r\n\t\tif (p_Month == 0) {\r\n\t\t\tret_arr[0] = 11;\r\n\t\t\tret_arr[1] = parseInt(p_Year) - 1;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tret_arr[0] = parseInt(p_Month) - 1;\r\n\t\t\tret_arr[1] = parseInt(p_Year);\r\n\t\t}\r\n\t} else if (incr == 1) {\r\n\t\t// F O R W A R D\r\n\t\tif (p_Month == 11) {\r\n\t\t\tret_arr[0] = 0;\r\n\t\t\tret_arr[1] = parseInt(p_Year) + 1;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tret_arr[0] = parseInt(p_Month) + 1;\r\n\t\t\tret_arr[1] = parseInt(p_Year);\r\n\t\t}\r\n\t}\r\n\t\r\n\treturn ret_arr;\r\n}\r\n\r\n// This is for compatibility with Navigator 3, we have to create and discard one object before the prototype object exists.\r\nnew Calendar();\r\n\r\nCalendar.prototype.getMonthlyCalendarCode = function() {\r\n\tvar vCode = \"\";\r\n\tvar vHeader_Code = \"\";\r\n\tvar vData_Code = \"\";\r\n\t\r\n\t// Begin Table Drawing code here..\r\n\tvCode = vCode + \"<TABLE BORDER=1 BGCOLOR=\\\"\" + this.gBGColor + \"\\\">\";\r\n\t\r\n\tvHeader_Code = this.cal_header();\r\n\tvData_Code = this.cal_data();\r\n\tvCode = vCode + vHeader_Code + vData_Code;\r\n\t\r\n\tvCode = vCode + \"</TABLE>\";\r\n\t\r\n\treturn vCode;\r\n}\r\n\r\nCalendar.prototype.show = function() {\r\n\tvar vCode = \"\";\r\n\t\r\n\tthis.gWinCal.document.open();\r\n\r\n\t// Setup the page...\r\n\tthis.wwrite(\"<html>\");\r\n\tthis.wwrite(\"<head><title>Calendar</title>\");\r\n\tthis.wwrite(\"</head>\");\r\n\r\n\tthis.wwrite(\"<body \" + \r\n\t\t\"link=\\\"\" + this.gLinkColor + \"\\\" \" + \r\n\t\t\"vlink=\\\"\" + this.gLinkColor + \"\\\" \" +\r\n\t\t\"alink=\\\"\" + this.gLinkColor + \"\\\" \" +\r\n\t\t\"text=\\\"\" + this.gTextColor + \"\\\">\");\r\n\tthis.wwriteA(\"<FONT FACE='\" + fontface + \"' SIZE=2><B>\");\r\n\tthis.wwriteA(this.gMonthName + \" \" + this.gYear);\r\n\tthis.wwriteA(\"</B><BR>\");\r\n\r\n\t// Show navigation buttons\r\n\tvar prevMMYYYY = Calendar.calc_month_year(this.gMonth, this.gYear, -1);\r\n\tvar prevMM = prevMMYYYY[0];\r\n\tvar prevYYYY = prevMMYYYY[1];\r\n\r\n\tvar nextMMYYYY = Calendar.calc_month_year(this.gMonth, this.gYear, 1);\r\n\tvar nextMM = nextMMYYYY[0];\r\n\tvar nextYYYY = nextMMYYYY[1];\r\n\t\r\n\tthis.wwrite(\"<TABLE WIDTH='100%' BORDER=1 CELLSPACING=0 CELLPADDING=0 BGCOLOR='#e0e0e0'><TR><TD ALIGN=center>\");\r\n\tthis.wwrite(\"[<A HREF=\\\"\" +\r\n\t\t\"javascript:window.opener.Build(\" + \r\n\t\t\"'\" + this.gReturnItem + \"', '\" + this.gMonth + \"', '\" + (parseInt(this.gYear)-1) + \"', '\" + this.gFormat + \"'\" +\r\n\t\t\");\" +\r\n\t\t\"\\\"><<<\\/A>]</TD><TD ALIGN=center>\");\r\n\tthis.wwrite(\"[<A HREF=\\\"\" +\r\n\t\t\"javascript:window.opener.Build(\" + \r\n\t\t\"'\" + this.gReturnItem + \"', '\" + prevMM + \"', '\" + prevYYYY + \"', '\" + this.gFormat + \"'\" +\r\n\t\t\");\" +\r\n\t\t\"\\\"><<\\/A>]</TD><TD ALIGN=center>\");\r\n\tthis.wwrite(\"[<A HREF=\\\"javascript:window.print();\\\">Print</A>]</TD><TD ALIGN=center>\");\r\n\tthis.wwrite(\"[<A HREF=\\\"\" +\r\n\t\t\"javascript:window.opener.Build(\" + \r\n\t\t\"'\" + this.gReturnItem + \"', '\" + nextMM + \"', '\" + nextYYYY + \"', '\" + this.gFormat + \"'\" +\r\n\t\t\");\" +\r\n\t\t\"\\\">><\\/A>]</TD><TD ALIGN=center>\");\r\n\tthis.wwrite(\"[<A HREF=\\\"\" +\r\n\t\t\"javascript:window.opener.Build(\" + \r\n\t\t\"'\" + this.gReturnItem + \"', '\" + this.gMonth + \"', '\" + (parseInt(this.gYear)+1) + \"', '\" + this.gFormat + \"'\" +\r\n\t\t\");\" +\r\n\t\t\"\\\">>><\\/A>]</TD></TR></TABLE><BR>\");\r\n\r\n\t// Get the complete calendar code for the month..\r\n\tvCode = this.getMonthlyCalendarCode();\r\n\tthis.wwrite(vCode);\r\n\r\n\tthis.wwrite(\"</font></body></html>\");\r\n\tthis.gWinCal.document.close();\r\n}\r\n\r\nCalendar.prototype.showY = function() {\r\n\tvar vCode = \"\";\r\n\tvar i;\r\n\tvar vr, vc, vx, vy;\t\t// Row, Column, X-coord, Y-coord\r\n\tvar vxf = 285;\t\t\t// X-Factor\r\n\tvar vyf = 200;\t\t\t// Y-Factor\r\n\tvar vxm = 10;\t\t\t// X-margin\r\n\tvar vym;\t\t\t\t// Y-margin\r\n\tif (isIE)\tvym = 75;\r\n\telse if (isNav)\tvym = 25;\r\n\t\r\n\tthis.gWinCal.document.open();\r\n\r\n\tthis.wwrite(\"<html>\");\r\n\tthis.wwrite(\"<head><title>Calendar</title>\");\r\n\tthis.wwrite(\"<style type='text/css'>\\n<!--\");\r\n\tfor (i=0; i<12; i++) {\r\n\t\tvc = i % 3;\r\n\t\tif (i>=0 && i<= 2)\tvr = 0;\r\n\t\tif (i>=3 && i<= 5)\tvr = 1;\r\n\t\tif (i>=6 && i<= 8)\tvr = 2;\r\n\t\tif (i>=9 && i<= 11)\tvr = 3;\r\n\t\t\r\n\t\tvx = parseInt(vxf * vc) + vxm;\r\n\t\tvy = parseInt(vyf * vr) + vym;\r\n\r\n\t\tthis.wwrite(\".lclass\" + i + \" {position:absolute;top:\" + vy + \";left:\" + vx + \";}\");\r\n\t}\r\n\tthis.wwrite(\"-->\\n</style>\");\r\n\tthis.wwrite(\"</head>\");\r\n\r\n\tthis.wwrite(\"<body \" + \r\n\t\t\"link=\\\"\" + this.gLinkColor + \"\\\" \" + \r\n\t\t\"vlink=\\\"\" + this.gLinkColor + \"\\\" \" +\r\n\t\t\"alink=\\\"\" + this.gLinkColor + \"\\\" \" +\r\n\t\t\"text=\\\"\" + this.gTextColor + \"\\\">\");\r\n\tthis.wwrite(\"<FONT FACE='\" + fontface + \"' SIZE=2><B>\");\r\n\tthis.wwrite(\"Year : \" + this.gYear);\r\n\tthis.wwrite(\"</B><BR>\");\r\n\r\n\t// Show navigation buttons\r\n\tvar prevYYYY = parseInt(this.gYear) - 1;\r\n\tvar nextYYYY = parseInt(this.gYear) + 1;\r\n\t\r\n\tthis.wwrite(\"<TABLE WIDTH='100%' BORDER=1 CELLSPACING=0 CELLPADDING=0 BGCOLOR='#e0e0e0'><TR><TD ALIGN=center>\");\r\n\tthis.wwrite(\"[<A HREF=\\\"\" +\r\n\t\t\"javascript:window.opener.Build(\" + \r\n\t\t\"'\" + this.gReturnItem + \"', null, '\" + prevYYYY + \"', '\" + this.gFormat + \"'\" +\r\n\t\t\");\" +\r\n\t\t\"\\\" alt='Prev Year'><<<\\/A>]</TD><TD ALIGN=center>\");\r\n\tthis.wwrite(\"[<A HREF=\\\"javascript:window.print();\\\">Print</A>]</TD><TD ALIGN=center>\");\r\n\tthis.wwrite(\"[<A HREF=\\\"\" +\r\n\t\t\"javascript:window.opener.Build(\" + \r\n\t\t\"'\" + this.gReturnItem + \"', null, '\" + nextYYYY + \"', '\" + this.gFormat + \"'\" +\r\n\t\t\");\" +\r\n\t\t\"\\\">>><\\/A>]</TD></TR></TABLE><BR>\");\r\n\r\n\t// Get the complete calendar code for each month..\r\n\tvar j;\r\n\tfor (i=11; i>=0; i--) {\r\n\t\tif (isIE)\r\n\t\t\tthis.wwrite(\"<DIV ID=\\\"layer\" + i + \"\\\" CLASS=\\\"lclass\" + i + \"\\\">\");\r\n\t\telse if (isNav)\r\n\t\t\tthis.wwrite(\"<LAYER ID=\\\"layer\" + i + \"\\\" CLASS=\\\"lclass\" + i + \"\\\">\");\r\n\r\n\t\tthis.gMonth = i;\r\n\t\tthis.gMonthName = Calendar.get_month(this.gMonth);\r\n\t\tvCode = this.getMonthlyCalendarCode();\r\n\t\tthis.wwrite(this.gMonthName + \"/\" + this.gYear + \"<BR>\");\r\n\t\tthis.wwrite(vCode);\r\n\r\n\t\tif (isIE)\r\n\t\t\tthis.wwrite(\"</DIV>\");\r\n\t\telse if (isNav)\r\n\t\t\tthis.wwrite(\"</LAYER>\");\r\n\t}\r\n\r\n\tthis.wwrite(\"</font><BR></body></html>\");\r\n\tthis.gWinCal.document.close();\r\n}\r\n\r\nCalendar.prototype.wwrite = function(wtext) {\r\n\tthis.gWinCal.document.writeln(wtext);\r\n}\r\n\r\nCalendar.prototype.wwriteA = function(wtext) {\r\n\tthis.gWinCal.document.write(wtext);\r\n}\r\n\r\nCalendar.prototype.cal_header = function() {\r\n\tvar vCode = \"\";\r\n\t\r\n\tvCode = vCode + \"<TR>\";\r\n\tvCode = vCode + \"<TD WIDTH='14%'><FONT SIZE='2' FACE='\" + fontface + \"' COLOR='\" + this.gHeaderColor + \"'><B>Sun</B></FONT></TD>\";\r\n\tvCode = vCode + \"<TD WIDTH='14%'><FONT SIZE='2' FACE='\" + fontface + \"' COLOR='\" + this.gHeaderColor + \"'><B>Mon</B></FONT></TD>\";\r\n\tvCode = vCode + \"<TD WIDTH='14%'><FONT SIZE='2' FACE='\" + fontface + \"' COLOR='\" + this.gHeaderColor + \"'><B>Tue</B></FONT></TD>\";\r\n\tvCode = vCode + \"<TD WIDTH='14%'><FONT SIZE='2' FACE='\" + fontface + \"' COLOR='\" + this.gHeaderColor + \"'><B>Wed</B></FONT></TD>\";\r\n\tvCode = vCode + \"<TD WIDTH='14%'><FONT SIZE='2' FACE='\" + fontface + \"' COLOR='\" + this.gHeaderColor + \"'><B>Thu</B></FONT></TD>\";\r\n\tvCode = vCode + \"<TD WIDTH='14%'><FONT SIZE='2' FACE='\" + fontface + \"' COLOR='\" + this.gHeaderColor + \"'><B>Fri</B></FONT></TD>\";\r\n\tvCode = vCode + \"<TD WIDTH='16%'><FONT SIZE='2' FACE='\" + fontface + \"' COLOR='\" + this.gHeaderColor + \"'><B>Sat</B></FONT></TD>\";\r\n\tvCode = vCode + \"</TR>\";\r\n\t\r\n\treturn vCode;\r\n}\r\n\r\nCalendar.prototype.cal_data = function() {\r\n\tvar vDate = new Date();\r\n\tvDate.setDate(1);\r\n\tvDate.setMonth(this.gMonth);\r\n\tvDate.setFullYear(this.gYear);\r\n\r\n\tvar vFirstDay=vDate.getDay();\r\n\tvar vDay=1;\r\n\tvar vLastDay=Calendar.get_daysofmonth(this.gMonth, this.gYear);\r\n\tvar vOnLastDay=0;\r\n\tvar vCode = \"\";\r\n\r\n\t/*\r\n\tGet day for the 1st of the requested month/year..\r\n\tPlace as many blank cells before the 1st day of the month as necessary. \r\n\t*/\r\n\r\n\tvCode = vCode + \"<TR>\";\r\n\tfor (i=0; i<vFirstDay; i++) {\r\n\t\tvCode = vCode + \"<TD WIDTH='14%'\" + this.write_weekend_string(i) + \"><FONT SIZE='2' FACE='\" + fontface + \"'> </FONT></TD>\";\r\n\t}\r\n\r\n\t// Write rest of the 1st week\r\n\tfor (j=vFirstDay; j<7; j++) {\r\n\t\tvCode = vCode + \"<TD WIDTH='14%'\" + this.write_weekend_string(j) + \"><FONT SIZE='2' FACE='\" + fontface + \"'>\" + \r\n\t\t\t\"<A HREF='#' \" + \r\n\t\t\t\t\"onClick=\\\"self.opener.document.\" + this.gReturnItem + \".value='\" + \r\n\t\t\t\tthis.format_data(vDay) + \r\n\t\t\t\t\"';window.close();\\\">\" + \r\n\t\t\t\tthis.format_day(vDay) + \r\n\t\t\t\"</A>\" + \r\n\t\t\t\"</FONT></TD>\";\r\n\t\tvDay=vDay + 1;\r\n\t}\r\n\tvCode = vCode + \"</TR>\";\r\n\r\n\t// Write the rest of the weeks\r\n\tfor (k=2; k<7; k++) {\r\n\t\tvCode = vCode + \"<TR>\";\r\n\r\n\t\tfor (j=0; j<7; j++) {\r\n\t\t\tvCode = vCode + \"<TD WIDTH='14%'\" + this.write_weekend_string(j) + \"><FONT SIZE='2' FACE='\" + fontface + \"'>\" + \r\n\t\t\t\t\"<A HREF='#' \" + \r\n\t\t\t\t\t\"onClick=\\\"self.opener.document.\" + this.gReturnItem + \".value='\" + \r\n\t\t\t\t\tthis.format_data(vDay) + \r\n\t\t\t\t\t\"';window.close();\\\">\" + \r\n\t\t\t\tthis.format_day(vDay) + \r\n\t\t\t\t\"</A>\" + \r\n\t\t\t\t\"</FONT></TD>\";\r\n\t\t\tvDay=vDay + 1;\r\n\r\n\t\t\tif (vDay > vLastDay) {\r\n\t\t\t\tvOnLastDay = 1;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (j == 6)\r\n\t\t\tvCode = vCode + \"</TR>\";\r\n\t\tif (vOnLastDay == 1)\r\n\t\t\tbreak;\r\n\t}\r\n\t\r\n\t// Fill up the rest of last week with proper blanks, so that we get proper square blocks\r\n\tfor (m=1; m<(7-j); m++) {\r\n\t\tif (this.gYearly)\r\n\t\t\tvCode = vCode + \"<TD WIDTH='14%'\" + this.write_weekend_string(j+m) + \r\n\t\t\t\"><FONT SIZE='2' FACE='\" + fontface + \"' COLOR='gray'> </FONT></TD>\";\r\n\t\telse\r\n\t\t\tvCode = vCode + \"<TD WIDTH='14%'\" + this.write_weekend_string(j+m) + \r\n\t\t\t\"><FONT SIZE='2' FACE='\" + fontface + \"' COLOR='gray'>\" + m + \"</FONT></TD>\";\r\n\t}\r\n\t\r\n\treturn vCode;\r\n}\r\n\r\nCalendar.prototype.format_day = function(vday) {\r\n\tvar vNowDay = gNow.getDate();\r\n\tvar vNowMonth = gNow.getMonth();\r\n\tvar vNowYear = gNow.getFullYear();\r\n\r\n\tif (vday == vNowDay && this.gMonth == vNowMonth && this.gYear == vNowYear)\r\n\t\treturn (\"<FONT COLOR=\\\"RED\\\"><B>\" + vday + \"</B></FONT>\");\r\n\telse\r\n\t\treturn (vday);\r\n}\r\n\r\nCalendar.prototype.write_weekend_string = function(vday) {\r\n\tvar i;\r\n\r\n\t// Return special formatting for the weekend day.\r\n\tfor (i=0; i<weekend.length; i++) {\r\n\t\tif (vday == weekend[i])\r\n\t\t\treturn (\" BGCOLOR=\\\"\" + weekendColor + \"\\\"\");\r\n\t}\r\n\t\r\n\treturn \"\";\r\n}\r\n\r\nCalendar.prototype.format_data = function(p_day) {\r\n\tvar vData;\r\n\tvar vMonth = 1 + this.gMonth;\r\n\tvMonth = (vMonth.toString().length < 2) ? \"0\" + vMonth : vMonth;\r\n\tvar vMon = Calendar.get_month(this.gMonth).substr(0,3).toUpperCase();\r\n\tvar vFMon = Calendar.get_month(this.gMonth).toUpperCase();\r\n\tvar vY4 = new String(this.gYear);\r\n\tvar vY2 = new String(this.gYear.substr(2,2));\r\n\tvar vDD = (p_day.toString().length < 2) ? \"0\" + p_day : p_day;\r\n\r\n\tswitch (this.gFormat) {\r\n\t\tcase \"MM\\/DD\\/YYYY\" :\r\n\t\t\tvData = vMonth + \"\\/\" + vDD + \"\\/\" + vY4;\r\n\t\t\tbreak;\r\n\t\tcase \"MM\\/DD\\/YY\" :\r\n\t\t\tvData = vMonth + \"\\/\" + vDD + \"\\/\" + vY2;\r\n\t\t\tbreak;\r\n\t\tcase \"MM-DD-YYYY\" :\r\n\t\t\tvData = vMonth + \"-\" + vDD + \"-\" + vY4;\r\n\t\t\tbreak;\r\n\t\tcase \"MM-DD-YY\" :\r\n\t\t\tvData = vMonth + \"-\" + vDD + \"-\" + vY2;\r\n\t\t\tbreak;\r\n\r\n\t\tcase \"DD\\/MON\\/YYYY\" :\r\n\t\t\tvData = vDD + \"\\/\" + vMon + \"\\/\" + vY4;\r\n\t\t\tbreak;\r\n\t\tcase \"DD\\/MON\\/YY\" :\r\n\t\t\tvData = vDD + \"\\/\" + vMon + \"\\/\" + vY2;\r\n\t\t\tbreak;\r\n\t\tcase \"DD-MON-YYYY\" :\r\n\t\t\tvData = vDD + \"-\" + vMon + \"-\" + vY4;\r\n\t\t\tbreak;\r\n\t\tcase \"DD-MON-YY\" :\r\n\t\t\tvData = vDD + \"-\" + vMon + \"-\" + vY2;\r\n\t\t\tbreak;\r\n\r\n\t\tcase \"DD\\/MONTH\\/YYYY\" :\r\n\t\t\tvData = vDD + \"\\/\" + vFMon + \"\\/\" + vY4;\r\n\t\t\tbreak;\r\n\t\tcase \"DD\\/MONTH\\/YY\" :\r\n\t\t\tvData = vDD + \"\\/\" + vFMon + \"\\/\" + vY2;\r\n\t\t\tbreak;\r\n\t\tcase \"DD-MONTH-YYYY\" :\r\n\t\t\tvData = vDD + \"-\" + vFMon + \"-\" + vY4;\r\n\t\t\tbreak;\r\n\t\tcase \"DD-MONTH-YY\" :\r\n\t\t\tvData = vDD + \"-\" + vFMon + \"-\" + vY2;\r\n\t\t\tbreak;\r\n\r\n\t\tcase \"DD\\/MM\\/YYYY\" :\r\n\t\t\tvData = vDD + \"\\/\" + vMonth + \"\\/\" + vY4;\r\n\t\t\tbreak;\r\n\t\tcase \"DD\\/MM\\/YY\" :\r\n\t\t\tvData = vDD + \"\\/\" + vMonth + \"\\/\" + vY2;\r\n\t\t\tbreak;\r\n\t\tcase \"DD-MM-YYYY\" :\r\n\t\t\tvData = vDD + \"-\" + vMonth + \"-\" + vY4;\r\n\t\t\tbreak;\r\n\t\tcase \"DD-MM-YY\" :\r\n\t\t\tvData = vDD + \"-\" + vMonth + \"-\" + vY2;\r\n\t\t\tbreak;\r\n\r\n\t\tdefault :\r\n\t\t\tvData = vMonth + \"\\/\" + vDD + \"\\/\" + vY4;\r\n\t}\r\n\r\n\treturn vData;\r\n}\r\n\r\nfunction Build(p_item, p_month, p_year, p_format) {\r\n\tvar p_WinCal = ggWinCal;\r\n\tgCal = new Calendar(p_item, p_WinCal, p_month, p_year, p_format);\r\n\r\n\t// Customize your Calendar here..\r\n\tgCal.gBGColor=\"white\";\r\n\tgCal.gLinkColor=\"black\";\r\n\tgCal.gTextColor=\"black\";\r\n\tgCal.gHeaderColor=\"darkgreen\";\r\n\r\n\t// Choose appropriate show function\r\n\tif (gCal.gYearly)\tgCal.showY();\r\n\telse\tgCal.show();\r\n}\r\n\r\nfunction show_calendar() {\r\n\t/* \r\n\t\tp_month : 0-11 for Jan-Dec; 12 for All Months.\r\n\t\tp_year\t: 4-digit year\r\n\t\tp_format: Date format (mm/dd/yyyy, dd/mm/yy, ...)\r\n\t\tp_item\t: Return Item.\r\n\t*/\r\n\r\n\tp_item = arguments[0];\r\n\tif (arguments[1] == null)\r\n\t\tp_month = new String(gNow.getMonth());\r\n\telse\r\n\t\tp_month = arguments[1];\r\n\tif (arguments[2] == \"\" || arguments[2] == null)\r\n\t\tp_year = new String(gNow.getFullYear().toString());\r\n\telse\r\n\t\tp_year = arguments[2];\r\n\tif (arguments[3] == null)\r\n\t\tp_format = \"MM/DD/YYYY\";\r\n\telse\r\n\t\tp_format = arguments[3];\r\n\r\n\tvWinCal = window.open(\"\", \"Calendar\", \"width=250,height=250,status=no,resizable=no,top=200,left=200\");\r\n\tvWinCal.opener = self;\r\n\tggWinCal = vWinCal;\r\n\r\n\tBuild(p_item, p_month, p_year, p_format);\r\n}\r\n/*\r\nYearly Calendar Code Starts here\r\n*/\r\nfunction show_yearly_calendar(p_item, p_year, p_format) {\r\n\t// Load the defaults..\r\n\tif (p_year == null || p_year == \"\")\r\n\t\tp_year = new String(gNow.getFullYear().toString());\r\n\tif (p_format == null || p_format == \"\")\r\n\t\tp_format = \"MM/DD/YYYY\";\r\n\r\n\tvar vWinCal = window.open(\"\", \"Calendar\", \"scrollbars=yes\");\r\n\tvWinCal.opener = self;\r\n\tggWinCal = vWinCal;\r\n\r\n\tBuild(p_item, null, p_year, p_format);\r\n}\r\n\r\n\r\n<!-- STEP TWO: Paste this code into the HEAD of your HTML document  -->\r\n\r\n<HEAD>\r\n\r\n<script language=\"JavaScript\" src=\"date-picker.js\"></script>\r\n\r\n</HEAD>\r\n\r\n<!-- STEP THREE: Copy this code into the BODY of your HTML document  -->\r\n\r\n<BODY>\r\n\r\n<center>\r\n<form name=calform>\r\n<input type=text name=\"datebox\" size=15><a href=\"javascript:show_calendar('calform.datebox');\" onmouseover=\"window.status='Date Picker';return true;\" onmouseout=\"window.status='';return true;\"><img src=\"show-calendar.gif\" width=24 height=22 border=0></a>\r\n</form>\r\n</center>","Declares":"","CodeCategory":{"CategoryId":"2","CategoryDescription":"Web"},"Keywords":["Date Picker","PopUp Calendar"]},{"RecordId":"524","Title":"Date Picker #2","Description":"Very similar to Date Picker #1","Code":"<!-- TWO STEPS TO INSTALL DYNAMIC CALENDAR:\r\n\r\n  1.  Copy the coding into the HEAD of your HTML document\r\n  2.  Add the last code into the BODY of your HTML document  -->\r\n\r\n<!-- STEP ONE: Paste this code into the HEAD of your HTML document  -->\r\n\r\n<HEAD>\r\n\r\n<SCRIPT LANGUAGE=\"JavaScript\">\r\n<!-- Original:  Nick Korosi (nfk2000@hotmail.com) -->\r\n\r\n<!-- This script and many more are available free online at -->\r\n<!-- The JavaScript Source!! http://javascript.internet.com -->\r\n\r\n<!-- Begin\r\nvar dDate = new Date();\r\nvar dCurMonth = dDate.getMonth();\r\nvar dCurDayOfMonth = dDate.getDate();\r\nvar dCurYear = dDate.getFullYear();\r\nvar objPrevElement = new Object();\r\n\r\nfunction fToggleColor(myElement) {\r\n\tvar toggleColor = \"#ff0000\";\r\n\tif (myElement.id == \"calDateText\") {\r\n\t\tif (myElement.color == toggleColor) {\r\n\t\t\tmyElement.color = \"\";\r\n\t\t} else {\r\n\t\t\tmyElement.color = toggleColor;\r\n\t\t}\r\n\t} else if (myElement.id == \"calCell\") {\r\n\t\tfor (var i in myElement.children) {\r\n\t\t\tif (myElement.children[i].id == \"calDateText\") {\r\n\t\t\t\tif (myElement.children[i].color == toggleColor) {\r\n\t\t\t\t\tmyElement.children[i].color = \"\";\r\n\t\t\t\t} else {\r\n\t\t\t\t\tmyElement.children[i].color = toggleColor;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\n\r\n\r\nfunction fSetSelectedDay(myElement){\r\n\tif (myElement.id == \"calCell\") {\r\n\t\tif (!isNaN(parseInt(myElement.children[\"calDateText\"].innerText))) {\r\n\t\t\tmyElement.bgColor = \"#c0c0c0\";\r\n\t\t\tobjPrevElement.bgColor = \"\";\r\n\t\t\tdocument.all.calSelectedDate.value = parseInt(myElement.children[\"calDateText\"].innerText);\r\n\t\t\tobjPrevElement = myElement;\r\n\t\t}\r\n\t}\r\n}\r\n\r\n\r\nfunction fGetDaysInMonth(iMonth, iYear) {\r\n\tvar dPrevDate = new Date(iYear, iMonth, 0);\r\n\treturn dPrevDate.getDate();\r\n}\r\n\r\n\r\nfunction fBuildCal(iYear, iMonth, iDayStyle) {\r\n\tvar aMonth = new Array();\r\n\taMonth[0] = new Array(7);\r\n\taMonth[1] = new Array(7);\r\n\taMonth[2] = new Array(7);\r\n\taMonth[3] = new Array(7);\r\n\taMonth[4] = new Array(7);\r\n\taMonth[5] = new Array(7);\r\n\taMonth[6] = new Array(7);\r\n\tvar dCalDate = new Date(iYear, iMonth-1, 1);\r\n\tvar iDayOfFirst = dCalDate.getDay();\r\n\tvar iDaysInMonth = fGetDaysInMonth(iMonth, iYear);\r\n\tvar iVarDate = 1;\r\n\tvar i, d, w;\r\n\tif (iDayStyle == 2) {\r\n\t\taMonth[0][0] = \"Sunday\";\r\n\t\taMonth[0][1] = \"Monday\";\r\n\t\taMonth[0][2] = \"Tuesday\";\r\n\t\taMonth[0][3] = \"Wednesday\";\r\n\t\taMonth[0][4] = \"Thursday\";\r\n\t\taMonth[0][5] = \"Friday\";\r\n\t\taMonth[0][6] = \"Saturday\";\r\n\t} else if (iDayStyle == 1) {\r\n\t\taMonth[0][0] = \"Sun\";\r\n\t\taMonth[0][1] = \"Mon\";\r\n\t\taMonth[0][2] = \"Tue\";\r\n\t\taMonth[0][3] = \"Wed\";\r\n\t\taMonth[0][4] = \"Thu\";\r\n\t\taMonth[0][5] = \"Fri\";\r\n\t\taMonth[0][6] = \"Sat\";\r\n\t} else {\r\n\t\taMonth[0][0] = \"Su\";\r\n\t\taMonth[0][1] = \"Mo\";\r\n\t\taMonth[0][2] = \"Tu\";\r\n\t\taMonth[0][3] = \"We\";\r\n\t\taMonth[0][4] = \"Th\";\r\n\t\taMonth[0][5] = \"Fr\";\r\n\t\taMonth[0][6] = \"Sa\";\r\n\t}\r\n\tfor (d = iDayOfFirst; d < 7; d++) {\r\n\t\taMonth[1][d] = iVarDate;\r\n\t\tiVarDate++;\r\n\t}\r\n\tfor (w = 2; w < 7; w++) {\r\n\t\tfor (d = 0; d < 7; d++) {\r\n\t\t\tif (iVarDate <= iDaysInMonth) {\r\n\t\t\t\taMonth[w][d] = iVarDate;\r\n\t\t\t\tiVarDate++;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn aMonth;\r\n}\r\n\r\n\r\nfunction fDrawCal(iYear, iMonth, iCellWidth, iCellHeight, sDateTextSize, sDateTextWeight, iDayStyle) {\r\n\tvar myMonth;\r\n\tmyMonth = fBuildCal(iYear, iMonth, iDayStyle);\r\n\tdocument.write(\"<table border='1'>\")\r\n\tdocument.write(\"<tr>\");\r\n\tdocument.write(\"<td align='center' style='FONT-FAMILY:Arial;FONT-SIZE:12px;FONT-WEIGHT: bold'>\" + myMonth[0][0] + \"</td>\");\r\n\tdocument.write(\"<td align='center' style='FONT-FAMILY:Arial;FONT-SIZE:12px;FONT-WEIGHT: bold'>\" + myMonth[0][1] + \"</td>\");\r\n\tdocument.write(\"<td align='center' style='FONT-FAMILY:Arial;FONT-SIZE:12px;FONT-WEIGHT: bold'>\" + myMonth[0][2] + \"</td>\");\r\n\tdocument.write(\"<td align='center' style='FONT-FAMILY:Arial;FONT-SIZE:12px;FONT-WEIGHT: bold'>\" + myMonth[0][3] + \"</td>\");\r\n\tdocument.write(\"<td align='center' style='FONT-FAMILY:Arial;FONT-SIZE:12px;FONT-WEIGHT: bold'>\" + myMonth[0][4] + \"</td>\");\r\n\tdocument.write(\"<td align='center' style='FONT-FAMILY:Arial;FONT-SIZE:12px;FONT-WEIGHT: bold'>\" + myMonth[0][5] + \"</td>\");\r\n\tdocument.write(\"<td align='center' style='FONT-FAMILY:Arial;FONT-SIZE:12px;FONT-WEIGHT: bold'>\" + myMonth[0][6] + \"</td>\");\r\n\tdocument.write(\"</tr>\");\r\n\tfor (w = 1; w < 7; w++) {\r\n\t\tdocument.write(\"<tr>\")\r\n\t\tfor (d = 0; d < 7; d++) {\r\n\t\t\tdocument.write(\"<td align='left' valign='top' width='\" + iCellWidth + \"' height='\" + iCellHeight + \"' id=calCell style='CURSOR:Hand' onMouseOver='fToggleColor(this)' onMouseOut='fToggleColor(this)' onclick=fSetSelectedDay(this)>\");\r\n\t\t\tif (!isNaN(myMonth[w][d])) {\r\n\t\t\t\tdocument.write(\"<font id=calDateText onMouseOver='fToggleColor(this)' style='CURSOR:Hand;FONT-FAMILY:Arial;FONT-SIZE:\" + sDateTextSize + \";FONT-WEIGHT:\" + sDateTextWeight + \"' onMouseOut='fToggleColor(this)' onclick=fSetSelectedDay(this)>\" + myMonth[w][d] + \"</font>\");\r\n\t\t\t} else {\r\n\t\t\t\tdocument.write(\"<font id=calDateText onMouseOver='fToggleColor(this)' style='CURSOR:Hand;FONT-FAMILY:Arial;FONT-SIZE:\" + sDateTextSize + \";FONT-WEIGHT:\" + sDateTextWeight + \"' onMouseOut='fToggleColor(this)' onclick=fSetSelectedDay(this)> </font>\");\r\n\t\t\t}\r\n\t\t\tdocument.write(\"</td>\")\r\n\t\t}\r\n\t\tdocument.write(\"</tr>\");\r\n\t}\r\n\tdocument.write(\"</table>\")\r\n}\r\n\r\n\r\nfunction fUpdateCal(iYear, iMonth) {\r\n\tmyMonth = fBuildCal(iYear, iMonth);\r\n\tobjPrevElement.bgColor = \"\";\r\n\tdocument.all.calSelectedDate.value = \"\";\r\n\tfor (w = 1; w < 7; w++) {\r\n\t\tfor (d = 0; d < 7; d++) {\r\n\t\t\tif (!isNaN(myMonth[w][d])) {\r\n\t\t\t\tcalDateText[((7*w)+d)-7].innerText = myMonth[w][d];\r\n\t\t\t} else {\r\n\t\t\t\tcalDateText[((7*w)+d)-7].innerText = \" \";\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n// End -->\r\n</script>\r\n</head>\r\n</HEAD>\r\n\r\n\r\n\r\n\r\n<!-- STEP TWO: Copy this code into the BODY of your HTML document  -->\r\n\r\n<BODY>\r\n\r\n<script language=\"JavaScript\" for=window event=onload>\r\n<!-- Begin\r\n\tvar dCurDate = new Date();\r\n\tfrmCalendarSample.tbSelMonth.options[dCurDate.getMonth()].selected = true;\r\n\tfor (i = 0; i < frmCalendarSample.tbSelYear.length; i++)\r\n\t\tif (frmCalendarSample.tbSelYear.options[i].value == dCurDate.getFullYear())\r\n\t\t\tfrmCalendarSample.tbSelYear.options[i].selected = true;\r\n//  End -->\r\n</script>\r\n\r\n<form name=\"frmCalendarSample\" method=\"post\" action=\"\">\r\n<input type=\"hidden\" name=\"calSelectedDate\" value=\"\">\r\n\r\n<table border=\"1\">\r\n\t<tr>\r\n\t\t<td>\r\n\t\t\t<select name=\"tbSelMonth\" onchange='fUpdateCal(frmCalendarSample.tbSelYear.value, frmCalendarSample.tbSelMonth.value)'>\r\n\t\t\t\t<option value=\"1\">January</option>\r\n\t\t\t\t<option value=\"2\">February</option>\r\n\t\t\t\t<option value=\"3\">March</option>\r\n\t\t\t\t<option value=\"4\">April</option>\r\n\t\t\t\t<option value=\"5\">May</option>\r\n\t\t\t\t<option value=\"6\">June</option>\r\n\t\t\t\t<option value=\"7\">July</option>\r\n\t\t\t\t<option value=\"8\">August</option>\r\n\t\t\t\t<option value=\"9\">September</option>\r\n\t\t\t\t<option value=\"10\">October</option>\r\n\t\t\t\t<option value=\"11\">November</option>\r\n\t\t\t\t<option value=\"12\">December</option>\r\n\t\t\t</select>\r\n\t\t\t  \r\n\t\t\t<select name=\"tbSelYear\" onchange='fUpdateCal(frmCalendarSample.tbSelYear.value, frmCalendarSample.tbSelMonth.value)'>\r\n\t\t\t\t<option value=\"1998\">1998</option>\r\n\t\t\t\t<option value=\"1999\">1999</option>\r\n\t\t\t\t<option value=\"2000\">2000</option>\r\n\t\t\t\t<option value=\"2001\">2001</option>\r\n\t\t\t\t<option value=\"2002\">2002</option>\r\n\t\t\t\t<option value=\"2003\">2003</option>\r\n\t\t\t\t<option value=\"2004\">2004</option>\r\n\t\t\t</select>\r\n\t\t</td>\r\n\t</tr>\r\n\t<tr>\r\n\t\t<td>\r\n\t\t\t<script language=\"JavaScript\">\r\n\t\t\t\tvar dCurDate = new Date();\r\n\t\t\t\tfDrawCal(dCurDate.getFullYear(), dCurDate.getMonth()+1, 30, 30, \"12px\", \"bold\", 1);\r\n\t\t\t</script>\r\n\t\t</td>\r\n\t</tr>\r\n</table>\r\n</form>","Declares":"","CodeCategory":{"CategoryId":"2","CategoryDescription":"Web"},"Keywords":["Date Picker","PopUp Calendar"]},{"RecordId":"525","Title":"Up/Down List Box Magic (Uses DIVs)","Description":"Demonstrates how to move list items up/down by clicking the up/down button (but has horizontal scroll bars)","Code":"<html>\r\n<head>\r\n<title>Untitled Document</title>\r\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=iso-8859-1\">\r\n\r\n<SCRIPT LANGUAGE=\"JavaScript\">\r\n\r\n\tvar oChosen;\r\n\r\n\tfunction selectRow(){\r\n\r\n\t\tif (oChosen != null) {\r\n\t\t\toChosen.style.backgroundColor = 'white';\r\n\t\t\toChosen.style.color = 'black';\r\n\t\t} \r\n\t\t\r\n\t\tvar oTemp = window.event.srcElement;\r\n\t\tif (oTemp.tagName == 'TD') {\r\n\t\t\toChosen = oTemp;\r\n\t\t\toChosen.style.backgroundColor = 'darkblue';\r\n\t\t\toChosen.style.color = 'white';\r\n\t\t}\r\n\r\n\t\talert(oChosen.keyField + '\\n' + oChosen.someValue);\r\n\t}\r\n\r\n\r\n\tfunction moveUp(){\r\n\r\n\t\tif (oChosen == null) {return;} \r\n\t\t\r\n\t\tvar nRow = oChosen.parentElement.rowIndex;\r\n\t\tif (nRow == 0) {return;}\r\n\r\n\t\tvar oPrev =  tbl.rows[nRow - 1].cells[0];\r\n\r\n\t\tvar sTemp = oChosen.innerText;\r\n        var skeyField = oChosen.keyField;\r\n        var ssomeValue = oChosen.someValue;\r\n\r\n        oChosen.innerText = oPrev.innerText;\r\n\t\toChosen.keyField = oPrev.keyField;\r\n\t\toChosen.someValue = oPrev.someValue;\r\n        \r\n        oPrev.innerText = sTemp;\r\n\t\toPrev.keyField = skeyField;\r\n\t\toPrev.someValue = ssomeValue;\r\n\r\n\t\toChosen.style.backgroundColor = 'white';\r\n\t\toChosen.style.color = 'black';\r\n\r\n\t\toPrev.style.backgroundColor = 'darkblue';\r\n\t\toPrev.style.color = 'white';\r\n\r\n\t\toChosen = oPrev;\r\n\t}\r\n\r\n\r\n\tfunction moveDown(){\r\n\t\t\r\n\t\tif (oChosen == null) {return;} \r\n\t\t\r\n\t\tvar nRow = oChosen.parentElement.rowIndex;\r\n\t\tif (nRow == tbl.rows.length - 1) {return;}\r\n\r\n\t\tvar oNext =  tbl.rows[nRow + 1].cells[0];\r\n\r\n        var sTemp = oChosen.innerText;\r\n        var skeyField = oChosen.keyField;\r\n        var ssomeValue = oChosen.someValue;\r\n        \r\n        oChosen.innerText = oNext.innerText;\r\n\t\toChosen.keyField = oNext.keyField;\r\n\t\toChosen.someValue = oNext.someValue;\r\n        \r\n        oNext.innerText = sTemp;\r\n\t\toNext.keyField = skeyField;\r\n\t\toNext.someValue = ssomeValue;\r\n\r\n        oChosen.style.backgroundColor = 'white';\r\n\t\toChosen.style.color = 'black';\r\n\r\n\t\toNext.style.backgroundColor = 'darkblue';\r\n\t\toNext.style.color = 'white';\r\n\r\n\t\toChosen = oNext;\r\n\t}\r\n\r\n</script>\r\n\r\n\r\n</head>\r\n\r\n<body bgcolor=\"#FFFFFF\" text=\"#000000\">\r\n\r\n\r\n<!-- <div id=\"Layer2\" style=\"position:absolute; left:46px; top:100px; width:200; height:100; z-index:1; overflow: auto; background-color: Ffffff; border: thin solid Black;\"> -->\r\n<div id=\"Layer2\" style=\"width:200; height:100; overflow: auto; background-color: Ffffff; border: thin solid;\"> \r\n\t<table ID=\"tbl\"  WIDTH=\"300\" CELLPADDING=\"0\" CELLSPACING=\"0\" BORDER=\"0\" ONCLICK=\"selectRow();\">\r\n\t\t<tr><td keyField=\"1\" someValue=\"1a\">1 This is a test to see what will happen 1</td></tr>\r\n\t\t<tr><td keyField=\"2\" someValue=\"2a\">2 This is a test to see what will happen 2</td></tr>\r\n\t\t<tr><td keyField=\"3\" someValue=\"3a\">3 This is a test to see what will happen 3</td></tr>\r\n\t\t<tr><td keyField=\"4\" someValue=\"4a\">4 This is a test to see what will happen 4</td></tr>\r\n\t\t<tr><td keyField=\"5\" someValue=\"5a\">5 This is a test to see what will happen 5</td></tr>\r\n\t</table>\r\n\r\n</div>\r\n\r\n<input type=\"Button\" ONCLICK=\"moveUp();\" VALUE=\"Up\">\r\n<input type=\"Button\" ONCLICK=\"moveDown();\" VALUE=\"Down\">\r\n\r\n</body>\r\n</html>","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["Up/Down","Select Table Row","Table Row Select"]},{"RecordId":"528","Title":"Up/Down Select Box Demo","Description":"Up/Down Select Box Demo","Code":"<LANGUAGE=javascript>\r\n<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 3.2 Final//EN\">\r\n\r\n<HTML>\r\n<HEAD>\r\n<TITLE>Up/Down Select Box Demo</TITLE>\r\n\r\n<script language=javascript runat=server>\r\n// script from http://javascript.internet.com/forms/menu-swapper.htm\r\n\r\nsortitems = 0;  // Automatically sort items within lists? (1 or 0)\r\n\r\nfunction upshift(tbox) {\r\n// This function moves the highlighted lines up the current list.\r\n// The cont variable allows us to move multiple highlighted lines as a unit. However, if\r\n// the first highlighted line is the first line in the list, then we will not move any of the data.\r\n    var swap, cont = 1;\r\n\r\n    for(var i=0; i<tbox.options.length && cont; i++) {\r\n    \t\r\n        swap = i - 1;\r\n        if(tbox.options[i].selected && tbox.options[i].value != \"\") {\r\n\t        \r\n            if (swap >= 0) { \r\n                // if the previous line is before the first line in the list, then move the data \r\n                var no = new Option();\r\n\tno.value = tbox.options[i].value;\r\n\tno.text = tbox.options[i].text;\r\n\r\n\ttbox.options[i].value = tbox.options[swap].value;\r\n\ttbox.options[i].text = tbox.options[swap].text;\r\n\ttbox.options[i].selected = false;\r\n\r\n\ttbox.options[swap].value = no.value;\r\n\ttbox.options[swap].text = no.text;\r\n\ttbox.options[swap].selected = true;\r\n            } else {\r\n\t cont = 0;\r\n            }\r\n        }\r\n    }\r\n}\r\n<LANGUAGE=javascript>\r\n<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 3.2 Final//EN\">\r\n\r\n<HTML>\r\n<HEAD>\r\n<TITLE>Up/Down Select Box Demo</TITLE>\r\n\r\n<script language=javascript runat=server>\r\n// script from http://javascript.internet.com/forms/menu-swapper.htm\r\n\r\nsortitems = 0;  // Automatically sort items within lists? (1 or 0)\r\n\r\nfunction upshift(tbox) {\r\n// This function moves the highlighted lines up the current list.\r\n// The cont variable allows us to move multiple highlighted lines as a unit. However, if\r\n// the first highlighted line is the first line in the list, then we will not move any of the data.\r\n    var swap, cont = 1;\r\n\r\n    for(var i=0; i<tbox.options.length && cont; i++) {\r\n    \t\r\n        swap = i - 1;\r\n        if(tbox.options[i].selected && tbox.options[i].value != \"\") {\r\n\t        \r\n            if (swap >= 0) { \r\n                // if the previous line is before the first line in the list, then move the data \r\n                var no = new Option();\r\n\tno.value = tbox.options[i].value;\r\n\tno.text = tbox.options[i].text;\r\n\r\n\ttbox.options[i].value = tbox.options[swap].value;\r\n\ttbox.options[i].text = tbox.options[swap].text;\r\n\ttbox.options[i].selected = false;\r\n\r\n\ttbox.options[swap].value = no.value;\r\n\ttbox.options[swap].text = no.text;\r\n\ttbox.options[swap].selected = true;\r\n            } else {\r\n\t cont = 0;\r\n            }\r\n        }\r\n    }\r\n}\r\n<LANGUAGE=javascript>\r\n<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 3.2 Final//EN\">\r\n\r\n<HTML>\r\n<HEAD>\r\n<TITLE>Up/Down Select Box Demo</TITLE>\r\n\r\n<script language=javascript runat=server>\r\n// script from http://javascript.internet.com/forms/menu-swapper.htm\r\n\r\nsortitems = 0;  // Automatically sort items within lists? (1 or 0)\r\n\r\nfunction upshift(tbox) {\r\n// This function moves the highlighted lines up the current list.\r\n// The cont variable allows us to move multiple highlighted lines as a unit. However, if\r\n// the first highlighted line is the first line in the list, then we will not move any of the data.\r\n    var swap, cont = 1;\r\n\r\n    for(var i=0; i<tbox.options.length && cont; i++) {\r\n    \t\r\n        swap = i - 1;\r\n        if(tbox.options[i].selected && tbox.options[i].value != \"\") {\r\n\t        \r\n            if (swap >= 0) { \r\n                // if the previous line is before the first line in the list, then move the data \r\n                var no = new Option();\r\n\tno.value = tbox.options[i].value;\r\n\tno.text = tbox.options[i].text;\r\n\r\n\ttbox.options[i].value = tbox.options[swap].value;\r\n\ttbox.options[i].text = tbox.options[swap].text;\r\n\ttbox.options[i].selected = false;\r\n\r\n\ttbox.options[swap].value = no.value;\r\n\ttbox.options[swap].text = no.text;\r\n\ttbox.options[swap].selected = true;\r\n            } else {\r\n\t cont = 0;\r\n            }\r\n        }\r\n    }\r\n}\r\n<LANGUAGE=javascript>\r\n<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 3.2 Final//EN\">\r\n\r\n<HTML>\r\n<HEAD>\r\n<TITLE>Up/Down Select Box Demo</TITLE>\r\n\r\n<script language=javascript runat=server>\r\n// script from http://javascript.internet.com/forms/menu-swapper.htm\r\n\r\nsortitems = 0;  // Automatically sort items within lists? (1 or 0)\r\n\r\nfunction upshift(tbox) {\r\n// This function moves the highlighted lines up the current list.\r\n// The cont variable allows us to move multiple highlighted lines as a unit. However, if\r\n// the first highlighted line is the first line in the list, then we will not move any of the data.\r\n    var swap, cont = 1;\r\n\r\n    for(var i=0; i<tbox.options.length && cont; i++) {\r\n    \t\r\n        swap = i - 1;\r\n        if(tbox.options[i].selected && tbox.options[i].value != \"\") {\r\n\t        \r\n            if (swap >= 0) { \r\n                // if the previous line is before the first line in the list, then move the data \r\n                var no = new Option();\r\n\tno.value = tbox.options[i].value;\r\n\tno.text = tbox.options[i].text;\r\n\r\n\ttbox.options[i].value = tbox.options[swap].value;\r\n\ttbox.options[i].text = tbox.options[swap].text;\r\n\ttbox.options[i].selected = false;\r\n\r\n\ttbox.options[swap].value = no.value;\r\n\ttbox.options[swap].text = no.text;\r\n\ttbox.options[swap].selected = true;\r\n            } else {\r\n\t cont = 0;\r\n            }\r\n        }\r\n    }\r\n}","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["Up/Down"]},{"RecordId":"529","Title":"Registry Setting to Unlock IE Security Tab","Description":"Registry setting that unlocks IE security settings if they are locked.","Code":"HKEY_LOCAL_MACHINE\r\n  Software\r\n    Policies\r\n      Microsoft\r\n        Windows\r\n          CurrentVersion\r\n            Internet Settings\r\n\r\nSet the following values to zero (0):\r\n  Security_HKLM_only\r\n  Security_options_edit\r\n  Security_zones_map_edit\r\n","Declares":"","CodeCategory":{"CategoryId":"7","CategoryDescription":"Misc"},"Keywords":["IE","Security","Unlock"]},{"RecordId":"530","Title":"Confirm Delete On Anchor Tag With Message Box","Description":"Displays a message box to confirm deletion of an item that has a \"Delete\" anchor tag.","Code":"<a\r\n href=\"upload_admin_deletedata.asp?DocID=<%=oRS(\"DocID\")%>&amp;Mode=DELETE\r\n onClick=\"if (confirm('Are you sure you want to delete this item?')) {return (true);} \r\n                else {return (false);}\">Delete</a>\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["Confirm","Delete"]},{"RecordId":"531","Title":"Creating Internet Shortcuts","Description":"This shows the format of an internet shortcut.\r\nThis file could be sent as an attachment in an email.","Code":"[InternetShortcut]\r\nURL=http://www.microsoft.com","Declares":"","CodeCategory":{"CategoryId":"2","CategoryDescription":"Web"},"Keywords":["Internet Shortcut","URL"]},{"RecordId":"532","Title":"Adding \"Edit With ...\" as Explorer Right-Click Option","Description":"Explains how to add a right-click \"Edit with...\" option for NT Explorer.","Code":"MS Windows Explorer (the file manager, not the browser) allows you to associate multiple applications with a particular file type. In Explorer, you can select a file, then Right-Mouse-Click to pop up the context menu. You then select which application you wish or what action to perform. This procedure tells you how to add an \"Edit with HomeSite\" action/option for .ASP files. Obviously, this procedure can be applied to other file types.\r\n\r\n1.  Open Windows Explorer and navigate to a subdirectory that contains files of the\r\n     type you wish to add an action to. \r\n2.  Note the name of that file type used in the Type column. \r\n3.  Select one of the files and Right-Mouse-Click to see if there is already a default action\r\n     associated with it. The action will generally be bolded and near the top of the pop-up menu. \r\n     If the bolded one is \"Open With\" then there is no default application. \r\n4.  If there are no actions assocated with the file type or if you want to replace the existing \r\n     open action, you can add one the short way. If you want to add HomeSite in addition to\r\n     other actions, then you need the longer method. (just like taxes, the short form or the long\r\n     form... ;-) \r\n\r\n\r\nThe short method \r\n\r\n1.  Select one .asp file (or whatever type you're working on) \r\n2.  Hold in the Shift key and right-click. \r\n3.  The pop-up menu should have \"Open With\" as an option. Click it. \r\n4.  Choose the program you want to use (HomeSite) and check the box saying \"Always use \r\n     this program to open this type of file.\" \r\n5.  Click OK. \r\n6.  HomeSite should now be used as the default when you double-click on files of this type. \r\n\r\n\r\nThe longer method \r\n\r\n1.  On the Explorer menu, select View | Options. \r\n2.  Next, select the File Types tab. \r\n3.  Find the file type name you noted in step 2 and click \"Edit.\" (If it's not there, then click\r\n     \"New Type\") \r\n4.  Under actions, there will be a list of any actions that are set up. The default action will be\r\n     bolded. To add a new one for HomeSite click \"New\" under the actions box. \r\n5.  In the \"Action\" box, add a new name, like \"Edit with HomeSite\" \r\n6.  For the \"Application used to perform action\" box, click on the browse button and go to\r\n     your HomeSite install directory. Select the Homesite exe file and click ok. This should\r\n     enter something like:   \"C:\\Program Files\\homesite 4.5\\homesite45.exe\" \r\n     depending upon your install path. \r\n7.  Add \"%1\" after the path for something like this:\r\n     \"C:\\Program Files\\homesite 4.5\\homesite45.exe\" \"%1\"\r\n     Note that all the quotes should be there. This lets it work for paths that contain spaces. \r\n8.  Click Ok. \r\n9.  Select the action and click \"Set Default\" if you wish. \r\n10.  lick OK several times to finish. \r\n\r\nExplorer's ability to associate multiple apps with a file type can be very handy.  For instance, you can have the default set to your main editor, but also have options for other editors you use, file checkers, compilers, etc as long as you have the correct command line parameters set up.","Declares":"","CodeCategory":{"CategoryId":"7","CategoryDescription":"Misc"},"Keywords":["Explorer","Open With","Right Click"]},{"RecordId":"533","Title":"ADSI - Get Group Members and Get Groups User Is A Member Of","Description":"Demonstrates how to obtain members of a group and how to obtain groups that a user is a member of.","Code":"<%\r\n\r\noption explicit\r\n\t\r\nDim Member\r\nDim Group\r\nDim ADsGroup\r\nDim ADsUser\r\nDim strUser\r\nDim strGroup\r\n\r\n'---- Get some groups and their members --------------------------------------------------------------------------------------------\r\nstrGroup = \"US CSN Web Editors\"\r\nresponse.write \"Group: \" & strGroup & \"<br>\"\r\nSet ADsGroup = GetObject(\"WinNT://US/\" & strGroup & \",Group\")\r\nFor Each Member In ADsGroup.members\r\n\tresponse.write Member.Name & \"<br>\"\r\nNext\r\n    \r\nSet ADsGroup = Nothing\r\n\r\n\r\nstrGroup = \"Administrators\"\r\nresponse.write \"<br><br>Group: \" & strGroup & \"<br>\"\r\nSet ADsGroup = GetObject(\"WinNT://US/\" & strGroup & \",Group\")\r\nFor Each Member In ADsGroup.members\r\n\tresponse.write Member.Name & \"<br>\"\r\nNext\r\n    \r\nSet ADsGroup = Nothing\r\n\r\n\r\n'---- Get the groups a user belongs to --------------------------------------------------------------------------------------------\r\nstrUser = \"jtgamble\"\r\nresponse.write \"<br><br>User: \" & strUser & \" <br>\"\r\nSet ADsUser = GetObject(\"WinNT://us/\" & strUser & \",User\")\r\nfor each Group in ADsUser.Groups\r\n\tresponse.write Group.Name & \"<br>\"\r\nNext\r\n\r\nSet ADsGroup = Nothing\r\n\t\r\n\r\nstrUser = \"tratz\"\r\nresponse.write \"<br><br>User: \" & strUser & \" <br>\"\r\nSet ADsUser = GetObject(\"WinNT://us/\" & strUser & \",User\")\r\nfor each Group in ADsUser.Groups\r\n\tresponse.write Group.Name & \"<br>\"\r\nNext\r\n\r\nSet ADsGroup = Nothing\r\n\r\n%>","Declares":"","CodeCategory":{"CategoryId":"7","CategoryDescription":"Misc"},"Keywords":["ADSI","Member","Group"]},{"RecordId":"534","Title":"Location of .asp Icon","Description":"Location of the default icon that is used for .asp files","Code":"Location of the VID icon for .asp extensions:\r\n  \r\nC:\\Program Files\\Microsoft Visual Studio\\VIntDev98\\bin\\vidisws.dll","Declares":"","CodeCategory":{"CategoryId":"2","CategoryDescription":"Web"},"Keywords":["Visual InterDev"]},{"RecordId":"536","Title":"Print This Page From Browser (NS & IE)","Description":"Print this page that works in Netscape & IE","Code":"/*   This script is written by Eric (Webcrawl@usa.net)\r\n       For full source code, installation instructions,\r\n       100's more DHTML scripts, and Terms Of\r\n       Use, visit dynamicdrive.com     */\r\n\r\nfunction printit(){\r\n\r\n  var NS = (navigator.appName == \"Netscape\");\r\n\r\n  if (NS) {\r\n    window.print() ;\r\n  } else {\r\n    var WebBrowser = '<OBJECT ID=\"WebBrowser1\" WIDTH=0 HEIGHT=0\r\n         CLASSID=\"CLSID:8856F961-340A-11D0-A96B-00C04FD705A2\"></OBJECT>';\r\n    document.body.insertAdjacentHTML('beforeEnd', WebBrowser);\r\n    WebBrowser1.ExecWB(6, 2);    //Use a 1 vs. a 2 for a prompting dialog box         WebBrowser1.outerHTML = \"\";\r\n  }\r\n}\r\n</script>\r\n\r\n<input type=button value=\"Print this Page\" name=\"Print\"   onClick=\"printit()\">","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["Print This Page"]},{"RecordId":"537","Title":"Read Standard Input Channel","Description":"Reads the standard input channel","Code":"' Read a number of chars from standard input channel\r\n' If NumBytes < 0 then it reads all the bytes from the standard input\r\n' NOTE: this routine works only in compiled applications\r\n\r\nFunction ReadFromStdInput(Optional ByVal NumBytes As Long = -1) As String\r\n\r\n    Dim hStdIn As Long\r\n    Dim ret As Long\r\n    Dim buffer As String\r\n    Dim bytesRead As Long\r\n    \r\n    ' get the handle of standard input\r\n    hStdIn = GetStdHandle(STD_INPUT_HANDLE)\r\n    \r\n    ' prepare receiving buffer\r\n    buffer = Space$(1024)\r\n    \r\n    Do\r\n        ' read from standard input\r\n        ret = ReadFile(hStdIn, ByVal buffer, Len(buffer), bytesRead, ByVal 0&)\r\n    \r\n        ' deal with errors\r\n        If ret = 0 Then\r\n            Err.Raise 1001, , \"Unable to read from standard input\"\r\n        End If\r\n        \r\n        ' append to result built so far\r\n        ReadFromStdInput = ReadFromStdInput & Left$(buffer, bytesRead)\r\n        \r\n        ' continue to read if there are more chars\r\n    Loop Until bytesRead < Len(buffer)\r\n        \r\nEnd Function","Declares":"Private Declare Function GetStdHandle Lib \"kernel32\" (ByVal nStdHandle As Long) As Long\r\nPrivate Declare Function ReadFile Lib \"kernel32\" (ByVal hFile As Long, lpBuffer As Any, ByVal nNumberOfBytesToRead As Long, lpNumberOfBytesRead As Long, lpOverlapped As Any) As Long\r\n\r\nPrivate Const STD_INPUT_HANDLE = -10&\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Console Input","Standard In"]},{"RecordId":"538","Title":"Write Standaard Ouput Channel","Description":"Writes to the standard output channel","Code":"' Write to standard output channel\r\n' NOTE: this routine works only in compiled applications\r\n\r\nSub WriteToStdOutput(ByVal Text As String)\r\n\r\n    Dim hStdOut As Long\r\n    Dim ret As Long\r\n    Dim bytesWritten As Long\r\n    \r\n    ' get the handle of standard output\r\n    hStdOut = GetStdHandle(STD_OUTPUT_HANDLE)\r\n    \r\n    ' write to standard output\r\n    ret = WriteFile(hStdOut, ByVal Text, Len(Text), bytesWritten, ByVal 0&)\r\n    \r\n    ' deal with errors\r\n    If ret = 0 Then\r\n        Err.Raise 1001, , \"Unable to write to standard output\"\r\n    ElseIf bytesWritten < Len(Text) Then\r\n        Err.Raise 1002, , \"Incomplete write operation\"\r\n    End If\r\n\r\nEnd Sub","Declares":"Private Declare Function GetStdHandle Lib \"kernel32\" (ByVal nStdHandle As Long) As Long\r\nPrivate Declare Function WriteFile Lib \"kernel32\" (ByVal hFile As Long, lpBuffer As Any, ByVal nNumberOfBytesToWrite As Long, lpNumberOfBytesWritten As Long, lpOverlapped As Any) As Long\r\n\r\nPrivate Const STD_OUTPUT_HANDLE = -11&\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Console Output","Standard Output"]},{"RecordId":"539","Title":"Calling COM Components and Passing Parameters ByRef in ASP","Description":"When calling VB COM components from ASP and passing parms ByRef, ASP generates a Type Missmatch Error.  This sample demonstrates how to get around the problem.","Code":"A typical assumption might look like this:\r\n\r\nPublic Sub ModifyData(ByRef rstOne As ADODB.Recordset, \r\n                                     ByRef rstTwo As ADODB.Recordset) \r\n   'code that modifies the data in both recordsets\r\nEnd Sub\r\n\r\nAnd let's say the ASP page is: \r\nDim rstOne, rstTwo\r\nSet rstOne = Server.CreateObject(\"ADODB.Recordset\")\r\nSet rstTwo = Server.CreateObject(\"ADODB.Recordset\")\r\n\r\nDim objTest\r\nSet objTest = Server.CreateObject(\"Test.clsTest\")\r\n\r\nCall objTest.ModifyData(rstOne, rstTwo)\r\n\r\nHere, despite the instantiating of the recordsets on the ASP page before they are passed into the component, a Type Mismatch Error occurs. \r\n\r\nFortunately, there is a way around it. The answer is to dimension a local variable or instantiate a local object in the called procedure, use that variable or object within the component, and then set the variant argument to equal the local variable or object just before the procedure ends. \r\n\r\nPublic Sub ModifyData(ByRef varOne As Variant, ByRef varTwo As Variant) \r\n\tDim rstOne As ADODB.Recordset\r\n\tDim rstTwo As ADODB.Recordset\r\n\tSet rstOne = varOne\r\n\tSet rstTwo = varTwo\r\n\t'code that modifies the data in both recordsets, rstOne and rstTwo\r\n\t...\r\n\tSet varOne = rstOne\r\n\tSet varTwo = rstTwo\r\n\tSet rstOne = Nothing\r\n\tSet rstTwo = Nothing\r\nEnd Sub\r\n\r\n'With a variable\r\nPublic Sub TestSub(ByVal X As Integer, ByRef Y As Variant)\r\n\tDim intY as Integer\r\n\tX = X + 1\r\n\tintY = X + 1\r\n\tY = intY\r\nEnd Sub   \r\n\r\nWith this strategy, using ByRef with ASP and VB COM becomes possible because the type mismatch error is avoided.","Declares":"","CodeCategory":{"CategoryId":"5","CategoryDescription":"ASP"},"Keywords":["ByRef","Parameter Passing","MTS"]},{"RecordId":"540","Title":"Closing Browser Windows","Description":"6 ways to close browser windows","Code":"There are six slightly different scripts below. In cases where images are used, replace the image name with the name of your own image.\r\n\r\nOther than that, just insert the code as shown into your page <body> wherever you wish the closing link, image, or button to appear.\r\n\r\nSpecial Note on Frameset Pages:\r\nClosing windows that are comprised of a frameset requires that you ask to close the \"topmost\" window, *not* the page that contains the JavaScript closing code. Thus, where window.close() will work fine with a regular page, it will often fail (depending on the browser) when attempting to close a window comprised of frameset pages.  In this case, the JavaScript closer must ask for top.window.close() instead.\r\n\r\nOther Background:\r\nBefore you ask... if a window is *not* a popup to begin with, window.close() JavaScript calls will normally result in a browser message requesting confirmation that you wish to close the window.  There is no means in most browsers to avoid or circumvent this.\r\n\r\n1. Closing a Regular Window from a Link Click\r\n<a href=\"javascript:window.close()\">Close</a>\r\n\r\n2. Closing a Regular Window from an Image Click\r\n<a href=\"javascript:window.close()\">\r\n<img border=\"0\" src=\"closingwindows.gif\" width=\"95\" height=\"46\">\r\n</a>\r\n\r\n3. Closing a Regular Window from a Button Click\r\n<form>\r\n<input type=\"button\" value=\"Close\" onClick=\"window.close()\">\r\n</form>\r\n\r\n4. Closing a Frameset Window from a Link Click\r\n<a href=\"javascript:top.window.close()\">Close</a>\r\n\r\n5. Closing a Frameset Window from an Image Click\r\n<a href=\"javascript:top.window.close()\">\r\n<img border=\"0\" src=\"closingwindows.gif\" width=\"95\" height=\"46\">\r\n</a>\r\n\r\n6. Closing a Frameset Window from a Button Click\r\n<form>\r\n<input type=\"button\" value=\"Close\" onClick=\"top.window.close()\">\r\n</form>","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["Close Browser","Close Window"]},{"RecordId":"541","Title":"Frame Buster","Description":"Used to break out of a frame set","Code":"if (window != window.top)\r\n  top.location.href = location.href;","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["Frame Buster"]},{"RecordId":"542","Title":"Reload Current Page","Description":"Creates a link that reloads the current page","Code":"<'a href=\"javascript:location.reload()\" target=\"_self\">Refresh</a>","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["Refresh Current Page","Reload Current Page"]},{"RecordId":"543","Title":"Associating an Icon With a Web Page","Description":"How to associate an Icon with a web page so that it appears next to the URL when the page is bookmarked.","Code":"Two methods for linking an Icon with a page.  \r\n\r\nNOTE 1:  Supported by IE5 and above only.\r\n\r\nNOTE 2:  You can create the icon with different sizes and color depths, but there must be at least one that is a 16x16 icon in the file.\r\n\r\n\r\nMethod 1:  Create a  <link rel=\"shortcut icon\" href=\"ted.ico\"> line in the <head> section of your page.  This associates the icon with this specific page.\r\n\r\n<html>\r\n<head>\r\n  <link rel=\"shortcut icon\" href=\"ted.ico\">   <-- This is how\r\n</head>\r\n  <body>\r\n    This is a test page that places an icon in the favorites.\r\n  </body>\r\n</html>\r\n\r\nMethod 2:  Name the icon \"favicon.ico\" and place it in the root of your site.  This has the advantage that when ANY page on your site is bookmarked, it will have the icon associated with it.  The disadvantage, however, is that IE searches backwards from the current page up the directory structure towards the root.  This means that you would get a series of 404 errors in your site logs back up the directory structure until the icon was found.","Declares":"","CodeCategory":{"CategoryId":"2","CategoryDescription":"Web"},"Keywords":["Icon","Bookmark","Favorites"]},{"RecordId":"544","Title":"Bookmark This Page","Description":"Sample of how to add a \"Bookmark This Page\" link to a page.","Code":"<SCRIPT>\r\n<!--\r\nif ((navigator.appVersion.indexOf(\"MSIE\") > 0)\r\n  && (parseInt(navigator.appVersion) >= 4)) {\r\n    var sText = \"<U><SPAN STYLE='color:blue;cursor:hand;'\";\r\n    sText += \"onclick='window.external.AddFavorite(location.href,\";\r\n    sText += \"document.title);'>Add this page to your favorites</SPAN></U>\";\r\n    document.write(sText);\r\n}\r\n//-->\r\n</SCRIPT>","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["Bookmark This Page"]},{"RecordId":"545","Title":"Zip On-The-Fly Within ASP","Description":"Demonstrates how to zip files on the fly from within an ASP page.\r\nNOTE:  Requires ASPExec component, icuSgDldSvd.dll, and WinZip be installed on the web server.","Code":"<%@ Language=VBScript %>\r\n<%\r\n\r\n'###############################################################\r\n'#  Sub DeleteAFile(sFilename, bForce)\r\n'###############################################################\r\nSub DeleteAFile(sFilename, bForce)\r\n\r\n   Dim fso\r\n   Set fso = CreateObject(\"Scripting.FileSystemObject\")\r\n   fso.DeleteFile sFilename, bForce \r\n\r\nEnd Sub\r\n\r\n'###############################################################\r\n'#  Function ReturnFile(sFilename)\r\n'###############################################################\r\nFunction ReturnFile(sFilename)\r\n\t\r\n   Dim oFile, bFileContents\r\n\r\n   Set oFile = Server.CreateObject(\"icuSgDldSvc.cFile\")\r\n\r\n   ' Don't ask about the NULL, without it it just won't work!\r\n   bFileContents = oFile.ReadFileToByteA(sFilename & NULL)\r\n\r\n   ReturnFile = bFileContents\r\n\r\nEnd Function\r\n\r\n'###############################################################\r\n'#  Mainline processing\r\n'###############################################################\r\n\r\n   Const ZIP_ADD = 4\r\n   Const UNZIP_EXTRACT = 8\r\n   Const THREADING_TIMEOUT = 30\r\n\r\n   Select Case Request.ServerVariables(\"SERVER_NAME\")\r\n      case \"ushernt63\"\r\n         root_dir = \"e:\\inetpub\\\"\r\n      case  \"ushernt40\", \"dweb\", \"dweb.dttus.com\", \"10.5.10.195\"\r\n         root_dir = \"d:\\inetpub\\\"\r\n      case else\r\n         root_dir = \"e:\\inetpub\\wwwroot\\\"\r\n   End Select\r\n   \r\n   strDirectory = Request(\"template\")\r\n   SourceDir = root_dir & \"dweb\\palette\\templates\\tables\\\" & strDirectory & \"\\*.*\"\r\n   DestinationDir = \"c:\\temp\\\" & strDirectory\r\n   FileLocation = DestinationDir & \".zip\"\r\n\r\n   ' Zip up files  and return file.\r\n    Set Executor = Server.CreateObject(\"ASPExec.Execute\")\r\n    Executor.Application = \"c:\\progra~1\\PKZip\\pkzip.exe\"\r\n    Executor.Parameters = \"-add -speed -rec -exc=*_vti* -exc=*.log -dir=relative \" _\r\n                                            & DestinationDir & \".zip \" & SourceDir\r\n    Executor.ShowWindow = False\r\n    Executor.TimeOut = 300000\r\n    strResult = Executor.ExecuteWinAppAndWait\r\n\r\n    ' Begin Download\r\n    Response.Buffer = TRUE\r\n    Response.ContentType = \"zapplication/octet-stream\"\r\n    Response.AddHeader \"Content-Disposition\", \"attachment;filename=\" & strDirectory & \".zip\"\r\n    Response.BinaryWrite ReturnFile(FileLocation)\r\n\r\n    'Delete temporary file from server.\r\n    DeleteAFile FileLocation, FALSE\r\n    Response.end\r\n%>\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"5","CategoryDescription":"ASP"},"Keywords":["Zip"]},{"RecordId":"546","Title":"Run DTS Package From Stored Procedure","Description":"Demonstrates how to run DTS package from stored procedure","Code":"CREATE PROCEDURE sp_DTSRUN  AS\r\n  EXEC master..xp_cmdshell  \"dtsrun /S uswebnt08 /U sa /P rockwell /N fast500test\"\r\nGO\r\n","Declares":"","CodeCategory":{"CategoryId":"10","CategoryDescription":"SQL Server"},"Keywords":["DTS","Stored Procedure"]},{"RecordId":"547","Title":"Force Open / SaveAs Dialog on Downloads","Description":"Forces browser to show the Open / Save As dialog, even if the file extension is a known MIME type.","Code":"Add a content disposition of \"attachment\".  This overrides the browser's tendency to show the file in it's native application.\r\n\r\nResponse.AddHeader \"content-disposition\", \"attachment; filename=fname.ext\"","Declares":"","CodeCategory":{"CategoryId":"2","CategoryDescription":"Web"},"Keywords":["File Download","MIME Types"]},{"RecordId":"548","Title":"Run the Shortcut Creation Wizard","Description":"Demonstrates how to run the \"Create a Shortcut\" wizard, giving an end user the ability to create a new shortcut.","Code":"Shell \"rundll32.exe AppWiz.Cpl, NewLinkHere \" & App.Path, 1\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Shortcut","Wizard"]},{"RecordId":"549","Title":"Extract an Icon From a File and Show It","Description":"Extract an Icon from a file and display it","Code":"' Extract an icon from a file and display it on a Form or PictureBox\r\n' (in general, any control that has the hDC property)\r\n'\r\n' Returns True if successful\r\n'\r\n' FILENAME is the file that contains the icon\r\n' ICONINDEX is the number of the icon to extract from the file (zero-based)\r\n' HDC is a valid Device Context handle\r\n' X,Y are the coordinates in the picturebox where the icon should be displayed\r\n'\r\n' Example:\r\n'    ' display the first icon in SHELL32.DLL\r\n'    ShowIcon \"C:\\WINDOWS\\SYSTEM\\SHELL32.DLL\", 0, Picture1.hDC, 0, 0\r\n\r\nFunction ShowIcon(ByVal FileName As String, ByVal iconIndex As Long, _\r\n    ByVal hDC As Long, ByVal X As Long, ByVal Y As Long) As Boolean\r\n    Dim hIcon As Long\r\n    ' extract the icon\r\n    hIcon = ExtractIcon(App.hInstance, FileName, iconIndex)\r\n\r\n    If hIcon Then\r\n        ' if non null display it\r\n        DrawIcon hDC, X, Y, hIcon\r\n        ' signal success\r\n        ShowIcon = True\r\n    End If\r\nEnd Sub\r\n\r\n","Declares":"Private Declare Function ExtractIcon Lib \"shell32.dll\" Alias \"ExtractIconA\" _\r\n    (ByVal hInst As Long, ByVal lpszExeFileName As String, _\r\n    ByVal nIconIndex As Long) As Long\r\n\r\nPrivate Declare Function DrawIcon Lib \"user32\" (ByVal hDC As Long, _\r\n    ByVal X As Long, ByVal Y As Long, ByVal hIcon As Long) As Long\r\n","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Icon Extraction"]},{"RecordId":"550","Title":"Hilight Text in Text Box","Description":"Demonstrates how to highlight (select) text in a text box on an html page","Code":"document.frmMain.txtName.focus();\r\ndocument.frmMain.txtName.select();","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["Hilight","Select Text"]},{"RecordId":"551","Title":"Extract Words Into a Collection","Description":"Uses regular expressions to extract all words and return a collection","Code":"The following routine extracts all the words from a source string and returns a collection. Optionally, the result contains only unique words.\r\n\r\nThis code is remarkably simpler than an equivalent \"pure\" VB solution because it takes advantage of the RegExp object in the Microsoft VBScript Regular Expression type library. \r\n\r\n' Get a collection of all the words in a string\r\n' If the second argument is True, only unique words are returned\r\n'\r\n'\r\n' NOTE: requires a reference to the\r\n'       Microsoft VBScript Regular Expression type library\r\n\r\nFunction GetWords(ByVal Text As String, Optional DiscardDups As Boolean) As _\r\n    Collection\r\n    Dim re As New RegExp\r\n    Dim ma As Match\r\n    \r\n    ' the following pattern means that we're looking for a word character (\\w)\r\n    ' repeated one or more times (the + suffix), and that occurs on a word\r\n    ' boundary (leading and trailing \\b sequences)\r\n    re.Pattern = \"\\b\\w+\\b\"\r\n    ' search for *all* occurrences\r\n    re.Global = True\r\n    \r\n    ' initialize the result\r\n    Set GetWords = New Collection\r\n    \r\n    ' we need to ignore errors, if duplicates are to be discarded\r\n    On Error Resume Next\r\n    \r\n    ' the Execute method does the search and returns a MatchCollection object\r\n    For Each ma In re.Execute(Text)\r\n        If DiscardDups Then\r\n            ' if duplicates are to be discarded, we just add a key to the \r\n            ' collection item\r\n            ' and the Add method will do the rest\r\n            GetWords.Add ma.Value, ma.Value\r\n        Else\r\n            ' otherwise just add to the result\r\n            GetWords.Add ma.Value\r\n        End If\r\n    Next\r\n    \r\nEnd Function\r\n\r\nHere is an example of how you can use the routine: \r\n' Count how many articles appear in a source string\r\n' held in the txtSource textbox control\r\nDim v As Variant\r\nDim count As Long\r\n\r\nFor Each v In GetWords(txtSource.Text)\r\n    Select Case LCase$(v)\r\n        Case \"the\", \"a\", \"an\"\r\n            count = count + 1\r\n    End Select\r\nNext\r\nMsgBox \"Found \" & count & \" articles.\"","Declares":"","CodeCategory":{"CategoryId":"15","CategoryDescription":"Regular Expressions"},"Keywords":["Words"]},{"RecordId":"552","Title":"Simple Regular Expression Example","Description":"Demonstrates how to use the RegExp object from VB","Code":"As an example of how to use the RegEx object, the following code searches all the occurrences of an uppercase character followed by three digits: \r\n\r\n' NOTE: this code requires a reference to the \r\n'       Microsoft VBScript Regular Expression type library\r\n'\r\nDim re As New RegExp\r\nDim ma As Match\r\n\r\nre.Pattern = \"[A-Z][0-9][0-9][0-9]\"    ' uppercase char followed by 3 digits\r\nre.IgnoreCase = False                  ' case sensitive search\r\nre.Global = True                       ' find all the occurrences\r\n\r\nFor Each ma In re.Execute(txtSource.Text)\r\n    Print \"Found '\" & ma.Value & \"' at index \" & ma.FirstIndex\r\nNext\r\n\r\n\r\nBecause the special \\d reqular expression sequence means \"a digit character\", the Pattern property in the above example could be assigned also as follows: \r\nre.Pattern = \"[A-Z]\\d\\d\\d\"\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"15","CategoryDescription":"Regular Expressions"},"Keywords":["Regular Expressions"]},{"RecordId":"553","Title":"Count Number of Words Using Regular Expressions","Description":"VB example of how to use the RegExp object to count the number of words in a string","Code":"A Visual Basic function that counts the number of words in a sentence or text file can become quickly very complex, and usually doesn't execute fast enough for most purposes. Thanks to the RegEx object that comes with the Microsoft VBScript Regular Expression type library, this task becomes trivial. Here's all the code that you need: \r\n\r\n' Count the number of words in the string argument\r\n'\r\n' NOTE: requires a reference to the \r\n'       Microsoft VBScript Regular Expression type library\r\n\r\nFunction CountWords(ByVal Text As String) As Long\r\n    Dim re As New RegExp\r\n    ' the following pattern means that we're looking for a word character (\\w)\r\n    ' repeated one or more times (the + suffix), and that occurs on a word\r\n    ' boundary (leading and trailing \\b sequences)\r\n    re.Pattern = \"\\b\\w+\\b\"\r\n    ' search for *all* occurrences\r\n    re.Global = True\r\n    ' the Execute method does the search and returns a MatchCollection object\r\n    ' which in turn exposes the Count property,\r\n    '  i.e. the result we're interested into\r\n    CountWords = re.Execute(Text).Count\r\nEnd Function\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"15","CategoryDescription":"Regular Expressions"},"Keywords":["Word Count"]},{"RecordId":"554","Title":"Count Number of Word Occurances Using Regular Expressions","Description":"VB example of how to use the RegExp object to count the number of word occurances in a string.","Code":"' Analyze a source string and return a bidimensional array that contains\r\n' all the words the string contains and the number of occurrences of each\r\n'\r\n' Example of usage:\r\n'     Dim arr() as Variant\r\n'     arr = GetWordsOccurrences(txtSource.Text)\r\n'     For i = 1 To UBound(arr, 2)\r\n'         Print \"Word \" & arr(0, i) & \": \" & arr(1, i) & \" occurrences\"\r\n'     Next\r\n'\r\n' NOTE: requires a reference to the\r\n'       Microsoft VBScript Regular Expression type library\r\n\r\nFunction GetWordsOccurrences(ByVal Text As String) As Variant()\r\n    Dim re As New RegExp\r\n    Dim ma As Match\r\n    Dim col As New Collection\r\n    Dim ndx As Long\r\n    \r\n    ' the following pattern means that we're looking for a word character (\\w)\r\n    ' repeated one or more times (the + suffix), and that occurs on a word\r\n    ' boundary (leading and trailing \\b sequences)\r\n    re.Pattern = \"\\b\\w+\\b\"\r\n    ' search for *all* occurrences\r\n    re.Global = True\r\n    \r\n    ' let's start with an array of 100 elements\r\n    ReDim res(1, 100) As Variant\r\n    \r\n    ' we need this to work with the collection\r\n    On Error Resume Next\r\n    \r\n    For Each ma In re.Execute(Text)\r\n        ' the index in the array where this word should be inserted,\r\n        ' if not already in the array\r\n        ndx = col.Count + 1\r\n        ' attempt to add this to the collection\r\n        col.Add ndx, ma.Value\r\n        ' if no error, this is the first occurrence of the word and the\r\n        ' element in the collection already contains the index of the\r\n        ' corresponding element in the array\r\n        If Err = 0 Then\r\n            ' ensure the array is large enough\r\n            If ndx > UBound(res, 2) Then\r\n                ' if not, add 100 elements\r\n                ReDim Preserve res(1, ndx + 99) As Variant\r\n            End If\r\n            ' insert the word and initialize word count\r\n            res(0, ndx) = ma.Value\r\n            res(1, ndx) = 1\r\n            \r\n        Else\r\n            ' the word is already in the array\r\n            Err.Clear\r\n            ' get the index in the array\r\n            ndx = col(ma.Value)\r\n            ' increment word count\r\n            res(1, ndx) = res(1, ndx) + 1\r\n        End If\r\n    Next\r\n    \r\n    ' trim the result array\r\n    If col.Count Then\r\n        ReDim Preserve res(1, col.Count) As Variant\r\n        GetWordsOccurrences = res\r\n    End If\r\n\r\nEnd Function","Declares":"","CodeCategory":{"CategoryId":"15","CategoryDescription":"Regular Expressions"},"Keywords":["Word Count","Word Occurances"]},{"RecordId":"555","Title":"Extract All Quoted Strings Using Regular Expressions","Description":"When parsing a text file that contains quoted strings - such as a VB source file - you might want to quickly locate and extract all the quoted strings.","Code":"When parsing a text file that contains quoted strings - such as a VB source file - you might want to quickly locate and extract all the quoted strings. Thanks to regular expressions and the RegExp object in the Microsoft VBScript Regular Expression type library, this task is surprisingly easy: \r\n\r\nDim re As New RegExp\r\nDim ma As Match\r\n\r\n' the pattern \".*\" means a double quote char followed by any number \r\n' of chars and finally another double quote char\r\nre.Pattern = \"\"\".*\"\"\"     \r\n' we want all occurrences\r\nre.Global = True\r\n' assumes that the text to be parsed is in the txtSource textbox\r\nFor Each ma In re.Execute(txtSource.Text)\r\n    Print ma.Value & \" at index \" & ma.FirstIndex\r\nNext\r\n\r\nThe following routine has only one drawback: it doesn't account for repeated double quote chars, which should translate to a single double quote. See how you can remedy to this problem: \r\nDim re As New RegExp\r\nDim ma As Match\r\nDim tmpText As String\r\nDim maText As String \r\n\r\n' the pattern \".*\" means a double quote char followed by any number \r\n' of chars and finally another double quote char\r\nre.Pattern = \"\"\".*\"\"\"     \r\n' we want all occurrences\r\nre.Global = True\r\n' get the text to be parsed from the txtSource textbox, but\r\n' replace repeated double quotes with an unprintable chars\r\ntmpText = Replace(txtSource.Text, \"\"\"\"\"\", vbNullChar & vbNullChar)\r\n\r\n' search all the occurrences\r\nFor Each ma In re.Execute(tmpText)\r\n    ' display this occurrence, but restore embedded double quotes\r\n    tmpText = Replace(ma.Value, vbNullChar & vbNullChar, \"\"\"\"\"\")\r\n    Print tmpText & \" at index \" & ma.FirstIndex\r\nNext\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"15","CategoryDescription":"Regular Expressions"},"Keywords":["Quoted Strings"]},{"RecordId":"556","Title":"Net Use","Description":"Syntax for using \"Net Use\" to map a network drive","Code":"Maps the \"K\" drive to the \\\\ushernt141\\sscweb share with a US\\jtgamble \"connect as\"\r\n\r\nnet use K: \\\\ushernt141\\sscweb MyDomainPassword /user:us\\jtgamble\r\n\r\n\r\n\r\nThe complete NET USE syntax is as follows:\r\n\r\nNET USE [devicename | *] [\\\\computername\\sharename[\\volume] [password | *]]\r\n        [/USER:[domainname\\]username]\r\n        [[/DELETE] | [/PERSISTENT:{YES | NO}]]\r\n\r\nNET USE [devicename | *] [password | *]] [/HOME]\r\n\r\nNET USE [/PERSISTENT:{YES | NO}]","Declares":"","CodeCategory":{"CategoryId":"7","CategoryDescription":"Misc"},"Keywords":["Net Use","Mapping Drives"]},{"RecordId":"558","Title":"Create Excel File Download (Demonstrates Formulas)","Description":"Creates Excel file download without going through external file creation.  Creates an HTML table text stream.  The down side of this one is that you don't get the grid-lines in excel, even though you do get cells.\r\n\r\nNOTE:  Set response.buffer = true","Code":"<%@ Language=VBScript %>\r\n\r\n<%\r\nresponse.buffer = true\r\nresponse.ContentType = \"application/vnd.ms-excel\"\r\nresponse.AddHeader \"content-disposition\", \"inline; filename=dynamic.xls\"\r\n%>\r\n\r\n<TABLE>\r\n   <TR>\r\n      <TD>Col 1</TD>\r\n      <TD>Col 2</TD>\r\n      <TD>Total</TD>\r\n   </TR>\r\n   <TR>\r\n      <TD>1</TD>\r\n      <TD>2</TD>\r\n      <TD><FONT color=#000080>=sum(a2:b2)</FONT></TD>\r\n   </TR>\r\n   <TR>\r\n      <TD>4</TD>\r\n      <TD>6</TD>\r\n      <TD><FONT color=#000080>=sum(a3:b3)</FONT></TD>\r\n   </TR>\r\n</TABLE>\r\n\r\n<%\r\nresponse.flush\r\nresponse.end\r\n%>\r\n","Declares":"","CodeCategory":{"CategoryId":"5","CategoryDescription":"ASP"},"Keywords":["Excel","Download","Content Type"]},{"RecordId":"560","Title":"Detect if Flash is Installed","Description":"Detects whether or not Flash is installed on the client.  Works in NS & IE.","Code":"<html>\r\n<head>\r\n<title>Flash Sniffer</title>\r\n\r\n<SCRIPT LANGUAGE=\"VBScript\">\r\n<!--\r\n\r\n\tFunction CheckFlashIE()\r\n\r\n\t   dim x\r\n\t   dim MM_FlashControlInstalled\r\n\t   \r\n\t   On Error Resume Next\r\n\t   \r\n\t   CheckFlashIE = False\r\n\t\r\n       Set x = CreateObject(\"ShockwaveFlash.ShockwaveFlash.5\")\t//  <- NOTE:  Checks for specific version of flash\r\n       Set x = CreateObject(\"ShockwaveFlash.ShockwaveFlash\")\t//  <- NOTE:  Checks for any version of flash\r\n       MM_FlashControlInstalled = IsObject(x)\r\n\t   \r\n       If MM_FlashControlInstalled Then\r\n\t   \t   CheckFlashIE = True\r\n       End If\r\n   \r\n   End Function\r\n   \r\n//-->\r\n</SCRIPT>\r\n\r\n<script language=\"JavaScript\">\r\n<!--\r\n\r\n\r\n\tfunction CheckFlashNS() {\r\n\r\n\t\tvar useFlash = navigator.mimeTypes && \r\n\t\tnavigator.mimeTypes[\"application/x-shockwave-flash\"] &&\r\n\t\tnavigator.mimeTypes[\"application/x-shockwave-flash\"].enabledPlugin;\r\n   \r\n   \t\tif (useFlash) {\r\n   \t\t\treturn(true);\r\n   \t\t} else {\r\n   \t\t\treturn(false);\r\n   \t\t}\r\n   \t}\r\n   \r\n\r\n\r\n\tfunction CheckFlash() {\r\n\t\r\n\t\tvar myBrowser=navigator.appName;\r\n\t\tvar IE=(myBrowser.indexOf(\"Explorer\")!=-1);\r\n\t\tvar NS=(myBrowser.indexOf(\"Netscape\")!=-1);\r\n\t\r\n\t\tif (IE) {\r\n\t\t\tif (CheckFlashIE()) {\r\n\t\t\t\talert('IE with Flash');\r\n\t\t\t} else {\r\n\t\t\t\talert('IE without Flash');\r\n\t\t\t}\r\n\r\n\t\t} else if (NS) {\r\n\t\t\tif (CheckFlashNS()) {\r\n\t\t\t\talert('NS with Flash');\r\n\t\t\t} else {\r\n\t\t\t\talert('NS without Flash');\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\t\t\talert('Not IE or NS');\r\n\t\t}\r\n\t}\r\n\r\n//-->\r\n</script>\r\n</head>\r\n\r\n<body bgcolor=\"#FFFFFF\" onLoad=\"CheckFlash()\">\r\n</body>\r\n</html>\r\n","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["Flash","Browser Detect"]},{"RecordId":"562","Title":"Create XML Document from ADO Recordset","Description":"Creates an XML Document from an ADO recordset","Code":"<%@ Language=VBScript %>\r\n<% \r\n\r\nOption Explicit\r\n\r\nResponse.Expires = 0 \r\n\r\nFunction GetPage() \r\n\r\n\tDim rs\r\n\tDim ConnectString\r\n\tDim Sql\r\n\t\r\n\t\r\n\tConnectString = \"Provider=SQLOLEDB.1;Password=F50_User;Persist Security Info=True;User ID=F50_User;Initial Catalog=Fast50_Intranet;Data Source=uswebnt08\"\r\n\tSql = \"Select * from Users\"\r\n\t\r\n\tSet rs = server.CreateObject(\"ADODB.Recordset\") \r\n\trs.CursorLocation = 3\r\n\trs.Open Sql, ConnectString, 3, 1, &H0001\r\n\t\r\n\tDim oXMLDOM\r\n\t' set oXMLDOM = Server.CreateObject(\"MSXML2.DOMDocument.3.0\")\t\r\n\tset oXMLDOM = Server.CreateObject(\"MSXML.DOMDocument\")\t\r\n\tset oXMLDOM.documentElement = oXMLDOM.createElement(\"result\")\r\n\t\r\n\tDim root\r\n\tset root = oXMLDOM.documentElement\r\n\t\r\n\tIf rs.RecordCount = 0 Then\r\n\t\tGetPage = oXMLDOM.xml\r\n\t\trs.Close\r\n\t\tSet rs = Nothing\r\n\t\tExit Function\r\n\tEnd If\r\n\t\r\n\t\r\n\tDim Field\r\n\tDim oNode\r\n\tDo Until rs.EOF \r\n\t\r\n\t\tset oNode = oXMLDOM.createElement(\"row\")\r\n\t\troot.appendChild oNode\r\n\t\t\r\n\t\tFor each Field in rs.Fields \r\n\t\t\tset oNode = oXMLDOM.createElement(Field.Name)\r\n\t\t\tif Not rs(Field.Name).Value = \"\" and Not LenB(rs(Field.Name).Value)=0 Then\r\n\t\t\t\toNode.text = rs(Field.Name).Value\r\n\t\t\tend if\r\n\t\t\troot.lastChild.appendChild oNode \r\n\t\tNext\r\n\t\t\r\n\t\trs.MoveNext\r\n\tLoop\r\n\t\r\n\tGetPage = oXMLDOM.xml \r\n\t\r\n\trs.Close\r\n\tSet rs = Nothing\r\n\r\nEnd Function\r\n\r\n\r\nresponse.write getpage()\r\n\r\n%>","Declares":"","CodeCategory":{"CategoryId":"8","CategoryDescription":"XML"},"Keywords":["Create Document"]},{"RecordId":"563","Title":"Numeric Text Entry Only and Eat Keystroke","Description":"Checks for numeric keys only in text box and eats keystroke if not numeric.","Code":"function CheckNum(obj) {\r\n\r\n  if ( obj.value.length == 0) \r\n    return;\r\n\t\r\n  if (!parseInt(obj.value,10) && obj.value != 0)\t{\r\n    alert(\"Please enter valid Number\");\r\n    obj.value = '';\r\n    obj.focus();\r\n    obj.select();\r\n  } else {\r\n    obj.value = '' + parseInt(obj.value,10);\r\n  }\r\n}\r\n\r\nUSAGE:\r\n<input type=\"text\" name=\"txtSalary\" size=\"6\" value=\"\"            onkeyup=\"Javascript:CheckNum(this);\">\r\n","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["Numeric Text","Keypress"]},{"RecordId":"564","Title":"Determining IE's Start Page","Description":"Shows the location in the registry where IE's start page is kept","Code":"HKEY_CURRENT_USER\r\n  Software\r\n    Microsoft\r\n      Internet Explorer\r\n        Main -> Value is store in \"Start Page\" variable\r\n","Declares":"","CodeCategory":{"CategoryId":"2","CategoryDescription":"Web"},"Keywords":["IE Start Page","Registry"]},{"RecordId":"565","Title":"HTML Encode/Decode Text String","Description":"Applies HTML encoding rules to a string of text (changes < to &lt;), etc.","Code":"'----------------------------------------------------------------------\r\n'  1 of 2:  Encode\r\n'----------------------------------------------------------------------\r\n' Applies HTML encoding rules to the specified Text and returns the result\r\n'\r\n' Optionally specify if we're encoding a HREF link and the character\r\n' to use for encoding - the default is the standard ampersand\r\n' e.g. Server.HTMLEncode\r\n' i.e. Call MsgBox(HTMLEncodeEx(\"<Sample HTML encoded text>\")) \r\n\r\nPublic Function HTMLEncodeEx(ByVal Text As String, Optional ByVal vfHREFEncode _\r\n    As Boolean = False, Optional ByVal vstrAmpChar As String = \"&\") As String\r\n    \r\n    Dim abytTokens() As Byte\r\n    Dim lngTotal As Long\r\n    Dim lngCount As Long\r\n    Dim astrReturn() As String\r\n    Dim strReturn As String\r\n    \r\n    strReturn = Text\r\n    \r\n    If Trim$(strReturn) <> \"\" Then\r\n        ' convert to an array\r\n        abytTokens = StrConv(Text, vbFromUnicode)\r\n        \r\n        lngTotal = UBound(abytTokens)\r\n        \r\n        ' dimension enough space for the return\r\n        ReDim astrReturn(lngTotal)\r\n        \r\n        For lngCount = 0 To lngTotal\r\n            Select Case abytTokens(lngCount)\r\n                Case 32\r\n                    If vfHREFEncode Then\r\n                        astrReturn(lngCount) = \"%20\"\r\n                    Else\r\n                        astrReturn(lngCount) = vstrAmpChar & \"nbsp;\"\r\n                    End If\r\n                Case 34\r\n                    astrReturn(lngCount) = vstrAmpChar & \"quot;\"\r\n                Case 38\r\n                    astrReturn(lngCount) = vstrAmpChar & \"amp;\"\r\n                Case 60\r\n                    astrReturn(lngCount) = vstrAmpChar & \"lt;\"\r\n                Case 62\r\n                    astrReturn(lngCount) = vstrAmpChar & \"gt;\"\r\n                Case 32 To 127\r\n                    ' don't touch alphanumeric chars\r\n                    astrReturn(lngCount) = Chr$(abytTokens(lngCount))\r\n                Case Else\r\n                    astrReturn(lngCount) = vstrAmpChar & \"#\" & CStr(abytTokens _\r\n                        (lngCount)) & \";\"\r\n            End Select\r\n        Next ' lngCount\r\n        strReturn = Join(astrReturn, \"\")\r\n    \r\n        Erase astrReturn\r\n    End If\r\n    \r\n    ' join the return tokens together\r\n    HTMLEncodeEx = strReturn\r\n    \r\nEnd Function\r\n\r\n'----------------------------------------------------------------------\r\n'  2 of 2:  Encode\r\n'----------------------------------------------------------------------\r\n' Decodes HTML encoding applied to the specified Text and returns the result\r\n' Optionally specify if we encoded a HREF link and the character\r\n' used for encoding - the default is the standard ampersand\r\n\r\n' i.e. Call MsgBox(HTMLDecodeEx(\"&lt;Sample&nbsp;HTML&nbsp;Decoded&nbsp;Text&gt;\"\r\n' & \"\"))\r\n\r\nPublic Function HTMLDecodeEx(ByVal Text As String, Optional ByVal vfHREFDecode _\r\n    As Boolean = False, Optional ByVal vstrAmpChar As String = \"&\") As String\r\n    \r\n    Dim astrTokens() As String\r\n    Dim lngTotal As Long\r\n    Dim lngCount As Long\r\n    Dim strToken As String\r\n    Dim strCode As String\r\n    Dim lngPos As Long\r\n    Dim astrReturn() As String\r\n    Dim strReturn As String\r\n    \r\n    strReturn = Text\r\n    \r\n    If Trim$(strReturn) <> \"\" Then\r\n        ' tokenize the text\r\n        astrTokens = Split(Text, vstrAmpChar, -1, vbTextCompare)\r\n            \r\n        lngTotal = UBound(astrTokens)\r\n        \r\n        ' create enough space for the return\r\n        ReDim astrReturn(lngTotal)\r\n        \r\n        For lngCount = 0 To lngTotal\r\n            ' look for the end of the token\r\n            strToken = astrTokens(lngCount)\r\n            lngPos = InStr(1, strToken, \";\", vbTextCompare)\r\n            If (lngPos = 0) Then\r\n                astrReturn(lngCount) = strToken\r\n            Else\r\n                strCode = Mid$(strToken, 1, lngPos)\r\n                Select Case strCode\r\n                    Case \"nbsp;\"\r\n                        astrReturn(lngCount) = \" \" & Mid$(strToken, lngPos + 1)\r\n                    Case \"quot;\"\r\n                        astrReturn(lngCount) = \"\"\"\" & Mid$(strToken, lngPos + 1)\r\n                    Case \"amp;\"\r\n                        astrReturn(lngCount) = vstrAmpChar & Mid$(strToken, _\r\n                            lngPos + 1)\r\n                    Case \"lt;\"\r\n                        astrReturn(lngCount) = \"<\" & Mid$(strToken, lngPos + 1)\r\n                    Case \"gt;\"\r\n                        astrReturn(lngCount) = \">\" & Mid$(strToken, lngPos + 1)\r\n                    Case Else\r\n                        ' see if it's\r\n                        If Left$(strToken, 1) = \"#\" Then\r\n                            astrReturn(lngCount) = Chr$(Mid$(strToken, 2, _\r\n                                lngPos - 2)) & Mid$(strToken, lngPos + 1)\r\n                        Else\r\n                            astrReturn(lngCount) = strToken\r\n                        End If\r\n                End Select\r\n            End If\r\n        Next ' lngCount\r\n        \r\n        Erase astrTokens\r\n        \r\n        strReturn = Join(astrReturn, \"\")\r\n    \r\n        Erase astrReturn\r\n    End If\r\n    \r\n    HTMLDecodeEx = strReturn\r\n    \r\nEnd Function\r\n\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"2","CategoryDescription":"Web"},"Keywords":["HTML Encode","HTML Decode"]},{"RecordId":"566","Title":"URL Encode/Decode Text String","Description":"Same effect as Server.URLEncode and Server.URLDecode","Code":"'------------------------------------------------------------\r\n'  1 of 2\r\n'------------------------------------------------------------\r\n\r\n' Applies URL encoding rules to the specified Text and returns the result\r\n' (similar to Server.URLEncode)\r\n\r\nPublic Function URLEncodeEx(ByVal Text As String) As String\r\n    \r\n    Dim abytTokens() As Byte\r\n    Dim lngTotal As Long\r\n    Dim lngCount As Long\r\n    Dim astrReturn() As String\r\n    Dim strReturn As String\r\n    \r\n    strReturn = Text\r\n    \r\n    If Trim$(strReturn) <> \"\" Then\r\n        ' convert to an array\r\n        abytTokens = StrConv(Text, vbFromUnicode)\r\n        \r\n        lngTotal = UBound(abytTokens)\r\n        \r\n        ' dimension enough space for the return\r\n        ReDim astrReturn(lngTotal)\r\n        \r\n        For lngCount = 0 To lngTotal\r\n            Select Case abytTokens(lngCount)\r\n                Case 48 To 57, 65 To 90, 97 To 122\r\n                    ' don't touch alphanumeric chars\r\n                    astrReturn(lngCount) = Chr$(abytTokens(lngCount))\r\n                Case 32\r\n                    astrReturn(lngCount) = \"+\"\r\n                Case Else\r\n                    If abytTokens(lngCount) < 16 Then\r\n                        astrReturn(lngCount) = \"%0\" & Hex$(abytTokens(lngCount))\r\n                    Else\r\n                        astrReturn(lngCount) = \"%\" & Hex$(abytTokens(lngCount))\r\n                    End If\r\n            End Select\r\n        Next ' lngCount\r\n        strReturn = Join(astrReturn, \"\")\r\n    \r\n        Erase astrReturn\r\n        Erase abytTokens\r\n    End If\r\n    \r\n    ' join the return tokens together\r\n    URLEncodeEx = strReturn\r\n    \r\nEnd Function\r\n\r\n'------------------------------------------------------------\r\n'  2 of 2\r\n'------------------------------------------------------------\r\n' Decodes URL encoding applied to the specified Text and returns the result\r\n\r\nPublic Function URLDecodeEx(ByVal Text As String) As String\r\n        \r\n    Dim abytTokens() As Byte\r\n    Dim lngTotal As Long\r\n    Dim lngCount As Long\r\n    Dim astrReturn() As String\r\n    Dim strReturn As String\r\n    Dim strHex As String\r\n    Dim strDec As String\r\n    \r\n    strReturn = Text\r\n    \r\n    If Trim$(strReturn) <> \"\" Then\r\n        ' convert to an array\r\n        abytTokens = StrConv(Text, vbFromUnicode)\r\n        \r\n        lngTotal = UBound(abytTokens)\r\n        \r\n        ' dimension enough space for the return\r\n        ReDim astrReturn(lngTotal)\r\n        \r\n        For lngCount = 0 To lngTotal\r\n            Select Case abytTokens(lngCount)\r\n                Case 43\r\n                    ' +\r\n                    astrReturn(lngCount) = \" \"\r\n                Case 37\r\n                    ' %\r\n                    If ((lngCount + 1) <= lngTotal) And ((lngCount + 2) <= _\r\n                        lngTotal) Then\r\n                        strHex = Chr$(abytTokens(lngCount + 1)) & Chr$ _\r\n                            (abytTokens(lngCount + 2))\r\n                        If strHex <> \"\" Then\r\n                            strDec = Chr$(Val(\"&H\" & strHex))\r\n                            astrReturn(lngCount) = strDec\r\n                            lngCount = lngCount + 2\r\n                        End If\r\n                    End If\r\n                Case Else\r\n                    astrReturn(lngCount) = Chr$(abytTokens(lngCount))\r\n            End Select\r\n        Next ' lngCount\r\n        strReturn = Join(astrReturn, \"\")\r\n    \r\n        Erase astrReturn\r\n    End If\r\n    \r\n    ' join the return tokens together\r\n    URLDecodeEx = strReturn\r\n    \r\nEnd Function\r\n","Declares":"","CodeCategory":{"CategoryId":"2","CategoryDescription":"Web"},"Keywords":["URL Encode","URL Decode"]},{"RecordId":"567","Title":"Get, Update, Save Data Using Client-Side XML (XMLHTTP)","Description":"Demonstrates how to retrieve an ADO recordset from a server, modify it, & send it back as a stream of binary data using the IXMLHTTPRequest object.\r\n\r\nNOTE:  The cool part is that it uses client-side JavaScipt & XMLHTTP instead of posting an HTML form.","Code":"This code consists of 2 parts (2 ASP files).  \r\nFile 1 (Sender.asp) contains client-side code to get the data, modify it, and send it back to SQL.  File 2 (Receiver.asp) catches the request from Sender.asp and either retrieves a recordset or saves the recordset.\r\n\r\n'---------------------------------------------------------------------------------------------------------------------\r\nFile 1 - Sender.asp\r\n'---------------------------------------------------------------------------------------------------------------------\r\n\r\n<SCRIPT ID=clientEventHandlersJS LANGUAGE=javascript>\r\n<!--\r\n\r\nvar rs;\r\nvar xmldoc; \r\nvar xmlstream;\r\n\r\nfunction SendRS_onclick() {\r\n\txmlstream = new ActiveXObject(\"ADODB.Stream\");\r\n\txmlstream.Mode = 3; //read write\r\n\txmlstream.Open();\r\n\txmlstream.Type = 1; // adTypeBinary\r\n\trs.Save(xmlstream,0); //adpersistadtg\r\n   \tvar xmlhttp = new ActiveXObject(\"Msxml2.XMLHTTP\");\r\n   \txmlhttp.Open(\"POST\",\"http://localhost/Receiver.asp?getRecordset=NO\",false);\r\n\txmlhttp.setRequestHeader(\"Content-Length\",xmlstream.Size); //set the length of the content\r\n   \txmlhttp.send(xmlstream.Read(xmlstream.Size)); //Send the stream\r\n   \talert(xmlhttp.responseText);\r\n}\r\n\r\nfunction getRS_onclick() {\r\n\trs = new ActiveXObject(\"ADODB.Recordset\");\r\n\txmldoc = new ActiveXObject(\"Msxml2.DOMDocument\");\r\n   \tvar xmlhttp = new ActiveXObject(\"Msxml2.XMLHTTP\");\r\n   \txmlhttp.Open(\"Get\",\"http://localhost/Receiver.asp?getRecordset=YES\",false);\r\n   \txmlhttp.send();\r\n   \txmldoc.loadXML(xmlhttp.responseText); //load the returned stream into the dom document\r\n   \trs.Open(xmldoc); //load the dom document into the recordset\r\n   \talert(\"Recordset Loaded\");\r\n}\r\n\r\nfunction Update_onclick() {\r\n\talert(\"before: \" + rs.Fields(2).Value);\r\n\trs.Fields(2).Value = rs.Fields(2).Value + \"!\";\r\n\trs.Update();\r\n\talert(\"after: \" + rs.Fields(2).Value);\r\n}\r\n\r\n//-->\r\n</SCRIPT>\r\n<INPUT type=\"button\" value=\"Get Recordset\" id=getRS name=getRS LANGUAGE=javascript onclick=\"return getRS_onclick()\">\r\n<INPUT type=\"button\" value=\"Update\" id=Update name=Update LANGUAGE=javascript onclick=\"return Update_onclick()\">\r\n<INPUT type=\"button\" value=\"Send Recordset\" id=SendRS name=SendRS LANGUAGE=javascript onclick=\"return SendRS_onclick()\"> \r\n\r\n\r\n'---------------------------------------------------------------------------------------------------------------------\r\nFile 2 - Receiver.asp.\r\n'---------------------------------------------------------------------------------------------------------------------\r\n\r\n<%\r\ndim Connection\r\ndim rs\r\nConnection = \"Provider=SQLOLEDB.1;Data Source=servername;User Id=username;Password=password;Initial Catalog=Northwind;\"\r\nsql =  \"Select * from Customers\"\r\n\r\nset rs = server.CreateObject(\"ADODB.Recordset\")\r\n\r\nif Request.QueryString(\"getRecordset\") = \"YES\" then\r\n\trs.ActiveConnection = Connection\r\n\trs.CursorLocation = 3 'Client Side\r\n\trs.CursorType = 3 'Static Recordset\r\n\trs.LockType = 4 'Batch Optimistic\r\n\trs.Open sql\r\n\trs.Save response, 1 'persist adPersistXML\r\n\tResponse.End\r\nelse\r\n\trs.open Request '.BinaryRead(Request.TotalBytes)\r\n\trs.activeconnection = Connection 'Reconnect\r\n\trs.updatebatch 'Update adAffectAll\r\n\trs.close\r\n\tResponse.Write \"Recordset Saved\" 'Send back response\r\n\tResponse.End\r\nend if\r\n\r\n%>","Declares":"","CodeCategory":{"CategoryId":"8","CategoryDescription":"XML"},"Keywords":["XMLHTTP","Client-side XML"]},{"RecordId":"568","Title":"Prevent Page Caching (Prefered 2)","Description":"Prefered headers for no caching","Code":"<%\r\n\r\nResponse.CacheControl = \"Private\"\r\nResponse.AddHeader \"Pragma\", \"no-cache\"\r\nResponse.Expires = -1 \r\nResponse.Buffer = True\r\n\r\n%>\r\n","Declares":"","CodeCategory":{"CategoryId":"2","CategoryDescription":"Web"},"Keywords":["Page Caching","Headers","No-Cache"]},{"RecordId":"569","Title":"List Directory Contents to a File","Description":"List contents of a directory to a file.  \r\nNOTE: dir /s won't format the output file as well as dir /s /b does.  The \"/b\" switch causes the listing to have the complete path immediately ahead of the file name.","Code":"dir *.* /s /b > file_out.txt","Declares":"","CodeCategory":{"CategoryId":"7","CategoryDescription":"Misc"},"Keywords":["Directory Listing","List Files"]},{"RecordId":"570","Title":"Validating Phone Numbers","Description":"Regular Expression for validating a phone number","Code":"Validates a phone number in the form:  (XXX) XXX-XXXX\r\n\r\n\\([0-9]{3}\\) [0-9]{3}-[0-9]{4}\r\n \r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"15","CategoryDescription":"Regular Expressions"},"Keywords":["Phone Number"]},{"RecordId":"571","Title":"Registry Settings for Making NT Boot With NumLock On","Description":"Registry settings for making NT boot with NumLock on","Code":"You can control whether the NumLock key is automatically on or off at logon using the following Windows NT / Windows 2000 / Windows XP registry hack: \r\n  Hive: HKEY_CURRENT_USER\r\n  Key: Control Panel\\Keyboard\r\n  Name: InitialKeyboardIndicators\r\n  Type: REG_DWORD\r\n  Value: 0 NumLock disabled for current user after logging on\r\n  Value: 2 NumLock enabled and will retain the settings from the last shutdown \r\n\r\nNumLock doesn't reflect these setting during the logon phase because at that point, NT is using the .Default user profile since it does not know which user is logging on. Make the same changes to HKEY_USERS\\.DEFAULT\\Control Panel\\Keyboard if you want the NumLock state to be consistent throughout. \r\n\r\nThe best, and non-registry editing method to set InitialKeyboardIndicators, is to set NumLock on, then use Alt-Ctrl-Del to log off. It should remember state for the account. \r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"7","CategoryDescription":"Misc"},"Keywords":["NumLock"]},{"RecordId":"573","Title":"Print Current Frame","Description":"Demonstrates how to use a \"Print\" button to print the current frame","Code":"<!-- THREE STEPS TO INSTALL FRAME PRINT:\r\n\r\n  1.  Set up your frames (example below)\r\n  2.  Copy the coding into the HEAD of your HTML document for one frame\r\n  3.  Add the last code into the BODY of your HTML document for the same frame  -->\r\n\r\n\r\n<!-- STEP ONE: Set up your frames -->\r\n\r\n<frameset cols=\"100,*\">\r\n<frame src=\"frame-left.htm\" name=\"frame1\">\r\n<frame src=\"frame-right.htm\" name=\"frame2\">\r\n</frameset>\r\n\r\n\r\n<!-- STEP TWO: Paste this code into the HEAD of your HTML document for the first frame  -->\r\n\r\n<SCRIPT LANGUAGE=\"JavaScript\">\r\n\r\n\tfunction myprint() {\r\n\t\twindow.parent.frame2.focus();\r\n\t\twindow.print();\r\n\t}\r\n\r\n</script>\r\n\r\n\r\n<!-- STEP THREE: Copy this code into the BODY of your HTML document of the frame that you want to print -->\r\n\r\n<input type=button value=\"Print Right Frame\" onClick=\"myprint()\">","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["Print Current Frame","Printing"]},{"RecordId":"574","Title":"Print Current Frame (IE & Netscape)","Description":"Demonstrates how to print a specific frame","Code":"<!--  The is the frameset -->\r\n<HTML>\r\n<HEAD><TITLE>An Example</TITLE></HEAD>\r\n<FRAMESET COLS=\"30%, *\">\r\n<FRAME SRC=\"991123b.html\" NAME=\"control\">\r\n<FRAME SRC=\"991123c.html\" NAME=\"main\">\r\n</FRAMESET>\r\n</HTML>\r\n\r\n<!--  Netscape -->\r\nWith any of these statements, Navigator prints the content of the \"main\" frame. Note that it isn't possible to print the parent document with Navigator, so if you call parent.print() the browser ignores the statement.\r\n\r\nparent.main.print();\r\nparent.frames.main.print();\r\nparent.frames[\"main\"].print();\r\nparent.frames[1].print(); // main is the second frame\r\n\r\n<!--  IE -->\r\nInternet Explorer is a different story. Regardless of the specified window object, the browser prints the frame that currently has focus. The Print dialog box enables the user to change the selection.\r\n\r\nparent.main.focus();\r\nparent.main.print();","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["Print Current Frame","Printing"]},{"RecordId":"575","Title":"Create a Page With a Hidden Frame","Description":"Demonstrates how to create a page with a hidden and a visible frame","Code":"This is the frameset\r\n<HTML>\r\n<HEAD>\r\n<TITLE>Page with two frames - One hidden, one visible</TITLE>\r\n</HEAD>\r\n<FRAMESET FRAMESPACING=\"0\" BORDER=\"false\" ROWS=\"1,*\" FRAMEBORDER=\"0\">\r\n  <FRAME NAME=\"hidden\" SCROLLING=\"no\" NORESIZE TARGET=\"main\" SRC=\"page1.htm\" MARGINWIDTH=\"1\" MARGINHEIGHT=\"1\">\r\n  <FRAME NAME=\"visible\" src=\"page2.htm\" scrolling=\"auto\">\r\n  <NOFRAMES>\r\n  <BODY>\r\n  <P>This page uses frames, but your browser doesn't support them.</P>\r\n  </BODY>\r\n  </NOFRAMES>\r\n</FRAMESET>\r\n</HTML>\r\n\r\n\r\nThis is the code for the invisible frame:\r\n<HTML>\r\n<HEAD>\r\n<TITLE>INVISIBLE FRAME</TITLE>\r\n</HEAD>\r\n<BODY>\r\n</BODY>\r\n</HTML>\r\n\r\n\r\nThis is the code for the visible frame:\r\n<HTML>\r\n<HEAD>\r\n<TITLE>VISIBLE FRAME</TITLE>\r\n</HEAD>\r\n<BODY>\r\n<P>Hello World. There are two frames on this page. The first one is invisible.</P>\r\n</BODY>\r\n</HTML>","Declares":"","CodeCategory":{"CategoryId":"9","CategoryDescription":"HTML"},"Keywords":["Hidden Frame","Frameset"]},{"RecordId":"576","Title":"Fix() Method - Returns a Number Rounded to Number Of Digits","Description":"This adds a fix method to the JavaScript number object. The fix() method returns the number rounded to the specified number of digits.","Code":"For example, \r\n        var n=1.14752\r\n        n.fix(0) // 1\r\n        n.fix(1) // 1.1\r\n        n.fix(2) // 1.15\r\n        n.fix(3) // 1.148\r\n        n.fix(4) // 1.1475\r\n        n.fix(5) // 1.14752\r\n\r\nNumber.fix() Method Code\r\nfunction _fix(dig) {\r\n // dig specifies how many digits\r\n // Invalid values default to 0.\r\n if ((dig<0) || (dig==null) || (isNaN(dig))) dig=0\r\n var power = Math.pow(10,dig)\r\n return Math.round(this.valueOf()*power)/power;\r\n}\r\nNumber.prototype.fix = _fix      \r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["Fix()","Number of Digits","Format"]},{"RecordId":"577","Title":"Date Object Enhancements","Description":"Adds three new methods to the JavaScript Date Object:\r\n  weekOf - Returns first day of week for a given date\r\n  strDay - Returns the day as a string\r\n  strMonth - Returns the month as a string","Code":"Demonstration Code\r\n // Outputs the week this page was created\r\n var d = new Date(\"8/9/1997\");\r\n d  = d.weekOf();\r\n document.write(d.strDay() +\", \" + d.strMonth() +\" \" + d.getDate()+\".\")\r\n\r\n\r\n\r\nDate Methods Code\r\n // The following code adds three methods to the built-in Date object\r\n function _strMonth() {\r\n  var months = new Array(\"January\", \"February\", \"March\", \"April\",\r\n     \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \r\n     \"November\", \"December\");\r\n  return months[this.getMonth()];\r\n }\r\n\r\n function _strDay() {\r\n  var days= new Array(\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \r\n      \"Thursday\", \"Friday\", \"Saturday\");\r\n  return days[this.getDay()];\r\n }\r\n\r\n function _weekOf() {\r\n  sunday = ((arguments[0]==null) || (!arguments[0])); // Check for optional argument\r\n  return (new Date(this - ((this.getDay() - ((sunday) ? 0 : 1)) *24*60*60*1000)));\r\n }\r\n\r\n // Add these methods to all dates\r\n Date.prototype.weekOf = _weekOf;\r\n Date.prototype.strMonth = _strMonth;\r\n Date.prototype.strDay = _strDay;\r\n","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["Date Functions"]},{"RecordId":"578","Title":"JavaScript - Object Oriented Encapsulation/Inheritance Example","Description":"JavaScript object that illustrates both prototype-based inheritance and encapsulation.","Code":"/* ------------------------------------------------------------------------------------------------\r\n How to use it\r\n------------------------------------------------------------------------------------------------ */\r\nvar myLocalObject = new myObject('abc', 'def');\r\n\r\nmyLocalObject.setProp1 'abc'\r\nvar strMyVar = myLocalObject.getProp1()\r\n\r\n/* ------------------------------------------------------------------------------------------------\r\n This is the actual object code\r\n------------------------------------------------------------------------------------------------ */\r\nfunction myObject(param1,param2){\r\n\r\n   //Private Member Variables\r\n   var prop1 = null;\r\n   var prop2 = null;\r\n   setProp1(param1);\r\n   setProp2(param2);\r\n\r\n   //Private Read Only Member Variable\r\n   var prop3 = null;\r\n   setProp3(\"read only\");\r\n\r\n   //Public Method Pointers for Getters/Setters\r\n   this.getProp1 = getProp1;\r\n   this.setProp1 = setProp1;\r\n   this.getProp2 = getProp2;\r\n   this.setProp2 = setProp2;\r\n   this.getProp3 = getProp3;\r\n\r\n   //Public Method Pointers for other Actions\r\n   this.getProps = getProps;\r\n   this.testPrivateMethod = testPrivateMethod;\r\n\r\n   //Public Methods (they all have pointers)\r\n   //Getters and Setters\r\n   function getProp1(){\r\n      return prop1;\r\n   }\r\n   function setProp1(parameter){\r\n      prop1 = parameter;\r\n   }\r\n   function getProp2(){\r\n      return prop2;\r\n   }\r\n   function setProp2(parameter){\r\n      prop2 = parameter;\r\n   }\r\n   function getProp3(){\r\n      return prop3;\r\n   }\r\n   //Setter for prop3 is private&#151;no method pointer\r\n   function setProp3(parameter){\r\n      prop3 = parameter;\r\n   }\r\n\r\n   //Other Actions\r\n   function getProps(){\r\n      return \"prop1: \" + this.getProp1() + \"\\nprop2: \" + this.getProp2() + \"\\nprop3: \" + \r\n             this.getProp3();\r\n   }\r\n   function testPrivateMethod(){\r\n      privateMethod();\r\n   }\r\n\r\n   //A Private Method -- no method pointer\r\n   function privateMethod(){\r\n      setProp1(\"new prop1\");\r\n      setProp2(\"new prop2\");\r\n   }\r\n}","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["Object Oriented","Prototype","Encapsulation"]},{"RecordId":"579","Title":"Clickable Labels for Radio Buttons and Check Boxes","Description":"This sample makes the labels of radio buttons and check boxes clickable, similar to the functionality of VB check boxes and radio buttons.","Code":"A.noLink {text-decoration:none; color:black}\r\n\r\nThis script starts off by setting a specific style for the labels. We want them to appear to be completely normal text, with no underlines and no special color identifying them as links. This style will apply to all links that have the class set to \"noLink\".\r\n\r\n\r\n<a href=\"javascript:toggleCheck('sun')\" class=\"noLink\">\r\n   <input type= \"checkbox\" name= \"sun\">Sun<BR>\r\n</a> \r\n\r\nThe HTML for a checkbox is simple. We take a normal INPUT tag and its associated label (\"Sun\"), and wrap it inside a ANCHOR (link) tag associated with the \"noLink\" style that we just created. Now, clicking on anything inside that tag causes the JavaScript function toggleCheck() to run, and in this particular example, passes the parameter \"sun\" to match the name of the checkbox.\r\n\r\n\r\n<a href=\"javascript:toggleRadio('colorChoice','red')\" class=\"noLink\">\r\n   <input type=\"radio\" name=\"colorChoice\" value= \"red\">Red<BR>\r\n</a> \r\n\r\nHere's the HTML for a radio button. Again, there's the INPUT tag and associated label (\"Red\"), wrapped inside an ANCHOR tag. In this case, if the user clicks on the text, it'll call the JavaScript function toggleRadio(). This example passes in two parameters, \"colorChoice\" and \"red\", to match the name and value, respectively, of the radio button.\r\n\r\n\r\nfunction toggleCheck(thisField) {\r\n   checkSet = eval(\"document.myForm.\" + thisField);\r\n   checkSet.checked = !(checkSet.checked);\r\n} \r\n\r\nHere's the entire toggleCheck() function. The parameter thisField is used to pass in the name of the checkbox field. By combining the field name with the hard-coded name of the form, you can get a reference to the actual object (instead of just a string). The script stores the object reference in the variable checkSet. Checkbox objects have a property called checked, which returns true when the checkbox is checked and false when it isn't. We're just going to toggle it from true to false or vice versa, by means of the ! (Boolean NOT) operator. Resetting the checked property updates the visual representation of the checkbox in the form automatically.\r\n\r\n\r\nfunction toggleRadio(thisField,thisValue) {\r\n   radioSet = eval(\"document.myForm.\"+thisField);\r\n   for (i=0;i < radioSet.length;i++) {\r\n      if (radioSet[i].value == thisValue)\r\n         radioSet[i].checked = true\r\n   }\r\n}\r\n\r\nThe function toggleRadio() is more complex, but not by much. This function accepts two parameters: thisField, which is the name of the radio button, and thisValue, the value of the radio button. Again, we start off by obtaining an object reference by querying the document for the object name formed by combining thisField with the form name. The resulting script stores the resulting JavaScript object in the variable radioSet. That field, however, is an array, not a single field. That means that we have to have a loop through the possible values to see which particular radio button should be set. The property radioSet.length gives the number of radio buttons in the array, and we can then compare radioSet[i].value to the thisValue parameter to see if it matches. If it does, then radioSet[i].checked is set to true, which automatically turns the previously set radio button off and redisplays the form fields.","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["Clickable Labels","Radio Buttons","Check Boxes"]},{"RecordId":"580","Title":"Simulate \"Locked\" Property of Text Box","Description":"The \"locked\" does not exist for HTML controls.","Code":"<INPUT TYPE=\"text\" NAME=\"output\" SIZE=\"30\" onFocus=\"this.blur()\">","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["Locked"]},{"RecordId":"581","Title":"Stay On Top","Description":"Make a browser instance stay on top of all other windows.","Code":"Use the following on the window that you want ot keep on top\r\n<body onblur=\"self.focus()\">\r\n","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["Stay on top","Top"]},{"RecordId":"582","Title":"JavaScript Library","Description":"Collection of great JavaScript functions such as DaysInMonth, Chr, Abs, Len, etc, etc.","Code":"/*************************************************************************************\r\n\tJavaScript Library  v1.0.03\r\n\r\n\tA recopilation of the best FREE Javascript functions.\r\n\r\n\tThe code exposed here has been found all over the Internet and considered Public \r\n\tDomain. Please feel free to pass this Library to all your friends. This library\r\n\tworks with browsers that doesnt support Javascript1.2\r\n\r\n\tLast Modified: 08/01/2000 Bryan Bensing\r\n *************************************************************************************/\r\n\r\n/**************************************************************\r\n DetectBrowser: Return a string that contains the current \r\n                browser name and version used.\r\n\r\n Parameters:\r\n\r\n Returns: String\r\n***************************************************************/\r\nfunction DetectBrowser()\r\n{\r\n\tvar temp = navigator.appName;\r\n\ttemp = temp.toLowerCase();\r\n\r\n\tif (temp == 'microsoft internet explorer')\r\n\t\treturn 'IE' + navigator.appVersion\r\n\telse\r\n\t\treturn 'NS' + navigator.appVersion;\r\n}\r\n\r\n/**************************************************************\r\n OpenURL: Return a concatenated string with all the 'objects\r\n          values' contained in a FORM HTML in the format:\r\n          page_to_redirect.html/asp?object1=xxxx&object2=yyyyy&...\r\n\r\n Parameters:\r\n      URL  = URL to redirect\r\n      Form = Form name (be sure not to use QUOTES when passing\r\n             the Form name)\r\n\r\n Returns: URL\r\n\r\n Example: var redirect = OpenURL('mytest.asp', frmMyForm)\r\n          alert(redirect)\r\n          window.nagivate(redirect)\r\n***************************************************************/\r\nfunction OpenURL(URL, Form)\r\n{\r\n\tif (URL.length == 0 || URL == null)\r\n\t\treturn (false);\r\n\r\n\tvar form_length = Form.elements.length;\r\n\tvar myform = Form;\r\n\tvar mytype = '';\r\n\tvar temp = URL + '?';\r\n\r\n\tfor (var i = 0; i < form_length; i++)\r\n\t{\r\n\t\tmytype = myform.elements[i].type\r\n\t\tmytype = mytype.toLowerCase();\r\n\t\tif (mytype == 'text' || mytype == 'hidden' || mytype == 'select-one' ||\r\n\t\t    mytype == 'checkbox' || mytype == 'radio' || mytype == 'select-multiple')\r\n\t\t{\r\n\t\t\tvar t = myform.elements[i].name\r\n\t\t\tif (t == null || t == '')\r\n\t\t\t\tt = myform.elements[i].id\r\n\t\t\tif (mytype == 'text' || mytype == 'hidden')\r\n\t\t\t\ttemp = temp + t + \"=\" + escape(myform.elements[i].value);\r\n\t\t\telse if (mytype == 'checkbox' || mytype == 'radio')\r\n\t\t\t\ttemp = temp + t + \"=\" + escape(myform.elements[i].checked);\r\n\t\t\telse if (mytype == 'select-one' || mytype == 'select-multiple')\r\n\t\t\t\ttemp = temp + t + \"=\" + escape(myform.elements[i][myform.elements[i].selectedIndex].value);\r\n\t\t\tif (i < form_length - 1)\r\n\t\t\t\ttemp = temp + \"&\";\r\n\t\t}\r\n\t}\r\n\ttemp = temp.substring(temp, temp.length - 1)\r\n\r\n\treturn temp;\r\n} \r\n\r\n/**************************************************************\r\n DaysInMonth: Return number of days in a month.\r\n\r\n Parameters:\r\n      dDate = Date to process. If date is null, false is\r\n              returned.\r\n\r\n Returns: Integer\r\n***************************************************************/\r\nfunction DaysInMonth(dDate)\r\n{\r\n\tif (dDate == null)\r\n\t\treturn (false);\r\n\r\n\tdDate = new Date(dDate)\r\n\r\n\tvar dt1, cmn1, cmn2, dtt, lflag, dycnt\r\n\tvar temp1 = dDate.getMonth() + 1;\r\n\tvar temp2 = dDate.getYear();\r\n\tdt1 = new Date(temp2, temp1 - 1, 1)\r\n\tcmn1 = dt1.getMonth()\r\n\tdtt = dt1.getTime() + 2332800000\r\n\tlflag = true\r\n\tdycnt = 28\r\n\twhile (lflag)\r\n\t{\r\n\t\tdtt = dtt + 86400000\r\n\t\tdt1.setTime(dtt)\r\n\t\tcmn2 = dt1.getMonth()\r\n\t\tif (cmn1 != cmn2)\r\n\t\t\tlflag = false\r\n\t\telse\r\n\t\t\tdycnt = dycnt + 1;\r\n\t}\r\n\tif (dycnt > 31)\r\n\t\tdycnt = 31;\r\n\r\n    return dycnt;\r\n}\r\n\r\n/**************************************************************\r\n Abs: Returns a value of the same type that is passed to it \r\n      specifying the absolute value of a number.\r\n\r\n Parameters:\r\n      Number = The required number argument can be any valid \r\n               numeric expression. If number contains Null, \r\n               false is returned; if it is an uninitialized \r\n               variable, false is returned.\r\n\r\n Returns: Long\r\n***************************************************************/\r\nfunction Abs(Number)\r\n{\r\n\tNumber = Number.toLowerCase();\r\n\tRefString = \"0123456789.-\";\r\n\r\n\tif (Number.length < 1) \r\n\t\treturn (false);\r\n\r\n\tfor (var i = 0; i < Number.length; i++) \r\n\t{\r\n\t\tvar ch = Number.substr(i, 1)\r\n\t\tvar a = RefString.indexOf(ch, 0)\r\n\t\tif (a == -1)\r\n\t\t\treturn (false);\r\n\t}\r\n\r\n\tif (Number < 0)\r\n\t\treturn (Number * -1)\r\n\r\n\treturn Number;\r\n}\r\n\r\n/**************************************************************\r\n Len: Returns a Long containing the number of characters in a \r\n      string or the number of bytes required to store a \r\n      variable.\r\n\r\n Parameters:\r\n      string = Any valid string expression. If string contains \r\n               null, false is returned.\r\n\r\n Returns: Long\r\n***************************************************************/\r\nfunction Len(string)\r\n{\r\n\tif (string == null)\r\n\t\treturn (false);\r\n\r\n\treturn String(string).length;\r\n}\r\n\r\n/**************************************************************\r\n Chr: Returns a String containing the character associated \r\n      with the specified character code.\r\n\r\n Parameters:\r\n      CharCode = Long that identifies a character.\r\n\r\n Returns: String\r\n***************************************************************/\r\nfunction Chr(CharCode)\r\n{\r\n\treturn String.fromCharCode(CharCode);\r\n}\r\n\r\n/**************************************************************\r\n Asc: Returns an Integer representing the character code \r\n      corresponding to the first letter in a string\r\n\r\n Parameters:\r\n      String = The required string argument is any valid \r\n               string expression. If the string if not in \r\n               the range 32-126, the function return ZERO\r\n\r\n Returns: Integer\r\n***************************************************************/\r\nfunction Asc(string)\r\n{\r\n\tvar symbols = \" !\\\"#$%&'()*+'-./0123456789:;<=>?@\";\r\n\tvar loAZ = \"abcdefghijklmnopqrstuvwxyz\";\r\n\tsymbols += loAZ.toUpperCase();\r\n\tsymbols += \"[\\\\]^_`\";\r\n\tsymbols += loAZ;\r\n\tsymbols += \"{|}~\";\r\n\tvar loc;\r\n\tloc = symbols.indexOf(string);\r\n\tif (loc > -1)\r\n\t{ \r\n\t\tAscii_Decimal = 32 + loc;\r\n\t\treturn (32 + loc);\r\n\t}\r\n\treturn (0);\r\n}\r\n\r\n/**************************************************************\r\n LTrim: Returns a String containing a copy of a specified \r\n        string without leading spaces \r\n\r\n Parameters:\r\n      String = The required string argument is any valid \r\n               string expression. If string contains null, \r\n               false is returned\r\n\r\n Returns: String\r\n***************************************************************/\r\nfunction LTrim(String)\r\n{\r\n\tvar i = 0;\r\n\tvar j = String.length - 1;\r\n\r\n\tif (String == null)\r\n\t\treturn (false);\r\n\r\n\tfor (i = 0; i < String.length; i++)\r\n\t{\r\n\t\tif (String.substr(i, 1) != ' ' &&\r\n\t\t    String.substr(i, 1) != '\\t')\r\n\t\t\tbreak;\r\n\t}\r\n\r\n\tif (i <= j)\r\n\t\treturn (String.substr(i, (j+1)-i));\r\n\telse\r\n\t\treturn ('');\r\n}\r\n\r\n/**************************************************************\r\n RTrim: Returns a String containing a copy of a specified \r\n        string without trailing spaces \r\n\r\n Parameters:\r\n      String = The required string argument is any valid \r\n               string expression. If string contains null, \r\n               false is returned\r\n\r\n Returns: String\r\n***************************************************************/\r\nfunction RTrim(String)\r\n{\r\n\tvar i = 0;\r\n\tvar j = String.length - 1;\r\n\r\n\tif (String == null)\r\n\t\treturn (false);\r\n\r\n\tfor(j = String.length - 1; j >= 0; j--)\r\n\t{\r\n\t\tif (String.substr(j, 1) != ' ' &&\r\n\t\t\tString.substr(j, 1) != '\\t')\r\n\t\tbreak;\r\n\t}\r\n\r\n\tif (i <= j)\r\n\t\treturn (String.substr(i, (j+1)-i));\r\n\telse\r\n\t\treturn ('');\r\n}\r\n\r\n/**************************************************************\r\n RTrim: Returns a String containing a copy of a specified \r\n        string without both leading and trailing spaces \r\n\r\n Parameters:\r\n      String = The required string argument is any valid \r\n               string expression. If string contains null, \r\n               false is returned\r\n\r\n Returns: String\r\n***************************************************************/\r\nfunction Trim(String)\r\n{\r\n\tif (String == null)\r\n\t\treturn (false);\r\n\r\n\treturn RTrim(LTrim(String));\r\n}\r\n\r\n/**************************************************************\r\n Left: Returns a String containing a specified number of \r\n       characters from the left side of a string.\r\n\r\n Parameters:\r\n      String = String expression from which the leftmost \r\n               characters are returned. If string contains null, \r\n               false is returned.\r\n      Length = Numeric expression indicating how many characters \r\n               to return. If 0, a zero-length string (\"\") is \r\n               returned. If greater than or equal to the number \r\n               of characters in string, the entire string is \r\n               returned. \r\n\r\n Returns: String\r\n***************************************************************/\r\nfunction Left(String, Length)\r\n{\r\n\tif (String == null)\r\n\t\treturn (false);\r\n\r\n\treturn String.substr(0, Length);\r\n}\r\n\r\n/**************************************************************\r\n Right: Returns a String containing a specified number of \r\n        characters from the right side of a string.\r\n\r\n Parameters:\r\n      String = String expression from which the leftmost \r\n               characters are returned. If string contains null, \r\n               false is returned.\r\n      Length = Numeric expression indicating how many characters \r\n               to return. If 0, a zero-length string (\"\") is \r\n               returned. If greater than or equal to the number \r\n               of characters in string, the entire string is \r\n               returned. \r\n\r\n Returns: String\r\n***************************************************************/\r\nfunction Right(String, Length)\r\n{\r\n\tif (String == null)\r\n\t\treturn (false);\r\n\r\n    var dest = '';\r\n    for (var i = (String.length - 1); i >= 0; i--)\r\n\t\tdest = dest + String.charAt(i);\r\n\r\n\tString = dest;\r\n\tString = String.substr(0, Length);\r\n\tdest = '';\r\n\r\n    for (var i = (String.length - 1); i >= 0; i--)\r\n\t\tdest = dest + String.charAt(i);\r\n\r\n\treturn dest;\r\n}\r\n\r\n/**************************************************************\r\n Mid: Returns a String containing a specified number of \r\n      characters from a string\r\n\r\n Parameters:\r\n      String = String expression from which characters are \r\n               returned. If string contains null, false is \r\n               returned.\r\n      Start  = Number. Character position in string at which \r\n               the part to be taken begins. If Start is \r\n               greater than the number of characters in \r\n               string, Mid returns a zero-length string (\"\").\r\n      Length = Number of characters to return. If omitted \r\n               false is returned. \r\n\r\n Returns: String\r\n***************************************************************/\r\nfunction Mid(String, Start, Length)\r\n{\r\n\tif (String == null)\r\n\t\treturn (false);\r\n\r\n\tif (Start > String.length)\r\n\t\treturn '';\r\n\r\n\tif (Length == null || Length.length == 0)\r\n\t\treturn (false);\r\n\r\n\treturn String.substr((Start - 1), Length);\r\n}\r\n\r\n/**************************************************************\r\n InStr: Returns a Long specifying the position of the first \r\n        occurrence of one string within another. Is String1\r\n        or String2 are null, false is returned.\r\n\r\n Parameters:\r\n      String1 = String expression being searched.\r\n      String2 = String expression sought\r\n\r\n Returns: Integer\r\n***************************************************************/\r\nfunction InStr(String1, String2)\r\n{\r\n\tvar a = 0;\r\n\r\n\tif (String1 == null || String2 == null)\r\n\t\treturn (false);\r\n\r\n\tString1 = String1.toLowerCase();\r\n\tString2 = String2.toLowerCase();\r\n\r\n\ta = String1.indexOf(String2);\r\n\tif (a == -1)\r\n\t\treturn 0;\r\n\telse\r\n\t\treturn a + 1;\r\n}\r\n\r\n/**************************************************************\r\n Sgn: Returns an Integer indicating the sign of a number. If\r\n      Integer is not a number the functions return false.\r\n\r\n Parameters:\r\n      Integer = The number argument can be any valid numeric \r\n                expression.\r\n\r\n Returns: Integer       -1 If Integer < 0\r\n                         0 If Integer = 0\r\n                         1 If Integer > 0\r\n                     false If Parameter IS NOT NUMERIC\r\n***************************************************************/\r\nfunction Sgn(Integer)\r\n{\r\n\tNumber = Integer.toLowerCase();\r\n\tRefString = \"0123456789-\";\r\n\r\n\tif (Number.length < 1) \r\n\t\treturn (false);\r\n\r\n\tfor (var i = 0; i < Number.length; i++) \r\n\t{\r\n\t\tvar ch = Number.substr(i, 1)\r\n\t\tvar a = RefString.indexOf(ch, 0)\r\n\t\tif (a == -1)\r\n\t\t\treturn (false);\r\n\t}\r\n\tif (Integer < 0)\r\n\t\treturn (-1);\r\n\telse if (Integer == 0)\r\n\t\treturn (0);\r\n\telse\r\n\t\treturn (1);\r\n}\r\n\r\n/**************************************************************\r\n LBound: Returns a Long containing the smallest available \r\n         subscript for the indicated dimension of an array\r\n\r\n Parameters:\r\n      array = Array to verify\r\n\r\n Returns: Integer       (-1 if Array does not contain\r\n                            any subscript)\r\n***************************************************************/\r\nfunction LBound(array)\r\n{\r\n\tvar i = 0;\r\n\tvar temp = '';\r\n\r\n\tif (array.length == 0)\r\n\t\treturn (-1);\r\n\r\n\tfor (i = 0; i < array.length; i++)\r\n\t{\r\n\t\ttemp = array[i]\r\n\t\tif (temp != null)\r\n\t\t{\r\n\t\t\tvar temp = i;\r\n\t\t\treturn temp;\r\n\t\t}\r\n\t}\r\n\treturn (-1);\r\n}\r\n\r\n/**************************************************************\r\n UBound: Returns a Long containing the largest available \r\n         subscript for the indicated dimension of an array\r\n\r\n Parameters:\r\n      array = Array to verify\r\n\r\n Returns: Integer       (-1 if Array does not contain\r\n                            any subscript)\r\n***************************************************************/\r\nfunction UBound(array)\r\n{\r\n\treturn (array.length - 1);\r\n}\r\n\r\n/**************************************************************\r\n Join: Returns a string created by joining a number of \r\n       substrings contained in an array.\r\n\r\n Parameters:\r\n      array     = One-dimensional array containing substrings \r\n                  to be joined\r\n      Delimiter = String character used to separate the \r\n                  substrings in the returned string. \r\n                  If delimiter is a zero-length string (\"\"), \r\n                  all items in the list are concatenated \r\n                  with no delimiters. \r\n\r\n Returns: String\r\n***************************************************************/\r\nfunction Join(array, Delimiter)\r\n{\r\n\tvar temp = '';\r\n\r\n\tif (array.length == 0)\r\n\t\treturn '';\r\n\r\n\tif (Delimiter.length == 0)\r\n\t\tDelimiter = ' ';\r\n\r\n\tfor (var i = 0; i < array.length; i++)\r\n\t{\r\n\t\ttemp = temp + array[i]\r\n\t\tif (i < array.length - 1)\r\n\t\t\ttemp = temp + Delimiter;\r\n\t}\r\n\treturn temp;\r\n}\r\n\r\n/**************************************************************\r\n ReturnString: Returns a String containing a repeating \r\n               character string of the length specified\r\n\r\n Parameters:\r\n      Number    = Length of the returned string. If number \r\n                  is less than 1, false is returned.\r\n      Character = Character code specifying the character or \r\n                  string expression whose first character is \r\n                  used to build the return string. If character \r\n                  contains null, false is returned. \r\n\r\n Returns: String\r\n***************************************************************/\r\nfunction ReturnString(Number, Character)\r\n{\r\n\tvar temp = '';\r\n\r\n\tif (Number < 1)\r\n\t\treturn (false);\r\n\r\n\tif (Character.length == 0)\r\n\t\treturn (false);\r\n\r\n\tif (Character.length > 1)\r\n\t\tCharacter = Character.charAt(0);\r\n\r\n\tfor (var i = 0; i < Number; i++)\r\n\t{\r\n\t\ttemp = temp + Character\r\n\t}\r\n\r\n\treturn temp;\r\n}\r\n\r\n/**************************************************************\r\n Split: Returns a zero-based, one-dimensional array containing \r\n        a specified number of substrings\r\n\r\n Parameters:\r\n      Expression = String expression containing substrings and \r\n                   delimiters. If expression is a zero-length \r\n                   string(\"\"), Split returns an empty array, \r\n                   that is, an array with no elements and no \r\n                   data.\r\n      Delimiter  = String character used to identify substring \r\n                   limits. If delimiter is a zero-length \r\n                   string (\"\"), a single-element array \r\n                   containing the entire expression string \r\n                   is returned.\r\n\r\n Returns: String\r\n***************************************************************/\r\nfunction Split(Expression, Delimiter)\r\n{\r\n\tvar temp = Expression;\r\n\tvar a, b = 0;\r\n\tvar array = new Array();\r\n\r\n\tif (Delimiter.length == 0)\r\n\t{\r\n\t\tarray[0] = Expression;\r\n\t\treturn (array);\r\n\t}\r\n\r\n\tif (Expression.length == '')\r\n\t{\r\n\t\tarray[0] = Expression;\r\n\t\treturn (array);\r\n\t}\r\n\r\n\tDelimiter = Delimiter.charAt(0);\r\n\r\n\tfor (var i = 0; i < Expression.length; i++) \r\n\t{\r\n\t\ta = temp.indexOf(Delimiter);\r\n\t\tif (a == -1)\r\n\t\t{\r\n\t\t\tarray[i] = temp;\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tb = (b + a) + 1;\r\n\t\t\tvar temp2 = temp.substring(0, a);\r\n\t\t\tarray[i] = temp2;\r\n\t\t\ttemp = Expression.substr(b, Expression.length - temp2.length);\r\n\t\t}\r\n\t}\r\n\r\n\treturn (array);\r\n}\r\n\r\n/**************************************************************\r\n Space: Returns a String consisting of the specified number \r\n        of spaces\r\n\r\n Parameters:\r\n      Number = Number of spaces you want in the string.\r\n\r\n Returns: String\r\n***************************************************************/\r\nfunction Space(Number)\r\n{\r\n\tvar temp = '';\r\n\r\n\tif (Number < 1)\r\n\t\treturn '';\r\n\r\n\tfor (var i = 0; i < Number; i++)\r\n\t{\r\n\t\ttemp = temp + ' ';\r\n\t}\r\n\treturn temp;\r\n}\r\n\r\n/**************************************************************\r\n Replace: Returns a string in which a specified substring has \r\n          been replaced with another substring a specified \r\n          number of times.\r\n\r\n Parameters:\r\n      Expression = String expression containing substring to \r\n                   replace\r\n      Find       = Substring being searched for.\r\n      Replace    = Replacement substring.\r\n\r\n Returns: String\r\n***************************************************************/\r\nfunction Replace(Expression, Find, Replace)\r\n{\r\n\tvar temp = Expression;\r\n\tvar a = 0;\r\n\r\n\tfor (var i = 0; i < Expression.length; i++) \r\n\t{\r\n\t\ta = temp.indexOf(Find);\r\n\t\tif (a == -1)\r\n\t\t\tbreak\r\n\t\telse\r\n\t\t\ttemp = temp.substring(0, a) + Replace + temp.substring((a + Find.length));\r\n\t}\r\n\r\n\treturn temp;\r\n}\r\n\r\n/**************************************************************\r\n IsChar: Returns a Boolean value indicating whether an \r\n         expression can be evaluated as a character (this \r\n         not only includes alpha chars but all symbols such as\r\n         @#$%^&|\\_+-/*=\"!?,.:;'(){}<>[]\r\n\r\n Parameters:\r\n    - Expression = Variant containing a numeric expression or \r\n                   string expression.\r\n\r\n Returns: Boolean\r\n***************************************************************/\r\nfunction IsChar(Expression)\r\n{\r\n\tExpression = Expression.toLowerCase();\r\n\tRefString = \"0123456789\";\r\n\r\n\tif (Expression.length < 1) \r\n\t\treturn (false);\r\n\r\n\tfor (var i = 0; i < Expression.length; i++) \r\n\t{\r\n\t\tvar ch = Expression.substr(i, 1)\r\n\t\tvar a = RefString.indexOf(ch, 0)\r\n\t\tif (a != -1)\r\n\t\t\treturn (false);\r\n\t}\r\n\treturn(true);\r\n}\r\n\r\n/**************************************************************\r\n IsNumber: Returns a Boolean value indicating whether an \r\n           expression can be evaluated as a number (this\r\n           includes values like $15,656.00)\r\n\r\n Parameters:\r\n      Expression = Variant containing a numeric expression or \r\n                   string expression.\r\n\r\n Returns: Boolean\r\n***************************************************************/\r\nfunction IsNumber(Expression)\r\n{\r\n\tExpression = Expression.toLowerCase();\r\n\tRefString = \"0123456789.-\";\r\n\r\n\tif (Expression.length < 1) \r\n\t\treturn (false);\r\n\r\n\tfor (var i = 0; i < Expression.length; i++) \r\n\t{\r\n\t\tvar ch = Expression.substr(i, 1)\r\n\t\tvar a = RefString.indexOf(ch, 0)\r\n\t\tif (a == -1)\r\n\t\t\treturn (false);\r\n\t}\r\n\treturn(true);\r\n}\r\n\r\n/**************************************************************\r\n IsAlphanumeric: Returns a Boolean value indicating whether an \r\n                 expression can be evaluated as a number or\r\n                 char.\r\n\r\n Parameters:\r\n      Expression = Variant containing a numeric expression or \r\n                   string expression.\r\n\r\n Returns: Boolean\r\n***************************************************************/\r\nfunction IsAlphanumeric(Expression)\r\n{\r\n\tExpression = Expression.toLowerCase();\r\n\tRefString = \"abcdefghijklmnopqrstuvwxyz0123456789 \";\r\n\r\n\tif (Expression.length < 1) \r\n\t\treturn (false);\r\n\r\n\tfor (var i = 0; i < Expression.length; i++) \r\n\t{\r\n\t\tvar ch = Expression.substr(i, 1)\r\n\t\tvar a = RefString.indexOf(ch, 0)\r\n\t\tif (a == -1)\r\n\t\t\treturn (false);\r\n\t}\r\n\treturn(true);\r\n}\r\n\r\n/**************************************************************\r\n ReverseString: Returns a string in which the character order \r\n                of a specified string is reversed\r\n\r\n Parameters:\r\n      Expression = The expression argument is the string whose \r\n                   characters are to be reversed. If expression \r\n                   is a zero-length string (\"\"), a zero-length \r\n                   string is returned. If expression is null,\r\n                   false is returned.\r\n\r\n Returns: String\r\n***************************************************************/\r\nfunction ReverseString(Expression)\r\n{\r\n\tif (Expression == null)\r\n\t\treturn (false);\r\n\r\n    var dest = '';\r\n    for (var i = (Expression.length - 1); i >= 0; i--)\r\n\t\tdest = dest + Expression.charAt(i);\r\n    return dest;\r\n}\r\n\r\n/**************************************************************\r\n StrConv: Returns a String converted as specified in the\r\n          Parameters Section.\r\n\r\n Parameters:\r\n      String     = String expression to be converted.\r\n      Conversion = Number specifying the type of conversion \r\n                   to perform.\r\n                   1 = TO UPPER CASE\r\n                   2 = to lower case\r\n                   3 = To Proper Case\r\n                   If Conversion is null or not specified 1\r\n                   is set as default.\r\n\r\n Returns: String\r\n***************************************************************/\r\nfunction StrConv(String, Conversion)\r\n{\r\n\tvar index;\r\n\tvar tmpStr;\r\n\tvar tmpChar;\r\n\tvar preString;\r\n\tvar postString;\r\n\tvar strlen;\r\n\r\n\tif (Conversion == null || Conversion.length == 0)\r\n\t\tConversion = '1';\r\n\r\n\tif (Conversion != '1' && Conversion != '2' && Conversion != '3')\r\n\t\tConversion = '1';\r\n\r\n\tif (Conversion == '1')\r\n\t\treturn String.toUpperCase();\r\n\r\n\tif (Conversion == '2')\r\n\t\treturn String.toLowerCase();\r\n\r\n\t//Proper Case\r\n\ttmpStr = String.toLowerCase();\r\n\tstrLen = tmpStr.length;\r\n\tif (strLen > 0)\r\n\t{\r\n\t\tfor (index = 0; index < strLen; index++)\r\n\t\t{\r\n\t\t\tif (index == 0)\r\n\t\t\t{\r\n\t\t\t\ttmpChar = tmpStr.substring(0, 1).toUpperCase();\r\n\t\t\t\tpostString = tmpStr.substring(1, strLen);\r\n\t\t\t\ttmpStr = tmpChar + postString;\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\ttmpChar = tmpStr.substring(index, index + 1);\r\n\t\t\t\tif (tmpChar == \" \" && index < (strLen - 1))\r\n\t\t\t\t{\r\n\t\t\t\t\ttmpChar = tmpStr.substring(index + 1, index + 2).toUpperCase();\r\n\t\t\t\t\tpreString = tmpStr.substring(0, index + 1);\r\n\t\t\t\t\tpostString = tmpStr.substring(index + 2,strLen);\r\n\t\t\t\t\ttmpStr = preString + tmpChar + postString;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn tmpStr;\r\n}\r\n\r\n/**************************************************************\r\n ComboAdd: Add a new item to a SELECT HTML object at runtime.\r\n\r\n Parameters:\r\n      Object = SELECT Object ID\r\n      Value  = Value of the String ... <option VALUE=\"?????\">....</option>\r\n      String = String to add.\r\n\r\n Returns: None\r\n***************************************************************/\r\nfunction ComboAdd(Object, Value, String)\r\n{\r\n\tValue = Trim(Value)\r\n\tString = Trim(String)\r\n\r\n\tif (Value.length < 1 || String.length < 1)\r\n\t\treturn false\r\n\r\n\tObject[Object.length] = new Option(String, Value);\r\n\tObject.selectedIndex = Object.length;\r\n}\r\n\r\n/**************************************************************\r\n ComboDel: Delete the current/selected item from a SELECT \r\n           HTML object at runtime.\r\n\r\n Parameters:\r\n      Object = SELECT Object ID\r\n\r\n Returns: None\r\n***************************************************************/\r\nfunction ComboDel(Object)\r\n{\r\n\tvar selected_index = Object.selectedIndex\r\n\tif (selected_index >= 0)\r\n\t{\r\n\t\tObject.options[Object.selectedIndex] = null;\r\n\t\tif (selected_index > 0)\r\n\t\t\tObject.selectedIndex = selected_index\r\n\t\telse\r\n\t\t\tObject.selectedIndex = 0;\r\n\t}\r\n}\r\n\r\n/**************************************************************\r\n FormatNumber: Returns an expression formatted as a number.\r\n\r\n Parameters:\r\n      Expression            = Expression to be formatted.\r\n      NumDigitsAfterDecimal = Numeric value indicating how\r\n                              many places to the right of the\r\n                              decimal are displayed.\r\n\r\n Returns: String\r\n***************************************************************/\r\nfunction FormatNumber(Expression, NumDigitsAfterDecimal)\r\n{\r\n\tvar iNumDecimals = NumDigitsAfterDecimal;\r\n\tvar dbInVal = Expression;\r\n\tvar bNegative = false;\r\n\tvar iInVal = 0;\r\n\tvar strInVal\r\n\tvar strWhole = \"\", strDec = \"\";\r\n\tvar strTemp = \"\", strOut = \"\";\r\n\tvar iLen = 0;\r\n\r\n\tif (dbInVal < 0)\r\n\t{\r\n\t\tbNegative = true;\r\n\t\tdbInVal *= -1;\r\n\t}\r\n\r\n\tdbInVal = dbInVal * Math.pow(10, iNumDecimals)\r\n\tiInVal = parseInt(dbInVal);\r\n\tif ((dbInVal - iInVal) >= .5)\r\n\t{\r\n\t\tiInVal++;\r\n\t}\r\n\tstrInVal = iInVal + \"\";\r\n\tstrWhole = strInVal.substring(0, (strInVal.length - iNumDecimals));\r\n\tstrDec = strInVal.substring((strInVal.length - iNumDecimals), strInVal.length);\r\n\twhile (strDec.length < iNumDecimals)\r\n\t{\r\n\t\tstrDec = \"0\" + strDec;\r\n\t}\r\n\tiLen = strWhole.length;\r\n\tif (iLen >= 3)\r\n\t{\r\n\t\twhile (iLen > 0)\r\n\t\t{\r\n\t\t\tstrTemp = strWhole.substring(iLen - 3, iLen);\r\n\t\t\tif (strTemp.length == 3)\r\n\t\t\t{\r\n\t\t\t\tstrOut = \",\" + strTemp + strOut;\r\n\t\t\t\tiLen -= 3;\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tstrOut = strTemp + strOut;\r\n\t\t\t\tiLen = 0;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (strOut.substring(0, 1) == \",\")\r\n\t\t{\r\n\t\t\tstrWhole = strOut.substring(1, strOut.length);\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tstrWhole = strOut;\r\n\t\t}\r\n\t}\r\n\tif (bNegative)\r\n\t{\r\n\t\treturn \"-\" + strWhole + \".\" + strDec;\r\n\t}\r\n\telse\r\n\t{\r\n\t\treturn strWhole + \".\" + strDec;\r\n\t}\r\n}\r\n\r\n/**************************************************************\r\n FormatCurrency: Returns an expression formatted as a currency \r\n                 value using the currency symbol $.\r\n\r\n Parameters:\r\n      Expression = Expression to be formatted.\r\n\r\n Returns: String\r\n***************************************************************/\r\nfunction FormatCurrency(Expression)\r\n{\r\n\tvar iNumDecimals = 2;\r\n\tvar dbInVal = Expression;\r\n\tvar bNegative = false;\r\n\tvar iInVal = 0;\r\n\tvar strInVal\r\n\tvar strWhole = \"\", strDec = \"\";\r\n\tvar strTemp = \"\", strOut = \"\";\r\n\tvar iLen = 0;\r\n\r\n\tif (dbInVal < 0)\r\n\t{\r\n\t\tbNegative = true;\r\n\t\tdbInVal *= -1;\r\n\t}\r\n\r\n\tdbInVal = dbInVal * Math.pow(10, iNumDecimals)\r\n\tiInVal = parseInt(dbInVal);\r\n\tif ((dbInVal - iInVal) >= .5)\r\n\t{\r\n\t\tiInVal++;\r\n\t}\r\n\tstrInVal = iInVal + \"\";\r\n\tstrWhole = strInVal.substring(0, (strInVal.length - iNumDecimals));\r\n\tstrDec = strInVal.substring((strInVal.length - iNumDecimals), strInVal.length);\r\n\twhile (strDec.length < iNumDecimals)\r\n\t{\r\n\t\tstrDec = \"0\" + strDec;\r\n\t}\r\n\tiLen = strWhole.length;\r\n\tif (iLen >= 3)\r\n\t{\r\n\t\twhile (iLen > 0)\r\n\t\t{\r\n\t\t\tstrTemp = strWhole.substring(iLen - 3, iLen);\r\n\t\t\tif (strTemp.length == 3)\r\n\t\t\t{\r\n\t\t\t\tstrOut = \",\" + strTemp + strOut;\r\n\t\t\t\tiLen -= 3;\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tstrOut = strTemp + strOut;\r\n\t\t\t\tiLen = 0;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (strOut.substring(0, 1) == \",\")\r\n\t\t{\r\n\t\t\tstrWhole = strOut.substring(1, strOut.length);\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tstrWhole = strOut;\r\n\t\t}\r\n\t}\r\n\tif (bNegative)\r\n\t{\r\n\t\treturn \"-$\" + strWhole + \".\" + strDec;\r\n\t}\r\n\telse\r\n\t{\r\n\t\treturn \"$\" + strWhole + \".\" + strDec;\r\n\t}\r\n}\r\n\r\n/**************************************************************\r\n FormatPercent: Returns an expression formatted as a \r\n                percentage (multipled by 100) with a \r\n                trailing % character\r\n\r\n Parameters:\r\n      Expression = Expression to be formatted.\r\n\r\n Returns: String\r\n***************************************************************/\r\nfunction FormatPercent(Expression, NumDigitsAfterDecimal)\r\n{\r\n\tvar iNumDecimals = NumDigitsAfterDecimal;\r\n\tvar dbInVal = Expression * 100;\r\n\tvar bNegative = false;\r\n\tvar iInVal = 0;\r\n\tvar strInVal\r\n\tvar strWhole = \"\", strDec = \"\";\r\n\tvar strTemp = \"\", strOut = \"\";\r\n\tvar iLen = 0;\r\n\r\n\tif (dbInVal < 0)\r\n\t{\r\n\t\tbNegative = true;\r\n\t\tdbInVal *= -1;\r\n\t}\r\n\r\n\tdbInVal = dbInVal * Math.pow(10, iNumDecimals)\r\n\tiInVal = parseInt(dbInVal);\r\n\tif ((dbInVal - iInVal) >= .5)\r\n\t{\r\n\t\tiInVal++;\r\n\t}\r\n\tstrInVal = iInVal + \"\";\r\n\tstrWhole = strInVal.substring(0, (strInVal.length - iNumDecimals));\r\n\tstrDec = strInVal.substring((strInVal.length - iNumDecimals), strInVal.length);\r\n\twhile (strDec.length < iNumDecimals)\r\n\t{\r\n\t\tstrDec = \"0\" + strDec;\r\n\t}\r\n\tiLen = strWhole.length;\r\n\tif (iLen >= 3)\r\n\t{\r\n\t\twhile (iLen > 0)\r\n\t\t{\r\n\t\t\tstrTemp = strWhole.substring(iLen - 3, iLen);\r\n\t\t\tif (strTemp.length == 3)\r\n\t\t\t{\r\n\t\t\t\tstrOut = \",\" + strTemp + strOut;\r\n\t\t\t\tiLen -= 3;\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tstrOut = strTemp + strOut;\r\n\t\t\t\tiLen = 0;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (strOut.substring(0, 1) == \",\")\r\n\t\t{\r\n\t\t\tstrWhole = strOut.substring(1, strOut.length);\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tstrWhole = strOut;\r\n\t\t}\r\n\t}\r\n\tif (bNegative)\r\n\t{\r\n\t\treturn \"-\" + strWhole + \".\" + strDec + \"%\";\r\n\t}\r\n\telse\r\n\t{\r\n\t\treturn strWhole + \".\" + strDec + \"%\";\r\n\t}\r\n}\r\n\r\n/**************************************************************\r\n FormatDateTime: Returns an expression formatted as a date or \r\n                 time. If DateTime is null then false is\r\n                 returned.\r\n\r\n Parameters:\r\n      DateTime   = Date/Time expression to be formatted\r\n      FormatType = Numeric value that indicates the date/time \r\n                   format used. If omitted, GeneralDate is used\r\n                   0 = Very Long Date/Time Format (Mon Jul 10, 12:02:30 am EDT 2000)\r\n                   1 = Long Date/Time Format (Monday, July 10, 2000)\r\n                   2 = Short Date (1/10/00)\r\n                   3 = Long Time (4:20 PM)\r\n                   4 = Military Time (14:43)\r\n\r\n Returns: String\r\n***************************************************************/\r\nfunction FormatDateTime(DateTime, FormatType)\r\n{\r\n\tif (DateTime == null)\r\n\t\treturn (false);\r\n\r\n\tif (FormatType < 0)\r\n\t\tFormatType = 1;\r\n\r\n\tif (FormatType > 4)\r\n\t\tFormatType = 1;\r\n\r\n\tvar strDate = new String(DateTime);\r\n\r\n\tif (strDate.toUpperCase() == \"NOW\")\r\n\t{\r\n\t\tvar myDate = new Date();\r\n\t\tstrDate = String(myDate);\r\n\t}\r\n\telse\r\n\t{\r\n\t\tvar myDate = new Date(DateTime);\r\n\t\tstrDate = String(myDate);\r\n\t}\r\n\r\n\tvar Day = new String(strDate.substring(0, 3));\r\n\tif (Day == \"Sun\") Day = \"Sunday\";\r\n\tif (Day == \"Mon\") Day = \"Monday\";\r\n\tif (Day == \"Tue\") Day = \"Tuesday\";\r\n\tif (Day == \"Wed\") Day = \"Wednesday\";\r\n\tif (Day == \"Thu\") Day = \"Thursday\";\r\n\tif (Day == \"Fri\") Day = \"Friday\";\r\n\tif (Day == \"Sat\") Day = \"Saturday\";\t\r\n\r\n\tvar Month = new String(strDate.substring(4, 7)), MonthNumber = 0;\r\n\tif (Month == \"Jan\") { Month = \"January\"; MonthNumber = 1; }\r\n\tif (Month == \"Feb\") { Month = \"February\"; MonthNumber = 1; }\r\n\tif (Month == \"Mar\") { Month = \"March\"; MonthNumber = 1; }\r\n\tif (Month == \"Apr\") { Month = \"April\"; MonthNumber = 1; }\r\n\tif (Month == \"May\") { Month = \"May\"; MonthNumber = 1; }\r\n\tif (Month == \"Jun\") { Month = \"June\"; MonthNumber = 1; }\r\n\tif (Month == \"Jul\") { Month = \"July\"; MonthNumber = 1; }\r\n\tif (Month == \"Aug\") { Month = \"August\"; MonthNumber = 1; }\r\n\tif (Month == \"Sep\") { Month = \"September\"; MonthNumber = 1; }\r\n\tif (Month == \"Oct\") { Month = \"October\"; MonthNumber = 1; }\r\n\tif (Month == \"Nov\") { Month = \"November\"; MonthNumber = 1; }\r\n\tif (Month == \"Dec\") { Month = \"December\"; MonthNumber = 1; }\r\n\r\n\tvar curPos = 11;\r\n\tvar MonthDay = new String(strDate.substring(8, 10));\r\n\tif (MonthDay.charAt(1) == \" \")\r\n\t{\r\n\t\tMonthDay = \"0\" + MonthDay.charAt(0);\r\n\t\tcurPos--;\r\n\t}\t\r\n\r\n\tvar MilitaryTime = new String(strDate.substring(curPos, curPos + 5));\r\n\tvar Year = new String(strDate.substring(strDate.length - 4, strDate.length));\r\n\r\n\t// Format Type decision time!\r\n\tif (FormatType == 1)\r\n\t\tstrDate = Day + \", \" + Month + \" \" + MonthDay + \", \" + Year;\r\n\telse if (FormatType == 2)\r\n\t\tstrDate = MonthNumber + \"/\" + MonthDay + \"/\" + Year.substring(2,4);\r\n\telse if (FormatType == 3)\r\n\t{\r\n\t\tvar AMPM = MilitaryTime.substring(0,2) >= 12 && MilitaryTime.substring(0,2) != \"24\" ? \" PM\" : \" AM\";\r\n\t\tif (MilitaryTime.substring(0,2) > 12)\r\n\t\t\tstrDate = (MilitaryTime.substring(0,2) - 12) + \":\" + MilitaryTime.substring(3,MilitaryTime.length) + AMPM;\r\n\t\telse\r\n\t\t{\r\n\t\t\tif (MilitaryTime.substring(0,2) < 10)\r\n\t\t\t\tstrDate = MilitaryTime.substring(1,MilitaryTime.length) + AMPM;\r\n\t\t\telse\r\n\t\t\tstrDate = MilitaryTime + AMPM;\r\n\t\t}\r\n\t}\t\r\n\telse if (FormatType == 4)\r\n\t\tstrDate = MilitaryTime;\r\n\r\n\treturn strDate;\r\n}\r\n\r\n/**************************************************************\r\n Mask: Returns a Boolean if the specified Expression match\r\n       the specified Mask.\r\n\r\n Parameters:\r\n      Expression = String to validate\r\n      Mask       = String that can contain the following\r\n                   options:\r\n                   9 = only numbers (0..9)\r\n                   X = only letters (a..z or A..Z)\r\n                   * = Anything...\r\n Example: alert(Mask(\"(954) 572-4419\", \"(999) 999-9999\")); => TRUE\r\n          alert(Mask(\"33351-820\", \"99999-9999\"));          => FALSE\r\n          alert(Mask(\"This is a test\", \"XXXXXX\"));         => FALSE\r\n          alert(Mask(\"This 34 a test\", \"**************\")); => TRUE\r\n\r\n Returns: Boolean\r\n***************************************************************/\r\nfunction Mask(Expression, Mask)\r\n{\r\n\tMask = Mask.toUpperCase();\r\n\tLenStr = Expression.length;\r\n\tLenMsk = Mask.length;\r\n\tif ((LenStr == 0) || (LenMsk == 0))\r\n\t\treturn (false);\r\n\tif (LenStr != LenMsk)\r\n\t\treturn (false);\r\n\tTempString = '';\r\n\tfor (Count = 0; Count <= Expression.length; Count++)\r\n\t{\r\n\t\tStrChar = Expression.substring(Count, Count + 1);\r\n\t\tMskChar = Mask.substring(Count, Count + 1);\r\n\t\tif (MskChar == '9')\r\n\t\t{\r\n\t\t\tif(!IsNumber(StrChar))\r\n\t\t\t\treturn (false);\r\n\t\t}\r\n\t\telse if (MskChar == 'X')\r\n\t\t{\r\n\t\t\tif(!IsChar(StrChar))\r\n\t\t\t\treturn (false);\r\n\t\t}\r\n\t\telse if (MskChar == '*')\r\n\t\t{\r\n\t\t\tif(!IsAlphanumeric(StrChar))\r\n\t\t\t\treturn (false);\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tif (MskChar != StrChar) \r\n\t\t\t\treturn (false);\r\n\t\t}\r\n\t}\r\n\treturn (true);\r\n}\r\n\r\n/**************************************************************\r\n IsEmail: Returns a Boolean if the specified Expression is a\r\n          valid e-mail address. If Expression is null, false\r\n          is returned.\r\n\r\n Parameters:\r\n      Expression = e-mail to validate.\r\n\r\n Returns: Boolean\r\n***************************************************************/\r\nfunction IsEmail(Expression)\r\n{\r\n\tif (Expression == null)\r\n\t\treturn (false);\r\n\r\n\tvar supported = 0;\r\n\tif (window.RegExp)\r\n\t{\r\n\t\tvar tempStr = \"a\";\r\n\t\tvar tempReg = new RegExp(tempStr);\r\n\t\tif (tempReg.test(tempStr)) supported = 1;\r\n\t}\r\n\tif (!supported) \r\n\t\treturn (Expression.indexOf(\".\") > 2) && (Expression.indexOf(\"@\") > 0);\r\n\tvar r1 = new RegExp(\"(@.*@)|(\\\\.\\\\.)|(@\\\\.)|(^\\\\.)\");\r\n\tvar r2 = new RegExp(\"^.+\\\\@(\\\\[?)[a-zA-Z0-9\\\\-\\\\.]+\\\\.([a-zA-Z]{2,3}|[0-9]{1,3})(\\\\]?)$\");\r\n\treturn (!r1.test(Expression) && r2.test(Expression));\r\n}\r\n\r\n/**************************************************************\r\n DayOfWeek: Returns a String specifying a name of the day\r\n            for a given date.\r\n\r\n Parameters:\r\n      dDate = Date to evaluate. The Date can be one of the\r\n              following formats: '7/6/2000' or 'July 4, 1830'\r\n\r\n Returns: String\r\n***************************************************************/\r\nfunction DayOfWeek(dDate)\r\n{\r\n\tvar ar = new Array();\r\n\tar[0] = \"Sunday\";   ar[1] = \"Monday\"; ar[2] = \"Tuesday\";  ar[3] = \"Wednesday\";\r\n\tar[4] = \"Thursday\";\tar[5] = \"Friday\"; ar[6] = \"Saturday\";\r\n\tvar dow = new Date(dDate);\r\n\tvar day = dow.getDay();\r\n\treturn ar[day];\r\n}\r\n\r\n/**************************************************************\r\n AddDays: Returns a Date containing a date to which a \r\n          specified days interval has been added to the\r\n          current date.\r\n\r\n Parameters:\r\n      DaysToAdd = Numeric expression that is the interval of \r\n                  days you want to add to the actual date.\r\n\r\n Returns: Date/String\r\n***************************************************************/\r\nfunction AddDays(DaysToAdd)\r\n{\r\n\tvar newdate = new Date();\r\n\tvar newtimems = newdate.getTime() + (DaysToAdd * 24 * 60 * 60 * 1000);\r\n\tnewdate.setTime(newtimems);\r\n\treturn newdate.toLocaleString();\r\n}\r\n\r\n/**************************************************************\r\n AllowOnly: This function allow entering just the specified\r\n            Expression to a textbox or textarea control.\r\n\r\n Parameters:\r\n      Expression = Allowed characters.\r\n                   a..z => ONLY LETTERS\r\n                   0..9 => ONLY NUMBERS\r\n                   other symbols...\r\n\r\n Example: use the onKeyPress event to make this function work:\r\n          //Allows only from A to Z\r\n          onKeyPress=\"AllowOnly('a..z');\"\r\n\r\n          //Allows only from 0 to 9\r\n          onKeyPress=\"AllowOnly('0..9');\"\r\n\r\n          //Allows only A,B,C,1,2 and 3\r\n          onKeyPress=\"AllowOnly('abc123');\"\r\n\r\n          //Allows only A TO Z,@,#,$ and %\r\n          onKeyPress=\"AllowOnly('a..z|@#$%');\"\r\n\r\n\t\t  //Allows only A,B,C,0 TO 9,.,,,+ and -\r\n          onKeyPress=\"AllowOnly('ABC|0..9|.,+-');\"\r\n\r\n Remarks: Use the pipe \"|\" symbol to separate a..z from 0..9 and symbols\r\n\r\n Returns: None\r\n***************************************************************/\r\nfunction AllowOnly(Expression)\r\n{\r\n\tExpression = Expression.toLowerCase();\r\n\tExpression = Replace(Expression, 'a..z', 'abcdefghijklmnopqrstuvwxyz');\r\n\tExpression = Replace(Expression, '0..9', '0123456789');\r\n\tExpression = Replace(Expression, '|', '');\r\n\r\n\tvar ch = String.fromCharCode(window.event.keyCode);\r\n\tch = ch.toLowerCase();\r\n\tExpression = Expression.toLowerCase();\r\n\tvar a = Expression.indexOf(ch);\r\n\tif (a == -1) \r\n\t\twindow.event.keyCode = 0;\r\n}\r\n\r\n/**************************************************************\r\n LeapYear: Return a Boolean if the speficied Year is a Leap\r\n           Year\r\n\r\n Parameters:\r\n      Year = Numeric expression that represents the Year.\r\n\r\n Returns: Boolean\r\n***************************************************************/\r\nfunction LeapYear(Year)\r\n{    \r\n\tif(Year % 4 == 0 && Year % 100 != 0 || Year % 400 ==0)\r\n\t\treturn true;\r\n\treturn false;\r\n}\r\n\r\n/**************************************************************\r\n GeneratePopupMenu: Defines a new MENU for the right-click\r\n                    event. The arrMenu 'array' must have the\r\n                    following syntax:\r\n                    arrMenu('<tool_tip>'|'<function_to_call OR javascript_code>'|'<menu_string'>)\r\n\r\n Parameters:\r\n      arrMenu  = Array containing the NEW menu\r\n      FontFace = The font name (ie: Tahoma, Times New, Helvetica, etc).\r\n                 If FontFace is blank ('') or ('default') Tahoma\r\n                 font will be used\r\n      FontSize = The font size (8, 9, 12, 24, etc). If FontSize\r\n\t             is blank ('') or ('default') font size 8\r\n\t             will be used\r\n\r\n Returns: Nothing\r\n\r\n Remarks: - This menu works only with IE 4.01+\r\n          - Use <HR> to separate items in the menu\r\n\r\n Example:\r\n [body]\r\n\t[script language=javascript]\r\n\tvar arrM = new Array()\r\n\tarrM[0] = 'Cancel the current Order|btnCancelOrder_OnClick()|Cancel Order'\r\n\tarrM[1] = 'Refresh the Current page|window.location.reload()|Refresh Order'\r\n\tarrM[2] = '<hr>'\r\n\tarrM[3] = 'Search Products by Category|SearchProducts()|Search Products'\r\n\tarrM[4] = '<hr>'\r\n\tarrM[5] = 'Display the Agency Order History|AgencyOrderHistory()|Order History'\r\n\tarrM[6] = 'Shows the Agency Information|AgencyInfo()|Show Agency Info'\r\n\tarrM[7] = 'Add a new Agent to the Database|AddNewAgent()|Add New Agent'\r\n\tarrM[8] = '<hr>'\r\n\tarrM[9] = 'Enter your Name|var a=prompt(\"Enter your Name:\");showName(a)|Enter Name'\r\n\tarrM[10] = '<hr>'\r\n\tarrM[11] = 'Close this menu...|alert(\"This menu will be closed\")|Close this Menu'\r\n\r\n\tGeneratePopupMenu(arrM, '', '')\r\n\r\n\tfunction showName(a)\r\n\t{\r\n\t\t//This function will be called from the Popup menu//\r\n\t\talert('Hello' + a);\r\n\t}\r\n\t[/script]\r\n [/body]\r\n***************************************************************/\r\nfunction GeneratePopupMenu(arrMenu, FontFace, FontSize)\r\n{\r\n\tvar strTemp = ''\r\n\tvar A = new Array()\r\n\r\n\tif (FontFace.length == 0 || FontFace == '' || FontFace.toLowerCase() == 'default')\r\n\t\tFontFace = \"Tahoma\"\r\n\r\n\tif (FontSize.length == 0 || FontSize == 0 || FontSize == '' || FontSize.toLowerCase() == 'default')\r\n\t\tFontSize = \"8\"\r\n\r\n\tvar line_step = ((FontSize * 16) / 8)\r\n\r\n\tdocument.write('<style>')\r\n\tdocument.write('#MainMenu {border-top: 1px solid #D4D0C8; border-left: 1px solid LightGrey; border-right: 1px solid Black; border-bottom: 1px solid Black; position: absolute; visibility: hidden}')\r\n\tdocument.write('.MenuItem {border-top: 1px solid White; border-left: 1px solid White; border-right: 1px solid Gray; border-bottom: 1px solid Gray; line-height: ' + line_step + 'px; padding-left: 15px; padding-right: 15px; font-family: ' + FontFace + '; font-size: ' + FontSize + 'pt; background-color: #D4D0C8}')\r\n\tdocument.write('</style>')\r\n\r\n\tstrTemp = \"<div id='MainMenu' bgcolor='#D4D0C8'>\"\r\n\tstrTemp = strTemp + \"<table border='0' bgcolor='#D4D0C8' cellpadding='0' cellspacing='0' class='MenuItem' valign='top'>\"\r\n\r\n\tfor (var I = 0; I <= UBound(arrMenu); I++)\r\n\t{\r\n\t\tA = Split(arrMenu[I], \"|\")\r\n\t\tif (A[0].toLowerCase() != \"<hr>\")\r\n\t\t{\r\n\t\t\tstrTemp = strTemp + \"<tr><td valign='top' onmouseover='highlight()' onmouseout='lowlight()' style='cursor: hand' \"\r\n\t\t\tstrTemp = strTemp + \" toolTip='\" + A[0] + \"'\"\r\n\t\t\tstrTemp = strTemp + \" onClick='javascript:{HideMenu();\" + A[1] + \"}'>\"\r\n\t\t\tstrTemp = strTemp + A[2] + \"\"\r\n\t\t\tstrTemp = strTemp + \"</td></tr>\"\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tstrTemp = strTemp + \"<tr><td style='height: 3px; cursor: normal'></td></tr>\"\r\n\t\t\tstrTemp = strTemp + \"<tr><td bgcolor=gray style='height: 1px; cursor: normal'></td></tr>\"\r\n\t\t\tstrTemp = strTemp + \"<tr><td bgcolor=white style='height: 1px; cursor: normal'></td></tr>\"\r\n\t\t\tstrTemp = strTemp + \"<tr><td style='height: 3px; cursor: normal'></td></tr>\"\r\n\t\t}\r\n\t}\r\n\r\n\tstrTemp = strTemp + \"</table></div>\"\r\n\r\n\tdocument.write(strTemp)\r\n\r\n\tdocument.oncontextmenu = DisplayMenu\r\n\tif (document.all && window.print)\r\n\t\tdocument.body.onclick = HideMenu\r\n\r\n\treturn true\r\n}\r\n\r\nfunction highlight()\r\n{\r\n\tevent.srcElement.style.background = \"Navy\" //<= change value to change background color\r\n\tevent.srcElement.style.color = \"White\"     //<= change value to change fore color\r\n\tif (event.srcElement.toolTip != '')\r\n\t\twindow.status = event.srcElement.toolTip\r\n}\r\n\r\nfunction lowlight()\r\n{\r\n\tevent.srcElement.style.backgroundColor = \"#D4D0C8\"\r\n\tevent.srcElement.style.color = \"Black\"\r\n\twindow.status = ''\r\n}\r\n\r\nfunction DisplayMenu()\r\n{\r\n\tvar rightedge = document.body.clientWidth - event.clientX\r\n\tvar bottomedge = document.body.clientHeight - event.clientY\r\n\r\n\tif (rightedge < MainMenu.offsetWidth)\r\n\t\tMainMenu.style.left = document.body.scrollLeft + event.clientX - MainMenu.offsetWidth\r\n\telse\r\n\t\tMainMenu.style.left = document.body.scrollLeft + event.clientX\r\n\r\n\tif (bottomedge < MainMenu.offsetHeight)\r\n\t\tMainMenu.style.top = document.body.scrollTop + event.clientY - MainMenu.offsetHeight\r\n\telse\r\n\t\tMainMenu.style.top = document.body.scrollTop + event.clientY\r\n\r\n\tMainMenu.style.visibility = \"visible\"\r\n\treturn false\r\n}\r\n\r\nfunction HideMenu()\r\n{\r\n\tMainMenu.style.visibility = \"hidden\"\r\n}\r\n\r\n/**************************************************************\r\n IsDate: Returns a Boolean (true) if the date is true, false\r\n         is not\r\n\r\n Parameters:\r\n\t- DateStr: String date in format (MM/DD/YYYY)\r\n\r\n Returns: Boolean\r\n***************************************************************/\r\nfunction IsDate(dateStr)\r\n{\r\n\t// Checks for the following valid date formats:\r\n\t// MM/DD/YYYY   MM-DD-YYYY\r\n\r\n\tvar datePat = /^(\\d{1,2})(\\/|-)(\\d{1,2})\\2(\\d{4})$/;\r\n\r\n\tvar matchArray = dateStr.match(datePat)\r\n\tif (matchArray == null)\r\n\t\treturn false\r\n\r\n\tmonth = matchArray[1]\r\n\tday = matchArray[3]\r\n\tyear = matchArray[4]\r\n\tif (month < 1 || month > 12)\r\n\t\treturn false\r\n\r\n\tif (day < 1 || day > 31)\r\n\t\treturn false\r\n\r\n\tif ((month==4 || month==6 || month==9 || month==11) && day==31)\r\n\t\treturn false\r\n\r\n\tif (month == 2)\r\n\t{\r\n\t\tvar isleap = (year % 4 == 0 && (year % 100 != 0 || year % 400 == 0))\r\n\t\tif (day>29 || (day==29 && !isleap))\r\n\t\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\n/**************************************************************\r\n CheckBoxes: Checks, unchecks or switch the values of the\r\n             checkboxes in a form.\r\n\r\n Parameters:\r\n    - f_form: String. Name of the Form <FORM...>\r\n    - Start : Number: Checkbox to start with (0 to start from \r\n              the first one\r\n    - Length: Number: How many checkboxes after the Start \r\n              you want to check, uncheck or switch\r\n    - Method: Strign: c = Check, u = Uncheck, s = Switch\r\n\r\n Returns: None\r\n***************************************************************/\r\nfunction CheckBoxes(f_form, Start, Length, Method)\r\n{\r\n\tvar s_type = ''\r\n\r\n\tMethod = Method.toLowerCase()\r\n\r\n\tif (Start == 0) {Start = 0} else {Start = Start - 1}\r\n\tif (Length == 0) {Length = f_form.elements.length}\r\n\r\n\tfor (var i = Start; i < Start + Length; i++)\r\n\t{\r\n\t\ts_type = f_form.elements[i]\r\n\t\tif (s_type.type == 'checkbox')\r\n\t\t{\r\n\t\t\tif (Method == 'c')\r\n\t\t\t\ts_type.checked = true\r\n\t\t\tif (Method == 'u')\r\n\t\t\t\ts_type.checked = false\r\n\t\t\tif (Method == 's')\r\n\t\t\t\ts_type.checked = !s_type.checked\r\n\t\t}\r\n\t}\r\n\r\n\treturn\r\n}\r\n\r\n/**************************************************************\r\n DateDiff: Returns the Difference between two dates in weeks,\r\n           days, hours, minutes & seconds\r\n\r\n Parameters:\r\n    - Date1: First Date\r\n    - Date2: Second Data\r\n\r\n Returns: String containing the weeks, days, hours, minutes &\r\n          seconds between the two dates.\r\n***************************************************************/\r\nfunction DateDiff(Date1, Date2)\r\n{\r\n\tdate1 = new Date();\r\n\tdate2 = new Date();\r\n\tdiff  = new Date();\r\n\r\n\tdate1temp = new Date(Date1);\r\n\tdate1.setTime(date1temp.getTime());\r\n\tdate2temp = new Date(Date2);\r\n\tdate2.setTime(date2temp.getTime());\r\n\r\n\tdiff.setTime(Math.abs(date1.getTime() - date2.getTime()));\r\n\ttimediff = diff.getTime();\r\n\r\n\tweeks = Math.floor(timediff / (1000 * 60 * 60 * 24 * 7));\r\n\ttimediff -= weeks * (1000 * 60 * 60 * 24 * 7);\r\n\r\n\tdays = Math.floor(timediff / (1000 * 60 * 60 * 24)); \r\n\ttimediff -= days * (1000 * 60 * 60 * 24);\r\n\r\n\thours = Math.floor(timediff / (1000 * 60 * 60)); \r\n\ttimediff -= hours * (1000 * 60 * 60);\r\n\r\n\tmins = Math.floor(timediff / (1000 * 60)); \r\n\ttimediff -= mins * (1000 * 60);\r\n\r\n\tsecs = Math.floor(timediff / 1000); \r\n\ttimediff -= secs * 1000;\r\n\r\n\treturn (weeks + \" weeks, \" + days + \" days, \" + hours + \" hours, \" + mins + \" minutes, and \" + secs + \" seconds\");\r\n}\r\n\r\n/**************************************************************\r\n MinutesDiff: Returns the number of minutes between two dates.\r\n\r\n Parameters:\r\n    - Date1: First date\r\n    - Date2: Second data\r\n\r\n Returns: Number\r\n***************************************************************/\r\nfunction MinutesDiff(Date1, Date2)\r\n{\r\n\tdate1 = new Date();\r\n\tdate2 = new Date();\r\n\tdiff  = new Date();\r\n\r\n\tdate1temp = new Date(Date1);\r\n\tdate1.setTime(date1temp.getTime());\r\n\r\n\tdate2temp = new Date(Date2);\r\n\tdate2.setTime(date2temp.getTime());\r\n\r\n\tdiff.setTime(Math.abs(date1.getTime() - date2.getTime()));\r\n\ttimediff = diff.getTime();\r\n\r\n\tweeks = Math.floor(timediff / (1000 * 60 * 60 * 24 * 7));\r\n\ttimediff -= weeks * (1000 * 60 * 60 * 24 * 7);\r\n\r\n\tdays = Math.floor(timediff / (1000 * 60 * 60 * 24)); \r\n\ttimediff -= days * (1000 * 60 * 60 * 24);\r\n\r\n\thours = Math.floor(timediff / (1000 * 60 * 60)); \r\n\ttimediff -= hours * (1000 * 60 * 60);\r\n\r\n\tmins = Math.floor(timediff / (1000 * 60)); \r\n\ttimediff -= mins * (1000 * 60);\r\n\r\n\tsecs = Math.floor(timediff / 1000); \r\n\ttimediff -= secs * 1000;\r\n\r\n\treturn (mins + (hours * 60) + (days * 24 * 60) + (weeks * 7 * 24 * 60))\r\n}\r\n\r\n\r\n\r\n/**************************************************************\r\n                               Tips\r\n **************************************************************/\r\n\r\n/*\r\n - Want to keep a window in top of other? \r\n   use: <body onblur=\"self.focus()\"> on the window you want to\r\n        keep in top\r\n\r\n - Want to make a textbox read only?\r\n   use: <INPUT TYPE=\"text\" NAME=\"output\" SIZE=\"30\" onFocus=\"this.blur()\">\r\n\r\n - Want to highlight the whole textbox or textarea box?\r\n   use: <INPUT TYPE=\"text\" NAME=\"output\" SIZE=\"30\" onFocus=\"this.select();\">\r\n*/","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["JavaScript Library"]},{"RecordId":"584","Title":"IIS Host File (LMHost)","Description":"Location of LMHost file","Code":"c:\\winnt\\system32\\drivers\\etc\\lmhosts.sam\r\n","Declares":"","CodeCategory":{"CategoryId":"2","CategoryDescription":"Web"},"Keywords":["LMHost","Host"]},{"RecordId":"585","Title":"Date/Time Formatting Utilities","Description":"Date and time formatting utilities","Code":"'-------------------------------------------------------------------------------------\r\n' Determines the date of the Sunday of the week for the incoming date\r\n'-------------------------------------------------------------------------------------\r\nFunction GetSundayDate(strDateIn)\r\n\r\n\tdim intDayOfWeek\r\n\r\n\tintDayOfWeek = weekday(strDateIn, 1)\r\n\tintDayOfWeek = (intDayOfWeek * (-1)) + 1\r\n\r\n\tGetSundayDate = formatdate(dateadd(\"d\",strDateIn ,intDayOfWeek))\r\n\t\r\nEnd Function\r\n\r\n\r\n'-------------------------------------------------------------------------------------\r\n' Formats a date in mm/dd/yyyy format\r\n'-------------------------------------------------------------------------------------\r\nFunction FormatDate(strDateIn)\r\n\r\n\tFormatDate = datepart(\"m\", strDateIn) & \"/\" & datepart(\"d\", strDateIn) & \"/\" &  datepart(\"yyyy\", strDateIn)\r\n\t\r\nEnd Function\r\n\r\n\r\n'-------------------------------------------------------------------------------------\r\n' Returns a formatted \"hh:mm AM/PM\" string for the incoming 24-hour formatted time\r\n'-------------------------------------------------------------------------------------\r\nFunction FormatTime(intTime)\r\n\r\n\tdim strTime \r\n\r\n\tif intTime < 1000 then\r\n\t\tstrTime = cstr(intTime)\r\n\t\tFormatTime = left(strTime,1) & \":\" & right(strTime,2) & \" AM\"\r\n\telseif intTime < 1200 then\r\n\t\tstrTime = cstr(intTime)\r\n\t\tFormatTime = left(strTime,2) & \":\" & right(strTime,2) & \" AM\"\r\n\telseif intTime < 1300 then\r\n\t\tstrTime = cstr(intTime)\r\n\t\tFormatTime = left(strTime,2) & \":\" & right(strTime,2) & \" PM\"\r\n\telse\r\n\t\tstrTime = cstr(intTime - 1200)\r\n\t\tFormatTime = left(strTime,1) & \":\" & right(strTime,2) & \" PM\"\r\n\tend if\r\n\r\nEnd Function\r\n\r\n\r\n'-------------------------------------------------------------------------------------\r\n' Returns a mm/dd/yy formatted date for the incoming Sunday date and the requested day of the week\r\n'-------------------------------------------------------------------------------------\r\nFunction GetDate(strDateIn, intDayOfWeek)\r\n\r\n\tGetDate = formatdate(dateadd(\"d\", intDayOfWeek, strDateIn))\r\n\r\nEnd Function\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"5","CategoryDescription":"ASP"},"Keywords":["FormatDate","Date Utilities","Time Utilities"]},{"RecordId":"586","Title":"Execute DTS Package","Description":"Executes a DTS package","Code":"'----------------------------------------------------------------------------------------------------------------------\r\n'  NOTE:  Requires reference to Microsoft DTS Package Object Library\r\n'  \r\n'  Addtional VB samples can be found on SQL Server 7.0 CD in folder:\r\n'     \\devtools\\samples\\dts\\dtsempl1 or 2 or 3\r\n'----------------------------------------------------------------------------------------------------------------------\r\n\r\n\r\nDim oPackage As New DTS.Package\r\n\r\noPackage.LoadFromSQLServer sServerName, sUID, sPWD, DTSSQLStgFlag_Default, \"\", \"\", \"\", \"MyPackageName\", 0\r\n\r\noPackage.Execute\r\n\r\nSet oPackage = Nothing\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"10","CategoryDescription":"SQL Server"},"Keywords":["DTS Package"]},{"RecordId":"587","Title":"Lock Workstation","Description":"API call to lock a workstation","Code":"Call LockWorkStation","Declares":"Private Declare Function LockWorkStation Lib \"user32.dll\" () As Long\r\n","CodeCategory":{"CategoryId":"11","CategoryDescription":"Windows API"},"Keywords":["Lock Workstation"]},{"RecordId":"588","Title":"Open NT Explorer With Specific NameSpaces Loaded","Description":"Open NT Explorer with specific NameSpaces loaded","Code":"Open Explorer from VB\r\n\r\nDim TaskID as Long\r\nTaskID = Shell(\"Explorer c:\\\", vbNormalFocus)\r\n\r\n\r\nOpen Explorer from VB with specific namespace preloaded (This opens Scheduled Tasks)\r\n\r\nDim TaskID as Long\r\nDim ShellCmd as String\r\nShellCmd = \"Explorer ::{20D04FE0-3AEA-1069-A2D8-08002B30309D}\\::{D6277990-4C6A-11CF-8D87-00AA0060F5BF}\"\r\n\r\n\r\nCommon GUIDs for NameSpaces\r\n\r\nMy Computer\r\n::{20D04FE0-3AEA-1069-A2D8-08002B30309D}\r\n\r\nNetwork Neighborhood\r\n::{208D2C60-3AEA-1069-A2D7-08002B30309D}\r\n\r\nRecycle Bin\r\n::{645FF040-5081-101B-9F08-00AA002F954E}\r\n\r\nTask Scheduler\r\n::{20D04FE0-3AEA-1069-A2D8-08002B30309D}\\::{D6277990-4C6A-11CF-8D87-00AA0060F5BF}\r\n\r\n\r\nPrinters\r\n::{20D04FE0-3AEA-1069-A2D8-08002B30309D}\\::{2227A280-3AEA-1069-A2DE-08002B30309D}\r\n\r\nControl Panel\r\n::{20D04FE0-3AEA-1069-A2D8-08002B30309D}\\::{21EC2020-3AEA-1069-A2DD-08002B30309D}\r\n\r\nDial-up Networking\r\n::{20D04FE0-3AEA-1069-A2D8-08002B30309D}\\::{a4d92740-67cd-11cf-96f2-00aa00a11dd9}\r\n\r\nWeb Folders\r\n::{20D04FE0-3AEA-1069-A2D8-08002B30309D}\\::{BDEADF00-C265-11d0-BCED-00A0C90AB50F}","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Explorer","My Computer","NameSpace"]},{"RecordId":"589","Title":"Send eMail Formatted as HTML Using CDONTS","Description":"Uses CDONTS to send an email that is formatted as HTML","Code":"Dim myMail \r\nSet myMail = CreateObject(\"CDONTS.NewMail\") \r\n \r\nHTML = \"<!DOCTYPE HTML PUBLIC \"\"-//IETF//DTD HTML//EN\"\">\" & vbCrLf \r\nHTML = HTML & \"<html>\" \r\nHTML = HTML & \"<head>\" \r\nHTML = HTML & \"<meta http-equiv=\"\"Content-Type\"\"\" \r\nHTML = HTML & \"\"content=\"\"text/html; charset=iso-8859-1\"\">\"\" \r\nHTML = HTML & \"<title>Sample NewMail</title>\" \r\nHTML = HTML & \"</head>\" \r\nHTML = HTML & \"<body>\" \r\nHTML = HTML & \"This is a sample message being sent using HTML. <BR></body>\" \r\nHTML = HTML & \"</html>\" \r\n \r\nmyMail.From = \"Example@microsoft.com\" \r\nmyMail.To = \"Someone@microsoft.com\" \r\nmyMail.Subject = \"Sample Message\" \r\nmyMail.BodyFormat = 0 \r\nmyMail.MailFormat = 0 \r\nmyMail.Body = HTML \r\nmyMail.Send \r\nSet myMail = Nothing \r\n","Declares":"","CodeCategory":{"CategoryId":"5","CategoryDescription":"ASP"},"Keywords":["CDONTS"]},{"RecordId":"590","Title":"Copy TextArea Text to Clipboard (IE only)","Description":"Demonstrates how to copy text from an HTML TextArea to the clipboard.","Code":"<!-- TWO STEPS TO INSTALL SELECT AND AUTO COPY:\r\n\r\n  1.  Copy the coding into the HEAD of your HTML document\r\n  2.  Add the last code into the BODY of your HTML document  -->\r\n\r\n<!-- STEP ONE: Paste this code into the HEAD of your HTML document  -->\r\n\r\n<HEAD>\r\n\r\n<SCRIPT LANGUAGE=\"JavaScript\">\r\nfunction copyit(theField) {\r\n    var tempval=eval(\"document.\"+theField);\r\n    tempval.focus();\r\n    tempval.select();\r\n    therange=tempval.createTextRange();\r\n    therange.execCommand(\"Copy\");\r\n}\r\n</script>\r\n\r\n</HEAD>\r\n\r\n<!-- STEP TWO: Copy this code into the BODY of your HTML document  -->\r\n\r\n<BODY>\r\n\r\n<form name=\"it\">\r\n  <textarea name=\"select1\" rows=\"3\" cols=\"25\">\r\n    If this is highlighted, then it has been copied.\r\n  </textarea>\r\n  <input onclick=\"copyit('it.select1')\" \r\n             type=\"button\" value=\"Press to Copy the Text\" name=\"cpy\">\r\n</form>\r\n</body>","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["Clipboard","Copy"]},{"RecordId":"591","Title":"Script Timeout","Description":"Changing the ASP script timeout value","Code":"Server.ScriptTimeout = numSeconds\r\n\r\nDefault is 90.","Declares":"","CodeCategory":{"CategoryId":"5","CategoryDescription":"ASP"},"Keywords":["Script Timeout","Timeout"]},{"RecordId":"592","Title":"ADSI - Part 1 of 3","Description":"ADSI routines","Code":"ADSI - PART 1\r\n\r\n\r\n\r\nWindows Security Account Manager\r\n\r\nThe Security Account Manager (SAM) is the portion of Windows which registers and holds all user information and knows all the default configuration settings. Our first meeting with SAM entails the process of creating a user. This applies to Windows 2000 as well as Windows NT 4.0. \r\n\r\nNOTE: In order for the following code to work, administrator rights are required. \r\n\r\n \r\nAdding A User to The SAM\r\n\r\n\r\n<%\r\n\r\n1. AddUser  \"newuser\",\"mydomain\"\r\n2. \r\n3.   Sub AddUser(strUser,strDomain)\r\n4.     Dim Computer\r\n5.     Dim User\r\n6.\r\n7.     Set Computer = Getobject(\"WinNT://\" & strDomain)\r\n8.     Set User = computer.create(\"User\",strUser)\r\n9.     User.setinfo\r\n10.\r\n11.   Set User = nothing\r\n12.   Set computer = nothing\r\n13. End sub\r\n\r\n%>\r\n\r\n\r\nThis code can be activated by calling it anywhere in the ASP page (line 1). Also, make sure to spell winnt like the example given in line 7. ADSI is very case sensitive and will refuse to work if you spell it differently. As you can see there are no attributes given; this user is created without a password. Let's do something about that. \r\n\r\n<%\r\n\r\n1. AddUser  \"newuser\",\"mydomain\",\"New user\",\"adsi\",\"Our best employee\"\r\n2. \r\n3.   Sub AddUser(strUser,strDomain,strFullname,strPassword,strDesc)\r\n4.     Dim Computer\r\n5.     Dim User\r\n6.\r\n7.     Set Computer = Getobject(\"WinNT://\" & strDomain)\r\n8.     Set User = computer.create(\"User\",strUser)\r\n8.     User.fullname = strFullname\r\n9.     User.Description = strDesc\r\n10.   call User.SetPassword(strPassword)\r\n11.   User.setinfo\r\n12.\r\n13.   Set User = nothing\r\n14.   Set computer = nothing\r\n15. End sub\r\n%>\r\n\r\n\r\nAs you can see, I added more than just a password. I also added the fullname and the description. These aren't really important if you have a system with 5 users, but large corporations usually have a policy about that. Please be advised that the above code is for adding a new user. I will cover modifying an existing user in a future article. The problem about ADSI is that you can't guess the code. It's not as easy as only punching up user.[attribute_name]. \r\nNext stop is the userflags. These control options such as \"Password Never Expires\" and \"Account Disabled\". \r\n\r\n\r\n<%\r\n\r\n1.  UserFlags \"newuser\",\"mydomain\",0,False,True,True,True\r\n2. \r\n3.   Sub UserFlags(strUser,strDomain,strPassexpires,strNochange,strNoexpire, & _        \r\n                               strDisable,strLocked)\r\n4.      Dim User\r\n5.      Dim Flags\r\n6.\r\n7.      Set User = Getobject(\"WinNT://\" & strDomain & \"/\" & strUser & \",user\")\r\n8.      Flags = User.Get(\"UserFlags\")\r\n9.\r\n10.    User.put \"PasswordExpired\",strPassexpires\r\n11.    User.Accountdisabled = strDisable\r\n12.    if strNochange = \"true\" then \r\n13.      User.put \"UserFlags\", Flags OR &H00040\r\n14.    End if\r\n15.    If strNoexpire = \"true\" then\r\n16.      User.put \"Userflags\", flags OR &H10000\r\n17.    end if\r\n18.    User.IsAccountLocked = strLocked\r\n19.\r\n20.   Set User = Nothing\r\n21.   Set Flags = Nothing\r\n22.  End sub\r\n\r\n%>\r\n\r\n\r\nIn the example above I gave my new user some restrictions. The outcome of this subroutine is that my new user will have a valid password (password isn't expired because it's set on 0. If you change it to 1, the password isn't valid anymore. If the password is expired, the user will be forced to change it at the next login). He will be unable to change his own password; his password will never expire; and his account is disabled and locked. In order to change, this you should modify the subroutine call. \r\nSo now we have a new user with all the default settings. Maybe this is enough for your home situation, but many companies want to set more boundaries for their users. Also, a lot of companies have the personal settings of their users stored on a separate network drive. ADSI allows you to make sure your new users have the same configuration as every other employee. \r\n\r\n\r\n<%\r\n\r\n1. userconfig \"newuser\",\"mydomain\",\"c:\\myprofiles\\\",\"myscript.cmd\",\"c:\\\",\"z:\\\", & _\r\n                         #mm/dd/yyyy#,\"true\"\r\n2.\r\n3.    sub userconfig(strUser,strDomain,strProfile,strScript,strHomedir, & _\r\n                               strHomedirdrive,strAccountexpire,strPassrequired)\r\n4.      Dim User\r\n5.      Dim Flags\r\n6.\r\n7.      Set User = Getobject(\"WinNT://\" & strDomain & \"/\" & strUser & \",user\")\r\n8.      \r\n9.      User.Profile = strProfile\r\n10.    User.LoginScript = strScript\r\n11.    User.Homedirectory = strHomedir\r\n12.    User.Put(\"HomeDirDrive\"),strHomedirdrive\r\n13.    User.AccountExpirationDate = strAccountexpire\r\n14.    User.Passwordrequired = strPassrequired\r\n15.\r\n16.   Set User = nothing\r\n17.   Set Flags = Nothing\r\n18.  end sub\r\n\r\n%>\r\n\r\n\r\nNow we have all the information we need to make a new user. I'm not going to explain these options because if you don't know them, you don't need to use them. The three subroutines we created can be used perfectly in combination with each other (see below). Remember, please test on a non-operational system first! \r\nLook out for little mistakes and adjust the code so it applies to your situation. Just in case: I cannot be held responsible for any damage that could occur before, during or after implementing and using this code. \r\n\r\n\r\n<%\r\n1.  AddUser  \"newuser\",\"mydomain\",\"New user\",\"adsi\",\"Our best employee\"\r\n2.  UserFlags \"newuser\",\"mydomain\",0,False,True,True,True\r\n3.  userconfig \"newuser\",\"mydomain\",\"c:\\myprofiles\\\",\"myscript.cmd\",\"c:\\\",\"z:\\\", & _\r\n                         #mm/dd/yyyy#,\"true\"\r\n4.\r\n5.\r\n6.    Sub AddUser(strUser,strDomain,strFullname,strPassword,strDesc)\r\n7.      Dim Computer,User\r\n8.      Set Computer = Getobject(\"WinNT://\" & strDomain)\r\n9.      Set User = computer.create(\"User\",strUser)\r\n10.    User.fullname = strFullname\r\n11.    User.Description = strDesc\r\n12.    call User.SetPassword(strPassword)\r\n13.    User.setinfo\r\n14.\r\n15.\t Set User = nothing\r\n16.\t Set computer = nothing\r\n17.  End sub\r\n18.\r\n19.  Sub UserFlags(strUser,strDomain,strPassexpires,strNochange,strNoexpire, & _        \r\n                               strDisable,strLocked)\r\n20.    Dim User,Flags\r\n21.    Set User = Getobject(\"WinNT://\" & strDomain & \"/\" & strUser & \",user\")\r\n22.    Flags = User.Get(\"UserFlags\")\r\n23.    User.put \"PasswordExpired\",strPassexpires\r\n24.    User.Accountdisabled = strDisable\r\n25.    if strNochange = \"true\" then \r\n26.      User.put \"UserFlags\", Flags OR &H00040\r\n27.    End if\r\n28.    If strNoexpire = \"true\" then\r\n29.      User.put \"Userflags\", flags OR &H10000\r\n30.    end if\r\n31.    User.IsAccountLocked = strLocked\r\n32.\r\n33.\t Set User = nothing\r\n34.   Set Flags = Nothing\r\n35.  End sub\r\n36.\r\n37.  Sub userconfig(strUser,strDomain,strProfile,strScript,strHomedir, & _\r\n                                 strHomedirdrive,strAccountexpire,strPassrequired)\r\n37.    Dim User,Flags\r\n38.    Set User = Getobject(\"WinNT://\" & strDomain & \"/\" & strUser & \",user\")\r\n39.    User.Profile = strProfile\r\n40.    User.LoginScript = strScript\r\n41.    User.Homedirectory = strHomedir\r\n42.    User.Put(\"HomeDirDrive\"),strHomedirdrive\r\n43.    User.AccountExpirationDate = strAccountexpire\r\n44.    User.Passwordrequired = strPassrequired\r\n45.\r\n46.\t Set User = nothing\r\n47.   Set Flags = Nothing\r\n48.  End sub\r\n%>","Declares":"","CodeCategory":{"CategoryId":"7","CategoryDescription":"Misc"},"Keywords":["ADSI","Active Directory"]},{"RecordId":"593","Title":"ADSI - Part 2 of 3","Description":"ADSI routines","Code":"ADSI - PART 2\r\n\r\n\r\n\r\nEditing an Existing User\r\n\r\nAs I explained in my first article, every action performed here goes directly through the Windows SAM. In response to my first article, there were some questions on how to change the logon hours or the terminal server home path. Sorry, but I have to disappoint you . This , as well as some other vital functions, can't be changed by ADSI. Then again, ADSI does do a lot. In the upcoming articles we are going to dive into the IIS metabase. But before we do that, let's start with editing a user. \r\n\r\nRenaming Users \r\n\r\n\r\n<%\r\n1.  RenameUser(\"MyDomain\",\"MyUsername\",\"MyNewUsername\")\r\n2.\r\n3.   Sub RenameUser(strDomain,strOldUsername,strNewUsername)\r\n4.     Dim Computer\r\n5.     Dim User\r\n6.     Dim MoveUser\r\n7.    \r\n8.     Set Computer = GetObject(\"WinNT://\" & strDomain)\r\n9.     Set User = GetObject(\"WinNT://\" & strDomain & \"/\" & strOldUsername & \",user\")\r\n10.   Set MoveUser = Computer.MoveHere(User.ADsPath, strNewUsername)\r\n11.\r\n12.   Set Computer = nothing\r\n13.   Set User = nothing\r\n14.   Set MoveUser = nothing\r\n15. End Sub\r\n%>\r\n\r\n\r\nThere isn't much to explain. The computer just grabs all the information about a user (the user.ADsPath) and projects that to the new user, deleting the old. \r\nChanging User-Properties \r\n\r\n\r\n<%\r\n1.   ChangeUser(\"MyUser\",\"MyDomain\",\"MyFullname\",\"MyDescription\",\"MyOldPass\"\r\n      ,\" MyNewPass\"\r\n2.\r\n3.   Sub ChangeUser(strUser,strDomain,strFullname,strDesc,strOldPassword, \r\n4.                              strNewPassword)\r\n5.     Dim User\r\n6.     Set User = GetObject(\"WinNT://\" & strDomain & \"/\" & strUser & \",user\")\r\n7.     User.Fullname = strDesc\r\n8.     User.Description = strDesc\r\n9.     User.ChangePassword(strOldPassword,strNewPassword)\r\n10.   User.Setinfo\r\n11.   Set User = nothing\r\n12. End Sub\r\n%>\r\n\r\n\r\nIn the above code we changed some basic elements of a user account. It isn't that different from adding a user. The only thing difference is the way a password is changed. Because of security reasons you can only change a password by providing the old password. The outcome of this subroutine is very simple. The user \"MyUser\" now has \"MyFullname\",\"MyDescription\", and \"MyNewpass\" as a fullname, description and password. The next part is a bit harder since we are going into Hex/Decimal codes with the User-Flags. Again the code looks a lot like the code I used in my first article, but with one difference. Because we are now changing the user settings we use XOR instead of OR when dealing with userflags. \r\nChanging Specific User Boundaries \r\n\r\n\r\n<%\r\n\r\n1.  UserFlags \"newuser\",\"mydomain\",0,False,True,True,True\r\n2. \r\n3.    Sub UserFlags(strUser,strDomain,strPassexpires,strNochange,strNoexpire, & _        \r\n                               strDisable,strLocked)\r\n4.      Dim User\r\n5.      Dim Flags\r\n6.\r\n7.      Set User = Getobject(\"WinNT://\" & strDomain & \"/\" & strUser & \",user\")\r\n8.      Flags = User.Get(\"UserFlags\")\r\n9.\r\n10.    User.put \"PasswordExpired\",strPassexpires\r\n11.    User.Accountdisabled = strDisable\r\n12.    if strNochange = \"true\" then \r\n13.      User.put \"UserFlags\", Flags OR &H00040\r\n14.    End if\r\n15.    If strNoexpire = \"true\" then\r\n16.      User.put \"Userflags\", flags OR &H10000\r\n17.    end if\r\n18.    User.IsAccountLocked = strLocked\r\n19.\r\n20.    Set User = nothing\r\n21. End sub\r\n\r\n%>\r\n\r\n\r\nI'm not going to explain this code since it is an almost exact copy of the coding in the first article. Please make sure that you use XOR to change a userflag and OR to initially set it. The following part is a direct copy since nothing has changed. In order to change the logon script, profile path, etc., we use the same code as we used to initially set it. \r\n\r\n<%\r\n\r\n1.    userconfig \"newuser\",\"mydomain\",\"c:\\myprofiles\\\",\"myscript.cmd\",\"c:\\\",\"z:\\\", & _\r\n                         #mm/dd/yyyy#,\"true\"\r\n2.\r\n3.    sub userconfig(strUser,strDomain,strProfile,strScript,strHomedir, & _\r\n                               strHomedirdrive,strAccountexpire,strPassrequired)\r\n4.      Dim User\r\n5.      Dim Flags\r\n6.\r\n7.      Set User = Getobject(\"WinNT://\" & strDomain & \"/\" & strUser & \",user\")\r\n8.      \r\n9.      User.Profile = strProfile\r\n10.    User.LoginScript = strScript\r\n11.    User.Homedirectory = strHomedir\r\n12.    User.Put(\"HomeDirDrive\"),strHomedirdrive\r\n13.    User.AccountExpirationDate = strAccountexpire\r\n14.    User.Passwordrequired = strPassrequired\r\n15.\r\n16.  end sub\r\n\r\n%>\r\n\r\n\r\nNow we edited the same information that we applied to the computer in the previous article. After doing this we might as well remove the user we created, leaving us with nothing. \r\nRemoving Users \r\n\r\n\r\n<%\r\n1.  DelUser(\"MyDomain\",\"MyUsername\",)\r\n2.\r\n3.   Sub DelUser(strDomain,strUsername)\r\n4.     Dim Computer\r\n5.    \r\n6.     Set Computer = GetObject(\"WinNT://\" & strDomain)\r\n7.     Computer.Delete(\"User\", strUsername)\r\n8.     Set Computer = nothing\r\n9.   End Sub\r\n%>\r\n\r\n\r\nIn the next article I will provide codes on how to query specific user information. For now we are going to order our thousands of users by making groups. \r\n \r\nCreating, Editing and Populating Groups\r\n\r\nGroups are made to make the life of system administrators a bit easier. By creating groups you don't have to give folder rights to each specific user. You only have to give folder rights to the group. With ADSI and some good old DOS programming we can automate both. \r\n\r\nCreating a Group \r\n\r\n\r\n<%\r\n1.    '//Creating a local group\r\n2.    AddLocalGroup(\"MyDomain\", \"MyGroup\")\r\n3.  \r\n4.    Sub AddLocalGroup(strDomain,strGroupname)\r\n5.      Dim Computer\r\n6.      Dim Group\r\n7.\r\n8.      Set Computer = GetObject(\"WinNT://\" & strDomain)\r\n9.      Set Group = Computer.Create(\"Group\", strGroupname)\r\n10.    Group.Put \"groupType\", 4\r\n11.    Group.Setinfo\r\n12.\r\n13.    Set Computer = nothing\r\n14.    Set Group = nothing\r\n15.  End Sub\r\n16.  '//End Creating a local group\r\n%>\r\n\r\n<%\r\n1.    '//Creating a global group\r\n2.    AddGlobalGroup(\"MyDomain\",\"MyGroup\")\r\n3.\r\n4.    Sub AddGlobalGroup(strDomain,strGroupname)\r\n5.      Dim Computer\r\n6.      Dim Group\r\n7.  \r\n8.      Set Computer = GetObject(\"WinNT://\" & strDomain)\r\n9.      Set Group = Computer.Create(\"Group\", strGroupname)\r\n10.    Group.Put \"groupType\", 2\r\n11.    Group.Setinfo\r\n12. \r\n13.    Set Computer = nothing\r\n14.    Set Group = nothing\r\n15.  End Sub\r\n16.  '//End Creating a global group\r\n%>\r\n\r\n\r\nYou may have noticed that in the first code sample the grouptype is 4, and in the second it is 2. The grouptype defines if the group is a local group, or a global group. Local groups are created to make independent groups on a workstation, and global groups are made for the whole domain. By default ADSI creates a Global group, so if you want to make a group without thinking, use the second sample and remove the Group.Put \"groupType\", 2 part. \r\nAdding Users to a Group \r\n\r\n\r\n<%\r\n1.    AddUserToGroup(\"MyDomain\",\"MyUsername\",\"MyGroup\")\r\n2.\r\n3.    Sub AddUserToGroup(strDomain,strUsername,strGroupname)\r\n4.      Dim User\r\n5.      Dim Group\r\n6.\r\n7.      Set User = GetObject(\"WinNT://\" & strDomain & \"/\" & strUsername & \",user\")\r\n8.      Set Group = GetObject(\"WinNT://\" & strDomain & \"/\" & strGroupname & \r\n                                               \",group\")\r\n9.      Group.Add(User.ADsPath)\r\n10.    Group.Setinfo\r\n11.\r\n12.    Set User = nothing\r\n13.    Set Group = nothing\r\n14.  End Sub\r\n%>\r\n\r\n\r\nRemoving Users from a Group \r\n\r\n<%\r\n1.    DelUserFromGroup(\"MyDomain\",\"MyUsername\",\"MyGroup\")\r\n2.\r\n3.    Sub DelUserFromGroup (strDomain,strUsername,strGroupname)\r\n4.      Dim User\r\n5.      Dim Group\r\n6.\r\n7.      Set User = GetObject(\"WinNT://\" & strDomain & \"/\" & strUsername & \",user\")\r\n8.      Set Group = GetObject(\"WinNT://\" & strDomain & \"/\" & strGroupname & \r\n                                               \",group\")\r\n9.      Group.Remove(User.ADsPath)\r\n10.    Group.Setinfo\r\n11.\r\n12.    Set User = nothing\r\n13.    Set Group = nothing\r\n14.  End Sub\r\n%>\r\n\r\n\r\nEditing the Group Description Field \r\n\r\n<%\r\n1.    EditGroup(\"MyDomain\",\"MyGroup\",\"MyDescription\")\r\n2.\r\n3.    Sub EditGroup (strDomain,strGroupname,strGroupDesc)\r\n4.      Dim Group\r\n5.\r\n6.      Set Group = GetObject(\"WinNT://\" & strDomain & \"/\" & strGroupname & \r\n                                               \",group\")\r\n7.      Group.Description = strGroupDesc\r\n8.      Group.Setinfo\r\n9.\r\n10.    Set Group = nothing\r\n11.  End Sub\r\n%>\r\n\r\n\r\nMaybe some of you missed my explanation here. But I couldn't think of anything to comment on. The creation of a group doesn't involve difficult pieces of coding. Frankly, the only thing that is different between adding and removing a user in a group is the words \"add\" and \"remove\". There is nothing as easy as making new groups; you just have to know the syntax. So that is what I've provided here. Let's cleanup our little experiment by removing the group. \r\nRemoving a Group \r\n\r\n\r\n<%\r\n1.  DelGroup(\"MyDomain\",\"MyGroup\",)\r\n2.\r\n3.   Sub DelGroup(strDomain,strGroupname)\r\n4.     Dim Computer\r\n5.     Set Computer = GetObject(\"WinNT://\" & strDomain)\r\n6.     Computer.Delete(\"Group\", strGroupname)\r\n7.     Set Computer = nothing\r\n8.   End Sub\r\n%>\r\n\r\n\r\nThat is all there is to say about groups in the ADSI. So now for the special bonus: Automatically changing the Folder Rights. After creating a group, or a user, you can automatically set the folder rights by using old fashion DOS methods. Every Windows server has a little program called cacls.exe. This program changes the user rights on folders. You can just run it by using Windows Scripting, but then you will get stuck. Why? Because the cacls.exe is waiting for confirmation. In order to do this you should pipe a Y to the cacls.exe, forcing it to accept the new settings. \r\n\r\n<%\r\n1.    ChangeFolderSettings(\"c:\\myfolder\",\"Myuser\",\"C\")\r\n2.\r\n3.    Sub ChangeFolderSettings(strFolderPath,strUser,strPermission)\r\n4.      Dim caclscommand\r\n5.      Dim whs\r\n6.      Dim whsRun\r\n7.\r\n8.      Caclscommand = \"cmd /c echo y| CACLS \" & strFolderPath\r\n9.      Caclscommand = Caclscommand & \" /E /C /G \" & strUser & \":\" & strPermission\r\n10.\r\n11.    Set whs = server.createobject(\"WScript.Shell\")\r\n12.    Set whsRun = whs.run(Caclscommand, 0, True)\r\n13.\r\n14.    Set whsrun = nothing\r\n15.    Set whs = nothing\r\n16.  End Sub\r\n%>\r\n\r\n\r\nThe code creates a commandline that is executed in by the Windows Script Host. In that commandline I specify a few different things: \r\n\r\n1. \"cmd /c echo\"\r\n2. \"y| CACLS\"\r\n3. & strFolderPath & \" /E /C\"\r\n4. \"/G \" & strUser & \":\" & strPermission\r\n\r\n\r\nThe first thing I do is open a command window and pointing out that I want to see the what's happening. After that I pipe the letter Y to the CACLS.exe by using the y| symbol. By piping Y, I avoid the \"Are you Sure\" question. Then I give the name of the folder (or file) I want to edit, followed by /E and /C. The /E says that I want to edit the user rights. Without the /E the rights will be overwritten. The /C says that the code should continue even if an error occurs. The last part is where I grant to user strUser (this can also be a group) a specific right. In the example I use C. But there are more rights: \r\n\r\n- R (read only)\r\n- W (write only)\r\n- C (change (read/write))\r\n- F (Full Control)\r\n\r\n\r\nPlease note that if you want to change the rights of a user you have to use \"/P \" & strUser & \":\" & strPermission \r\nI'm going to end with some answers to questions I received concerning my previous article. Hope you enjoyed it, and happy programming. \r\n\r\n \r\nFAQ\r\n\r\nQ: I can't set the AccountExpirationDate\r\nA: This could be because the user has the \"Password Never Expires\" toggled on. If so, the account won't expire, and therefore ADSI isn't able to set it. \r\n\r\nQ: I get a \"General Access Denied Error\" when I apply the codes\r\nA: The server will only allow changes to be made to the SAM using an Administrator username and password. So the IUSR_machinename (IIS anonymous account) isn't allowed to execute the codes. Make sure that you toggle off the anonymous access in IIS, and let people login using a valid Administrator account. \r\n\r\nQ: Can I Automatically create an exchange Mail account?\r\nA: Yes you can, but I will handle that later. \r\n\r\nQ: can I set the Terminal Services Properties using ADSI.\r\nA: No you can't. ADSI can't set the terminal services properties, as well as it can't change logon hours. \r\n\r\nBeside these questions, there were some question about LDAP. This article doesn't involve LDAP; it just refers to the ADSI language. If you do have question about LDAP, you can e-mail me. I'm not really good at it, but I can help to figure out a solution.","Declares":"","CodeCategory":{"CategoryId":"7","CategoryDescription":"Misc"},"Keywords":["ADSI","Active Directory"]},{"RecordId":"594","Title":"ADSI - Part 3 of 3","Description":"ADSI routines","Code":"ADSI - Useful Routines\r\n\r\n\r\n\r\n1. Domain Computers\r\n\r\n1.1 Display all domains in the server NameSpace \r\n\r\n\r\n  Sub PullAllDomains\r\n    Dim objNameSpace\r\n    Dim Domain\r\n\r\n    Set objNameSpace = GetObject(\"WinNT:\")\r\n    For Each Domain in Namespace\r\n       Response.Write Domain.Name\r\n    Next\r\n  End sub\r\n\r\n\r\n1.2 Display all Connected Computers on the Primary Domain Controller \r\n  \r\nSub PullAllComputers(strDomain)\r\n    Dim PrimDomainContr\r\n\r\n    Set PrimDomainContr = getobject(\"WinNT://\" & strDomain)\r\n    PrimDomainContr.filter = Array(\"Computer\")\r\n   \r\n    For each Computer in PrimDomainContr\r\n      Reponse.write Computer.Name\r\n    Next\r\n  End sub\r\n\r\n\r\n1.3 Remove a Connected Computer from a Primary Domain Controller \r\n  \r\nSub DelComputerFromPDC(strDomain,strDelComputer)\r\n    Dim PrimDomainContr\r\n    Set PrimDomainContr = getobject(\"WinNT://\" & strDomain)\r\n    Call PrimDomainContr.Delete(\"Computer\", strDelComputer)\r\n  End Sub\r\n\r\n\r\n \r\n2. Computer Users\r\n\r\n2.1 Display all user accounts \r\n\r\n\r\nsub PullAllUsers(strDomain)\r\n    Dim Computer\r\n    Dim User\r\n\r\n    Set Computer = GetObject(\"WinNT://\" & strDomain)\r\n    Computer.Filter = Array(\"User\")\r\n    For Each User in Computer\r\n      Response.Write User.Name\r\n    Next\r\n  End Sub\r\n\r\n\r\n2.2 Display Minimum Password Age \r\n  \r\nSub DispMinPassAge(strDomain)\r\n    Dim Computer\r\n    Set Computer = GetObject(\"WinNT://\" & strDomain)\r\n    Response.Write ((Computer.MinPasswordAge) / 86400)\r\n  End Sub\r\n\r\n\r\n2.3 Display Minimum Password Length \r\n  \r\nSub DispMinPassLength(strDomain)\r\n    Dim Computer\r\n    Set Computer= GetObject(\"WinNT://\" & strDomain)\r\n    Response.Write Computer.MinPasswordLength\r\n  End Sub\r\n\r\n\r\n2.4 Display Password History Length \r\n  \r\nSub DispPassHisLength(strDomain)\r\n    Dim Computer\r\n    Set Computer = GetObject(\"WinNT://\" & strDomain)\r\n    Response.Write Domain.PasswordHistoryLength\r\n  End Sub\r\n\r\n\r\n2.5 Display Auto Unlock Interval \r\n  \r\nSub DispAutoUnlock(strDomain)\r\n    Dim Computer\r\n    Set Computer = GetObject(\"WinNT://\" & strDomain)\r\n    Response.Write Computer.AutoUnlockInterval\r\n  End Sub\r\n\r\n\r\n2.6 Display Lockout Observation Interval \r\n\r\nSub DispAutoUnlockObservation(strDomain)\r\n    Dim Computer\r\n    Set Computer = GetObject(\"WinNT://\" & strDomain)\r\n    Response.Write Computer.LockOutObservationInterval\r\n  End Sub\r\n\r\n\r\n \r\n3. Computer Groups\r\n\r\n3.1 Display All Groups \r\n\r\n  \r\nSub PullAllGroups(strDomain)\r\n    Dim Computer\r\n    Dim Group  \r\n\r\n    Set Computer = GetObject(\"WinNT://\" & strDomain)\r\n    Computer.Filter = Array(\"Group\")\r\n    For Each Group in Computer\r\n      Response.Write Group.Name\r\n    Next\r\n  End Sub\r\n\r\n\r\n \r\n4. User Specific Fields\r\n\r\n4.1 Display User Fullname \r\n\r\n  \r\nSub PullUserFullname(strDomain,strUser)\r\n    Dim User\r\n    Set User = GetObject(\"WinNT://\" & strDomain & \"/\" & strUser & \",user\")\r\n    Response.write User.Fullname\r\n  End sub\r\n\r\n\r\n4.2 Display User Description \r\n  \r\nSub PullUserDescription(strDomain,strUser)\r\n    Dim User\r\n    Set User = GetObject(\"WinNT://\" & strDomain & \"/\" & strUser & \",user\")\r\n    Response.write User.Description\r\n  End sub\r\n\r\n\r\n4.3 Display User Must Change Password Flag \r\n\r\n  Sub PullUserMustChangePass(strDomain,strUser)\r\n    Dim User\r\n    Set User = GetObject(\"WinNT://\" & strDomain & \"/\" & strUser & \",user\")\r\n    Response.write User.Get(\"PasswordExpired\")  '// 1 Means the Password Expired\r\n  End Sub\r\n\r\n\r\n4.4 Display User Can't Change Password Flag \r\n\r\nSub PullUserCannotChangePass(strDomain,strUser)\r\n    Dim User\r\n    Dim Flags\r\n    \r\n    Set User = GetObject(\"WinNT://\" & strDomain & \"/\" & strUser & \",user\")\r\n    Flags = User.Get(\"UserFlags\")\r\n    Response.write  Flags And &H00040 '// 0 Means that user CAN change pass\r\n  End sub\r\n\r\n\r\n4.5 Display Password Never Expires Flag \r\n  \r\nSub PullPassNeverExpires(strDomain,strUser)\r\n    Dim User\r\n    Dim Flags\r\n    \r\n    Set User = GetObject(\"WinNT://\" & strDomain & \"/\" & strUser & \",user\")\r\n    Flags = User.Get(\"UserFlags\")\r\n    Response.write  Flags And &H10000 '// 0 Means that Password DOES expire\r\n  End sub\r\n\r\n\r\n4.6 Display User Password Minimum Length \r\n  \r\nSub PullUserPassMinLength(strDomain,strUser)\r\n    Dim User\r\n    Set User = GetObject(\"WinNT://\" & strDomain & \"/\" & strUser & \",user\")\r\n    Response.Write User.PasswordMinimumLength\r\n  End Sub\r\n\r\n\r\n4.7 Display User Password Required \r\n  \r\nSub PullUserPassRequired(strDomain,strUser)\r\n    Dim User\r\n    Set User = GetObject(\"WinNT://\" & strDomain & \"/\" & strUser & \",user\")\r\n    Response.Write User.PasswordRequired\r\n  End Sub\r\n\r\n\r\n4.8 Display User Account Disabled Flag \r\n  \r\nSub PullUserAccountDisabled(strDomain,strUser)\r\n    Dim User\r\n    Set User = GetObject(\"WinNT://\" & strDomain & \"/\" & strUser & \",user\")\r\n    Response.Write User.AccountDisabled\r\n  End Sub\r\n\r\n\r\n4.9 Display User Account Lockout Flag \r\n\r\n  Sub PullUserAccountLockout(strDomain,strUser)\r\n    Dim User\r\n    Set User = GetObject(\"WinNT://\" & strDomain & \"/\" & strUser & \",user\")\r\n    Response.Write User.IsAccountLocked\r\n  End Sub\r\n\r\n\r\n4.10 Display User Account Type \r\n\r\n  Sub PullUserAccountType(strDomain,strUser)\r\n    Dim User\r\n    Dim Flags\r\n    \r\n    Set User = GetObject(\"WinNT://\" & strDomain & \"/\" & strUser & \",user\")\r\n    Flags = User.Get(\"UserFlags\")\r\n    Response.write  Flags And &H100  '// 0 Means that account is GLOBAL\r\n  End sub\r\n\r\n\r\n4.11 Display User Profile Path \r\n  \r\nSub PullUserProfilePath(strDomain,strUser)\r\n    Dim User\r\n    Set User = GetObject(\"WinNT://\" & strDomain & \"/\" & strUser & \",user\")\r\n    Response.Write User.Profile\r\n  End Sub\r\n\r\n\r\n4.12 Display User Login Script \r\n\r\n  Sub PullUserLoginScript(strDomain,strUser)\r\n    Dim User\r\n    Set User = GetObject(\"WinNT://\" & strDomain & \"/\" & strUser & \",user\")\r\n    Response.Write User.LoginScript\r\n  End Sub\r\n\r\n\r\n4.13 Display User Home Directory Path \r\n\r\n  Sub PullUserHomeDirPath(strDomain,strUser)\r\n    Dim User\r\n    Set User = GetObject(\"WinNT://\" & strDomain & \"/\" & strUser & \",user\")\r\n    Response.Write User.HomeDirectory\r\n  End Sub\r\n\r\n\r\n4.14 Display User Home Directory Mapping \r\n\r\n  Sub PullUserHomeDirDrive(strDomain,strUser)\r\n    Dim User\r\n    Set User = GetObject(\"WinNT://\" & strDomain & \"/\" & strUser & \",user\")\r\n    Response.Write User.Get(\"HomeDirDrive\")\r\n  End Sub\r\n\r\n\r\n4.15 Display User Account Expiration Date (NT 4.0 only) \r\n\r\n  Sub PullUserAccountExpireDate(strDomain,strUser)\r\n    Dim User\r\n    Set User = GetObject(\"WinNT://\" & strDomain & \"/\" & strUser & \",user\")\r\n    Response.Write User.AccountExpirationDate\r\n  End Sub\r\n\r\n\r\n4.16 Display User Bad Login Count (NT 4.0 only) \r\n\r\n  Sub PullUserBadLoginCount(strDomain,strUser)\r\n    Dim User\r\n    Set User = GetObject(\"WinNT://\" & strDomain & \"/\" & strUser & \",user\")\r\n    Response.Write User.BadLoginCount\r\n  End Sub\r\n\r\n\r\n4.17 Display User Last Login (NT 4.0 only) \r\n\r\n  Sub PullUserLastLogin(strDomain,strUser)\r\n    Dim User\r\n    Set User = GetObject(\"WinNT://\" & strDomain & \"/\" & strUser & \",user\")\r\n    Response.Write User.LastLogin\r\n  End Sub\r\n\r\n\r\n4.18 Display User Last Logoff (NT 4.0 only) \r\n\r\n  Sub PullUserLastLogoff(strDomain,strUser)\r\n    Dim User\r\n    Set User = GetObject(\"WinNT://\" & strDomain & \"/\" & strUser & \",user\")\r\n    Response.Write User.LastLogoff\r\n  End Sub\r\n\r\n\r\n4.19 Display User Last Logoff (NT 4.0 only) \r\n\r\n  Sub PullUserLastLogoff(strDomain,strUser)\r\n    Dim User\r\n    Set User = GetObject(\"WinNT://\" & strDomain & \"/\" & strUser & \",user\")\r\n    Response.Write User.LastLogoff\r\n  End Sub\r\n\r\n\r\n4.20 Display User Logon Hours Restriction(NT 4.0 only) \r\n\r\n  Sub PullUserLogonHourRestriction(strDomain,strUser)\r\n    Dim User\r\n    Dim RegTime\r\n    Dim Restrict\r\n\r\n    Set User = GetObject(\"WinNT://\" & strDomain & \"/\" & strUser & \",user\")\r\n    For Each RegTime In User.LoginHours\r\n      If RegTime < 255 Then Restrict = True\r\n    Next\r\n    Response.write Restrict\r\n  End Sub\r\n\r\n\r\n \r\n5. Group Specific Fields\r\n\r\n5.1 Display All Users in a Group \r\n\r\n\r\n  Sub PullAllUserFromGroup(strDomain,strGroup)\r\n    Dim Group\r\n    Dim User\r\n    Set Group = GetObject(\"WinNT://\" & strDomain & \"/\" & strGroup & \",group\")\r\n    For Each User in Group.Members\r\n      Response.Write User.Name\r\n    Next\r\n  End Sub\r\n\r\n\r\n5.2 Display if a Users is listed in a Group \r\n\r\n  Sub DispUserInGroup(strDomain,strGroup,strUser)\r\n    Dim Group\r\n    Dim User\r\n    Set Group = GetObject(\"WinNT://\" & strDomain & \"/\" & strGroup & \",group\")\r\n    Set User = GetObject(\"WinNT://\" & strDomain & \"/\" & strUser & \",user\")\r\n    Response.Write Group.IsMember(User.ADsPath)\r\n  End Sub\r\n\r\n\r\n5.2 Display Group Description \r\n  \r\nSub PullGroupDescription(strDomain,strGroup,strUser)\r\n    Dim Group\r\n    Set Group = GetObject(\"WinNT://\" & strDomain & \"/\" & strGroup & \",group\")\r\n    Response.Write Group.Description\r\n  End Sub\r\n\r\n\r\n5.2 Display Which Group a User is Listed in \r\n\r\n  Sub DispUserInWhichGroup(strDomain,strGroup,strUser)\r\n    Dim Group\r\n    Dim User\r\n    Set User = GetObject(\"WinNT://\" & strDomain & \"/\" & strUser & \",user\")\r\n    For Each Group in User.Groups\r\n     Response.Write Group.Name\r\n    Next\r\n  End Sub","Declares":"","CodeCategory":{"CategoryId":"7","CategoryDescription":"Misc"},"Keywords":["ADSI","Active Directory"]},{"RecordId":"595","Title":"Format Phone Number As (xxx)xxx-xxxx","Description":"Formats a phone number in  (xxx)xxx-xxxx format.  Uses a timer that looks at the input box and reformats it as characters are entered.","Code":"<!-- TWO STEPS TO INSTALL FORMAT PHONE NUMBER:\r\n\r\n  1.  Copy the coding into the HEAD of your HTML document\r\n  2.  Add the last code into the BODY of your HTML document  -->\r\n\r\n\r\n<!-- STEP ONE: Paste this code into the HEAD of your HTML document  -->\r\n\r\n<HEAD>\r\n\r\n<SCRIPT LANGUAGE=\"JavaScript\">\r\n\r\nvar n;\r\nvar p;\r\nvar p1;\r\n\r\nfunction ValidatePhone(){\r\n\tp=p1.value\r\n\tif(p.length==3){\r\n\t\tpp=p;\r\n\t\td4=p.indexOf('(')\r\n\t\td5=p.indexOf(')')\r\n\t\tif(d4==-1){\r\n\t\t\tpp=\"(\"+pp;\r\n\t\t}\r\n\t\tif(d5==-1){\r\n\t\t\tpp=pp+\")\";\r\n\t\t}\r\n\t\tdocument.frmPhone.txtphone.value=\"\";\r\n\t\tdocument.frmPhone.txtphone.value=pp;\r\n\t}\r\n\tif(p.length>3){\r\n\t\td1=p.indexOf('(')\r\n\t\td2=p.indexOf(')')\r\n\t\tif (d2==-1){\r\n\t\t\tl30=p.length;\r\n\t\t\tp30=p.substring(0,4);\r\n\t\t\tp30=p30+\")\"\r\n\t\t\tp31=p.substring(4,l30);\r\n\t\t\tpp=p30+p31;\r\n\t\t\tdocument.frmPhone.txtphone.value=\"\";\r\n\t\t\tdocument.frmPhone.txtphone.value=pp;\r\n\t\t}\r\n\t}\r\n\tif(p.length>5){\r\n\t\tp11=p.substring(d1+1,d2);\r\n\t\tif(p11.length>3){\r\n\t\t\tp12=p11;\r\n\t\t\tl12=p12.length;\r\n\t\t\tl15=p.length\r\n\t\t\tp13=p11.substring(0,3);\r\n\t\t\tp14=p11.substring(3,l12);\r\n\t\t\tp15=p.substring(d2+1,l15);\r\n\t\t\tdocument.frmPhone.txtphone.value=\"\";\r\n\t\t\tpp=\"(\"+p13+\")\"+p14+p15;\r\n\t\t\tdocument.frmPhone.txtphone.value=pp;\r\n\t\t}\r\n\t\tl16=p.length;\r\n\t\tp16=p.substring(d2+1,l16);\r\n\t\tl17=p16.length;\r\n\t\tif(l17>3&&p16.indexOf('-')==-1){\r\n\t\t\tp17=p.substring(d2+1,d2+4);\r\n\t\t\tp18=p.substring(d2+4,l16);\r\n\t\t\tp19=p.substring(0,d2+1);\r\n\t\t\tpp=p19+p17+\"-\"+p18;\r\n\t\t\tdocument.frmPhone.txtphone.value=\"\";\r\n\t\t\tdocument.frmPhone.txtphone.value=pp;\r\n\t\t}\r\n\t}\r\n\r\n\tsetTimeout(ValidatePhone,100)\r\n}\r\n\r\nfunction getIt(m){\r\n\tn=m.name;\r\n\tp1=m;\r\n\tValidatePhone();\r\n}\r\n\r\nfunction testphone(obj1){\r\n\tp=obj1.value\r\n\tp=p.replace(\"(\",\"\")\r\n\tp=p.replace(\")\",\"\")\r\n\tp=p.replace(\"-\",\"\")\r\n\tp=p.replace(\"-\",\"\")\r\n\tif (isNaN(p)==true){\r\n\t\talert(\"Check phone\");\r\n\t\treturn false;\r\n\t}\r\n}\r\n</script>\r\n</HEAD>\r\n\r\n\r\n<!-- STEP TWO: Copy this code into the BODY of your HTML document  -->\r\n\r\n<form name=frmPhone>\r\n<font size=\"4\" color=\"#0000FF\"><b>Enter Telephone Number</b></font><br>\r\n<input type=text name=txtphone maxlength=\"13\" onclick=\"javascript:getIt(this)\" >\r\n</form>","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["Phone Number","Format Phone Number"]},{"RecordId":"596","Title":"Turn Of AutoComplete On Text Fields","Description":"Turns off IE's AutoComplete feature for text boxes (most importantly, password boxes).","Code":"Use AutoComplete = \"Off\" on the text box.\r\n\r\n<INPUT TYPE=\"password\" AUTOCOMPLETE=\"off\">","Declares":"","CodeCategory":{"CategoryId":"9","CategoryDescription":"HTML"},"Keywords":["AutoComplete","Password Protect"]},{"RecordId":"597","Title":"Allow Only Numeric Characters In Textbox","Description":"Allow Only Numeric Characters In Textbox (IE only)","Code":"To use this function, simply call it as an \"onkeypress()\" event handler in your <INPUT> tag in your HTML code.\r\n\r\nfunction CheckNumeric() {\r\n\r\n   // Get ASCII value of key that user pressed\r\n   var key = window.event.keyCode;\r\n\r\n   // Was key that was pressed a numeric character (0-9)?\r\n   if ( key > 47 && key < 58 )\r\n      return; // if so, do nothing\r\n   else\r\n      window.event.returnValue = null;    // otherwise, discard character\r\n}\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["CheckNumeric","Numeric Characters","On Keypress"]},{"RecordId":"598","Title":"SQL Server Data Types","Description":"SQL Server 2K data types","Code":"-------------------------------------------------------------------------\r\nExact Numerics\r\n-------------------------------------------------------------------------\r\nbigint\r\nInteger (whole number) data from -2^63 (-9223372036854775808) through 2^63-1 (9223372036854775807).\r\n\r\nint\r\nInteger (whole number) data from -2^31 (-2,147,483,648) through 2^31 - 1 (2,147,483,647).\r\n\r\nsmallint\r\nInteger data from 2^15 (-32,768) through 2^15 - 1 (32,767).\r\n\r\ntinyint\r\nInteger data from 0 through 255.\r\n\r\nbit\r\nInteger data with either a 1 or 0 value.\r\n\r\ndecimal\r\nFixed precision and scale numeric data from -10^38 +1 through 10^38 - 1. \r\n\r\nnumeric\r\nFunctionally equivalent to decimal.\r\n\r\nmoney\r\nMonetary data values from -2^63 (-922,337,203,685,477.5808) through 2^63 - 1 (+922,337,203,685,477.5807), with accuracy to a ten-thousandth of a monetary unit.\r\n\r\nsmallmoney\r\nMonetary data values from -214,748.3648 through +214,748.3647, with accuracy to a ten-thousandth of a monetary unit.\r\n\r\n-------------------------------------------------------------------------\r\nApproximate Numerics\r\n-------------------------------------------------------------------------\r\nfloat\r\nFloating precision number data from -1.79E + 308 through 1.79E + 308.\r\n\r\nreal\r\nFloating precision number data from -3.40E + 38 through 3.40E + 38.\r\n\r\ndatetime and smalldatetime\r\n\r\ndatetime\r\nDate and time data from January 1, 1753, through December 31, 9999, with an accuracy of three-hundredths of a second, or 3.33 milliseconds.\r\n\r\nsmalldatetime\r\nDate and time data from January 1, 1900, through June 6, 2079, with an accuracy of one minute.\r\n\r\n-------------------------------------------------------------------------\r\nCharacter Strings\r\n-------------------------------------------------------------------------\r\nchar\r\nFixed-length non-Unicode character data with a maximum length of 8,000 characters.\r\n\r\nvarchar\r\nVariable-length non-Unicode data with a maximum of 8,000 characters.\r\n\r\ntext\r\nVariable-length non-Unicode data with a maximum length of 2^31 - 1 (2,147,483,647) characters.\r\n\r\n-------------------------------------------------------------------------\r\nUnicode Character Strings\r\n-------------------------------------------------------------------------\r\nnchar\r\nFixed-length Unicode data with a maximum length of 4,000 characters. \r\n\r\nnvarchar\r\nVariable-length Unicode data with a maximum length of 4,000 characters. sysname is a system-supplied user-defined data type that is functionally equivalent to nvarchar(128) and is used to reference database object names.\r\n\r\nntext\r\nVariable-length Unicode data with a maximum length of 2^30 - 1 (1,073,741,823) characters.\r\n\r\n-------------------------------------------------------------------------\r\nBinary Strings\r\n-------------------------------------------------------------------------\r\nbinary\r\nFixed-length binary data with a maximum length of 8,000 bytes.\r\n\r\nvarbinary\r\nVariable-length binary data with a maximum length of 8,000 bytes.\r\n\r\nimage\r\nVariable-length binary data with a maximum length of 2^31 - 1 (2,147,483,647) bytes.\r\n\r\n-------------------------------------------------------------------------\r\nOther Data Types\r\n-------------------------------------------------------------------------\r\ncursor\r\nA reference to a cursor.\r\n\r\nsql_variant\r\nA data type that stores values of various SQL Server-supported data types, except text, ntext, timestamp, and sql_variant.\r\n\r\ntable\r\nA special data type used to store a result set for later processing .\r\n\r\ntimestamp\r\nA database-wide unique number that gets updated every time a row gets updated.\r\n\r\nuniqueidentifier\r\nA globally unique identifier (GUID).\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"10","CategoryDescription":"SQL Server"},"Keywords":["Data Types"]},{"RecordId":"599","Title":"Remove IE Private Branding","Description":"How to remove private branding such as \"IE Provided by ...\"","Code":"rundll32 iedkcs32.dll,Clear\r\n\r\nSearch the registry for \"Microsoft Internet Explorer by ...\" and make it whatever you want.\r\n\r\nSearch the registry for the following and clear their contents (these are the icons):\r\n  bigbitmap\r\n  brandbitmap\r\n  smallbitmap\r\n  smbrandbitmap","Declares":"","CodeCategory":{"CategoryId":"7","CategoryDescription":"Misc"},"Keywords":["IE Branding","Branding"]},{"RecordId":"600","Title":"Countdown Re Direct Timer","Description":"Shows countdown timer prior to redirection","Code":"<!-- TWO STEPS TO INSTALL COUNTDOWN REDIRECT:\r\n  1.  Copy the coding into the HEAD of your HTML document\r\n  2.  Add the last code into the BODY of your HTML document  -->\r\n\r\n<!-- STEP ONE: Paste this code into the HEAD of your HTML document  -->\r\n\r\n<HEAD>\r\n<SCRIPT LANGUAGE=\"JavaScript\">\r\n<!-- Begin\r\nvar start=new Date();\r\n\tstart=Date.parse(start)/1000;\r\n\tvar counts=10;\r\n\tfunction CountDown(){\r\n\t\tvar now=new Date();\r\n\t\tnow=Date.parse(now)/1000;\r\n\t\tvar x=parseInt(counts-(now-start),10);\r\n\t\tif(document.form1){document.form1.clock.value = x;}\r\n\t\tif(x>0){\r\n\t\t\ttimerID=setTimeout(\"CountDown()\", 100)\r\n\t\t}else{\r\n\t\t\tlocation.href=\"http://javascript.internet.com\"\r\n\t\t}\r\n\t}\r\n//  End -->\r\n</script>\r\n<SCRIPT LANGUAGE=\"JavaScript\">\r\n<!--\r\nwindow.setTimeout('CountDown()',100);\r\n-->\r\n</script>\r\n\r\n</HEAD>\r\n\r\n<!-- STEP TWO: Copy this code into the BODY of your HTML document  -->\r\n\r\n<BODY>\r\n\r\n<FORM NAME=\"form1\">\r\nYou are being redirected in \r\n<INPUT TYPE=\"text\" NAME=\"clock\" SIZE=\"2\" VALUE=\"10\"> \r\nseconds.\r\n</FORM>\r\n","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["Countdown Timer","Redirect Timer"]},{"RecordId":"601","Title":"Read Binary File Using ADODB.Stream","Description":"Demonstrates how to use an ADODB.Stream object to read a binary file from the file system","Code":"Function BinFileRead(strFileName)\r\n\r\n Dim varOut\r\n Dim objStream, oFileSys, oDeleteFile\r\n\r\n strFileName = replace(strFileName, \"\\\", \"/\")\r\n set objStream = Server.CreateObject(\"ADODB.Stream\")\r\n objStream.Open\r\n  objStream.Type = adTypeBinary 'get BIN data from filesystem\r\n  objStream.LoadFromFile strFileName\r\n  varOut = objStream.Read\r\n objStream.Close\r\n Set objStream = Nothing \r\n\r\n BinFileRead = varOut\r\n\r\nEnd Function\r\n","Declares":"","CodeCategory":{"CategoryId":"5","CategoryDescription":"ASP"},"Keywords":["Stream","Binary Read"]},{"RecordId":"603","Title":"FTP Via VB Script and DOS","Description":"Demonstrates how to use VB script to control DOS FTP with a script file.  This code even uses the FileSystemObject to create the FTP command file on the fly.","Code":"'FTP grabber for the SAP feed\r\n\r\n\r\nDim strMemberLoadPath           'drive letter\r\nDim strFTPSite\r\n\r\n'===============\r\n\r\n'call Main() ' commented because DTS takes care of it...\r\n\r\n\r\nSub InitVars()\r\nDim strComputerName\r\n\r\non error resume next\r\n\r\n    strComputerName = \"ushernt335\"\r\n\r\n    Select Case strComputerName\r\n        Case \"ushernt06\"\r\n            strMemberLoadPath = \"c:\\peopleadd\"\r\n            strLDAP_Root = \"LDAP://ushernt141:1004/\"   '\"LDAP://ushernt141:1004/\"\r\n            strFTPSite = \"uswebnt03\"\r\n        Case \"ushernt335\"\r\n            strMemberLoadPath = \"c:\\peopleadd\"\r\n            strLDAP_Root = \"LDAP://ushernt331:1003/\"\r\n            strFTPSite = \"uswebnt03\"\r\n        Case \"pscsacopela2k01\"\r\n            strLDAP_Root = \"LDAP://ushernt331:1003/\"\r\n            strMemberLoadPath = \"W:\\peopleadd\"\r\n            strFTPSite = \"uswebnt03\"\r\n    End Select\r\n        \r\n\r\n    Exit Sub\r\n        \r\nEnd Sub\r\n\r\n'===============\r\n\r\nSub RunFTP()\r\ndim oChunkFile, strFTPScript\r\ndim i, objWSHShell\r\n\r\nDim LFile, objFS\r\ndim ForAppending\r\ndim TristateFalse\r\n\r\nForAppending = 8\r\nTristateFalse = 0\r\n\r\n\tstrFTPScript = strMemberLoadPath & \"\\sap.ftp\"\r\n\r\n        Set objFS = CreateObject(\"Scripting.FileSystemObject\")\r\n        Set LFile = objFS.OpenTextFile(strFTPScript, ForAppending, True, TristateFalse)\r\n        LFile.Write \"user MyDomain\\MUserID MyPassword \" & vbCrLf 'change later because this is test area ONLY!!!\r\n        LFile.Write \"binary \" & vbCrLf\r\n        LFile.Write \"cd /erslinknet03/tools\" & vbCrLf\r\n        LFile.Write \"lcd \" & Replace(strMemberLoadPath, \"/\", \"\\\") & vbCrLf\r\n        LFile.Write \"mget *.txt\" & vbCrLf\r\n        LFile.Write \"y\" & vbCrLf\r\n        LFile.Write \"close \" & vbCrLf\r\n        LFile.Write \"bye \" & vbCrLf\r\n        LFile.Close\r\n        Set objFS = Nothing\r\n        \r\n        Set objWSHShell = CreateObject(\"WScript.Shell\")\r\n        strShellCmd = \"FTP -n -s:\"\"\" & replace(strFTPScript, \"\\\", \"/\") & \"\"\" \" & strFTPSite\r\n        i = objWSHShell.Run(strShellCmd, 1, True)\r\n        Set objWSHShell = Nothing\r\n\r\n\tSet objFS = CreateObject(\"Scripting.FileSystemObject\")\r\n\tSet oChunkFile = objFS.GetFile(strFTPScript)\r\n\toChunkFile.Delete()\r\n\tSet oChunkFile = Nothing\r\n        Set objFS = Nothing\r\n\r\nEnd Sub\r\n\r\n'=================\r\n\r\nfunction Main()\r\n\r\n    \r\n    Call InitVars\r\n    Call RunFTP()\r\n\r\n    Main = DTSTaskExecResult_Success\r\n    \r\nEnd function\r\n\r\n'===============\r\n","Declares":"","CodeCategory":{"CategoryId":"7","CategoryDescription":"Misc"},"Keywords":["FTP","DOS Batch"]},{"RecordId":"604","Title":"Send Users To Their IE Home Page","Description":"Sends user to their home page (as configured in IE).  Only works in IE.","Code":"<INPUT \r\n  TYPE=\"button\" \r\n  VALUE=\"Your Home\" \r\n  onClick=\"parent.location='about:home'\">","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["Home Page","HomePage"]},{"RecordId":"605","Title":"List All Tables and Columns In a DB (Stored Procedure)","Description":"Stored procedure to list all tables and columns in a database","Code":"/*************************************************************************/\r\n/* \r\nSTORED PROCEDURE \r\n~~~~~~~~~~~~~~~~\r\nNAME            :  spro_ListAllColumns\r\nPURPOSE         :  To LIST ALL COLUMNS AND TABLES IN A DATABASE\r\nAUTHOR          :  ABHAY PATNY\r\nEMAIL           :  sendtoabhay@yahoo.com\r\nCREATED ON\t:  JANUARY 22, 2002\r\nLAST MODIFIED ON:  FEBRUARY 12,2002\r\n\r\nPARAMETERS\r\n~~~~~~~~~~\r\n@dbname\t--\tName of Database to be Searched\r\n\t\t\tDefault is 'pubs'\r\n\r\nEXAMPLES\r\n~~~~~~~~\r\n\r\nEXEC spro_ListAllColumns\r\n\r\nEXEC spro_ListAllColumns 'mydatabase'\r\n\r\n*/\r\nCREATE PROC  spro_ListAllColumns\r\n\r\n@dbname\tVARCHAR (50) ='pubs'\r\n\r\nAS\r\n\r\nSET NOCOUNT ON\r\n\r\n\tDECLARE @tablename VARCHAR (50)\r\n\tDECLARE @fieldname VARCHAR(100),@type VARCHAR (20),@len INT\r\n\tDECLARE @temp VARCHAR(1000)\r\n\r\n\t-- Checking Whether th Database Exist or Not\r\n\tIF NOT EXISTS (SELECT name FROM master..sysdatabases WHERE name =@dbname) \r\n\tBEGIN\r\n\t\tRAISERROR ('Database does not exist',16,1)\r\n\t\tRETURN -1\r\n\tEND\r\n\r\n\t-- Checking Whether the user has Permissions for the Database\r\n\tIF HAS_DBACCESS (QUOTENAME(@dbname))=0\r\n\tBEGIN\r\n\t\tRAISERROR ('You DO NOT HAVE PERMISSIONS onn the Database',16,1)\r\n\t\tRETURN -1\r\n\tEND\r\n\t\r\n\tPRINT '~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~'\r\n\tPRINT 'List of All the Fields in Database : ' + UPPER(@dbname)\r\n\tPRINT '~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~'\r\n\r\n\tEXEC ('DECLARE cur2 CURSOR \tFOR select name from ' + @dbname + '..sysobjects where type=''U'' order by name')\r\n\tOPEN cur2\r\n\tFETCH NEXT FROM cur2 INTO @tablename\r\n\t\tWHILE (@@fetch_status <> -1)\r\n\t\tBEGIN\r\n\t\t\tPRINT ''\r\n\t\t\tPRINT 'TABLE : ' + @tablename \r\n\t\t\tPRINT '~~~~~'\r\n\t\t\tSET @temp= 'DECLARE cur3 CURSOR FOR SELECT B.name as ''FIELD NAME'',C.name as ''DATA TYPE'' ,B.length as ''LENGTH'' FROM '+ @dbname +'..sysobjects A'\r\n\t\t\tSET @temp = @temp + ' INNER JOIN '+ @dbname +'..syscolumns B ON  A.id=B.id INNER JOIN '+ @dbname +'..systypes C ON B.xtype=C.xtype'\r\n\t\t\tSET @temp = @temp + ' WHERE A.type=''U'' and A.name=''' + @tablename + ''' ORDER BY B.name'\r\n\r\n\t\t\tEXEC (@temp)\r\n\r\n\t\t\tOPEN cur3\r\n\t\t\tFETCH NEXT FROM cur3 INTO @fieldname,@type,@len\r\n\t\t\t\tWHILE (@@fetch_status <> -1)\r\n\t\t\t\tBEGIN\r\n\t\t\t\t\tPRINT '          ' + @fieldname + '    [' + @type + ' (' + LTRIM(RTRIM(STR(@len))) + ')]'\r\n\r\n\t\t\t\tFETCH NEXT FROM cur3 INTO @fieldname,@type,@len\r\n\t\t\t\tEND\r\n\t\t\tCLOSE cur3\r\n\t\t\tDEALLOCATE cur3\r\n\t\tFETCH NEXT FROM cur2 INTO @tablename\r\n\t\tEND\r\n\tCLOSE cur2\r\n\tDEALLOCATE cur2\r\nGO\r\n\r\n/*************************************************************************/","Declares":"","CodeCategory":{"CategoryId":"6","CategoryDescription":"T-SQL"},"Keywords":["List All Columns","List All Tables"]},{"RecordId":"606","Title":"Compare SQL Server Databases (Stored Procedure)","Description":"Stored Procedure to compare SQL Server database (and optionally, data in tables)","Code":"How to Run sp_CompareDB Stored Procedure\r\n\r\nOnce the stored procedure has been created, simply run:\r\n\r\nsp_CompareDB <dbName1>,<dbName2>\r\n\r\nAnd enjoy seeing the differences.\r\n\r\nIf you are comparing a database from a linked server, then the command would be:\r\n\r\nsp_CompareDB <LinkedServer1>.<dbName1>,<dbName2>\r\n\r\nYou can use the following parameters for the SP, besides the obvious db1 name (parameter name @db1) and db2 name (parameter name @db2).\r\n\r\n@TabList - comma separated list of tables to compare. If empty - all tables in the databases should be compared\r\n\r\n@NumbToShow - number of rows with differences to show. Default - 10. Be cautious increasing it. For tables with a unique key just the keys of rows with differences should be shown. But for tables without a unique key, all data for rows with differences are shown. After all its unlikely that somebody needs a boundless report to get lost in the ocean of digits and letters. If databases are completely different then there is no sense comparing them.\r\n\r\n@OnlyStructure - flag being set to 1 allows you to avoid data comparing. Only structures should be compared. Default 0.\r\n\r\n@NoTimestamp - flag being set to 1 allows you to avoid comparing of columns with timestamp data type. Default 0.\r\n\r\n@VerboseLevel - flag being set to 1 lets you see queries used for data comparison. They can be used easily to synchronize data in the databases if you need it. Default 0.\r\n\r\n-------------------------------------------------------------------------------------------------------------------\r\nHere's the stored procedure\r\n-------------------------------------------------------------------------------------------------------------------\r\n\r\n\r\nUSE Master\r\nGO\r\nIF EXISTS (SELECT * FROM sysobjects WHERE name = 'sp_CompareDB' and type = 'P')\r\nDROP PROC sp_CompareDB\r\nGO\r\n--------------------------------------------------------------------------------------------\r\n-- sp_CompareDB\r\n-- \r\n-- The SP compares structures and data in 2 databases.\r\n-- 1. Compares if all tables in one database have analog (by name) in second database\r\n-- Tables not existing in one of databases won't be used for data comparing\r\n-- 2. Compares if structures for tables with the same names are the same. Shows structural\r\n-- differences like:\r\n-- authors\r\n-- Column Phone: in db1 - char(12), in db2 - char(14)\r\n-- sales\r\n-- Column Location not in db2\r\n-- Tables, having different structures, won't be used for data comparing. However if the tables\r\n-- contain columns of the same type and different length (like Phone in the example above) or\r\n-- tables have compatible data types (have the same type in syscolumns - char and nchar, \r\n-- varchar and nvarchar etc) they will be allowed for data comparing.\r\n-- 3. Data comparison itself. \r\n-- 3.1 Get information about unique keys in the tables. If there are unique keys then one of them\r\n-- (PK is a highest priority candidate for this role) will be used to specify rows with\r\n-- different data.\r\n-- 3.2 Get information about all data columns in the table and form predicates that will be \r\n-- used to compare data.\r\n-- 3.3 Compare data with the criteria:\r\n-- a. if some unique keys from the table from first database do not exist in second db (only\r\n-- for tables with a unique key)\r\n-- b. if some unique keys from the table from second database do not exist in first db (only\r\n-- for tables with a unique key)\r\n-- c. if there are rows with the same values of unique keys and different data in other\r\n-- columns (only for tables with a unique key)\r\n-- d. if there are rows in the table from first database that don't have a twin in the \r\n-- table from second db\r\n-- e. if there are rows in the table from second database that don't have a twin in the \r\n-- table from first db\r\n--------------------------------------------------------------------------------------------\r\n-- Parameters:\r\n-- 1. @db1 - name of first database to compare\r\n-- 2. @db2 - name of second database to compare\r\n-- 3. @TabList - list of tables to compare. if empty - all tables in the databases should be\r\n-- compared\r\n-- 4. @NumbToShow - number of rows with differences to show. Default - 10.\r\n-- 5. @OnlyStructure - flag, if set to 1, allows to avoid data comparing. Only structures should\r\n-- be compared. Default - 0\r\n-- 6. @NoTimestamp - flag, if set to 1, allows to avoid comparing of columns of timestamp\r\n-- data type. Default - 0\r\n-- 7. @VerboseLevel - if set to 1 allows to print querues used for data comparison\r\n--------------------------------------------------------------------------------------------\r\n-- Created by Viktor Gorodnichenko (c)\r\n-- Created on: July 5, 2001\r\n--------------------------------------------------------------------------------------------\r\nCREATE PROC sp_CompareDB\r\n@db1 varchar(128),\r\n@db2 varchar(128),\r\n@OnlyStructure bit = 0,\r\n@TabList varchar(8000) = '',\r\n@NumbToShow int = 10,\r\n@NoTimestamp bit = 0,\r\n@VerboseLevel tinyint = 0\r\nAS\r\nif @OnlyStructure <> 0\r\nset @OnlyStructure = 1\r\nif @NoTimestamp <> 0\r\nset @NoTimestamp = 1\r\nif @VerboseLevel <> 0\r\nset @VerboseLevel = 1\r\n\r\nSET NOCOUNT ON\r\nSET ANSI_WARNINGS ON\r\nSET ANSI_NULLS ON\r\ndeclare @sqlStr varchar(8000)\r\nset nocount on\r\n-- Checking if there are specified databases\r\ndeclare @SrvName sysname\r\ndeclare @DBName sysname\r\nset @db1 = RTRIM(LTRIM(@db1))\r\nset @db2 = RTRIM(LTRIM(@db2))\r\nset @SrvName = @@SERVERNAME\r\nif CHARINDEX('.',@db1) > 0\r\nbegin\r\nset @SrvName = LEFT(@db1,CHARINDEX('.',@db1)-1)\r\nif not exists (select * from master.dbo.sysservers where srvname = @SrvName)\r\nbegin\r\nprint 'There is no linked server named '+@SrvName+'. End of work.'\r\nreturn \r\nend\r\nset @DBName = RIGHT(@db1,LEN(@db1)-CHARINDEX('.',@db1))\r\nend\r\nelse\r\nset @DBName = @db1\r\nexec ('declare @Name sysname select @Name=name from ['+@SrvName+'].master.dbo.sysdatabases where name = '''+@DBName+'''')\r\nif @@rowcount = 0\r\nbegin\r\nprint 'There is no database named '+@db1+'. End of work.'\r\nreturn \r\nend\r\nset @SrvName = @@SERVERNAME\r\nif CHARINDEX('.',@db2) > 0\r\nbegin\r\nset @SrvName = LEFT(@db2,CHARINDEX('.',@db2)-1)\r\nif not exists (select * from master.dbo.sysservers where srvname = @SrvName)\r\nbegin\r\nprint 'There is no linked server named '+@SrvName+'. End of work.'\r\nreturn \r\nend\r\nset @DBName = RIGHT(@db2,LEN(@db2)-CHARINDEX('.',@db2))\r\nend\r\nelse\r\nset @DBName = @db2\r\nexec ('declare @Name sysname select @Name=name from ['+@SrvName+'].master.dbo.sysdatabases where name = '''+@DBName+'''')\r\nif @@rowcount = 0\r\nbegin\r\nprint 'There is no database named '+@db2+'. End of work.'\r\nreturn \r\nend\r\n\r\nprint Replicate('-',LEN(@db1)+LEN(@db2)+25)\r\nprint 'Comparing databases '+@db1+' and '+@db2\r\nprint Replicate('-',LEN(@db1)+LEN(@db2)+25)\r\nprint 'Options specified:'\r\nprint ' Compare only structures: '+CASE WHEN @OnlyStructure = 0 THEN 'No' ELSE 'Yes' END\r\nprint ' List of tables to compare: '+CASE WHEN LEN(@TabList) = 0 THEN ' All tables' ELSE @TabList END\r\nprint ' Max number of different rows in each table to show: '+LTRIM(STR(@NumbToShow))\r\nprint ' Compare timestamp columns: '+CASE WHEN @NoTimestamp = 0 THEN 'No' ELSE 'Yes' END\r\nprint ' Verbose level: '+CASE WHEN @VerboseLevel = 0 THEN 'Low' ELSE 'High' END\r\n\r\n-----------------------------------------------------------------------------------------\r\n-- Comparing structures\r\n-----------------------------------------------------------------------------------------\r\nprint CHAR(10)+Replicate('-',36)\r\nprint 'Comparing structure of the databases'\r\nprint Replicate('-',36)\r\nif exists (select * from tempdb.dbo.sysobjects where name like '#TabToCheck%')\r\ndrop table #TabToCheck\r\ncreate table #TabToCheck (name sysname)\r\ndeclare @NextCommaPos int\r\nif len(@TabList) > 0 \r\nbegin\r\nwhile 1=1\r\nbegin\r\nset @NextCommaPos = CHARINDEX(',',@TabList)\r\nif @NextCommaPos = 0\r\nbegin\r\nset @sqlstr = 'insert into #TabToCheck values('''+@TabList+''')'\r\nexec (@sqlstr)\r\nbreak\r\nend\r\nset @sqlstr = 'insert into #TabToCheck values('''+LEFT(@TabList,@NextCommaPos-1)+''')'\r\nexec (@sqlstr)\r\nset @TabList = RIGHT(@TabList,LEN(@TabList)-@NextCommaPos)\r\nend\r\nend\r\nelse -- then will check all tables\r\nbegin\r\nexec ('insert into #TabToCheck select name from '+@db1+'.dbo.sysobjects where type = ''U''')\r\nexec ('insert into #TabToCheck select name from '+@db2+'.dbo.sysobjects where type = ''U''')\r\nend\r\n-- First check if at least one table specified in @TabList exists in db1\r\nexec ('declare @Name sysname select @Name=name from '+@db1+'.dbo.sysobjects where name in (select * from #TabToCheck)')\r\nif @@rowcount = 0\r\nbegin\r\nprint 'No tables in '+@db1+' to check. End of work.'\r\nreturn\r\nend\r\n-- Check if tables existing in db1 are in db2 (all tables or specified in @TabList)\r\nif exists (select * from tempdb.dbo.sysobjects where name like '#TabNotInDB2%')\r\ndrop table #TabNotInDB2\r\ncreate table #TabNotInDB2 (name sysname)\r\ninsert into #TabNotInDB2 \r\nexec ('select name from '+@db1+'.dbo.sysobjects d1o '+\r\n'where name in (select * from #TabToCheck) and '+\r\n' d1o.type = ''U'' and not exists '+\r\n'(select * from '+@db2+'.dbo.sysobjects d2o'+\r\n' where d2o.type = ''U'' and d2o.name = d1o.name)')\r\nif @@rowcount > 0\r\nbegin\r\nprint CHAR(10)+'The table(s) exist in '+@db1+', but do not exist in '+@db2+':'\r\nselect * from #TabNotInDB2 \r\nend\r\ndelete from #TabToCheck where name in (select * from #TabNotInDB2)\r\ndrop table #TabNotInDB2\r\n\r\nif exists (select * from tempdb.dbo.sysobjects where name like '#TabNotInDB1%')\r\ndrop table #TabNotInDB1\r\ncreate table #TabNotInDB1 (name sysname)\r\ninsert into #TabNotInDB1 \r\nexec ('select name from '+@db2+'.dbo.sysobjects d1o '+\r\n'where name in (select * from #TabToCheck) and '+\r\n' d1o.type = ''U'' and not exists '+\r\n'(select * from '+@db1+'.dbo.sysobjects d2o'+\r\n' where d2o.type = ''U'' and d2o.name = d1o.name)')\r\nif @@rowcount > 0\r\nbegin\r\nprint CHAR(10)+'The table(s) exist in '+@db2+', but do not exist in '+@db1+':'\r\nselect * from #TabNotInDB1 \r\nend\r\ndelete from #TabToCheck where name in (select * from #TabNotInDB1)\r\ndrop table #TabNotInDB1\r\n-- Comparing structures of tables existing in both dbs\r\nprint CHAR(10)+'Checking if there are tables existing in both databases having structural differences ...'+CHAR(10)\r\nif exists (select * from tempdb.dbo.sysobjects where name like '#DiffStructure%')\r\ndrop table #DiffStructure\r\ncreate table #DiffStructure (name sysname)\r\nset @sqlStr='\r\ndeclare @TName1 sysname, @TName2 sysname, @CName1 sysname, @CName2 sysname,\r\n@TypeName1 sysname, @TypeName2 sysname,\r\n@CLen1 smallint, @CLen2 smallint, @Type1 sysname, @Type2 sysname, @PrevTName sysname\r\ndeclare @DiffStructure bit\r\ndeclare Diff cursor fast_forward for\r\nselect d1o.name, d2o.name, d1c.name, d2c.name, d1t.name, d2t.name,\r\nd1c.length, d2c.length, d1c.type, d2c.type\r\nfrom ('+@db1+'.dbo.sysobjects d1o \r\nJOIN '+@db2+'.dbo.sysobjects d2o2 ON d1o.name = d2o2.name and d1o.type = ''U'' --only tables in both dbs\r\nand d1o.name in (select * from #TabToCheck)\r\nJOIN '+@db1+'.dbo.syscolumns d1c ON d1o.id = d1c.id\r\nJOIN '+@db1+'.dbo.systypes d1t ON d1c.xusertype = d1t.xusertype)\r\nFULL JOIN ('+@db2+'.dbo.sysobjects d2o \r\nJOIN '+@db1+'.dbo.sysobjects d1o2 ON d1o2.name = d2o.name and d2o.type = ''U'' --only tables in both dbs\r\nand d2o.name in (select * from #TabToCheck)\r\nJOIN '+@db2+'.dbo.syscolumns d2c ON d2c.id = d2o.id\r\nJOIN '+@db2+'.dbo.systypes d2t ON d2c.xusertype = d2t.xusertype)\r\nON d1o.name = d2o.name and d1c.name = d2c.name\r\nWHERE (not exists \r\n(select * from '+@db2+'.dbo.sysobjects d2o2\r\nJOIN '+@db2+'.dbo.syscolumns d2c2 ON d2o2.id = d2c2.id\r\nJOIN '+@db2+'.dbo.systypes d2t2 ON d2c2.xusertype = d2t2.xusertype\r\nwhere d2o2.type = ''U''\r\nand d2o2.name = d1o.name \r\nand d2c2.name = d1c.name \r\nand d2t2.name = d1t.name\r\nand d2c2.length = d1c.length)\r\nOR not exists \r\n(select * from '+@db1+'.dbo.sysobjects d1o2\r\nJOIN '+@db1+'.dbo.syscolumns d1c2 ON d1o2.id = d1c2.id\r\nJOIN '+@db1+'.dbo.systypes d1t2 ON d1c2.xusertype = d1t2.xusertype\r\nwhere d1o2.type = ''U''\r\nand d1o2.name = d2o.name \r\nand d1c2.name = d2c.name \r\nand d1t2.name = d2t.name\r\nand d1c2.length = d2c.length))\r\norder by coalesce(d1o.name,d2o.name), d1c.name\r\nopen Diff\r\nfetch next from Diff into @TName1, @TName2, @CName1, @CName2, @TypeName1, @TypeName2,\r\n@CLen1, @CLen2, @Type1, @Type2\r\nset @PrevTName = ''''\r\nset @DiffStructure = 0\r\nwhile @@fetch_status = 0\r\nbegin\r\nif Coalesce(@TName1,@TName2) <> @PrevTName\r\nbegin\r\nif @PrevTName <> '''' and @DiffStructure = 1\r\nbegin\r\ninsert into #DiffStructure values (@PrevTName)\r\nset @DiffStructure = 0\r\nend\r\nset @PrevTName = Coalesce(@TName1,@TName2)\r\nprint @PrevTName\r\nend\r\nif @CName2 is null\r\nprint '' Colimn ''+RTRIM(@CName1)+'' not in '+@db2+'''\r\nelse\r\nif @CName1 is null\r\nprint '' Colimn ''+RTRIM(@CName2)+'' not in '+@db1+'''\r\nelse\r\nif @TypeName1 <> @TypeName2\r\nprint '' Colimn ''+RTRIM(@CName1)+'': in '+@db1+' - ''+RTRIM(@TypeName1)+'', in '+@db2+' - ''+RTRIM(@TypeName2)\r\nelse --the columns are not null(are in both dbs) and types are equal,then length are diff\r\nprint '' Colimn ''+RTRIM(@CName1)+'': in '+@db1+' - ''+RTRIM(@TypeName1)+''(''+\r\nLTRIM(STR(CASE when @TypeName1=''nChar'' or @TypeName1 = ''nVarChar'' then @CLen1/2 else @CLen1 end))+\r\n''), in '+@db2+' - ''+RTRIM(@TypeName2)+''(''+\r\nLTRIM(STR(CASE when @TypeName1=''nChar'' or @TypeName1 = ''nVarChar'' then @CLen2/2 else @CLen2 end))+'')''\r\nif @Type1 = @Type2\r\nset @DiffStructure=@DiffStructure -- Do nothing. Cannot invert predicate\r\nelse\r\nset @DiffStructure = 1\r\nfetch next from Diff into @TName1, @TName2, @CName1, @CName2, @TypeName1, @TypeName2,\r\n@CLen1, @CLen2, @Type1, @Type2\r\nend\r\ndeallocate Diff\r\nif @DiffStructure = 1\r\ninsert into #DiffStructure values (@PrevTName)\r\n'\r\nexec (@sqlStr)\r\nif (select count(*) from #DiffStructure) > 0\r\nbegin\r\nprint CHAR(10)+'The table(s) have the same name and different structure in the databases:'\r\nselect distinct * from #DiffStructure \r\ndelete from #TabToCheck where name in (select * from #DiffStructure)\r\nend\r\nelse\r\nprint CHAR(10)+'There are no tables with the same name and structural differences in the databases'+CHAR(10)+CHAR(10)\r\nif @OnlyStructure = 1\r\nbegin\r\nprint 'The option ''Only compare structures'' was specified. End of work.'\r\nreturn\r\nend\r\nexec ('declare @Name sysname select @Name=d1o.name\r\nfrom '+@db1+'.dbo.sysobjects d1o, '+@db2+'.dbo.sysobjects d2o \r\nwhere d1o.name = d2o.name and d1o.type = ''U'' and d2o.type = ''U''\r\nand d1o.name not in (''dtproperties'') \r\nand d1o.name in (select * from #TabToCheck)')\r\nif @@rowcount = 0\r\nbegin\r\nprint 'There are no tables with the same name and structure in the databases to compare. End of work.'\r\nreturn\r\nend\r\n\r\n\r\n-----------------------------------------------------------------------------------------\r\n-- Comparing data \r\n-----------------------------------------------------------------------------------------\r\n-- ##CompareStr - will be used to pass comparing strings into dynamic script\r\n-- to execute the string\r\nif exists (select * from tempdb.dbo.sysobjects where name like '##CompareStr%')\r\ndrop table ##CompareStr\r\ncreate table ##CompareStr (Ind int, CompareStr varchar(8000))\r\n\r\nif exists (select * from tempdb.dbo.sysobjects where name like '#DiffTables%')\r\ndrop table #DiffTables\r\ncreate table #DiffTables (Name sysname)\r\nif exists (select * from tempdb.dbo.sysobjects where name like '#IdenticalTables%')\r\ndrop table #IdenticalTables\r\ncreate table #IdenticalTables (Name sysname)\r\nif exists (select * from tempdb.dbo.sysobjects where name like '#EmptyTables%')\r\ndrop table #EmptyTables\r\ncreate table #EmptyTables (Name sysname)\r\nif exists (select * from tempdb.dbo.sysobjects where name like '#NoPKTables%')\r\ndrop table #NoPKTables\r\ncreate table #NoPKTables (Name sysname)\r\n\r\nif exists (select * from tempdb.dbo.sysobjects where name like '#IndList1%')\r\ntruncate table #IndList1\r\nelse \r\ncreate table #IndList1 (IndId int, IndStatus int,\r\nKeyAndStr varchar(7000), KeyCommaStr varchar(1000))\r\nif exists (select * from tempdb.dbo.sysobjects where name like '#IndList2%')\r\ntruncate table #IndList2\r\nelse\r\ncreate table #IndList2 (IndId smallint, IndStatus int,\r\nKeyAndStr varchar(7000), KeyCommaStr varchar(1000))\r\n\r\nprint Replicate('-',51)\r\nprint 'Comparing data in tables with indentical structure:'\r\nprint Replicate('-',51)\r\n--------------------------------------------------------------------------------------------\r\n-- Cursor for all tables in dbs (or for all specified tables if parameter @TabList is passed)\r\n--------------------------------------------------------------------------------------------\r\ndeclare @SqlStrGetListOfKeys1 varchar(8000)\r\ndeclare @SqlStrGetListOfKeys2 varchar(8000)\r\ndeclare @SqlStrGetListOfColumns varchar(8000)\r\ndeclare @SqlStrCompareUKeyTables varchar(8000)\r\ndeclare @SqlStrCompareNonUKeyTables varchar(8000)\r\nset @SqlStrGetListOfKeys1 = '\r\ndeclare @sqlStr varchar(8000)\r\ndeclare @ExecSqlStr varchar(8000)\r\ndeclare @PrintSqlStr varchar(8000)\r\ndeclare @Tab varchar(128)\r\ndeclare @d1User varchar(128)\r\ndeclare @d2User varchar(128)\r\ndeclare @KeyAndStr varchar(8000) \r\ndeclare @KeyCommaStr varchar(8000) \r\ndeclare @AndStr varchar(8000) \r\ndeclare @Eq varchar(8000) \r\ndeclare @IndId int\r\ndeclare @IndStatus int\r\ndeclare @CurrIndId smallint\r\ndeclare @CurrStatus int\r\ndeclare @UKey sysname \r\ndeclare @Col varchar(128)\r\ndeclare @LastUsedCol varchar(128)\r\ndeclare @xType int\r\ndeclare @Len int\r\ndeclare @SelectStr varchar(8000) \r\ndeclare @ExecSql nvarchar(1000) \r\ndeclare @NotInDB1 bit \r\ndeclare @NotInDB2 bit \r\ndeclare @NotEq bit \r\ndeclare @Numb int\r\ndeclare @Cnt1 int\r\ndeclare @Cnt2 int\r\nset @Numb = 0\r\n\r\ndeclare @StrInd int\r\ndeclare @i int\r\ndeclare @PrintStr varchar(8000)\r\ndeclare @ExecStr varchar(8000)\r\ndeclare TabCur cursor for \r\n\r\nselect d1o.name, d1u.name, d2u.name from '+@db1+'.dbo.sysobjects d1o, '+@db2+'.dbo.sysobjects d2o,\r\n'+@db1+'.dbo.sysusers d1u, '+@db2+'.dbo.sysusers d2u \r\nwhere d1o.name = d2o.name and d1o.type = ''U'' and d2o.type = ''U''\r\nand d1o.uid = d1u.uid and d2o.uid = d2u.uid \r\nand d1o.name not in (''dtproperties'') \r\nand d1o.name in (select * from #TabToCheck)\r\norder by 1\r\n\r\nopen TabCur \r\nfetch next from TabCur into @Tab, @d1User, @d2User \r\nwhile @@fetch_status = 0 \r\nbegin \r\nset @Numb = @Numb + 1\r\nprint Char(13)+Char(10)+LTRIM(STR(@Numb))+''. TABLE: [''+@Tab+''] ''\r\n\r\nset @ExecSql = ''SELECT @Cnt = count(*) FROM '+@db1+'.[''+@d1User+''].[''+@Tab+'']''\r\nexec sp_executesql @ExecSql, N''@Cnt int output'', @Cnt = @Cnt1 output\r\nprint CHAR(10)+STR(@Cnt1)+'' rows in '+@db1+'''\r\nset @ExecSql = ''SELECT @Cnt = count(*) FROM '+@db2+'.[''+@d2User+''].[''+@Tab+'']''\r\nexec sp_executesql @ExecSql, N''@Cnt int output'', @Cnt = @Cnt2 output\r\nprint STR(@Cnt2)+'' rows in '+@db2+'''\r\nif @Cnt1 = 0 and @Cnt2 = 0\r\nbegin\r\nexec ('' insert into #EmptyTables values(''''[''+@Tab+'']'''')'') \r\ngoto NextTab\r\nend\r\nset @KeyAndStr = '''' \r\nset @KeyCommaStr = '''' \r\nset @NotInDB1 = 0\r\nset @NotInDB2 = 0 \r\nset @NotEq = 0\r\nset @KeyAndStr = '''' \r\nset @KeyCommaStr = '''' \r\ntruncate table #IndList1\r\ndeclare UKeys cursor fast_forward for \r\nselect i.indid, i.status, c.name, c.xType from '+@db1+'.dbo.sysobjects o, '+@db1+'.dbo.sysindexes i, '+@db1+'.dbo.sysindexkeys k, '+@db1+'.dbo.syscolumns c \r\nwhere i.id = o.id and o.name = @Tab\r\nand (i.status & 2)<>0 \r\nand k.id = o.id and k.indid = i.indid \r\nand c.id = o.id and c.colid = k.colid \r\norder by i.indid, c.name\r\nopen UKeys \r\nfetch next from UKeys into @IndId, @IndStatus, @UKey, @xType\r\nset @CurrIndId = @IndId\r\nset @CurrStatus = @IndStatus\r\nwhile @@fetch_status = 0 \r\nbegin \r\nif @KeyAndStr <> ''''\r\nbegin \r\nset @KeyAndStr = @KeyAndStr + '' and '' + CHAR(10) \r\nset @KeyCommaStr = @KeyCommaStr + '', '' \r\nend \r\nif @xType = 175 or @xType = 167 or @xType = 239 or @xType = 231 -- char, varchar, nchar, nvarchar\r\nbegin\r\nset @KeyAndStr = @KeyAndStr + '' ISNULL(d1.[''+@UKey+''],''''!#null$'''')=ISNULL(d2.[''+@UKey+''],''''!#null$'''') ''\r\nend\r\nif @xType = 173 or @xType = 165 -- binary, varbinary\r\nbegin\r\nset @KeyAndStr = @KeyAndStr +\r\n'' CASE WHEN d1.[''+@UKey+''] is null THEN 0x4D4FFB23A49411D5BDDB00A0C906B7B4 ELSE d1.[''+@UKey+''] END=''+\r\n''CASE WHEN d2.[''+@UKey+''] is null THEN 0x4D4FFB23A49411D5BDDB00A0C906B7B4 ELSE d2.[''+@UKey+''] END ''\r\nend\r\nelse if @xType = 56 or @xType = 127 or @xType = 60 or @xType = 122 -- int, 127 - bigint,60 - money, 122 - smallmoney\r\nbegin\r\nset @KeyAndStr = @KeyAndStr + \r\n'' CASE WHEN d1.[''+@UKey+''] is null THEN 971428763405345098745 ELSE d1.[''+@UKey+''] END=''+\r\n''CASE WHEN d2.[''+@UKey+''] is null THEN 971428763405345098745 ELSE d2.[''+@UKey+''] END ''\r\nend\r\nelse if @xType = 106 or @xType = 108 -- int, decimal, numeric\r\nbegin\r\nset @KeyAndStr = @KeyAndStr + \r\n'' CASE WHEN d1.[''+@UKey+''] is null THEN 71428763405345098745098.8723 ELSE d1.[''+@UKey+''] END=''+\r\n''CASE WHEN d2.[''+@UKey+''] is null THEN 71428763405345098745098.8723 ELSE d2.[''+@UKey+''] END ''\r\nend\r\nelse if @xType = 62 or @xType = 59 -- 62 - float, 59 - real\r\nbegin \r\nset @KeyAndStr = @KeyAndStr + \r\n'' CASE WHEN d1.[''+@UKey+''] is null THEN 8764589764.22708E237 ELSE d1.[''+@UKey+''] END=''+\r\n''CASE WHEN d2.[''+@UKey+''] is null THEN 8764589764.22708E237 ELSE d2.[''+@UKey+''] END ''\r\nend\r\nelse if @xType = 52 or @xType = 48 or @xType = 104 -- smallint, tinyint, bit\r\nbegin\r\nset @KeyAndStr = @KeyAndStr + '' CASE WHEN d1.[''+@UKey+''] is null THEN 99999 ELSE d1.[''+@UKey+''] END=''+\r\n''CASE WHEN d2.[''+@UKey+''] is null THEN 99999 ELSE d2.[''+@UKey+''] END ''\r\nend\r\nelse if @xType = 36 -- 36 - id \r\nbegin\r\nset @KeyAndStr = @KeyAndStr +\r\n'' CASE WHEN d1.[''+@UKey+''] is null''+\r\n'' THEN CONVERT(uniqueidentifier,''''1CD827A0-744A-4866-8401-B9902CF2D4FB'''')''+\r\n'' ELSE d1.[''+@UKey+''] END=''+\r\n''CASE WHEN d2.[''+@UKey+''] is null''+\r\n'' THEN CONVERT(uniqueidentifier,''''1CD827A0-744A-4866-8401-B9902CF2D4FB'''')''+\r\n'' ELSE d2.[''+@UKey+''] END''\r\nend\r\nelse if @xType = 61 or @xType = 58 -- datetime, smalldatetime\r\nbegin\r\nset @KeyAndStr = @KeyAndStr +\r\n'' CASE WHEN d1.[''+@UKey+''] is null THEN ''''!#null$'''' ELSE CONVERT(varchar(40),d1.[''+@UKey+''],109) END=''+\r\n''CASE WHEN d2.[''+@UKey+''] is null THEN ''''!#null$'''' ELSE CONVERT(varchar(40),d2.[''+@UKey+''],109) END ''\r\nend\r\nelse if @xType = 189 -- timestamp (189) \r\nbegin\r\nset @KeyAndStr = @KeyAndStr + '' d1.[''+@UKey+'']=d2.[''+@UKey+''] ''\r\nend\r\nelse if @xType = 98 -- SQL_variant\r\nbegin\r\nset @KeyAndStr = @KeyAndStr + '' ISNULL(d1.[''+@UKey+''],''''!#null$'''')=ISNULL(d2.[''+@UKey+''],''''!#null$'''') ''\r\nend\r\nset @KeyCommaStr = @KeyCommaStr + '' d1.''+@UKey \r\nfetch next from UKeys into @IndId, @IndStatus, @UKey, @xType\r\nif @IndId <> @CurrIndId\r\nbegin\r\ninsert into #IndList1 values (@CurrIndId, @CurrStatus, @KeyAndStr, @KeyCommaStr)\r\nset @CurrIndId = @IndId\r\nset @CurrStatus = @IndStatus\r\nset @KeyAndStr = ''''\r\nset @KeyCommaStr = '''' \r\nend\r\nend \r\ndeallocate UKeys \r\ninsert into #IndList1 values (@CurrIndId, @CurrStatus, @KeyAndStr, @KeyCommaStr)'\r\nset @SqlStrGetListOfKeys2 = '\r\nset @KeyAndStr = '''' \r\nset @KeyCommaStr = '''' \r\ntruncate table #IndList2\r\ndeclare UKeys cursor fast_forward for \r\nselect i.indid, i.status, c.name, c.xType from '+@db2+'.dbo.sysobjects o, '+@db2+'.dbo.sysindexes i, '+@db2+'.dbo.sysindexkeys k, '+@db2+'.dbo.syscolumns c \r\nwhere i.id = o.id and o.name = @Tab\r\nand (i.status & 2)<>0 \r\nand k.id = o.id and k.indid = i.indid \r\nand c.id = o.id and c.colid = k.colid \r\norder by i.indid, c.name\r\nopen UKeys \r\nfetch next from UKeys into @IndId, @IndStatus, @UKey, @xType\r\nset @CurrIndId = @IndId\r\nset @CurrStatus = @IndStatus\r\nwhile @@fetch_status = 0 \r\nbegin \r\nif @KeyAndStr <> ''''\r\nbegin \r\nset @KeyAndStr = @KeyAndStr + '' and '' + CHAR(10) \r\nset @KeyCommaStr = @KeyCommaStr + '', '' \r\nend \r\nif @xType = 175 or @xType = 167 or @xType = 239 or @xType = 231 -- char, varchar, nchar, nvarchar\r\nbegin\r\nset @KeyAndStr = @KeyAndStr + '' ISNULL(d1.[''+@UKey+''],''''!#null$'''')=ISNULL(d2.[''+@UKey+''],''''!#null$'''') ''\r\nend\r\nif @xType = 173 or @xType = 165 -- binary, varbinary\r\nbegin\r\nset @KeyAndStr = @KeyAndStr +\r\n'' CASE WHEN d1.[''+@UKey+''] is null THEN 0x4D4FFB23A49411D5BDDB00A0C906B7B4 ELSE d1.[''+@UKey+''] END=''+\r\n''CASE WHEN d2.[''+@UKey+''] is null THEN 0x4D4FFB23A49411D5BDDB00A0C906B7B4 ELSE d2.[''+@UKey+''] END ''\r\nend\r\nelse if @xType = 56 or @xType = 127 or @xType = 60 or @xType = 122 -- int, 127 - bigint,60 - money, 122 - smallmoney\r\nbegin\r\nset @KeyAndStr = @KeyAndStr + \r\n'' CASE WHEN d1.[''+@UKey+''] is null THEN 971428763405345098745 ELSE d1.[''+@UKey+''] END=''+\r\n''CASE WHEN d2.[''+@UKey+''] is null THEN 971428763405345098745 ELSE d2.[''+@UKey+''] END ''\r\nend\r\nelse if @xType = 106 or @xType = 108 -- int, decimal, numeric\r\nbegin\r\nset @KeyAndStr = @KeyAndStr + \r\n'' CASE WHEN d1.[''+@UKey+''] is null THEN 71428763405345098745098.8723 ELSE d1.[''+@UKey+''] END=''+\r\n''CASE WHEN d2.[''+@UKey+''] is null THEN 71428763405345098745098.8723 ELSE d2.[''+@UKey+''] END ''\r\nend\r\nelse if @xType = 62 or @xType = 59 -- 62 - float, 59 - real\r\nbegin \r\nset @KeyAndStr = @KeyAndStr + \r\n'' CASE WHEN d1.[''+@UKey+''] is null THEN 8764589764.22708E237 ELSE d1.[''+@UKey+''] END=''+\r\n''CASE WHEN d2.[''+@UKey+''] is null THEN 8764589764.22708E237 ELSE d2.[''+@UKey+''] END ''\r\nend\r\nelse if @xType = 52 or @xType = 48 or @xType = 104 -- smallint, tinyint, bit\r\nbegin\r\nset @KeyAndStr = @KeyAndStr + '' CASE WHEN d1.[''+@UKey+''] is null THEN 99999 ELSE d1.[''+@UKey+''] END=''+\r\n''CASE WHEN d2.[''+@UKey+''] is null THEN 99999 ELSE d2.[''+@UKey+''] END ''\r\nend\r\nelse if @xType = 36 -- 36 - id \r\nbegin\r\nset @KeyAndStr = @KeyAndStr +\r\n'' CASE WHEN d1.[''+@UKey+''] is null''+\r\n'' THEN CONVERT(uniqueidentifier,''''1CD827A0-744A-4866-8401-B9902CF2D4FB'''')''+\r\n'' ELSE d1.[''+@UKey+''] END=''+\r\n''CASE WHEN d2.[''+@UKey+''] is null''+\r\n'' THEN CONVERT(uniqueidentifier,''''1CD827A0-744A-4866-8401-B9902CF2D4FB'''')''+\r\n'' ELSE d2.[''+@UKey+''] END''\r\nend\r\nelse if @xType = 61 or @xType = 58 -- datetime, smalldatetime\r\nbegin\r\nset @KeyAndStr = @KeyAndStr +\r\n'' CASE WHEN d1.[''+@UKey+''] is null THEN ''''!#null$'''' ELSE CONVERT(varchar(40),d1.[''+@UKey+''],109) END=''+\r\n''CASE WHEN d2.[''+@UKey+''] is null THEN ''''!#null$'''' ELSE CONVERT(varchar(40),d2.[''+@UKey+''],109) END ''\r\nend\r\nelse if @xType = 189 -- timestamp (189) \r\nbegin\r\nset @KeyAndStr = @KeyAndStr + '' d1.[''+@UKey+'']=d2.[''+@UKey+''] ''\r\nend\r\nelse if @xType = 98 -- SQL_variant\r\nbegin\r\nset @KeyAndStr = @KeyAndStr + '' ISNULL(d1.[''+@UKey+''],''''!#null$'''')=ISNULL(d2.[''+@UKey+''],''''!#null$'''') ''\r\nend\r\nset @KeyCommaStr = @KeyCommaStr + '' d1.''+@UKey \r\nfetch next from UKeys into @IndId, @IndStatus, @UKey, @xType\r\nif @IndId <> @CurrIndId\r\nbegin\r\ninsert into #IndList2 values (@CurrIndId, @CurrStatus, @KeyAndStr, @KeyCommaStr)\r\nset @CurrIndId = @IndId\r\nset @CurrStatus = @IndStatus\r\nset @KeyAndStr = ''''\r\nset @KeyCommaStr = '''' \r\nend\r\nend \r\ndeallocate UKeys \r\ninsert into #IndList2 values (@CurrIndId, @CurrStatus, @KeyAndStr, @KeyCommaStr)\r\nset @KeyCommaStr = null\r\n\r\nselect @KeyCommaStr=i1.KeyCommaStr from #IndList1 i1\r\njoin #IndList2 i2 on i1.KeyCommaStr = i2.KeyCommaStr\r\nwhere (i1.IndStatus & 2048)<> 0 and (i2.IndStatus & 2048)<>0\r\n\r\nif @KeyCommaStr is null \r\nset @KeyCommaStr = (select top 1 i1.KeyCommaStr from #IndList1 i1\r\njoin #IndList2 i2 on i1.KeyCommaStr = i2.KeyCommaStr)\r\nset @KeyAndStr = (select TOP 1 KeyAndStr from #IndList1 where KeyCommaStr = @KeyCommaStr)\r\nif @KeyCommaStr is null\r\nset @KeyCommaStr = ''''\r\nif @KeyAndStr is null\r\nset @KeyAndStr = '''''\r\nset @SqlStrGetListOfColumns = '\r\nset @AndStr = ''''\r\nset @StrInd = 1\r\ndeclare Cols cursor local fast_forward for \r\nselect c.name, c.xtype, c.length from '+@db1+'.dbo.sysobjects o, '+@db1+'.dbo.syscolumns c\r\nwhere o.id = c.id and o.name = @Tab \r\nand CHARINDEX(c.name, @KeyCommaStr) = 0\r\nopen Cols \r\nfetch next from Cols into @Col, @xType, @len\r\nwhile @@fetch_status = 0 \r\nbegin \r\nif @xType = 175 or @xType = 167 or @xType = 239 or @xType = 231 -- char, varchar, nchar, nvarchar\r\nbegin\r\nset @Eq = ''ISNULL(d1.[''+@Col+''],''''!#null$'''')=ISNULL(d2.[''+@Col+''],''''!#null$'''') ''\r\nend\r\nif @xType = 173 or @xType = 165 -- binary, varbinary\r\nbegin\r\nset @Eq = ''CASE WHEN d1.[''+@Col+''] is null THEN 0x4D4FFB23A49411D5BDDB00A0C906B7B4 ELSE d1.[''+@Col+''] END=''+\r\n''CASE WHEN d2.[''+@Col+''] is null THEN 0x4D4FFB23A49411D5BDDB00A0C906B7B4 ELSE d2.[''+@Col+''] END ''\r\nend\r\nelse if @xType = 56 or @xType = 127 or @xType = 60 or @xType = 122 -- int, 127 - bigint,60 - money, 122 - smallmoney\r\nbegin\r\nset @Eq = ''CASE WHEN d1.[''+@Col+''] is null THEN 971428763405345098745 ELSE d1.[''+@Col+''] END=''+\r\n''CASE WHEN d2.[''+@Col+''] is null THEN 971428763405345098745 ELSE d2.[''+@Col+''] END ''\r\nend\r\nelse if @xType = 106 or @xType = 108 -- int, decimal, numeric\r\nbegin\r\nset @Eq = ''CASE WHEN d1.[''+@Col+''] is null THEN 71428763405345098745098.8723 ELSE d1.[''+@Col+''] END=''+\r\n''CASE WHEN d2.[''+@Col+''] is null THEN 71428763405345098745098.8723 ELSE d2.[''+@Col+''] END ''\r\nend\r\nelse if @xType = 62 or @xType = 59 -- 62 - float, 59 - real\r\nbegin \r\nset @Eq = ''CASE WHEN d1.[''+@Col+''] is null THEN 8764589764.22708E237 ELSE d1.[''+@Col+''] END=''+\r\n''CASE WHEN d2.[''+@Col+''] is null THEN 8764589764.22708E237 ELSE d2.[''+@Col+''] END ''\r\nend\r\nelse if @xType = 52 or @xType = 48 or @xType = 104 -- smallint, tinyint, bit\r\nbegin\r\nset @Eq = ''CASE WHEN d1.[''+@Col+''] is null THEN 99999 ELSE d1.[''+@Col+''] END=''+\r\n''CASE WHEN d2.[''+@Col+''] is null THEN 99999 ELSE d2.[''+@Col+''] END ''\r\nend\r\nelse if @xType = 36 -- 36 - id \r\nbegin\r\nset @Eq = ''CASE WHEN d1.[''+@Col+''] is null''+\r\n'' THEN CONVERT(uniqueidentifier,''''1CD827A0-744A-4866-8401-B9902CF2D4FB'''')''+\r\n'' ELSE d1.[''+@Col+''] END=''+\r\n''CASE WHEN d2.[''+@Col+''] is null''+\r\n'' THEN CONVERT(uniqueidentifier,''''1CD827A0-744A-4866-8401-B9902CF2D4FB'''')''+\r\n'' ELSE d2.[''+@Col+''] END''\r\nend\r\nelse if @xType = 61 or @xType = 58 -- datetime, smalldatetime\r\nbegin\r\nset @Eq =\r\n''CASE WHEN d1.[''+@Col+''] is null THEN ''''!#null$'''' ELSE CONVERT(varchar(40),d1.[''+@Col+''],109) END=''+\r\n''CASE WHEN d2.[''+@Col+''] is null THEN ''''!#null$'''' ELSE CONVERT(varchar(40),d2.[''+@Col+''],109) END ''\r\nend\r\nelse if @xType = 34\r\nbegin\r\nset @Eq = ''ISNULL(DATALENGTH(d1.[''+@Col+'']),0)=ISNULL(DATALENGTH(d2.[''+@Col+'']),0) '' \r\nend\r\nelse if @xType = 35 or @xType = 99 -- text (35),ntext (99) \r\nbegin\r\nset @Eq = ''ISNULL(SUBSTRING(d1.[''+@Col+''],1,DATALENGTH(d1.[''+@Col+\r\n''])),''''!#null$'''')=ISNULL(SUBSTRING(d2.[''+@Col+''],1,DATALENGTH(d2.[''+@Col+''])),''''!#null$'''') ''\r\nend\r\nelse if @xType = 189 \r\nbegin\r\nif '+STR(@NoTimestamp)+' = 0 \r\nset @Eq = ''d1.[''+@Col+'']=d2.[''+@Col+''] ''\r\nelse\r\nset @Eq = ''1=1''\r\nend\r\nelse if @xType = 98 -- SQL_variant\r\nbegin\r\nset @Eq = ''ISNULL(d1.[''+@Col+''],''''!#null$'''')=ISNULL(d2.[''+@Col+''],''''!#null$'''') ''\r\nend\r\nif @AndStr = ''''\r\nset @AndStr = @AndStr + CHAR(10) + '' '' + @Eq \r\nelse\r\nif len(@AndStr) + len('' and '' + @Eq)<8000\r\nset @AndStr = @AndStr + '' and '' + CHAR(10) + '' '' + @Eq \r\nelse\r\nbegin\r\nset @StrInd = @StrInd + 1\r\nInsert into ##CompareStr values(@StrInd,@AndStr)\r\nset @AndStr = '' and '' + @Eq \r\nend\r\nfetch next from Cols into @Col, @xType, @len \r\nend \r\ndeallocate Cols '\r\nset @SqlStrCompareUKeyTables = '\r\nif @KeyAndStr <> ''''\r\nbegin\r\nset @SelectStr = ''SELECT ''+ @KeyCommaStr+'' INTO ##NotInDb2 FROM '+@db1+'.[''+@d1User+''].[''+@Tab+''] d1 ''+ \r\n'' WHERE not exists''+CHAR(10)+'' (SELECT * FROM '+@db2+'.[''+@d2User+''].[''+@Tab+''] d2 ''+ \r\n'' WHERE ''+CHAR(10)+@KeyAndStr+'')''\r\nif '+STR(@VerboseLevel)+' = 1\r\nprint CHAR(10)+''To find rows that are in '+@db1+', but are not in db2:''+CHAR(10)+\r\nREPLACE (@SelectStr, ''into ##NotInDB2'','''')\r\nexec (@SelectStr) \r\nif @@rowcount > 0 \r\nset @NotInDB2 = 1 \r\nset @SelectStr = ''SELECT ''+@KeyCommaStr+'' INTO ##NotInDB1 FROM '+@db2+'.[''+@d2User+''].[''+@Tab+''] d1 ''+ \r\n'' WHERE not exists''+CHAR(10)+'' (SELECT * FROM '+@db1+'.[''+@d1User+''].[''+@Tab+''] d2 ''+ \r\n'' WHERE ''+CHAR(10)+@KeyAndStr+'')'' \r\nif '+STR(@VerboseLevel)+' = 1\r\nprint CHAR(10)+''To find rows that are in '+@db2+', but are not in '+@db1+':''+CHAR(10)+\r\nREPLACE (@SelectStr, ''into ##NotInDB1'','''')\r\nexec (@SelectStr) \r\nif @@rowcount > 0 \r\nset @NotInDB1 = 1 \r\n-- if there are non-key columns\r\nif @AndStr <> '''' \r\nbegin\r\nset @PrintStr = '' Print ''\r\nset @ExecStr = '' exec (''\r\nset @SqlStr = ''''\r\nInsert into ##CompareStr values(1,\r\n''SELECT ''+ @KeyCommaStr+'' INTO ##NotEq FROM '+@db2+'.[''+@d2User+''].[''+@Tab+''] d1 ''+ \r\n'' INNER JOIN '+@db1+'.[''+@d1User+''].[''+@Tab+''] d2 ON ''+CHAR(10)+@KeyAndStr+CHAR(10)+''WHERE not('') \r\n-- Adding last string in temp table containing a comparing string to execute\r\nset @StrInd = @StrInd + 1\r\nInsert into ##CompareStr values(@StrInd,@AndStr+'')'')\r\nset @i = 1\r\nwhile @i <= @StrInd\r\nbegin\r\nset @SqlStr = @SqlStr + '' declare @Str''+LTRIM(STR(@i))+'' varchar(8000) ''+\r\n''select @Str''+LTRIM(STR(@i))+''=CompareStr FROM ##CompareStr WHERE ind = ''+STR(@i)\r\nif @ExecStr <> '' exec (''\r\nset @ExecStr = @ExecStr + ''+''\r\nif @PrintStr <> '' Print ''\r\nset @PrintStr = @PrintStr + ''+''\r\nset @ExecStr = @ExecStr + ''@Str''+LTRIM(STR(@i))\r\nset @PrintStr = @PrintStr + '' REPLACE(@Str''+LTRIM(STR(@i))+'','''' into ##NotEq'''','''''''') ''\r\nset @i = @i + 1\r\nend\r\nset @ExecStr = @ExecStr + '') ''\r\nset @ExecSqlStr = @SqlStr + @ExecStr \r\nset @PrintSqlStr = @SqlStr + \r\n'' Print CHAR(10)+''''To find rows that are different in non-key columns:'''' ''+\r\n@PrintStr \r\nif '+STR(@VerboseLevel)+' = 1\r\nexec (@PrintSqlStr)\r\nexec (@ExecSqlStr)\r\n\r\nif @@rowcount > 0 \r\nset @NotEq = 1 \r\nend\r\nelse\r\nif '+STR(@VerboseLevel)+' = 1\r\nprint CHAR(10)+''There are no non-key columns in the table''\r\ntruncate table ##CompareStr\r\nif @NotInDB1 = 1 or @NotInDB2 = 1 or @NotEq = 1\r\nbegin \r\nprint CHAR(10)+''Data are different''\r\nif @NotInDB2 = 1 and '+STR(@NumbToShow)+' > 0\r\nbegin\r\nprint ''These key values exist in '+@db1+', but do not exist in '+@db2+': ''\r\nset @SelectStr = ''select top ''+STR('+STR(@NumbToShow)+')+'' * from ##NotInDB2''\r\nexec (@SelectStr)\r\nend\r\nif @NotInDB1 = 1 and '+STR(@NumbToShow)+' > 0\r\nbegin\r\nprint ''These key values exist in '+@db2+', but do not exist in '+@db1+': ''\r\nset @SelectStr = ''select top ''+STR('+STR(@NumbToShow)+')+'' * from ##NotInDB1''\r\nexec (@SelectStr)\r\nend\r\nif @NotEq = 1 and '+STR(@NumbToShow)+' > 0\r\nbegin\r\nprint ''Row(s) with these key values contain differences in non-key columns: ''\r\nset @SelectStr = ''select top ''+STR('+STR(@NumbToShow)+')+'' * from ##NotEq''\r\nexec (@SelectStr) \r\nend\r\nexec (''insert into #DiffTables values(''''[''+@Tab+'']'''')'') \r\nend \r\nelse\r\nbegin\r\nprint CHAR(10)+''Data are identical''\r\nexec ('' insert into #IdenticalTables values(''''[''+@Tab+'']'''')'') \r\nend\r\nif exists (select * from tempdb.dbo.sysobjects where name like ''##NotEq%'')\r\ndrop table ##NotEq\r\nend \r\nelse '\r\nset @SqlStrCompareNonUKeyTables = '\r\nbegin\r\nexec (''insert into #NoPKTables values(''''[''+@Tab+'']'''')'')\r\nset @PrintStr = '' Print ''\r\nset @ExecStr = '' exec (''\r\nset @SqlStr = ''''\r\nInsert into ##CompareStr values(1,\r\n''SELECT ''+\r\n'' * INTO ##NotInDB2 FROM '+@db1+'.[''+@d1User+''].[''+@Tab+''] d1 WHERE not exists ''+CHAR(10)+\r\n'' (SELECT * FROM '+@db2+'.[''+@d2User+''].[''+@Tab+''] d2 WHERE '')\r\nset @StrInd = @StrInd + 1\r\nInsert into ##CompareStr values(@StrInd,@AndStr+'')'')\r\nset @i = 1\r\nwhile @i <= @StrInd\r\nbegin\r\nset @SqlStr = @SqlStr + '' declare @Str''+LTRIM(STR(@i))+'' varchar(8000) ''+\r\n''select @Str''+LTRIM(STR(@i))+''=CompareStr FROM ##CompareStr WHERE ind = ''+STR(@i)\r\nif @ExecStr <> '' exec (''\r\nset @ExecStr = @ExecStr + ''+''\r\nif @PrintStr <> '' Print ''\r\nset @PrintStr = @PrintStr + ''+''\r\nset @ExecStr = @ExecStr + ''@Str''+LTRIM(STR(@i))\r\nset @PrintStr = @PrintStr + '' REPLACE(@Str''+LTRIM(STR(@i))+'','''' into ##NotInDB2'''','''''''') ''\r\nset @i = @i + 1\r\nend\r\nset @ExecStr = @ExecStr + '') ''\r\nset @ExecSqlStr = @SqlStr + @ExecStr \r\nset @PrintSqlStr = @SqlStr +\r\n'' Print CHAR(10)+''''To find rows that are in '+@db1+', but are not in '+@db2+':'''' ''+\r\n@PrintStr \r\nif '+STR(@VerboseLevel)+' = 1\r\nexec (@PrintSqlStr)\r\nexec (@ExecSqlStr)\r\n\r\nif @@rowcount > 0 \r\nset @NotInDB2 = 1 \r\ndelete from ##CompareStr where ind = 1\r\nset @PrintStr = '' Print ''\r\nset @ExecStr = '' exec (''\r\nset @SqlStr = ''''\r\nInsert into ##CompareStr values(1,\r\n''SELECT ''+\r\n'' * INTO ##NotInDB1 FROM '+@db2+'.[''+@d2User+''].[''+@Tab+''] d1 WHERE not exists ''+CHAR(10)+\r\n'' (SELECT * FROM '+@db1+'.[''+@d1User+''].[''+@Tab+''] d2 WHERE '')\r\nset @i = 1\r\nwhile @i <= @StrInd\r\nbegin\r\nset @SqlStr = @SqlStr + '' declare @Str''+LTRIM(STR(@i))+'' varchar(8000) ''+\r\n''select @Str''+LTRIM(STR(@i))+''=CompareStr FROM ##CompareStr WHERE ind = ''+STR(@i)\r\nif @ExecStr <> '' exec (''\r\nset @ExecStr = @ExecStr + ''+''\r\nif @PrintStr <> '' Print ''\r\nset @PrintStr = @PrintStr + ''+''\r\nset @ExecStr = @ExecStr + ''@Str''+LTRIM(STR(@i))\r\nset @PrintStr = @PrintStr + '' REPLACE(@Str''+LTRIM(STR(@i))+'','''' into ##NotInDB1'''','''''''') ''\r\nset @i = @i + 1\r\nend\r\nset @ExecStr = @ExecStr + '') ''\r\nset @ExecSqlStr = @SqlStr + @ExecStr \r\nset @PrintSqlStr = @SqlStr +\r\n'' Print CHAR(10)+''''To find rows that are in '+@db2+', but are not in '+@db1+':'''' ''+\r\n@PrintStr \r\nif '+STR(@VerboseLevel)+' = 1\r\nexec (@PrintSqlStr)\r\nexec (@ExecSqlStr)\r\n\r\nif @@rowcount > 0 \r\nset @NotInDB1 = 1 \r\ntruncate table ##CompareStr\r\nif @NotInDB1 = 1 or @NotInDB2 = 1\r\nbegin \r\nprint CHAR(10)+''Data are different''\r\nif @NotInDB2 = 1 and '+STR(@NumbToShow)+' > 0\r\nbegin\r\nprint ''The row(s) exist in '+@db1+', but do not exist in '+@db2+': ''\r\nset @SelectStr = ''select top ''+STR('+STR(@NumbToShow)+')+'' * from ##NotInDB2''\r\nexec (@SelectStr)\r\nend\r\nif @NotInDB1 = 1 and '+STR(@NumbToShow)+' > 0\r\nbegin\r\nprint ''The row(s) exist in '+@db2+', but do not exist in '+@db1+': ''\r\nset @SelectStr = ''select top ''+STR('+STR(@NumbToShow)+')+'' * from ##NotInDB1''\r\nexec (@SelectStr)\r\nend\r\nexec (''insert into #DiffTables values(''''[''+@Tab+'']'''')'') \r\nend \r\nelse\r\nbegin\r\nprint CHAR(10)+''Data are identical''\r\nexec ('' insert into #IdenticalTables values(''''[''+@Tab+'']'''')'') \r\nend\r\nend\r\nif exists (select * from tempdb.dbo.sysobjects where name like ''##NotInDB1%'')\r\ndrop table ##NotInDB1\r\nif exists (select * from tempdb.dbo.sysobjects where name like ''##NotInDB2%'')\r\ndrop table ##NotInDB2\r\nNextTab:\r\nfetch next from TabCur into @Tab, @d1User, @d2User \r\nend \r\ndeallocate TabCur \r\n'\r\nexec (@SqlStrGetListOfKeys1+@SqlStrGetListOfKeys2+@SqlStrGetListOfColumns+\r\n@SqlStrCompareUKeyTables+@SqlStrCompareNonUKeyTables)\r\nprint ' '\r\nSET NOCOUNT OFF\r\nif (select count(*) from #NoPKTables) > 0\r\nbegin\r\nselect name as 'Table(s) without Unique key:' from #NoPKTables \r\nend\r\nif (select count(*) from #DiffTables) > 0\r\nbegin\r\nselect name as 'Table(s) with the same name & structure, but different data:' from #DiffTables \r\nend\r\nelse\r\nprint CHAR(10)+'No tables with the same name & structure, but different data'+CHAR(10)\r\nif (select count(*) from #IdenticalTables) > 0\r\nbegin\r\nselect name as 'Table(s) with the same name & structure and identical data:' from #IdenticalTables \r\nend\r\nif (select count(*) from #EmptyTables) > 0\r\nbegin\r\nselect name as 'Table(s) with the same name & structure and empty in the both databases:' from #EmptyTables \r\nend\r\ndrop table #TabToCheck\r\ndrop table ##CompareStr\r\ndrop table #DiffTables\r\ndrop table #IdenticalTables\r\ndrop table #EmptyTables\r\ndrop table #NoPKTables\r\ndrop table #IndList1\r\ndrop table #IndList2\r\nreturn\r\n","Declares":"","CodeCategory":{"CategoryId":"6","CategoryDescription":"T-SQL"},"Keywords":["Compare Databases","DB Compare"]},{"RecordId":"607","Title":"Javascript Calendar (Great one)","Description":"Javascript calendar with drop-down month & year.  Works only in IE.  Super!","Code":"<!-- ONE STEP TO INSTALL WINDOW CALENDAR:\r\n\r\n  1.  Copy the coding into the BODY of your HTML document  -->\r\n\r\n<!-- STEP ONE: Paste this code into the BODY of your HTML document  -->\r\n\r\n<BODY>\r\n\r\n<SCRIPT LANGUAGE=\"JavaScript\">\r\n\r\n<!-- This script and many more are available free online at -->\r\n<!-- The JavaScript Source!! http://javascript.internet.com -->\r\n<!-- Original:  Scriptbreaker (pieterpareit@hotmail.com ) -->\r\n<!-- Web Site:  http://www24.brinkster.com/scriptbreaker -->\r\n<!-- Begin\r\nvar now = new Date();\r\nvar month_array = new Array(\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\"July\",\"August\",\"September\",\"October\",\"November\",\"December\");\r\ndocument.write(\"<form name=date_list><table bgcolor=silver><tr><td>\");\r\ndocument.write(\"<select name=month onchange=change_month(this.options.selectedIndex)>\");\r\nfor(i=0;i<month_array.length;i++)\r\n{\r\n if (now.getMonth() != i)\r\n {document.write (\"<option value=\"+i+\">\"+month_array[i]);}\r\n else\r\n {document.write (\"<option value=\"+i+\" selected>\"+month_array[i]);}\r\n\r\n}\r\ndocument.write(\"</select>\");\r\ndocument.write(\"</td><td>\");\r\ndocument.write (\"<select name=year onchange=change_year(this.options[this.options.selectedIndex])>\");\r\nfor(i=1950;i<3000;i++)\r\n{\r\n if (now.getYear() != i)\r\n {document.write(\"<option value=\"+i+\">\"+i);}\r\n else\r\n {document.write(\"<option value=\"+i+\" selected>\"+i);}\r\n}\r\ndocument.write(\"</select></td></tr><tr><td colspan=2><center>\");\r\n\r\ndocument.write(\"<table bgcolor=white border=0 cellspacing = 0 cellpading = 0 width=100%><tr bgcolor=gray align=center>\");\r\ndocument.write(\"<td><font color=silver>M</font></td><td><font color=silver>T</td><td><font color=silver>W</td><td><font color=silver>T</td><td><font color=silver>F</td><td ><font color=silver>S</td><td ><font color=silver>S</td>\");\r\ndocument.write(\"</tr><tr>\");\r\nfor(j=0;j<6;j++)\r\n{\r\n for(i=0;i<7;i++)\r\n {\r\n   document.write(\"<td align=center id=d\"+i+\"r\"+j+\"></td>\")\r\n }\r\n document.write(\"</tr>\");\r\n}\r\n\r\ndocument.write(\"</table>\");\r\n\r\ndocument.write(\"</center></from></td></tr></table>\");\r\n\r\nvar show_date = new Date();\r\n\r\nfunction set_cal(show_date)\r\n{\r\nbegin_day = new Date (show_date.getYear(),show_date.getMonth(),1);\r\nbegin_day_date = begin_day.getDay();\r\nend_day = new Date (show_date.getYear(),show_date.getMonth()+1,1);\r\ncount_day = (end_day - begin_day)/1000/60/60/24;\r\ninput_table(begin_day_date,count_day);\r\n}\r\nset_cal(show_date);\r\n\r\nfunction input_table(begin,count)\r\n{\r\ninit();\r\nj=0;\r\nif (begin!=0){i=begin-1;}else{i=6}\r\nfor (c=1;c<count+1;c++)\r\n{\r\n colum_name = eval(\"d\"+i+\"r\"+j);\r\n if ((now.getDate() == c)&&(show_date.getMonth() == now.getMonth())&&(show_date.getYear() == now.getYear())) {colum_name.style.backgroundColor = \"blue\";colum_name.style.color = \"white\";};\r\n colum_name.innerText =  c;\r\n i++;\r\n if (i==7){i=0;j++;}\r\n}\r\n}\r\n\r\nfunction init()\r\n{\r\nfor(j=0;j<6;j++)\r\n{\r\n for(i=0;i<7;i++)\r\n {\r\n colum_name = eval(\"d\"+i+\"r\"+j);\r\n colum_name.innerText =  \"-\";\r\n colum_name.style.backgroundColor =\"\";\r\n colum_name.style.color =\"\";\r\n }\r\n}\r\n}\r\n\r\nfunction change_month(sel_month)\r\n{\r\nshow_date = new Date(show_date.getYear(),sel_month,1);\r\nset_cal(show_date);\r\n}\r\n\r\nfunction change_year(sel_year)\r\n{\r\nsel_year = sel_year.value;\r\nshow_date = new Date(sel_year,show_date.getMonth(),1);\r\nset_cal(show_date);\r\n}\r\n//  End -->\r\n</script>\r\n\r\n<p><center>\r\n<font face=\"arial, helvetica\" size\"-2\">Free JavaScripts provided<br>\r\nby <a href=\"http://javascriptsource.com\">The JavaScript Source</a></font>\r\n</center><p>\r\n\r\n<!-- Script Size:  3.64 KB -->","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["Calendar","Date Picker"]},{"RecordId":"608","Title":"Spell Check HTML TextArea (Uses Word)","Description":"Uses Word2K to spell check an HTML TextArea client-side.","Code":"'**************************************\r\n    ' Name: Spell Checker\r\n    ' Description:Use Microsoft word spell checker utility\r\n    '\r\n    ' Assumes client machine has word 2000, Browser is I.E., Activex scripting is enabled\r\n    '\r\n    '**************************************\r\n    \r\n    <SCRIPT LANGUAGE=vbscript>\r\n    <!--\r\n    'SpellChecker\r\n    ' PURPOSE: This function accepts Text data for which spell checking has to be done. \r\n    ' Return's Spelling corrected data \r\n    '\t\r\n    Function SpellChecker(TextValue)\r\n    \t\r\n    \tDim objWordobject\r\n    \tDim objDocobject \r\n    \tDim strReturnValue\r\n    \t'Create a new instance of word Application\r\n    \tSet objWordobject = CreateObject(\"word.Application\")\r\n    \tobjWordobject.WindowState = 2\r\n    \tobjWordobject.Visible = True\r\n    \t'Create a new instance of Document\r\n    \tSet objDocobject = objWordobject.Documents.Add( , , 1, True)\r\n    \tobjDocobject.Content=TextValue\r\n    \tobjDocobject.CheckSpelling\r\n    \t'Return spell check completed text data\r\n    \tstrReturnValue = objDocobject.Content\r\n    \t'Close Word Document \r\n    \tobjDocobject.Close false\r\n    \t'Set Document to nothing\r\n    \tSet objDocobject = Nothing\r\n    \t'Quit Word\r\n    \tobjWordobject.Application.Quit True\r\n    \t'Set word object to nothing\r\n    \tSet objWordobject= Nothing\r\n    SpellChecker=strReturnValue\r\n    End Function \r\n    -->\r\n    </SCRIPT>\r\n\t\t\r\n\r\n\r\n\r\n<FORM name=\"frm\">\r\n<TEXTAREA name=x></TEXTAREA>\r\n<INPUT TYPE=\"button\" onClick=\"frm.x.value=SpellChecker(frm.x.value)\">\r\n</FORM>","Declares":"","CodeCategory":{"CategoryId":"2","CategoryDescription":"Web"},"Keywords":["SpellCheck","Spell check"]},{"RecordId":"609","Title":"Check Caps Lock","Description":"Determines whether caps lock is on or off.","Code":"<BODY>\r\n\r\n<SCRIPT LANGUAGE=\"JavaScript\">\r\n\r\nfunction checkCapsLock( e ) {\r\n\tvar myKeyCode=0;\r\n\tvar myShiftKey=false;\r\n\tvar myMsg='Caps Lock is On.\\n\\nTo prevent entering your password incorrectly,\\nyou should press Caps Lock to turn it off.';\r\n\r\n\t// Internet Explorer 4+\r\n\tif ( document.all ) {\r\n\t\tmyKeyCode=e.keyCode;\r\n\t\tmyShiftKey=e.shiftKey;\r\n\r\n\t// Netscape 4\r\n\t} else if ( document.layers ) {\r\n\t\tmyKeyCode=e.which;\r\n\t\tmyShiftKey=( myKeyCode == 16 ) ? true : false;\r\n\r\n\t// Netscape 6\r\n\t} else if ( document.getElementById ) {\r\n\t\tmyKeyCode=e.which;\r\n\t\tmyShiftKey=( myKeyCode == 16 ) ? true : false;\r\n\r\n\t}\r\n\r\n\t// Upper case letters are seen without depressing the Shift key, therefore Caps Lock is on\r\n\tif ( ( myKeyCode >= 65 && myKeyCode <= 90 ) && !myShiftKey ) {\r\n\t\talert( myMsg );\r\n\r\n\t// Lower case letters are seen while depressing the Shift key, therefore Caps Lock is on\r\n\t} else if ( ( myKeyCode >= 97 && myKeyCode <= 122 ) && myShiftKey ) {\r\n\t\talert( myMsg );\r\n\r\n\t}\r\n}\r\n</script>\r\n\r\n<FORM>\r\n<STRONG>Password:</STRONG>\r\n<INPUT TYPE=\"Password\" NAME=\"Password\" SIZE=16 MAXLENGTH=16 onKeyPress=\"checkCapsLock( event )\">\r\n<P>\r\n<INPUT TYPE=\"Reset\">\r\n</FORM>","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["CapsLock","Caps Lock"]},{"RecordId":"610","Title":"Execute Dynamic SQL In Stored Procedure","Description":"Demonstrates how to build dynamic SQL statement in a stored procedure and execute it.  Also demonstrates how to convert numeric parameter value to a varchar so that it can be concatenated in the string.","Code":"CREATE PROCEDURE [dbo].[app_c_GetSelectedPublishedContributionsByContentType]\r\n\r\n\t@ContentType int,\r\n\t@ContributionIDs varchar(8000)\r\n\r\n AS\r\n\r\nDECLARE @SQL varchar(8000)\r\n\r\nSET @SQL = \r\n'SELECT \tA.ContributionID,\r\n\t\tB.FunctionName,\r\n\t   \tA.FunctionID,\r\n\t   \tC.CountryName,\r\n\t   \tA.CountryID,\r\n\t   \tA.Title,\r\n\t   \tA.ContributedBy,\r\n\t   \tA.ClientName,\r\n\t   \tA.EngagementManager,\r\n\t   \tA.Team,\r\n\t   \tA.PrimaryContact,\r\n\t   \tA.Description,\r\n\t   \tA.DateSubmitted,\r\n\t   \tA.DatePublished,\r\n\t   \tD.OfficeLocation,\r\n\t   \tA.OfficeID,\r\n\t   \tA.Fees\r\n\r\nFROM \t\tContribution A \r\n\r\nINNER JOIN  \tDTFunction B\r\nON \t\tA.FunctionID = B.FunctionID\r\n\r\nINNER JOIN \tCountry C\r\nON \t\tA.CountryID = C.CountryID\r\n\r\nINNER JOIN \tOffice D\r\nON \t\tA.OfficeID = D.OfficeID\r\n\r\nWHERE \t                B.ActiveFlag = 1 \r\nAND\t\tA.ContributionWorkflowID = 400\r\nAND\t\tA.ContributionID IN (' + @ContributionIDs + ')\r\nAND\t\tA.ContributionID IN (SELECT DISTINCT ContributionID FROM vw_GetAllContributionInfo WHERE ContentTypeID = ' + convert(varchar(6),@ContentType) + ')\r\nAND\t\t(A.DateExpired IS NULL \r\nOR\t\tA.DateExpired > GETDate())'\r\n\r\nexecute (@SQL)\r\nGO\r\n","Declares":"","CodeCategory":{"CategoryId":"6","CategoryDescription":"T-SQL"},"Keywords":["Dynamic SQL","Execute SQL"]},{"RecordId":"611","Title":"Print IFrames","Description":"Demonstrates how to dynamically load up to 5 IFrames with document and then print them.","Code":"/* --------------------------------------------------------------------------------------------------\r\nThis is the code that sets the URLs of the IFrames to the document\r\nthat is being printed.\r\n----------------------------------------------------------------------------------------------------*/\r\nif (strAction == 'Print') {\r\n\tvar i2 = 0;\r\n\r\n\tif (parseInt(frm.chkContribution.length).toString() == 'NaN') {\t// Special case - one record only\r\n\t\tif (frm.chkContribution.checked) {\r\n\t\t\ti2=1;\r\n\t\t\tstrPrintURL = '../cform/ContentDetail.asp?DocID=' + frm.chkContribution.value + '&CTID=<%=lngCurrentContentType%>';\r\n\t\t\telFrames = eval('window.frames[\\'printFrame' + i2.toString() + '\\']');\r\n\t\t\telFrames.location.href = strPrintURL;\r\n\t\t\tPrintThisFrame(i2.toString(), 0);\r\n\t\t}\r\n\t} else {\r\n\r\n\t\tfor (i=0; i < frm.chkContribution.length; i++) {\r\n\t\t\tif (frm.chkContribution[i].checked) {\r\n\t\t\t\ti2++;\r\n\t\t\t\tvar strPrintURL = '../cform/ContentDetail.asp?DocID=' + frm.chkContribution[i].value + '&CTID=<%=lngCurrentContentType%>';\r\n\t\t\t\tvar elFrames = eval('window.frames[\\'printFrame' + i2.toString() + '\\']');\r\n\t\t\t\telFrames.location.href = strPrintURL;\r\n\t\t\t\tPrintThisFrame(i2.toString(), 0);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\treturn;\r\n}\r\n\r\n\r\n\r\n\r\n\r\n/*-----------------------------------------------------------------\r\nPrintThisFrame\tPrints the selected records.  Loads each document\r\n\t\t\t\tinto IFrames and prints them.  Retries up to 20 times.\r\n-----------------------------------------------------------------*/\r\nfunction PrintThisFrame(strFrameNumber, intCount){\r\n\r\n\tvar elThisFrame = eval('window.frames[\\'printFrame' + strFrameNumber + '\\']');\r\n\r\n\tintCount++;\r\n\r\n\t// If we've tried 20 times, give up.\r\n\tif (intCount > 20) {\r\n\t\telThisFrame.location.href='about:blank';\r\n\t\talert('Unable to print document');\r\n\t\treturn;\r\n\t}\r\n\r\n\t// If the iframe is not loaded yet, wait one second and try again.\r\n\tif (elThisFrame.location.href == 'about:blank') {\r\n\t\tsetTimeout(\"PrintThisFrame(\\'\" + strFrameNumber + \"\\',\" + intCount + \")\", 1);\r\n\t} else {\r\n\t\telThisFrame.window.focus();\r\n\t\telThisFrame.window.print();\r\n\t\telThisFrame.location.href='about:blank';\r\n\t}\r\n}\r\n\r\n\r\n/* --------------------------------------------------------------------------------------------------\r\nThese are the IFrames that will be used to contain the documents to print.\r\nThey are in a 1 x 1 div that has a 10 x 10 div on top of it to prevent it from being visible.\r\n----------------------------------------------------------------------------------------------------*/\r\n\r\n<!-- The following iFrames are used for printing individual documents (up to 5) -->\r\n<div style=\"position:absolute;top:0;left:0;width:1;height:1;z-index:0\">\r\n<iframe name=\"printFrame1\" id=\"printFrame1\" src=\"about:blank\" width=\"1px\" height=\"1px\"></iframe>\r\n<iframe name=\"printFrame2\" id=\"printFrame2\" src=\"about:blank\" width=\"1px\" height=\"1px\"></iframe>\r\n<iframe name=\"printFrame3\" id=\"printFrame3\" src=\"about:blank\" width=\"1px\" height=\"1px\"></iframe>\r\n<iframe name=\"printFrame4\" id=\"printFrame4\" src=\"about:blank\" width=\"1px\" height=\"1px\"></iframe>\r\n<iframe name=\"printFrame5\" id=\"printFrame5\" src=\"about:blank\" width=\"1px\" height=\"1px\"></iframe>\r\n</div>\r\n<!-- The following div sits on top of the div that contains the iFrames so that it won't be seen -->\r\n<div style=\"position:absolute;top:0;left:0;width:10;height:10;z-index:10;background:#FFFFFF\">\r\n\r\n</div>\r\n","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["Print IFrame","IFrame Printing"]},{"RecordId":"612","Title":"Attach MS Access Tables","Description":"Reattaches MS Access tables on the fly","Code":"Option Compare Database\r\nOption Explicit\r\n\r\nPublic Const ConStr As String = \"ODBC;DSN=MuniPortMgr;\" & _\r\n        \"Description=Municipal Bonds Portfolio Manager;SERVER=JCBMNUW;UID=;PWD=;\" & _\r\n        \"DATABASE=MuniPortMgr;QueryLog_On=Yes;StatsLon_On=Yes;Regional=Yes\"\r\n\r\nPublic Sub AttachTables()\r\n\r\nDim dbcurrent As Database\r\nDim tmpTable As TableDef\r\nDim intTotalTables As Integer\r\nDim lngReturnValue As Long\r\nDim i As Integer\r\n\r\nOn Error GoTo AttachError\r\n\r\nSet dbcurrent = CurrentDb()\r\nintTotalTables = dbcurrent.TableDefs.Count\r\n\r\nlngReturnValue = SysCmd(acSysCmdInitMeter, \"Establishing database connections . . .\", intTotalTables)\r\nFor i = 0 To intTotalTables - 1\r\n    \r\n    Set tmpTable = dbcurrent.TableDefs(i)\r\n   ' Debug.Print tmpTable.Name\r\n    \r\n    If tmpTable.Connect <> \"\" Then\r\n        \r\n        If Left$(tmpTable.Connect, 5) = \"ODBC;\" Then\r\n        \r\n            If tmpTable.Connect <> ConStr Then\r\n                tmpTable.Connect = ConStr\r\n                tmpTable.RefreshLink\r\n            End If\r\n        End If\r\n    End If\r\n    \r\nNextRecord:\r\n    lngReturnValue = SysCmd(acSysCmdUpdateMeter, i + 1)\r\nNext\r\n\r\nlngReturnValue = SysCmd(acSysCmdClearStatus)\r\nExit Sub\r\n\r\nAttachError:\r\n\r\n    MsgBox Err.Description & vbCrLf & vbCrLf & \"Unable to establish connection for \" & tmpTable.Name, vbExclamation, \"Application Startup Error\"\r\n    Resume Next\r\n\r\nEnd Sub\r\n\r\n\r\n\r\n\r\nPublic Sub CreateDSN()\r\n\r\n'Creates an ODBC DSN and caches the server connection\r\n\r\nDim db As Database\r\nDim strAttribs As String\r\n\r\nOn Error GoTo ConnectError\r\n\r\nstrAttribs = \"Description=Municipal Bonds Portfolio Manager\" & _\r\n            Chr$(13) & \"AnsiNPW=Yes\" & _\r\n            Chr$(13) & \"Database=MuniPortMgr\" & _\r\n            Chr$(13) & \"OemToAnsi=No\" & _\r\n            Chr$(13) & \"QuotedId=Yes\" & _\r\n            Chr$(13) & \"Server=JCBMNUW\" & _\r\n            Chr$(13) & \"Trusted_Connection=Yes\" & _\r\n            Chr$(13) & \"UseProcForPrepare=Yes\"\r\n            \r\nDBEngine.RegisterDatabase \"MuniPortMgr\", \"SQL Server\", True, strAttribs\r\n\r\nSet db = DBEngine.Workspaces(0).OpenDatabase(\"\", False, False, ConStr)\r\ndb.Close\r\n\r\nSet db = Nothing\r\nExit Sub\r\n\r\nConnectError:\r\n\r\n    MsgBox Err.Description & vbCrLf & vbCrLf & \"Unable to connect to SQL Server.\"\r\n    Exit Sub\r\n    \r\nEnd Sub","Declares":"","CodeCategory":{"CategoryId":"1","CategoryDescription":"VB"},"Keywords":["Access","Attach Tables"]},{"RecordId":"613","Title":"Meta Tag Search Keywords","Description":"How to tag your site for search engines","Code":"EXAMPLE 1\r\n\r\n<HEAD>\r\n<TITLE>My World</TITLE>\r\n<META name=\"description\" content=\"Everything you wanted to know about stamps, from prices to history.\">\r\n<META name=\"keywords\" content=\"stamps, stamp collecting, stamp history, prices, stamps for sale\">\r\n</HEAD>\r\n\r\nEXAMPLE 2\r\n\r\n<HEAD>\r\n<TITLE>Page I Don't Want In Search Engines</TITLE>\r\n<META NAME=\"ROBOTS\" CONTENT=\"NOINDEX\">\r\n</HEAD>","Declares":"","CodeCategory":{"CategoryId":"2","CategoryDescription":"Web"},"Keywords":["Meta Tags","Search Keywords"]},{"RecordId":"614","Title":"Get Week Information From SQL Server","Description":"This procedure will get week information (number, day, start-day, finish) for requested date. By default output dates are in 'mm/dd/yyyy' format.\r\nFormat of the output dates could be changed (see 'style' info in the SQL HelpFile for 'Convert' function).","Code":"/*----------------------------------------------------------------------------------------------\r\nUsage:\r\ndeclare @mydate varchar(25)\r\nset @mydate = getdate()\r\nexec _weekByDate_sp @mydate,110\r\n----------------------------------------------------------------------------------------------*/\r\n\r\ncreate procedure _WeekByDate_sp\r\n\t\t@currdate varchar(25),\r\n\t\t@Format int = 101\t\r\nas\r\n/*\r\nThe following procedure will get week information ( number,day start-day finish) for requested date.\r\nFormat of the output dates could be changed. (see 'style' info in the SQL HelpFile for 'Convert' function)\r\n\r\n\r\nWithout   With \r\ncentury century \r\n(yy)\t(yyyy)\tStandard Input/Output**\r\n-\t0 or 100 (*) \tDefault\tmon dd yyyy hh:miAM (or PM)\r\n1\t101\tUSA\tmm/dd/yy\r\n2\t102\tANSI\tyy.mm.dd\r\n3\t103\tBritish/French\tdd/mm/yy\r\n4\t104\tGerman\tdd.mm.yy\r\n5\t105\tItalian\tdd-mm-yy\r\n6\t106\t-\tdd mon yy\r\n7\t107\t-\tmon dd, yy\r\n8\t108\t-\thh:mm:ss\r\n-\t9 or 109 (*) \tDefault + milliseconds\tmon dd yyyy hh:mi:ss:mmmAM (or PM)\r\n10\t110\tUSA\tmm-dd-yy\r\n11\t111\tJAPAN\tyy/mm/dd\r\n12\t112\tISO\tyymmdd\r\n-\t13 or 113 (*) \tEurope default + milliseconds\tdd mon yyyy hh:mm:ss:mmm(24h)\r\n14\t114\t-\thh:mi:ss:mmm(24h)\r\n-\t20 or 120 (*) \tODBC canonical\tyyyy-mm-dd hh:mi:ss(24h)\r\n-\t21 or 121 (*) \tODBC canonical (with milliseconds)\tyyyy-mm-dd hh:mi:ss.mmm(24h)\r\n\r\n\r\nCreated by Eva Zadoyen\r\n04/08/2002 \r\n*/\r\n\r\ndeclare @firstday varchar(25)\r\ndeclare @endday varchar(25)\r\ndeclare @day int\r\ndeclare @week int\r\n\r\nselect @week = datepart(ww,@currdate)\r\nselect @day = @@datefirst- datepart(dd,@currdate)\r\nselect @firstday = convert(varchar(25),dateadd( dd,@day, @currdate),@format)\r\nselect @endday = convert(varchar(25),dateadd(dd,7,@firstday),@format)\r\nselect @currdate 'Date',@week 'Week', @firstday 'First Day of the Week',@endday 'Last Day of the Week' \r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"6","CategoryDescription":"T-SQL"},"Keywords":["GetWeek","Get Week Information"]},{"RecordId":"615","Title":"DateDiff2 - This modified function returns how many \"date part\" is exactly passed.","Description":"A modified version of DateDiff.  \r\nDateDiff Function checks the \"datepart\" only of the dates. \r\nThis modified function returns how many \"date part\" is exactly passed.","Code":"Use Master\r\nif exists (select * from dbo.sysobjects where id = object_id(N'dbo.DateDiff2') \r\n\tand xtype in (N'FN', N'IF', N'TF'))\r\ndrop function dbo.DateDiff2\r\nGO\r\n\r\nCREATE Function DateDiff2 (  \r\n @DatePart Varchar(20), @D1 dateTime, @D2 DateTime)  \r\nReturns Int  \r\nAS  \r\nBEGIN  \r\nDeclare @Diff int, @Date1 DateTime, @Date2 dateTime\r\nIF @D1>@D2\r\n Select @Date1=@D2, @Date2=@D1\r\nElse\r\n Select @Date1=@D1, @Date2=@D2\r\n\r\n\t\r\nIF @DatePart In ('Year', 'yy', 'yyyy') \r\nBEGIN\r\n\tSelect @Diff = DateDiff(Year, @Date1, @Date2)\r\n\tIF DateAdd(Year, @Diff, @Date1)>@Date2\r\n\t\tSet @Diff= @Diff-1\r\nEND\r\nELSE \r\n\tIF @DatePart In ('Quarter', 'qq', 'q') \r\nBEGIN\r\n\tSelect @Diff = DateDiff(Quarter, @Date1, @Date2)\r\n\tIF DateAdd(Quarter, @Diff, @Date1)>@Date2\r\n\t\tSet @Diff= @Diff-1\r\nEND\r\nELSE \r\n\tIF @DatePart In ('Month', 'mm', 'm') \r\nBEGIN\r\n\tSelect @Diff = DateDiff(Month, @Date1, @Date2)\r\n\tIF DateAdd(Month, @Diff, @Date1)>@Date2\r\n\t\tSet @Diff= @Diff-1\r\nEND\r\nELSE \r\n\tIF @DatePart In ('DayofYear', 'dy', 'y') \r\nBEGIN\r\n\tSelect @Diff = DateDiff(DayOFYear, @Date1, @Date2)\r\n\tIF DateAdd(DayOFYear, @Diff, @Date1)>@Date2\r\n\t\tSet @Diff= @Diff-1\r\nEND\r\nELSE \r\n\tIF @DatePart In ('Day', 'dd', 'd') \r\nBEGIN\r\n\tSelect @Diff = DateDiff(Day, @Date1, @Date2)\r\n\tIF DateAdd(Day, @Diff, @Date1)>@Date2\r\n\t\tSet @Diff= @Diff-1\r\nEND\r\nELSE \r\n\tIF @DatePart In ('Week', 'wk', 'ww') \r\nBEGIN\r\n\tSelect @Diff = DateDiff(Week, @Date1, @Date2)\r\n\tIF DateAdd(Week, @Diff, @Date1)>@Date2\r\n\t\tSet @Diff= @Diff-1\r\nEND\r\nELSE \r\n\tIF @DatePart In ('WeekDay', 'dw') \r\nBEGIN\r\n\tSelect @Diff = DateDiff(WeekDay, @Date1, @Date2)\r\n\tIF DateAdd(WeekDay, @Diff, @Date1)>@Date2\r\n\t\tSet @Diff= @Diff-1\r\nEND\r\nELSE \r\n\tIF @DatePart In ('Hour', 'hh') \r\nBEGIN\r\n\tSelect @Diff = DateDiff(Hour, @Date1, @Date2)\r\n\tIF DateAdd(Hour, @Diff, @Date1)>@Date2\r\n\t\tSet @Diff= @Diff-1\r\nEND\r\nELSE \r\n\tIF @DatePart In ('Minute', 'mi', 'n') \r\nBEGIN\r\n\tSelect @Diff = DateDiff(Minute, @Date1, @Date2)\r\n\tIF DateAdd(Minute, @Diff, @Date1)>@Date2\r\n\t\tSet @Diff= @Diff-1\r\nEND\r\nELSE \r\n\tIF @DatePart In ('Second', 'ss', 's') \r\nBEGIN\r\n\tSelect @Diff = DateDiff(Second, @Date1, @Date2)\r\n\tIF DateAdd(Second, @Diff, @Date1)>@Date2\r\n\t\tSet @Diff= @Diff-1\r\nEND\r\nELSE \r\n\tIF @DatePart In ('Millisecond', 'ms') \r\nBEGIN\r\n\tSelect @Diff = DateDiff(Millisecond, @Date1, @Date2)\r\n\tIF DateAdd(Millisecond, @Diff, @Date1)>@Date2\r\n\t\tSet @Diff= @Diff-1\r\nEND\r\nIF @D1>@D2\r\n\tSet @Diff= -1*@Diff\r\nReturn @Diff\r\nEND","Declares":"","CodeCategory":{"CategoryId":"6","CategoryDescription":"T-SQL"},"Keywords":["DateDiff2"]},{"RecordId":"617","Title":"Open CSV Text File With ADO","Description":"Demonstrates how to open a CSV text file with ADO","Code":"Schema.ini file is required to be in the folder where the file is\r\n[currenttemplates.csv]\r\nColNameHeader=True\r\nFormat=CSVDelimited\r\nMaxScanRows=0\r\nCharacterSet=ANSI\r\nCol1=TEMPLATENAME Char\r\nCol2=FUNCTION Char\r\nCol3=DESCRIPTION Char\r\nCol4=RELEASEDATE Char\r\nCol5=SUNSETDATE Char\r\nCol6=CONTACT Char\r\nCol7=CONTACTEMAIL Char\r\nCol8=URL Char\r\n\r\n\r\n\r\ndim oConn\r\ndim oRS\r\n\r\nset oConn = server.CreateObject(\"ADODB.Connection\")\r\nset oRS = server.CreateObject(\"ADODB.Recordset\")\r\n\r\noConn.Provider = \"Microsoft.Jet.OLEDB.4.0\"\r\noConn.ConnectionString = \"Data Source=c:\\mypath\\;Extended Properties=Text;\"\t'Note that we provide PATH only - not the file name\r\noConn.Open\r\n\r\noRS.Open \"SELECT * FROM CurrentTemplates.csv\", oConn\t\t\t\t' This is what opens the text file\r\ndo while not oRS.EOF\r\n\tResponse.Write oRS(0) & \"<BR>\"\r\n\toRS.MoveNext\r\nloop\r\n\r\noRS.Close\r\nset oRS = Nothing\r\n\r\noConn.close\r\nset oConn = nothing","Declares":"","CodeCategory":{"CategoryId":"5","CategoryDescription":"ASP"},"Keywords":["CSV Text File","ADO CSV"]},{"RecordId":"618","Title":"XML - Web Page Hit Counter","Description":"Outstanding demo of how to use XML to create a web page hit counter","Code":"'------------------------------------------------------------------------------------\r\n'  Script 1 of 2 - Appends hit counts to an XML file\r\n'------------------------------------------------------------------------------------\r\n<%\r\nOption Explicit\r\n'-----Declare Data\r\nDim objXML, blnFileExist\r\nDim objXMLv\r\nDim intID\r\n\r\nSet objXML = server.CreateObject(\"Microsoft.XMLDOM\")\r\n'Set objXML = server.CreateObject(\"Msxml2.XMLDocument\")\r\nobjXML.async = False\r\n\r\n'-----Check FileExist\r\nblnFileExist = objXML.load(server.MapPath(\"visitor.xml\"))\r\nIf blnFileExist = False Then\r\n\tobjXML.appendChild(objXML.createProcessingInstruction(\"xml\",\"version=\"\"1.0\"\"\"))\r\n\tobjXML.appendChild(objXML.createElement(\"visitors\"))\r\n\tintID = 1\r\nElse\r\n\tintID = objXML.documentElement.childNodes( _\r\n\t\tobjXML.documentElement.childNodes.length - 1).childNodes(0).text + 1\r\nEnd If\r\n\r\n'-----Start Processing\r\nSet objXMLv = objXML.createElement(\"visitor\")\r\n\r\nobjXMLv.appendChild(objXML.createElement(\"ID\"))\r\nobjXMLv.appendChild(objXML.createElement(\"HTTP_USER_AGENT\"))\r\nobjXMLv.appendChild(objXML.createElement(\"HTTP_REFERER\"))\r\nobjXMLv.appendChild(objXML.createElement(\"HTTP_HOST\"))\r\nobjXMLv.appendChild(objXML.createElement(\"HTTP_ACCEPT_LANGUAGE\"))\r\nobjXMLv.appendChild(objXML.createElement(\"REMOTE_HOST\"))\r\nobjXMLv.appendChild(objXML.createElement(\"REMOTE_ADDR\"))\r\nobjXMLv.appendChild(objXML.createElement(\"LOCAL_ADDR\"))\r\nobjXMLv.appendChild(objXML.createElement(\"DATE\"))\r\n\r\nobjXMLv.childNodes(0).text = intID\r\nobjXMLv.childNodes(1).text = Request.ServerVariables(\"HTTP_USER_AGENT\")\r\nobjXMLv.childNodes(2).text = Request.ServerVariables(\"HTTP_REFERER\")\r\nobjXMLv.childNodes(3).text = Request.ServerVariables(\"HTTP_HOST\")\r\nobjXMLv.childNodes(4).text = Request.ServerVariables(\"HTTP_ACCEPT_LANGUAGE\")\r\nobjXMLv.childNodes(5).text = Request.ServerVariables(\"REMOTE_HOST\")\r\nobjXMLv.childNodes(6).text = Request.ServerVariables(\"REMOTE_ADDR\")\r\nobjXMLv.childNodes(7).text = Request.ServerVariables(\"LOCAL_ADDR\")\r\nobjXMLv.childNodes(8).text = Now()\r\n\r\nobjXML.documentElement.appendChild(objXMLv.cloneNode(True))\r\nobjXML.save(server.MapPath(\"visitor.xml\"))\r\n\r\n'-----Clear Object\r\nSet objXMLv = Nothing\r\nSet objXML = Nothing\r\n%>\r\n\r\n\r\n'------------------------------------------------------------------------------------\r\n'  Script 2 of 2 - Displays the XML file\r\n'------------------------------------------------------------------------------------\r\n<%@ Language=VBScript %>\r\n<%\r\nOption Explicit\r\n\r\n'-----Declare Data\r\nDim xmlVisitor\r\nDim blnFileExist\r\nDim intMaxRow, intRow, intCol, intMaxCol\r\n\r\n'-----Start Processing\r\nSet xmlVisitor = server.CreateObject(\"Microsoft.XMLDOM\")\r\n'Set xmlVisitor = server.CreateObject(\"Msxml2.XMLDocument\")\r\nblnFileExist = xmlVisitor.load(server.MapPath(\"visitor.xml\"))\r\n\r\nIf blnFileExist = False Then\r\n\tResponse.Write \"No Record Found\"\r\nElse\r\n\t\r\n\tWith xmlVisitor.documentElement\r\n\t\tintMaxRow = .childNodes.length - 1\r\n\t\tintMaxCol = .childNodes(0).childNodes.length - 1\r\n\t\t\r\n\t\t'-----Draw Table\r\n\t\tResponse.Write \"<table border=\"\"1\"\" width=\"\"100%\"\" cellspacing=\"\"0\"\">\"\r\n\t\t'-----Write Title\r\n\t\tResponse.Write \"<tr>\"\r\n\t\tFor intCol = 0 To intMaxCol\r\n\t\t\tResponse.Write \"<th>\" & .childNodes(0).childNodes(intCol).nodeName & \"</th>\"\r\n\t\tNext\r\n\t\tResponse.Write \"</tr>\"\r\n\t\t\r\n\t\t'-----Write Records\r\n\t\tFor intRow = 0 To intMaxRow\r\n\t\t\tResponse.Write \"<tr>\"\r\n\t\t\tFor intCol = 0 To intMaxCol\r\n\t\t\t\tResponse.Write \"<td>\"\r\n\t\t\t\tResponse.Write .childNodes(intRow).childNodes(intCol).text & \"<br>\"\r\n\t\t\t\tResponse.Write \"</td>\"\r\n\t\t\tNext\r\n\t\t\tResponse.Write \"</tr>\"\r\n\t\tNext\r\n\t\tResponse.Write \"</table>\"\r\n\tEnd With\r\nEnd If\r\n\r\n'-----Clear Object\r\nSet xmlVisitor = Nothing\r\n%>","Declares":"","CodeCategory":{"CategoryId":"8","CategoryDescription":"XML"},"Keywords":["Hit Counter","XML"]},{"RecordId":"619","Title":"XML - File Upload Example","Description":"Demonstrates how to use XML to upload a binary file to a web server","Code":"'----------------------------------------------------------------------------------------------------------------\r\n' File 1 of 2 - Request form/page\r\n'----------------------------------------------------------------------------------------------------------------\r\n\r\n<HTML>\r\n<HEAD><TITLE>File Send</TITLE></HEAD>\r\n<BODY>\r\n   <INPUT id=btn_send name=\"btn_send\" type=button value=\"FILE SEND\">\r\n   <DIV id=div_message>Ready</DIV>\r\n</BODY>\r\n</HTML>\r\n\r\n<SCRIPT LANGUAGE=JavaScript>\r\n\r\n// files upload function\r\nfunction btn_send.onclick()\r\n{\r\n   // create ADO-stream Object\r\n   var ado_stream = new ActiveXObject(\"ADODB.Stream\");\r\n\r\n   // create XML document with default header and primary node\r\n   var xml_dom = new ActiveXObject(\"MSXML2.DOMDocument\");\r\n   xml_dom.loadXML('<?xml version=\"1.0\" ?> <root/>');\r\n\r\n   // specify namespaces datatypes\r\n   xml_dom.documentElement.setAttribute(\"xmlns:dt\", \"urn:schemas-microsoft-com:datatypes\");\r\n\r\n   // create a new node and set binary content\r\n   var l_node1 = xml_dom.createElement(\"file1\");\r\n   l_node1.dataType = \"bin.base64\";\r\n\r\n   // open stream object and read source file\r\n   ado_stream.Type = 1;  // 1=adTypeBinary \r\n   ado_stream.Open(); \r\n   ado_stream.LoadFromFile(\"c:\\\\tmp\\\\myfile.doc\");\r\n\r\n   // store file content into XML node\r\n   l_node1.nodeTypedValue = ado_stream.Read(-1); // -1=adReadAll\r\n   ado_stream.Close();\r\n   xml_dom.documentElement.appendChild(l_node1);\r\n\r\n   // we can create more XML nodes for multiple file upload\r\n\r\n   // send XML documento to Web server\r\n   var xmlhttp = new ActiveXObject(\"Microsoft.XMLHTTP\");\r\n   xmlhttp.open(\"POST\",\"./file_receive.asp\",false);\r\n   xmlhttp.send(xml_dom);\r\n\r\n   // show server message in message-area\r\n   div_message.innerHTML = xmlhttp.ResponseText;\r\n}\r\n</SCRIPT>\r\n</body>\r\n</html>\r\n\r\n'----------------------------------------------------------------------------------------------------------------\r\n' File 2 of 2 - Request processing page\r\n'----------------------------------------------------------------------------------------------------------------\r\n<%@ LANGUAGE=VBScript%>\r\n<% Option Explicit\r\n   Response.Expires = 0 \r\n   \r\n   ' define variables and COM objects\r\n   dim ado_stream\r\n   dim xml_dom\r\n   dim xml_file1\r\n\r\n   ' create Stream Object\r\n   set ado_stream = Server.CreateObject(\"ADODB.Stream\")\r\n\r\n   ' create XMLDOM object and load it from request ASP object\r\n   set xml_dom = Server.CreateObject(\"MSXML2.DOMDocument\")\r\n   xml_dom.load(request)\r\n\r\n   ' retrieve XML node with binary content\r\n   set xml_file1 = xml_dom.selectSingleNode(\"root/file1\")\r\n\r\n   ' open stream object and store XML node content into it   \r\n   ado_stream.Type = 1  ' 1=adTypeBinary \r\n   ado_stream.open \r\n   ado_stream.Write xml_file1.nodeTypedValue\r\n\r\n   ' save uploaded file\r\n   ado_stream.SaveToFile \"c:\\tmp\\upload1.doc\",2  ' 2=adSaveCreateOverWrite \r\n   ado_stream.close\r\n\r\n   ' destroy COM object   \r\n   set ado_stream = Nothing \r\n   set xml_dom = Nothing\r\n\r\n   ' write message to browser\r\n   Response.Write \"Upload successful!\"\r\n%>","Declares":"","CodeCategory":{"CategoryId":"8","CategoryDescription":"XML"},"Keywords":["File Upload","XML Upload"]},{"RecordId":"622","Title":"Create ADO Recordset On The Fly","Description":"Create ADO recordset on the fly and populate it with data","Code":"function createRS()\r\n\r\n\tdim oConn\r\n\tdim oRS\r\n\tConst adCurrency = 6\r\n\tConst adChar = 129\t\r\n\r\n\tset oConn = Server.Createobject(\"adodb.connection\")\r\n\tset oRS = Server.Createobject(\"ADODB.Recordset\")\r\n\t\r\n\toRS.Fields.Append \"Column1\", adChar, 10\r\n    \toRS.Fields.Append \"Column2\", adCurrency\r\n    \toRS.Fields.Append \"Column3\", adCurrency\r\n\r\n\toRS.Open\r\n\t    \r\n\toRS.addnew\r\n\toRS(\"Column1\") = \"001\"\t\r\n\toRS(\"Column2\") = 100\t\r\n\toRS(\"Column3\") = 200\r\n\toRS.Update\t\r\n\t\r\n\toRS.addnew\r\n\toRS(\"Column1\") = \"002\"\t\r\n\toRS(\"Column2\") = 130\t\r\n\toRS(\"Column3\") = 230\r\n\toRS.Update\t\r\n\r\n\toRS.addnew\r\n\toRS(\"Column1\") = \"003\"\t\r\n\toRS(\"Column2\") = 160\t\r\n\toRS(\"Column3\") = 260\r\n\toRS.Update\t\r\n\t\r\n\toRS.Movefirst\r\n\t\t\r\n\tset createRS = oRS\r\n\tset oRS.activeconnection = nothing\r\n\tset oRS = Nothing\r\n\r\nend function","Declares":"","CodeCategory":{"CategoryId":"3","CategoryDescription":"Database"},"Keywords":["On The Fly","Dynamic Recordset","Create ADO Recordset On The Fl"]},{"RecordId":"623","Title":"Client-side Validation Using the XMLHTTPRequest Object","Description":"Demonstrates how to use XMLHTTPRequest object to call server-side pages to perform client-side validation.","Code":"<SCRIPT TYPE=\"text/javascript\" LANGUAGE=\"JavaScript\">\r\n\r\nfunction validateuserid(suserid) {\r\n\r\n\tdocument.body.style.cursor='wait';\r\n\r\n\t// Create an instance of the XML HTTP Request object\r\n\tvar oXMLHTTP = new ActiveXObject(\"Microsoft.XMLHTTP\");\r\n\t\r\n\t// Prepare the XMLHTTP object for a HTTP POST to our validation ASP page\r\n\tvar sURL = \"http://mysite/mypath/validateuser.asp?username=\" + suserid\r\n\toXMLHTTP.open( \"POST\", sURL, false );\r\n\r\n\t// Execute the request\r\n\toXMLHTTP.send();\r\n\r\n\tif (oXMLHTTP.responseText == \"exists\") \r\n\t\talert(\"Sorry - the User ID \" + suserid + \" already exists.\");\r\n\r\n\tdocument.body.style.cursor='auto';\r\n\r\n}\r\n\r\n</SCRIPT>","Declares":"","CodeCategory":{"CategoryId":"5","CategoryDescription":"ASP"},"Keywords":["XMLHTTPRequest","Client-side Validation"]},{"RecordId":"624","Title":"ADSI Samples - Programming Against an NT Domain","Description":"Validate NT users, change NT password, see if account is locked out, etc.","Code":"I needed to be able to create a means to have a custom login Web page \r\nthat collected a user's username and password and then determined if \r\nthe entered credentials matched the credentials for a user on the \r\nWindows NT domain.\r\n\r\nADSI services can be used to enumerate and manage resources in a \r\ndirectory service.  Microsoft products that currently support the \r\nADSI programming interface are Windows NT 4.0 Server, Windows 2000, \r\nExchange, IIS, and Site Server. More ADSI information can be found \r\nat: ADSI Article Archive - \r\nhttp://www.4guysfromrolla.com/webtech/LearnMore/adsi.asp -\r\nand the 15Second.com ADSI Focus Section -\r\nhttp://www.15seconds.com/focus/ADSI.htm\r\n\r\nUsing ADSI to Retrieve Information\r\nWhen using ADSI and the Windows NT provider, you are able to retrieve\r\ninformation about the Domain, Computers, Groups and Users. To get\r\ninformation about a particular user, you could use the following code,\r\nwhich retrieves information about the user dsetzer on the NT Domain\r\nMyDomain:\r\n\r\n'Specify the domain and username\r\nstrNTDomain = \"MyDomain\"\r\nstrUsername = \"dsetzer\"\r\n\r\n'Get information about the user\r\nDim objIADSUser\r\nSet objIADSUser = GetObject(\"WinNT://\" & strNTDomain & \"/\" &\r\nstrUsername & \",user\")\r\n\r\n\r\nThe above code retrieves information about a specific user. The last \r\nline is the important one that does all the work. It calls ADSI and \r\ncreates an ADSI user object. Note that the variables get translated \r\ninto the request:\r\nWinNT://MyDomain/dsetzer,user, and returns a User object.\r\n\r\nChanging User Information through ADSI\r\nThe user object give you access to the user's information such as\r\ntheir full name, the groups they are in, if their account is disabled\r\nand if their account is locked out. In addition to finding out\r\ninformation about the user, it allows you to make changes to their\r\naccount. To change their password, you execute the following code:\r\n\r\n'specify the old and new passwords\r\nstrOldPassword = \"THEPWD\"\r\nstrNewPassword = \"ILOVEMOM\"\r\n\r\n'change the user's password\r\nobjIADSUser.ChangePassword strOldPassword,strNewPassword\r\nobjIADSUser.SetInfo\r\n\r\n\r\nThis code defines what the user's current password is and what the\r\npassword should be changed to. It then calls a method on the ADSI user\r\nobject to change the password for the user. Anytime you make changes,\r\nyou need to call the SetInfo method to do the actual update in the\r\nprovider. This is because ADSI locally caches the information about\r\nthe user to speed up response times and minimize network traffic.\r\n\r\nIn order for the change password code above to work, administrator\r\nrights are required. Because ADSI was written with network\r\nadministrators in mind, it gives you a way to run scripts on behalf of\r\nanother user. For instance, say a company wanted users to be able to\r\nchange their password from the company's intranet. Anonymous requests\r\nto the intranet are likely going to be configured to be run under the\r\nIUSR_machinename account, which is generally a normal user with very\r\nlimited permissions. To allow for ADSI actions to occur for an\r\nintranet request, one can essentially use ADSI to create a \"container\"\r\nobject that encapsulates the Administrator account. Using this\r\ncontainer you can then change a user's password through an ASP Web\r\npage. Some code may help clarify things here:\r\n\r\n'Specify the domain we're working with\r\nstrNTDomain = \"MyDomain\"\r\n\r\n'Specify the username/password for the administrator account\r\nstrAdminUsername = \"Administrator\"\r\nstrAdminPassword = \"password\"\r\n\r\n'Specify the name of the user whose password you wish to change\r\nstrClientUsername = \"dsetzer\"\r\n\r\n'Specify the desired old and new password for the user\r\nstrOldPassword = \"THEPWD\"\r\nstrNewPassword = \"ILOVEMOM\"\r\n\r\n'Create a container for the Administrator account\r\nConst ADS_SECURE_AUTHENTICATION = 1\r\nSet objIADS = GetObject(\"WinNT:\").OpenDSObject(\"WinNT://\" & _\r\n                        strNTDomain, strAdminUserame, _\r\n                        strAdminPassword, _\r\n                        ADS_SECURE_AUTHENTICATION)\r\n\r\n'Change the user's password through the Administrator container\r\nSet objIADSUser = objIADS.GetObject(\"user\", strClientUsername)\r\n    objIADSUser.ChangePassword strOldPassword,strNewPassword\r\n    objIADSUser.SetInfo\r\n\r\n'Clean up\r\nSet objIADSUser = Nothing\r\nSet objIADS = Nothing\r\n\r\n\r\nWhile this code is a little longer that the previous example, it does,\r\nessentially, the same thing: it changes a specified user's password\r\nfrom an old password to a new one. Recall that the script to change\r\nthe user's password must run under the Administrator account. Since\r\nanonymous Web requests are treated as requests from the\r\nIUSR_machinename account, to perform an Administrator-level ADSI task\r\nthrough an ASP page you will need to create a container object that\r\nimpersonates the Administrator account. Once this container is\r\ncreated, you can use the container to perform the password changing\r\ntask.\r\n\r\nTake a quick minute to examine the code. Note that there is a constant\r\ncalled ADS_SECURE_AUTHENTICATION, which is used when authenticating\r\nthe Administrator account. Instead of creating the user object\r\ndirectly, as was done in the previous example, I first create a\r\ncontainer object on behalf of the Administrator. When I create this\r\nobject, ADSI securely verifies that the Administrator user exists in\r\nthe domain, that the password matches, and that the account isn't\r\ndisabled or locked out. Using that container, I create a User object\r\nwith which I'm then able to change the client user's password using\r\nthe same code as before.\r\n\r\nAuthenticating a User with ADSI\r\nChanging a password is all fine and dandy, but, you are probably\r\nsaying that you don't want to change the password, you want to check\r\nif a given username/password that has been entered into a login form\r\nmatches the user's account on the Windows domain. As I mentioned\r\nearlier, with ADSI you can get various pieces of information about a\r\nuser once you create an ADSI user object. One piece of information you\r\ncan't get the user's password from this object -- even as an\r\nadministrator. This is because when you enter or change your password\r\nin Windows, it doesn't store what you type in. Instead, it encrypts\r\nthe password using a one-way hash encryption and stores the encrypted\r\nvalue. It can't tell you what the password is because it can't decrypt\r\nit. But, you aren't really interested in what the user's password is.\r\nInstead, you want to know that it matches whatever the user enters as\r\nhis or her password.\r\n\r\nTo do this, you need to be able to create an object that verifies that\r\nthe account exists, the password matches and that it isn't disabled or\r\nlocked out. Sound familiar? The ability to run scripts on behalf of\r\nanother user isn't limited to just Administrators. If you are able to\r\ncreate the container object, without an error, you know that the\r\naccount exists, the password matches and that it isn't disabled or\r\nlocked out. If you receive an error, you can check the Err.Description\r\nproperty to find out why it failed.\r\n\r\nA final note, you should definitely be using SSL to secure the\r\ntransmission of the username and password from the browser to the\r\nserver. Windows NT passwords are one thing that you don't want to let\r\nloose!\r\n","Declares":"","CodeCategory":{"CategoryId":"5","CategoryDescription":"ASP"},"Keywords":["ADSI","NT Domain"]},{"RecordId":"626","Title":"Change Cursor on Web Pages","Description":"Demonstrates how to use custom cursors on web pages","Code":"How to use stylesheets for cross-browser cursor control or to display your own custom cursors.  \r\n \r\nCurrent versions of both major browsers (Internet Explorer 4+ and Netscape 6+) support the cursor style property. This CSS2 property allows Web designers to associate designated cursor shapes with elements on their Web page. \r\n\r\nOne way to assign a specific cursor to an element, is to add the style=\"cursor:value\" attribute to the HTML element tag. For instance, the following code would assign the standard help cursor to an individual paragraph. (There is a complete list of cursor values and shapes below.): \r\n\r\n<p style=\"cursor:help\"> \r\n\r\nThe cursor property can also be included in either an internal or external stylesheet. The following example uses an internal stylesheet to set the cursor to a crosshair as it passes over all paragraphs in the page: \r\n\r\n<style>\r\np {cursor:crosshair;}\r\n</style> \r\n\r\nCustom Cursors \r\n\r\nIn addition to controlling standard cursor shapes, the ability to display an original cursor is part of the W3C specification. This capability is supported by Internet Explorer 6 (and possibly a coming version of Netscape). IE 6 supports cursors of type .CUR and .ANI. \r\n\r\nThe format for specifying a user-created icon is: \r\n\r\ncursor:url(uri) \r\n\r\nThe custom cursor is retrieved from the designated location (uri). A list of cursors should be specified, followed by a standard cursor designation. Then, if the user's browser cannot handle or find the first cursor, it will attempt to use the second, and so on. If the browser can't handle any of the user-defined cursors, it will use the standard cursor at the end of the list. Here is an example of how the actual code might look: \r\n\r\n<style>\r\np {cursor:url(\"mycursor.cur\"), url(\"mycursor.csr\"), auto;}\r\n</style>","Declares":"","CodeCategory":{"CategoryId":"2","CategoryDescription":"Web"},"Keywords":["Change Cursor","Custom Cursor"]},{"RecordId":"627","Title":"T-SQL Optimization Tips","Description":"14 T-SQL optimization tips","Code":"Transact-SQL Optimization Tips\r\n\r\nHere are fourteen little known tips that you can use to ensure your Transact-SQL queries are performing in the most efficient manner possible. \r\n\r\n\r\n1. Try to restrict the queries result set by using the WHERE clause. \r\n\r\nThis can result in a performance benefit, as SQL Server will return to the client only particular rows, not all rows from the table(s). This can reduce network traffic and boost the overall performance of the query. \r\n\r\n\r\n2. Try to restrict the queries result set by returning only the particular columns from the table, not all the table's columns. \r\n\r\nThis can result in a performance benefit as well, because SQL Server will return to the client only particular columns, not all the table's columns. This can reduce network traffic and boost the overall performance of the query. \r\n\r\n\r\n3. Use views and stored procedures instead of heavy-duty queries. \r\n\r\nThis can reduce network traffic as your client will send to the server only stored procedures or view name (perhaps with some parameters) instead of large heavy-duty queries text. This can be used to facilitate permission management also, because you can restrict user access to table columns they should not see. \r\n\r\n\r\n4. Whenever possible, try to avoid using SQL Server cursors. \r\n\r\nSQL Server cursors can result in some performance degradation in comparison with select statements. Try to use correlated subquery or derived tables, if you need to perform row-by-row operations. \r\n\r\n\r\n5. If you need to return the total table's row count, you can use an alternative way instead of the SELECT COUNT(*) statement. \r\n\r\nBecause the SELECT COUNT(*) statement makes a full table scan to return the total table's row count, it can take an extremely long time for large tables. There is another way to determine the total row count in a table. In this case, you can use the sysindexes system table. There is a ROWS column in the sysindexes table. This column contains the total row count for each table in your database. So, you can use the following select statement instead of SELECT COUNT(*): \r\n\r\nSELECT rows FROM sysindexes WHERE id = OBJECT_ID('table_name') AND indid < 2 \r\n\r\nThis way, you can improve the speed of such queries by several times. See this article for more details: Alternative way to get the table's row count. \r\n\r\n\r\n6. Try to use constraints instead of triggers, whenever possible. \r\n\r\nConstraints are much more efficient than triggers and can boost performance. So, whenever possible, you should use constraints instead of triggers. \r\n\r\n\r\n7. Use table variables instead of temporary tables. \r\n\r\nTable variables require fewer locking and logging resources than temporary tables, so table variables should be used whenever possible. The table variables are available in SQL Server 2000 only. \r\n\r\n\r\n8. Try to avoid the HAVING clause, whenever possible. \r\n\r\nThe HAVING clause is used to restrict the result set returned by the GROUP BY clause. When you use GROUP BY with the HAVING clause, the GROUP BY clause divides the rows into sets of grouped rows and aggregates their values, and then the HAVING clause eliminates undesired aggregated groups. In many cases, you can write your select statement so that they will contain only WHERE and GROUP BY clauses without the HAVING clause. This can improve the performance of your query. \r\n\r\n\r\n9. Whenever possible, try to avoid using the DISTINCT clause. \r\n\r\nBecause using the DISTINCT clause will result in some performance degradation, you should use this clause only when it is absolutely necessary. \r\n\r\n\r\n10. Include SET NOCOUNT ON statement into your stored procedures to stop the message indicating the number of rows affected by a T-SQL statement. \r\n\r\nThis can reduce network traffic, as your client will not receive the message indicating the number of rows affected by a T-SQL statement. \r\n\r\n\r\n11. Use select statements with the TOP keyword or the SET ROWCOUNT statement if you need to return only the first n rows. \r\n\r\nThis can improve performance of your queries, as a smaller result set will be returned. This can also reduce the traffic between the server and the clients. \r\n\r\n\r\n12. Use the FAST number_rows table hint if you need to quickly return 'number_rows' rows. \r\n\r\nYou can quickly get the n rows and can work with them when the query continues execution and produces its full result set. \r\n\r\n\r\n13. Try to use UNION ALL statement instead of UNION, whenever possible. \r\n\r\nThe UNION ALL statement is much faster than UNION, because UNION ALL statement does not look for duplicate rows, while the UNION statement does look for duplicate rows, whether they exist or not. \r\n\r\n\r\n14. Do not use optimizer hints in your queries. \r\n\r\nBecause the SQL Server query optimizer is very clever, it is highly unlikely that you can optimize your query by using optimizer hints; more often than not, this will hurt performance.\r\n","Declares":"","CodeCategory":{"CategoryId":"6","CategoryDescription":"T-SQL"},"Keywords":["Optimization Tips","Performance Tips"]},{"RecordId":"628","Title":"Caching XSL Processor to Improve Performance","Description":"The transformNode & transformNodeToObject methods compile XSLT stylesheets every time a user makes a request. Instead, use an XSLTemplate DOM object to cache the compiled XSLT stylesheet and use the XSLTProcessor DOM object to activate the transformation.","Code":"The following ASP code can result in poor performance and unpleasant experiences for the user.\r\n\r\n<%@LANGUAGE=\"JavaScript\"%>\r\n<%Response.expires=-1;\r\nfunction showSelection(){\r\n    var xmlDoc=new ActiveXObject(\"MSXML2.DOMDocument.4.0\");\r\n    xmlDoc.async=false;\r\n    xmlDoc.load(Server.mapPath(Request(\"xmlDoc\")));\r\n\r\n    var xsltDoc=new ActiveXObject(\"MSXML2.DOMDocument.4.0\");\r\n    xsltDoc.async=false;\r\n    xsltDoc.load(Server.mapPath(Request(\"xsltDoc\")));\r\n\r\n    xmlDoc.transformNode(xsltDoc);\r\n    }\r\nshowSelection();\r\n%>\r\n\r\nThe problem with the ASP code above is that the transformNode method (or its variant, transformNodeToObject) must compile the XSLT style sheet (xsltDoc) every time a user makes a request. To avoid such a pitfall, use the XSLTemplate DOM object to cache the compiled XSLT style sheet, and use the XSLTProcessor DOM object to activate the transformation using the cached style sheet.\r\n\r\nThis approach includes a subtle but useful feature. The XSLTProcessor object allows you to pass a parameter to the style sheet, so that you can write a single XSLT style sheet to transform different XML source documents based on this input parameter. Otherwise, you might need to keep different style sheets for different source documents.\r\n\r\nAdvantages of using XSLProcessor vs. TransformNode()\r\n\r\nScalability:  Caching the XSLT style sheet helps an ASP/XSLT application to scale better. However, it is not generally recommended to cache an XML document, due to the memory constraints involved. \r\n\r\nPerformance:  Using XSLTemplate means that the style sheet needs to be compiled only once. This considerably reduces the amount of processing involved. The XSLTemplate object can also be cached as an MTS object. The processing of this object can then be optimized across sessions, as well as within a session. \r\n\r\nParameterization:  The XSLTProcessor object enables to you to pass parameters into the style sheet. \r\n\r\nExtensions:  You can also pass COM objects into XSLT documents as namespace extensions. \r\n\r\n\r\n<%@LANGUAGE=\"JavaScript\"%>\r\n<%Response.expires=-1;\r\n\r\n// Sorts books from a given catalog by title, for a given Genre.\r\n\r\nfunction loadSource(sourceName){\r\n    var xmlDoc=new ActiveXObject(\"MSXML2.FreeThreadedDOMDocument.4.0\");\r\n    xmlDoc.async=false;\r\n    xmlDoc.load(Server.mapPath(sourceName));\r\n    return xmlDoc;\r\n    }\r\n\r\nfunction getProcessor(transformName){\r\n    if (\"\" + Session(transformName) == \"undefined\"){\r\n        var xslDoc=new ActiveXObject(\"MSXML2.FreeThreadedDOMDocument.4.0\");\r\n        var xslTemplate=new ActiveXObject(\"MSXML2.XSLTemplate.4.0\");\r\n        xslDoc.async=false;\r\n        xslDoc.load(Server.mapPath(transformName));\r\n        xslTemplate.stylesheet=xslDoc;\r\n        xslProcessor=xslTemplate.createProcessor();\r\n        Session(transformName)=xslProcessor;\r\n        }\r\n    else {\r\n        xslProcessor=Session(transformName);\r\n        }\r\n    return xslProcessor;\r\n    }\r\n\r\nfunction transformData(srcDoc,processor){\r\n    processor.input=srcDoc;\r\n    processor.output=Response;\r\n    processor.transform();\r\n    return true;\r\n    }\r\n\r\nfunction main(){\r\n\r\n    var srcDoc=loadSource(\"books.xml\");\r\n    var processor=getProcessor(\"catalogFilter.xsl\");\r\n\r\n    var genre=Request(\"genre\");\r\n    if(\"\"+genre==\"undefined\"){\r\n        genre=\"all\";\r\n        }\r\n    else {\r\n        genre=\"\"+genre;\r\n        }           \r\n    processor.addParameter(\"selected_genre\",genre);\r\n    transformData(srcDoc,processor);\r\n    }    \r\n\r\nmain();    \r\n %>","Declares":"","CodeCategory":{"CategoryId":"8","CategoryDescription":"XML"},"Keywords":["Caching XSL Processors"]},{"RecordId":"629","Title":"XML Special Characters","Description":"These characters, <, &, >, \", and ' must be substituted with the following character codes, respectively: &lt;, &amp;, &gt;, &quot;, and &apos;","Code":"---------------------------------------------------------------------------------------------------------------------------\r\n<  &lt;\r\n&  &amp;\r\n>  &gt;\r\n\"  &quot;\r\n'  &apos;\r\n\r\n---------------------------------------------------------------------------------------------------------------------------\r\nYou should avoid using other named HTML entities (see below). When in doubt, always use the numeric character reference for the character of interest. For example, for non-breaking spaces, use &#160; or &#xA0; instead of &nbsp;. For emphatic dashes, use &#8212; instead of &mdash;. Also, in Internet Explorer, the numeric character reference of &#151; is treated as the named entity of &mdash;, but will not be resolved to &#8212; in MSXML.\r\n\r\n---------------------------------------------------------------------------------------------------------------------------\r\nThe following HTML script block contains both an unparsable character (<) and JScript comments. The well-formed script block uses CDATA to encapsulate the script.\r\n\r\nHTML Well-formed HTML \r\n<SCRIPT>\r\n// checks a number against 7\r\nfunction less-than-seven(n) {\r\nreturn n < 7;\r\n}\r\n</SCRIPT> \r\n\r\nXML Well-formed XML\r\n\r\n<SCRIPT><![CDATA[\r\n// checks a number against 7\r\nfunction less-than-seven(n) {\r\nreturn n < 7;\r\n}\r\n]]></SCRIPT> \r\n\r\n---------------------------------------------------------------------------------------------------------------------------\r\nHTML Entities\r\n\r\nChar\tNamed\tHex\t\tUsing NCR\r\n\tEntity\t(NCR)\r\n\r\nC0 Controls and Basic Latin \r\n\"  \t&quot  \t&#34;\tquotation mark, =apl quote, U0022 ISOnum  \r\n&  \t&amp  \t&#38;\tampersand, U0026 ISOnum  \r\n<  \t&lt  \t&#60;\tless-than sign, U003C ISOnum  \r\n>  \t&gt  \t&#62;\tgreater-than sign, U003E ISOnum  \r\n\r\nLatin Extended-A \r\nS  \t&OElig \t&#338;\tLatin capital ligature oe, U0152 ISOlat2  \r\ns  \t&oelig \t&#339;\tLatin small ligature oe, U0153 ISOlat2  \r\n  \t&Scaro\t&#352;\tLatin capital letter s with caron, U0160 ISOlat2  \r\n  \t&scaro\t&#353;\tLatin small letter s with caron, U0161 ISOlat2  \r\nz  \t&Yuml\t&#376;\tLatin capital letter y with diaeresis, U0178 ISOlat2  \r\n\r\nSpacing Modifier Letters \r\n?  \t&circ\t&#710;\tmodifier letter circumflex accent, U02C6 ISOpub  \r\n?\t&tilde\t&#732;\tsmall tilde, U02DC ISOdia  \r\n\r\nGeneral Punctuation \r\n\t&ensp\t&#8194;\ten space, U2002 ISOpub  \r\n\t&emsp\t&#8195;\tem space, U2003 ISOpub  \r\n?  \t&thinsp\t&#8201;\tthin space, U2009 ISOpub  \r\n?\t&zwnj\t&#8204;\tzero width non-joiner, U200C NEW RFC 2070  \r\n?  \t&zwj\t&#8205;\tzero width joiner, U200D NEW RFC 2070  \r\n?\t&lrm\t&#8206;\tleft-to-right mark, U200E NEW RFC 2070  \r\n?  \t&rlm\t&#8207;\tright-to-left mark, U200F NEW RFC 2070  \r\n\t&ndash\t&#8211;\ten dash, U2013 ISOpub  \r\n \t&mdash\t&#151;\tem dash, U2014 ISOpub  \r\n  \t&lsquo\t&#8216;\tleft single quotation mark, U2018 ISOnum  \r\n\t&rsquo\t&#8217;\tright single quotation mark, U2019 ISOnum  \r\n  \t&sbquo\t&#8218;\tsingle low-9 quotation mark, U201A NEW  \r\n\t&ldquo\t&#8220;\tleft double quotation mark, U201C ISOnum  \r\n  \t&rdquo\t&#8221;\tright double quotation mark, U201D ISOnum  \r\n\t&bdquo\t&#8222;\tdouble low-9 quotation mark, U201E NEW  \r\n  \t&dagger\t&#8224;\tdagger, U2020 ISOpub  \r\n\t&Dagger\t&#8225;\tdouble dagger, U2021 ISOpub  \r\n  \t&permil\t&#8240;\tper mille sign, U2030 ISOtech  \r\n\t&lsaquo\t&#8249;\tsingle left-pointing angle quotation mark, U2039 ISO proposed  \r\n  \t&rsaquo\t&#8250;\tsingle right-pointing angle quotation mark, U203A ISO proposed\r\n\r\nNot all scripts will fail if they are not escaped in this way. However, it is highly recommended that you habitually escape them. This ensures not only that the script will work if it contains escaped characters or comments now, but that it will continue to work if these characters are added in the future.","Declares":"","CodeCategory":{"CategoryId":"8","CategoryDescription":"XML"},"Keywords":["Special Characters","Escaping XML","Named Entities"]},{"RecordId":"630","Title":"IE6 - Unlocking AutoComplete on Forms","Description":"Registry setting that locks down allowing users to enable AutoComplete on forms.","Code":"HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Internet Explorer\\Control Panel\r\n\r\nThere are two entries with a value of 1.  Change them to 0 (zero).\r\n\r\nThis may not persist beyond the next reboot or login.  I'm convinced that some things are being restricted at a system policy level.\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"2","CategoryDescription":"Web"},"Keywords":["AutoComplete"]},{"RecordId":"631","Title":"Using \"Run As\" on a Desktop Shortcut","Description":"Demonstrates how to run an application on your desktop under the context of a different user.","Code":"NOTE:  Requires that you be running a program, not a URL.\r\n\r\nMethod 1 (Prefered)\r\nFirst create a short cut on the desktop and point it to a program, IE for example, which is at \"C:\\Program Files\\Internet Explorer\\IEXPLORE.EXE\".   \r\nNow you can right click the short cut and select \"Run as...\"  \r\n\r\n\r\nMethod 2\r\nOr you can modify the target of the short cut by entering the \"run as\" command on the target line.  The syntax can be found from typing \"runas /?\" in a command window.  \r\nExample:  runas /user:YourDomain\\YourUserID \"C:\\Program Files\\Internet Explorer\\IEXPLORE.EXE\"  \r\nYou will be prompted for the password.\r\n","Declares":"","CodeCategory":{"CategoryId":"7","CategoryDescription":"Misc"},"Keywords":["Run As","RunAs"]},{"RecordId":"632","Title":"Random Number and Random String Generator","Description":"Stored procedure that generates a random number or a random string from SQL Server.","Code":"-- Part 1 - SPs creation\r\nIF EXISTS (SELECT * FROM sysobjects WHERE name = 'RandomString' and type = 'P')\r\nDROP PROC RandomString\r\nGO\r\nIF EXISTS (SELECT * FROM sysobjects WHERE name = 'RandomNumber' and type = 'P')\r\nDROP PROC RandomNumber\r\nGO\r\n\r\nCREATE PROCEDURE RandomString \r\n@Length int,\r\n@Result varchar(200) OUTPUT\r\nAS\r\nSET @Result = ''\r\nWHILE LEN(@Result) < @Length\r\nBEGIN\r\nSET @Result = @Result + CHAR(CAST(((122 - 97 + 1) * RAND() + 97) AS SmallInt))\r\nEND\r\nGO\r\n\r\nCREATE PROCEDURE RandomNumber \r\n@Lower int,\r\n@Upper int,\r\n@Result int OUTPUT\r\nAS\r\nSET @Result = CAST(((@Upper - @Lower + 1) * RAND() + @Lower) AS Int)\r\nGO\r\n\r\n--Part 2 - calling the SPs\r\n\r\nDECLARE \r\n@SomeRandomString varchar(50),\r\n@SomeRandomNumber int\r\n\r\nEXEC RandomString 30, @Result = @SomeRandomString OUTPUT \r\nEXEC RandomNumber 1, 25, @Result = @SomeRandomNumber OUTPUT\r\n\r\n-- For demonstration purposes only print them\r\nPRINT @SomeRandomString\r\nPRINT @SomeRandomNumber","Declares":"","CodeCategory":{"CategoryId":"6","CategoryDescription":"T-SQL"},"Keywords":["Random Number","Random String"]},{"RecordId":"633","Title":"Turn on NumLock at Logon (XP)","Description":"Registry entry for enabling NumLock at boot time for XP.","Code":"NumLock does not toggle on by default (system-wide), even if you have it set in your PC's BIOS, because of XP's multi-user functionality. Guess Microsoft doesn't know everyone actually turns it on, which should be reason enough for what acts as \"default\"... \r\n\r\nAnyway, you can hack the Windows Registry to change this behavior, or run a script at logon to turn NumLock on.\r\n\r\n1. To enable NumLock through the Registry:\r\n\r\n* Open Windows' Registry Editor (START > RUN, type \"REGEDIT\"). \r\n*. Navigate to HKEY_USERS\\.Default\\Control Panel\\Keyboard. \r\n*. Change the value for InitialKeyboardIndicators from 0 to 2. \r\n","Declares":"","CodeCategory":{"CategoryId":"7","CategoryDescription":"Misc"},"Keywords":["NumLock"]},{"RecordId":"634","Title":"Changing IE's Scroll Bar Appearance","Description":"Style sheet for changing IE's scroll bar appearance","Code":"body {\r\n  scrollbar-arrow-color: #000000;\r\n  scrollbar-face-color: #006699;\r\n  scrollbar-shadow-color: #000000;\r\n  scrollbar-highlight-color: #000000;\r\n  scrollbar-track-color: #000000;\r\n  font-family: arial;\r\n  font-size: 10pt;\r\n  color: #006699;\r\n}","Declares":"","CodeCategory":{"CategoryId":"13","CategoryDescription":"CSS"},"Keywords":["Scroll Bar"]},{"RecordId":"635","Title":"Animated Window Opener - Down Then Across - Way Cool","Description":"JavaScript that opens a new window that first expands down then across.  Really cool.","Code":"<SCRIPT language=JavaScript>\r\n<!-- Begin\r\n \r\n//Animated Window- By Rizwan Chand (rizwanchand@hotmail.com)\r\n//Modified by DD for NS compatibility\r\n//Visit http://www.dynamicdrive.com for this script\r\n \r\nfunction expandingWindow(website) {\r\n \r\n var windowprops='width=100,height=100,scrollbars=yes,status=yes,resizable=yes,'\r\n var heightspeed = 2; // vertical scrolling speed (higher = faster)\r\n var widthspeed = 7;  // horizontal scrolling speed (higher = faster)\r\n var leftdist = 125;    // distance to left edge of window\r\n var topdist = 75;     // distance to top edge of window\r\n \r\n if (window.resizeTo&&navigator.userAgent.indexOf(\"Opera\")==-1) {\r\n  var winwidth = window.screen.availWidth - leftdist;\r\n  var winheight = window.screen.availHeight - topdist;\r\n  var sizer = window.open(\"\",\"\",\"left=\" + leftdist + \",top=\" + topdist +\",\"+ windowprops);\r\n  for (sizeheight = 1; sizeheight < winheight; sizeheight += heightspeed)\r\n   sizer.resizeTo(\"1\", sizeheight);\r\n  for (sizewidth = 1; sizewidth < winwidth; sizewidth += widthspeed)\r\n   sizer.resizeTo(sizewidth, sizeheight);\r\n  sizer.location = website;\r\n } else \r\n  window.open(website,'mywindow');\r\n}\r\n \r\n//  End -->\r\n</SCRIPT>\r\n","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["Animated Window Opener","Window.Open"]},{"RecordId":"636","Title":"Disable Mouse Down - Right Click - on Web Page (IE and NS)","Description":"Captures right mouse click on web page to prevent \"View Source\"","Code":"<!--  NO RIGHT CLICK  -->\r\n<!--  Paste this code into the HEAD of your HTML document  -->\r\n<SCRIPT LANGUAGE=\"JavaScript1.1\">\r\n<!-- Original:  Martin Webb (martin@irt.org) -->\r\n \r\n<!-- This script and many more are available free online at -->\r\n<!-- The JavaScript Source!! http://javascript.internet.com -->\r\n \r\n<!-- Begin\r\nfunction right(e) {\r\nif (navigator.appName == 'Netscape' && \r\n(e.which == 3 || e.which == 2))\r\nreturn false;\r\nelse if (navigator.appName == 'Microsoft Internet Explorer' && \r\n(event.button == 2 || event.button == 3)) {\r\nalert(\"Please sign my Guestbook!\");\r\nreturn false;\r\n}\r\nreturn true;\r\n}\r\n \r\ndocument.onmousedown=right;\r\ndocument.onmouseup=right;\r\nif (document.layers) window.captureEvents(Event.MOUSEDOWN);\r\nif (document.layers) window.captureEvents(Event.MOUSEUP);\r\nwindow.onmousedown=right;\r\nwindow.onmouseup=right;\r\n//  End -->\r\n</script>\r\n<!--  END NO RIGHT CLICK  -->","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["Capture Mouse Down","Right Click"]},{"RecordId":"637","Title":"Capture Mouse Down - No Text Selection - on Web Page","Description":"Captures mouse down to prevent selecting text on a web page","Code":"<!--  NO TEXT SELECTION  -->\r\n<!-- DISABLE SELECT-TEXT -->\r\n<!--  Paste this code into the HEAD of your HTML document  -->\r\n<script language=\"JavaScript1.2\">\r\n//Disable select-text script (IE4+, NS6+)- By Andy Scott\r\n//Exclusive permission granted to Dynamic Drive to feature script\r\n//Visit http://www.dynamicdrive.com for this script\r\nfunction disableselect(e){\r\nreturn false\r\n}\r\nfunction reEnable(){\r\nreturn true\r\n}\r\n//if IE4+\r\ndocument.onselectstart=new Function (\"return false\")\r\n//if NS6\r\nif (window.sidebar){\r\ndocument.onmousedown=disableselect\r\ndocument.onclick=reEnable\r\n}\r\n</script>\r\n<!--  END NO TEXT SELECTION -->\r\n","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["Capture Mouse Down","Select Text","Disable Text Selection"]},{"RecordId":"638","Title":"Scrolling Marquee - DHTML - Simple & Elegant","Description":"Uses <Marquee> HTML tag to create a simple and elegant scrolling marquee.","Code":"<html>\r\n<body>\r\n\r\n\t<marquee \r\n\t\tdirection=\"up\" \r\n\t\tscrollamount=\"2\" \r\n\t\tbehavior=\"scroll\" \r\n\t\theight=\"200\" \r\n\t\twidth=\"400\" \r\n\t\tbgcolor=\"#FFFF99\"\r\n\t\t>\r\n\tLine 1...\r\n\t<br><br>\r\n\tLine 2...\r\n\t<br><br>\r\n\t<a href='http://www.thegamblefamily.net'>TheGambleFamily.net</a>\r\n\t<br><br>\r\n\tLine 3...\r\n\t</marquee>\r\n</body>\r\n</html>\r\n","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["Scroll","Marquee"]},{"RecordId":"639","Title":"Transform XML With XSL in ASP","Description":"Uses Transform Node to transform xml with xsl stylesheet","Code":"dim xmlDoc\r\ndim xslDoc\r\ndim xmlParseError\r\ndim xslParseError\r\n\r\non errror resume next    \r\n\r\nSet xmlDoc = Server.CreateObject(\"Msxml2.DOMDocument.3.0\")\r\nIf Err.Number <> 0 Then\r\n\tSet xmlDoc = server.CreateObject(\"MSXML2.DOMDocument\")\r\n\tIf Err.Number <> 0 Then\r\n\t\tSet xmlDoc = Server.CreateObject(\"Microsoft.XMLDOM\")\r\n\tEnd If\r\nEnd If\r\n\r\n\r\nSet xslDoc = Server.CreateObject(\"Msxml2.FreeThreadedDOMDocument.3.0\")\r\nIf Err.Number <> 0 Then\r\n\tset xslDoc = server.CreateObject(\"MSXML2.DOMDocument\")\r\nend if\r\n\r\non error goto 0\r\n\r\nxmlDoc.async = false\r\nxslDoc.async = false\r\n\r\nxmlDoc.load(server.MapPath(\"File1.xml\"))\r\nxslDoc.load(server.MapPath(\"File2.xsl\"))\r\n\r\nxmlParseError = xmlDoc.parseError.reason\r\nxslParseError = xslDoc.parseError.reason\r\n\r\nif xmlParseError <> \"\" or xslParseError <> \"\" then\r\n\tResponse.Write \"XML PARSE ERROR: \" + xmlParseError + \"<br>XSL PARSE ERROR: \" + xslParseError\r\nelse\r\n\tResponse.Write xmlDoc.transformNode(xslDoc)\r\nend if","Declares":"","CodeCategory":{"CategoryId":"8","CategoryDescription":"XML"},"Keywords":["Transform Node"]},{"RecordId":"640","Title":"Web Page With Automatic Download OnLoad","Description":"Demonstrates how to fire off a file download when page loads.","Code":"<html>\r\n<head>\r\n<script language=\"JavaScript\">\r\nfunction startDownload()\r\n{\r\n      window.location = 'locker/compact071-4.zip';\r\n}\r\n</script>\r\n</head>\r\n<body onLoad=\"startDownload()\">\r\n\r\nYou are being redirected to the download site . . .<br><br>\r\nIf your download doesn't start automatically, please <a href=\"locker/compact071-4.zip\">click here</a>.<br><br><br><center>\r\n</body>\r\n</html>\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"9","CategoryDescription":"HTML"},"Keywords":["File Download","Download"]},{"RecordId":"641","Title":"Get AD User Information","Description":"Retrieves user account information from Active Directory","Code":"<%\r\n\r\nfunction GetADFieldValue(oFldIn)\r\n\tif isarray(oFldIn) then\r\n\t\tGetADFieldValue = oFldIn(0)\r\n\telse\r\n\t\tGetADFieldValue = oFldIn\r\n\tend if\r\nend function\r\n\r\n\r\ndim g_strFirstName\r\ndim g_strLastName\r\ndim g_strOfficeName\r\ndim g_strEmail\r\ndim g_strPhone\r\n\r\ng_strFirstName = \"FirstName\"\r\ng_strLastName = \"LastName\"\r\ng_strOfficeName = \"OfficeName\"\r\ng_strEmail = \"anybody@someplace.com\"\r\ng_strPhone = \"111-222-3333 ext. 4444\"\r\n\r\n'This code must run on an authenticated site \r\n'Can remove the command portion of this and just do rec.open if desired & you know you will have small recordsets (< 1000) because there is a 1000 record barier if not using the command object\r\n\r\ndim objADConn\r\ndim cmdAD\r\ndim rsAD\r\ndim strLDAP_FILTER\r\ndim strUserID\r\ndim intOffset\r\ndim strFIELD_LIST\r\ndim strLDAP\r\ndim strADQuery\r\ndim strDomain\r\nconst adUseClient = 3\r\nConst adOpenStatic = 3\r\nConst adLockReadOnly = 1\r\nConst adCmdText = &H0001\r\n\r\nSet objADConn = Server.CreateObject(\"ADODB.Connection\")\r\nSet cmdAD = Server.CreateObject(\"ADODB.Command\")\r\nSet rsAD = Server.CreateObject(\"ADODB.RecordSet\")\r\n\r\nobjADConn.Provider = \"ADsDSOObject\"\r\nobjADConn.Properties(\"Encrypt Password\") = True\r\nobjADConn.Open \"Active Directory Provider\", \"\", \"\"\r\nstrUserID = Request.ServerVariables(\"Logon_User\")\r\n\r\nstrUserID = replace(strUserID,\"/\", \"\\\")\r\nintOffset = instr(1,strUserID, \"\\\") \r\nif intOffset <> 0 then\r\n\tstrDomain = left(strUserID,intOffset -1)\r\n\tstrUserID = right(strUserID,len(strUserID)-intOffset)\r\nend if\r\n\r\nstrLDAP_FILTER = \"(&(objectCategory=person)(samAccountName=\" & strUserID & \")(objectClass=user))\"\r\n\r\n'cn = last, first (domain - office)\r\n'givenName = first name\r\n'sn = last/surname\r\n'l = office location\r\n'physicalDeliveryOfficeName = alternate way of finding office name\r\n'mail = user@domain.com\r\n\r\nstrFIELD_LIST = \"cn,givenName,sn,mail,l,physicalDeliveryOfficeName,TelephoneNumber,info,Title\"\r\n\r\nstrLDAP  = \"LDAP://\" & strDomain\r\nstrADQuery = \"<\" & strLDAP & \">;\" & strLDAP_FILTER & \";\" & strFIELD_LIST & \";subTree\"\r\nrsAD.CursorType = adUseClient\r\nrsAD.CursorType = adOpenStatic\r\nrsAD.LockType = adLockReadOnly\r\n\r\ncmdAD.ActiveConnection = objADConn\r\n\r\ncmdAD.Properties(\"Page Size\") = 1000\r\ncmdAD.Properties(\"Asynchronous\") = True\r\ncmdAD.CommandText = strADQuery\r\ncmdAD.CommandType = adCmdText\r\n\r\nset rsAD = cmdAD.execute\r\n\r\ndim oFld\r\noFld = rsAD.fields(\"givenName\")\r\ng_strFirstName = GetADFieldValue(oFld)\r\n\r\noFld = rsAD.fields(\"sn\")\r\ng_strLastName = GetADFieldValue(oFld)\r\n\r\noFld = rsAD.fields(\"l\")\r\ng_strOfficeName = GetADFieldValue(oFld)\r\n\r\noFld = rsAD.fields(\"mail\")\r\ng_strEmail = GetADFieldValue(oFld)\r\n\r\noFld = rsAD.fields(\"TelephoneNumber\")\r\ng_strPhone = GetADFieldValue(oFld)\r\n'g_strPhone = \"\"\r\n\r\nrsAD.Close\r\nobjADConn.Close\r\nSet cmdAD = Nothing\r\nSet rsAD = Nothing\r\nSet objADConn = Nothing\r\n\t\r\n%>\r\n","Declares":"","CodeCategory":{"CategoryId":"5","CategoryDescription":"ASP"},"Keywords":["Active Directory","AD","User Information"]},{"RecordId":"643","Title":"Create Safe Filename","Description":"Function that replaces invalid filename characters with \"_\"","Code":"Function CreateSafeFileName(strFilename)\r\n\r\n\tDim strTmp\r\n\t\r\n\tstrTmp = Replace(strFilename, \"\\\", \"_\")\r\n\tstrTmp = Replace(strTmp, \"/\", \"_\")\r\n\tstrTmp = Replace(strTmp, \":\", \"_\")\r\n\tstrTmp = Replace(strTmp, \"*\", \"_\")\r\n\tstrTmp = Replace(strTmp, \"?\", \"_\")\r\n\tstrTmp = Replace(strTmp, \"\"\"\", \"_\")\r\n\tstrTmp = Replace(strTmp, \"<\", \"_\")\r\n\tstrTmp = Replace(strTmp, \">\", \"_\")\r\n\tstrTmp = Replace(strTmp, \"|\", \"_\")\r\n\tstrTmp = Replace(strTmp, \"%\", \"_\")\r\n\tstrTmp = Replace(strTmp, \"#\", \"_\")\r\n\tstrTmp = Replace(strTmp, \";\", \"_\")\r\n\tstrTmp = Replace(strTmp, \"@\", \"_\")\r\n\tstrTmp = Replace(strTmp, \"&\", \"_\")\r\n\tstrTmp = Replace(strTmp, \"=\", \"_\")\r\n\tstrTmp = Replace(strTmp, \"~\", \"_\")\r\n\r\n\tCreateSafeFileName = strTmp\r\n\t\r\nEnd Function\r\n","Declares":"","CodeCategory":{"CategoryId":"7","CategoryDescription":"Misc"},"Keywords":["CreateSafeFileName"]},{"RecordId":"644","Title":"Input Mask for Input Fields","Description":"Similar to input mask fields in VB, this Javascript allows you to easily implement input masking on web pages.","Code":"This code consists of two parts.\r\n\r\n-----------------------------------------------------------------------------------------------\r\nPart 1 - Usage instructions\r\n-----------------------------------------------------------------------------------------------\r\n<!-- TWO STEPS TO INSTALL DFILTER:\r\n\r\n  1.  Copy the coding into the HEAD of your HTML document\r\n  2.  Add the last code into the BODY of your HTML document  -->\r\n\r\n<!-- STEP ONE: Paste this code into the HEAD of your HTML document  -->\r\n\r\n<HEAD>\r\n<script type='text/javascript' src='dFilter.js'></script> \r\n</script>\r\n\r\n</HEAD>\r\n\r\n<!-- STEP TWO: Copy this code into the BODY of your HTML document  -->\r\n\r\n<BODY>\r\n\r\n<form name=\"fred\" action=\"fred.htm\" method=\"post\">\r\n<table>\r\n\t<tr>\r\n\t\t<td>SSN:</td>\r\n\t\t<td><input value=\"\" type=\"text\" onKeyDown=\"javascript:return dFilter (event.keyCode, this, '###-##-####');\"></td>\r\n\t</tr>\r\n    <tr>\r\n        <td>Phone:</td>\r\n\t\t<td><input value=\"\" type=\"text\" onKeyDown=\"javascript:return dFilter (event.keyCode, this, '(###) ###-####');\"></td>\r\n\t</tr>\r\n\t<tr>\r\n        <td>Zip:</td>\r\n\t\t<td><input value=\"\" type=\"text\" onKeyDown=\"javascript:return dFilter (event.keyCode, this, '#####-####');\"></td>\r\n\t</tr>\r\n</table>\r\n</form>\r\n\r\n</body>\r\n</html>\r\n\r\n-----------------------------------------------------------------------------------------------\r\nPart 2 - dFilter.js\r\n-----------------------------------------------------------------------------------------------\r\n\r\n// [dFilter] - A Numerical Input Mask for JavaScript\r\n// Written By Dwayne Forehand - March 27th, 2003\r\n// Please reuse & redistribute while keeping this notice.\r\n\r\nvar dFilterStep\r\n\r\nfunction dFilterStrip (dFilterTemp, dFilterMask)\r\n{\r\n    dFilterMask = replace(dFilterMask,'#','');\r\n    for (dFilterStep = 0; dFilterStep < dFilterMask.length++; dFilterStep++)\r\n\t\t{\r\n\t\t    dFilterTemp = replace(dFilterTemp,dFilterMask.substring(dFilterStep,dFilterStep+1),'');\r\n\t\t}\r\n\t\treturn dFilterTemp;\r\n}\r\n\r\nfunction dFilterMax (dFilterMask)\r\n{\r\n \t\tdFilterTemp = dFilterMask;\r\n    for (dFilterStep = 0; dFilterStep < (dFilterMask.length+1); dFilterStep++)\r\n\t\t{\r\n\t\t \t\tif (dFilterMask.charAt(dFilterStep)!='#')\r\n\t\t\t\t{\r\n\t\t        dFilterTemp = replace(dFilterTemp,dFilterMask.charAt(dFilterStep),'');\r\n\t\t\t\t}\r\n\t\t}\r\n\t\treturn dFilterTemp.length;\r\n}\r\n\r\nfunction dFilter (key, textbox, dFilterMask)\r\n{\r\n\t\tdFilterNum = dFilterStrip(textbox.value, dFilterMask);\r\n\t\t\r\n\t\tif (key==9)\r\n\t\t{\r\n\t\t    return true;\r\n\t\t}\r\n\t\telse if (key==8&&dFilterNum.length!=0)\r\n\t\t{\r\n\t\t \t \tdFilterNum = dFilterNum.substring(0,dFilterNum.length-1);\r\n\t\t}\r\n \t  else if ( ((key>47&&key<58)||(key>95&&key<106)) && dFilterNum.length<dFilterMax(dFilterMask) )\r\n\t\t{\r\n        dFilterNum=dFilterNum+String.fromCharCode(key);\r\n\t\t}\r\n\r\n\t\tvar dFilterFinal='';\r\n    for (dFilterStep = 0; dFilterStep < dFilterMask.length; dFilterStep++)\r\n\t\t{\r\n        if (dFilterMask.charAt(dFilterStep)=='#')\r\n\t\t\t\t{\r\n\t\t\t\t\t  if (dFilterNum.length!=0)\r\n\t\t\t\t\t  {\r\n\t\t\t\t        dFilterFinal = dFilterFinal + dFilterNum.charAt(0);\r\n\t\t\t\t\t      dFilterNum = dFilterNum.substring(1,dFilterNum.length);\r\n\t\t\t\t\t  }\r\n\t\t\t\t    else\r\n\t\t\t\t    {\r\n\t\t\t\t        dFilterFinal = dFilterFinal + \"\";\r\n\t\t\t\t    }\r\n\t\t\t\t}\r\n\t\t \t\telse if (dFilterMask.charAt(dFilterStep)!='#')\r\n\t\t\t\t{\r\n\t\t\t\t    dFilterFinal = dFilterFinal + dFilterMask.charAt(dFilterStep); \t\t\t\r\n\t\t\t\t}\r\n//\t\t    dFilterTemp = replace(dFilterTemp,dFilterMask.substring(dFilterStep,dFilterStep+1),'');\r\n\t\t}\r\n\r\n\r\n\t\ttextbox.value = dFilterFinal;\r\n    return false;\r\n}\r\n\r\nfunction replace(fullString,text,by) {\r\n// Replaces text with by in string\r\n    var strLength = fullString.length, txtLength = text.length;\r\n    if ((strLength == 0) || (txtLength == 0)) return fullString;\r\n\r\n    var i = fullString.indexOf(text);\r\n    if ((!i) && (text != fullString.substring(0,txtLength))) return fullString;\r\n    if (i == -1) return fullString;\r\n\r\n    var newstr = fullString.substring(0,i) + by;\r\n\r\n    if (i+txtLength < strLength)\r\n        newstr += replace(fullString.substring(i+txtLength,strLength),text,by);\r\n\r\n    return newstr;\r\n}","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["Input Mask","Numeric Mask"]},{"RecordId":"645","Title":"ADO.Net","Description":"Using C# to call stored procedures (with and without parameters)","Code":"--------------------------------------------------------------------------------------------------------------------------\r\nUsing the Command Object to Execute a Stored Procedure (1 of 2)\r\n--------------------------------------------------------------------------------------------------------------------------\r\nIn order to access the stored procedure from a .NET client application, you use the System.Data.SqlClient namespace. This namespace contains the objects used to interact with SQL Server 7.0 and above. A SqlConnection object is used to establish a connection into the database. Once the connection is established a SqlCommand object is used to execute SQL statements or Stored Procedures. The SqlCommand object contains four different methods for executing statements against the database. The ExecuteReader method is used to execute commands that return records. The ExecuteNonQuery is used to execute commands that do not return records such as update and insert statements. The ExecuteScalar method is used to execute a command that returns a single value rather than a result set. The ExecuteXmlReader is used to execute a command that returns the results in an XML formatted string.\r\n\r\nThe CommandType property of the SqlCommand object is used to indicate what type of command is being executed. The CommandType property is set to one of three possible CommandType enumeration values. The default Text value is used when a SQL string is passed in for execution. The StoredProcedure value is used when the name of a stored procedure is passed in to execute. The TableDirect value is used when a table name is being passed in. This setting will pass back all the records in the table. The CommandText property of the SqlCommand object is used in conjunction with the CommandType property. The CommandText property will contain a SQL string, stored procedure name, or table name depending on the setting of the CommandType property.\r\n\r\nIn order to demonstrate the process of executing a stored procedure from a C# client, create a new console application project in Visual Studio named SPClient. Add a class to the project and rename it Authors. Add using statements above the namespace declaration to enable the use of non-fully qualified references to other namespace types.\r\n\r\nusing System;\r\nusing System.Data.SqlClient;\r\nusing System.Collections;\r\nusing System.Data;\r\n\r\nCreate a method procedure called GetNames in the class that takes no input parameters and returns an ArrayList to the caller. \r\n\r\nnamespace SPDemo\r\n{\r\n            public class Authors\r\n            {\r\n                            public Authors()\r\n                            {\r\n                            }\r\n                            public ArrayList getNames()\r\n                            {                           \r\n\r\n                            }\r\n            }\r\n}\r\n\r\nIn the body of the method, create an instance of the SqlConnection class and pass in connection information with the instantiation of the SqlConnection object.\r\n\r\nSqlConnection cnPubs = new SqlConnection\r\n                            (\"server=localhost;integrated security=true;\" + \"database=pubs\");\r\n\r\nNote: This assumes you have a local instance of SQL Server and are logged on with a trusted connection.\r\n\r\nNext, create a SqlCommand object and set the appropriate properties needed to execute the up_AuthorNames stored procedure created earlier.\r\n\r\nSqlCommand cmdAuthors = new SqlCommand(\"up_AuthorNames\", cnPubs);\r\ncmdAuthors.CommandType = CommandType.StoredProcedure;\r\n\r\nThe next step is to use the SqlCommand object to create an instance of the SqlDataReader class. The SqlDataReader class is used to read a forward only stream of records returned from the database. The SqlDataReader object is not instantiated directly through a constructor (hence the lack of the New key word) but rather through the ExecuteReader method of the SqlCommand object. Before calling the ExecuteReader method the connection to the database is established using the Open method of the SqlConnection object.\r\n\r\nSqlDataReader drAuthors;\r\ncnPubs.Open();\r\ndrAuthors = cmdAuthors.ExecuteReader();\r\n\r\nNow that the stored procedure has been executed, the Read method of the SqlDataReader object is used to read the records and pass them into an ArrayList that will be returned to the caller. The Read method returns a value of False when it reaches the end of the records. Before exiting the method, the close methods of the SqlDataReader and the SqlConnection objects are called.\r\n\r\nArrayList alNames = new ArrayList();\r\nwhile (drAuthors.Read())\r\n{\r\nalNames.Add(drAuthors.GetValue(0));\r\n}\r\ndrAuthors.Close();\r\ncnPubs.Close();\r\nreturn alNames;\r\n\r\nTo test the method, place the following code in the Main procedure of Class1. This code instantiates an instance of the Authors class and calls the GetNames method. The list of names returned is then written out to the console. The ReadLine method of the Console class pauses execution until a keystroke is entered in the console screen.\r\n\r\nstatic void Main (string[] args)\r\n{\r\n            Authors objAuthors = new Authors();\r\n            System.Collections.ArrayList alNames = objAuthors.getNames();\r\n                                           \r\n      foreach (String item in alNames)\r\n            {\r\n                            Console.WriteLine(item);\r\n            }            Console.ReadLine();\r\n}\r\n\r\n\r\n\r\n--------------------------------------------------------------------------------------------------------------------------\r\nCreating a Stored Procedure with Parameters (2 of 2)\r\n--------------------------------------------------------------------------------------------------------------------------\r\nNow that you know how to create a basic stored procedure and call it from a C# client, lets take a look at creating a more advanced stored procedure that includes parameters. Navigate to and expand the Pubs database node in the Server Explorer window of Visual Studio. Right click on the stored procedure node and select Create a New Stored Procedure from the popup menu. Change the name of the stored procedure to up_AuthorBookCount and add the following code to the body of the stored procedure.\r\n\r\nCREATE PROCEDURE dbo.up_AuthorBookCount   \r\n\r\n            (\r\n                            @au_id varchar(11),\r\n                            @Count int OUTPUT\r\n            )   \r\n\r\nAS\r\n            SET NOCOUNT ON\r\n            Select @Count = count(title_id) from titleauthor\r\n            where au_id = @au_id           \r\n\r\n            RETURN \r\n\r\nUsing the Parameters Collection to Pass Parameters To and From Stored Procedures\r\nCalling a stored procedure that contains parameters from a C# client is very similar to the previous process of executing stored procedure without parameters. A SqlConnection object is used to establish a connection to the database and a SqlCommand object is used to execute the stored procedure. The difference when calling a parameterized stored procedure is the use of the Parameters collection of the SqlCommand object. When the parameter is added to the collection, the appropriate properties such as ParameterName, DbType, Size, and Value are set.\r\n\r\nIn order to demonstrate the process of executing a parameterized stored procedure from a C# client, open the previous console application project in Visual Studio. Create a method in the Authors class called GetBookCount that takes an input parameter of type string and returns an integer type to the caller.\r\n\r\npublic int getBookCount(string AuthorID )\r\n{\r\n            return 0;\r\n}\r\n\r\nIn the body of the method, create an instance of the SqlConnection class and pass in connection information with the instantiation of the SqlConnection object.\r\n\r\nSqlConnection cnPubs = new SqlConnection\r\n                            (\"server=localhost;integrated security=true;\" + \"database=pubs\");\r\n\r\nNext, create a SqlCommand object and set the appropriate properties needed to execute the up_AuthorBookCount stored procedure created earlier.\r\n\r\nSqlCommand cmdAuthors = new SqlCommand(\"up_AuthorBookCount\", cnPubs);\r\ncmdAuthors.CommandType = CommandType.StoredProcedure;\r\n\r\nUsing the Add method of the SqlCommands Parameter collection add an input parameter that takes the AuthorId value passed in by the caller. Also add an output parameter that will store the value passed back by the stored procedure. The names and data types of the parameters must mach those defined in the stored procedure.\r\n\r\ncmdAuthors.Parameters.Add(\"@au_id\", SqlDbType.NVarChar, 11);\r\ncmdAuthors.Parameters[\"@au_id\"].Value = AuthorID;\r\ncmdAuthors.Parameters.Add(\"@Count\", SqlDbType.Int);\r\ncmdAuthors.Parameters[\"@Count\"].Direction = ParameterDirection.Output;\r\n\r\nOpen the connection to the database and call the ExecuteNonQuerry method of the command object. Once the stored procedure is executed, the value of the output parameter is held in a local variable, which is in turn passed back to the client. Dont forget to close the connection after executing the stored procedure.\r\n\r\ncnPubs.Open();\r\nint iCount;\r\ncmdAuthors.ExecuteNonQuery();\r\niCount = (int)cmdAuthors.Parameters[\"@Count\"].Value;\r\ncnPubs.Close();\r\nreturn iCount;\r\n\r\nTo test the method, comment out the previous code in the Main procedure of Class1. Add the following code to the Main procedure. This code instantiates an instance of the Authors class and calls the GetBookCount method. The book count returned is then written out to the console. The final ReadLine method call of the Console class is used to pause execution until a keystroke is entered in the console screen.\r\n\r\nAuthors objAuthors = new Authors();\r\nConsole.WriteLine(\"Enter an author id.\");\r\nstring authorID = Console.ReadLine();\r\nConsole.WriteLine(objAuthors.getBookCount(authorID));\r\nConsole.ReadLine();\r\n","Declares":"","CodeCategory":{"CategoryId":"21","CategoryDescription":".Net - ADO.Net"},"Keywords":["Stored Procedures"]},{"RecordId":"646","Title":"Encryption/Decryption Using C#","Description":"Used TripleDES encryption/decryption.  Two samples - One encrypts/decrypts a file and the other encrypts/decrypts a string.","Code":"using System;\r\nusing System.IO;\r\nusing System.Security.Cryptography;\r\nusing System.Text;\r\nnamespace Encryption\r\n{\r\n\t/// <summary>\r\n\t/// Summary description for DESClass.\r\n\t/// </summary>\r\n\tpublic class DESClass\r\n\t{\r\n\r\n\t\tpublic DESClass() {\t}\r\n\r\n\t\tpublic void DecryptData(String inName, String outName, byte[] tdesKey, byte[] tdesIV) {    \r\n\t\t\r\n\t\t\t//Create the file streams to handle the input and output files.\r\n\t\t\tFileStream fin = new FileStream(inName, FileMode.Open, FileAccess.Read);\r\n\t\t\tFileStream fout = new FileStream(outName, FileMode.OpenOrCreate, FileAccess.Write);\r\n\t\t\tfout.SetLength(0);\r\n      \r\n\t\t\t//Create variables to help with read and write.\r\n\t\t\tbyte[] bin = new byte[100]; //This is intermediate storage for the encryption.\r\n\t\t\tlong rdlen = 0;              //This is the total number of bytes written.\r\n\t\t\tlong totlen = fin.Length;    //This is the total length of the input file.\r\n\t\t\tint len;                     //This is the number of bytes to be written at a time.\r\n\r\n\t\t\tTripleDESCryptoServiceProvider tdes = new TripleDESCryptoServiceProvider();       \r\n\t\t\tCryptoStream decStream = new CryptoStream(fout, tdes.CreateDecryptor(tdesKey, tdesIV),CryptoStreamMode.Write);\r\n               \r\n\t\t\tConsole.WriteLine(\"Decrypting...\");\r\n\r\n\t\t\t//Read from the input file, then encrypt and write to the output file.\r\n\t\t\twhile(rdlen < totlen) {\r\n\t\t\t\tlen = fin.Read(bin, 0, 100);\r\n\t\t\t\tdecStream.Write(bin, 0, len);\r\n\t\t\t\trdlen = rdlen + len;\r\n\t\t\t\tConsole.WriteLine(\"{0} bytes processed\", rdlen);\r\n\t\t\t}\r\n\r\n\t\t\tdecStream.Close();                     \r\n\t\t}\r\n\r\n\t\tpublic void EncryptData(String inName, String outName, byte[] tdesKey, byte[] tdesIV) {    \r\n\t\t\r\n\t\t\t//Create the file streams to handle the input and output files.\r\n\t\t\tFileStream fin = new FileStream(inName, FileMode.Open, FileAccess.Read);\r\n\t\t\tFileStream fout = new FileStream(outName, FileMode.OpenOrCreate, FileAccess.Write);\r\n\t\t\tfout.SetLength(0);\r\n      \r\n\t\t\t//Create variables to help with read and write.\r\n\t\t\tbyte[] bin = new byte[100]; //This is intermediate storage for the encryption.\r\n\t\t\tlong rdlen = 0;              //This is the total number of bytes written.\r\n\t\t\tlong totlen = fin.Length;    //This is the total length of the input file.\r\n\t\t\tint len;                     //This is the number of bytes to be written at a time.\r\n\r\n\t\t\tTripleDESCryptoServiceProvider tdes = new TripleDESCryptoServiceProvider();          \r\n\t\t\tCryptoStream encStream = new CryptoStream(fout, tdes.CreateEncryptor(tdesKey, tdesIV), CryptoStreamMode.Write);\r\n\r\n\t\t\tConsole.WriteLine(\"Encrypting...\");\r\n\r\n\t\t\t//Read from the input file, then encrypt and write to the output file.\r\n\t\t\twhile(rdlen < totlen) {\r\n\t\t\t\tlen = fin.Read(bin, 0, 100);\r\n\t\t\t\tencStream.Write(bin, 0, len);\r\n\t\t\t\trdlen = rdlen + len;\r\n\t\t\t\tConsole.WriteLine(\"{0} bytes processed\", rdlen);\r\n\t\t\t}\r\n\r\n\t\t\tencStream.Close();                     \r\n\t\t}\r\n\r\n\t\tpublic string EncryptDataToSting(string plaintext, byte[] tdesKey, byte[] tdesIV) {    \r\n\t\t\r\n\t\t\t//Create a memory stream to which CryptoStream will write the cipher text\r\n\t\t\tMemoryStream ciphertextmem = new MemoryStream();\r\n\r\n\t\t\t//Create a CryptoStream in Write Mode; initialise with the TripleDES Encryptor ICryptoTransform\r\n\t\t\tTripleDESCryptoServiceProvider tdes = new TripleDESCryptoServiceProvider();          \r\n\t\t\tCryptoStream crystm = new CryptoStream(ciphertextmem, tdes.CreateEncryptor(tdesKey, tdesIV), CryptoStreamMode.Write);\r\n\r\n\t\t\t//Encode the passed plain text string into Unicode byte stream\r\n\t\t\tByte[] plaintextbyte = new UnicodeEncoding().GetBytes(plaintext);\r\n\r\n\t\t\t//Write the plaintext byte stream to CryptoStream\r\n\t\t\tcrystm.Write(plaintextbyte,0,plaintextbyte.Length);\r\n\r\n\t\t\t//don't forget to close the stream\r\n\t\t\tcrystm.Close();\r\n\r\n\t\t\t//Extract the ciphertext byte stream and close the MemoryStream\r\n\t\t\tByte[] ciphertextbyte = ciphertextmem.ToArray();\r\n\t\t\tciphertextmem.Close();\r\n\r\n\t\t\t//Encode the ciphertext byte into Unicode string\r\n\t\t\treturn (new UnicodeEncoding().GetString(ciphertextbyte));\r\n\t\t}\r\n\r\n\t\tpublic string DecryptToString(string ciphertext, byte[] tdesKey, byte[] tdesIV) {    \r\n\r\n\t\t\t//Create a memory stream from which CryptoStream will read the cipher text\r\n\t\t\tMemoryStream ciphertextmem = new MemoryStream(new UnicodeEncoding().GetBytes(ciphertext));\r\n\r\n\t\t\t//Create a CryptoStream in Read Mode; initialise with the TripleDES Decryptor ICryptoTransform\r\n\t\t\tTripleDESCryptoServiceProvider tdes = new TripleDESCryptoServiceProvider();       \r\n\t\t\tCryptoStream crystm = new CryptoStream(ciphertextmem, tdes.CreateDecryptor(tdesKey, tdesIV),CryptoStreamMode.Read);\r\n\r\n\t\t\t//Create a temporary memory stream to which we will copy the plaintext byte array from CryptoStream\r\n\t\t\tMemoryStream plaintextmem = new MemoryStream();\r\n\r\n\t\t\tdo {\r\n\t\t\t\t//Create a byte array into which we will read the plaintext from CryptoStream\r\n\t\t\t\tByte[] buf = new Byte[100];\r\n\r\n\t\t\t\t//read the plaintext from CryptoStream\r\n\t\t\t\tint actualbytesread = crystm.Read(buf,0,100);\r\n\r\n\t\t\t\t//if we have reached the end of stream quit the loop\r\n\t\t\t\tif (0 == actualbytesread)\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t//copy the plaintext byte array to MemoryStream\r\n\t\t\t\tplaintextmem.Write(buf,0,actualbytesread);\r\n\t\r\n\t\t\t}while(true);\r\n\r\n\t\t\t//don't forget to close the streams\r\n\t\t\tcrystm.Close();\r\n\t\t\tciphertextmem.Close();\r\n\r\n\t\t\t//Extract the plaintext byte stream and close the MemoryStream\r\n\t\t\tByte[] plaintextbyte = plaintextmem.ToArray();\r\n\t\t\tplaintextmem.Close();\r\n\r\n\t\t\t//Encode the plaintext byte into Unicode string\r\n\t\t\treturn(new UnicodeEncoding().GetString(plaintextbyte));\r\n\t\t}\r\n\r\n\t\r\n\t}\r\n\r\n\tpublic class Foo{\r\n\r\n\t\tstatic void Main(string[] args) {\r\n\r\n\t\t\tbyte[] key =  {1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24};\r\n\t\t\tbyte[] iv = {65, 110, 68, 26, 69, 178, 200, 219};\r\n\r\n\t\t\tDESClass oDES = new DESClass();\r\n\t\t\toDES.EncryptData(@\"c:\\a\\testIn.txt\",@\"c:\\a\\testOutEncrypted.txt\", key, iv);\r\n\t\t\toDES.DecryptData(@\"c:\\a\\testOutEncrypted.txt\",@\"c:\\a\\testOutDecrypted.txt\", key, iv);\r\n\r\n\t\t\tstring strTemp = oDES.EncryptDataToSting(\"This text will be encrypted\", key, iv);\r\n\t\t\tSystem.Console.Write(strTemp);\r\n\r\n\t\t\tstrTemp = oDES.DecryptToString(strTemp, key, iv);\r\n\t\t\tSystem.Console.Write(strTemp);\r\n\r\n\t\t\toDES = null;\r\n\r\n\t\t}\t\t\t\r\n\t}\r\n}\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Encryption","DES"]},{"RecordId":"647","Title":"ADSI Programming Sample","Description":"Demonstrates how to query Active Directory for a particular user, lists groups, isMember, etc.","Code":"using System;\r\nusing System.DirectoryServices;\r\nusing System.Security.Principal;\r\n\r\nnamespace ConsoleApplication1\r\n{\r\n\tclass Class1\r\n\t{\r\n\r\n\t\tstatic void getGroups(string strGroupIn){\r\n\r\n\t\t\tDirectoryEntry oDERoot = new DirectoryEntry(@\"GC://DC=somedomain,DC=com\");\t\t\t\r\n\t\t\tDirectorySearcher oDirSrch = new DirectorySearcher(oDERoot);\r\n\t\t\toDirSrch.Filter = strGroupIn;\r\n\r\n\t\t\tSearchResultCollection OSrchResults = oDirSrch.FindAll();\r\n\t\t\tstring strGroupList = \"\";\r\n\t\t\tforeach (SearchResult oResult in OSrchResults) {\r\n\t\t\t\tstrGroupList += oResult.Properties[\"cn\"][0].ToString() + \"\\n\";\r\n\t\t\t\t//DirectoryEntry oThisGroup = oResult.GetDirectoryEntry();\r\n\t\t\t\t//strOut = \"\";\r\n\t\t\t\t//foreach(string strProperty2 in oThisGroup.Properties.PropertyNames){\r\n\t\t\t\t\t//strOut += \"||\" + strProperty2 + \":\" + oThisGroup.Properties[strProperty2][0].ToString() + \"\\n\";\r\n\t\t\t\t//}\r\n\t\t\t}\r\n\r\n\t\t\tSystem.Console.Write(strGroupList);\r\n\r\n\t\t}\r\n\r\n\r\n\t\tstatic void isMember(string strGroupIn){\r\n\r\n\t\t\tstring strOut = \"\";\r\n\t\t\t//Get the current identity and put it into an identity object.\r\n\t\t\tWindowsIdentity MyIdentity = WindowsIdentity.GetCurrent();\r\n\r\n\t\t\t//Put the previous identity into a principal object.\r\n\t\t\tWindowsPrincipal MyPrincipal = new WindowsPrincipal(MyIdentity);\r\n\t\t\tif(MyPrincipal.IsInRole(strGroupIn)) {\r\n\t\t\t\tstrOut = \"Member of \";\r\n\t\t\t} else {\r\n\t\t\t\tstrOut = \"Not a member of \";\r\n\t\t\t}\r\n\r\n\t\t\tstrOut += strGroupIn;\r\n\t\t\tSystem.Console.Write(strOut);\r\n\t\t}\r\n\r\n\r\n\t\tstatic void getMemberDetails(string strMemberIn) {\r\n\r\n\t\t\tstring strOut = \"\";\r\n\t\t\tstring strOut2 = \"\";\r\n\t\t\tstring strOut3 = \"\";\r\n\t\t\t\r\n\t\t\tDirectoryEntry oDERoot = new DirectoryEntry(@\"GC://DC=somedomain,DC=com\");\t\t\t\r\n\t\t\tDirectorySearcher oDirSrch = new DirectorySearcher(oDERoot);\r\n\t\t\toDirSrch.Filter = strMemberIn;\r\n\t\t\toDirSrch.PropertiesToLoad.Add(\"cn\");\r\n\t\t\toDirSrch.PropertiesToLoad.Add(\"sn\");\r\n\t\t\toDirSrch.PropertiesToLoad.Add(\"givenName\");\r\n\t\t\toDirSrch.PropertiesToLoad.Add(\"mail\");\r\n\t\t\toDirSrch.PropertiesToLoad.Add(\"info\");\r\n\t\t\toDirSrch.PropertiesToLoad.Add(\"c\");\r\n\t\t\toDirSrch.PropertiesToLoad.Add(\"l\");\r\n\t\t\toDirSrch.PropertiesToLoad.Add(\"physicalDeliveryOfficeName\");\r\n\t\t\toDirSrch.PropertiesToLoad.Add(\"samAccountName\");\r\n\t\t\toDirSrch.PropertiesToLoad.Add(\"AdsPath\");\r\n\t\t\toDirSrch.PropertiesToLoad.Add(\"Groups\");\r\n\r\n\t\t\tSearchResultCollection OSrchResults = oDirSrch.FindAll();\r\n\r\n\t\t\tforeach (SearchResult oResult in OSrchResults) {\r\n\t\t\t\t// Print \"all requested\" properties in this result set by named property\r\n\t\t\t\tstrOut += \"cn\" + oResult.Properties[\"cn\"][0].ToString() + \"\\n\";\r\n\t\t\t\tstrOut += \"sn\" + oResult.Properties[\"sn\"][0].ToString() + \"\\n\";\r\n\t\t\t\tstrOut += \"givenName\" + oResult.Properties[\"givenName\"][0].ToString() + \"\\n\";\r\n\t\t\t\tstrOut += \"mail\" + oResult.Properties[\"mail\"][0].ToString() + \"\\n\";\r\n\t\t\t\t//strOut += \"info\" + oResult.Properties[\"info\"][0].ToString() + \"\\n\";\r\n\t\t\t\tstrOut += \"c\" + oResult.Properties[\"c\"][0].ToString() + \"\\n\";\r\n\t\t\t\tstrOut += \"l\" + oResult.Properties[\"l\"][0].ToString() + \"\\n\";\r\n\t\t\t\t//strOut += \"physicaldeliveryofficename\" + oResult.Properties[\"physicaldeliveryofficename\"][0].ToString() + \"\\n\";\r\n\t\t\t\tstrOut += \"samAccountName\" + oResult.Properties[\"samAccountName\"][0].ToString() + \"\\n\";\r\n\t\t\t\tstrOut += \"AdsPath\" + oResult.Properties[\"AdsPath\"][0].ToString() + \"\\n\\n\";\r\n\r\n\t\t\t\t// Print \"all requested\" properties in this result set\r\n\t\t\t\tforeach (string strProperty in oResult.Properties.PropertyNames) {\r\n\t\t\t\t\tstrOut2 += strProperty + \":\" + oResult.Properties[strProperty][0].ToString() + \"\\n\";\r\n\t\t\t\t}\r\n\t\t\t\tstrOut2 += \"\\n\";\r\n\r\n\t\t\t\t// Print \"all\" properties in this directory entry\r\n\t\t\t\tDirectoryEntry oThisUser = oResult.GetDirectoryEntry();\r\n\t\t\t\tforeach(string strProperty2 in oThisUser.Properties.PropertyNames){\r\n\t\t\t\t\tstrOut3 += \"||\" + strProperty2 + \":\" + oThisUser.Properties[strProperty2][0].ToString();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tSystem.Console.WriteLine(strOut);\r\n\t\t\tSystem.Console.WriteLine(\"\\n\\n\");\r\n\r\n\t\t\tSystem.Console.WriteLine(strOut2);\r\n\t\t\tSystem.Console.WriteLine(\"\\n\\n\");\r\n\r\n\t\t\tSystem.Console.WriteLine(strOut3);\r\n\t\t\tSystem.Console.WriteLine(\"\\n\\n\");\r\n\t\t\r\n\t\t}\r\n\r\n\t\t[STAThread]\r\n\t\tstatic void Main(string[] args)\r\n\t\t{\r\n\r\n\t\t\tgetMemberDetails(\"(samAccountName=jtga*)\");\r\n\t\t\tgetGroups(\"(&(cn=ad*)(objectClass=Group))\");\r\n\t\t\tisMember(@\"BUILTIN\\Administrators\");\r\n\r\n\t\t}\r\n\t}\r\n}\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["ADSI","Active Directory"]},{"RecordId":"648","Title":"Events and Delegates","Description":"Demonstrates how to construct a class that raises events and how to capture those events.","Code":"//----------------------------------------------------------------------\r\n// Class to contain the FireShots event's data\r\n//----------------------------------------------------------------------\r\npublic class FireShotsEventArgs:EventArgs{\r\n\r\n\tprivate int _Counter = 0;\r\n\tprivate string _GunType = \"\";\r\n\r\n\t// Class constructor\r\n\tpublic FireShotsEventArgs (){\r\n\t}\r\n\r\n\t// NumberOfTimesFired property\r\n\tpublic int NumberOfTimesFired {\r\n\t\tget {\r\n\t\t\treturn _Counter;\r\n\t\t}\r\n\t\tset {\r\n\t\t\t_Counter = value;\r\n\t\t}\r\n\t}\r\n\r\n\t// TypeOfGun property\r\n\tpublic string TypeOfGun {\r\n\t\tget {\r\n\t\t\treturn _GunType;\r\n\t\t}\r\n\t\tset {\r\n\t\t\t_GunType = value;\r\n\t\t}\r\n\t}\r\n} \r\n\r\n//----------------------------------------------------------------------\r\n// Class to contain the GunIsEmpty event's data\r\n//----------------------------------------------------------------------\r\npublic class GunIsEmptyEventArgs:EventArgs{\r\n\r\n\tprivate string _GunType = \"\";\r\n\r\n\t// Class constructor\r\n\tpublic GunIsEmptyEventArgs (){\r\n\t}\r\n\r\n\t// TypeOfGun property\r\n\tpublic string TypeOfGun {\r\n\t\tget {\r\n\t\t\treturn _GunType;\r\n\t\t}\r\n\t\tset {\r\n\t\t\t_GunType = value;\r\n\t\t}\r\n\t}\r\n} \r\n\r\n\r\n//----------------------------------------------------------------------\r\n// Declare the delegates\r\n//----------------------------------------------------------------------\r\npublic delegate void FireShotsEventHandler(object sender, FireShotsEventArgs e);\r\npublic delegate void GunIsEmptyEventHandler(object sender, GunIsEmptyEventArgs e);\r\n\r\n//----------------------------------------------------------------------\r\n// Declare a class that raises the event\r\n//----------------------------------------------------------------------\r\npublic class Gun {\r\n\t\r\n\tstring _GunType = \"\";\r\n\tint _MaxBullets = 0;\r\n\tint _TotalShotsFired = 0;\r\n\r\n\t// Class constructor\r\n\tpublic Gun(string strGunType, int intMaxBullets) {\r\n\t\t_GunType = strGunType;\r\n\t\t_MaxBullets = intMaxBullets;\r\n\t}\r\n\r\n\t// Declare the public events\r\n\tpublic event FireShotsEventHandler GunWentOff;\r\n\tpublic event GunIsEmptyEventHandler GunIsEmpty;\r\n\t\r\n\t// Raise the FireShots event\r\n\tprotected virtual void OnFireShotsEvent(FireShotsEventArgs e) {\r\n\t\tGunWentOff(this, e);\r\n\t}\r\n\r\n\t// Raise the GunIsEmpty event\r\n\tprotected virtual void OnGunIsEmpty(GunIsEmptyEventArgs e) {\r\n\t\tGunIsEmpty(this, e);\r\n\t}\r\n\r\n\r\n\t// Simulate making something happen that raises an event\r\n\tpublic void PullTheTrigger(int intHowManyShots) {\r\n\r\n\t\tFireShotsEventArgs eShotsArgs = new FireShotsEventArgs();\r\n\t\tGunIsEmptyEventArgs eEmptyArgs = new GunIsEmptyEventArgs();\r\n\r\n\t\teShotsArgs.TypeOfGun = this._GunType;\r\n\r\n\t\tfor (int i = 1; i <= intHowManyShots; i++){\r\n\t\t\tSystem.Threading.Thread.Sleep(500);\r\n\r\n\t\t\t_TotalShotsFired ++;\r\n\t\t\tif (_TotalShotsFired > _MaxBullets) {\r\n\t\t\t\teEmptyArgs.TypeOfGun = this._GunType;\r\n\t\t\t\tOnGunIsEmpty(eEmptyArgs);\r\n\t\t\t\tbreak;\r\n\t\t\t} else {\r\n\t\t\t\teShotsArgs.NumberOfTimesFired = i;\r\n\t\t\t\tOnFireShotsEvent(eShotsArgs);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\n\t\r\n\t\r\n//----------------------------------------------------------------------\r\n// This is the class that uses the class that raises two events\r\n//----------------------------------------------------------------------\r\npublic class Form1 : System.Windows.Forms.Form {\r\n\t...\r\n\t...\r\n\r\n\t// This is the GunWentOff event that gets fired\r\n\tprivate void OnGunWentOff(object sender, FireShotsEventArgs e) {\r\n\t       MessageBox.Show(e.TypeOfGun + \" went off \" + e.NumberOfTimesFired.ToString());\r\n\t}\r\n\r\n\t// This is the GunIsEmpty event that gets fired\r\n\tprivate void OnGunIsEmpty(object sender, GunIsEmptyEventArgs e) {\r\n\t\tMessageBox.Show(e.TypeOfGun + \" is empty\");\r\n\t}\r\n\r\n\tprivate void cmdDoEvent_Click(object sender, System.EventArgs e) {\r\n\r\n\t\t// Create two Gun objects\r\n\t\tGun g1 = new Gun(\"Colt 45\", 6);\r\n\t\tGun g2 = new Gun(\"Glok\", 9);\r\n\r\n\t\t// Wire up the event handlers for the FireShots events\r\n\t\tg1.GunWentOff  += new FireShotsEventHandler(OnGunWentOff);\r\n\t\tg2.GunWentOff  += new FireShotsEventHandler(OnGunWentOff);\r\n\r\n\t\t// Wire up the event handlers for the GunIsEmpty events\r\n\t\tg1.GunIsEmpty += new GunIsEmptyEventHandler(OnGunIsEmpty);\r\n\t\tg2.GunIsEmpty += new GunIsEmptyEventHandler(OnGunIsEmpty);\r\n\r\n\r\n\t\t// Shoot the guns\r\n\t\tg1.PullTheTrigger(1);\r\n\t\tg2.PullTheTrigger(1);\r\n\r\n\t\tg1.PullTheTrigger(10);\r\n\t\tg2.PullTheTrigger(10);\r\n\r\n\t\tg1.PullTheTrigger(1);\r\n\t\tg2.PullTheTrigger(1);\r\n\r\n\t\tg1 = null;\r\n\t\tg2 = null;\r\n\t\t\r\n\t\tMessageBox.Show(\"Done\");\r\n\r\n\t }\r\n}","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Events and Delegates","Events & Delegates"]},{"RecordId":"649","Title":"Registering an Assembly in the GAC","Description":"Article that describes how to register an assembly in the Global Assembly Cache (GAC).","Code":"-------------------------\r\nIntroduction\r\n-------------------------\r\n\r\nThis article explains what is a Global Assembly Cache, how to register an assembly in GACm how to create a strong named assembly and finally how to operating system maintains and stores different versions of the assembly in GAC.\r\n\r\n\r\n-------------------------\r\nGlobal Assembly Cache\r\n-------------------------\r\n\r\nIt is a directory named GAC that is under WINNT/Assembly. When you explore directory structure you will not be able to see this directory as the OS runs a special snap in when you try the explore the directory. You can see this directory using command prompt.\r\n\r\nAs the name suggest the assemblies in this directory are globally accessible.\r\n\r\n\r\n-------------------------\r\nStrong Name\r\n-------------------------\r\n\r\nAs Microsoft says, a strong name consists of the assembly's identity - it's simple text name, version number, and culture information (if provided) - plus a public key and a digital signature. It is generated from an assembly file using the corresponding private key. (The assembly file contains the assembly manifest, which contains the names and hashes of all of the files that make up the assembly.)   \r\n\r\nStrong named assemblies are no different from other assemblies except for the fact that they could be stored in the global assembly cache (GAC) and could be used across different projects.\r\n\r\n\r\n-------------------------\r\nCreating strong named assemblies.\r\n-------------------------\r\n\r\nTo create a strong named assembly you need to have a strong key file, which contains key pair for generating strong name.\r\nTo create strong key file use the command line utility supplied with .NET as shown below:\r\nSn -k <Destination file>.\r\n\r\nOpen the .Net project to be complied as a strong named assembly. Open AssembyInfo.cs/ AssembyInfo.vb file. Add the following line to AssemblyInfo file:\r\nC#\r\n[assembly: AssemblyKeyFile(\"\")]\r\n\r\nVB.NET\r\n<assembly: AssemblyKeyFile(\"\")>\r\n\r\nCompile the application; you have created a strong named assembly.\r\n\r\n\r\n-------------------------\r\nRegistering Strong named assembly into GAC.\r\n-------------------------\r\n\r\nThe purpose of having strong named assembly is to make use of the same assembly across applications. This would be easily achieved if the assembly were stored in the GAC.\r\nTo register an assembly use the \"Actual\" command line utility supplied with Microsoft .NET. \r\nFollow these steps:\r\n\r\n1.Open the \"Visual Studio.Net Command Prompt\",\r\nStart->Program Files->Microsoft Visual Studio. NET->Visual Studio .NET Tools-> Visual Studio.Net Command Prompt.\r\n\r\n2. Type \"GacUtil <Assembly file path>\" in the command prompt and press enter.\r\n\r\nAnother easy way is to drag and drop the assembly file on to the C:\\WINNT\\assembly folder opened in the explore as shown. \r\n\r\n\r\n-------------------------\r\nHow Windows stores multiple versions?\r\n-------------------------\r\n\r\nRecompile the assembly, if you have left the following line in the AssemblyInfo file as they are, version of the assembly will change.\r\n\r\nC#\r\n[Assembly: AssemblyVersion(\"1.0.*\")]\r\n\r\nVB.NET\r\n<Assembly: AssemblyVersion(\"1.0.*\")>\r\n\r\nRegister the assembly again in the GAC, open the GAC (C:\\WINNT\\Assembly).  In the explorer, you can see two entries for the same assembly.\r\n \r\nHow is it possible? You have dragged and dropped the same file twice. Does OS have two copies of the same file in the same folder? Is it allowed in Windows?\r\n\r\nWhen you are dragging and dropping the assembly file are registering a file OS is not copying the file to the directory C:\\WINNT\\Assembly.\r\n\r\nWhat you are seeing in the explorer is because of the Snap-in running. Actually the entries seen in the GAC are not corresponding to the physical files in the Assembly folder, they are the .NET assemblies register in the GAC. \r\n\r\n\r\n-------------------------\r\nHow is the OS storing these files?\r\n-------------------------\r\n\r\nIn the DOS prompt, move to the Directory GAC under C:\\WINNT\\Assembly.\r\n\r\nHere you can see one directory for each of the assembly registered irrespective of the version. The directory derives its name form the name of the assembly.\r\n\r\nType of the following command in the command prompt\r\n\r\nCD <assemblyfilename>\r\n\r\nList the directories, by typing \"dir /p\".\r\n\r\nYou can see one directory for each of the version you are maintaining in the GAC.  The key file associated with the Assembly generates the string after the last \"_\". In above shown example it is 337b0459925acbc4.\r\n\r\nThe String before the first \"_\" is the version number of the assembly.  In this case, it is 1.0.1168.17969.\r\n\r\nWe can conclude that the same key file can be used with different assemblies.\r\n\r\nIf you further go down and browse the contents of these directories you can see two files - one is the assembly file and the other one is \"__AssebemlyInfo__.ini\".\r\n\r\nThe contents of the \"__AssebemlyInfo__. ini\" is something like this:\r\n\r\n[AssemblyInfo] \r\nMVID=c431813ca833a846ba67c5ea3088ce51 \r\nURL=file:///C:/Gags/RnD/StrongName/bin/Release/StrongName.dll \r\nDisplayName=StrongName, Version=1.0.1168.17969, Culture=neutral, PublicKeyToke\r\n\r\n\r\n-------------------------\r\nConclusion\r\n-------------------------\r\n\r\nTo register assembly in GAC assembly needs a strong name. Multiple versions of the same assembly could be stored in the GAC.  Single key file (.snk) could be used for different assemblies.  Each version of an assembly in the GAC is stored in a separate directory under winnt\\Assembly\\GAC","Declares":"","CodeCategory":{"CategoryId":"20","CategoryDescription":".Net - ASP.Net"},"Keywords":["GAC","Assembly"]},{"RecordId":"650","Title":"Add, Change, Delete Record Maintenance Sample (ADO.Net  and C#)","Description":"C# application that uses drop-down to position to record.\r\nHas first,prev,next,last record nav buttons.\r\nHas add,update,delete buttons.\r\nGreat ADO.Net sample.","Code":"using System;\r\nusing System.Drawing;\r\nusing System.Collections;\r\nusing System.ComponentModel;\r\nusing System.Windows.Forms;\r\nusing System.Data;\r\nusing System.Data.OleDb;\r\n\r\nnamespace NavigatingRecordsUnbound\r\n{\r\n\t/// <summary>\r\n\t/// Summary description for Form1.\r\n\t/// </summary>\r\n\t/// \r\n\r\n\t\r\n\r\n\tpublic class Form1 : System.Windows.Forms.Form\r\n\t{\r\n\t\r\n\t\tprivate System.ComponentModel.Container components = null;\r\n\r\n\t\tprivate System.Data.OleDb.OleDbConnection oleDbConnection1;\r\n\t\tprivate System.Data.OleDb.OleDbDataAdapter oleDbDataAdapter1;\r\n\t\tprivate System.Data.OleDb.OleDbCommandBuilder oleDbCommandBuilder1;\r\n\t\tprivate DataSet myDs;\r\n\t\tprivate string sqlStr;\r\n\t\tprivate int currentRow;\r\n\t\tprivate string opMode;\r\n\r\n\t\tprivate string AccNumber;\r\n\r\n\r\n\t\tprivate System.Windows.Forms.ComboBox cbxAccNumber;\r\n\t\tprivate System.Windows.Forms.TextBox tbxName;\r\n\t\tprivate System.Windows.Forms.TextBox tbxBalance;\r\n\t\tprivate System.Windows.Forms.Label lblAccNumber;\r\n\t\tprivate System.Windows.Forms.Label lblName;\r\n\t\tprivate System.Windows.Forms.Label lblBalance;\r\n\t\tprivate System.Windows.Forms.Button btnFirst;\r\n\t\tprivate System.Windows.Forms.Button btnPrevious;\r\n\t\tprivate System.Windows.Forms.Button btnNext;\r\n\t\tprivate System.Windows.Forms.Button btnLast;\r\n\t\tprivate System.Windows.Forms.Button btnNew;\r\n\t\tprivate System.Windows.Forms.Button btnEdit;\r\n\t\tprivate System.Windows.Forms.Button btnDelete;\r\n\t\tprivate System.Windows.Forms.Button btnUpdate;\r\n\t\tprivate System.Windows.Forms.Label lblDisplay;\r\n\t\tprivate System.Windows.Forms.Button btnCancel;\r\n\r\n\t\tpublic Form1()\r\n\t\t{\r\n\t\t\t//\r\n\t\t\t// Required for Windows Form Designer support\r\n\t\t\t//\r\n\t\t\tInitializeComponent();\r\n\r\n\t\t\t// Attach event handlers to various buttons.\r\n\t\t\tbtnFirst.Click += new EventHandler(btnFirst_Click);\r\n\t\t\tbtnPrevious.Click += new EventHandler(btnPrevious_Click);\r\n\t\t\tbtnNext.Click += new EventHandler(btnNext_Click);\r\n\t\t\tbtnLast.Click += new EventHandler(btnLast_Click);\r\n\t\t\tbtnNew.Click += new EventHandler(btnNew_Click);\r\n\t\t\tbtnEdit.Click += new EventHandler(btnEdit_Click);\r\n\t\t\tbtnDelete.Click += new EventHandler(btnDelete_Click);\r\n\t\t\tbtnUpdate.Click += new EventHandler(btnUpdate_Click);\r\n\t\t\tbtnCancel.Click += new EventHandler(btnCancel_Click);\r\n\r\n\t\t\t// Attach event handler to the Account Number combo box.\r\n\t\t\tcbxAccNumber.SelectedIndexChanged += new EventHandler(cbxAccNumber_Changed);\r\n\r\n\t\t\t\r\n\t\t\tloadData();\r\n\t\r\n\t\t}\r\n\r\n\t\tprivate void loadData()\r\n\t\t{\r\n\t\t\tstring connStr = \"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=D:\\\\banking\\\\bank_database.mdb\";\r\n\t\t\toleDbConnection1 = new OleDbConnection(connStr);\r\n\t\t\toleDbConnection1.Open();\r\n\t\t\tmyDs = new DataSet();\r\n\t\t\tsqlStr = \"SELECT AccountNumber,CustomerName,AccountBalance \"\r\n\t\t\t\t+ \"FROM bank ORDER BY AccountNumber\";\r\n\t\t\toleDbDataAdapter1 = new OleDbDataAdapter(sqlStr, oleDbConnection1);\r\n\t\t\toleDbDataAdapter1.SelectCommand.CommandText = sqlStr;\r\n\t\t\toleDbCommandBuilder1 = new OleDbCommandBuilder(oleDbDataAdapter1);\r\n\t\t\toleDbDataAdapter1.Fill(myDs,\"dtBankAccounts\");\r\n\t\t\tcurrentRow = 0;\r\n\t\t}\r\n\r\n\t\t/// <summary>\r\n\t\t/// Clean up any resources being used.\r\n\t\t/// </summary>\r\n\t\tprotected override void Dispose( bool disposing )\r\n\t\t{\r\n\t\t\tif( disposing )\r\n\t\t\t{\r\n\t\t\t\tif (components != null) \r\n\t\t\t\t{\r\n\t\t\t\t\tcomponents.Dispose();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tbase.Dispose( disposing );\r\n\t\t}\r\n\r\n\t\t#region Windows Form Designer generated code\r\n\t\t/// <summary>\r\n\t\t/// Required method for Designer support - do not modify\r\n\t\t/// the contents of this method with the code editor.\r\n\t\t/// </summary>\r\n\t\tprivate void InitializeComponent()\r\n\t\t{\r\n\t\t\tthis.btnCancel = new System.Windows.Forms.Button();\r\n\t\t\tthis.lblBalance = new System.Windows.Forms.Label();\r\n\t\t\tthis.lblName = new System.Windows.Forms.Label();\r\n\t\t\tthis.btnFirst = new System.Windows.Forms.Button();\r\n\t\t\tthis.cbxAccNumber = new System.Windows.Forms.ComboBox();\r\n\t\t\tthis.btnUpdate = new System.Windows.Forms.Button();\r\n\t\t\tthis.btnDelete = new System.Windows.Forms.Button();\r\n\t\t\tthis.btnNew = new System.Windows.Forms.Button();\r\n\t\t\tthis.btnPrevious = new System.Windows.Forms.Button();\r\n\t\t\tthis.lblAccNumber = new System.Windows.Forms.Label();\r\n\t\t\tthis.btnNext = new System.Windows.Forms.Button();\r\n\t\t\tthis.tbxName = new System.Windows.Forms.TextBox();\r\n\t\t\tthis.tbxBalance = new System.Windows.Forms.TextBox();\r\n\t\t\tthis.btnLast = new System.Windows.Forms.Button();\r\n\t\t\tthis.btnEdit = new System.Windows.Forms.Button();\r\n\t\t\tthis.lblDisplay = new System.Windows.Forms.Label();\r\n\t\t\tthis.SuspendLayout();\r\n\t\t\t// \r\n\t\t\t// btnCancel\r\n\t\t\t// \r\n\t\t\tthis.btnCancel.Location = new System.Drawing.Point(384, 16);\r\n\t\t\tthis.btnCancel.Name = \"btnCancel\";\r\n\t\t\tthis.btnCancel.TabIndex = 14;\r\n\t\t\tthis.btnCancel.Text = \"Cancel\";\r\n\t\t\t// \r\n\t\t\t// lblBalance\r\n\t\t\t// \r\n\t\t\tthis.lblBalance.Location = new System.Drawing.Point(184, 112);\r\n\t\t\tthis.lblBalance.Name = \"lblBalance\";\r\n\t\t\tthis.lblBalance.Size = new System.Drawing.Size(80, 23);\r\n\t\t\tthis.lblBalance.TabIndex = 5;\r\n\t\t\tthis.lblBalance.Text = \"Balance  $\";\r\n\t\t\tthis.lblBalance.TextAlign = System.Drawing.ContentAlignment.MiddleRight;\r\n\t\t\t// \r\n\t\t\t// lblName\r\n\t\t\t// \r\n\t\t\tthis.lblName.Location = new System.Drawing.Point(200, 72);\r\n\t\t\tthis.lblName.Name = \"lblName\";\r\n\t\t\tthis.lblName.Size = new System.Drawing.Size(64, 23);\r\n\t\t\tthis.lblName.TabIndex = 4;\r\n\t\t\tthis.lblName.Text = \"Name\";\r\n\t\t\tthis.lblName.TextAlign = System.Drawing.ContentAlignment.MiddleRight;\r\n\t\t\t// \r\n\t\t\t// btnFirst\r\n\t\t\t// \r\n\t\t\tthis.btnFirst.Location = new System.Drawing.Point(48, 192);\r\n\t\t\tthis.btnFirst.Name = \"btnFirst\";\r\n\t\t\tthis.btnFirst.TabIndex = 6;\r\n\t\t\tthis.btnFirst.Text = \"|< First\";\r\n\t\t\t// \r\n\t\t\t// cbxAccNumber\r\n\t\t\t// \r\n\t\t\tthis.cbxAccNumber.DropDownWidth = 96;\r\n\t\t\tthis.cbxAccNumber.Location = new System.Drawing.Point(88, 72);\r\n\t\t\tthis.cbxAccNumber.Name = \"cbxAccNumber\";\r\n\t\t\tthis.cbxAccNumber.Size = new System.Drawing.Size(96, 21);\r\n\t\t\tthis.cbxAccNumber.TabIndex = 0;\r\n\t\t\t// \r\n\t\t\t// btnUpdate\r\n\t\t\t// \r\n\t\t\tthis.btnUpdate.Location = new System.Drawing.Point(296, 16);\r\n\t\t\tthis.btnUpdate.Name = \"btnUpdate\";\r\n\t\t\tthis.btnUpdate.TabIndex = 13;\r\n\t\t\tthis.btnUpdate.Text = \"Update\";\r\n\t\t\t// \r\n\t\t\t// btnDelete\r\n\t\t\t// \r\n\t\t\tthis.btnDelete.Location = new System.Drawing.Point(208, 16);\r\n\t\t\tthis.btnDelete.Name = \"btnDelete\";\r\n\t\t\tthis.btnDelete.TabIndex = 12;\r\n\t\t\tthis.btnDelete.Text = \"Delete\";\r\n\t\t\t// \r\n\t\t\t// btnNew\r\n\t\t\t// \r\n\t\t\tthis.btnNew.Location = new System.Drawing.Point(32, 16);\r\n\t\t\tthis.btnNew.Name = \"btnNew\";\r\n\t\t\tthis.btnNew.TabIndex = 10;\r\n\t\t\tthis.btnNew.Text = \"New\";\r\n\t\t\t// \r\n\t\t\t// btnPrevious\r\n\t\t\t// \r\n\t\t\tthis.btnPrevious.Location = new System.Drawing.Point(160, 192);\r\n\t\t\tthis.btnPrevious.Name = \"btnPrevious\";\r\n\t\t\tthis.btnPrevious.TabIndex = 7;\r\n\t\t\tthis.btnPrevious.Text = \"< Previous\";\r\n\t\t\t// \r\n\t\t\t// lblAccNumber\r\n\t\t\t// \r\n\t\t\tthis.lblAccNumber.Location = new System.Drawing.Point(0, 72);\r\n\t\t\tthis.lblAccNumber.Name = \"lblAccNumber\";\r\n\t\t\tthis.lblAccNumber.Size = new System.Drawing.Size(80, 23);\r\n\t\t\tthis.lblAccNumber.TabIndex = 3;\r\n\t\t\tthis.lblAccNumber.Text = \"Acc Number\";\r\n\t\t\tthis.lblAccNumber.TextAlign = System.Drawing.ContentAlignment.MiddleRight;\r\n\t\t\t// \r\n\t\t\t// btnNext\r\n\t\t\t// \r\n\t\t\tthis.btnNext.Location = new System.Drawing.Point(264, 192);\r\n\t\t\tthis.btnNext.Name = \"btnNext\";\r\n\t\t\tthis.btnNext.TabIndex = 8;\r\n\t\t\tthis.btnNext.Text = \"Next >\";\r\n\t\t\t// \r\n\t\t\t// tbxName\r\n\t\t\t// \r\n\t\t\tthis.tbxName.Location = new System.Drawing.Point(272, 72);\r\n\t\t\tthis.tbxName.Name = \"tbxName\";\r\n\t\t\tthis.tbxName.Size = new System.Drawing.Size(200, 20);\r\n\t\t\tthis.tbxName.TabIndex = 1;\r\n\t\t\tthis.tbxName.Text = \"\";\r\n\t\t\t// \r\n\t\t\t// tbxBalance\r\n\t\t\t// \r\n\t\t\tthis.tbxBalance.Location = new System.Drawing.Point(272, 112);\r\n\t\t\tthis.tbxBalance.Name = \"tbxBalance\";\r\n\t\t\tthis.tbxBalance.TabIndex = 2;\r\n\t\t\tthis.tbxBalance.Text = \"\";\r\n\t\t\t// \r\n\t\t\t// btnLast\r\n\t\t\t// \r\n\t\t\tthis.btnLast.Location = new System.Drawing.Point(368, 192);\r\n\t\t\tthis.btnLast.Name = \"btnLast\";\r\n\t\t\tthis.btnLast.TabIndex = 9;\r\n\t\t\tthis.btnLast.Text = \"Last >|\";\r\n\t\t\t// \r\n\t\t\t// btnEdit\r\n\t\t\t// \r\n\t\t\tthis.btnEdit.Location = new System.Drawing.Point(120, 16);\r\n\t\t\tthis.btnEdit.Name = \"btnEdit\";\r\n\t\t\tthis.btnEdit.TabIndex = 11;\r\n\t\t\tthis.btnEdit.Text = \"Edit\";\r\n\t\t\t// \r\n\t\t\t// lblDisplay\r\n\t\t\t// \r\n\t\t\tthis.lblDisplay.Location = new System.Drawing.Point(136, 248);\r\n\t\t\tthis.lblDisplay.Name = \"lblDisplay\";\r\n\t\t\tthis.lblDisplay.Size = new System.Drawing.Size(232, 23);\r\n\t\t\tthis.lblDisplay.TabIndex = 15;\r\n\t\t\tthis.lblDisplay.TextAlign = System.Drawing.ContentAlignment.MiddleCenter;\r\n\t\t\t// \r\n\t\t\t// Form1\r\n\t\t\t// \r\n\t\t\tthis.AutoScaleBaseSize = new System.Drawing.Size(5, 13);\r\n\t\t\tthis.BackColor = System.Drawing.Color.Teal;\r\n\t\t\tthis.ClientSize = new System.Drawing.Size(488, 309);\r\n\t\t\tthis.Controls.AddRange(new System.Windows.Forms.Control[] {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t  this.lblDisplay,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t  this.btnCancel,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t  this.btnUpdate,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t  this.btnDelete,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t  this.btnEdit,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t  this.btnNew,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t  this.btnLast,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t  this.btnNext,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t  this.btnPrevious,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t  this.btnFirst,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t  this.lblBalance,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t  this.lblName,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t  this.lblAccNumber,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t  this.tbxBalance,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t  this.tbxName,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t  this.cbxAccNumber});\r\n\t\t\tthis.Name = \"Form1\";\r\n\t\t\tthis.Text = \"Navigating One Bank Record At A Time\";\r\n\t\t\tthis.Load += new System.EventHandler(this.Form1_Load);\r\n\t\t\tthis.ResumeLayout(false);\r\n\r\n\t\t}\r\n\t\t#endregion\r\n\r\n\t\t/// <summary>\r\n\t\t/// The main entry point for the application.\r\n\t\t/// </summary>\r\n\t\t[STAThread]\r\n\t\tstatic void Main() \r\n\t\t{\r\n\t\t\tApplication.Run(new Form1());\r\n\t\t}\r\n\r\n\t\tprivate void Form1_Load(object sender, System.EventArgs e)\r\n\t\t{\r\n\t\t\topMode = \"View\";\r\n\t\t\tlockControls();\r\n\t\t\tpopulateAccNumbers();\r\n\t\t\tshowData();\r\n\t\t}\r\n\r\n\t\tprivate void lockControls()\r\n\t\t{\r\n\t\t\topMode = \"View\";\r\n\t\t\ttbxName.ReadOnly = true;\r\n\t\t\ttbxBalance.ReadOnly = true;\r\n\r\n\t\t\tbtnUpdate.Enabled = false;\r\n\t\t\tbtnCancel.Enabled = false;\r\n\t\t}\r\n\r\n\t\tprivate void unlockControls()\r\n\t\t{\r\n\t\t\ttbxName.ReadOnly = false;\r\n\t\t\ttbxBalance.ReadOnly = false;\r\n\r\n\t\t\tbtnUpdate.Enabled = true;\r\n\t\t\tbtnCancel.Enabled = true;\r\n\t\t}\r\n\r\n\t\tprivate void populateAccNumbers()\r\n\t\t{\r\n\t\t\tfor ( int i=0; i < myDs.Tables[\"dtBankAccounts\"].Rows.Count; i++)\r\n\t\t\t\tcbxAccNumber.Items.Add(myDs.Tables[\"dtBankAccounts\"].Rows[i][\"AccountNumber\"].ToString());\r\n\t\t}\r\n\r\n\t\tprivate void showData()\r\n\t\t{\r\n\t\t\tcbxAccNumber.Text = myDs.Tables[\"dtBankAccounts\"].Rows[currentRow][\"AccountNumber\"].ToString();\r\n\t\t\ttbxName.Text = myDs.Tables[\"dtBankAccounts\"].Rows[currentRow][\"CustomerName\"].ToString();\r\n\t\t\ttbxBalance.Text = myDs.Tables[\"dtBankAccounts\"].Rows[currentRow][\"AccountBalance\"].ToString();\r\n\t\t\tlblDisplay.Text = \"Record \" + (currentRow + 1).ToString() + \" of \" + myDs.Tables[\"dtBankAccounts\"].Rows.Count.ToString();\r\n\t\t}\r\n\r\n\t\tprivate void btnFirst_Click(object source, System.EventArgs e)\r\n\t\t{\r\n\t\t\tcurrentRow = 0;\r\n\t\t\tshowData();\r\n\t\t}\r\n\r\n\t\tprivate void btnPrevious_Click(object source, System.EventArgs e)\r\n\t\t{\r\n\t\t\tif ( currentRow > 0 )\r\n\t\t\t\tcurrentRow --;\r\n\t\t\tshowData();\r\n\t\t}\r\n\r\n\t\tprivate void btnNext_Click(object source, System.EventArgs e)\r\n\t\t{\r\n\t\t\tif ( currentRow < myDs.Tables[\"dtBankAccounts\"].Rows.Count -1 )\r\n\t\t\t\tcurrentRow ++;\r\n\t\t\tshowData();\r\n\t\t}\r\n\r\n\t\tprivate void btnLast_Click(object source, System.EventArgs e)\r\n\t\t{\r\n\t\t\tcurrentRow = myDs.Tables[\"dtBankAccounts\"].Rows.Count -1;\r\n\t\t\tshowData();\r\n\t\t}\r\n\r\n\t\tprivate void btnUpdate_Click(object source, System.EventArgs e)\r\n\t\t{\r\n\t\t\tif (opMode == \"New\")\r\n\t\t\t{\t\r\n\t\t\t\tstring newAccountNumber;\r\n\t\t\t\tnewAccountNumber = cbxAccNumber.Text;\r\n\r\n\t\t\t\tif ( !checkIfUnique(newAccountNumber) )\r\n\t\t\t\t{\r\n\t\t\t\t\tMessageBox.Show(\"Account Number already exists!\");\r\n\t\t\t\t\tcbxAccNumber.Focus();\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n                DataRow newRow = myDs.Tables[\"dtBankAccounts\"].NewRow();\r\n\t\t\t\tnewRow[\"AccountNumber\"] = cbxAccNumber.Text;\r\n\t\t\t\tnewRow[\"CustomerName\"] = tbxName.Text;\r\n\t\t\t\tnewRow[\"AccountBalance\"] = double.Parse(tbxBalance.Text);\r\n\t\t\t\tmyDs.Tables[\"dtBankAccounts\"].Rows.Add(newRow);\r\n\t\t\r\n\t\t\t\tcbxAccNumber.Items.Add(cbxAccNumber.Text);\r\n\t\t\t\t\r\n\t\t\t\toleDbDataAdapter1.Update(myDs,\"dtBankAccounts\");\r\n\t\t\t\tMessageBox.Show(\"Record successfully added!\");\r\n\t\t\t}\r\n\r\n\t\t\tif (opMode == \"Edit\")\r\n\t\t\t{\r\n\t\t\t\tstring newAccountNumber;\r\n\t\t\t\tnewAccountNumber = cbxAccNumber.Text;\r\n\r\n\t\t\t\tif ( !checkIfUnique(newAccountNumber) )\r\n\t\t\t\t{\r\n\t\t\t\t\tMessageBox.Show(\"Account Number already exists!\");\r\n\t\t\t\t\tcbxAccNumber.Focus();\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tint index = cbxAccNumber.Items.IndexOf(AccNumber);\r\n\t\t\t\tcbxAccNumber.Items.RemoveAt(index);\r\n\t\t\t\tcbxAccNumber.Items.Insert(index, cbxAccNumber.Text);\r\n\t\t\t\tmyDs.Tables[\"dtBankAccounts\"].Rows[currentRow][\"AccountNumber\"] = cbxAccNumber.Text;\r\n\t\t\t\tmyDs.Tables[\"dtBankAccounts\"].Rows[currentRow][\"CustomerName\"] = tbxName.Text;\r\n\t\t\t\tmyDs.Tables[\"dtBankAccounts\"].Rows[currentRow][\"AccountBalance\"] = double.Parse(tbxBalance.Text);\r\n\t\t\t\toleDbDataAdapter1.Update(myDs,\"dtBankAccounts\");\r\n\t\t\t\tMessageBox.Show(\"Record Updated\");\r\n\t\t\t}\r\n\r\n\t\t\tcurrentRow = 0;\r\n\t\t\tlockControls();\r\n\t\t\tshowData();\r\n\r\n\t\t\tbtnNew.Enabled = true;\r\n\t\t\tbtnEdit.Enabled = true;\r\n\t\t\tbtnDelete.Enabled = true;\r\n\t\t\tbtnFirst.Enabled = true;\r\n\t\t\tbtnLast.Enabled = true;\r\n\t\t\tbtnPrevious.Enabled = true;\r\n\t\t\tbtnNext.Enabled = true;\r\n\r\n\t\t\tbtnNext.Focus();\r\n\t\t}\r\n\r\n\t\tprivate void btnEdit_Click(object source, System.EventArgs e)\r\n\t\t{\r\n\t\t\tcurrentRow = cbxAccNumber.SelectedIndex;\r\n\t\t\topMode = \"Edit\";\r\n\t\t\tunlockControls();\r\n\r\n\t\t\tbtnCancel.Enabled = true;\r\n\t\t\tbtnUpdate.Enabled = true;\r\n\r\n\t\t\tbtnNew.Enabled = false;\r\n\t\t\tbtnEdit.Enabled = false;\r\n\t\t\tbtnDelete.Enabled = false;\r\n\t\t\tbtnFirst.Enabled = false;\r\n\t\t\tbtnLast.Enabled = false;\r\n\t\t\tbtnPrevious.Enabled = false;\r\n\t\t\tbtnNext.Enabled = false;\r\n\t\t\t\r\n\t\t\tAccNumber = cbxAccNumber.Text;\r\n\t\t\tcbxAccNumber.Focus();\r\n\t\t}\r\n\r\n\t\tprivate void btnNew_Click(object source, System.EventArgs e)\r\n\t\t{\r\n\t\t\topMode = \"New\";\r\n\t\t\tunlockControls();\r\n\t\t\t\r\n\t\t\tcbxAccNumber.Text = \"\";\r\n\t\t\ttbxName.Text = \"\";\r\n\t\t\ttbxBalance.Text = \"\";\r\n\r\n\t\t\tbtnCancel.Enabled = true;\r\n\t\t\tbtnUpdate.Enabled = true;\r\n\r\n\t\t\tbtnNew.Enabled = false;\r\n\t\t\tbtnEdit.Enabled = false;\r\n\t\t\tbtnDelete.Enabled = false;\r\n\t\t\tbtnFirst.Enabled = false;\r\n\t\t\tbtnLast.Enabled = false;\r\n\t\t\tbtnPrevious.Enabled = false;\r\n\t\t\tbtnNext.Enabled = false;\r\n\r\n\t\t\tlblDisplay.Text = \"\";\r\n\t\t\r\n\t\t\tcbxAccNumber.Focus();\r\n\t\t}\r\n\r\n\t\tprivate void btnCancel_Click(object source, System.EventArgs e)\r\n\t\t{\r\n\t\t\tlockControls();\r\n\t\t\tshowData();\r\n\r\n\t\t\tbtnNew.Enabled = true;\r\n\t\t\tbtnEdit.Enabled = true;\r\n\t\t\tbtnDelete.Enabled = true;\r\n\t\t\tbtnFirst.Enabled = true;\r\n\t\t\tbtnLast.Enabled = true;\r\n\t\t\tbtnPrevious.Enabled = true;\r\n\t\t\tbtnNext.Enabled = true;\r\n\r\n\t\t\tbtnNext.Focus();\r\n\t\t}\r\n\r\n\t\tprivate void btnDelete_Click(object source, System.EventArgs e)\r\n\t\t{\r\n\t\t\tint index = cbxAccNumber.SelectedIndex;\r\n            myDs.Tables[\"dtBankAccounts\"].Rows[index].Delete();\r\n\t\t\toleDbDataAdapter1.Update(myDs,\"dtBankAccounts\");\r\n\t\t\tcbxAccNumber.Items.RemoveAt(index);\r\n\t\t\tcurrentRow = 0;\r\n\t\t\tshowData();\r\n\t\t\tMessageBox.Show(\"Record successfully deleted!\");\r\n\t\t}\r\n\r\n\t\tprivate void cbxAccNumber_Changed(object source, System.EventArgs e)\r\n\t\t{\r\n\t\t\tif (opMode == \"New\" || opMode == \"Edit\")\r\n\t\t\t{\r\n\t\t\t\tMessageBox.Show(\"You cannot select an Account Number in this mode!\");\r\n\t\t\t\tcbxAccNumber.Focus();\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tcurrentRow = cbxAccNumber.SelectedIndex;\r\n\t\t\t\tshowData();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tprivate bool checkIfUnique(string newAccountNumber)\r\n\t\t{\r\n\t\t\tstring oldAccountNumber;\r\n\t\t\tforeach ( DataRow r in myDs.Tables[\"dtBankAccounts\"].Rows )\r\n\t\t\t{\r\n\t\t\t\toldAccountNumber = (string) r[\"AccountNumber\"];\r\n\t\t\t\tif ( newAccountNumber == oldAccountNumber )\r\n\t\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n}","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["ADO.Net","Add, Change, Delete"]},{"RecordId":"651","Title":"XML Sample","Description":"Demonstrates how to read an XML string and process nested elements","Code":"-----------------------------------------------------------------------------------\r\nConsider the following XML string\r\n-----------------------------------------------------------------------------------\r\n<Aggregations>\r\n\t<Aggregation ID=\"Site1\">\r\n\t\t<SiteURL>http://blah1/blah1</SiteURL>\r\n\t\t<TargetList>TargetListName1</TargetList>\r\n\t\t<SourceLists>\r\n\t\t\t<SourceList>SourceList1a</SourceList>\r\n\t\t\t<SourceList>SourceList2a</SourceList>\r\n\t\t\t<SourceList>SourceList3a</SourceList>\r\n\t\t\t<SourceList>SourceList4a</SourceList>\r\n\t\t</SourceLists>\r\n\t</Aggregation>\r\n\t<Aggregation ID=\"Site2\">\r\n\t\t<SiteURL>http://blah2/blah2</SiteURL>\r\n\t\t<TargetList>TargetListName2</TargetList>\r\n\t\t<SourceLists>\r\n\t\t\t<SourceList>SourceList1b</SourceList>\r\n\t\t\t<SourceList>SourceList2b</SourceList>\r\n\t\t\t<SourceList>SourceList3b</SourceList>\r\n\t\t\t<SourceList>SourceList4b</SourceList>\r\n\t\t</SourceLists>\r\n\t</Aggregation>\r\n</Aggregations>\r\n\r\n-----------------------------------------------------------------------------------\r\nIt can be processed as follows\r\n-----------------------------------------------------------------------------------\r\n\r\nstring strSite;\r\nstring strTargetList;\r\nstring strSourceLists;\r\nstring strSiteID;\r\n\r\nstring strXML = @\"<Aggregations><Aggregation ID=\"\"Site1\"\"><SiteURL>http://blah1/blah1</SiteURL><TargetList>TargetListName1</TargetList><SourceLists><SourceList>SourceList1a</SourceList><SourceList>SourceList2a</SourceList><SourceList>SourceList3a</SourceList><SourceList>SourceList4a</SourceList></SourceLists></Aggregation><Aggregation ID=\"\"Site2\"\"><SiteURL>http://blah2/blah2</SiteURL><TargetList>TargetListName2</TargetList><SourceLists><SourceList>SourceList1b</SourceList><SourceList>SourceList2b</SourceList><SourceList>SourceList3b</SourceList><SourceList>SourceList4b</SourceList></SourceLists></Aggregation></Aggregations>\";\t\t\r\n\r\n// Load the xml\r\nXmlDocument oXMLDoc = new XmlDocument();\r\noXMLDoc.LoadXml(strXML);\r\n\r\n// Get the Aggregations\r\nXmlNodeList oNodeList = oXMLDoc.SelectNodes(\"//Aggregation\");\r\nfor (int i = 0; i < oNodeList.Count; i++) {\r\n\r\n\t// Get the ID attribute\r\n\tstrSiteID = oNodeList.Item(i).Attributes[\"ID\"].Value.ToString();\r\n\r\n\t// Get the site url\r\n\tXmlNode oNode = oNodeList.Item(i).SelectSingleNode(\"SiteURL\");\r\n\tstrSite = oNode.InnerText;\r\n\r\n\t// Get the target list\r\n\toNode = oNodeList.Item(i).SelectSingleNode(\"TargetList\");\r\n\tstrTargetList = oNode.InnerText;\r\n\r\n\t// Get the source lists\r\n\tXmlNodeList oNodeListSources = oNodeList.Item(i).SelectNodes(\"SourceLists/SourceList\");\r\n\tstrSourceLists = \"\";\r\n\tfor (int j = 0; j < oNodeListSources.Count; j++) {\r\n\t\tstrSourceLists += oNodeListSources.Item(j).InnerText + \";\";\r\n\t}\r\n}","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["XML"]},{"RecordId":"652","Title":"XSL Transformations in .Net","Description":"3 examples of how do perform XSL transformations in .Net","Code":"//----------------------------------------------------------------------------------\r\n//  Perform XSL transformation and output to the console\r\n//----------------------------------------------------------------------------------\r\n\r\n// Create the XslTransform and load the stylesheet\r\nSystem.Xml.Xsl.XslTransform xslt = new System.Xml.Xsl.XslTransform();\r\nxslt.Load(\"numbers.xsl\");\r\n\r\n// Load the XML data file\r\nSystem.Xml.XPath.XPathDocument doc = new System.Xml.XPath.XPathDocument(\"numbers.xml\");\r\n\r\n// Create the XmlTextWriter to output to the console.\r\nSystem.Xml.XmlTextWriter writer = new System.Xml.XmlTextWriter(System.Console.Out);\r\n\r\n// Transform the file.\r\nxslt.Transform(doc, null, writer);\r\n\r\n// Be careful when using the console, closing it will not allow you to write any additional information to it\r\nwriter.Close();\r\n\r\n\r\n\r\n\r\n//----------------------------------------------------------------------------------\r\n//  Perform XSL transformation and output to a memory stream\r\n//----------------------------------------------------------------------------------\r\n\r\n// Create the XslTransform and load the stylesheet\r\nSystem.Xml.Xsl.XslTransform xslt = new System.Xml.Xsl.XslTransform();\r\nxslt.Load(\"numbers.xsl\");\r\n\r\n// Load the XML data file\r\nSystem.Xml.XPath.XPathDocument doc = new System.Xml.XPath.XPathDocument(\"numbers.xml\");\r\n\r\n// Create the Stream to place the output.\r\nSystem.IO.Stream str = new System.IO.MemoryStream();\r\n\r\n// Transform the file.\r\nxslt.Transform(doc, null, str);\r\n\r\n// Remember to Flush the Stream and set the position to 0\r\nstr.Flush();\r\nstr.Position = 0;\r\n\r\n\r\n\r\n//----------------------------------------------------------------------------------\r\n//  Perform XSL transformation and pass parameters into the XSL document\r\n//----------------------------------------------------------------------------------\r\n\r\n// Load the XML into an XPathDocument\r\nSystem.Xml.XPath.XPathDocument xp = new System.Xml.XPath.XPathDocument(\"numbers.xml\");\r\n\r\n// Create a new XslTransform class and load the stylesheet\r\nSystem.Xml.Xsl.XslTransform trans = new System.Xml.Xsl.XslTransform();\r\ntrans.Load(\"numbersExtension.xsl\");\r\n\r\n// Create the XsltArgumentList class and add the parameter using AddParam\r\nSystem.Xml.Xsl.XsltArgumentList xslArg = new System.Xml.Xsl.XsltArgumentList();\r\nxslArg.AddParam(\"displayme\",\"\",\"Is this fun?\");\r\n\r\n// Create and add the extension object using AddExtensionObject\r\nSayHello hi = new SayHello();\r\nxslArg.AddExtensionObject(\"urn:SayHello\",hi);\r\n\r\n// Create the System.IO.Stream to place the output.\r\nSystem.IO.Stream str = new System.IO.MemoryStream();\r\n\r\n// Transform the file.\r\ntrans.Transform(xp, xslArg, str);\r\n\r\n// Flush the XmlWriter and set the position of the Stream to 0\r\nstr.Flush();\r\nstr.Position = 0;\r\n\r\n// Create a StreamReader to Read the Stream and Return the String\r\nSystem.IO.StreamReader sr = new System.IO.StreamReader(str);\r\nstring xmlOut = sr.ReadToEnd();\r\n\r\n// Close the StreamReader and the base Stream\r\nsr.Close();\r\n\r\n// Write the Results to the Console\r\nConsole.Write(xmlOut);\r\n\r\n// Extension Object to return Hello Name\r\npublic class SayHello\r\n{\r\n   public string HelloName(string name) {\r\n      return \"Hello \" + name;\r\n   }\r\n}\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["XSL Transformations","XML/XSL"]},{"RecordId":"653","Title":"Asc and Chr in C#","Description":"Demonstrates how to accomplish the Asc and Chr VB functions in C#","Code":"-----------------------------------------------\r\nAsc\r\n-----------------------------------------------\r\nVB\r\nDim asciiCode\r\nasciiCode = Asc(\"A\")\r\n\r\nC#\r\nByte[] myBytes = System.Text.Encoding.ASCII.GetBytes(\"A\");\r\nByte asciiCode = myBytes[0];\r\n\r\n \r\n-----------------------------------------------\r\nChr\r\n-----------------------------------------------\r\n\r\nVB\r\nDim myStr\r\nmyStr = Chr(99)\r\n\r\nC#\r\nByte[] myBytes2 = {99};\r\nstring myStr = System.Text.Encoding.ASCII.GetString(myBytes2);\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Asc","Chr"]},{"RecordId":"654","Title":"ADO.Net Examples","Description":"Examples of how to open connections, read data, and read XML using both the SQLServer and OleDB providers.  Shows how to open Jet database also.","Code":"----------------------------------------------------------------------------------------------------\r\nConnection Object\r\n----------------------------------------------------------------------------------------------------\r\n// Opening Connecting to SQL Server Database (Using SQL Server Provider)\r\nString connectString = \"server=localhost; uid=sa; pwd=; database=pubs\";\r\nSqlConnection myConn = new SqlConnection (connectString);\r\nmyConn.Open();\r\n\r\n// Opening Connecting to Jet Database (Using OleDB Provider)\r\nString connectString = \"Provider=Microsoft.Jet.OLEDB.4.0; Data Source=pubs.mdb\"\r\nOleDbConnection myConn = new OleDbConnection (connectString);\r\nmyConn.Open();\r\n\r\n// Opening Connecting to Jet Database when MDB is in a different folder (Using OleDB Provider)\r\nString connectString = \"Provider=Microsoft.Jet.OleDb.4.0; Data Source=\" + Server.MapPath (\"~/shared/data/dbtutor.mdb\");\r\nOleDbConnection myConn = new OleDbConnection (connectString);\r\nmyConn.Open();\r\n\r\n\r\n----------------------------------------------------------------------------------------------------\r\nCommand Object\r\n----------------------------------------------------------------------------------------------------\r\n// Creating the Command Object (Using SQL Server Provider)\r\nString query = \"SELECT * FROM Authors\";\r\nSqlCommand myCmd = new SqlCommand (query, myConn);\r\n\r\n// Creating the Command Object  (Using OleDB Provider)\r\nString query = \"SELECT * FROM Authors\";\r\nOleDbCommand myCmd = new OleDbCommand (query, myConn);\r\n \r\n\r\n----------------------------------------------------------------------------------------------------\r\nReading Data with DataReader\r\n----------------------------------------------------------------------------------------------------\r\n// Reading the Data with DataReader  (Using SQL Server Provider)\r\nSqlDataReader myReader = myCmd.ExecuteReader ();\r\n\r\nwhile (myReader.Read()) {\r\n   Response.Write (myReader[\"LastName\"] + \", \" + myReader[\"FirstName\"]);\r\n}\r\n\r\nmyReader.Close();\r\nmyConn.Close();\r\n\r\n\r\n// Reading the Data with DataReader (Using OleDB Provider)\r\nOleDbDataReader myReader = myCmd.ExecuteReader();\r\n\r\nwhile (myReader.Read()) {\r\n   Response.Write (myReader[\"LastName\"] + \", \" + myReader[\"FirstName\"]);\r\n}\r\n\r\nmyReader.Close();\r\nmyConn.Close();\r\n\r\n\r\n----------------------------------------------------------------------------------------------------\r\nReading Data with DataAdapter/DataSet\r\n----------------------------------------------------------------------------------------------------\r\n//Using DataAdapter instead of DataReader (Using SQL Server Provider)\r\nSqlConnection myConn = new SqlConnection (\r\n   \"server=(local)\\\\NetSDK; trusted_connection=yes; database=northwind\");\r\n\r\nSqlDataAdapter myCmd = new SqlDataAdapter (\r\n   \"select * from customers\", myConn);\r\n\r\nDataSet myData = new DataSet();\r\n\r\nmyCmd.Fill (myData, \"Customers\");\r\n\r\nforeach (DataTable table in myData.Tables) {\r\n   foreach (DataRow row in table.Rows) {\r\n      foreach (DataColumn col in table.Columns) {\r\n         Response.Write (row[col].ToString());\r\n      }\r\n   }\r\n}\r\n\r\n\r\n//Using DataAdapter/DataSet instead of DataReader (Using OleDB Provider)\r\nOleDbConnection myConn = new OleDbConnection (\r\n   \"Provider=Microsoft.Jet.OleDb.4.0; Data Source=\" + \r\n   Server.MapPath (\"~/shared/data/dbtutor.mdb\"));\r\n\r\nOleDbDataAdapter myCmd = new OleDbDataAdapter (\r\n   \"select * from Products\", myConn);\r\n\r\nDataSet myData = new DataSet();\r\n\r\nmyCmd.Fill (myData, \"Products\");\r\n\r\nforeach (DataTable table in myData.Tables) {\r\n   foreach (DataRow row in table.Rows) {\r\n      foreach (DataColumn col in table.Columns) {\r\n         Response.Write (row[col].ToString());\r\n      }\r\n   }\r\n}\r\n\r\n\r\n----------------------------------------------------------------------------------------------------\r\nUsing DataSet to Read XML File\r\n----------------------------------------------------------------------------------------------------\r\nDataSet myData = new DataSet();\r\nmyData.ReadXml (Server.MapPath (\"~/adonet/demos/authors.xml\"));\r\n\r\nforeach (DataTable table in myData.Tables) {\r\n   foreach (DataRow row in table.Rows) {\r\n      foreach (DataColumn col in table.Columns) {\r\n         Response.Write (row[col].ToString());\r\n      }\r\n   }\r\n}\r\n","Declares":"","CodeCategory":{"CategoryId":"21","CategoryDescription":".Net - ADO.Net"},"Keywords":["ADO.Net","Read XML","Jet"]},{"RecordId":"655","Title":"Credit Card Validation","Description":"Explanation of Luhn's Formula and Credit Card numbering schemes.","Code":"Luhn's Formula\r\nLuhn's formula is used to validate card numbers. It can be used to check against a number of cards, including the following:\r\nMasterCard \r\nVISA \r\nAmerican Express \r\nDiners Club/Carte Blanche \r\nenRoute \r\nDiscover \r\nJCB \r\nSolo* \r\nSwitch* \r\n* These are UK only cards from my recollection, but have been tested by myself and work.\r\n\r\n\r\n------------------------------------------------------------------------------------------------------\r\nInformation on the history of the formula can be found on WebOpedia but so you don't have to read that here is a summary of how it is performed:\r\n\r\n1.\r\nDouble the value of alternating digits\r\nThe first step is to double each of the alternating digits in the number. But the trick is to start with the second digit from the right and work backwards. Say we have a credit card number 1234 5678 1234 5670. We'll start with the rightmost number 7, double it, and then do the same for every other digit. \r\n1234 5678 1234 5670\r\n\r\nThis will give us the following values.\r\n\r\n7 x 2 = 14\r\n5 x 2 = 10\r\n3 x 2 = 6\r\n.\r\n. \r\netc. \r\n\r\n\r\n2.\r\nAdd the separate digits of all the products\r\nNow we'll the separate digits of all the products, and come up with a final sum. \r\n(1 + 4) + (1 + 0) + 6 + 2 + (1 + 4) + (1 + 0) + 6 + 2 = 28\r\n\r\nBe sure to add the digits, not just the number.\r\n\r\n\r\n3.\r\nAdd the unaffected digits\r\nNow we'll go back to the original number and add all the digits that we didn't double. We'll still start from the right, but this time we'll start from the rightmost number. \r\n1234 5678 1234 5670\r\n0 + 6 + 4 + 2 + 8 + 6 + 4 + 2 = 32\r\n\r\n\r\n4.\r\nAdd the results and divide by 10 \r\nFinally, we'll add both the results and divide the answer by 10. \r\n\r\n28 + 32 = 60\r\n\r\n60 is evenly divided by 10, so the credit card number is well formed and ready for further processing.\r\n\r\n\r\n------------------------------------------------------------------------------------------------------\r\nCard Type Validation\r\nEach of the card types mentioned above can be tested for a given length based upon the numerical prefix. The prefixes and lengths are in the table below:\r\n\r\nCard Type \t\tPrefix \t\tNumber Length \r\nMasterCard \t\t51-55 \t\t16 \r\nVISA \t\t\t4 \t\t13 or 16 \r\nAmerican Express \t\t34 or 37 \t\t15 \r\nDiners Club/Carte Blanche \t300-305,36,38 \t14 \r\nenRoute \t\t\t2014,2149 \t15 \r\nDiscover \t\t\t6011 \t\t16 \r\nJCB \t\t\t3 \t\t16 \r\nJCB \t\t\t2131,1800 \t15 \r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"7","CategoryDescription":"Misc"},"Keywords":["Credit Card","Luhn"]},{"RecordId":"656","Title":"Cookies in ASP.Net","Description":"Demonstrates how to use single value and multiple value cookies in ASP.Net","Code":"Creating and Reading Cookies \r\n--------------------------------------------------------------------------------\r\n\r\nThe HttpCookie class defined in the System.Web namespace represents a browser cookie. The Cookies property of the Response and Request classes can be used to read all cookies as a HttpCookieCollection object, which represents a collection of cookies. Like other collection classes, the HttpCookieCollection class provides members to add, remove, and read cookies from the collection.\r\n\r\nYou can create a cookie by using the HttpCookie class by passing cookie name and its value as string values as first and second arguments. Or you can also use the Name and Value properties of HttpCookie to set the name and values of a cookie. The Expires property of the HttpCookie class makes a cookie persistent and sets a date when a cookie will expire.\r\n\r\nThe code listed in Listing 1 creates two cookies \"UID\" and \"PASS\". As you can see from this code, we add cookies to the collection by using the Response.Cookies.Add method.\r\n\r\nListing 1. Creating cookies\r\n\r\n' Create user id and password cookies\r\n    ' set their values and add to the collection\r\n    Dim cookie As HttpCookie = New HttpCookie(\"UID\")\r\n    cookie.Value = \"myid\"\r\n    cookie.Expires = #9/28/2002#\r\n    Response.Cookies.Add(cookie)\r\n    cookie = New HttpCookie(\"PASS\")\r\n    cookie.Value = \"mypass\"\r\n    cookie.Expires = #9/28/2002#\r\n Response.Cookies.Add(cookie)\r\n\r\nYou can read cookies using the Request.Cookies property. The code listed in Listing 2 reads the cookies from the browser and adds them to a ListBox control.\r\n\r\nListing 2. Reading cookies \r\n\r\n' Read cookies\r\nDim cookieCols As New HttpCookieCollection()\r\ncookieCols = Request.Cookies\r\nDim str As String\r\n' Read and add all cookies to the list box\r\nFor Each str In cookieCols\r\n   ListBox1.Items.Add(\"Cookie: \" + str)\r\n   ListBox1.Items.Add(\"Value:\" & Request.Cookies(str).Value)\r\nNext \r\n\r\nYou can use the Remove and Clear methods of HttpCookieCollection  to remove a particular cookie by name or all cookies respectively. The code listed in Listing 3 delete the cookies using the Remove method.\r\n\r\nListing 3. Deleting cookies \r\n\r\nDim cookieCols As New HttpCookieCollection()\r\ncookieCols = Request.Cookies\r\nDim str As String\r\n' Read and add all cookies to the list box\r\nRequest.Cookies.Remove(\"PASS\")\r\nRequest.Cookies.Remove(\"UID\")\r\n\r\nA cookie can also store multiple values. This type of cookies called cookie dictionaries. You use Values property to create and read this type of cookies. The code listed in Listing 4 creates a dictionary cookie.\r\n\r\nListing 4. Creating a dictionary cookie\r\n\r\nDim cookDict As HttpCookie = New HttpCookie(\"dict\")\r\ncookDict.Values(\"fname\") = \"first name\"\r\ncookDict.Values(\"lname\") = \"last name\"\r\ncookDict.Values(\"Address\") = \"address\"\r\nResponse.Cookies.Add(cookDict)\r\n","Declares":"","CodeCategory":{"CategoryId":"20","CategoryDescription":".Net - ASP.Net"},"Keywords":["Cookie"]},{"RecordId":"657","Title":"Global.asax","Description":"This article explains the ASP.NET application class, global.asax and using context in an application. \r\n","Code":"ASP.NET Application and Global.asax \r\n \r\nThis article explains the ASP.NET application class, global.asax and using context in an application. \r\n  \r\nThe HttpApplication Class \r\n--------------------------------------------------------------------------------\r\n\r\nThe HttpApplication is another important class that is use to control and manage the global scope of an application. The HttpApplication defines methods, properties, and events that are common to all application objects within an ASP.NET application. Only once instance of HttpApplication is created by the framework and can be used by applications. You dont create this class instance.\r\n\r\nIn this section, well see the HttpApplication class members briefly and well use them in the following sections as needed. The HttpApplication class properties are listed in Table 3.\r\n\r\nTable 3. The HttpApplication class properties\r\n\r\nProperty             Description \r\nApplication         Get the application state. Weve discussed in previous section\r\nContext              Gets the HttpContext for the current instance of the application.\r\nModules             Get the collection of modules of an application in the form of an \r\n                             HttpModuleCollection, which represents a collection of IhttpModule objects.\r\nRequest              Gets the request object\r\nResponse           Gets the response object\r\nServer                 Gets the server object \r\nSession               Gets the session object \r\nUser                    Gets the user object \r\n\r\nNormally the HttpApplication events are listed in Global.asax file, which well discuss in the following section.\r\n\r\nUsing the Global.asax \r\n--------------------------------------------------------------------------------\r\n\r\nGlobal.asax file is one more well discuss in this chapter. Whenever you create a new project, VS.NET creates the Global.asax file. You can find this file in the root of an application. Actually its an optional file and contains application level events raised by ASP.NET or by HTTP modules.\r\n\r\nThe default events available in this file are listed in Table 4.\r\n\r\nTable 4. The Global.asax events\r\n\r\nEvent                                             Description \r\nApplication_Start                            Occurs when an application starts. This event occurs only\r\n                                                       one time in an applications life cycle. It occurs again when\r\n                                                       you restart the application. Its the best place to count \r\n                                                       number of visitors.\r\nSession_Start                                 Occurs whenever a new session starts. This is the best\r\n                                                       place to count user sessions for an application.\r\nApplication_BeginRequest             Occurs every time when server makes a request. This \r\n                                                       event may occur multiple times in an applications life cycle.\r\nApplication_AuthenticateRequest  Occurs before a user is being authenticated.\r\nApplication_Error                            Occurs when an unhandled error or exception occurs in an\r\n                                                       application.\r\nSession_End                                   Occurs when a session ends. \r\nApplication_End                              Occurs when an application closes. \r\nUser                                                Gets the user object \r\n\r\nThe default Global.asax of an application added by VS.NET is listed in Listing 1.\r\n\r\nListing 1. The Global.asax file contents\r\n\r\nImports System.Web\r\nImports System.Web.SessionState  \r\n\r\nPublic Class Global\r\n    Inherits System.Web.HttpApplication  \r\n\r\n#Region \" Component Designer Generated Code \"\r\n#End Region  \r\n\r\n  Sub Application_Start(ByVal sender As Object, _\r\n  ByVal e As EventArgs)\r\n    ' Fires when the application is started\r\n  End Sub  \r\n\r\n  Sub Session_Start(ByVal sender As Object, _\r\n  ByVal e As EventArgs)\r\n    ' Fires when the session is started\r\n  End Sub  \r\n\r\n  Sub Application_BeginRequest(ByVal sender As Object, _\r\n  ByVal e As EventArgs)\r\n    ' Fires at the beginning of each request\r\n  End Sub  \r\n\r\n  Sub Application_AuthenticateRequest( _\r\n  ByVal sender As Object, ByVal e As EventArgs)\r\n    ' Fires upon attempting to authenticate the use\r\n  End Sub  \r\n\r\n  Sub Application_Error(ByVal sender As Object, _\r\n  ByVal e As EventArgs)\r\n    ' Fires when an error occurs\r\n  End Sub  \r\n\r\n  Sub Session_End(ByVal sender As Object, _\r\n  ByVal e As EventArgs)\r\n    ' Fires when the session ends\r\n  End Sub  \r\n\r\n  Sub Application_End(ByVal sender As Object, _\r\n  ByVal e As EventArgs)\r\n    ' Fires when the application ends\r\n  End Sub \r\n\r\nEnd Class\r\n\r\nUsing Context in an Application \r\n--------------------------------------------------------------------------------\r\n\r\nBy default there is no reference of Response, Request, and Page in Global.asax. The Context object is used to get the reference of these objects in the Global.asax file.\r\n\r\nThe code listed in Listing 2 shows how to calculate users and user sessions in an application. As you can see from this code, weve used Context to get a Response object. If you dont use Context, youll get compiler errors.\r\n\r\nListing 2. Using Application_Start and Session_Start events\r\n\r\nSub Application_Start(ByVal sender As Object, _\r\n  ByVal e As EventArgs)\r\n    ' Fires when the application is started\r\n    Application(\"Title\") = \"Job Board\"\r\n    Application.Lock()\r\n    Application(\"Users\") += 1\r\n    Application.UnLock()\r\n    Context.Response.Write(Application(\"Users\"))\r\n  End Sub  \r\n\r\n  Sub Session_Start(ByVal sender As Object, _\r\n  ByVal e As EventArgs)\r\n    ' Fires when the session is started\r\n    Application.Lock()\r\n    Application(\"SessionCounter\") += 1\r\n    Application.UnLock()\r\n    Context.Response.Write(Application(\"SessionCounter\"))\r\nEnd Sub \r\n \r\n","Declares":"","CodeCategory":{"CategoryId":"20","CategoryDescription":".Net - ASP.Net"},"Keywords":["global.asax"]},{"RecordId":"658","Title":"HTTP Modules (Like iFilters)","Description":"HTTP skeleton code to tap into the ASP.Net pipeline and override certain phases of the request.","Code":"HTTP Modules\r\n\r\nHttp Modules allow you to extend the existing ASP.NET pipeline.  The most common use of HTTPModules is pre and/or postprecessing of requests.  Internally ASP.NET utilizes custom modules (httpmodules) for output caching, authentication and authorization etc.  Therefore, if you ever need to tap into the pipleline to alter the request in any way, look into HttpModules as they provide a relatively easy way for you to do just that (similiar to how ISAPI filters helped achieve pre/post processing capabilities).  \r\n\r\nTo develop an HttpModule you are required to do the following:\r\n\r\nYour class must implement the iHttpModule Interface.  Both the Init(..) and Dispose() methods must be in your class definitions\r\n\r\nBelow is a simple example that outputs \"HttpModule says Hello!\" to each and every request.  You will notice that I wired an event in the Init(..) method that calls OnBeginRequest at the beginning of every request.\r\n\r\nusing System;\r\nusing System.Web;\r\nnamespace CSharpFriends.Samples\r\n{\r\n public class CSharpFriendsHttpModule : IHttpModule \r\n {\r\n  public CSharpFriendsHttpModule()\r\n  {\r\n  }\r\n  /// \r\n  /// Required by the interface IHttpModule\r\n  /// \r\n  public void Dispose() \r\n  {\r\n  }\r\n  /// \r\n  /// Required by the interface IHttpModule\r\n  /// I also wire up the Begin Request event.\r\n  /// \r\n  public void Init(System.Web.HttpApplication Appl) \r\n  {\r\n   Appl.BeginRequest += new System.EventHandler(OnBeginRequest);\r\n  }\r\n  public void OnBeginRequest(object sender, EventArgs e)\r\n  {\r\n   HttpApplication app = (HttpApplication)sender;\r\n   app.Context.Response.Write(\"HttpModule says Hello!\");\r\n   \r\n  }\r\n \r\n }\r\n}\r\n \r\n\r\nIn your web.config, add the following elements:\r\n<httpModules>\r\n   <add type=\"CSharpFriends.Samples.CSharpFriendsHttpModule,Test\"\r\n            name=\"CSharpFriendsHttpModule\" />\r\n</httpModules>\r\n \r\n\r\n\r\nBelow is a table that lists all the events that are available to the HttpModule developer to tap into the pipeline at various stages of the request.\r\n\r\nAcquireRequestState\r\n When ASP.NET acquires the current state (for example, session state) associated with the current request\r\n \r\nAuthenticateRequest\r\n When a security module has established the identity of the user\r\n \r\nAuthorizeRequest\r\n When a security module has verified user authorization\r\n \r\nBeginRequest\r\n When the first event in the HTTP pipeline chain of execution responds to a request\r\n \r\nDisposed\r\n When ASP.NET completes the chain of execution when responding to a request\r\n \r\nEndRequest\r\n When the last event in the HTTP pipeline chain of execution responds to a request\r\n \r\nError\r\n When an unhandled exception is thrown\r\n \r\nPostRequestHandlerExecute\r\n When the ASP.NET handler (page, XML Web Service) finishes execution\r\n \r\nPreRequestHandlerExecute\r\n Just before ASP.NET begins executing a handler such as a page or XML Web Service\r\n \r\nPreSendRequestContent\r\n Just before ASP.NET sends content to the client\r\n \r\nPreSendRequestHeaders\r\n Just before ASP.NET sends HTTP headers to the client\r\n \r\nReleaseRequestState\r\n After ASP.NET finishes executing all request handlers; also causes state modules to save the current state data\r\n \r\nResolveRequestCache\r\n When ASP.NET completes an authorization event to let the caching modules serve requests from the cache, bypassing execution of the handler (the page or XML Web Service, for example)\r\n \r\nUpdateRequestCache\r\n When ASP.NET finishes executing a handler in order to let caching modules store responses that will be used to serve subsequent requests from the cache","Declares":"","CodeCategory":{"CategoryId":"20","CategoryDescription":".Net - ASP.Net"},"Keywords":["HTTP Modules","iFilter"]},{"RecordId":"659","Title":"Environment Variables and Drive Information","Description":"Demonstrates how to retrieve environment variables and local drive information in C#","Code":"using System; \r\n\r\nclass EnvironmentClass \r\n{\r\n      static void Main(string[] args)\r\n      {\r\n            //Getting machine and user information\r\n            Console.WriteLine(\"Machine Information\");\r\n            Console.WriteLine(\"======================\");\r\n            Console.WriteLine(\"Machine Name: \"+ Environment.MachineName);\r\n            Console.WriteLine(\"OS Version: \"+ Environment.OSVersion);\r\n            Console.WriteLine(\"System Directory: \"+ Environment.SystemDirectory);\r\n            Console.WriteLine(\"User Name: \"+ Environment.UserName);\r\n            Console.WriteLine(\"Version: \"+ Environment.Version);\r\n            Console.WriteLine(\"Current Directory: \"+ Environment.CurrentDirectory);\r\n            Console.WriteLine();            \r\n\r\n            // Get all logical hard drives            \r\n            string[] drives = Environment.GetLogicalDrives();\r\n            Console.WriteLine(\"======================\");\r\n            Console.WriteLine(\"Available drives:\");\r\n            foreach(string drive in drives) \r\n            {\r\n                  Console.WriteLine(drive);\r\n            }\r\n            Console.ReadLine();\r\n\r\n      }\r\n}","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Environment Variables","Drive Information"]},{"RecordId":"660","Title":"Installing a Service Programmatically","Description":"Demonstrates how to programmatically install a service in C#","Code":"With the arrival of .Net, creation of a windows service has become a piece of cake by just selecting Windows Service as project type in the New Project Dialog Box. For installing a service, .Net provides a utility called installutil.exe which installs the service and registers it with Service Control Manager(SCM).\r\n\r\nAt times, there is a need to install the service programmatically (for example as a part of your custom installer program where you don't want your user to manually install the service using installutil).\r\n\r\nThe following piece of code shows how to install/uninstall a given service and register it with SCM calling appropriate APIs using P/Invoke in C#.  The sample code shows that installing a service programmatically is as simple, if not simpler, than using installutil and gives you far more flexibility.\r\n\r\n \r\nSERVICEINSTALLER.CS\r\n \r\nusing System;\r\nusing System.Runtime.InteropServices;\r\n \r\nnamespace SvcInstaller\r\n{\r\n /// <summary>\r\n /// Summary description for ServiceInstaller.\r\n /// </summary>\r\n class ServiceInstaller\r\n {\r\n  #region Private Variables\r\n  \r\n  private string _servicePath;\r\n  private string _serviceName;\r\n  private string _serviceDisplayName;\r\n \r\n  #endregion Private Variables\r\n \r\n  #region DLLImport\r\n  \r\n  [DllImport(\"advapi32.dll\")]\r\n  public static extern IntPtr OpenSCManager(string lpMachineName,string lpSCDB, int scParameter);\r\n  [DllImport(\"Advapi32.dll\")]\r\n  public static extern IntPtr CreateService(IntPtr SC_HANDLE,string lpSvcName,string lpDisplayName, \r\n int dwDesiredAccess,int dwServiceType,int dwStartType,int dwErrorControl,string lpPathName, \r\nstring lpLoadOrderGroup,int lpdwTagId,string lpDependencies,string lpServiceStartName,string lpPassword);\r\n  [DllImport(\"advapi32.dll\")]\r\n  public static extern void CloseServiceHandle(IntPtr SCHANDLE);\r\n  [DllImport(\"advapi32.dll\")]\r\n  public static extern int StartService(IntPtr SVHANDLE,int dwNumServiceArgs,string lpServiceArgVectors);\r\n  \r\n  [DllImport(\"advapi32.dll\",SetLastError=true)]\r\n  public static extern IntPtr OpenService(IntPtr SCHANDLE,string lpSvcName,int dwNumServiceArgs);\r\n  [DllImport(\"advapi32.dll\")]\r\n  public static extern int DeleteService(IntPtr SVHANDLE);\r\n \r\n  [DllImport(\"kernel32.dll\")]\r\n  public static extern int GetLastError();\r\n  \r\n  #endregion DLLImport\r\n \r\n  \r\n  /// <summary>\r\n  /// The main entry point for the application.\r\n  /// </summary>\r\n  #region Main method + testing code \r\n   [STAThread]\r\n   static void Main(string[] args)\r\n   {\r\n     \r\n     // TODO: Add code to start application here\r\n     \r\n    \r\n    #region Testing\r\n    //  Testing --------------\r\n     string svcPath;\r\n     string svcName;\r\n     string svcDispName;\r\n     \r\n     //path to the service that you want to install\r\n     svcPath = @\"C:\\build\\service\\Debug\\Service.exe\";\r\n     svcDispName=\"Service Display Name\";\r\n     svcName= \"Service Name\";\r\n  \r\n     ServiceInstaller c = new ServiceInstaller();\r\n     c.InstallService(svcPath, svcName, svcDispName);\r\n  \r\n     Console.Read();\r\n       Testing --------------\r\n    #endregion Testing\r\n   }\r\n  #endregion Main method + testing code - Commented\r\n \r\n\r\n  \r\n  /// <summary>\r\n  /// This method installs and runs the service in the service conrol manager.\r\n  /// </summary>\r\n  /// <param name=\"svcPath\">The complete path of the service.</param>\r\n  /// <param name=\"svcName\">Name of the service.</param>\r\n  /// <param name=\"svcDispName\">Display name of the service.</param>\r\n  /// <returns>True if the process went thro successfully. False if there was any error.</returns>\r\n  public bool InstallService(string svcPath, string svcName, string svcDispName)\r\n  {\r\n   #region Constants declaration.\r\n   int SC_MANAGER_CREATE_SERVICE = 0x0002;\r\n   int SERVICE_WIN32_OWN_PROCESS = 0x00000010;\r\n   //int SERVICE_DEMAND_START = 0x00000003;\r\n   int SERVICE_ERROR_NORMAL = 0x00000001;\r\n \r\n   int STANDARD_RIGHTS_REQUIRED = 0xF0000;\r\n   int SERVICE_QUERY_CONFIG       =    0x0001;\r\n   int SERVICE_CHANGE_CONFIG       =   0x0002;\r\n   int SERVICE_QUERY_STATUS           =  0x0004;\r\n   int SERVICE_ENUMERATE_DEPENDENTS   = 0x0008;\r\n   int SERVICE_START                  =0x0010;\r\n   int SERVICE_STOP                   =0x0020;\r\n   int SERVICE_PAUSE_CONTINUE         =0x0040;\r\n   int SERVICE_INTERROGATE            =0x0080;\r\n   int SERVICE_USER_DEFINED_CONTROL   =0x0100;\r\n \r\n   int SERVICE_ALL_ACCESS             =  (STANDARD_RIGHTS_REQUIRED     | \r\n        SERVICE_QUERY_CONFIG         |\r\n        SERVICE_CHANGE_CONFIG        |\r\n        SERVICE_QUERY_STATUS         | \r\n        SERVICE_ENUMERATE_DEPENDENTS | \r\n        SERVICE_START                | \r\n        SERVICE_STOP                 | \r\n        SERVICE_PAUSE_CONTINUE       | \r\n        SERVICE_INTERROGATE          | \r\n        SERVICE_USER_DEFINED_CONTROL);\r\n   int SERVICE_AUTO_START = 0x00000002;\r\n   #endregion Constants declaration.\r\n \r\n   try\r\n   {\r\n    IntPtr  sc_handle = OpenSCManager(null,null,SC_MANAGER_CREATE_SERVICE);\r\n \r\n    if (sc_handle.ToInt32() != 0)\r\n    {\r\n     IntPtr sv_handle = CreateService(sc_handle,svcName,svcDispName,SERVICE_ALL_ACCESS,SERVICE_WIN32_OWN_PROCESS, SERVICE_AUTO_START,SERVICE_ERROR_NORMAL,svcPath,null,0,null,null,null);\r\n \r\n     if(sv_handle.ToInt32() ==0)\r\n     {\r\n \r\n      CloseServiceHandle(sc_handle);\r\n      return false;\r\n     }\r\n     else\r\n     {\r\n      //now trying to start the service\r\n      int i = StartService(sv_handle,0,null);\r\n      // If the value i is zero, then there was an error starting the service.\r\n      // note: error may arise if the service is already running or some other problem.\r\n      if(i==0)\r\n      {\r\n       //Console.WriteLine(\"Couldnt start service\");\r\n       return false;\r\n      }\r\n      //Console.WriteLine(\"Success\");\r\n      CloseServiceHandle(sc_handle);\r\n      return true;\r\n     }\r\n    }\r\n    else\r\n     //Console.WriteLine(\"SCM not opened successfully\");\r\n     return false;\r\n \r\n   }\r\n   catch(Exception e)\r\n   {\r\n    throw e;\r\n   }\r\n  }\r\n \r\n  \r\n  /// <summary>\r\n  /// This method uninstalls the service from the service conrol manager.\r\n  /// </summary>\r\n  /// <param name=\"svcName\">Name of the service to uninstall.</param>\r\n  public bool UnInstallService(string svcName)\r\n  {\r\n   int GENERIC_WRITE = 0x40000000;\r\n   IntPtr sc_hndl = OpenSCManager(null,null,GENERIC_WRITE);\r\n \r\n   if(sc_hndl.ToInt32() !=0)\r\n   {\r\n    int DELETE = 0x10000;\r\n    IntPtr svc_hndl = OpenService(sc_hndl,svcName,DELETE);\r\n    //Console.WriteLine(svc_hndl.ToInt32());\r\n    if(svc_hndl.ToInt32() !=0)\r\n    { \r\n     int i = DeleteService(svc_hndl);\r\n     if (i != 0)\r\n     {\r\n      CloseServiceHandle(sc_hndl);\r\n      return true;\r\n     }\r\n     else\r\n     {\r\n      CloseServiceHandle(sc_hndl);\r\n      return false;\r\n     }\r\n    }\r\n    else\r\n     return false;\r\n   }\r\n   else\r\n    return false;\r\n  }\r\n }\r\n}\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Service"]},{"RecordId":"661","Title":"ASP.Net Modal Dialog","Description":"Shows how to pass info to and get info back from a modal dialog in .Net","Code":"//---------------------------------------------------------------------------\r\n//\tPart 1 of 2\r\n//\tCalling page\r\n//---------------------------------------------------------------------------\r\n\r\n<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.0 Transitional//EN\">\r\n<HTML>\r\n\t<HEAD>\r\n\t\t<title>Parent Webform</title>\r\n\t\t<script language=\"javascript\">\r\n\t\t\tfunction OpenChild() \r\n\t\t\t{\r\n\t\t\t\tvar ParmA = retvalA.value;\r\n\t\t\t\tvar ParmB = retvalB.value;\r\n\t\t\t\tvar ParmC = retvalC.value;\r\n\t\t\t\tvar MyArgs = new Array(ParmA, ParmB, ParmC);\r\n\t\t\t\tvar WinSettings = \"center:yes;resizable:no;dialogHeight:300px\"\r\n\t\t\t\t// ALTER BELOW LINE - supply correct URL for Child Form\r\n\t\t\t\tvar MyArgs = window.showModalDialog(\r\n\t\t\t              \"http://localhost/ModalWin/ChildWebForm.aspx\", \r\n\t\t\t                      MyArgs, WinSettings);\r\n\t\t\t\tif (MyArgs == null)\r\n\t\t\t\t{\r\n\t\t\t\t\twindow.alert(\"Nothing returned from child. No changes \r\n\t\t\t                  made to input boxes\")\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\tretvalA.value=MyArgs[0].toString();\r\n\t\t\t\t\tretvalB.value=MyArgs[1].toString();\r\n\t\t\t\t\tretvalC.value=MyArgs[2].toString();\r\n\t\t\t\t}\r\n}\r\n\t\t</script>\r\n\t</HEAD>\r\n\t<body>\r\n\t\t<P><INPUT id=\"retvalA\" type=\"text\" value=\"AAA\"></P>\r\n\t\t<P><INPUT id=\"retvalB\" type=\"text\" value=\"BBB\"></P>\r\n\t\t<P><INPUT id=\"retvalC\" type=\"text\" value=\"CCC\"></P>\r\n\t\t<P><BUTTON onclick=\"OpenChild()\" type=\"button\">Open Child \r\n                     Window\r\n                </BUTTON>\r\n\t\t</P>\r\n\t</body>\r\n</HTML>\r\n\r\n\r\n\r\n\r\n//---------------------------------------------------------------------------\r\n//\tPart 2 of 2\r\n//\tModal Dialog page\r\n//---------------------------------------------------------------------------\r\n\r\n<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.0 Transitional//EN\">\r\n<HTML>\r\n\t<HEAD>\r\n\t\t<TITLE>Child Webform</TITLE>\r\n\t\t<script language=\"javascript\">\r\n\t\t\tfunction Done() {\r\n\t\t\t\tvar ParmA = tbParamA.value;\r\n\t\t\t\tvar ParmB = tbParamB.value;\r\n\t\t\t\tvar ParmC = tbParamC.value;\r\n\t\t\t\tvar MyArgs = new Array(ParmA, ParmB, ParmC);\r\n\t\t\t\twindow.returnValue = MyArgs;\r\n\t\t\t\twindow.close();\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tfunction doInit() {\r\n\t\t\t\tvar ParmA = \"Aparm\";\r\n\t\t\t\tvar ParmB = \"Bparm\";\r\n\t\t\t\tvar ParmC = \"Cparm\";\r\n\t\t\t\tvar MyArgs = new Array(ParmA, ParmB, ParmC);\r\n\t\t\t\tMyArgs =  window.dialogArguments;\r\n\t\t\t\ttbParamA.value = MyArgs[0].toString();\r\n\t\t\t\ttbParamB.value = MyArgs[1].toString();\r\n\t\t\t\ttbParamC.value = MyArgs[2].toString();\r\n\t\t\t}\r\n\t\t</script>\r\n\t</HEAD>\r\n\t<BODY onload=\"doInit()\">\r\n\t\t<P>Param A:<INPUT id=\"tbParamA\" TYPE=\"text\"></P>\r\n\t\t<P>Param B:<INPUT ID=\"tbParamB\" TYPE=\"text\"></P>\r\n\t\t<P>Param C:<INPUT ID=\"tbParamC\" TYPE=\"text\"></P>\r\n\t\t<BUTTON onclick=\"Done()\" type=\"button\">OK</BUTTON>\r\n\t</BODY>\r\n</HTML>","Declares":"","CodeCategory":{"CategoryId":"20","CategoryDescription":".Net - ASP.Net"},"Keywords":["Modal Dialog"]},{"RecordId":"662","Title":"Caching Credentials in .Net","Description":"Uses CredentialCache to cache user's id and password so that user will not have to re-authenticate.","Code":"WebRequest wReg = new WebRequest(\"www.contoso.com\");\r\n\r\nCredentialCache myCache = new CredentialCache();\r\n\r\nmyCache.Add(new Uri(\"http://www.contoso.com/\"),\"Basic\",new NetworkCredential(UserName,SecurelyStoredPassword));\r\nmyCache.Add(new Uri(\"http://www.contoso.com/\"),\"Digest\", new NetworkCredential(UserName,SecurelyStoredPassword,Domain));\r\n\r\nwReq.Credentials = myCache;","Declares":"","CodeCategory":{"CategoryId":"20","CategoryDescription":".Net - ASP.Net"},"Keywords":["CredentialCache","Cache Credentials","Authorization"]},{"RecordId":"663","Title":"Simple Encryption/Decryption in C#","Description":"Simple encrypt/decrypt using C#.  Output is converted to printable characters.\r\nYou pass a \"magic number\" into the encrypt and decrypt function, making it a little more secure.","Code":"\t\tstrTemp = EncryptString(27,@\"usdev\\jtgamble|11/17/2003 12:59:00 PM|Y\");\r\n\t\tstrTemp = DecryptPassword(27,strTemp);\r\n\r\n\r\n\t\tprivate static string EncryptString(int Number, string DecryptedPassword) {\r\n\r\n\t\t\tstring Password = \"\";\r\n\t\t\tint Counter;\r\n\t\t\tint Temp;\r\n\r\n\t\t\tCounter = 0;\r\n\t\t\tfor (Counter = 0; Counter < DecryptedPassword.Length; Counter ++) {\r\n\t\t\t\tTemp = Convert.ToChar(DecryptedPassword.Substring(Counter, 1));\r\n\t\t\t\tif (Counter % 2 == 0) {\r\n\t\t\t\t\tTemp = Temp - Number;\r\n\t\t\t\t}else{\r\n\t\t\t\t\tTemp = Temp + Number;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tPassword += DecToHex(Temp.ToString());\r\n\t\t\t}\r\n\r\n\t\t\treturn Password;\r\n\t\t}\r\n\r\n\r\n\t\tprivate static string DecryptPassword(int Number, string EncryptedPassword) {\r\n\r\n\t\t\tstring Password = \"\";\r\n\t\t\tint Counter;\r\n\t\t\tint Temp ;\r\n\t\t\tint i = 0;\r\n\t\t\tfor (Counter = 0; Counter < EncryptedPassword.Length; Counter += 2 ) {\t\t\t\t\t\t\t\r\n\r\n\t\t\t\t//Temp = Convert.ToChar(EncryptedPassword.Substring(Counter, 1)) ^ (10 - Number);\r\n\t\t\t\tstring strT1 = EncryptedPassword.Substring(Counter,2);\r\n\t\t\t\tTemp = int.Parse(HexToDec(strT1));\r\n\t\t\t\tif (i % 2 == 0) {\r\n\t\t\t\t\tTemp = Temp + Number;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tTemp = Temp - Number;\r\n\t\t\t\t}\r\n\t\t\t\ti++;\r\n\r\n\t\t\t\tPassword += Convert.ToChar(Temp);\r\n\t\t\t}\r\n\r\n\t\t\treturn  Password;\r\n\r\n\t\t}\r\n\r\n\r\n\t\tprivate static string DecToHex(string strStringIn) {\r\n\r\n\t\t\tstring strTemp = \"\";\r\n\r\n\t\t\t// To hold our converted unsigned integer32 value\r\n\t\t\tuint uiDecimal = 0;\r\n\r\n\t\t\ttry {\r\n\t\t\t\t// Convert text string to unsigned integer\r\n\t\t\t\tuiDecimal = checked((uint)System.Convert.ToUInt32(strStringIn));\r\n\t\t\t}\r\n\r\n\t\t\tcatch (System.OverflowException exception) {\r\n\t\t\t\t// Show overflow message and return\r\n\t\t\t\tstrTemp = \"Overflow\";\r\n\t\t\t\treturn strTemp;\r\n\t\t\t}\r\n\r\n\t\t\t// Format unsigned integer value to hex and show in another textbox\r\n\t\t\tstrTemp = String.Format(\"{0:x2}\", uiDecimal);\r\n\t\t\treturn strTemp;\r\n\t\t}\r\n\r\n\t\tprivate static string HexToDec(string strStringIn) {\r\n\r\n\t\t\tstring strTemp = \"\";\r\n\t\t\t\r\n\t\t\t// To hold our converted unsigned integer32 value\r\n\t\t\tuint uiHex = 0;\r\n\r\n\t\t\ttry {\r\n\t\t\t\t// Convert hex string to unsigned integer\r\n\t\t\t\tuiHex = System.Convert.ToUInt32(strStringIn, 16);\r\n\t\t\t}\r\n\r\n\t\t\tcatch (System.OverflowException exception) {\r\n\t\t\t\t// Show overflow message and return\r\n\t\t\t\tstrTemp = \"Overflow\";\r\n\t\t\t\treturn strTemp;\r\n\t\t\t}\r\n\r\n\t\t\t// Format it and show as a string\r\n\t\t\tstrTemp = uiHex.ToString();\r\n\t\t\treturn strTemp;\r\n\t\t}\r\n\r\n\r\n\t}\r\n}\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Encryption","Decryption"]},{"RecordId":"664","Title":"Typed DataSets","Description":"Demonstrates how to create and use typed datasets in .Net","Code":"=====================================================================\r\nTraditional DataSet\r\n\r\n// Create a DataAdapter for each of the tables we're filling\r\nSqlDataAdapter daCustomers = new SqlDataAdapter(\"SELECT * FROM CUSTOMER;\", conn);\r\n\r\n// Create the Invoice DataAdapter\r\nSqlDataAdapter daInvoices = new SqlDataAdapter(\"SELECT * FROM INVOICE\", conn);\r\n\r\n// Create your blank DataSet\r\nDataSet dataSet = new DataSet();\r\n\r\n// Fill the DataSet with each DataAdapter\r\ndaCustomers.Fill(dataSet, \"Customers\");\r\ndaInvoices.Fill(dataSet, \"Invoices\");\r\n\r\n// Show the customer name\r\nConsole.WriteLine(dataSet.Tables[\"Customers\"].Rows[0][\"FirstName\"].ToString());\r\nConsole.WriteLine(dataSet.Tables[\"Customers\"].Rows[0][\"LastName\"].ToString());\r\nConsole.WriteLine(dataSet.Tables[\"Customers\"].Rows[0][\"HomePhone\"].ToString());\r\n\r\n// Change an invoice number with a string - This shouldn't work because InvoiceNumber expects an integer\r\ndataSet.Tables[\"Invoices\"].Rows[0][\"InvoiceNumber\"] = \"15234\";\r\n\r\n=====================================================================\r\n\r\nTyped DataSet\r\n\r\n// Create the Customer DataAdapter\r\nSqlDataAdapter customerAdapter = new SqlDataAdapter(\"SELECT * FROM CUSTOMER\", conn);\r\n\r\n// Create the Invoice DataAdapter\r\nSqlDataAdapter invoiceAdapter = new SqlDataAdapter(\"SELECT * FROM INVOICE\", conn);\r\n\r\n// Create the DataSet\r\nCustomerTDS typedDS = new CustomerIDS();\r\n\r\n// Use the DataAdapters to fill the DataSet\r\ncustomerAdapter.Fill(typedDS, \"Customer\");\r\ninvoiceAdapter.Fill(typedDS, \"Invoice\");\r\n\r\n// Show the address and # of invoices for each customer\r\nforeach(CustomerTDS.CustomerRow custRow in typedDS.Customer)\r\n{\r\n  Console.WriteLine(custRow.FullName);\r\n  Console.WriteLine(custRow.Address);\r\n  Console.WriteLine(\"{0}, {1}  {2}\", custRow.City, custRow.State, custRow.Zip);\r\n  Console.WriteLine(\"{0} (hm)\", custRow.IsHomePhoneNull() ? \"\" : custRow.HomePhone);\r\n  Console.WriteLine(\"{0} (bus)\", custRow.IsBusinessPhoneNull() ? \"\" : custRow.BusinessPhone);\r\n  Console.WriteLine(\"Invoices: \" + custRow.GetChildRows(\"CustomerInvoice\").Length);\r\n}\r\n\r\n====================================================================\r\n\r\n6.2.1  Using Visual Studio .NET to Create a Typed DataSet\r\n\r\nThis section will walk you through creating a Typed DataSet in Visual Studio. NET. To get started, please create a new Console C# project, as shown in Figure 6.3. Next, in the Solution Explorer add a new item, as shown in Figure 6.4.\r\n\r\nFigure 6.3: Creating a new C# project\r\n\r\nFigure 6.4: Adding a new item\r\n\r\nFrom the Data folder in the Local Project Items, select a new DataSet and name it ADONET.xsd, as shown in Figure 6.5. If you add an XML Schema file instead (they both are .XSD files), the Typed DataSet will not generate. Make sure it is a DataSet. When you finish, the IDE will look something like what is shown in Figure 6.6.\r\n\r\nFigure 6.5: Adding a DataSet\r\n\r\nFigure 6.6: A blank canvas\r\n\r\n\r\nYou probably have noticed already that the Typed DataSet has an extension of .xsd. This is because the source of a Typed DataSet is an XML Schema Document. What the IDE asks you to do is to create a new .XSD file that represents the schema of the DataSet. This will include the schema information we discussed in Chapter 5. The XSD can include table and column names as well as keys, relationships, and constraints.\r\n\r\nNow that you have a new Typed DataSet added to your project, you can use either the Server Explorer to add tables to the DataSet or the Toolbox to add elements to the DataSet. Using the Server Explorer to add tables is shown in Figure 6.7.\r\n\r\nFigure 6.7: The Server Explorer\r\n\r\n\r\nAfter you have the Server Explorer open to an existing database, you can simply drag and drop the tables you want onto the .XSD file, to produce something that looks like Figure 6.8.\r\n\r\nFigure 6.8: Tables in the .XSD file\r\n\r\n\r\nAt this point, the new Typed DataSet will include two tables, but the tables remain unrelated. Unfortunately Visual Studio .NET does not try to discern all the schema information that may be contained in the database. In order to set the schema information, you will need to add it to the XSD.\r\n\r\nWe will start by adding a relationship between the Customer and Invoice tables. To do this, drag a new Relation from the Toolbox onto the Customer table, as shown in Figure 6.9. Once you do that, the Edit Relation dialog box appears, as shown in Figure 6.10.\r\n\r\nFigure 6.9: Adding a relationship\r\n\r\nFigure 6.10: The Edit Relation dialog box\r\n\r\nThe Edit Relation dialog box is where you will provide the specifics of the relationship. You will need to change the child element to the child table (in this case Invoice). Usually the dialog box will correctly select the foreign key field(s). If necessary, you can change the way that the Update rule, Delete rule, and Accept/Reject rule settings affect cascading changes to the DataSet. After you make these changes you should see something similar to what is shown in Figure 6.11.\r\n\r\nFigure 6.11: The completed Edit Relation dialog box\r\n\r\n\r\nAfter you click OK, you will see the Relation, as shown in Figure 6.12.\r\n\r\nNow that we have our tables and the relationship set up, let's add an expression column to our Customer table. To add an expression column, go to the bottom of the Customer table and add a new row. Name it FullName and look at the properties for the column. Set the expression of the column to:\r\n\r\nLastName + ', ' + FirstName\r\n\r\nFigure 6.12: Our tables with a new relationship\r\n\r\nOnce you have done this, it should look like that shown in Figure 6.13.\r\n\r\nLastly, we need to add a unique constraint on Home Phone to make sure all of our customers' home phone numbers are unique. In the Typed DataSet vernacular, you will need to add a key to that column. Select the column, right-click on it, and select Add Key, as shown in Figure 6.14. This will launch the Edit Key dialog box, shown in Figure 6.15.\r\n\r\nFigure 6.13: Adding an expression column\r\n\r\nFigure 6.14: Selecting Add Key\r\n\r\nFigure 6.15: Naming the key\r\n\r\n\r\nIf you do nothing but name the key and click OK, you've created a unique constraint. There may be cases in which you want to support having a multi-column unique key. To do this you would add fields to the key in the dialog box, as shown in Figure 6.16.\r\n\r\nFigure 6.16: Supporting a multi-column unique key\r\n\r\n\r\nThis unique constraint will force the DataSet to make sure that all HomePhone and BusinessPhone combinations are unique. Congratulations, you now have your Typed DataSet defined.\r\n\r\nBefore we can see the code that Visual Studio .NET will generate, we need to build the project. After you build the project, your new Typed DataSet will be available for use.\r\n\r\n6.2.2  Using XSD.exe to Create a Typed DataSet\r\nMuch like creating the class from Visual Studio .NET, Typed DataSets can also be created directly from an XML Schema Document (XSD) using the command-line XSD.exe tool that is included in the .NET Framework SDK. If you are not using Visual Studio .NET or just like your tools to be command-line tools, XSD.exe is for you. If you are using Visual Studio .NET, its built-in support for Typed DataSets is much easier than the tool and produces the same classes.\r\n\r\nThis tool is used to generate code from XML Schema Documentsboth classes derived from the .NET XML classes and those derived from the DataSet family of classes. Before we can start, we will need an XSD document. We can use the DataSet to create one of these for us, as in Listing 6.3.\r\n\r\nListing 6.3: Creating an XSD from a DataSet\r\n...\r\n\r\n// Create a DataAdapter for each of the tables we're filling\r\nSqlDataAdapter daCustomers = new SqlDataAdapter(\"SELECT * FROM CUSTOMER\", conn);\r\n\r\n// Create your blank DataSet\r\nDataSet dataSet = new DataSet();\r\n\r\n// Fill the DataSet with each DataAdapter\r\ndaCustomers.Fill(dataSet, \"Customers\");\r\n\r\n// Grab our DataTable for simplicity\r\nDataTable customersTable = dataSet.Tables[\"Customers\"];\r\n\r\n// Improve the schema\r\ncustomersTable.Columns[\"CustomerID\"].ReadOnly = true;\r\ncustomersTable.Columns[\"CustomerID\"].Unique = true;\r\ncustomersTable.Columns[\"LastName\"].MaxLength = 50;\r\ncustomersTable.Columns[\"LastName\"].AllowDBNull = false;\r\ncustomersTable.Columns[\"FirstName\"].MaxLength = 50;\r\ncustomersTable.Columns[\"FirstName\"].AllowDBNull = false;\r\ncustomersTable.Columns[\"MiddleName\"].MaxLength = 50;\r\ncustomersTable.Columns[\"State\"].DefaultValue = \"MA\";\r\ncustomersTable.Columns[\"State\"].MaxLength = 2;\r\ncustomersTable.Columns[\"HomePhone\"].Unique = true;\r\n\r\n// Write out our XSD file to use to generate our typed DataSet\r\ndataSet.WriteXmlSchema(@\"c:\\CustomerDS.xsd\");\r\n\r\nOnce we run this code, we will have a CustomersDS.xsd file to use with XSD.exe. To generate the class, simply go to the command line and use the XSD.exe tool, as shown in Figure 6.17.\r\n\r\nFigure 6.17: Running the XSD.exe tool from the command line\r\n\r\n\r\nThe most interesting options are:\r\n\r\n/d specifies to create a schema class that is of type DataSet. For Typed DataSet you will always specify this flag.\r\n\r\n/l specifies the language in which to generate the classesCS is C#, VB is VB .NET and JS is Jscript .NET.\r\n\r\n/n specifies the namespace to create our class in. This flag is optional.\r\n\r\n/o specifies the output directory. If used, the output directory must already exist; the tool will not create it. If this is not specified, the classes will be created in the current directory.\r\n\r\nNow you have your class file to include in your project.\r\n\r\n6.2.3  Customizing the Generated Code with Annotations\r\nADO.NET allows you to control some aspects of the generated code by annotating the XSD that you use to generate the Typed DataSets. You can do this by annotating your XSD with several special attributes. All of these attributes are prefixed with the namespace of codegen. These attributes are:\r\n\r\ntypedName: Specifies the name of an object.\r\n\r\ntypedPlural: Specifies the name of the collection of objects.\r\n\r\ntypedParent: Specifies the name of the parent relationship.\r\n\r\ntypedChildren: Specifies the name of the child relationship.\r\n\r\nnullValue: Specifies how to handle a DBNull value for a particular row value. When you use this annotation, there are several possible values for the nullValue attribute:\r\n\r\nReplacement Value: The value to return instead of a null (for example, codegen:nullValue=\"\" will return an empty string instead of a null for a string field).\r\n\r\n_throw: Throws an exception when the value is accessed and is null (for example, codegen:nullValue=_throw). If the user would use the IsNull properties as part of the Typed DataSet to determine whether the field is null before trying to retrieve it. This is the default behavior if not annotated.\r\n\r\n_null: Returns a null reference from the field. If a value type is encountered an exception is thrown.\r\n\r\n_empty: Returns a reference created with an empty constructor. For strings, it returns String.Empty. For value types, an exception is thrown.\r\n\r\nThese must be added directly to the .XSD file. If you are using Visual Studio .NET, you must go to the XML view of your XSD to add these annotations. These annotations are added to an XSD like so:\r\n\r\n<?xml version=\"1.0\" encoding=\"utf-8\" ?>\r\n<xs:schema id=\"AnnotatedTDS\"\r\n      targetNamespace=\"http://tempuri.org/AnnotatedTDS\"\r\n      elementFormDefault=\"qualified\"\r\n      attributeFormDefault=\"qualified\"\r\n      xmlns=\"http://tempuri.org/AnnotatedTDS\"\r\n      xmlns:mstns=\"http://tempuri.org/AnnotatedTDS\"\r\n      xmlns:xs=\"http://www.w3.org/2001/XMLSchema\"\r\n      xmlns:msdata=\"urn:schemas-microsoft-com:xml-msdata\"\r\n      xmlns:codegen=\"urn:schemas-microsoft-com:xml-msprop\" >\r\n  <xs:element name=\"AnnotatedTDS\" msdata:IsDataSet=\"true\">\r\n    <xs:complexType>\r\n      <xs:choice maxOccurs=\"unbounded\">\r\n        <xs:element name=\"Customer\"\r\n                    codegen:typedName=\"OurCustomer\"\r\n                    codegen:typedPlural=\"OurCustomers\">\r\n...\r\n              <xs:element name=\"MiddleName\" type=\"xs:string\"\r\n                          minOccurs=\"0\"\r\n                          codegen:nullValue=\"_empty\" />\r\n...\r\n        </xs:element>\r\n        <xs:element name=\"Invoice\"\r\n                    codegen:typedName=\"TheirInvoice\"\r\n                    codegen:typedPlural=\"TheirInvoices\">\r\n...\r\n              <xs:element name=\"Terms\" type=\"xs:string\"\r\n                          minOccurs=\"0\"\r\n                          codegen:nullValue=\"Net 30\" />\r\n...\r\n        </xs:element>\r\n      </xs:choice>\r\n    </xs:complexType>\r\n    <xs:keyref name=\"CustomerInvoice\"\r\n               refer=\"ADONETKey1\"\r\n               msdata:AcceptRejectRule=\"Cascade\"\r\n               msdata:DeleteRule=\"Cascade\"\r\n               msdata:UpdateRule=\"Cascade\"\r\n               codegen:typedChildren=\"Invoices\"\r\n               codegen:typedParent=\"Customer\">\r\n      <xs:selector xpath=\".//mstns:Invoice\" />\r\n      <xs:field xpath=\"mstns:CustomerID\" />\r\n    </xs:keyref>\r\n...\r\n  </xs:element>\r\n</xs:schema>\r\nLet's walk through this XSD and see where we have put the annotations.\r\n\r\nThe first thing we needed to do was to add the namespace reference to the schema header. This simply tells the XSD that we have a namespace defined and to allow the attributes.\r\n\r\nNext, we make some changes to the Customer Element. typedName changes the name of the Typed DataRow in the DataTable to OurCustomer. When you ask for an individual row from the DataTable, it will return you an instance of the OurCustomer class instead of the default of Customer. typedPlural changes the name of the property on the DataSet that returns the specific DataTable. When retrieving the Customer DataTable, you would call the OurCustomers property.\r\n\r\nNext, we added the codegen:nullValue=\"_empty\" to the MiddleName element. This annotated our XSD so that a DBNull in the middle name element should be treated as an empty string in our generated Typed DataSet.\r\n\r\nNext, we changed the Invoice element just like we did the Customer element. We renamed the Typed DataRow to TheirInvoice and the property that returns it to TheirInvoices.\r\n\r\nLast, we changed the names of each end of our relationship by annotating the keydef tag with typedChildren and typedParent. This changes how each side of the relationship is named. The Customer class will have a method called Invoices (instead of GetInvoiceTable) to navigate down the relationship and the Invoice class will have a method called Customer (instead of GetCustomerTable) to navigate up the relationship.","Declares":"","CodeCategory":{"CategoryId":"21","CategoryDescription":".Net - ADO.Net"},"Keywords":["Typed Datasets"]},{"RecordId":"665","Title":"Create Thumbnails From Original Image Files (Resize Images)","Description":"Demonstrates how to resize images in C#","Code":"This ASP.NET page will go through a given folder and create a thumbnail version of every .jpg, .gif, and .bmp it finds (assuming the folder in the querystring parameter has write permissions granted to the IUSR_machinename account).  The page can also take another querystring parameter and use it to generate a nicely formatted HTML page and TABLE displaying the thumbnails with links to the original image.\r\n\r\n\r\n\r\n<%@ Import Namespace=\"System.Collections\" %>\r\n<%@ Import Namespace=\"System.Drawing\" %>\r\n<%@ Import Namespace=\"System.Drawing.Imaging\" %>\r\n<%@ Import Namespace=\"System.Drawing.Drawing2D\" %>\r\n<%@ Import Namespace=\"System.IO\" %>\r\n<%@ Import Namespace=\"System.Text\" %>\r\n \r\n\r\n<script Language=\"C#\" runat=\"server\">\r\n \r\n  protected Size ThumbNailSize = new Size(75,75);\r\n  protected string ThumbNailName = \"_thumbnail\";\r\n\r\n  private void Page_Load(object sender, System.EventArgs e)\r\n  {\r\n      if (RequestObject(\"generate\") == \"1\")\r\n      {\r\n         GenerateThumbNailImagesForFolder(RequestObject(\"imgfolder\")); \r\n      }\r\n       this.RW(GenerateHTMLPageForFolder(RequestObject(\"imgfolder\")));\r\n  }\r\n\r\n       \r\n\r\n        public void GenerateThumbNailImagesForFolder(string FolderName)\r\n        {\r\n             string sPhysicalPath=\"\";\r\n             string sFileName=\"\";\r\n             string sThumbName=\"\";\r\n \r\n             sPhysicalPath = Server.MapPath(FolderName);\r\n\r\n             DirectoryInfo oDir = new DirectoryInfo(sPhysicalPath);\r\n  \r\n            try\r\n            {\r\n\r\n                  FileInfo[] oDeleteFiles = oDir.GetFiles();\r\n\r\n                  foreach (FileInfo oFile in oDeleteFiles)\r\n                  {                   \r\n                     sFileName = oFile.Name.ToLower(); \r\n                     if (sFileName.IndexOf(\"thumbnail\") > 0) { oFile.Delete(); }\r\n                   }\r\n\r\n                   FileInfo[] oFiles = oDir.GetFiles();\r\n\r\n                   foreach (FileInfo oFile in oFiles)\r\n                  {\r\n\r\n                      sFileName = oFile.Name.ToLower(); \r\n\r\n                      sThumbName = sFileName.Replace(\".\",this.ThumbNailName + \".\"); \r\n\r\n                      if (sFileName.IndexOf(\".gif\") > 0)\r\n                      { \r\n                         this.GenerateThumbNail(sPhysicalPath,sFileName,sThumbName,ImageFormat.Gif); \r\n                      }\r\n                      if (sFileName.IndexOf(\".jpg\") > 0)\r\n                      { \r\n                         this.GenerateThumbNail(sPhysicalPath,sFileName,sThumbName,ImageFormat.Jpeg); \r\n                      }\r\n                      if (sFileName.IndexOf(\".bmp\") > 0)\r\n                     { \r\n                        this.GenerateThumbNail(sPhysicalPath,sFileName,sThumbName,ImageFormat.Bmp); \r\n                     }\r\n\r\n                   }\r\n           }\r\n          catch (Exception) { }\r\n        }\r\n\r\n     public void GenerateThumbNail(string sPhysicalPath,string sOrgFileName,string sThumbNailFileName,ImageFormat oFormat)\r\n       {\r\n\r\n            try\r\n            {\r\n                 \r\n                   System.Drawing.Image oImg = System.Drawing.Image.FromFile(sPhysicalPath + @\"\\\" + sOrgFileName); \r\n\r\n                   System.Drawing.Image oThumbNail = new Bitmap(this.ThumbNailSize.Width, this.ThumbNailSize.Height, oImg.PixelFormat);\r\n\r\n                   Graphics oGraphic =  Graphics.FromImage(oThumbNail);\r\n\r\n                   oGraphic.CompositingQuality = CompositingQuality.HighQuality ;\r\n\r\n                   oGraphic.SmoothingMode = SmoothingMode.HighQuality ;\r\n\r\n                   oGraphic.InterpolationMode = InterpolationMode.HighQualityBicubic ;\r\n\r\n                   Rectangle oRectangle = new Rectangle(0, 0, this.ThumbNailSize.Width, this.ThumbNailSize.Height);\r\n\r\n                   oGraphic.DrawImage(oImg, oRectangle);\r\n              \r\n                   oThumbNail.Save(sPhysicalPath + @\"\\\" + sThumbNailFileName,oFormat); \r\n\t\t\t\t  \r\n                   oImg.Dispose(); \r\n\r\n            }\r\n            catch (Exception)  { }\r\n\r\n       }\r\n\r\n        public string GenerateHTMLPageForFolder(string FolderName)\r\n        {\r\n\r\n           string sPhysicalPath=\"\";\r\n           string sFileName=\"\";\r\n           int nFound=0;\r\n           int nCol=0;\r\n           int nMaxCols=7;\r\n\r\n           StringBuilder oString = new StringBuilder();\r\n\r\n           oString.Append(\"<html><body><table border=0 cellspacing=2 cellpadding=2 width='80%' align=center>\");\r\n           \r\n            try\r\n            {\r\n\r\n                 sPhysicalPath = Server.MapPath(FolderName);\r\n                 DirectoryInfo oDir = new DirectoryInfo(sPhysicalPath);\r\n                 FileInfo[] oFiles = oDir.GetFiles();\r\n\r\n                  foreach (FileInfo oFile in oFiles)\r\n                  {                   \r\n\r\n                     sFileName = oFile.Name.ToLower(); \r\n                     nFound++;\r\n\r\n                     if (sFileName.IndexOf(\"thumbnail\") > 0)\r\n                     { \r\n\r\n                       nCol++;\r\n                       if (nCol == 1) { oString.Append(\"<tr>\"); }\r\n\r\n                        if ((sFileName.IndexOf(\".gif\") > 0) || (sFileName.IndexOf(\".jpg\") > 0) || (sFileName.IndexOf(\".bmp\") > 0))\r\n                        {\r\n                           oString.Append(\"<td align=left>\");\r\n                           oString.Append(\"<a href=\" + FolderName + \"/\" + sFileName.Replace(this.ThumbNailName,\"\") + \" target=_blank>\"); \r\n                           oString.Append(\"<img src=\" + FolderName + \"/\" + sFileName + \" border=0>\");\r\n                           oString.Append(\"</a>\");\r\n                           oString.Append(\"</td>\");\r\n                        }\r\n\r\n                        if (nCol == nMaxCols) { nCol = 0; oString.Append(\"</tr>\"); }\r\n\r\n                      }\r\n\r\n                   }\r\n\r\n                  if ((nFound >0) && (nCol < nMaxCols))\r\n                  {\r\n                     nCol = nMaxCols - nCol;\r\n                     oString.Append(\"<td colspan=\" + nCol.ToString() + \"> </td></tr>\");\r\n                  }\r\n\r\n             }\r\n             catch (Exception) {  }\r\n\r\n             oString.Append(\"</table></body></html>\");\r\n\r\n             return oString.ToString();\r\n\r\n        }\r\n\r\n        public void RW(string sVal)\r\n        {  \r\n          Response.Write(sVal +'\\n');\r\n        } \r\n\r\n        public string RequestObject(string sName)\r\n        {\r\n          string sRet=\"\";\r\n          try { sRet = Request[sName].ToString().Trim(); }\r\n          catch (Exception) { sRet = \"\";}  \r\n          return sRet;\r\n        }\r\n</script>","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Thumbnail","Resize Images"]},{"RecordId":"666","Title":"Adding Document Icon to PDF for SPS V2","Description":"Explanation of how to add custom document icons for SPS V2 search results and document lists.","Code":"1. Youll notice that now when you do a search and a PDF file is returned, it wont have that nice icon next to it. What you need to do is add the gif file of the pdf icon to the \\Program Files\\Common Files\\Microsoft Shared\\Web Server Extensions\\60\\Template\\Images directory. This needs to be a 16x16 gif file and it needs to be called PDF16.gif. I got my icon (.gif file) from Adobe's Web site. \r\n\r\n2. When you view your document library that has your pdf files in it, they wont display the PDF icon. You actually need to go somewhere different to manage this. Open up your DOCICON.xml file located at \\Program Files\\Common Files\\Microsoft Shared\\Web Server Extensions\\60\\Template\\XML. Under the By Extension node add a new node for your PDF icon. It's best simply to copy one of the existing mapping nodes, but it should look something like this: <Mapping Key=\"pdf\" Value=\"pdf16.gif\"/>. Now, reset IIS and your PDF files in your document libraries should now display the correct icons. \r\n","Declares":"","CodeCategory":{"CategoryId":"7","CategoryDescription":"Misc"},"Keywords":["Document Icons","SPS V2"]},{"RecordId":"667","Title":"Loading ASP.NET Templates Dynamically","Description":"Load ASP.NET templates dynamically for a DataList Web server controls based on the user selection","Code":"Loading ASP.NET Templates Dynamically \r\n \r\nThere are occasions when programmers needs to load templates dynamically. In this article, I will show you how to load ASP.NET templates dynamically for a DataList Web server controls based on the user selection \r\n\r\n\r\nListing 1. The DB class\r\n\r\npublic class DB\r\n{\r\n\r\n\tpublic DB()\r\n\t{\r\n\t}\r\n\t\r\n\t/// <summary>\r\n\t/// Method returns a DataSet object filled with data\r\n\t/// </summary>\r\n\t\r\n\tpublic static DataSet GetDataSet()\r\n\t{\r\n\t\t// Create a DataSet and a DataTable\r\n\t\tDataSet ds = new DataSet();\r\n\t\tDataTable table = new DataTable(\"Records\");\r\n\t\tDataColumn col;\r\n\t\r\n\t\t// Create & Add DataTable columns\r\n\t\tcol = new DataColumn();\r\n\t\tcol.DataType = System.Type.GetType(\"System.Int32\");\r\n\t\tcol.ColumnName = \"ID\";\r\n\t\tcol.ReadOnly = true;\r\n\t\tcol.Unique = true;\r\n\t\ttable.Columns.Add(col);\r\n\t\t\r\n\t\tcol = new DataColumn();\r\n\t\tcol.DataType = System.Type.GetType(\"System.String\");\r\n\t\tcol.ColumnName = \"Name\";\r\n\t\tcol.AutoIncrement = false;\r\n\t\tcol.Caption = \"Name\";\r\n\t\tcol.ReadOnly = false;\r\n\t\tcol.Unique = false;\r\n\t\ttable.Columns.Add(col);\r\n\t\tcol = new DataColumn();\r\n\t\tcol.DataType = System.Type.GetType(\"System.String\");\r\n\t\tcol.ColumnName = \"Address\";\r\n\t\tcol.AutoIncrement = false;\r\n\t\tcol.Caption = \"Address\";\r\n\t\tcol.ReadOnly = false;\r\n\t\tcol.Unique = false;\r\n\t\ttable.Columns.Add(col);\r\n\r\n\t\t// Create & Add DataTable rows\r\n\t\tDataRow row = table.NewRow();\r\n\t\trow[\"ID\"] = 1001;\r\n\t\trow[\"Name\"] = \"Melanie Giard\";\r\n\t\trow[\"Address\"] = \"23rd Street, Park Road, NY City, NY\";\r\n\t\ttable.Rows.Add(row);\r\n\t\trow = table.NewRow();\r\n\t\trow[\"ID\"] = 1002;\r\n\t\trow[\"Name\"] = \"Puneet Nehra\";\r\n\t\trow[\"Address\"] = \"3rd Blvd, Ashok Vihar, New Delhi\";\r\n\t\ttable.Rows.Add(row);\r\n\t\trow = table.NewRow();\r\n\t\trow[\"ID\"] = 1003;\r\n\t\trow[\"Name\"] = \"Raj Mehta\";\r\n\t\trow[\"Address\"] = \"Nagrath Chowk, Jabalpur\";\r\n\t\ttable.Rows.Add(row);\r\n\t\trow = table.NewRow();\r\n\t\trow[\"ID\"] = 1004;\r\n\t\trow[\"Name\"] = \"Max Muller\";\r\n\t\trow[\"Address\"] = \"25 North Street, Hernigton, Russia\";\r\n\t\ttable.Rows.Add(row);\r\n\t\t\r\n\t\t// Add DataTable to DataSet\r\n\t\tds.Tables.Add(table);\r\n\t\t// Return DataSet\r\n\t\treturn ds; \r\n\t}\r\n}  \r\n\r\n\r\nListing 2. A typical item template\r\n\r\n<%@ Language = \"VB\" %>\r\n<FONT face=\"verdana\" color=\"red\" size=\"2\"><b>ID: </b>\r\n       <%# DataBinder.Eval(CType(Container, DataListItem).DataItem, \"ID\") %>\r\n       <b>Name: </b>\r\n       <%# DataBinder.Eval(CType(Container, DataListItem).DataItem, \"Name\") %>\r\n       <br>\r\n       <b>Address: </b>\r\n       <%# DataBinder.Eval(CType(Container, DataListItem).DataItem, \"Address\") %>\r\n       <p>\r\n</FONT> \r\n \r\n\r\n\r\nListing 3. The BindDataGrid method  \r\n\r\n// This methods binds a DataSet to the DataGrid\r\nprivate void BindDataGrid()\r\n{\r\n      // DB.GetDataSet returns a DataSet with a table\r\n      // called 'Records' with three columns - ID, Name and Address\r\n      dtSet = DB.GetDataSet();\r\n      DataList1.DataSource = dtSet.Tables[0].DefaultView;\r\n      DataList1.DataBind();\r\n}  \r\n\r\nWe call this method on the page load as shown below -   \r\n\r\nprivate void Page_Load(object sender, System.EventArgs e)\r\n{\r\n      if(!IsPostBack)\r\n      {                       \r\n            BindDataGrid();\r\n      }\r\n}       \r\n\r\nIn the last step of this article, we add code for two button click event handlers. On these button click event handlers, we load two different templates. As you can see from this code, I set the DataLists AlternatingItemTemplate, ItemTemplate, HeaderTemplate, and FooterTemplate properties by using the Page.LoadTemplate method.  \r\n\r\nprivate void Button1_Click(object sender, System.EventArgs e)\r\n{\r\n\t// Load templates\r\n\tDataList1.AlternatingItemTemplate = Page.LoadTemplate(\"AltItemTempate.ascx\");\r\n\tDataList1.ItemTemplate = Page.LoadTemplate(\"ItemTemplate.ascx\");\r\n\tDataList1.HeaderTemplate = Page.LoadTemplate(\"HeadTemplate.ascx\");\r\n\tDataList1.FooterTemplate = Page.LoadTemplate(\"FootTemplate.ascx\");\r\n\tBindDataGrid();\r\n}  \r\n\r\nprivate void Button2_Click(object sender, System.EventArgs e)\r\n{\r\n\t// Load templates\r\n\tDataList1.AlternatingItemTemplate = Page.LoadTemplate(\"AltItemTempate2.ascx\");\r\n\tDataList1.ItemTemplate = Page.LoadTemplate(\"ItemTemplate2.ascx\");\r\n\tDataList1.HeaderTemplate = Page.LoadTemplate(\"HeadTemplate2.ascx\");\r\n\tDataList1.FooterTemplate = Page.LoadTemplate(\"FootTemplate2.ascx\");\r\n\tBindDataGrid();   \r\n}  \r\n","Declares":"","CodeCategory":{"CategoryId":"20","CategoryDescription":".Net - ASP.Net"},"Keywords":["Templates","Server Controls"]},{"RecordId":"668","Title":"How Long Has IIS and the Server Been Running","Description":"How to determine how long the IIS process, as well as the server, has been running.","Code":"'-----------------------------------------------------------------\r\nHow Long Has IIS Been Running\r\n'-----------------------------------------------------------------\r\n\r\nASP.NET Web pages served up through IIS are delivered through an ASP.NET \"worker process\" (aspnet_wp.exe). It's this file that executes your code and puts all the ASP.NET pieces together. If we could access this worker process, we may be able to look at how long it had been running, its current stateand perhaps even a history, showing previous instantiations of the worker process.\r\n\r\nWell, you can. And the following snippet of code shows you exactly how:\r\n\r\nDim strReport As String\r\nDim objInfo As ProcessInfo = ProcessModelInfo.GetCurrentProcessInfo\r\n\r\n' Get time information\r\nstrReport = \"ASP.NET was started at \" & _\r\n    objInfo.StartTime.ToString & \". \" & _\r\n    \"It has been running for \" & _\r\n    objInfo.Age.Days & \" days, \" & _\r\n    objInfo.Age.Hours & \" hours and \" & _\r\n    objInfo.Age.Minutes & \" minutes. \"\r\nResponse.Write(strReport)\r\n\r\n' Get other info\r\nstrReport = \"The process ID is \" & _\r\n    objInfo.ProcessID & \". \" & _\r\n    \"Current status is \" & _\r\n    objInfo.Status.ToString & \". \" & _\r\n    \"Peak memory used was \" & _\r\n    objInfo.PeakMemoryUsed & \". \" & _\r\n    \"Request count is currently \" & _\r\n    objInfo.RequestCount & \".\"\r\nResponse.Write(strReport)\r\n\r\n\r\n'-----------------------------------------------------------------\r\nHow Long Has The Server Been Running\r\n'-----------------------------------------------------------------\r\n\r\nSimply nab the TickCount from the Environment class, which lists the number of milliseconds the machine has been running. After that, either perform a few simple calculationsor, slightly easier, convert it into a period of time (a TimeSpan object), then retrieve the appropriate properties. Here's my snippet of code that does exactly that:\r\n\r\nDim tsAge As TimeSpan = TimeSpan.FromMilliseconds(Environment.TickCount)\r\nDim intDaysUp As Integer = tsAge.Days\r\nDim intHoursUp As Integer = tsAge.Hours\r\nDim intMinsUp As Integer = tsAge.Minutes\r\nResponse.Write(\"The server has been up \" & _\r\n   intDaysUp & \" days, \" & intHoursUp & _\r\n   \" hours and \" & intMinsUp & \" minutes.\")\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"20","CategoryDescription":".Net - ASP.Net"},"Keywords":["How Long","IIS Server","Uptime"]},{"RecordId":"669","Title":"ASP.Net Forms Authentication","Description":"How to set up and use Forms Authentication in ASP.Net","Code":"Forms Authentication\r\n\r\nWhen a user attempts to access a page that uses Forms authentication, they get redirected to a login screen. From here, your surfer can provide a username and password. You then validate the credentials and grant or deny access to your pages accordingly.\r\n\r\nWant to set up ASP.NET Forms authentication? Just follow my five quick and easy steps:\r\n\r\n1.  Open the Web.config file in your Solution. This stores a number of settings for your Web application. Edit the <authentication> elements, so it reads something like the following (alter usernames and passwords as appropriateand watch both your casing and spacing). This provides your application with a list of valid users:\r\n\r\n  <authentication mode=\"Forms\">\r\n    <forms>\r\n      <credentials passwordFormat=\"Clear\">\r\n        <user name=\"test1\" password=\"password\" />\r\n        <user name=\"test2\" password=\"password\" />\r\n      </credentials>\r\n    </forms>\r\n  </authentication>\r\n\r\n2.  Still in the Web.config file, remove the <allow users=\"*\" /> line from within the <authorization> element. This line grants access to anyoneand we've just erased it.\r\n\r\n3.  Still within the <authorization> element, add the following line to deny access to all unknown users (that is, those not authenticated):\r\n\r\n<deny users=\"?\" />\r\n\r\n4.  Create a page called \"login.aspx\". By default, all unauthenticated users will be redirected to this page. Add TextBox controls (txtUsername and txtPassword) for your browser to supply credentials. Also, add a CheckBox (chkPersist) to be used if the user wants their machine to automatically log them in next time.\r\n\r\n5.  Behind a Login button on your login.aspx page, add code similar to the following to authenticate your user:\r\n\r\nIf System.Web.Security.FormsAuthentication.Authenticate( txtUsername.Text, txtPassword.Text) = True Then\r\n   System.Web.Security.FormsAuthentication.RedirectFromLoginPage(txtUsername.Text, chkPersist.Checked)\r\nElse\r\n   Response.Write(\"Invalid credentials - go back and try again!\")\r\nEnd If\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Forms Authentication"]},{"RecordId":"670","Title":"Default \"Enter\" Button on ASP.Net Webform","Description":"How to create a default \"Enter\" button in ASP.Net","Code":"Imagine you've created an ASP.NET Web page with a search button. The user taps a phrase into a text box and presses Enter. On most regular Web pages (think: Google), the form would be submitted and the results returned. In other words, the search button is automatically \"clicked\" for you.\r\n\r\nHowever on an ASP.NET Web page, pressing Enter resubmits the form to the server, but actually does nothing.\r\n\r\nSo, how do you set a default button to be clicked when the user presses Enter? Simply add the following line to your page's Load event, replacing \"btnSearch\" with the name of your button. It uses a hidden Page method called RegisterHiddenField and works splendidly:\r\n\r\nPage.RegisterHiddenField(\"__EVENTTARGET\", \"btnSearch\")\r\n\r\nNOTE:  This method will NOT work when you have <asp:Button> objects on the page.  In many browser versions (see above) the Buttons will post automatically, and their name/value pair will override the pre-set __EVENTTARGET.  Also, certain controls will re-set the __EVENTTARGET to an empty string. \r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"20","CategoryDescription":".Net - ASP.Net"},"Keywords":["Default Enter","Enter Button"]},{"RecordId":"671","Title":"Passing Values Between Two Webforms","Description":"Demonstrates how to use Server.Transfer to pass values from one webform to another during the postback.","Code":"Expose the values you want to access in other pages as proprties of the current page class. This method requires you to code extra properties that you can access in another web form.  \r\nThe entire process works as follows: \r\n\r\n1.  Create the web form with controls \r\n2.  Create property Get procedures that will return control values \r\n3.  Provide some button or link button that posts the form back \r\n4.  In the button click event handler call Server.Transfer method that will transfer execution\r\n     to the specified form \r\n5.  In the second form you can get a reference to the first form instance by using\r\n     Context.Handler property.  Then you will use the get properties we created to access \r\n     the control values. \r\n\r\n----------------------------------------\r\nSource Web Form\r\n----------------------------------------\r\nAdd following properties to the web form: \r\n\r\npublic string Name\r\n{\r\n\tget\r\n\t{\r\n\t\treturn TextBox1.Text;\r\n\t}\r\n}\r\n\r\npublic string EMail\r\n{\r\n\tget\r\n\t{\r\n\t\treturn TextBox2.Text;\r\n\t}\r\n}\r\n\r\nNow, call Server.Transfer. \r\n\r\nprivate void Button1_Click (object sender, System.EventArgs e)\r\n{\r\n\tServer.Transfer(\"anotherwebform.aspx\");\r\n}\r\n\r\n\r\n----------------------------------------\r\nDestination Web Form\r\n----------------------------------------\r\nprivate void Page_Load (object sender, System.EventArgs e)\r\n{\r\n\t//create instance of source web form\r\n\tWebForm1 wf1;\r\n\r\n\t//get reference to current handler instance\r\n\twf1=(WebForm1)Context.Handler;\r\n\tLabel1.Text=wf1.Name;\r\n\tLabel2.Text=wf1.EMail;\r\n}\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"20","CategoryDescription":".Net - ASP.Net"},"Keywords":["Passing Values Between Webform","Server.Transfer"]},{"RecordId":"672","Title":"How to Compile Against Sharepoint V2","Description":"List of assemblies needed to compile against SPS V2","Code":"You just need to copy over the assemblies that you will reference. You can compile it, but not run it.  \r\n\r\nYou can also share the\r\n    Y:\\Program Files\\Common Files\\Microsoft Shared\\web server extensions\\60\\ISAPI \r\nfolder on the portal server and reference the assemblies through a mpped drive.\r\n\r\nThe assemblies you'll need are under that folder:\r\nMicrosoft.SharePoint.dll\r\nMicrosoft.SharePoint.Portal.Admin.Search.dll\r\nMicrosoft.SharePoint.Portal.dll\r\nMicrosoft.SharePoint.Portal.SingleSignon.dll\r\nMicrosoft.SharePoint.Portal.SingleSignon.Security.dll\r\n","Declares":"","CodeCategory":{"CategoryId":"25","CategoryDescription":"Sharepoint 2003"},"Keywords":["Compile SPS V2","SPS Assemblies"]},{"RecordId":"673","Title":"Creating a Web Service to Run in the Context of Windows Sharepoint Services","Description":"This programming task provides an overview of how to create a custom Web service that runs in the context of Microsoft Windows SharePoint Services.","Code":"Creating a Web Service for SPS\r\n\r\nThis programming task provides an overview of how to create a custom Web service that runs in the context of Microsoft Windows SharePoint Services.\r\n\r\n----------------------------------------------------------------------------------\r\nBasic steps for creating a Web service\r\n----------------------------------------------------------------------------------\r\n1. Create a virtual server on the server running Windows SharePoint Services but on a \r\n    different port. You must be a local administrator on the server.\r\n2. Create a Web service project on the new virtual server.\r\n3. Generate and edit a static discovery file and a Web Services Description Language \r\n    (WSDL) file.\r\n4. Deploy the Web service files to the _vti_bin directory.\r\n5. Create a Windows Application to consume the Web service.\r\n\r\n----------------------------------------------------------------------------------\r\nCreating a virtual server on a different port\r\n----------------------------------------------------------------------------------\r\n1. On the server that is running Windows SharePoint Services, create a folder in the\r\n    Local_Drive:\\Inetpub\\wwwroot directory in which to create the Web service project.\r\n2. On the taskbar, click Start, point to Administrative Tools, and then click Internet Information\r\n    Services (IIS) Manager. \r\n3. In IIS Manager, expand the Server_Name (local computer) node of the server where you\r\n    want to create the virtual server and select Web Sites.\r\n4. On the Action menu, point to New and click Web Site, which launches the Web Site \r\n    Creation Wizard.\r\n5. Click Next, and on the Web Site Description page type a name in the Description box for \r\n    the Web site that will host the Web service. Click Next.\r\n6. In the Enter the IP address to use for this Web site box of the IP Address and Port Settings\r\n    page , select the IP address that you want to use, or use the default value (All Unassigned).\r\n7. In the TCP port this Web site should use box, type a port number that is not already in use\r\n    and click Next.\r\n    Note:   You do not need to assign a host header because Windows SharePoint Services\r\n    handles hosting.\r\n8. On the Web Site Home Directory page, browse to or type the file system path for the folder\r\n    created in step 1 and click Next.\r\n    Note:   If you do not want to permit anonymous access to your virtual server, clear the Allow\r\n    anonymous access to this Web site check box.\r\n9. On the Web Site Access Permissions page, select the permissions that you want to use, and\r\n    then click Next. \r\n    Note  For best results in most cases, accept the default permissions. By default, the Read\r\n    permission and the Run Scripts (such as ASP) permission are selected. Windows SharePoint\r\n    Services automatically adds the Execute (such as ISAPI applications or CGI) permission to\r\n    the appropriate folders.\r\n10. Click Finish to exit the wizard.\r\n\r\n----------------------------------------------------------------------------------\r\nCreating a Web service on the new virtual server that runs within the context of a \r\nWindows SharePoint Services deployment\r\n----------------------------------------------------------------------------------\r\n1. In Microsoft Visual Studio .NET, on the File menu, point to New, and then click Project. \r\n2. In the New Project dialog box, select Visual Basic Projects or Visual C# Projects in the\r\n    Project Types box, depending on which language you prefer.\r\n3. In the Templates box, select ASP.NET Web Service. \r\n4. In the Location box, type the following path, using the port number specified for the new\r\n    virtual server and CheckInOut as the name of the project:\r\n        http://Server_Name:Port_#/CheckInOut\r\n5. Click OK.\r\n\r\nCreating a Web service in Visual Studio .NET from a remote computer involves an extra step in the procedure required for creating a Web service in Visual Studio .NET from the server.\r\n\r\nAt this point, if you are working from a remote computer, a Web Access Failed dialog box appears, saying that the file path does not correspond to the URL previously specified in the New Project dialog box. \r\n\r\nPerform the following steps:\r\n1. Under What would you like to do?, ensure that Retry using a different file share path is \r\n    selected and type the following path in the Location box, which includes the server name,\r\n    the file system path specified for the project folder in step 1 of the procedure for creating a\r\n    virtual server, and the project name specified in step 5 of this procedure:\r\n       \\\\Server_Name\\Local_Drive$\\Inetpub\\wwwroot\\Project_Folder\\CheckInOut\r\n2. Click OK.\r\n\r\nCompleting this step creates an ASP.NET Web service project.\r\n\r\n6. Add a reference to the Windows SharePoint Services assembly by performing the following steps:\r\n\r\nIn Solution Explorer, right-click the References node and click Add Reference on the shortcut menu. \r\n\r\n6a. If you are using Visual Studio .NET on the server, on the .NET tab of the Add Reference\r\n     dialog box, select Windows SharePoint Services in the list of components. Click Select, \r\n     and then click OK.\r\n\r\n6b. If you are using Visual Studio .NET on a remote computer, perform the following steps:\r\n\r\n1. Click Browse, and in the Select Component dialog box, navigate to the \r\n      Local_Drive:\\Program Files\\Common Files\\Microsoft Shared\r\n            \\Web Server Extensions\\60\\ISAPI folder on the server running Windows SharePoint\r\n    Services. You may instead prefer to first copy Microsoft.SharePoint.dll from this folder to a\r\n    local drive on the remote computer and then open this local copy of the DLL in the Select \r\n    Component dialog box.\r\n2. Select Microsoft.SharePoint.dll, click Open, and then click OK.\r\n\r\n7. Right-click the Service1.asmx file for the project in Solution Explorer, click Rename, and type\r\n    CheckInOut.asmx.\r\n8. Right-click CheckInOut.asmx in Solution Explorer, and then click View Code.\r\n9. Add appropriate SPS references in the using/imports section of the .asmx.cs file:\r\n10. Change the class and constructor names from Service1 to the name of your web service.\r\n11. Add you web service code to the class.\r\n12. Press F5 to compile the project.\r\n\r\n----------------------------------------------------------------------------------\r\nGenerating and modifying static DISCO and WSDL files\r\n----------------------------------------------------------------------------------\r\nThis procedure uses the command line utility that is installed with Visual Studio .NET to generate the static discovery (.disco) file and the WSDL (.wsdl) file.\r\n\r\n1. On the taskbar, click Start, point to All Programs, point to Microsoft Visual Studio .NET, point\r\n    to Visual Studio .NET Tools, and then click Visual Studio .NET Command Prompt to open a\r\n    command prompt.\r\n2. At the prompt type the following command to generate .disco and .wsdl files in the \r\n    Local_Drive:\\Documents and Settings\\User folder:\r\n         Disco http://Server_Name:Port_#/CheckInOut/CheckInOut.asmx\r\n3. Open the new .disco  *** AND *** .wsdl files and replace the following XML processing instructions in\r\n    the files (NOTE, CHANGE BOTH FILES):\r\n        <?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n    with the following page directives:\r\n        <%@ Page Language=\"C#\" Inherits=\"System.Web.UI.Page\"%>\r\n        <%@ Assembly Name=\"Microsoft.SharePoint, Version=11.0.0.0, Culture=neutral, \r\n             PublicKeyToken=71e9bce111e9429c\" %> \r\n        <%@ Import Namespace=\"Microsoft.SharePoint.Utilities\" %> \r\n        <%@ Import Namespace=\"Microsoft.SharePoint\" %>\r\n        <% Response.ContentType = \"text/xml\"; %>\r\n\r\n4. Modify the following lines in the .disco file:\r\n        <contractRef ref=\"http://Server_Name:Port_#/CheckInOut/CheckInOut.asmx?wsdl\"\r\n            docRef=\"http://Server_Name:Port#/CheckInOut/CheckInOut.asmx\" \r\n            xmlns=\"http://schemas.xmlsoap.org/disco/scl/\" />\r\n        <soap address=\"http://Server_Name:Port#/CheckInOut/CheckInOut.asmx\"\r\n            xmlns:q1=\"http://tempuri.org/\" binding=\"q1:CheckInOutSoap\" \r\n            xmlns=\"http://schemas.xmlsoap.org/disco/soap/\" />\r\n\r\n    to be as follows:\r\n        <contractRef ref=<% SPEncode.WriteHtmlEncodeWithQuote(Response, \r\n            SPWeb.OriginalBaseUrl(Request) + \"?wsdl\", '\"'); %>  docRef=<%             SPEncode.WriteHtmlEncodeWithQuote(Response, SPWeb.OriginalBaseUrl(Request),\r\n             '\"'); %>  xmlns=\"http://schemas.xmlsoap.org/disco/scl/\" />\r\n        <soap address=<% SPEncode.WriteHtmlEncodeWithQuote(Response, \r\n            SPWeb.OriginalBaseUrl(Request), '\"'); %>  xmlns:q1=\"http://tempuri.org/\" \r\n            binding=\"q1:CheckInOutSoap\" xmlns=\"http://schemas.xmlsoap.org/disco/soap/\" />\r\n\r\n5. Modify the following line in the .wsdl file:\r\n        <soap:address location=\"http://Server_Name:Port#/CheckInOut/CheckInOut.asmx\" />\r\n\r\n    to be as follows:\r\n        <soap:address location=<% SPEncode.WriteHtmlEncodeWithQuote(Response,\r\n            SPWeb.OriginalBaseUrl(Request), '\"'); %> />\r\n\r\n6. Save the files as CheckInOutdisco.aspx and CheckInOutwsdl.aspx respectively.\r\n7. To include the service in the list of default Windows SharePoint Services Web services that \r\n    is displayed in the Add Web Reference browser of Visual Studio .NET, perform the following\r\n    steps:\r\n\r\n    In Notepad, open the spdisco.aspx file of the Local_Drive:\\Program Files\r\n        \\Common Files\\Microsoft Shared\\Web Server Extensions\\60\\ISAPI folder.\r\n\r\n    Add the following lines to the end of the file within the discovery element and save the file:\r\n      <contractRef ref=<% SPEncode.WriteHtmlEncodeWithQuote(Response, spWeb.Url + \r\n            \"/_vti_bin/CheckInOut.asmx?wsdl\", '\"'); %> docRef=<% \r\n            SPEncode.WriteHtmlEncodeWithQuote(Response, spWeb.Url + \r\n            \"/_vti_bin/CheckInOut.asmx\", '\"'); %> xmlns=\"http://schemas.xmlsoap.org/disco/scl/\"\r\n             />\r\n      <soap address=<% SPEncode.WriteHtmlEncodeWithQuote(Response, spWeb.Url +\r\n            \"/_vti_bin/CheckInOut.asmx\", '\"'); %> \r\n            xmlns:q1=\"http://schemas.microsoft.com/sharepoint/soap/directory/\" \r\n            binding=\"q1:CheckInOutSoap\" xmlns=\"http://schemas.xmlsoap.org/disco/soap/\" />\r\n\r\n    Note  The text appearing before \"Soap\" in the binding attribute of the soap element (in this\r\n    example, binding=\"q1:CheckInOutSoap\") specifies the name of the class that is defined in\r\n    the Web service.\r\n\r\n----------------------------------------------------------------------------------\r\nCopy the Web service files to the _vti_bin directory\r\n----------------------------------------------------------------------------------\r\nThe _vti_bin virtual directory maps physically to the Local_Drive:\\Program Files\\Common Files\\Microsoft Shared\\Web Server Extensions\\ISAPI directory, which contains the default Web service files used in Windows SharePoint Services. \r\n\r\nCopy the new .aspx and disco.aspx files, as well as the .asmx file of the Web service project, to the ISAPI folder. Also copy the corresponding assembly (.dll) from the bin folder of the project to the bin subfolder within the ISAPI folder.\r\n\r\nFrom the _vti_bin directory, a Web service offers its functionality to the site that is specified when adding a Web reference for the service.","Declares":"","CodeCategory":{"CategoryId":"25","CategoryDescription":"Sharepoint 2003"},"Keywords":["Web Service","_vti_bin"]},{"RecordId":"674","Title":"Writing Web Parts That Work On SharePoint Portal Server And Windows SharePoint Services","Description":"Demonstrates a complex technique for dynamically loading assemblies","Code":"I've been working a lot on web parts for both SharePoint Portal Server 2003 and Windows SharePoint Services.  Having them both running off the same web part page framework means you can write a web part that runs in WSS and it should work in SPS, too.\r\n\r\nThe problem arises in the fact that SPS is a superset of WSS.  There are features available in SPS that you can take advantage of when you're in that context that just aren't available in WSS.  Microsoft has a KB article that lists the differences.  The ones that have really been affecting me lately are the Audiences and User Profiles.\r\n\r\nWhat happens if you want to write a web part that takes advantage of, say, Audiences, when you're running in SPS but ignores those settings when you're in a WSS site?\r\n\r\nThere are a few road blocks to doing this.  First, there's no built-in way to ask the web part page framework whether you're running in WSS or SPS.  Second, if you [somehow] determine that you're running in SPS and you build some code containing Microsoft.SharePoint.Portal objects, that works great in SPS but when you port it to WSS you'll get a compile-time binding error because the Microsoft.SharePoint.Portal assembly doesn't exist.  (Even if you don't actually execute the part of the code with those assembly references, the compiler pukes when it tries to execute your part.)\r\n\r\nThe solution lies in the System.Reflection namespace and .NET's ability to perform late-binding to objects.  This allows us to build up a library of methods that we can include in a utility class or in our web parts directly that dynamically detect whether we are on WSS or SPS and conditionally create objects accordingly.  Because we don't ever actually reference the Microsoft.SharePoint.Portal namespace directly, the compiler lets us do what we need to do.\r\n\r\nI've included a code example in C# with three methods in it.  You'll need to include the System.Collections and System.Reflections namespace in your assembly to use them, and you'll have to paste them into a class and namespace of your own devising.  You may also want to play with the access modifiers to make them static, if you're looking for a strict utility class with no instance information, but we'll leave that sort of thing as an exercise to the reader.\r\n\r\nThe first method, ContextIsSPS(), returns true if it executes within the context of a SharePoint Portal Server web part page.  If it's running on a WSS site (even if it's a WSS site that resides on an SPS machine) it returns false.  This allows you to determine whether you're running in SPS or not.\r\n\r\nThe second method, GetAudienceAndGuidList(), returns a System.Collections.SortedList with the current SPS site's audience information in it.  The keys in the list are the names of the audiences; the values are the System.Guid identifiers associated with each audience.  I found this useful for populating list boxes and so forth.  Again, note we never actually reference any Microsoft.SharePoint.Portal objects, so the compiler won't throw errors when it's running on WSS.\r\n\r\nThe third method, UserIsMemberOfAudience(), returns true if a given user is a member of a particular audience.  Just pass in the username (DOMAIN\\username works, but for the current user you can pass in Page.User.Identity.Name) and the GUID for the audience (which you can get from the GetAudienceAndGuidList() method), and you get a Boolean back indicating whether the user is in that audience or not.  Note that the way I've written it, if it runs in the context of WSS it will always return true (since there are no audiences in WSS).\r\n\r\n\r\n//-----------------------------------------------------------------------------------------------------------------------------------\r\n\r\nusing System.Collections;\r\nusing System.Reflection;\r\n\r\n\r\n/// <summary>\r\n/// Returns a Boolean indicating whether we're running in SharePoint Portal Server\r\n/// or not.\r\n/// </summary>\r\n/// <returns>True if we're running in SPS; false otherwise.</returns>\r\npublic bool ContextIsSPS(){\r\n\tAssembly assemblyInstance = null;\r\n\ttry{\r\n\t\t// Try to bind to the Microsoft.SharePoint.Portal assembly.\r\n\t\t// If it isn't there, we're not in SPS.\r\n\t\tassemblyInstance = Assembly.LoadWithPartialName(\"Microsoft.Sharepoint.Portal\");\r\n\t\tif(assemblyInstance != null){\r\n\t\t\t// We've successfully bound to the assembly, so now let's try to determine\r\n\t\t\t// the current PortalContext.\r\n\t\t\tSystem.Type oType = assemblyInstance.GetType(\"Microsoft.SharePoint.Portal.PortalContext\");\r\n\t\t\tPropertyInfo oInfo = oType.GetProperty(\"Current\");\r\n\t\t\tobject result = oInfo.GetValue(null, null);\r\n\t\t\tif (result == null) {\r\n\t\t\t\t// SPS Installation, but WSS context\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\t// Running in SPS context\r\n\t\t\t\t// To determine SPS site URL:\r\n\t\t\t\t//     PropertyInfo oSiteURLInfo  = result.GetType().GetProperty(\"SiteUrl\");\r\n\t\t\t\t//     string siteurl =  (string)oSiteURLInfo.GetValue(result,null);\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse{\r\n\t\t\t// We couldn't bind to the Portal assembly, so we're not on an SPS box\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\tcatch (Exception err){\r\n\t\tSystem.Diagnostics.Debug.WriteLine(\"ContextIsSPS(): Exception determining SPS context; returning FALSE.\");\r\n\t\tSystem.Diagnostics.Debug.WriteLine(err.Message);\r\n\t\treturn false;\r\n\t}\r\n\tfinally{\r\n\t\tassemblyInstance = null;\r\n\t}\r\n}\r\n\r\n\r\n/// <summary>\r\n/// Gets the list of audience names and GUIDs for the current site\r\n/// </summary>\r\n/// <returns>A SortedList object where the keys are the audience names (string) and the values are the audience GUIDs (System.Guid)</returns>\r\npublic SortedList GetAudienceAndGuidList(){\r\n\tSortedList audList = new SortedList();\r\n\tAssembly assemblyInstance = Assembly.LoadWithPartialName(\"Microsoft.SharePoint.Portal\");\r\n\tif(assemblyInstance != null){\r\n\t\t// We're working on a SharePoint Portal Server, or a WSS site on a server with SPS\r\n\r\n\t\t// Get the current portal context\r\n\t\tSystem.Type portalContext = assemblyInstance.GetType(\"Microsoft.SharePoint.Portal.PortalContext\");\r\n\t\tPropertyInfo currentContextProperty = portalContext.GetProperty(\"Current\");\r\n\t\tobject currentContext = currentContextProperty.GetValue(null, null);\r\n\t\tif(currentContext != null){\r\n\t\t\t// We have a portal context, so we're on SPS\r\n\r\n\t\t\t// Get the types we'll be working with\r\n\t\t\tSystem.Type audMgrType = assemblyInstance.GetType(\"Microsoft.SharePoint.Portal.Audience.AudienceManager\");\r\n\t\t\tSystem.Type audCollType = assemblyInstance.GetType(\"Microsoft.SharePoint.Portal.Audience.AudienceCollection\");\r\n\t\t\tSystem.Type audType = assemblyInstance.GetType(\"Microsoft.SharePoint.Portal.Audience.Audience\");\r\n\r\n\t\t\t// Create the AudienceManager object\r\n\t\t\tobject audMgr = audMgrType.InvokeMember(null,\r\n\t\t\t\tBindingFlags.DeclaredOnly | BindingFlags.Public | BindingFlags.NonPublic | BindingFlags.Instance | BindingFlags.CreateInstance,\r\n\t\t\t\tnull,\r\n\t\t\t\tnull,\r\n\t\t\t\tnew object[]{currentContext});\r\n\r\n\t\t\t// Call the Audiences property to get the collection of audiences from the AudienceManager\r\n\t\t\tIEnumerable audColl = (IEnumerable)audMgrType.InvokeMember(\"Audiences\", \r\n\t\t\t\tBindingFlags.DeclaredOnly | BindingFlags.Public | BindingFlags.NonPublic | BindingFlags.Instance | BindingFlags.GetProperty,\r\n\t\t\t\tnull,\r\n\t\t\t\taudMgr,\r\n\t\t\t\tnull);\r\n\r\n\t\t\t// Get the name and GUID for each audience and put them in the collection\r\n\t\t\tforeach(object aud in audColl){\r\n\t\t\t\ttry{\r\n\t\t\t\t\tstring audName = (string)audType.InvokeMember(\"AudienceName\", \r\n\t\t\t\t\t\tBindingFlags.DeclaredOnly | BindingFlags.Public | BindingFlags.NonPublic | BindingFlags.Instance | BindingFlags.GetProperty,\r\n\t\t\t\t\t\tnull,\r\n\t\t\t\t\t\taud,\r\n\t\t\t\t\t\tnull);\r\n\t\t\t\t\tGuid audGuid = (Guid)audType.InvokeMember(\"AudienceID\", \r\n\t\t\t\t\t\tBindingFlags.DeclaredOnly | BindingFlags.Public | BindingFlags.NonPublic | BindingFlags.Instance | BindingFlags.GetProperty,\r\n\t\t\t\t\t\tnull,\r\n\t\t\t\t\t\taud,\r\n\t\t\t\t\t\tnull);\r\n\t\t\t\t\taudList.Add(audName, audGuid);\r\n\t\t\t\t}\r\n\t\t\t\tcatch(Exception exc){\r\n\t\t\t\t\t// If there are any problems, don't add the audience to the list\r\n\t\t\t\t\tSystem.Diagnostics.Debug.WriteLine(\"GetAudienceAndGuidList(): Exception getting audience list\");\r\n\t\t\t\t\tSystem.Diagnostics.Debug.WriteLine(exc.Message);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn audList;\r\n}\r\n\r\n\r\n/// <summary>\r\n/// Uses System.Reflection to late-bind to the Microsoft.SharePoint.Portal assembly and determine if\r\n/// a user is a member of an audience.\r\n/// </summary>\r\n/// <param name=\"username\">The username of the person to look up</param>\r\n/// <param name=\"audienceID\">The audience ID to check membership for</param>\r\n/// <returns>True if the user is a member of the specified audience; false otherwise</returns>\r\npublic bool UserIsMemberOfAudience(string username, Guid audienceID){\r\n\tAssembly assemblyInstance = Assembly.LoadWithPartialName(\"Microsoft.SharePoint.Portal\");\r\n\tif(assemblyInstance != null){\r\n\t\t// We're working on a SharePoint Portal Server, or a WSS site on a server with SPS\r\n\r\n\t\t// Get the current portal context\r\n\t\tSystem.Type portalContext = assemblyInstance.GetType(\"Microsoft.SharePoint.Portal.PortalContext\");\r\n\t\tPropertyInfo currentContextProperty = portalContext.GetProperty(\"Current\");\r\n\t\tobject currentContext = currentContextProperty.GetValue(null, null);\r\n\t\tif(currentContext != null){\r\n\t\t\t// We have a portal context, so we're on SPS\r\n\r\n\t\t\t// Get the types we'll be working with\r\n\t\t\tSystem.Type audMgrType = assemblyInstance.GetType(\"Microsoft.SharePoint.Portal.Audience.AudienceManager\");\r\n\r\n\t\t\t// Create the AudienceManager object\r\n\t\t\tobject audMgr = audMgrType.InvokeMember(null,\r\n\t\t\t\tBindingFlags.DeclaredOnly | BindingFlags.Public | BindingFlags.NonPublic | BindingFlags.Instance | BindingFlags.CreateInstance,\r\n\t\t\t\tnull,\r\n\t\t\t\tnull,\r\n\t\t\t\tnew object[]{currentContext});\r\n\r\n\t\t\t// Call the IsMemberOfAudience method to determine audience membership\r\n\t\t\tbool userIsMember = false;\r\n\t\t\tobject[] isMemberOfAudienceArgs = new object[] {username, audienceID};\r\n\t\t\ttry{\r\n\t\t\t\tuserIsMember = (bool)audMgrType.InvokeMember(\"IsMemberOfAudience\", \r\n\t\t\t\t\tBindingFlags.DeclaredOnly | BindingFlags.Public | BindingFlags.NonPublic | BindingFlags.Instance | BindingFlags.InvokeMethod,\r\n\t\t\t\t\tnull,\r\n\t\t\t\t\taudMgr,\r\n\t\t\t\t\tisMemberOfAudienceArgs);\r\n\t\t\t}\r\n\t\t\tcatch(Exception err){\r\n\t\t\t\t// Do nothing\r\n\t\t\t\tSystem.Diagnostics.Debug.WriteLine(\"UserIsMemberOfAudience(): Exception getting audience membership\");\r\n\t\t\t\tSystem.Diagnostics.Debug.WriteLine(exc.Message);\r\n\t\t\t}\r\n\t\t\treturn userIsMember;\r\n\t\t}\r\n\t\telse{\r\n\t\t\t// We're working in WSS, which doesn't have audiences, so we'll assume that everyone\r\n\t\t\t// is a member of every audience.\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\telse{\r\n\t\t// We're working in WSS, which doesn't have audiences, so we'll assume that everyone\r\n\t\t// is a member of every audience.\r\n\t\treturn true;\r\n\t}\r\n}\r\n","Declares":"","CodeCategory":{"CategoryId":"25","CategoryDescription":"Sharepoint 2003"},"Keywords":["Dynamically Load Assemblies","SPS WSS"]},{"RecordId":"675","Title":"Load XML From Remote URL","Description":"Demonstrates how to load xml from a remote URL","Code":"XmlDocument xmlDoc = new XmlDocument();\r\nxmlDoc.Load(\"http://datawebcontrols.com/demos/SimpleXML.xml\");\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"20","CategoryDescription":".Net - ASP.Net"},"Keywords":["Load XML"]},{"RecordId":"676","Title":"Transparent Iframe","Description":"How to create a transparent iframe","Code":"Place this code where you want your Transparent Iframe to be:\r\n<iframe src=\"URL OF FIRST PAGE\" FRAMEBORDER=\"0\" \r\n\twidth=\"NUMBER\" height=\"NUMBER\" name=\"IFRAME NAME\" \r\n\tstyle=\"position:absolute;left:NUMBERpx;top:NUMBERpx;\" allowtransparency=\"true\">\r\n</iframe>\r\n\r\nPlace this code in the page that is contained WITHIN the Iframe\r\n<body style=background-color:transparent>\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"9","CategoryDescription":"HTML"},"Keywords":["Transparent IFrame"]},{"RecordId":"677","Title":"Using ASP.Net Custom User Controls in Sharepoint Webparts","Description":"Demonstrates how to use ASP.Net User Controls in Webparts","Code":"---------------------------------------------------------\r\nSummary of Steps\r\n---------------------------------------------------------\r\n\r\nCreate the User Control Assembly\r\n\r\nCreate a physical folder in inetpub\r\nConnect the physical folder as a virtual folder under the SPS Portal\r\nTell SPS to exclude management of the path to the virtual folder\r\nUsing Visual InterDev, create new Web Application project.  The URL should be http://YourSPSPortalURL/YourNewVirtualFolder.  When VID complains about not being able to find the path, enter \\\\ushernt24E$\\inetpub\\yourfolder as a share location.\r\nDelete web.config and global.asax form the project.\r\nDevelop the user control.\r\nConsider adding a webform to the project in order to serve as a test harness to verify that the user control functions correctly under this website.\r\nMake the user control assembly strong named.  (Described below)\r\n\r\n\r\n\r\nCreate the Webpart Assembly\r\n\r\nCreate a physical folder in inetpub\r\nConnect the physical folder as a virtual folder under the SPS Portal\r\nTell SPS to exclude management of the path to the virtual folder\r\nUsing Visual InterDev, create new Webpart Library.  The URL should be \\\\ushernt24E$\\inetpub\\yourfolder as a share location.\r\nCreate a reference to the user control assembly that was built above.\r\nDevelop the web part.\r\nMake the web part assembly strong named.  (Described below)\r\nCopy the DLL to the SPS Portal's bin folder.\r\nTweak the DWP file.  (Described below)\r\nMake the <SafeControl> entry in the SPS Portal's web.config file.  (No changes are necessary to the <compilation> section.)\r\nImport the dwp file into Sharepoint\r\nUse the webpart\r\n\r\n\r\n\r\nFurther Development (code changes) of Either Component\r\n\r\nIf changes are made to the user control assembly, you must re-compile the webpart assembly.\r\nAfter re-compiling the assmeblies, re-copy them to the SPS Portal's bin folder.\r\nNo changes to the dwp or any web.config are necessary.\r\n\r\n\r\n---------------------------------------------------------\r\nMore Detailed Information\r\n---------------------------------------------------------\r\n\r\nI built 2 Web Parts (a simple hello world and one displaying a data grid with all the customers) and used the user control technique on a clean machine (that is one that has not been polluted with all kinds of custom configuration like my own portable). And to be positive, they work! I encountered however a number of problems. I list all the steps I took and all the problems I have encountered here:\r\n\r\n1. I started with creating a UserControls subfolder in the folder that is associated with your SharePoint virtual server. \r\n\r\n2. I made that folder an Web application directory using IIS management console. The UserControls site is associated with the same application pool running my WSS sites and has the default identity Network Service.\r\n\r\n3. Using the SharePoint Central Administration I defined a managed path to exclude (see article).\r\n\r\n4. I created a normal ASP.NET application under inetpubwwwroot and created there a user control displaying simply the text \"Hello World\" and a test ASPX page.\r\n\r\n5. First thing I checked is whether the SharePoint ISAPI filter ignores my ASPX request by going to the http://localhost:100/usercontrols/test.aspx page.\r\n\r\n6. I gave a strong name to my assembly resulting out of my ASP.NET project\r\n\r\n7. Next I created a Web Part library in which I have my Web Part class and my DWP file and my manifest.xml. After referencing the controls library, I gave my Web Part library a strong name, used the Roeder tool to find out the fully qualified name and updated my DWP file. I also modified the manifest.xml (and removed the ClassResource empty element since there are no resources (the technical refresh causes some problems when deploying like this). \r\n\r\n8. A cabinet file is used and I go for the STSADM.EXE to do the deployment. Here is the command I used:\r\n\r\n\"C:\\program Files\\Common Files\\Microsoft Shared\\Web Server Extensions\\60\\bin\\stsadm.exe\" -force -globalinstall -o addwppack -url http://neelix:123 -f  C:CABSHelloWorld2.CAB\r\n\r\n9. Next, I drop the usercontrols dll in the GAC and the ascx in the usercontrols directory under the directory associated with your WSS virtual server.\r\n\r\n10. With the first test, you get an error '... appears to cause a problem... in SharePoint.\r\n\r\n11. You can get a bit more details when you turn on the CallStack element in the web.config and set the CustomErrors element in the same web.config to Off.\r\n\r\n12. You normally see then an ASP.NET error page showing that the dll for the user controls could not be found.\r\n\r\n13. The magic element that you have to insert in the web.config is the following:\r\n\r\n   <compilation...>\r\n      <assemblies>\r\n         <add assembly=\"HelloWorldControls, Version=1.0.0.0, Culture=neutral, PublicKeyToken=12121...,/>\r\n      </assemblies>\r\n   </compilation>\r\n\r\n\r\nThe trust level is still minimal and I did not change anything to the SafeControls section.\r\n\r\nThe second part is showing a datagrid with all the customers and that worked as well following the above steps.\r\n\r\nMaking use of user controls is a lot more productive that doing everything through code.\r\n\r\n-------------------------------------------------------------------------------\r\nSharePoint Request Handling\r\n-------------------------------------------------------------------------------\r\n\r\nSharePoint sites are hosted on a IIS 6.0 virtual server where an ISAPI filter (stsfltr.dll) intercepts all of the incoming requests. The requests are handled by the SharePoint framework consulting the config SQL Server database and then generating the response based on the data available in the content SQL Server database. Since all of it is running on the ASP.NET framework, an HttpHandler (Microsoft.SharePoint.ApplicationRuntime.SharePointHandlerFactory) is taking the responsibility of actually generating the dynamic response of the SharePoint pages. \r\n\r\nAs a direct result of this, ordinary ASP.NET applications and Web Services will have difficulties running their code on the SharePoint extended virtual server. The only way you can avoid the stsfltr.dll to intercept a request directed towards your own ASP.NET application or Web Service running on the same virtual server as SharePoint, is by adding these sites to the managed path listing of SharePoint. \r\n\r\nHere is the procedure of allowing normal ASP.NET related requests to by-pass the stsfltr.dll: \r\nActivate the SharePoint Central Administration site from within your Administrative Tools.\r\n\r\n1. Click on the Configure Virtual Server Settings.\r\n2. Select your Virtual Server.\r\n3. Click on the Define Managed Paths link in the Virtual Server Management section.\r\n4. Add the path to exclude, pointing to the URL of your custom ASP.NET application.\r\n\r\n-------------------------------------------------------------------------------\r\n\r\nTo help us build our Web Parts in a more visual way, we can add a path for an ASP.NET application that will contain the user controls to be embedded in Web Parts. In the example below, I have created a new Virtual Directory in IIS called UserControls and used SharePoint Central Administration to exclude this path. Now we are ready to host any normal ASP.NET-related files in this directory. \r\n\r\nMaking use of the framework that user controls provide us, we have the ability to simplify the Web Part code considerably. \r\n\r\nCreate a new ASP.NET application using Visual Studio .NET. You can directly point to the new UserControls virtual directory, or decide to first create the ASP.NET application using a non-SharePoint specific virtual server and later deploy the necessary files into the UserControls virtual directory (that is, the ASCX file and the generated assembly). \r\n\r\nNOTE:  To avoid problems, remove the web.config and the global.asax from your project. \r\n\r\nA Web form can easily be added to the project and used for testing and debugging your code. \r\n\r\n\r\n-------------------------------------------------------------------------------\r\nCreating the User Control in the Web Part\r\n-------------------------------------------------------------------------------\r\n\r\nOnce the user control is doing what it is supposed to do, it is ready to be embedded in a Web Part. All you have to do now is to create a new project based on the Web Part library project template.\r\n\r\nThe Web Part library project needs a reference to the .NET assembly generated by the ASP.NET Web application in which you have created the user control. If the namespace you have used for the user control is different than the one you have used for the Web Part, then you will have to declare the namespace at the top of your Web Part code. \r\n\r\nThe CreateChildControls() method now only contains the code that takes care of the creation of our user control object and adding it to the controls collection of the Web Part. In the RenderWebPart() we ask the user control to render itself. As you see, the code is a lot simpler than the one written in the previous article. \r\n\r\nusing System;\r\nusing System.ComponentModel;\r\nusing System.Web.UI;\r\nusing System.Web.UI.WebControls;\r\nusing System.Xml.Serialization;\r\nusing Microsoft.SharePoint;\r\nusing Microsoft.SharePoint.Utilities;\r\nusing Microsoft.SharePoint.WebPartPages;\r\n\r\nnamespace U2U.Samples.WebParts\r\n{\r\n      [ToolboxData(\"<{0}:AmazonUserControl \r\n                        runat=server></{0}:AmazonUserControl>\"),\r\n                        XmlRoot(Namespace=\"U2U.Samples.WebParts\")]\r\n      public class AmazonUserControl : \r\n                              Microsoft.SharePoint.WebPartPages.WebPart\r\n      {\r\n\r\n            protected AmazonSearch amasearch = null;\r\n\r\n            protected override void CreateChildControls()\r\n            {\r\n                  this.amasearch = (AmazonSearch)Page.LoadControl\r\n                                          (\"/UserControls/AmazonSearch.ascx\");\r\n                  this.Controls.Add(this.amasearch);\r\n            }\r\n\r\n\r\n            protected override void RenderWebPart(HtmlTextWriter output)\r\n            {\r\n                  this.EnsureChildControls();\r\n                  this.amasearch.RenderControl(output); \r\n            }\r\n      }\r\n}\r\n \r\n\r\n\r\nTo deploy the web part, make sure you have a DWP file that contains all the details necessary for SharePoint to load the Web Part (that is the title, the description, the fully qualified name of the assembly and the class representing your Web Part). If you make use of the stsadm.exe utility to deploy the Web Part, you also have to modify the manifest.xml in your solution explorer with an entry for your Web Part. The Web Part dll, the dwp file and the manifest.xml should then be packaged in a cabinet file. \r\n\r\nWhen working with the technical refresh however, you need to take care of the following specific tasks within the deployment: \r\n\r\nBoth the Web Part dll and the dll with the code-behind from your user control needs to be made available in the GAC. \r\n\r\nThe assembly of your user controls must be defined as an assembly entry in your web.config.\r\n<compilation...>\r\n    <assemblies>\r\n        <add assembly=\"AmazonUserControls, Version=1.0.0.0, Culture=neutral, \r\n                   PublicKeyToken=12121...,/>\r\n    </assemblies>\r\n</compilation>\r\n\r\n\r\n-------------------------------------------------------------------------------\r\nDebugging Web Parts\r\n-------------------------------------------------------------------------------\r\n\r\nUnfortunately, it is rare that code works on the first try, so it is important to be able to quickly debug Web Parts. Debugging Web Parts is similar to debugging Server Controls and can be tricky. Debugging is not as simple as just pressing run in Debug mode in Visual Studio, but once you have done it, it's a snap. The reason why debugging is more difficult is that the ASP.NET worker process executes all the code to create a Web Part, so you must attach the Debugger to that process in order to debug the Web Part being executed. \r\n\r\nThe first step to debugging is to deploy a Debug version of the Web Part to the server and set a breakpoint where it is needed in the code. Next, follow the instructions below to attach the Debugger to the ASP.NET worker process:\r\n1.  On the Debug menu in Visual Studio .NET, click Processes.\r\n2.  Verify that the \"Show system processes\" check box is selected.\r\n3.  Verify that the \"Show processes in all sessions\" check box is selected.\r\n4.  Under Available Processes, click W3wp.exe in the Process list, and then click Attach.\r\n5.  Under \"Choose the program types that you want to debug,\" select Common Language Runtime, and then click OK.\r\n6.  Click Close. \r\n\r\nYou must browse to the page that the Web Part is installed on so that the worker process can execute the code and hit the set breakpoint. After the breakpoint has been hit, debugging the Web Part is similar to debugging any other application in Visual Studio .NET. When finished, press the stop button in Visual Studio to detach the Debugger from the worker process. \r\n\r\n\r\n-------------------------------------------------------------------------------\r\nCreating a Strong Named Webpart Assembly\r\n-------------------------------------------------------------------------------\r\nCreate a new Visual Studio Web Part Library project.\r\n\r\nWrite the DLL code.  All code should be in the RenderWebPart method.\r\n\r\nUse sn.exe to generate a public key file with the following command:\r\nSn.exe -k c:\\SomeDir\\YourKeyFile.snk\r\nSN.exe should be located in\r\nC:\\Program Files\\Microsoft Visual Studio .NET 2003\\SDK\\v1.1\\Bin\r\n\r\nOpen AssemblyInfo.cs and insure that the version is set to 1.0.0.0\r\n[assembly: AssemblyVersion(\"1.0.0.0\")]\r\n\r\nOpen AssemblyInfo.cs and add the AssemblyKeyFile name that was used in the step above.\r\n[assembly: AssemblyDelaySign(false)]\r\n[assembly: AssemblyKeyFile(\"c:\\\\ SomeDir\\\\YourKeyFile.snk\")]\r\n[assembly: AssemblyKeyName(\"\")]\r\n\r\n\r\nIn the class file, insure that the following matches your class and namespace values.\r\n[DefaultProperty(\"Text\"),\r\n\t\tToolboxData(\"<{0}:WebPart1 runat=server></{0}:WebPart1>\"),\r\n\t\tXmlRoot(Namespace=\"WebPartLibrary1\")]\r\n\r\n\r\nBuild the DLL.\r\n\r\nUse sn.exe to extract the public key from the DLL.\r\nsn.exe -T c:\\YourDir\\YourAssembly.dll\r\n\r\nCopy the DLL to the bin folder of the portal.  (Alternately, you can register it in the GAC with gacutil.exe).\r\n\r\nAdd this entry to web.config in the SPS portal site.  This tells the portal that this is a known safe assembly.\r\n<SafeControl Assembly=\"WebPartLibrary1, Version=1.0.0.0, Culture=neutral, PublicKeyToken=7edc5a4f3cf04efb\" Namespace=\"WebPartLibrary1\" TypeName=\"*\" />\r\n\r\nAdd this entry to the .dwp file.\r\n<Assembly>WebPartLibrary1, Version=1.0.0.0, Culture=Neutral, PublicKeyToken=7edc5a4f3cf04efb</Assembly>\r\n<TypeName>WebPartLibrary1.WebPart1</TypeName>\r\n\r\n\r\nImport the .dwp file into your portal page:\r\n Open the webpart page\r\n Select Modify Shared Page\r\n Select Add Web Parts\r\n Select Import\r\n Select Upload\r\n Drag and drop the webpart onto the page\r\n Viola'\r\n","Declares":"","CodeCategory":{"CategoryId":"25","CategoryDescription":"Sharepoint 2003"},"Keywords":["User Controls","Webparts"]},{"RecordId":"678","Title":"Convert to Local and UTC Time","Description":"Demonstrates how to convert local to UTC and UTC to local time","Code":"private void convertToLocalTime()\r\n{\r\n\r\n\tStreamReader f = new StreamReader(\"DateTime.txt\");\r\n\tstring strDT = f.ReadToEnd();\r\n\tf.Close();\r\n\r\n\tDateTime datDT = DateTime.Parse(strDT,System.Globalization.CultureInfo.InvariantCulture);\r\n\tdatDT = datDT.ToLocalTime();\r\n\tstring strTemp = datDT.ToString();\r\n\r\n}\r\n\r\nprivate void convertToUTC()\r\n{\r\n\r\n\tDateTime datDT = System.DateTime.Now;\r\n\tdatDT = datDT.ToUniversalTime();\r\n\r\n\tstring strDT = datDT.ToString(System.Globalization.CultureInfo.InvariantCulture);\r\n\tStreamWriter f = new StreamWriter(\"DateTime.txt\");\r\n\tf.WriteLine(strDT);\r\n\tf.Close();\r\n\r\n}\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["UTC","Local Time","Datetime Conversion"]},{"RecordId":"679","Title":"Add / Remove User from SPS Site Group (Role)","Description":"Code to add a user to and remove a user from an SPS Site Group (Role)","Code":"// Insures that user is a valid site user.  If not, adds the user.\r\nprivate void addUserToSite(SPWeb SPSSite, string userToAdd, string userEMail, string userDisplayName) \r\n{\r\n\r\n\ttry \r\n\t{\r\n\t\tSPUser oUser = SPSSite.Users[userToAdd];\r\n\t} \r\n\tcatch \r\n\t{\r\n\r\n\t\t// This puts the user in the role\r\n\t\tSPRole readers = SPSSite.Roles[\"SPS Readers\"];\r\n\t\treaders.AddUser(userToAdd,\"\",\"\",\"\");\r\n\r\n\t\t// You have to go after the fact to set the display name and email (even though they are parms on the .AddUser method above (Go figure...)\r\n\t\tSPUser oUser = SPSSite.Users[userToAdd];\t\r\n\t\toUser.Name = userDisplayName;\r\n\t\toUser.Update();\r\n\t}\r\n\r\n}\r\n\r\n\r\n// Adds a user to a SPS Site Group\r\nprivate void addUserToRole(SPWeb SPSSite, string userToAdd, string siteRole, string userEMail, string userDisplayName) \r\n{\r\n\taddUserToSite(SPSSite, userToAdd,userEMail,userDisplayName);\r\n\tSPUser oUser = SPSSite.Users[userToAdd];\r\n\tSPRole oRole = SPSSite.Roles[siteRole];\r\n\toRole.AddUser(oUser);\r\n}\r\n\r\n\r\n// Removes a user to a SPS Site Group\r\nprivate void removeUserFromRole(SPWeb SPSSite, string userToAdd, string siteRole) \r\n{\r\n\tSPUser oUser = SPSSite.Users[userToAdd];\r\n\tSPRole oRole = SPSSite.Roles[siteRole];\r\n\toRole.RemoveUser(oUser);\r\n}\r\n\r\n\r\n// Call to add a user to a site group\r\nstring strUser = @\"somedomain\\someuser\";\r\nstring strEmail = \"someuser@somedomain.com\";\r\nstring strDisplayName = \"Users Display Name\";\r\nstring strRole = \"SPS Approvers\";\r\nSPWeb site = SPControl.GetContextSite(Context).OpenWeb();\r\naddUserToRole(site,strUser, strRole,strEmail,strDisplayName);\r\n\r\n\r\n// Call to remove a user from a site group\r\nSPWeb site = SPControl.GetContextSite(Context).OpenWeb();\r\nremoveUserFromRole(site,@\"USDEV\\sps21\", \"ERS Content Manager\");\r\n\r\n\r\n\r\n\r\n// The following is needed at the top of the ASPX\r\n<%@ Register Tagprefix=\"SharePoint\" Namespace=\"Microsoft.SharePoint.WebControls\" Assembly=\"Microsoft.SharePoint, Version=11.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c\" %>\r\n\r\n// You need a formdigest control in the form\r\n<form id=\"Form1\" method=\"post\" runat=\"server\">\r\n\t<SHAREPOINT:FORMDIGEST id=\"Formdigest1\" runat=\"server\"></SHAREPOINT:FORMDIGEST>\r\n</form>\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"25","CategoryDescription":"Sharepoint 2003"},"Keywords":["Role","Site Group"]},{"RecordId":"680","Title":"HTTP Modules","Description":"Good article that demonstrates how to build and implement an HTTP Module.","Code":"The HTTP Pipeline is a series of extensible objects that are initiated by the ASP.NET runtime in order to process a request. Http Handlers and Http Modules are .NET components that serve as the main points of extensibility in the pipeline. This article, will demonstrate how to create an HTTP Module. Http modules are filters that can pre and post-process requests as they pass through the pipeline\r\n\r\nAt the most fundamental level, ASP.NET HTTP Modules are classes which implement the System.Web.IHttpModule interface, illustrated below: \r\n\r\npublic interface IHttpModule \r\n{ \r\nvoid Dispose(); \r\nvoid Init(HttpApplication context); \r\n} \r\n\r\nIn order to insure that your HttpHandler is hooked up to the HTTP pipeline requires an entry in the applications web config. or the machine.config file. The same holds true for HTTP modules. When an HTTP Module is added to the pipeline, the ASP.NET runtime will call the methods of the IHttpModule interface at the appropriate times. When the module is first created by the runtime, the Init method is called. As illustrated above, the parameter passed into the Init method allows your code to tie into the HttpApplication object.\r\n\r\nThe following table lists the key events exposed by the HttpApplication object. Note that all these events are implemented as multicast delegates so that numerous modules can register for each one. \r\n\r\nBeginRequest \r\nBefore request processing starts \r\n\r\nAuthenticateRequest \r\nTo authenticate client \r\n\r\nAuthorizeRequest \r\nTo perform access check \r\n\r\nResolveRequestCache \r\nTo get response from cache \r\n\r\nAcquireRequestState \r\nTo load session state \r\n\r\nPreRequestHandlerExecute \r\nBefore request sent to handler \r\n\r\nPostRequestHandlerExecute \r\nAfter request sent to handler \r\n\r\nReleaseRequestState \r\nTo store session state \r\n\r\nUpdateRequestCache \r\nTo update response cache \r\n\r\nEndRequest \r\nAfter processing ends \r\n\r\nPreSendRequestHeaders \r\nBefore buffered response headers sent \r\n\r\nPreSendRequestContent \r\nBefore buffered response body sent \r\n\r\n\r\nIn addition to the above methods, we can also respond to the methods in the global.asax file for the HttpApplication object. These events include the session start and end events, as well as the start and end events for the application. \r\n\r\nLets create a simple HTTP module and hook it up to the pipeline. In the following example, the SampleModule class implements the IHttpModule interface. When the Init method is called by the runtime, the module hooks up to the events of the HttpApplication object. In this example, we have registered for the applications BeginRequest event as well as its EndRequest event. In our implementation of these methods, we simply record the time the request was sent in, and then we record the difference between times when the request is finished. In order to send the output to the response stream in some fashion, we add the result to the header of the HTTP response. \r\n\r\nusing System; \r\nusing System.Web; \r\nnamespace MikeModules \r\n{ \r\npublic class SampleModule : IHttpModule \r\n{ \r\nDateTime beginrequest; \r\npublic void Init(HttpApplication app) \r\n{ \r\n// register for events created by the pipeline \r\napp.BeginRequest += new EventHandler(this.OnBeginRequest); \r\npp.EndRequest += new EventHandler(this.OnEndRequest); \r\n} \r\npublic void Dispose() {} \r\npublic void OnBeginRequest(object o, EventArgs args) \r\n\r\n{ \r\n// obtain the time of the current request \r\nbeginrequest = DateTime.Now; \r\n} \r\n\r\npublic void OnEndRequest(object o, EventArgs args) \r\n{ \r\n// get the time elapsed for the request \r\nTimeSpan elapsedtime = DateTime.Now - beginrequest; \r\n// get access to application object and the context object \r\nHttpApplication app =(HttpApplication) o; \r\nHttpContext ctx = app.Context; \r\n// add header to HTTP response \r\nctx.Response.AppendHeader(\"ElapsedTime\", elapsedtime.ToString()); \r\n} \r\n} \r\n} \r\n\r\nSimilar to ASP.NET HTTP Handlers, we need to notify the ASP.NET runtime that we wish to hook up our module to the pipeline. Once the module has been built and deployed to the applications bin directory or the machines GAC, it must be registered in either the web.config file or the machine.config file. The following code adds a module to the \r\n\r\nIIS metabase: \r\n\r\n<httpModules> \r\n<add type=classname, assemblyname name=modulename/> \r\n<httpModules> \r\n\r\nIn order to add our module, we must implement the following code in the web.config file: \r\n\r\n<configuration> \r\n<system.web> \r\n<httpModules> \r\n<add name=\"TimeElapsedModule type=\"SampleModules.SampleModule,SampleModules \"/> \r\n</httpModules> \r\n</system.web> \r\n</configuration> \r\n\r\nIn this example, the Web.config file tells the pipeline to attach an instance of the SampleModules.SimpleModule class to every HttpApplication object instantiated to service requests that target this application. \r\n\r\nOne of the most common operations when intercepting an HTTP request is to terminate the request. This is very common in custom authentication modules added to ASP.NET. In this case, the HttpApplication class has a method called CompleteRequest that is called for finishing the request. Calling CompleteRequest with the appropriate status codes can terminate the request. \r\n\r\nASP.NET HTTP Modules can be used to further extend the HTTP pipeline. Many of the services provided by the runtime are implemented as HTTP modules. Common uses for creating custom modules include custom authentication and authorization schemes, in addition to any other filtering services that your application needs.","Declares":"","CodeCategory":{"CategoryId":"20","CategoryDescription":".Net - ASP.Net"},"Keywords":["HTTP Module","HTTP Handler"]},{"RecordId":"681","Title":"App.Path in C#","Description":"Function to retrieve app.path","Code":"private string getAppExePath() \r\n{\r\n\tstring strExePath = Application.ExecutablePath;\r\n\tint intLastSlash = strExePath.LastIndexOf(@\"\\\");\r\n\tif (intLastSlash >= 0) \r\n\t{\r\n\t\tstrExePath = strExePath.Substring(0,intLastSlash + 1);\r\n\t}\r\n\treturn strExePath;\r\n}\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["App.Path"]},{"RecordId":"682","Title":"Passing DataGrid Data From One ASPX Page to Another","Description":"Demonstrates how to display a datagrid on one page and post it's data (using Server.Transfer) to a second page.","Code":"Passing DataGrid Data From One ASPX Page to Another\r\n\r\nLet us consider two ASP.NET Web pages that are assigned the following duties: \r\n\r\nSendingPage.aspx: -   Populates a DataGrid Web control with database data and presents \r\n                                    the user with a form that, when submitted, redirects them to the second\r\n                                    page, ReceivingPage.aspx \r\n\r\nReceivingPage.aspx - Called from SendingPage.aspx; reads in the data of the DataGrid \r\n                                    created in SendingPage.aspx. \r\n\r\n---------------------------------------------\r\nSending the Data\r\n---------------------------------------------\r\nThe code below creates a DataGrid populated with the data from the Authors table of the SQL Server pubs database. \r\n\r\n<%@ Page Language=\"VB\" ClassName=\"SendingPage\" %>\r\n<%@ Import Namespace=\"System.Data\" %>\r\n<%@ Import Namespace=\"System.Data.SqlClient\" %>\r\n<script runat=\"server\">\r\n  Public ReadOnly Property GridData() As System.Object\r\n    Get\r\n      ' Datasource of Datagrid1 is a data table inside a dataset\r\n      Return DataGrid1.DataSource\r\n    End Get\r\n  End Property\r\n\r\n  Sub Button_Clicked (sender As Object, e As EventArgs)\r\n    Server.Transfer(\"ReceivingPage.aspx\")\r\n  End Sub\r\n\r\n  Sub Page_Load(sender As Object, e As EventArgs)\r\n    'bind some relevant data to the grid at page load\r\n    GetData()\r\n  End Sub\r\n\r\n  Sub GetData()\r\n    Dim DS As System.Data.DataSet\r\n    Dim Con As System.Data.SqlClient.SqlConnection\r\n    Dim Ada As System.Data.SqlClient.SqlDataAdapter\r\n    Dim connStr as String\r\n    conStr = \"server=localhost;uid=sa;pwd=;initial catalog=pubs\"\r\n    \r\n    Con = New System.Data.SqlClient.SqlConnection(connStr)\r\n    \r\n    Ada = New System.Data.SqlClient.SqlDataAdapter(_\r\n              \"select * from authors\", Con)\r\n    \r\n    DS = New System.Data.DataSet()\r\n    Ada.Fill(DS, \"Table1\")    \r\n    \r\n    'Fill the DataGrid\r\n    DataGrid1.DataSource = DS.Tables(\"Table1\").DefaultView\r\n    DataGrid1.DataBind()\r\n  End Sub\r\n</script>\r\n\r\n<html>\r\n<body>\r\n  <form runat=\"server\">\r\n      <b>Visiting SendingPage.aspx</b>\r\n      <asp:datagrid id=DataGrid1 runat=server />\r\n\r\n      <asp:Button id=\"myButton\" OnClick=\"Button_Clicked\" \r\n            Text=\"Send Grid Data\" runat=server />\r\n  </form>\r\n</body>\r\n</html>\r\n\r\n \r\n---------------------------------------------\r\nReceiving the Data\r\n---------------------------------------------\r\nOn the receiving page We can retrieve an instance of the handler that first received the HTTP request from the Handler property of the Context object.  Essentially, we'll get the handler back from the Context object and cast it to an instance of the SendingPage class.  \r\n\r\nThe code in the ReceivingPage class would look as follows: \r\n\r\n  Public objSendingPage As sendingPage\r\n\r\n  Private Sub Page_Load(ByVal sender As System.Object, _\r\n                 ByVal e As System.EventArgs) Handles MyBase.Load\r\n    'Put user code to initialize the page here\r\n    If Not IsPostBack Then\r\n      objSendingPage = CType(context.Handler, SendingPage)\r\n    End If\r\n\r\n    receivingDG.DataSource = objSendingPage.GridData\r\n    receivingDG.DataBind()\r\n  End Sub","Declares":"","CodeCategory":{"CategoryId":"20","CategoryDescription":".Net - ASP.Net"},"Keywords":["Server.Transfer","Passing DataGrid"]},{"RecordId":"683","Title":"Read and Write Text File Without Character Translation Problems","Description":"Demonstrates how to read and write a text file without encountering character translation (encoding) problems.","Code":"StreamReader oRDR = new StreamReader(\"filein.htm\",System.Text.Encoding.Default);\r\nstring strBuffer = oRDR.ReadToEnd();\r\noRDR.Close();\r\n\r\nStreamWriter oWTR = new StreamWriter(\"fileout.htm\",false,System.Text.Encoding.Default);\r\noWTR.Write(strBuffer);\r\noWTR.Close();\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Character Translation Encoding","File I/O","Read Write File"]},{"RecordId":"684","Title":"Object Creation Using Factory Pattern","Description":"Demonstrates how to employ programming to interfaces and creating objects via a factory instead of direct object creation.","Code":"// ----------------------------------------------------------------------\r\n// IBaseObject.cs\r\n// ----------------------------------------------------------------------\r\n\r\nusing System;\r\n\r\nnamespace FactoryPattern\r\n{\r\n  public interface IBaseObject\r\n  {\r\n    string getSomeInfo();\r\n  }\r\n}\r\n\r\n\r\n// ----------------------------------------------------------------------\r\n// BaseObject.cs\r\n// ----------------------------------------------------------------------\r\n\r\nusing System;\r\n\r\nnamespace FactoryPattern\r\n{\r\n  public class BaseObject: IBaseObject\r\n  {\r\n    public BaseObject() { }\r\n\r\n    public string getSomeInfo()\r\n    {\r\n      return \"getSomeInfo() called in BaseObject class\";\r\n    }\r\n  }\r\n}\r\n\r\n\r\n\r\n// ----------------------------------------------------------------------\r\n// IFactory.cs\r\n// ----------------------------------------------------------------------\r\n\r\nusing System;\r\n\r\nnamespace FactoryPattern\r\n{\r\n  public interface IFactory\r\n  {\r\n    IBaseObject Create();\r\n  }\r\n}\r\n\r\n\r\n// ----------------------------------------------------------------------\r\n// Factory.cs\r\n// ----------------------------------------------------------------------\r\n\r\nusing System;\r\n\r\nnamespace FactoryPattern\r\n{\r\n  public class Factory: IFactory\r\n  {\r\n    public Factory() { }\r\n\r\n    public IBaseObject Create()\r\n    {\r\n      return new BaseObject();\r\n    }\r\n  }\r\n}\r\n\r\n\r\n\r\n// ----------------------------------------------------------------------\r\n// Client.cs\r\n// ----------------------------------------------------------------------\r\n\r\nIFactory oFactory = (IFactory) new Factory();\r\nIBaseObject oBase = oFactory.Create();\r\nstring strSomeInfo = oBase.getSomeInfo();","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Factory Pattern","Interface Programming"]},{"RecordId":"685","Title":"Singleton Objects","Description":"Demonstrates how to create a Singleton object (one in which only one instance of it exists for multiple clients).  NOTE:  This one is not thread-safe.","Code":"//-------------------------------------------------------------------------------\r\n// SingletonObject.cs\r\n//-------------------------------------------------------------------------------\r\n\r\nusing System;\r\n\r\nnamespace SingletonPattern\r\n{\r\n  public sealed class SingletonObject\r\n  {\r\n    // Static + readonly = best way to create the object    \r\n    private static readonly SingletonObject instance = new SingletonObject();\t\r\n\r\n    private SingletonObject() { } // Make constructor private\r\n\r\n    public static SingletonObject Instance\r\n    {\r\n      get \r\n      {\r\n        return instance;\r\n      }\r\n    }\r\n\r\n    public string getSomeInfo() \r\n    {\r\n      return &amp;quot;getSomeInfo() from Singleton object&amp;quot;;\r\n    }\r\n  }\r\n}\r\n\r\n\r\n//-------------------------------------------------------------------------------\r\n// Client.cs\r\n//-------------------------------------------------------------------------------\r\n\r\nSingletonObject oSingleton = SingletonObject.Instance;\r\nstring strTemp = oSingleton.getSomeInfo();\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Singleton Pattern"]},{"RecordId":"686","Title":"Design Patterns","Description":"Samples of all 23 design patterns","Code":"//----------------------------------------------------------------\r\n// Abstract Factory pattern -- Structural example  \r\n//----------------------------------------------------------------\r\n\r\nusing System;\r\n\r\n// \"AbstractFactory\"\r\n\r\nabstract class AbstractFactory\r\n{\r\n  // Methods\r\n  abstract public AbstractProductA CreateProductA();\r\n  abstract public AbstractProductB CreateProductB();\r\n}\r\n\r\n// \"ConcreteFactory1\"\r\n\r\nclass ConcreteFactory1 : AbstractFactory\r\n{\r\n  // Methods\r\n  override public AbstractProductA CreateProductA()\r\n  {\r\n    return new ProductA1();\r\n  }\r\n  override public AbstractProductB CreateProductB()\r\n  {\r\n    return new ProductB1();\r\n  }\r\n}\r\n\r\n// \"ConcreteFactory2\"\r\n\r\nclass ConcreteFactory2 : AbstractFactory\r\n{\r\n  // Methods\r\n  override public AbstractProductA CreateProductA()\r\n  {\r\n    return new ProductA2();\r\n  }\r\n\r\n  override public AbstractProductB CreateProductB()\r\n  {\r\n    return new ProductB2();\r\n  }\r\n}\r\n\r\n// \"AbstractProductA\"\r\n\r\nabstract class AbstractProductA\r\n{\r\n}\r\n\r\n// \"AbstractProductB\"\r\n\r\nabstract class AbstractProductB\r\n{\r\n  // Methods\r\n  abstract public void Interact( AbstractProductA a );\r\n}\r\n\r\n// \"ProductA1\"\r\n \r\nclass ProductA1 : AbstractProductA\r\n{\r\n}\r\n\r\n// \"ProductB1\"\r\n\r\nclass ProductB1 : AbstractProductB\r\n{\r\n  // Methods\r\n  override public void Interact( AbstractProductA a )\r\n  {\r\n    Console.WriteLine( this + \" interacts with \" + a );\r\n  }\r\n}\r\n\r\n// \"ProductA2\"\r\n\r\nclass ProductA2 : AbstractProductA\r\n{\r\n}\r\n\r\n// \"ProductB2\"\r\n\r\nclass ProductB2 : AbstractProductB\r\n{\r\n  // Methods\r\n  override public void Interact( AbstractProductA a )\r\n  {\r\n    Console.WriteLine( this + \" interacts with \" + a );\r\n  }\r\n}\r\n\r\n// \"Client\" - the interaction environment of the products\r\n\r\nclass Environment\r\n{\r\n  // Fields\r\n  private AbstractProductA AbstractProductA;\r\n  private AbstractProductB AbstractProductB;\r\n\r\n  // Constructors\r\n  public Environment( AbstractFactory factory )\r\n  {\r\n    AbstractProductB = factory.CreateProductB();\r\n    AbstractProductA = factory.CreateProductA();\r\n  }\r\n \r\n  // Methods\r\n  public void Run()\r\n  {\r\n    AbstractProductB.Interact( AbstractProductA );\r\n  }\r\n}\r\n\r\n/// <summary>\r\n/// ClientApp test environment\r\n/// </summary>\r\nclass ClientApp\r\n{\r\n  public static void Main(string[] args)\r\n  {\r\n    AbstractFactory factory1 = new ConcreteFactory1();\r\n    Environment e1 = new Environment( factory1 );\r\n    e1.Run();\r\n\r\n    AbstractFactory factory2 = new ConcreteFactory2();\r\n    Environment e2 = new Environment( factory2 );\r\n    e2.Run();\r\n  }\r\n}\r\n \r\n\r\nOutput \r\nProductB1 interacts with ProductA1\r\nProductB2 interacts with ProductA2\r\n\r\n\r\n//----------------------------------------------------------------\r\n// Adapter pattern -- Structural example  \r\n//----------------------------------------------------------------\r\n\r\nusing System;\r\n\r\n// \"Target\"\r\n\r\nclass Target\r\n{\r\n  // Methods\r\n  virtual public void Request()\r\n  {\r\n    // Normal implementation goes here\r\n  }\r\n}\r\n\r\n// \"Adapter\"\r\n\r\nclass Adapter : Target\r\n{\r\n  // Fields\r\n  private Adaptee adaptee = new Adaptee();\r\n\r\n  // Methods\r\n  override public void Request()\r\n  {\r\n    // Possibly do some data manipulation\r\n    // and then call SpecificRequest\r\n    adaptee.SpecificRequest();\r\n  }\r\n}\r\n\r\n// \"Adaptee\"\r\n\r\nclass Adaptee\r\n{\r\n  // Methods\r\n  public void SpecificRequest()\r\n  {\r\n    Console.WriteLine(\"Called SpecificRequest()\" );\r\n  }\r\n}\r\n\r\n/// <summary>\r\n/// Client test\r\n/// </summary>\r\npublic class Client\r\n{\r\n  public static void Main(string[] args)\r\n  {\r\n    // Create adapter and place a request\r\n    Target t = new Adapter();\r\n    t.Request();\r\n\r\n  }\r\n}\r\n \r\n\r\nOutput \r\nCalled SpecificRequest()\r\n\r\n\r\n//----------------------------------------------------------------\r\n// Bridge pattern -- Structural example  \r\n//----------------------------------------------------------------\r\n\r\nusing System;\r\n\r\n// \"Abstraction\"\r\n\r\nclass Abstraction\r\n{\r\n  // Fields\r\n  protected Implementor implementor;\r\n\r\n  // Properties\r\n  public Implementor Implementor\r\n  {\r\n    set{ implementor = value; }\r\n  }\r\n\r\n  // Methods\r\n  virtual public void Operation()\r\n  {\r\n    implementor.Operation();\r\n  }\r\n}\r\n\r\n// \"Implementor\"\r\n\r\nabstract class Implementor\r\n{\r\n  // Methods\r\n  abstract public void Operation();\r\n}\r\n\r\n// \"RefinedAbstraction\"\r\n\r\nclass RefinedAbstraction : Abstraction\r\n{\r\n  // Methods\r\n  override public void Operation()\r\n  {\r\n    implementor.Operation();\r\n  }\r\n}\r\n\r\n// \"ConcreteImplementorA\"\r\n\r\nclass ConcreteImplementorA : Implementor\r\n{\r\n  // Methods\r\n  override public void Operation()\r\n  {\r\n    Console.WriteLine(\"ConcreteImplementorA Operation\");\r\n  }\r\n}\r\n\r\n// \"ConcreteImplementorB\"\r\n\r\nclass ConcreteImplementorB : Implementor\r\n{\r\n  // Methods\r\n  override public void Operation()\r\n  {\r\n    Console.WriteLine(\"ConcreteImplementorB Operation\");\r\n  }\r\n}\r\n\r\n/// <summary>\r\n/// Client test\r\n/// </summary>\r\npublic class Client\r\n{\r\n  public static void Main( string[] args )\r\n  {\r\n    Abstraction abstraction = new RefinedAbstraction();\r\n\r\n    // Set implementation and call\r\n    abstraction.Implementor = new ConcreteImplementorA();\r\n    abstraction.Operation();\r\n\r\n    // Change implemention and call\r\n    abstraction.Implementor = new ConcreteImplementorB();\r\n    abstraction.Operation();\r\n  }\r\n}\r\n \r\n\r\nOutput \r\nConcreteImplementorA Operation\r\nConcreteImplementorB Operation\r\n\r\n\r\n//----------------------------------------------------------------\r\n// Builder pattern -- Structural example  \r\n//----------------------------------------------------------------\r\n\r\nusing System;\r\nusing System.Collections;\r\n\r\n// \"Director\"\r\n\r\nclass Director\r\n{\r\n  // Methods\r\n  public void Construct( Builder builder )\r\n  {\r\n    builder.BuildPartA();\r\n    builder.BuildPartB();\r\n  }\r\n}\r\n\r\n// \"Builder\"\r\n\r\nabstract class Builder\r\n{\r\n  // Methods\r\n  abstract public void BuildPartA();\r\n  abstract public void BuildPartB();\r\n  abstract public Product GetResult();\r\n}\r\n\r\n// \"ConcreteBuilder1\"\r\n\r\nclass ConcreteBuilder1 : Builder\r\n{\r\n  // Fields\r\n  private Product product;\r\n\r\n  // Methods\r\n  override public void BuildPartA()\r\n  {\r\n    product = new Product();\r\n    product.Add( \"PartA\" );\r\n  }\r\n\r\n  override public void BuildPartB()\r\n  {\r\n    product.Add( \"PartB\" );\r\n  }\r\n\r\n  override public Product GetResult()\r\n  {\r\n    return product;\r\n  }\r\n}\r\n\r\n// \"ConcreteBuilder2\"\r\n\r\nclass ConcreteBuilder2 : Builder\r\n{\r\n  // Fields\r\n  private Product product;\r\n\r\n  // Methods\r\n  override public void BuildPartA()\r\n  {\r\n    product = new Product();\r\n    product.Add( \"PartX\" );\r\n  }\r\n\r\n  override public void BuildPartB()\r\n  {\r\n    product.Add( \"PartY\" );\r\n  }\r\n\r\n  override public Product GetResult()\r\n  {\r\n    return product;\r\n  }\r\n}\r\n\r\n// \"Product\"\r\n\r\nclass Product\r\n{\r\n  // Fields\r\n  ArrayList parts = new ArrayList();\r\n \r\n  // Methods\r\n  public void Add( string part )\r\n  {\r\n    parts.Add( part );\r\n  }\r\n\r\n  public void Show()\r\n  {\r\n    Console.WriteLine( \"\\nProduct Parts -------\" );\r\n    foreach( string part in parts )\r\n      Console.WriteLine( part );\r\n  }\r\n}\r\n/// <summary>\r\n/// Client test\r\n/// </summary>\r\npublic class Client\r\n{\r\n  public static void Main( string[] args )\r\n  {\r\n    // Create director and builders\r\n    Director director = new Director( );\r\n\r\n    Builder b1 = new ConcreteBuilder1();\r\n    Builder b2 = new ConcreteBuilder2();\r\n\r\n    // Construct two products\r\n    director.Construct( b1 );\r\n    Product p1 = b1.GetResult();\r\n    p1.Show();\r\n\r\n    director.Construct( b2 );\r\n    Product p2 = b2.GetResult();\r\n    p2.Show();\r\n  }\r\n}\r\n \r\n\r\nOutput \r\nProduct Parts -------\r\nPartA\r\nPartB\r\n\r\nProduct Parts -------\r\nPartX\r\nPartY\r\n\r\n\r\n//----------------------------------------------------------------\r\n// Chain of Responsibility pattern -- Structural example  \r\n//----------------------------------------------------------------\r\n\r\nusing System;\r\n\r\n// \"Handler\"\r\n\r\nabstract class Handler\r\n{\r\n  // Fields\r\n  protected Handler successor;\r\n \r\n  // Methods\r\n  public void SetSuccessor( Handler successor )\r\n  {\r\n    this.successor = successor;\r\n  }\r\n  abstract public void HandleRequest( int request );\r\n}\r\n\r\n// \"ConcreteHandler1\"\r\n\r\nclass ConcreteHandler1 : Handler\r\n{\r\n  // Methods\r\n  override public void HandleRequest( int request )\r\n  {\r\n    if( request >= 0 && request < 10 )\r\n      Console.WriteLine(\"{0} handled request {1}\",\r\n        this, request );\r\n    else\r\n      if( successor != null )\r\n        successor.HandleRequest( request );\r\n  }\r\n}\r\n\r\n// \"ConcreteHandler2\"\r\n\r\nclass ConcreteHandler2 : Handler\r\n{\r\n  // Methods\r\n  override public void HandleRequest( int request )\r\n  {\r\n    if( request >= 10 && request < 20 )\r\n      Console.WriteLine(\"{0} handled request {1}\",\r\n        this, request );\r\n    else\r\n      if( successor != null )\r\n        successor.HandleRequest( request );\r\n  }\r\n}\r\n\r\n// \"ConcreteHandler3\"\r\n\r\nclass ConcreteHandler3 : Handler\r\n{\r\n  // Methods\r\n  override public void HandleRequest( int request )\r\n  {\r\n    if( request >= 20 && request < 30 )\r\n      Console.WriteLine(\"{0} handled request {1}\",\r\n        this, request );\r\n    else\r\n      if( successor != null )\r\n        successor.HandleRequest( request );\r\n  }\r\n}\r\n\r\n// \"Request\"\r\n\r\nclass Request\r\n{\r\n  // Fields\r\n  private int iRequestType;\r\n  private string strRequestParameters;\r\n\r\n  // Constructors\r\n  public Request(int requestType, string requestParameters)\r\n  {\r\n    iRequestType = requestType;\r\n    strRequestParameters = requestParameters;\r\n  }\r\n\r\n  // Properties\r\n  public int RequestType\r\n  {\r\n    get{ return iRequestType; }\r\n    set{iRequestType = value; }\r\n  }\r\n}\r\n\r\n/// <summary>\r\n/// Client test\r\n/// </summary>\r\npublic class Client\r\n{\r\n  public static void Main( string[] args )\r\n  {\r\n    // Setup Chain of Responsibility\r\n    Handler h1 = new ConcreteHandler1();\r\n    Handler h2 = new ConcreteHandler2();\r\n    Handler h3 = new ConcreteHandler3();\r\n    h1.SetSuccessor(h2);\r\n    h2.SetSuccessor(h3);\r\n\r\n    // Generate and process request\r\n    int[] requests = { 2, 5, 14, 22, 18, 3, 27, 20 };\r\n\r\n    foreach( int request in requests )\r\n      h1.HandleRequest( request );\r\n\r\n    }\r\n}\r\n \r\n\r\nOutput \r\nConcreteHandler1 handled request 2\r\nConcreteHandler1 handled request 5\r\nConcreteHandler2 handled request 14\r\nConcreteHandler3 handled request 22\r\nConcreteHandler2 handled request 18\r\nConcreteHandler1 handled request 3\r\nConcreteHandler3 handled request 27\r\nConcreteHandler3 handled request 20\r\n\r\n\r\n//----------------------------------------------------------------\r\n// Command pattern -- Structural example  \r\n//----------------------------------------------------------------\r\n\r\nusing System;\r\n\r\n// \"Command\"\r\n\r\nabstract class Command\r\n{\r\n  // Fields\r\n  protected Receiver receiver;\r\n\r\n  // Constructors\r\n  public Command( Receiver receiver )\r\n  {\r\n    this.receiver = receiver;\r\n  }\r\n\r\n  // Methods\r\n  abstract public void Execute();\r\n}\r\n\r\n// \"ConcreteCommand\"\r\n\r\nclass ConcreteCommand : Command\r\n{\r\n  // Constructors\r\n  public ConcreteCommand( Receiver receiver ) :\r\n                              base ( receiver ) {}\r\n\r\n  // Methods\r\n  public override void Execute()\r\n  {\r\n    receiver.Action();\r\n  }\r\n}\r\n\r\n// \"Receiver\"\r\n\r\nclass Receiver\r\n{\r\n  // Methods\r\n  public void Action()\r\n  {\r\n    Console.WriteLine(\"Called Receiver.Action()\");\r\n  }\r\n}\r\n\r\n// \"Invoker\"\r\n\r\nclass Invoker\r\n{\r\n  // Fields\r\n  private Command command;\r\n\r\n  // Methods\r\n  public void SetCommand( Command command )\r\n  {\r\n    this.command = command;\r\n  }\r\n\r\n  public void ExecuteCommand()\r\n  {\r\n    command.Execute();\r\n  }\r\n}\r\n\r\n/// <summary>\r\n///  Client test\r\n/// </summary>\r\npublic class Client\r\n{\r\n  public static void Main( string[] args )\r\n  {\r\n    // Create receiver, command, and invoker\r\n    Receiver r = new Receiver();\r\n    Command c = new ConcreteCommand( r );\r\n    Invoker i = new Invoker();\r\n\r\n    // Set and execute command\r\n    i.SetCommand(c);\r\n    i.ExecuteCommand();\r\n  }\r\n}\r\n \r\n\r\nOutput \r\nCalled Receiver.Action()\r\n\r\n\r\n//----------------------------------------------------------------\r\n// Composite pattern -- Structural example  \r\n//----------------------------------------------------------------\r\n\r\nusing System;\r\nusing System.Text;\r\nusing System.Collections;\r\n\r\n// \"Component\"\r\n\r\nabstract class Component\r\n{\r\n  // Fields\r\n  protected string name;\r\n\r\n  // Constructors\r\n  public Component( string name )\r\n  {\r\n    this.name = name;\r\n  }\r\n\r\n  // Methods\r\n  abstract public void Add(Component c);\r\n  abstract public void Remove( Component c );\r\n  abstract public void Display( int depth );\r\n}\r\n\r\n// \"Composite\"\r\n\r\nclass Composite : Component\r\n{\r\n  // Fields\r\n  private ArrayList children = new ArrayList();\r\n\r\n  // Constructors\r\n  public Composite( string name ) : base( name ) {}\r\n\r\n  // Methods\r\n  public override void Add( Component component )\r\n  {\r\n    children.Add( component );\r\n  }\r\n  public override void Remove( Component component )\r\n  {\r\n    children.Remove( component );\r\n  }\r\n  public override void Display( int depth )\r\n  {\r\n    Console.WriteLine( new String( '-', depth ) + name );\r\n\r\n    // Display each of the node's children\r\n    foreach( Component component in children )\r\n      component.Display( depth + 2 );\r\n  }\r\n}\r\n\r\n// \"Leaf\"\r\n\r\nclass Leaf : Component\r\n{\r\n  // Constructors\r\n  public Leaf( string name ) : base( name ) {}\r\n\r\n  // Methods\r\n  public override void Add( Component c )\r\n  {\r\n    Console.WriteLine(\"Cannot add to a leaf\");\r\n  }\r\n\r\n  public override void Remove( Component c )\r\n  {\r\n    Console.WriteLine(\"Cannot remove from a leaf\");\r\n  }\r\n\r\n  public override void Display( int depth )\r\n  {\r\n    Console.WriteLine( new String( '-', depth ) + name );\r\n  }\r\n}\r\n\r\n/// <summary>\r\n/// Client test\r\n/// </summary>\r\npublic class Client\r\n{\r\n  public static void Main( string[] args )\r\n  {\r\n    // Create a tree structure\r\n    Composite root = new Composite( \"root\" );\r\n    root.Add( new Leaf( \"Leaf A\" ));\r\n    root.Add( new Leaf( \"Leaf B\" ));\r\n    Composite comp = new Composite( \"Composite X\" );\r\n\r\n    comp.Add( new Leaf( \"Leaf XA\" ) );\r\n    comp.Add( new Leaf( \"Leaf XB\" ) );\r\n    root.Add( comp );\r\n\r\n    root.Add( new Leaf( \"Leaf C\" ));\r\n\r\n    // Add and remove a leaf\r\n    Leaf l = new Leaf( \"Leaf D\" );\r\n    root.Add( l );\r\n    root.Remove( l );\r\n\r\n    // Recursively display nodes\r\n    root.Display( 1 );\r\n  }\r\n}  \r\n\r\nOutput \r\n-root\r\n---Leaf A\r\n---Leaf B\r\n---Composite X\r\n-----Leaf XA\r\n-----Leaf XB\r\n---Leaf C\r\n\r\n\r\n//----------------------------------------------------------------\r\n// Decorator pattern -- Structural example  \r\n//----------------------------------------------------------------\r\n\r\nusing System;\r\n\r\n// \"Component\"\r\n\r\nabstract class Component\r\n{\r\n  // Methods\r\n  abstract public void Operation();\r\n}\r\n\r\n// \"ConcreteComponent\"\r\n\r\nclass ConcreteComponent : Component\r\n{\r\n  // Methods\r\n  override public void Operation()\r\n  {\r\n    Console.WriteLine(\"ConcreteComponent.Operation()\");\r\n  }\r\n}\r\n\r\n// \"Decorator\"\r\n\r\nabstract class Decorator : Component\r\n{\r\n  // Fields\r\n  protected Component component;\r\n\r\n  // Methods\r\n  public void SetComponent( Component component )\r\n  {\r\n    this.component = component;\r\n  }\r\n\r\n  override public void Operation()\r\n  {\r\n    if( component != null )\r\n      component.Operation();\r\n  }\r\n}\r\n\r\n// \"ConcreteDecoratorA\"\r\n\r\nclass ConcreteDecoratorA : Decorator\r\n{\r\n  // Fields\r\n  private string addedState;\r\n\r\n  // Methods\r\n  override public void Operation()\r\n  {\r\n    base.Operation();\r\n    addedState = \"new state\";\r\n    Console.WriteLine(\"ConcreteDecoratorA.Operation()\");\r\n  }\r\n}\r\n\r\n// \"ConcreteDecoratorB\"\r\n\r\nclass ConcreteDecoratorB : Decorator\r\n{\r\n  // Methods\r\n  override public void Operation()\r\n  {\r\n    base.Operation();\r\n    AddedBehavior();\r\n    Console.WriteLine(\"ConcreteDecoratorB.Operation()\");\r\n  }\r\n\r\n  void AddedBehavior()\r\n  {\r\n  }\r\n}\r\n\r\n/// <summary>\r\n/// Client test\r\n/// </summary>\r\npublic class Client\r\n{\r\n  public static void Main( string[] args )\r\n  {\r\n    // Create ConcreteComponent and two Decorators\r\n    ConcreteComponent c = new ConcreteComponent();\r\n    ConcreteDecoratorA d1 = new ConcreteDecoratorA();\r\n    ConcreteDecoratorB d2 = new ConcreteDecoratorB();\r\n\r\n    // Link decorators\r\n    d1.SetComponent( c );\r\n    d2.SetComponent( d1 );\r\n\r\n    d2.Operation();\r\n  }\r\n}\r\n \r\n\r\nOutput \r\nConcreteComponent.Operation()\r\nConcreteDecoratorA.Operation()\r\nConcreteDecoratorB.Operation()\r\n\r\n\r\n//----------------------------------------------------------------\r\n// Facade pattern -- Structural example  \r\n//----------------------------------------------------------------\r\n\r\nusing System;\r\n\r\n// \"SubSystem\"\r\n\r\nclass SubSystemOne\r\n{\r\n  public void MethodOne()\r\n  {\r\n    Console.WriteLine(\"SubSystemOne Method\");\r\n  }\r\n}\r\n\r\nclass SubSystemTwo\r\n{\r\n  public void MethodTwo()\r\n  {\r\n    Console.WriteLine(\"SubSystemTwo Method\");\r\n  }\r\n}\r\n\r\nclass SubSystemThree\r\n{\r\n  public void MethodThree()\r\n  {\r\n    Console.WriteLine(\"SubSystemThree Method\");\r\n  }\r\n}\r\n\r\nclass SubSystemFour\r\n{\r\n  public void MethodFour()\r\n  {\r\n    Console.WriteLine(\"SubSystemFour Method\");\r\n  }\r\n}\r\n\r\n// \"Facade\"\r\n\r\nclass Facade\r\n{\r\n  // Fields\r\n  SubSystemOne one;\r\n  SubSystemTwo two;\r\n  SubSystemThree three;\r\n  SubSystemFour four;\r\n\r\n  // Constructors\r\n  public Facade()\r\n  {\r\n    one = new SubSystemOne();\r\n    two = new SubSystemTwo();\r\n    three = new SubSystemThree();\r\n    four = new SubSystemFour();\r\n  }\r\n\r\n  // Methods\r\n  public void MethodA()\r\n  {\r\n    Console.WriteLine( \"\\nMethodA() ---- \" );\r\n    one.MethodOne();\r\n    two.MethodTwo();\r\n    four.MethodFour();\r\n  }\r\n\r\n  public void MethodB()\r\n  {\r\n    Console.WriteLine( \"\\nMethodB() ---- \" );\r\n    two.MethodTwo();\r\n    three.MethodThree();\r\n  }\r\n}\r\n\r\n/// <summary>\r\n/// Client test\r\n/// </summary>\r\npublic class Client\r\n{\r\n  public static void Main(string[] args)\r\n  {\r\n    // Create and call Facade\r\n    Facade f = new Facade();\r\n    f.MethodA();\r\n    f.MethodB();\r\n\r\n  }\r\n}  \r\n\r\nOutput \r\nMethodA() ----\r\nSubSystemOne Method\r\nSubSystemTwo Method\r\nSubSystemFour Method\r\n\r\nMethodB() ----\r\nSubSystemTwo Method\r\nSubSystemThree Method\r\n\r\n\r\n//----------------------------------------------------------------\r\n// Factory Method pattern -- Structural example  \r\n//----------------------------------------------------------------\r\n\r\nusing System;\r\nusing System.Collections;\r\n\r\n// \"Product\"\r\n\r\nabstract class Product\r\n{\r\n}\r\n\r\n// \"ConcreteProductA\"\r\n\r\nclass ConcreteProductA : Product\r\n{\r\n}\r\n\r\n// \"ConcreteProductB\"\r\n\r\nclass ConcreteProductB : Product\r\n{\r\n}\r\n\r\n// \"Creator\"\r\n\r\nabstract class Creator\r\n{\r\n  // Methods\r\n  abstract public Product FactoryMethod();\r\n}\r\n\r\n// \"ConcreteCreatorA\"\r\n\r\nclass ConcreteCreatorA : Creator\r\n{\r\n  // Methods\r\n  override public Product FactoryMethod()\r\n  {\r\n    return new ConcreteProductA();\r\n  }\r\n}\r\n\r\n// \"ConcreteCreatorB\"\r\n\r\nclass ConcreteCreatorB : Creator\r\n{\r\n  // Methods\r\n  override public Product FactoryMethod()\r\n  {\r\n    return new ConcreteProductB();\r\n  }\r\n}\r\n\r\n/// <summary>\r\n/// Client test\r\n/// </summary>\r\nclass Client\r\n{\r\n  public static void Main( string[] args )\r\n  {\r\n\r\n    // FactoryMethod returns ProductA\r\n    Creator c = new ConcreteCreatorA();\r\n    Product p = c.FactoryMethod();\r\n    Console.WriteLine( \"Created {0}\", p );\r\n\r\n    // FactoryMethod returns ProductB\r\n    c = new ConcreteCreatorB();\r\n    p = c.FactoryMethod();\r\n    Console.WriteLine( \"Created {0}\", p );  \r\n\r\n  }\r\n}  \r\n\r\nOutput \r\nCreated ConcreteProductA\r\nCreated ConcreteProductB\r\n\r\n\r\n//----------------------------------------------------------------\r\n// Flyweight pattern -- Structural example  \r\n//----------------------------------------------------------------\r\n\r\nusing System;\r\nusing System.Collections;\r\n\r\n// \"FlyweightFactory\"\r\n\r\nclass FlyweightFactory\r\n{\r\n  // Fields\r\n  private Hashtable flyweights = new Hashtable();\r\n\r\n  // Constructors\r\n  public FlyweightFactory()\r\n  {\r\n    flyweights.Add(\"X\", new ConcreteFlyweight());\r\n    flyweights.Add(\"Y\", new ConcreteFlyweight());\r\n    flyweights.Add(\"Z\", new ConcreteFlyweight());\r\n  }\r\n\r\n  // Methods\r\n  public Flyweight GetFlyweight(string key)\r\n  {\r\n    return((Flyweight)flyweights[ key ]);\r\n  }\r\n}\r\n\r\n// \"Flyweight\"\r\n\r\nabstract class Flyweight\r\n{\r\n  // Methods\r\n  abstract public void Operation( int extrinsicstate );\r\n}\r\n\r\n// \"ConcreteFlyweight\"\r\n\r\nclass ConcreteFlyweight : Flyweight\r\n{\r\n  // Methods\r\n  override public void Operation( int extrinsicstate )\r\n  {\r\n    Console.WriteLine(\"ConcreteFlyweight: {0}\",\r\n                                      extrinsicstate );\r\n  }\r\n}\r\n\r\n// \"UnsharedConcreteFlyweight\"\r\n\r\nclass UnsharedConcreteFlyweight : Flyweight\r\n{\r\n  // Methods\r\n  override public void Operation( int extrinsicstate )\r\n  {\r\n    Console.WriteLine(\"UnsharedConcreteFlyweight: {0}\",\r\n                                      extrinsicstate );\r\n  }\r\n}\r\n\r\n/// <summary>\r\n/// Client test\r\n/// </summary>\r\npublic class Client\r\n{\r\n  public static void Main( string[] args )\r\n  {\r\n    // Arbitrary extrisic state\r\n    int extrinsicstate = 22;\r\n     \r\n    FlyweightFactory f = new FlyweightFactory();\r\n\r\n    // Work with different flyweight instances\r\n    Flyweight fx = f.GetFlyweight(\"X\");\r\n    fx.Operation( --extrinsicstate );\r\n\r\n    Flyweight fy = f.GetFlyweight(\"Y\");\r\n    fy.Operation( --extrinsicstate );\r\n\r\n    Flyweight fz = f.GetFlyweight(\"Z\");\r\n    fz.Operation( --extrinsicstate );\r\n\r\n    UnsharedConcreteFlyweight fu = new\r\n                    UnsharedConcreteFlyweight();\r\n    fu.Operation( --extrinsicstate );\r\n \r\n  }\r\n}  \r\n\r\nOutput \r\nConcreteFlyweight: 21\r\nConcreteFlyweight: 20\r\nConcreteFlyweight: 19\r\nUnsharedConcreteFlyweight: 18\r\n\r\n\r\n//----------------------------------------------------------------\r\n// Interpreter pattern -- Structural example  \r\n//----------------------------------------------------------------\r\n\r\nusing System;\r\nusing System.Collections;\r\n\r\n// \"Context\"\r\n\r\nclass Context\r\n{\r\n}\r\n\r\n// \"AbstractExpression\"\r\n\r\nabstract class AbstractExpression\r\n{\r\n  public abstract void Interpret( Context context );\r\n}\r\n\r\n// \"TerminalExpression\"\r\n\r\nclass TerminalExpression : AbstractExpression\r\n{\r\n  public override void Interpret( Context context )\r\n  {\r\n    Console.WriteLine( \"Called Terminal.Interpret()\" );\r\n  }\r\n}\r\n\r\n// \"NonterminalExpression\"\r\n\r\nclass NonterminalExpression : AbstractExpression\r\n{\r\n  public override void Interpret( Context context )\r\n  {\r\n    Console.WriteLine( \"Called Nonterminal.Interpret()\" );\r\n  }\r\n}\r\n\r\n/// <summary>\r\n/// Client test\r\n/// </summary>\r\npublic class Client\r\n{\r\n  public static void Main( string[] args )\r\n  {\r\n    Context c = new Context();\r\n\r\n    // Usually a tree\r\n    ArrayList l = new ArrayList();\r\n\r\n    // Populate 'abstract syntax tree'\r\n    l.Add(new TerminalExpression());\r\n    l.Add(new NonterminalExpression());\r\n    l.Add(new TerminalExpression());\r\n    l.Add(new TerminalExpression());\r\n\r\n    // Interpret\r\n    foreach( AbstractExpression exp in l )\r\n      exp.Interpret(c);\r\n  }\r\n}  \r\n\r\nOutput \r\nCalled Terminal.Interpret()\r\nCalled Nonterminal.Interpret()\r\nCalled Terminal.Interpret()\r\nCalled Terminal.Interpret()\r\n\r\n\r\n//----------------------------------------------------------------\r\n// Iterator pattern -- Structural example  \r\n//----------------------------------------------------------------\r\n\r\nusing System;\r\nusing System.Collections;\r\n\r\n// \"Aggregate\"\r\n\r\nabstract class Aggregate\r\n{\r\n  // Methods\r\n  public abstract Iterator CreateIterator();\r\n}\r\n\r\n// \"ConcreteAggregate\"\r\n\r\nclass ConcreteAggregate : Aggregate\r\n{\r\n  // Fields\r\n  private ArrayList items = new ArrayList();\r\n\r\n  // Methods\r\n  public override Iterator CreateIterator()\r\n  {\r\n    return new ConcreteIterator( this );\r\n  }\r\n\r\n  // Properties\r\n  public int Count\r\n  {\r\n    get{ return items.Count; }\r\n  }\r\n\r\n  // Indexers\r\n  public object this[ int index ]\r\n  {\r\n    get{ return items[ index ]; }\r\n    set{ items.Insert( index, value ); }\r\n  }\r\n}\r\n\r\n// \"Iterator\"\r\n\r\nabstract class Iterator\r\n{\r\n  // Methods\r\n  public abstract object First();\r\n  public abstract object Next();\r\n  public abstract bool IsDone();\r\n  public abstract object CurrentItem();\r\n}\r\n\r\n// \"ConcreteIterator\"\r\n\r\nclass ConcreteIterator : Iterator\r\n{\r\n  // Fields\r\n  private ConcreteAggregate aggregate;\r\n  private int current = 0;\r\n\r\n  // Constructor\r\n  public ConcreteIterator( ConcreteAggregate aggregate )\r\n  {\r\n    this.aggregate = aggregate;\r\n  }\r\n\r\n  // Methods\r\n  override public object First()\r\n  {\r\n    return aggregate[ 0 ];\r\n  }\r\n\r\n  override public object Next()\r\n  {\r\n    if( current < aggregate.Count-1 )\r\n      return aggregate[ ++current ];\r\n    else\r\n      return null;\r\n  }\r\n\r\n  override public object CurrentItem()\r\n  {\r\n    return aggregate[ current ];\r\n  }\r\n\r\n  override public bool IsDone()\r\n  {\r\n    return current >= aggregate.Count ? true : false ;\r\n  }\r\n}\r\n\r\n/// <summary>\r\n///  Client test\r\n/// </summary>\r\npublic class Client\r\n{\r\n  public static void Main(string[] args)\r\n  {\r\n    ConcreteAggregate a = new ConcreteAggregate();\r\n    a[0] = \"Item A\";\r\n    a[1] = \"Item B\";\r\n    a[2] = \"Item C\";\r\n    a[3] = \"Item D\";\r\n\r\n    // Create Iterator and provide aggregate\r\n    ConcreteIterator i = new ConcreteIterator(a);\r\n\r\n    // Iterate over collection\r\n    object item = i.First();\r\n\r\n    while( item != null )\r\n    {\r\n      Console.WriteLine( item );\r\n      item = i.Next();\r\n    }\r\n  }\r\n}  \r\n\r\nOutput \r\nItem A\r\nItem B\r\nItem C\r\nItem D\r\n\r\n\r\n//----------------------------------------------------------------\r\n// Mediator pattern -- Structural example  \r\n//----------------------------------------------------------------\r\n\r\nusing System;\r\nusing System.Collections;\r\n\r\n// \"Mediator\"\r\n\r\nabstract class Mediator\r\n{\r\n  // Methods\r\n  abstract public void Send( string message,\r\n  Colleague colleague );\r\n}\r\n\r\n// \"ConcreteMediator\"\r\n\r\nclass ConcreteMediator : Mediator\r\n{\r\n  // Fields\r\n  private ConcreteColleague1 colleague1;\r\n  private ConcreteColleague2 colleague2;\r\n\r\n  // Properties\r\n  public ConcreteColleague1 Colleague1\r\n  {\r\n    set{ colleague1 = value; }\r\n  }\r\n\r\n  public ConcreteColleague2 Colleague2\r\n  {\r\n    set{ colleague2 = value; }\r\n  }\r\n\r\n  // Methods\r\n  override public void Send( string message,\r\n                          Colleague colleague )\r\n  {\r\n    if( colleague == colleague1 )\r\n      colleague2.Notify( message );\r\n    else\r\n      colleague1.Notify( message );\r\n  }\r\n}\r\n\r\n// \"Colleague\"\r\n\r\nabstract class Colleague\r\n{\r\n  // Fields\r\n  protected Mediator mediator;\r\n\r\n  // Constructors\r\n  public Colleague( Mediator mediator )\r\n  {\r\n    this.mediator = mediator;\r\n  }\r\n}\r\n\r\n// \"ConcreteColleague1\"\r\n\r\nclass ConcreteColleague1 : Colleague\r\n{\r\n  // \"Constructors\"\r\n  public ConcreteColleague1( Mediator mediator )\r\n                                  : base ( mediator ) { }\r\n\r\n  // Methods\r\n  public void Send( string message )\r\n  {\r\n    mediator.Send( message, this );\r\n  }\r\n\r\n  public void Notify( string message )\r\n  {\r\n    Console.WriteLine( \"Colleague1 gets message: \"\r\n                                            + message );\r\n  }\r\n}\r\n\r\n// \"ConcreteColleague2\"\r\n\r\nclass ConcreteColleague2 : Colleague\r\n{\r\n  // Constructors\r\n  public ConcreteColleague2( Mediator mediator )\r\n                                  : base ( mediator ) { }\r\n \r\n  // Methods\r\n  public void Send( string message )\r\n  {\r\n    mediator.Send( message, this );\r\n  }\r\n  public void Notify( string message )\r\n  {\r\n    Console.WriteLine( \"Colleague2 gets message: \"\r\n                                            + message );\r\n  }\r\n}\r\n\r\n/// <summary>\r\n/// Client test\r\n/// </summary>\r\npublic class Client\r\n{\r\n  public static void Main(string[] args)\r\n  {\r\n    ConcreteMediator m = new ConcreteMediator();\r\n    ConcreteColleague1 c1 = new ConcreteColleague1( m );\r\n    ConcreteColleague2 c2 = new ConcreteColleague2( m );\r\n\r\n    m.Colleague1 = c1;\r\n    m.Colleague2 = c2;\r\n\r\n    c1.Send( \"How are you?\" );\r\n    c2.Send( \"Fine, thanks\" );\r\n  }\r\n}  \r\n\r\nOutput \r\nColleague2 gets message: How are you?\r\nColleague1 gets message: Fine, thanks\r\n\r\n\r\n//----------------------------------------------------------------\r\n// Memento pattern -- Structural example  \r\n//----------------------------------------------------------------\r\n\r\nusing System;\r\n\r\n// \"Originator\"\r\n\r\nclass Originator\r\n{\r\n  // Fields\r\n  private string state = \"OFF\";\r\n\r\n  // Properties\r\n  public string State\r\n  {\r\n    get{ return state; }\r\n    set{ state = value; }\r\n  }\r\n\r\n  // Methods\r\n  public Memento CreateMemento()\r\n  {\r\n    return (new Memento( state ));\r\n  }\r\n\r\n  public void SetMemento( Memento memento )\r\n  {\r\n    state = memento.State;\r\n    Console.WriteLine( \"Restored to state: {0}\", state );\r\n  }\r\n}\r\n\r\n// \"Memento\"\r\n\r\nclass Memento\r\n{\r\n  // Fields\r\n  private string state;\r\n\r\n  // Constructors\r\n  public Memento( string state )\r\n  {\r\n    this.state = state;\r\n  }\r\n\r\n  // Properties\r\n  public string State\r\n  {\r\n    get{ return state; }\r\n  }\r\n}\r\n\r\n// \"Caretaker\"\r\n\r\nclass Caretaker\r\n{\r\n  // Fields\r\n  private Memento memento;\r\n\r\n  // Properties\r\n  public Memento Memento\r\n  {\r\n    set{ memento = value; }\r\n    get{ return memento; }\r\n  }\r\n}\r\n\r\n/// <summary>\r\n/// Client test\r\n/// </summary>\r\npublic class Client\r\n{\r\n  public static void Main( string[] args )\r\n  {\r\n    Originator o = new Originator();\r\n    o.State = \"On\";\r\n\r\n    // Store internal state\r\n    Caretaker c = new Caretaker();\r\n    c.Memento = o.CreateMemento();\r\n\r\n    // Continue changing originator\r\n    o.State = \"Off\";\r\n\r\n    // Restore saved state\r\n    o.SetMemento( c.Memento );\r\n  }\r\n}  \r\n\r\nOutput \r\nRestored to state: On\r\n\r\n\r\n//----------------------------------------------------------------\r\n// Observer pattern -- Structural example  \r\n//----------------------------------------------------------------\r\n\r\nusing System;\r\nusing System.Collections;\r\n\r\n// \"Subject\"\r\n\r\nabstract class Subject\r\n{\r\n  // Fields\r\n  private ArrayList observers = new ArrayList();\r\n\r\n  // Methods\r\n  public void Attach( Observer observer )\r\n  {\r\n    observers.Add( observer );\r\n  }\r\n\r\n  public void Detach( Observer observer )\r\n  {\r\n    observers.Remove( observer );\r\n  }\r\n\r\n  public void Notify()\r\n  {\r\n    foreach( Observer o in observers )\r\n      o.Update();\r\n  }\r\n}\r\n\r\n// \"ConcreteSubject\"\r\n\r\nclass ConcreteSubject : Subject\r\n{\r\n  // Fields\r\n  private string subjectState;\r\n\r\n  // Properties\r\n  public string SubjectState\r\n  {\r\n    get{ return subjectState; }\r\n    set{ subjectState = value; }\r\n  }\r\n}\r\n\r\n// \"Observer\"\r\n\r\nabstract class Observer\r\n{\r\n  // Methods\r\n  abstract public void Update();\r\n}\r\n\r\n// \"ConcreteObserver\"\r\n\r\nclass ConcreteObserver : Observer\r\n{\r\n  // Fields\r\n  private string name;\r\n  private string observerState;\r\n  private ConcreteSubject subject;\r\n\r\n  // Constructors\r\n  public ConcreteObserver( ConcreteSubject subject,  \r\n                                   string name )\r\n  {\r\n    this.subject = subject;\r\n    this.name = name;\r\n  }\r\n\r\n  // Methods\r\n  override public void Update()\r\n  {\r\n    observerState = subject.SubjectState;\r\n    Console.WriteLine( \"Observer {0}'s new state is {1}\",\r\n                                  name, observerState );\r\n  }\r\n\r\n  // Properties\r\n  public ConcreteSubject Subject\r\n  {\r\n    get { return subject; }\r\n    set { subject = value; }\r\n  }\r\n}\r\n\r\n/// <summary>\r\n/// Client test\r\n/// </summary>\r\npublic class Client\r\n{\r\n  public static void Main( string[] args )\r\n  {\r\n    // Configure Observer structure\r\n    ConcreteSubject s = new ConcreteSubject();\r\n    s.Attach( new ConcreteObserver( s, \"X\" ) );\r\n    s.Attach( new ConcreteObserver( s, \"Y\" ) );\r\n    s.Attach( new ConcreteObserver( s, \"Z\" ) );\r\n\r\n    // Change subject and notify observers\r\n    s.SubjectState = \"ABC\";\r\n    s.Notify();\r\n  }\r\n}  \r\n\r\nOutput \r\nObserver X's new state is ABC\r\nObserver Y's new state is ABC\r\nObserver Z's new state is ABC\r\n\r\n\r\n//----------------------------------------------------------------\r\n// Prototype pattern -- Structural example  \r\n//----------------------------------------------------------------\r\n\r\nusing System;\r\n\r\n// \"Prototype\"\r\n\r\nabstract class Prototype\r\n{\r\n  // Fields\r\n  private string id;\r\n\r\n  // Constructors\r\n  public Prototype( string id )\r\n  {\r\n    this.id = id;\r\n  }\r\n\r\n  public string Id\r\n  {\r\n    get{ return id; }\r\n  }\r\n\r\n  // Methods\r\n  abstract public Prototype Clone();\r\n}\r\n\r\n// \"ConcretePrototype1\"\r\n\r\nclass ConcretePrototype1 : Prototype\r\n{\r\n  // Constructors\r\n  public ConcretePrototype1( string id ) : base ( id ) {}\r\n\r\n  // Methods\r\n  override public Prototype Clone()\r\n  {\r\n    // Shallow copy\r\n    return (Prototype)this.MemberwiseClone();\r\n  }\r\n}\r\n\r\n// \"ConcretePrototype2\"\r\n\r\nclass ConcretePrototype2 : Prototype\r\n{\r\n  // Constructors\r\n  public ConcretePrototype2( string id ) : base ( id ) {}\r\n\r\n  // Methods\r\n  override public Prototype Clone()\r\n  {\r\n    // Shallow copy\r\n    return (Prototype)this.MemberwiseClone();\r\n  }\r\n}\r\n\r\n/// <summary>\r\n/// Client test\r\n/// </summary>\r\nclass Client\r\n{\r\n  public static void Main( string[] args )\r\n  {\r\n   // Create two instances and clone each\r\n   ConcretePrototype1 p1 = new ConcretePrototype1( \"I\" );\r\n   ConcretePrototype1 c1 = (ConcretePrototype1)p1.Clone();\r\n   Console.WriteLine( \"Cloned: {0}\", c1.Id );\r\n\r\n   ConcretePrototype2 p2 = new ConcretePrototype2( \"II\" );\r\n   ConcretePrototype2 c2 = (ConcretePrototype2)p2.Clone();\r\n   Console.WriteLine( \"Cloned: {0}\", c2.Id );\r\n  }\r\n}  \r\n\r\nOutput \r\nCloned: I\r\nCloned: II\r\n\r\n\r\n//----------------------------------------------------------------\r\n// Proxy pattern -- Structural example  \r\n//----------------------------------------------------------------\r\n\r\nusing System;\r\n\r\n// \"Subject\"\r\n\r\nabstract class Subject\r\n{\r\n  // Methods\r\n  abstract public void Request();\r\n}\r\n\r\n// \"RealSubject\"\r\n\r\nclass RealSubject : Subject\r\n{\r\n  // Methods\r\n  override public void Request()\r\n  {\r\n    Console.WriteLine(\"Called RealSubject.Request()\");\r\n  }\r\n}\r\n\r\n// \"Proxy\"\r\n\r\nclass Proxy : Subject\r\n{\r\n  // Fields\r\n  RealSubject realSubject;\r\n\r\n  // Methods\r\n  override public void Request()\r\n  {\r\n    // Uses \"lazy initialization\"\r\n    if( realSubject == null )\r\n      realSubject = new RealSubject();\r\n\r\n    realSubject.Request();\r\n  }\r\n}\r\n\r\n/// <summary>\r\n/// Client test\r\n/// </summary>\r\npublic class Client\r\n{\r\n  public static void Main( string[] args )\r\n  {\r\n    // Create proxy and request a service\r\n    Proxy p = new Proxy();\r\n    p.Request();\r\n\r\n  }\r\n}  \r\n\r\nOutput \r\nCalled RealSubject.Request()\r\n\r\n\r\n//----------------------------------------------------------------\r\n// Singleton pattern -- Structural example  \r\n//----------------------------------------------------------------\r\n\r\nusing System;\r\n\r\n// \"Singleton\"\r\n\r\nclass Singleton\r\n{\r\n  // Fields\r\n  private static Singleton instance;\r\n\r\n  // Constructor\r\n  protected Singleton() {}\r\n\r\n  // Methods\r\n  public static Singleton Instance()\r\n  {\r\n    // Uses \"Lazy initialization\"\r\n    if( instance == null )\r\n      instance = new Singleton();\r\n\r\n    return instance;\r\n  }\r\n}\r\n\r\n/// <summary>\r\n/// Client test\r\n/// </summary>\r\npublic class Client\r\n{\r\n  public static void Main()\r\n  {\r\n    // Constructor is protected -- cannot use new\r\n    Singleton s1 = Singleton.Instance();\r\n    Singleton s2 = Singleton.Instance();\r\n\r\n    if( s1 == s2 )\r\n      Console.WriteLine( \"The same instance\" );\r\n  }\r\n}  \r\n\r\nOutput \r\nThe same instance\r\n\r\n\r\n//----------------------------------------------------------------\r\n// State pattern -- Structural example  \r\n//----------------------------------------------------------------\r\n\r\nusing System;\r\n\r\n// \"State\"\r\n\r\nabstract class State\r\n{\r\n  // Methods\r\n  abstract public void Handle( Context context );\r\n}\r\n\r\n// \"ConcreteStateA\"\r\n\r\nclass ConcreteStateA : State\r\n{\r\n  // Methods\r\n  override public void Handle( Context context )\r\n  {\r\n    context.State = new ConcreteStateB();\r\n  }\r\n}\r\n\r\n// \"ConcreteStateB\"\r\n\r\nclass ConcreteStateB : State\r\n{\r\n  // Methods\r\n  override public void Handle( Context context )\r\n  {\r\n    context.State = new ConcreteStateA();\r\n  }\r\n}\r\n\r\n// \"Context\"\r\n\r\nclass Context\r\n{\r\n  // Fields\r\n  private State state;\r\n\r\n  // Constructors\r\n  public Context( State state )\r\n  {\r\n    this.state = state;\r\n  }\r\n\r\n  // Properties\r\n  public State State\r\n  {\r\n    get{ return state; }\r\n    set{ state = value; }\r\n  }\r\n\r\n  // Methods\r\n  public void Request()\r\n  {\r\n    state.Handle( this );\r\n  }\r\n\r\n  public void Show()\r\n  {\r\n    Console.WriteLine( \"State: \" + state );\r\n  }\r\n}\r\n\r\n/// <summary>\r\n/// Client test\r\n/// </summary>\r\npublic class Client\r\n{\r\n  public static void Main( string[] args )\r\n  {\r\n    // Setup context in a state\r\n    Context c = new Context( new ConcreteStateA() );\r\n    c.Show();\r\n\r\n    // Issue request, which toggles state\r\n    c.Request();\r\n    c.Show();\r\n\r\n    // Issue request, which toggles state\r\n    c.Request();\r\n    c.Show();\r\n  }\r\n}  \r\n\r\nOutput \r\nState: ConcreteStateA\r\nState: ConcreteStateB\r\nState: ConcreteStateA\r\n\r\n\r\n//----------------------------------------------------------------\r\n// Strategy pattern -- Structural example  \r\n//----------------------------------------------------------------\r\n\r\nusing System;\r\n\r\n// \"Strategy\"\r\n\r\nabstract class Strategy\r\n{\r\n  // Methods\r\n  abstract public void AlgorithmInterface();\r\n}\r\n\r\n// \"ConcreteStrategyA\"\r\n\r\nclass ConcreteStrategyA : Strategy\r\n{\r\n  // Methods\r\n  override public void AlgorithmInterface()\r\n  {\r\n  Console.WriteLine(\r\n      \"Called ConcreteStrategyA.AlgorithmInterface()\");\r\n  }\r\n}\r\n\r\n// \"ConcreteStrategyB\"\r\n\r\nclass ConcreteStrategyB : Strategy\r\n{\r\n  // Methods\r\n  override public void AlgorithmInterface()\r\n  {\r\n    Console.WriteLine(\r\n        \"Called ConcreteStrategyB.AlgorithmInterface()\");\r\n  }\r\n}\r\n\r\n// \"ConcreteStrategyC\"\r\n\r\nclass ConcreteStrategyC : Strategy\r\n{\r\n  // Methods\r\n  override public void AlgorithmInterface()\r\n  {\r\n    Console.WriteLine(\r\n        \"Called ConcreteStrategyC.AlgorithmInterface()\");\r\n  }\r\n}\r\n\r\n// \"Context\"\r\n\r\nclass Context\r\n{\r\n  // Fields\r\n  Strategy strategy;\r\n\r\n  // Constructors\r\n  public Context( Strategy strategy )\r\n  {\r\n    this.strategy = strategy;\r\n  }\r\n\r\n  // Methods\r\n  public void ContextInterface()\r\n  {\r\n    strategy.AlgorithmInterface();\r\n  }\r\n}\r\n\r\n/// <summary>\r\n/// Client test\r\n/// </summary>\r\npublic class Client\r\n{\r\n  public static void Main( string[] args )\r\n  {\r\n    // Three contexts following different strategies\r\n    Context c = new Context( new ConcreteStrategyA() );\r\n    c.ContextInterface();\r\n\r\n    Context d = new Context( new ConcreteStrategyB() );\r\n    d.ContextInterface();\r\n\r\n    Context e = new Context( new ConcreteStrategyC() );\r\n     e.ContextInterface();\r\n  }\r\n}  \r\n\r\nOutput \r\nCalled ConcreteStrategyA.AlgorithmInterface()\r\nCalled ConcreteStrategyB.AlgorithmInterface()\r\nCalled ConcreteStrategyC.AlgorithmInterface()\r\n\r\n\r\n//----------------------------------------------------------------\r\n// Template Method pattern -- Structural example  \r\n//----------------------------------------------------------------\r\n\r\nusing System;\r\n\r\n// \"AbstractClass\"\r\n\r\nabstract class AbstractClass\r\n{\r\n  // Methods\r\n  abstract public void PrimitiveOperation1();\r\n  abstract public void PrimitiveOperation2();\r\n\r\n  // The Template method\r\n  public void TemplateMethod()\r\n  {\r\n    Console.WriteLine(\r\n                \"In AbstractClass.TemplateMethod()\");\r\n    PrimitiveOperation1();\r\n    PrimitiveOperation2();\r\n  }\r\n}\r\n\r\n// \"ConcreteClass\"\r\n\r\nclass ConcreteClass : AbstractClass\r\n{\r\n  // Methods\r\n  public override void PrimitiveOperation1()\r\n  {\r\n    Console.WriteLine(\r\n        \"Called ConcreteClass.PrimitiveOperation1()\");\r\n  }\r\n\r\n  public override void PrimitiveOperation2()\r\n  {\r\n    Console.WriteLine(\r\n        \"Called ConcreteClass.PrimitiveOperation2()\");\r\n  }\r\n}\r\n\r\n/// <summary>\r\n/// Client test\r\n/// </summary>\r\npublic class Client\r\n{\r\n  public static void Main( string[] args )\r\n  {\r\n    // Create instance and call template method\r\n    ConcreteClass c = new ConcreteClass();\r\n    c.TemplateMethod();\r\n\r\n  }\r\n}  \r\n\r\nOutput \r\nIn AbstractClass.TemplateMethod()\r\nCalled ConcreteClass.PrimitiveOperation1()\r\nCalled ConcreteClass.PrimitiveOperation2()\r\n\r\n\r\n//----------------------------------------------------------------\r\n// Visitor pattern -- Structural example  \r\n//----------------------------------------------------------------\r\n\r\nusing System;\r\nusing System.Collections;\r\n\r\n// \"Visitor\"\r\n\r\nabstract class Visitor\r\n{\r\n  // Methods\r\n  abstract public void VisitConcreteElementA(\r\n                  ConcreteElementA concreteElementA );\r\n  abstract public void VisitConcreteElementB(\r\n                   ConcreteElementB concreteElementB );\r\n}\r\n\r\n// \"ConcreteVisitor1\"\r\n\r\nclass ConcreteVisitor1 : Visitor\r\n{\r\n  // Methods\r\n  override public void VisitConcreteElementA(\r\n                   ConcreteElementA concreteElementA )\r\n  {\r\n    Console.WriteLine( \"{0} visited by {1}\",\r\n                             concreteElementA, this );\r\n  }\r\n\r\n  override public void VisitConcreteElementB(\r\n                   ConcreteElementB concreteElementB )\r\n  {\r\n    Console.WriteLine( \"{0} visited by {1}\",\r\n                             concreteElementB, this );\r\n  }\r\n}\r\n\r\n// \"ConcreteVisitor2\"\r\n\r\nclass ConcreteVisitor2 : Visitor\r\n{\r\n  // Methods\r\n  override public void VisitConcreteElementA(\r\n                  ConcreteElementA concreteElementA )\r\n  {\r\n    Console.WriteLine( \"{0} visited by {1}\",\r\n                             concreteElementA, this );\r\n  }\r\n  override public void VisitConcreteElementB(\r\n                  ConcreteElementB concreteElementB )\r\n  {\r\n    Console.WriteLine( \"{0} visited by {1}\",\r\n                             concreteElementB, this );\r\n  }\r\n}\r\n\r\n// \"Element\"\r\n\r\nabstract class Element\r\n{\r\n  // Methods\r\n  abstract public void Accept( Visitor visitor );\r\n}\r\n\r\n// \"ConcreteElementA\"\r\nclass ConcreteElementA : Element\r\n{\r\n  // Methods\r\n  override public void Accept( Visitor visitor )\r\n  {\r\n    visitor.VisitConcreteElementA( this );\r\n  }\r\n\r\n  public void OperationA()\r\n  {\r\n  }\r\n}\r\n\r\n// \"ConcreteElementB\"\r\n\r\nclass ConcreteElementB : Element\r\n{\r\n  // Methods\r\n  override public void Accept( Visitor visitor )\r\n  {\r\n    visitor.VisitConcreteElementB( this );\r\n  }\r\n\r\n  public void OperationB()\r\n  {\r\n  }\r\n}\r\n\r\n// \"ObjectStructure\"\r\n\r\nclass ObjectStructure\r\n{\r\n  // Fields\r\n  private ArrayList elements = new ArrayList();\r\n\r\n  // Methods\r\n  public void Attach( Element element )\r\n  {\r\n    elements.Add( element );\r\n  }\r\n\r\n  public void Detach( Element element )\r\n  {\r\n    elements.Remove( element );\r\n  }\r\n\r\n  public void Accept( Visitor visitor )\r\n  {\r\n    foreach( Element e in elements )\r\n      e.Accept( visitor );\r\n  }\r\n}\r\n\r\n/// <summary>\r\n/// Client test\r\n/// </summary>\r\npublic class Client\r\n{\r\n  public static void Main( string[] args )\r\n  {\r\n    // Setup structure\r\n    ObjectStructure o = new ObjectStructure();\r\n    o.Attach( new ConcreteElementA() );\r\n    o.Attach( new ConcreteElementB() );\r\n\r\n    // Create visitor objects\r\n    ConcreteVisitor1 v1 = new ConcreteVisitor1();\r\n    ConcreteVisitor2 v2 = new ConcreteVisitor2();\r\n\r\n    // Structure accepting visitors\r\n    o.Accept( v1 );\r\n    o.Accept( v2 );\r\n  }\r\n}  \r\n\r\nOutput \r\nConcreteElementA visited by ConcreteVisitor1\r\nConcreteElementB visited by ConcreteVisitor1\r\nConcreteElementA visited by ConcreteVisitor2\r\nConcreteElementB visited by ConcreteVisitor2\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Design Patterns"]},{"RecordId":"687","Title":"Collection Class","Description":"Demonstrates how to implement a collection class in C#.  Uses a struct as an item and also has a custom enumerator.","Code":"//------------------------------------------------------------------------\r\n// Books.cs\r\n//------------------------------------------------------------------------\r\nusing System;\r\nusing System.Collections;\r\n\r\nnamespace CollectionClass {\r\n\r\n\t// Structure that defines a book\r\n\tpublic struct Book {\r\n\r\n\t\tprivate string _title;\r\n\t\tprivate string _author;\r\n\t\t\r\n\t\tpublic string Title {\r\n\t\t\tget { return _title;}\r\n\t\t\tset { _title = value;}\r\n\t\t}\r\n\t\t\r\n\t\tpublic string Author {\r\n\t\t\tget { return _author;}\r\n\t\t\tset { _author = value;}\r\n\t\t}\r\n\t}\r\n\t\r\n\t// Collection Class of books\r\n\tclass Books:IEnumerable {\r\n\r\n\t\tpublic ArrayList _books;\r\n\r\n\t\tpublic Books() {\r\n\t\t\t_books = new ArrayList();\r\n\t\t}\r\n\r\n\t\tpublic void Add(string Title, string Author) {\r\n\t\t\tBook b = new Book();\r\n\t\t\tb.Author = Author;\r\n\t\t\tb.Title = Title;\r\n\t\t\t_books.Add(b);\r\n\t\t}\r\n\r\n\t\tpublic IEnumerator GetEnumerator() {\r\n\t\t\treturn new BooksEnumerator(this);\r\n\t\t}\r\n\t}\r\n\r\n\t// Books enumerator class\r\n\tclass BooksEnumerator : IEnumerator {\r\n\r\n\t\tprivate int position = -1;\r\n\t\tprivate Books books;\r\n\r\n\t\tpublic BooksEnumerator(Books books) {\r\n\t\t\tthis.books = books;\r\n\t\t}\r\n\r\n\t\tpublic bool MoveNext() {\r\n\t\t\tif (position < books._books.Count - 1) {\r\n\t\t\t\tposition++;\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tpublic void Reset() {\r\n\t\t\tposition = -1;\r\n\t\t}\r\n\r\n\t\tpublic object Current {\r\n\t\t\tget {\r\n\t\t\t\treturn books._books[position];\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\n\r\n\r\n\r\n//------------------------------------------------------------------------\r\n// Client.cs\r\n//------------------------------------------------------------------------\r\nString strOut = \"\";\r\nBooks books = new Books();\r\n\r\nbooks.Add(\"vb.net\",\"Author 1\");\r\nbooks.Add(\"c#\", \"C# author\");\r\nbooks.Add(\"asp.net\", \"John Doe\");\r\n\r\nforeach(Book book in books) {\r\n\tstrOut += book.Title + \" \" + book.Author + \"\\n\";\r\n}\r\n\r\nMessageBox.Show(strOut);\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Collections","Collection Class"]},{"RecordId":"688","Title":"Getting File Properties for Office Documents","Description":"Programmatically read and write the custom properties of Office documents\r\nTitle, subject, etc.","Code":"Getting File Properties for Office Documents\r\n\r\nMicrosoft has an ActiveX component that can be used to programmatically retrieve the summary properties (title, subject, etc.) for files such as Excel, Word, and PowerPoint. It has advantages because it does not use Office Automation so Microsoft Office does not have to be installed. This component can be used to produce a listing of files and their properties.\r\nhttp://support.microsoft.com/?kbid=224351\r\n\r\n\r\nSample Code to Produce File Listing with Properties\r\nThe following code will populate a DataTable with a list of files and their properties. The DataTable could be bound to a DataGrid or another display control as desired. Be sure you've added the appropriate reference to the dsofile.dll that exposes the file properties. Because this is a COM-based DLL, COM Interop will be used to interact with the DLL.\r\n\r\n// Setup the data table\r\nDataTable fileTable = new DataTable(\"Files\");\r\nDataRow fileRow;\r\nfileTable.Columns.Add(\"Name\");\r\nfileTable.Columns.Add(\"Title\");\r\nfileTable.Columns.Add(\"Subject\");\r\nfileTable.Columns.Add(\"Description\");\r\n\r\n// Open the directory\r\nDirectoryInfo docDir = new DirectoryInfo(\"C:\\\\My Documents\\\\\");\r\nif( !docDir.Exists )\r\n{\r\n  docDir.Create();\r\n}\r\n\r\n// Add the document info into the table\r\nDSOleFile.PropertyReader propReader =\r\n       new DSOleFile.PropertyReaderClass();\r\nDSOleFile.DocumentProperties docProps;\r\n\r\nforeach(FileInfo file in docDir.GetFiles())\r\n{\r\n  try\r\n  {\r\n   fileRow = fileTable.NewRow();\r\n   docProps = propReader.GetDocumentProperties(file.FullName);\r\n   fileRow[\"Name\"] = file.Name;\r\n   fileRow[\"Title\"] = docProps.Title;\r\n   fileRow[\"Subject\"] = docProps.Subject;\r\n   fileRow[\"Description\"] = docProps.Comments;\r\n   fileTable.Rows.Add(fileRow);\r\n  }\r\n  catch( Exception exception )\r\n  {\r\n   Console.WriteLine(\"Error occurred: \" + exception.Message);\r\n  }\r\n}\r\npropReader = null;\r\nthis.DocumentGrid.DataSource = fileTable;\r\nthis.DocumentGrid.DataBind();\r\n\r\n// Force cleanup so dsofile doesn't keep files locked open\r\nGC.Collect();\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Office Properties","Custom Document Properties"]},{"RecordId":"689","Title":"Adding Wildcard Search to SharePoint Portal Server","Description":"By default SharePoint Portal Server doesn't support wildcard search through the default user interface. This article shows how to add wildcard search with no coding at all.","Code":"By default SharePoint Portal Server doesn't support wildcard search through the default user interface. However, the search engine of SharePoint is really powerfull and very well capable of searching with wildcards.  This article shows how to add wildcard search with no coding at all.\r\n\r\nWhen users search on the portal site the users are send to the search.aspx page. By adding the following after the url it will display the search page with the webparts on the page: http://servername/search.aspx?Mode=Edit&PageView=Shared\r\n\r\nThere are 2 webparts on the search page. The advanced search webpart which will hide or display according to the choice a user made on the left side menu (advanced or simple search). And there is a search results webpart. \r\n\r\nThere are a few things you can change, the number of results returned on a page, the message to display when no results are found etc. But the amount of modification is limited. We can change more properties by exporting the \"search results\" webpart and modifying the .DWP file with notepad.\r\n\r\nThe DWP file contains all the settings for the webpart as usual, but it also contains some extras. There are a lot of properties we could change, but the ones we are intrested in are:\r\n  QueryTemplateSelectPart\r\n  QueryTemplateFromPart\r\n  QueryTemplateWherePart\r\n  QueryTemplateOrderByPart\r\n\r\nThese 4 properties define the default search query which is sent to the SharePoint search engine. Add the following to the QueryTemplateWherePart:\r\nOR CONTAINS(' %__keywordinput__%') to the query. Delete the original Search Results webpart. Import the changed DWP file and place it on the page.\r\n\r\nTest the page. You will now have wildcard search. Of course this is a very simple addition to the search. When you want for example boolean search you still need to change the webparts yourself, but this can sometimes give the customer exactly what they want without custom development.","Declares":"","CodeCategory":{"CategoryId":"25","CategoryDescription":"Sharepoint 2003"},"Keywords":["Wildcard Search"]},{"RecordId":"690","Title":"Visual Studio Font & Color Settings - How to Save and Restore Them","Description":"All of the font/color information for the Visual Studio editor is stored in the registry.","Code":"All of the font/color information for the Visual Studio editor is stored in the registry. \r\n\r\nThe following key is the root of these settings for Visual Studio .NET 2002. HKEY_CURRENT_USER\\Software\\Microsoft\\VisualStudio\\7.0\\FontAndColors \r\n\r\nThe following key is the root of these settings for Visual Studio .NET 2003. HKEY_CURRENT_USER\\Software\\Microsoft\\VisualStudio\\7.1\\FontAndColors \r\n\r\n\r\nSaving your settings can be done by following these steps: \r\n1. Start -> Run -> RegEdit \r\n2. Registry -> Export Registry File. Paste the Key above into the box under Selected branch. Make sure Selected branch is checked \r\n3. Name your file and save it \r\n4. Close RegEdit \r\n\r\nUsing the reg file to set your settings can be done by following these steps: \r\n1. Right-click the reg file \r\n2. Click Merge from the context menu \r\n3. When prompted if you are sure chose Yes Note: If you have Visual Studio open, the settings will not take effect until it is opened again.","Declares":"","CodeCategory":{"CategoryId":"7","CategoryDescription":"Misc"},"Keywords":["Visual Studio Fonts and Colors"]},{"RecordId":"692","Title":"Expand Collapse (expander.js)","Description":"Cool Javascript file to allow each expand/compress sections of your web pages","Code":"/*===============================================================================\r\nusage:  In the <head> section of your page, put this:\r\n\r\n  <script language=\"JavaScript\" type=\"text/javascript\" src=\"expander.js\"></script>\r\n\r\nThen include an onload function in the <body...> tag like this:\r\n\r\n    <body onload=\"prepareExpander();\">\r\n\r\nIn your page's content, surround whatever you wish to be expandable / collapsible\r\nlike this:\r\n\r\n  <script type=\"text/javascript\">beginExpand();</script>\r\n  Content here.\r\n  <script type=\"text/javascript\">endExpand();</script>\r\n\r\nOptionally, you can pass arguments to the beginExpand() function to define the\r\ntrigger hypertext at runtime.  Example:\r\n  <script type=\"text/javascript\">beginExpand('+ Expand this','- Collapse this');</script>\r\n  Content here.\r\n  <script type=\"text/javascript\">endExpand();</script>\r\n\r\n===============================================================================*/\r\n\r\n// Modify the two variables below to customize the expand hypertext.\r\nvar closedExpand = \" [more ...] \";\r\nvar openedExpand = \" [less] \";\r\n\r\n// Stop editing!\r\n\r\nvar expandId = 0;\r\n\r\nfunction beginExpand(collapsedText,expandedText) {\r\n  if (typeof collapsedText == 'undefined') collapsedText = closedExpand;\r\n  if (typeof expandedText == 'undefined') expandedText = openedExpand; \r\n  document.write('<div id=\"expand' + expandId + '\" class=\"' + collapsedText + '&&&' + expandedText + '\">');\r\n}\r\n\r\nfunction endExpand() {\r\n  document.write('</div>');\r\n  expandId++;\r\n}\r\n\r\nfunction prepareExpander() {\r\n  divs = document.getElementsByTagName('div');\r\n  divIns = 0;\r\n  for (i = 0; i < divs.length; i++) {\r\n    if (typeof divs[i].getAttribute('id') != 'object' && divs[i].getAttribute('id').indexOf('expand') > -1) {\r\n      temp = divs[i].innerHTML;\r\n      tags = divs[i].className;\r\n      tags = tags.split('&&&');\r\n      divs[i].innerHTML = '<p><a href=\"javascript:expand(\\'exp' + divIns + '\\',\\'expand' + divIns + '\\');\">' + tags[0] + '</a></p><div id=\"exp' + divIns + '\" style=\"display: none;\">' + temp + '</div>';\r\n      divIns++; \r\n    }\r\n  }\r\n};\r\n\r\nfunction expand(what,where) {\r\n  temp = document.getElementById(what).innerHTML;\r\n  tags = document.getElementById(where).className;\r\n  tags = tags.split('&&&');\r\n  document.getElementById(where).innerHTML = '<p><a href=\"javascript:collapse(\\'' + what + '\\',\\'' + where + '\\');\">' + tags[1] + '</a></p><div id=\"' + what + '\" style=\"display: show;\">' + temp + '</div>';\r\n};\r\n\r\nfunction collapse(what,where) {\r\n  temp = document.getElementById(what).innerHTML;\r\n  tags = document.getElementById(where).className;\r\n  tags = tags.split('&&&');\r\n  document.getElementById(where).innerHTML = '<p><a href=\"javascript:expand(\\'' + what + '\\',\\'' + where + '\\');\">' + tags[0] + '</a></p><div id=\"' + what + '\" style=\"display: none;\">' + temp + '</div>';\r\n};\r\n","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["Expander","Expand","Collapse"]},{"RecordId":"693","Title":"Downloadable Web Fonts","Description":"CSS file that demonstrates how to implement a downloadable web font\r\n\r\nAlso, see the MSDN article:  http://msdn.microsoft.com/library/default.asp?url=/workshop/author/fontembed/font_embed.asp","Code":"@font-face {\r\n    font-family: AlphaMack AOE;\r\n    font-style:  normal;\r\n    font-weight: normal;\r\n    src: url(http://www.bloghole.net/include/ALPHAMA0.eot);\r\n}\r\n\r\nbody {\r\n\tcolor: #888;\r\n}\r\n\r\nbody, td {\r\n\tfont-family: \"AlphaMack AOE\",\"Courier New\", Courier, monospace;\r\n\tfont-size: 2em;\r\n\tline-height: 0.9em;\r\n}\r\n\r\n#isearch {\r\n\tposition: absolute;\r\n\tleft: 540px;\r\n\ttop: 10px;\r\n}\r\n\r\n\r\n.blogArchive table tr td {\r\n\tfont-size: 1.8em;\r\n\tline-height: 0.8em;\r\n}\r\n\r\n.title, .message {\r\n\tline-height: 0.8em;\r\n\tfont-size: 1.6em;\r\n}\r\n\r\n.oxyTable {\r\n\tfont-size: 10px;\r\n\tline-height: 10px;\r\n}\r\n","Declares":"","CodeCategory":{"CategoryId":"13","CategoryDescription":"CSS"},"Keywords":["Downloadable Web Font","Embedded Fonts"]},{"RecordId":"694","Title":"Make External Links Open In New Window","Description":"On page load, parses all <a href...> tags, determines which tags point to off-site locations, and inserts a \"target=_blank\" attribute for those off-site targets.\r\n","Code":"/*=========================================================================\r\nusage:  In the <head> section of your page, put this:\r\n\r\n  <script language=\"JavaScript\" type=\"text/javascript\" src=\"breakout_href.js\"></script>\r\n\r\nThen include an onload function in the <body...> tag like this:\r\n\r\n  <body onload=\"externalLinks('yourdomain.com');\">\r\n\r\nChange yourdomain.com appropriately.  Links containing this passed value open in a new window.\r\n=========================================================================*/\r\n\r\nfunction externalLinks(domain) {\r\n if (!document.getElementsByTagName) return;\r\n if (typeof domain == 'undefined') domain = window.location.domain.toString();\r\n var anchors = document.getElementsByTagName(\"a\");\r\n for (var i=0; i<anchors.length; i++) { \r\n   var anchorIns = anchors[i];\r\n   if (anchorIns.getAttribute(\"href\") && \r\n       (anchorIns.getAttribute(\"href\").indexOf(\"http://\") > -1 &&\r\n        anchorIns.getAttribute(\"href\").indexOf(domain) < 0))\r\n        anchorIns.target = \"_blank\";\r\n   } \r\n};\r\n","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["New Window","External Links","Breakout Links"]},{"RecordId":"696","Title":"SharePoint Search - Part 1","Description":"Part 1 of 2 - Explanation of the 4 Sharepoint Search webparts","Code":"SharePoint Search - Part I\r\n\r\nSubmitted By: Ingeborg Struijk\r\nPosted On: 4/26/2004  \r\n\r\nIntroduction \r\nThis article the functionality of the SharePoint Search page is described. This article will help you understand \r\nthe function of the controls on the search page, and help you extend or change the search functionality in your own \r\nportal without programming. In the next article I will describe the search controls in more detail, and explain how \r\nyou can create your own search page, add search criteria to the advanced search web part, add wild card search \r\nfunctionality etc.\r\n\r\nMatthijs Hoekstra already described some of the search control properties in his article Adding wildcard search to \r\nSharePoint Portal Server. In this article I will look at the search controls in more detail. In the second article I will \r\nexplain how you can develop your own SharePoint search web parts.\r\n\r\nSearch controls\r\nThe SharePoint Search page contains four important controls: SearchBox, AdvancedSearchControl, \r\nSearchResultManagement and SearchResults (See Figure 1). The next paragraphs describe the functionality of \r\nthese controls, and how you can extend the SharePoint search by developing your own controls.\r\n\r\n \r\nSearchBox \r\nIn the SearchBox you enter the search keyword. The SearchBox control is present on every SharePoint page. The \r\nmost interesting property of the SearchBox control is the SearchResultPageURL. This is the URL of the search \r\npage that is opened when you enter a search term. By default this property is set to SEARCH_HOME, and \r\nSearch.aspx is opened. When you develop your own search page, you can either replace the standard Search.aspx, \r\nor add your page and redirect to this page by changing the SearchResultPageURL of the SearchBox.\r\n\r\nThe property ContextSensitiveScopeType determined whether the default search scope is by the current topic \r\n(This topic) or the whole portal (All sources).\r\n\r\nContextSensitiveScopeType = 1 for This topic\r\nContextSensitiveScopeType = 0 for All sources\r\n\r\n<SPSWC:RightBodySectionSearchBox runat=\"server\" ContextSensitiveScopeType=\"1\" SearchResultPageURL=\"SEARCH_HOME\" FrameType=\"None\" WebPart=\"true\" __WebPartId=\"{B2FAE990-D76D-4CE2-819F-4EFD45426C1B}\"/>\r\n\r\nFigure 2 SearchBox control\r\n \r\nAdvancedSearch \r\nThe AdvancedSearch web part determines which criteria are used for the search. The search scope and additional \r\nsearch criteria are filled in in the AdvancedSearch web part.\r\n\r\nSearchResults  and SearchResultManagement\r\n\r\nThe SearchResults web part uses the search criteria (from Advanced Search), executes the search and displays \r\nthe search results. With the SearchResultManagement control you can show the search results in different views.\r\n\r\nThe SearchResults and SearchResultManagement controls are linked by the properties TargetResultListID (SearchResultsManagement) and ResultListID (SearchResults). These IDs must match.\r\n\r\nchange the search functionality (without programming)\r\n\r\nYou can change the search functionality by setting some properties of the SearchResults web part.\r\n\r\nThe properties of the SearchResults web part that determine which search query is executed are:\r\n QueryTemplateSelectPart\r\n QueryTemplateFromPart\r\n QueryTemplateWherePart\r\n QueryTemplateOrderByPart\r\n\r\nYou can use these properties to change the query that is executed. For instance: if you want to be able to enter a wildcard \r\n(*) in the SearchBox, you extend the QueryTemplateWherePart with CONTAINS (see Figure 3). \r\n\r\nwhere \r\nWITH (\"DAV:contentclass\":0,\"urn:schemas.microsoft.com:fulltextqueryinfo:description\":0,\"urn:schemas.microsoft.com:fulltextqueryinfo:sourcegroup\":0,\"urn:schemas.microsoft.com:fulltextqueryinfo:cataloggroup\":0,\"urn:schemas-microsoft-com:office:office#Keywords\":1.0,\"urn:schemas-microsoft-com:office:office#Title\":0.9,\"DAV:displayname\":0.9,\"urn:schemas-microsoft-com:publishing:Category\":0.8,\"urn:schemas-microsoft-com:office:office#Subject\":0.8,\"urn:schemas-microsoft-com:office:office#Author\":0.7,\"urn:schemas-microsoft-com:office:office#Description\":0.5,\"urn:schemas-microsoft-com:sharepoint:portal:profile:PreferredName\":0.2,contents:0.1,*:0.05) AS #WeightedProps \r\n\r\n((\"urn:schemas-microsoft-com:publishing:HomeBestBetKeywords\"= some array ['%__keywordinputnoboundaryquote__%'] \r\n\r\nRANK BY COERCION(absolute, 999))\r\n\r\nOR (FREETEXT(\"urn:schemas-microsoft-com:sharepoint:portal:profile:PreferredName\", '%__keywordinput__%')\r\n\r\nOR CONTAINS('\"%__keywordinput__%\"')  \r\n\r\nRANK BY COERCION(multiply, 0.01))\r\n\r\nOR FREETEXT(#WeightedProps, '%__keywordinput__%')  \r\n\r\n)\r\n\r\nAND (%__sourcegroups__%) %__morewhereCondition__% \r\n\r\nFigure 3 QueryTemplateWherePart extended to enable wild card search\r\n\r\nA few more interesting properties of the SearchResults web part are described below.\r\n\r\nDefaultSortBy\r\nThe default value of DefaultSortBy is:\r\nurn:schemas.microsoft.com:fulltextqueryinfo:rank\" DESC, so that by default the most important search result is \r\nshown first.\r\n\r\nMaxMatchingItemsNumber\r\nThe maximum number of search results shown.\r\n\r\nOpenNewWindowForMathingItems\r\nYou can use the property OpenNewWindowForMatchingItems to open search result items in a new window. By default \r\nthe property OpenNewWindowForMatchingItems is set to false. This means that search result items are shown in the original browser window. Many users find this behaviour confusing, and like to see the matching items in a new window.\r\n\r\nBy default there is no XML tag for this property on the Search page. So you have to add this tag (See Figure 4).\r\n\r\n  <OpenNewWindowForMatchingItems xmlns = \"urn:schemas-microsoft-com:sharepoint:DataResultBase\" > true </OpenNewWindowForMatchingItems>\r\n\r\nFigure 4 OpenNewWindowForMatchingItems tag of the SearchResults web part\r\n\r\nhow to change the web part properties\r\n\r\nThe easiest way to change the web part properties is to open the search page in FrontPage 2003. The web parts are then \r\ndisplayed as XML, and you can change the properties by typing other values.\r\n\r\nAn alternate way to change your web part is to export the web part, and modify the web part definition file (.DWP). You \r\ncan do that by using this URL: http://PortalName/Search.aspx?Mode=Edit&PageView=Shared \r\n\r\n\r\nDevelop your own search web parts\r\nIn this article I have shown which web parts provide the functionality of the standard SharePoint search page.In the next \r\narticle I will describe how you can develop your own web parts, based on de standard SharePoint web parts.","Declares":"","CodeCategory":{"CategoryId":"25","CategoryDescription":"Sharepoint 2003"},"Keywords":["Sharepoint Search"]},{"RecordId":"697","Title":"SharePoint Search - Part 2","Description":"Part 2 of 2 - Explanation of the 4 Sharepoint Search webparts","Code":"SharePoint Search - Part II\r\n\r\nSubmitted By: Ingeborg Struijk, e-office\r\nPosted On: 4/30/2004  \r\n\r\nIntroduction\r\nThis is the second article about the SharePoint Search page. In the first article the controls on the search page are described. In this article I describe how you can use the standard controls to create your own search web parts.\r\n\r\nBy developing your own search web part you can offer more extended search functionality. For example: look for documents that contain more than one search term, or exclude words from the search results (for example \"Find documents about 'SharePoint' that do not contain '2001' \").\r\n\r\nThe AdvancedSearch and SearchResults web parts are the most interesting web parts of this page. In AdvancedSearch the search criteria are entered, and SearchResults executes the search query.\r\n\r\nYou can create your own web parts, based on AdvancedSearch and SearchResults. You can still use the SearchResultManagement control to re-order the search results. There is no need to change or remove the SearchBox control when you add functionality to the AdvancedSearch and SearchResults web parts. So we leave the original SearchBox on the page as well.\r\n\r\nAdvancedSearch\r\nYou can create your own AdvancedSearchControl by inheriting from:\r\nMicrosoft.SharePoint.Portal.WebControls.AdvancedSearchControl\r\n\r\nWhen you inherit form this class, you can add extra functionality by adding your own controls. For example you can add a textbox in which a user can enter words that must be exluded from the search. So that you can execute queries like: Find documents about \"SharePoint\" that do not contain \"2001\".\r\n\r\nOr you can add a textbox in which a user can enter a phrase that must be found exactly. (When more than one term in the SearchBox SharePoint searches for one of these words, but not for the exact sentence.)\r\n\r\nThe only methods of the AdvancedSearchControl that you have to change are CreateChildControls and RenderWebPart. Because the query itself will be executed by the SearchResults web part.\r\n\r\nSearchResults\r\nThe SearchResults web part uses the search criteria (from AdvancedSearch), executes the search and displays the search results. So this is where the search actually takes place. You  can develop your own search web part by inheriting from the SearchResults class: Microsoft.SharePoint.Portal.WebControls.SearchResults\r\n\r\nIn the following paragraph, a few methods of the SearchResults control are described. The number of methods that you will have to use (override) depends on the complexity of the search functionality you like to offer.\r\n\r\nGenerateQueryString\r\nprotected override string GenerateQueryString(string strKeyword, System.Collections.ArrayList rgScopeList, string strWhereAndPart, out string strSavedQuery)\r\n\r\nIn GenerateQueryString the QueryTemplate properties (QueryTemplateSelectPart, QueryTemplateFromPart, QueryTemplateWherePart and QueryTemplateOrderByPart) are used to build the query that is executed. \r\n\r\nYou can use GenerateQueryString to append your own search criteria. For example: use the extra search terms that are entered in your own AdvancedSearch control to perform special search actions.\r\n\r\nSearch in search results\r\nThe string strSavedQuery can be used to search within search results. In SharePoint 2001 the default search page contained the option to search within search results, but for SharePoint 2003 you have to develop this functionality.\r\n\r\nIssueQuery\r\nprotected override object IssueQuery(string strQuery, int startRowIndex, int endRowIndex)\r\n\r\nIssueQuery uses the string that is created in GenerateQueryString to execute the search. A DataSet is returned.\r\n\r\nGenerateHtmlOneRowForOneItem\r\nprotected override void GenerateHtmlOneRowForOneItem(System.Data.DataRow objectDataRow, System.Text.StringBuilder sbRenderRowHtml, int rowID, string strStyleClass, int iIndexOfItemInDataSet, int iIndexOfItemInGroup)\r\n\r\nIn GenerateHtmlOneRowForOneItem the HTML for the search results is created. You can use this method for example to highlight the search terms in the results.\r\n\r\nConclusion\r\nIn two articles I have described the SharePoint search page and the controls that offer the search functionality. In the first article we have seen that we can offer a lot of extra functionality just by changing web part properties. Depending on the functionality you want to offer, you may have to develop your own search web part(s). In this second article I gave some ideas of the functionality you can provide.","Declares":"","CodeCategory":{"CategoryId":"25","CategoryDescription":"Sharepoint 2003"},"Keywords":["Sharepoint Search"]},{"RecordId":"698","Title":"Debugging Assembly Loading Failures","Description":"This article explains the use of Microsoft's Fusion Log Tool to debug assembly load problems.","Code":"Debugging Assembly Loading Failures \r\n\r\nNOTE:  This article explains the use of Microsoft's Fusion Log Tool, fuslogvw.exe, which is located in:  \r\nVisual Studio 7:      C:\\Microsoft Visual Studio .NET\\FrameworkSDK\\Bin\r\nVisual Studio 2003:   C:\\Program Files\\Microsoft Visual Studio .NET 2003\\SDK\\v1.1\\Bin\r\n\r\nSo...you're seeing a FileNotFoundException, FileLoadException, BadImageFormatException, or you suspect an assembly loading failure? Try the steps below to start your debugging process. \r\n\r\nFirst, get the Message property from the exception. If the exception's InnerException property is set, get the Message property from that. If the message is generic, also get the hresult by calling System.Runtime.InteropServices.Marshal.GetHRForException(), passing in the Exception object. If that info is not readily available, you may need to attach a debugger and set it to catch managed exceptions. Then, get the hresult by retrieving the private _HResult field of the managed Exception object. \r\n\r\nRetrieving the Fusion log: \r\n\r\nIf the exception message isn t enough for you to determine what the problem is, try getting the Fusion log. It will describe the binding failure (if this is due to an assembly binding failure, instead of a loading failure after the file is found). The exception may already include the log. If not, to get it, run fuslogvw.exe. If you don't have fuslogvw.exe already, install the Framework SDK.\r\n\r\nFor pre-v2.0: click on \"Log Failures.\" If this is an ASP.NET or .NET Windows service app, select the Custom option, and in regedit, set [HKLM\\Software\\Microsoft\\Fusion\\LogPath] to point to some directory (like c:\\mylogs, not c:\\). If you need to log all binds, not just failing ones, set [HKLM\\Software\\Microsoft\\Fusion\\ForceLog] as a DWORD value, to 1. \r\n\r\nFor v2.0: click on \"Settings,\" then choose \"Log bind failures to disk\" if you only care about the failures, or \"Log all binds to disk\" if you want to see all binding requests. \r\n\r\nTo turn on failure logging during a test run instead of by hand, have your script set [HKLM\\Software\\Microsoft\\Fusion\\LogFailures] as a DWORD value, to 1 in the registry.\r\n\r\nThen, click \"OK.\" Now, re-run the process. Next, click \"Refresh\" in fuslogvw, and a line should appear for each binding failure (or for each bind, if ForceLog is set). Keep in mind that there may not be any entries when if there were no binds, or if there were no binding failures (when logging failures only).  However, if there are not as many entries as you expect, you may need to clear your download cache to make room for them.   To do that, in Internet Explorer, choose Tools, Internet Options, Delete Files, OK, then re-run your app, and click Refresh again in fuslogvw.\r\n\r\nKeep in mind that there is only one Fusion log saved per display name/codebase. So, if the same exact reference is requested twice in the same process, it will only show up once in fuslogvw. To see the duplicate logs, you'll need to stop execution (for example, with breakpoints in your debugger), and then get the log at that time.\r\n\r\nNow, double-click on the line in the \"Application\" column for the interesting bind, and a web page should come up with the Fusion log. \r\n\r\nIf the file was found, it was loaded from the last path probed in the log (or from the GAC, if there is no probed path shown). \r\n\r\nFor FileNotFoundException: \r\nAt the bottom of the log will be the paths that Fusion tried probing for this assembly. If this was a load by path (as in Assembly.LoadFrom()), there will be just one path, and your assembly will need to be there to be found. Otherwise, your assembly will need to be on one of the probing paths listed, or in the GAC, if it s to be found. \r\n\r\nYou may also get this exception if an unmanaged dependency or internal module of the assembly failed to load. Try running depends.exe on the file to verify that unmanaged dependencies can be loaded. Note that if you re using ASP.NET, the PATH environment variable it s using may differ from the one the command line uses. If all of them could be loaded, try ildasm.exe on the file, double-click on \"MANIFEST\", and look for \".file\" entries. Each of those files will need to be in the same directory as the manifest-containing file. \r\n\r\nFor BadImageFormatException: \r\nTry running peverify.exe on the file. That will give a more specific description about why it s considered a bad image. \r\n\r\nFor SecurityException: \r\nYou need Execute permission for loading any assembly. Also, if a codebase was used to load this file, you would need FileIOPermission.Read and FileIOPermission.PathDiscovery, or WebPermission to the location (depending on whether this is a local file or a URL). Try caspol.exe to check your managed security settings. \r\n\r\nFor FileLoadException: \r\n\r\nFor an \"Access is denied\" message (for hresult E_ACCESSDENIED, 0x80070005): \r\nRun tlist -m on the file, to see if another process has the file locked and without share-read access. If not, check the ACLs for the file and its dependencies (especially if you're using impersonation). \r\n\r\nFor a \"The located assembly's manifest definition with name [yourAssembly] does not match the assembly reference\" message (for hresult FUSION_E_REF_DEF_MISMATCH, 0x80131040): \r\nThe Fusion log will say which part of the assembly reference failed to match what was found. It will be the assembly name, culture, public key (or token), or version (if the found assembly was strongly-named). \r\n\r\nFor \"Unverifiable image [yourAssembly] can not be run\" or \"Can not run executable [yourAssembly] because it contains relocations\" messages (for hresult COR_E_FIXUPSINEXE, 0x80131019): \r\nThat image must be run as the process exe, or else be compiled as a dll. This is because MC++ has made optimizations for you in your image, based on the assumption that it will be the process exe. If it's not the process exe, it won t be loaded at the expected location, so the assumed offsets will be incorrect. When the CLR sees such a file loaded as a non-process exe, it will reject the load.","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Assembly Load Failures","Fusion"]},{"RecordId":"699","Title":"XML Comment Tags for C#","Description":"XML comment tags for use in C#","Code":"/// <summary>\r\n/// Summary of your class ...\r\n/// NOTE:  An explanation of all comment tags is available at <see cref=\"ms-help://MS.NETFrameworkSDKv1.1/csref/html/vclrftagsfordocumentationcomments.htm\" />\r\n/// <para>You can use the \"see\" tag to link to other items as shown <see cref=\"here\" /></para>\r\n/// </summary>\r\n\r\n/// <remarks>Remarks start here ...\r\n/// <para>A new paragraph</para>\r\n/// <para>Another new paragraph</para>\r\n/// <list type=\"bullet\">\r\n/// <item><term>Author</term><description>Ted Gamble</description></item>\r\n/// <item><term>Created</term><description>5/14/2004</description></item>\r\n/// <item><term>Copyright</term><description> 2004 Your corp</description></item>\r\n/// <item><term>Revisions</term><description>N/A</description></item>\r\n/// </list>\r\n/// </remarks>\r\n\r\n/// <value>MyProperty1 gets and sets the value of ...  NOTE:  You should also use a 'Summary' tag to that the text will also show on the \"Members\" list.</value>\r\n/// <value>MyProperty2 gets and sets the value of ...  NOTE:  You should also use a 'Summary' tag to that the text will also show on the \"Members\" list.</value>\r\n/// <param name=\"param1\">Description of parm 1 ...</param>\r\n/// <param name=\"param2\">Description of parm 2 ...</param>\r\n/// <returns>Returns zero</returns>\r\n\r\n/// <example>The following example demonstrates ...\r\n/// <code lang=\"C#\">\r\n///   class MyClass \r\n///   {\r\n///      public static int Main() \r\n///      {\r\n///         return GetZero();\r\n///      }\r\n///   }\r\n///</code>\r\n/// </example>\r\n\r\n/// <exception cref=\"T:SomethingIsBadException\">Thrown when ...</exception>\r\n\r\n/// <seealso cref=\"YourClass.YourMethod\"/>","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["XML Comments","C# Documentation","NDoc"]},{"RecordId":"700","Title":"Catching Custom SQL Errors From Stored Procs","Description":"Demonstrates how to determine a custom error number when raised from a stored procedure.\r\nNOTE:  This example uses the DTDataAccess library.","Code":"DataSet ds = new DataSet();\r\nusing ( DTDataAccess da = new DTDataAccess( \"RACKv2ILM\" ))\r\n{\r\n  try\r\n  {\r\n    da.FillDataSet(\"Ted_sp\", ds, new string[] {\"Table1\"},\"1\");\r\n  } \r\n  catch (Exception E)\r\n  {\r\n    System.Data.SqlClient.SqlException EInnerException = E.InnerException \r\n           as System.Data.SqlClient.SqlException;\r\n    if (EInnerException != null)\r\n    {\r\n      int errNum = EInnerException.Number;\r\n      if (errNum == 51000) \r\n      {\r\n        MessageBox.Show(\"hello\");\r\n      }\r\n    }\r\n  }\r\n}\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Custom SQL Error","DTDataAccess"]},{"RecordId":"701","Title":"Catching Custom SQL Errors From Stored Procs (Expanded)","Description":"Demonstrates how to determine a custom error number when raised from a stored procedure.\r\nNOTE:  This example uses the DTDataAccess library.\r\n","Code":"//-----------------------------------------------------------------------------------------------------------\r\n// Sample usage\r\n//-----------------------------------------------------------------------------------------------------------\r\npublic bool CheckOut( Guid objectId, Guid newObjectId, CultureInfo cultureCode, string comments )\r\n{\r\n\r\n  using( DTDataAccess da = new DTDataAccess( Globals.DT_DATA_ACCESS_KEY ) )\r\n  {\r\n    try\r\n      {\r\n        da.ExecuteNonQuery( \"ILM_pub_CheckOutObject\", this.m_currentUserId, \r\n                     cultureCode.Name, objectId, newObjectId, comments ); \t\t\r\n      }\r\n      catch ( DTDataAccessException E )\r\n      {\r\n        SqlException sqlE = E.InnerException as SqlException;\r\n        if ( sqlE != null )\r\n        {\r\n          throw Globals.MapSqlException( sqlE, objectId );\r\n        }\r\n      }\r\n    }\r\n\t\r\n  return true;\r\n}\r\n\r\n//-----------------------------------------------------------------------------------------------------------\r\n// Globals.MapSqlException\r\n//-----------------------------------------------------------------------------------------------------------\r\ninternal class Globals\r\n{\r\n\r\n  internal const string DT_DATA_ACCESS_KEY = \"RACKv2ILM\";\r\n  internal const int SQL_ERR_OBJECT_CHECKED_OUT = 50501;\r\n\r\n  internal static Exception MapSqlException( SqlException E, params object[] parameters )\r\n  {\r\n    switch ( E.Number )\r\n    {\r\n      case SQL_ERR_OBJECT_CHECKED_OUT:\r\n        return new ObjectCheckedOutException( ( Guid ) parameters[ 0 ] );\r\n        break;\r\n    }\r\n    return E;\r\n  }\r\n}\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Custom SQL Error","DTDataAccess"]},{"RecordId":"702","Title":"NUnit Setup","Description":"Sets up current Visual Studio project properties to run under the context of NUnit","Code":"Are you getting tired of having to manually setup a Visual Studio Project for NUnit debugging?\r\n\r\nInstall this code into your VS Macros and run it using the Macro Explorer or Command Window.\r\n\r\nImports EnvDTE\r\nImports System.Diagnostics\r\nImports VSLangProj\r\n\r\nPublic Module NUnit\r\n\r\n    ' Replace if necessary\r\n    Public Const PathToNUnit As String = \"C:\\Program Files\\NUnit V2.1\\bin\\nunit-gui.exe\"\r\n\r\n    Sub SetupNUnitProjectForDebugging()\r\n        Dim projects As System.Array\r\n        projects = DTE.ActiveSolutionProjects()\r\n        If projects.Length > 0 Then\r\n            Dim project As Project\r\n            project = projects(0)\r\n            Debug.Write(project.Name)\r\n            Dim configProps As Properties = project.ConfigurationManager.Item(\"Debug\", \".NET\").Properties\r\n\r\n            With configProps\r\n                .Item(\"StartAction\").Value = prjStartAction.prjStartActionProgram\r\n                .Item(\"StartProgram\").Value = PathToNUnit\r\n            End With\r\n            DTE.Solution.Properties.Item(\"StartupProject\").Value = project\r\n        End If\r\n    End Sub\r\n\r\nEnd Module\r\n","Declares":"","CodeCategory":{"CategoryId":"26","CategoryDescription":".Net - Visual Studio IDE"},"Keywords":["NUnit"]},{"RecordId":"703","Title":"Dynamically Load Assembly and Call a Method","Description":"Demonstrates how to dynamically load a .Net assembly and call a method on it.","Code":"// Load the assembly\r\nObjectHandle objectHandle = Activator.CreateInstanceFrom(assemblyFile, typeName);\r\nobject phantomObject = objectHandle.Unwrap();\r\n\r\n// Cast it as to the real object\r\nBaseDialog baseDialog = phantomObject as BaseDialog;\r\n\r\n// Call a method on it\r\nDialogResult dialogResult = baseDialog.ShowDialog(_workspace);\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Dynamically load assembly"]},{"RecordId":"704","Title":"Execute DOS Application in .Net","Description":"Demonstrates how to run a DOS program in C#","Code":"Example 1. Running a command line application, without concern for the results:\r\nprivate void simpleRun_Click(object sender, System.EventArgs e)\r\n{\r\n System.Diagnostics.Process.Start(@\"C:\\listfiles.bat\");\r\n}\r\n\r\n\r\n\r\nExample 2. Retrieving the results and waiting until the process stops (running the process synchronously):\r\n\r\nprivate void runSyncAndGetResults_Click(object sender, System.EventArgs e)\r\n{\r\n System.Diagnostics.ProcessStartInfo psi = new System.Diagnostics.ProcessStartInfo(@\"C:\\listfiles.bat\");\r\n psi.RedirectStandardOutput = true; \r\n psi.WindowStyle = System.Diagnostics.ProcessWindowStyle.Hidden; \r\n psi.UseShellExecute = false; \r\n System.Diagnostics.Process listFiles; \r\n listFiles = System.Diagnostics.Process.Start(psi); \r\n System.IO.StreamReader myOutput = listFiles.StandardOutput; \r\n listFiles.WaitForExit(2000); \r\n if (listFiles.HasExited)  \r\n {\r\n   string output = myOutput.ReadToEnd();\r\n   this.processResults.Text = output; \r\n }\r\n}\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["DOS Batch","Shell"]},{"RecordId":"705","Title":"Shut Down and Restart Application on Error","Description":"Demonstrates how to shut down an application and restart it when an exception occurs.","Code":"//------------------------------------------------\r\n//  Put this code in Main(), before  Application.Run().  This hooks up the exception\r\n//  handler to the Application.ThreadException event.\r\n//------------------------------------------------\r\n\r\nExceptionHandlerRestart eh = new ExceptionHandlerRestart();\r\nApplication.ThreadException += new System.Threading.ThreadExceptionEventHandler(eh.OnApplicationError);\r\n\r\n\r\n//------------------------------------------------\r\n//  Sample code that triggers an error\r\n//------------------------------------------------\r\n\r\nprivate void cmdForceError_Click(object sender, System.EventArgs e)\r\n{\r\n  throw new Exception(\"foobar - restart\");\r\n}\r\n\r\n\r\n//------------------------------------------------\r\n//  ExceptionHandlerRestart.cs\r\n//  This code contains the method that runs when an Application.ThreadException \r\n//  event occurs.\r\n//------------------------------------------------\r\n\r\nusing System;\r\nusing System.Threading;\r\nusing System.Windows.Forms;\r\nusing System.Diagnostics;\r\n\r\nnamespace WinForms_Playground\r\n{\r\n  public class ExceptionHandlerRestart\r\n  {\r\n    public ExceptionHandlerRestart()\r\n    {\r\n    }\r\n\r\n    public void OnApplicationError( object sender, ThreadExceptionEventArgs t)\r\n    {\r\n      Application.Exit();\r\n      System.Diagnostics.Process.Start(Application.ExecutablePath);\r\n    }\r\n  }\r\n}\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Shut down","Restart","Exceptions"]},{"RecordId":"706","Title":"How to Embed and Access Resources Inside of Assemblies","Description":"Demonstrates how to embed and use resources inside of assemblies.","Code":"Files of almost any type or size can be embedded into your compiled assemblies. The files are stored within the assembly in the same structure as they are in the file system in your project. \r\n\r\nThe Assembly Manifest contains Metadata about the contents and locations of all files embedded within the assembly.  Using your assemblies to embed resources can be a very nice way to manage resources. By doing this, you reduce the number of files you distribute with your application. The management of local file structures within each distribution is also simplified.\r\n\r\nExample 1.0\r\n\r\nWith the ever increasing use of XML technologies, storing XML, XSLT or XSD required for your application may be a very common task. If your documents are actually part of your distrubuted library, embedding them within your assemblies can streamline a lot of your processes.\r\n\r\nExample 1.0 is a simplified way to wrap this task into a reusable function. This function will let you pull any UTF8 encoded resource from a given assembly and return it in the form of an XmlDocument object.\r\n\r\nprivate XmlDocument GetXmlResource(string Assembly, string Filename)\r\n{\r\n     Assembly myAssembly = Assembly.LoadFrom(Assembly);\r\n\r\n     // Example Filename = Greedo.MoreNamespaces.TradingPartner.xml\r\n     Stream fs = myAssembly .GetManifestResourceStream(Filename);\r\n     byte[] myBuffer = new Byte[fs.Length];\r\n     fs.Read(fs, 0, fs.Length);\r\n     string myResult = Encoding.UTF8.GetString(buffer);     \r\n     fs.Close();\r\n     \r\n     XmlDocument myXmlDoc = new XmlDocument();\r\n     myXmlDoc.LoadXml(myResult);\r\n     \r\n     return myXmlDoc;\r\n}\r\n\r\n\r\n\r\nExample 2.0\r\n\r\nRather than having to have a central data store for all of your files, you have instant access to them inside of your assembly. This also saves the you from having to manage file level permissions for your resources.  Embedding resources within an assembly also ties said resources to a specific version of an assembly. This implicitly ensures that outside modification of resources doesn't cause problems with internal code.\r\n\r\nIt is also very important to understand the impacts and limitations of using embedded resources. Storing large files or an excessive number of files is not a wise idea when using this technique for performance reasons. Using the assembly to store files that are being referenced very frequently and repeatedly without additional caching may also be an unwise design choice.\r\n\r\nI might recommend that in the case of frequent access, said files get cached into an intermediate data store during the life of the application. Example 2.0 shows a simple implementation of intermediate caching.\r\n\r\nprivate XmlDocument GetXmlResource(string Assembly, string Filename)\r\n{\r\n     Assembly myAssembly = Assembly.LoadFrom(Assembly);\r\n\r\n     if(Session[Filename] == null) \r\n     { \r\n          // Example Filename = Greedo.MoreNamespaces.TradingPartner.xml\r\n          Stream fs = myAssembly .GetManifestResourceStream(Filename);\r\n          byte[] myBuffer = new Byte[fs.Length];\r\n          fs.Read(fs, 0, fs.Length);\r\n          string myResult = Encoding.UTF8.GetString(buffer);     \r\n          fs.Close();\r\n     \r\n          XmlDocument myXmlDoc = new XmlDocument();\r\n          myXmlDoc.LoadXml(myResult);\r\n          \r\n          return myXmlDoc;\r\n     }\r\n     else \r\n     {\r\n          return (XmlDocument)Session[Filename];\r\n     }\r\n         \r\n}","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Embedded Resources"]},{"RecordId":"707","Title":"Add Your Custom Properties to Advanced Search","Description":"Here's the step by step on how to add your custom properties into the advanced search function.","Code":"Heres the step by step on how to add your custom properties into the advanced search function.\r\n\r\n1.      Log in into your portal using administrator account.\r\n\r\n2.      Go to Search Settings\r\n\r\n3.      Under Search Settings and Indexed Content, click Managed Properties from crawled documents.\r\n\r\n4.      Expand the namespace called urn:schemas-microsoft-com:office:office\r\n\r\n5.      Once expended, you will see all the attributes that are listed. Choose those attributes that relevant to you, the attributes that match the document properties, such as Control Number, Model Number, Part Type, etc. Your custom document properties should be listed here. If not, re-indexed your site directory first and start again.\r\n\r\n6.      Click on the property, and you will see the Edit Property page.\r\n\r\nThe two important things that you have to set in every property are the Name and Information and Search Options.\r\n\r\n\r\nIn Name and Information, for the Display name text ox, type the name that you want it to be display in the advanced search option.\r\n\r\nFor the Search Option, make sure you enable the Include this property in Advanced Search options. This is the option that displays the property in the advanced search option\r\n\r\n \r\n7.      Click OK.\r\n\r\n8.      Repeat steps 4-7 for all the properties that you need.\r\n\r\n9.      Re-indexed your portal and Non-portal Contents\r\n\r\n10   Click on the magnifying glass icon in the search tool bar on your top right page.\r\n\r\n11.   In the Search by properties, you can scroll down the drop down menu and choose the desirable property that you need.\r\n\r\nYou will see the properties you have added from the Manage Properties of Crawled Content\r\n\r\nYou can add or delete any properties that you want at any time. After you have added or delete any document properties, you have to re-index your indexes.","Declares":"","CodeCategory":{"CategoryId":"25","CategoryDescription":"Sharepoint 2003"},"Keywords":["Advanced Search","Custom Properties"]},{"RecordId":"708","Title":"Dynamically Load Assembly - Extensible UI","Description":"Demostrates how to build an extensible UI that dynamically loads assemblies from a config file","Code":"Introduction\r\n\r\nMany times it can be desirable to extend or enhance the User Interface (UI) of a program after it has been deployed. Usually this means redeploying the entire application. This document describes a plug in architecture that allows for the UI to be extended at any time. An example of a program with an extensible UI is the Microsoft Management Console (MMC) and its associated snap-ins.\r\nOverview\r\n\r\nThere is one main requirement that your program must meet before this architecture can be considered.  There should be NO interaction between UI plug-ins. This does not mean they cannot share a common data structure or business objects, but each UI plug-in should not try to make direct calls to other plug-ins.\r\n\r\nIn this architecture all UI elements are contained in a set of plug-ins based upon the System.Windows.Forms.UserControl class. All plug-ins are described in a configuration file, and loaded at runtime. Extending the UI is accomplished by creating a new plug-in and adding the appropriate entries to the config file.\r\n\r\nSome of the advantages of this architecture are:\r\n 1. Independent development of different UI elements. For example, if you are developing a Personal Information Manager (PIM), one person could be working on the \"Appointments/Calender\" UI, while another works on the \"Contacts\" UI.\r\n 2. Application control. You could restrict the functionality of the application based upon the user's name or the user's roll or purchased options.\r\n 3. You can add new UI elements at any time. In the PIM example above, you could add a \"Diary\" UI after the application has been distributed. \r\n\r\nThe architecture consists of 3 parts:\r\n\r\n   1. A shell application that handles the loading and navigation between the plug-ins.\r\n   2. A base class that supplies all communications between the shell and the plug-ins.\r\n   3. The individual UI plug-ins themselves. \r\n\r\n\r\n-----------------------------------------------------------------------------------------------------------------------------------\r\nThe plug-ins to be loaded at runtime are listed in an XML file named config.xml.\r\n\r\n<?xml version=\"1.0\" encoding=\"utf-8\" ?>\r\n<PlugIns>\r\n  <PlugIn Location=\"E:\\ExtensibleUI\\OurControls\\bin\\Debug\\OurControls.dll\" \r\n        Name=\"OurControls.PlugIn1\"></PlugIn>\r\n  <PlugIn Location=\"E:\\ExtensibleUI\\OurControls\\bin\\Debug\\OurControls.dll\" \r\n        Name=\"OurControls.PlugIn2\"></PlugIn>\r\n</PlugIns>\r\n\r\n\r\n\r\n-----------------------------------------------------------------------------------------------------------------------------------\r\nIn the form load event, the config.xml file is loaded into a DataSet via ReadXml. Then it iterates each DataRow calling AddPlugin with the location and name of the plug-in.\r\n\r\nprivate void Form1_Load(object sender, System.EventArgs e)\r\n{\r\n    DataSet ds = new DataSet();\r\n    ds.ReadXml(\"Config.xml\");\r\n    foreach(DataRow dr in ds.Tables[\"Plug-In\"].Rows)\r\n    {\r\n        AddPlugIn(dr[\"Location\"].ToString(),\r\n            dr[\"Name\"].ToString());\r\n    }\r\n}\r\n\r\n\r\n-----------------------------------------------------------------------------------------------------------------------------------\r\nThe AddPlugIn loads the assembly containing the plug-in and creates an instance of it. It also adds the plug-in to the ListBox. When a new item in the list box is selected, we need to hide the current plug-in, and show the new selection.\r\n\r\n// Load and add a plug-in to the panel1 control\r\n// Also set the list box to navigate between plugins.\r\nprivate void AddPlugIn(string Location, string ControlName)\r\n{\r\n    Assembly ControlLib;\r\n    PlugIn NewPlugIn;\r\n    // Load the assembly.\r\n    ControlLib = Assembly.LoadFrom(Location);\r\n\r\n    // Now create the plugin.\r\n    NewPlugIn = (PlugIn)ControlLib.CreateInstance(ControlName);\r\n    NewPlugIn.Location = new System.Drawing.Point(0, 0);\r\n    NewPlugIn.Dock = DockStyle.Fill;\r\n    NewPlugIn.Visible = false;\r\n    // Add it to the panel, note that its Visible property is false.\r\n    panel1.Controls.Add(NewPlugIn);\r\n    // Set up the ClickHandler\r\n    NewPlugIn.Clicked += new PlugInLib.ClickHandler(Control_Clicked);\r\n    // Add the plugin to the listBox, listBox will use ToString to\r\n    // get the text to display.\r\n    listBox1.Items.Add(NewPlugIn);\r\n\r\n}\r\n\r\nprivate PlugIn CurrentPlugIn;\r\n\r\n// When a new item in the listBox is selected,\r\n// hide the current plugin and show the new.\r\nprivate void listBox1_SelectedIndexChanged(object sender, \r\n                                           System.EventArgs e)\r\n{\r\n    if(CurrentPlugIn!=null)\r\n    {\r\n        CurrentPlugIn.Visible = false;\r\n    }\r\n    CurrentPlugIn = (PlugIn)listBox1.SelectedItem;\r\n    CurrentPlugIn.Visible = true;\r\n}\r\n\r\n\r\n-----------------------------------------------------------------------------------------------------------------------------------\r\nThe PlugIn base class is based upon the System.Windows.Forms.UserControl class and extends it to provide predefined events, methods, and properties that each plug-in can use to communicate with the shell applications. In this example a Clicked event, a Caption property, and a TestFunction method are predefined. In addition, ToString is overridden to return the Caption instead of the object name.\r\n\r\nusing System;\r\nusing System.Windows.Forms;\r\n\r\nnamespace PlugInLib\r\n{\r\n    /// <summary>\r\n    /// A delegate type for hooking up notifications.\r\n    /// </summary>\r\n     public delegate void ClickHandler(object sender, EventArgs e);\r\n    /// <summary>\r\n    /// Summary description for PlugIn.\r\n    /// </summary>\r\n    public class PlugIn : System.Windows.Forms.UserControl\r\n    {\r\n        // The following provides \"Clicked\" event back to the container.\r\n        public event ClickHandler Clicked;\r\n        protected void DoClick(EventArgs e)\r\n        {\r\n            if (Clicked != null)\r\n                Clicked(this, e);\r\n        }\r\n        // Provide a \"Caption\" that the container can display.\r\n        protected string m_Caption = \"PlugIn\";\r\n        public string Caption\r\n        {\r\n            get\r\n            {\r\n                return m_Caption;\r\n            }\r\n            set\r\n            {\r\n                m_Caption = value;\r\n            }\r\n        }\r\n        public override string ToString()\r\n        {\r\n            return m_Caption;\r\n        }\r\n\r\n        // Provide a method \"TestFunction\" that the container can call.\r\n        public virtual void TestFunction()\r\n        {\r\n        }\r\n    }\r\n}\r\n\r\n\r\n-----------------------------------------------------------------------------------------------------------------------------------\r\nCreating a UI plug-in.\r\n\r\n   1. Use Visual Studio to create a new Windows Control Library.\r\n   2. Add a reference to the PlugInLib that contains the plug-in base class.\r\n   3. Change the name of the user control from UserControl1 to something more descriptive.\r\n   4. Add the using directive for the PlugInLib.\r\n   5. Change the base class for the user control from System.Windows.Forms.UserControl to PlugIn.\r\n   6. Connect any events that you want to send to the shell applications.\r\n   7. Add the necessary overrides for calls from the shell to the plug-in.\r\n   8. Construct your UI as you would for any other UserControl. \r\n\r\nusing System;\r\nusing System.Collections;\r\nusing System.ComponentModel;\r\nusing System.Drawing;\r\nusing System.Data;\r\nusing System.Windows.Forms;\r\nusing PlugInLib;            // <---Add using for the plug-In base class\r\n\r\nnamespace OurControls\r\n{\r\n    /// <summary>\r\n    /// Summary description for PlugIn3.\r\n    /// </summary>\r\n    public class PlugIn3 : PlugIn    // <---Change base class to PlugIn\r\n    {\r\n        /// <summary> \r\n        /// Required designer variable.\r\n        /// </summary>\r\n        private System.ComponentModel.Container components = null;\r\n\r\n        public PlugIn3()\r\n        {\r\n            // This call is required by the Windows.Forms Form Designer.\r\n            InitializeComponent();\r\n\r\n            // TODO: Add any initialization after the InitForm call\r\n\r\n        }\r\n\r\n        /// <summary> \r\n        /// Clean up any resources being used.\r\n        /// </summary>\r\n        protected override void Dispose( bool disposing )\r\n        {\r\n            if( disposing )\r\n            {\r\n                if(components != null)\r\n                {\r\n                    components.Dispose();\r\n                }\r\n            }\r\n            base.Dispose( disposing );\r\n        }\r\n\r\n        #region Component Designer generated code\r\n        /// <summary> \r\n        /// Required method for Designer support - do not modify \r\n        /// the contents of this method with the code editor.\r\n        /// </summary>\r\n        private void InitializeComponent()\r\n        {\r\n            // \r\n            // PlugIn3\r\n            // \r\n            this.Caption = \"PlugIn 3\";\r\n            this.Name = \"PlugIn3\";\r\n            this.Click += new System.EventHandler(this.PlugIn3_Click);\r\n\r\n        }\r\n        #endregion\r\n\r\n        // Override Base class to receive call from the shell.\r\n        public override void TestFunction()\r\n        {\r\n            Console.WriteLine(\"TestFunction called by the shell.\");\r\n        }\r\n\r\n        // Send clicks to the shell, just because we can.\r\n        private void PlugIn3_Click(object sender, System.EventArgs e)\r\n        {\r\n            DoClick(e);\r\n        }\r\n    }\r\n}","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Dynamically load assembly","Extensible UI"]},{"RecordId":"709","Title":"Copy SiteGroups or Roles from One Site to Another Site","Description":"Code to copy Role or Site Groups from one SPS Site to another Site.\r\n","Code":"string strSiteA = \"http://localhost/sites/topsite/siteA\";\r\nstring strSiteB = \"http://localhost/sites/topsite/siteB\";\r\n\r\n//Get Reference to Site A\r\nSPSite siteTopA = new SPSite(strSiteA);\r\nSPWeb siteA = siteTopA.OpenWeb();\r\n\r\n\r\n//Get Reference to Site B\r\nSPSite siteTopB = new SPSite(strSiteB);\r\nSPWeb siteB = siteTopB.OpenWeb();\r\n\r\n\r\n//Get Site Groups of Site A\r\nSPRoleCollection siteGrpsSiteA = siteTopA.Roles;\r\n\r\nstring some = roleCollectionCommunity.Count.ToString();\r\n\r\n//Copy Site Groups into Site B\r\nsiteB.AllowUnsafeUpdates=true;\r\n\r\nSPRoleCollection siteGrpsSiteB= siteB.Roles;\r\n\r\nforeach (SPRole siteARole in roleCollectionCommunity)\r\n{\r\n\r\n  //If not default site groups add the site group\r\n    if (siteARole.Name.ToString()!=\"Administrator\"&&siteARole.Name.ToString()!=\"Guest\"&&siteARole.Name.ToString()!=\"Reader\"&&siteARole.Name.ToString()!=\"Contributor\"&&siteARole.Name.ToString()!=\"Web Designer\")\r\n    {\r\n        //Get the permissions associated with the site group\r\n        SPRights rights = siteARole.PermissionMask; \r\n        siteGrpsSiteB.Add(siteARole.Name,siteARole.Description,rights);  \r\n    }\r\n}\r\n\r\n \r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"25","CategoryDescription":"Sharepoint 2003"},"Keywords":["Site Groups","Roles"]},{"RecordId":"710","Title":"Create a Site or Web Using Custom Web Template","Description":"How to Create a Site Using Custom Web Template (thru Code)","Code":"Steps to create a Custom Template:\r\n\r\n1. Create a Site or Web using Sharepoint interface.\r\n\r\n2. Customize the Site or Web as required.\r\n\r\n3. Thru Administration interface save the site as template.\r\n   GoTo Site Settings -> Go to Site Administration -> Save site as template \r\n   A new Site template will be created and saved in the Site Template Gallery of the    Topsite.\r\n\r\n\r\nUsing the Custom Template to create a site from code:\r\n\r\n//TopSite URL\r\nstring strTopSite = \"http://localhost/sites/topsite/\";\r\n\r\n//Custom Template Name\r\nstring strTemplateName = \"MyTemplate\";\r\n\r\n//Get the Web Collection to which new web to be added\r\nSPSite siteTop = new SPSite(strTopSite);\r\nSPWeb siteRoot = siteTop.OpenWeb();\r\nSPWebCollection  myWebs = siteRoot.Webs;\r\n\r\n//Get Custom Web Template Collection\r\nSPWebTemplateCollection webTemplateCollection = siteTop.GetCustomWebTemplates(1033);\r\n\r\n//Get reference to the Custom Template from the collection\r\nSPWebTemplate webTemplate = webTemplateCollection[strTemplateName];  \r\n\r\n//Create the Web using the selected template\r\nmyWebs.Add(\"WebName\",\"Title\", \"Purpose\", 1033,webTemplate,  true, false);\r\n            \r\n\r\nNote: \r\n\r\n1. Custom Web template is given as the fourth Parameter. Here instead of the webTemplate object custom web template name (string) also can be used.\r\n\r\n2. We have retrieve the custom web template collection from the topsite where we have created the custom template.\r\n","Declares":"","CodeCategory":{"CategoryId":"25","CategoryDescription":"Sharepoint 2003"},"Keywords":["Site Creation","Template Site"]},{"RecordId":"711","Title":"Logoff IE","Description":"JavaScript to logoff IE.  NOTE:  Requires IE6, SP1.","Code":"function CNETLogoff()\r\n{\r\n\ttry\r\n\t{\r\n\t\tif (browseris.ie6up)\r\n\t\t{\r\n\t\t\tdocument.execCommand(\"ClearAuthenticationCache\",\"false\");\r\n\t\t\talert('You have been logged off from this Web site. Note that if you run Internet Explorer 6.0 without Service Pack 1 you need to close all browser windows in order to complete the log off process.');\r\n\t\t\tself.location.href = \".\";\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\talert(\"This feature requires Internet Explorer 6.0 Service Pack 1 or above. You need to close all browser windows in order to complete the log off process.\");\r\n\t\t}\r\n\t}\r\n\tcatch (e)\r\n\t{\r\n\t\talert(\"This feature requires Internet Explorer 6.0 Service Pack 1 or above. You need to close all browser windows in order to complete the log off process.\");\r\n\t}\r\n}\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["Logoff Browser","Logoff IE"]},{"RecordId":"712","Title":"Disable Right-click Context Menu for Text Boxes","Description":"Disables the context menu in text boxes when user right clicks.","Code":"To disable the right-click, assign an empty context menu to the textbox (Ctrl-x, Ctrl-c, Ctrl-v still work for handling the clipboard):\r\n\r\n  txtMyTextBox.ContextMenu = new ContextMenu();\r\n\r\n\r\nTo disable Ctrl-v:\r\n\r\n  protected override bool ProcessCmdKey ( ref Message msg, Keys keyData)\r\n  {\r\n    if ( keyData == ( Keys.Control | Keys.V ) return true;\r\n    else return base.ProcessCmdKey ( ref msg, keyData );\r\n  }\r\n\r\n\r\nAn alternative to assigning an empty context menu is to intercept the right button message:\r\n\r\n  private const int WM_RBUTTONDOWN = 0x0204;\r\n  protected override void WndProc ( ref Message m)\r\n  {\r\n    if ( m.msg == WM_RBUTTONDOWN )\r\n    {\r\n      m.Result = ( IntPtr ) 0;\r\n      return;\r\n    }\r\n    base.WndProc ( ref m ) ;\r\n  }","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Disable Context Menu","Disable Right-click"]},{"RecordId":"713","Title":"Favor Object Composition Over Class Inheritance","Description":"Favor Object Composition over Class Inheritance","Code":"Favor Object Composition Over Class Inheritance\r\n\r\n[ This is an excerpt from \"Design Patterns: Elements of Reusable OO SW\", by Gamma, Helm, Johnson, and Vlissides, p 18-20. Gamma is the author of ET++ and works at Taligent. Vlissides is the author of Interviews and works at IBM Watson Research Center. Johnson is a professor in Illinois and teaches courses on how to build frameworks. All have written extensively on OO design and reuse. -adc ]\r\n\r\nThe two most common techniques for reusing functionality in object-oriented systems are class inheritance and object composition. As we've explained class inheritance lets you define the implementation of one class in terms of another's. Reuse by sub-classing is often referred to as white-box reuse. The term white-box refers to visibility: with inheritance, the internals of parent classes are often visible to subclasses.\r\n\r\nObject composition is an alternative to class inheritance. Here, new functionality is obtained by assembling or composing objects to get more complex functionality. Object composition requires that the objects being composed have well-defined interfaces. This style of reuse is called black-box reuse, because no internal details of objects are visible. Objects appear only as black boxes.\r\n\r\nInheritance and composition each have their advantages and disadvantages. Class inheritance is defined statically at compile-time and is straight-forward to use, since it's supported directly by the programming language. Class inheritance also makes it easier to modify the implementation being reused. When a subclass overrides some but not all operations, it can affect the operations it inherits as well, assuming they call the overridden operations.\r\n\r\nBut class inheritance has some disadvantages too. First, you can't change the implementations inherited from parent classes at run-time, because inheritance is defined at compile-time. Second, and generally worse, parent classes often define at least part of their subclasses' physical representation. Because inheritance exposes a subclass to details of its parent's implementation, it's often said that \"inheritance breaks encapsulation\". The implementation of a subclass becomes so bound up with the implementation of its parent class that any change in the parent's implementation will for the subclass to change.\r\n\r\nImplementation dependencies can cause problems when you're trying to reuse a subclass. Should any aspect of the inherited implementation not be appropriate for the new problem domains, the parent class must be rewritten or replaced by something more appropriate. This dependency limits flexibility and ultimately reusability.  One cure for this is to inherit only from abstract classes, since they usually provide little or no implementation.\r\n\r\nObject composition is defined dynamically at run-time through objects acquiring references to other objects. Composition requires objects to respect each other's interfaces, which in turn requires carefully designed interfaces that don't stop you from using one object with many others. But there is a payoff. Because objects are accessed solely through their interfaces, we don't break encapsulation. Any object can be replaced at run-time by another as long as it has the same type.  Moreover, because an object's implementation will be written in terms of object interfaces, there are substantially fewer implementation dependencies.\r\n\r\nObject composition has another effect on system design. Favoring object composition over class inheritance helps you keep each class encapsulated and focused on one task.  Your classes and class hierarchies will remain small and will be less likely to grow into unmanageable monsters. On the other hand, a design based on object composition will have more objects (if fewer classes), and the system's behavior will depend on their interrelationships instead of being defined in one class.\r\n\r\nThat leads us to our second principle of object-oriented design:\r\n\tFavor object composition over class inheritance\r\n\r\nIdeally you shouldn't have to create new components to achieve reuse. You should be able to get all the functionality you need by assembling existing components through object composition. But this is rarely the case, because the set of available components is never quite rich enough in practice.  Reuse by inheritance makes it easier to make new components that can be composed with old ones. Inheritance and object composition thus work together.\r\n\r\nNevertheless, our experience is that designers overuse inheritance as a reuse technique and designs are often made more reusable (and simpler) by depending more on object composition.","Declares":"","CodeCategory":{"CategoryId":"27","CategoryDescription":"OO Principles"},"Keywords":["Favor Object Composition"]},{"RecordId":"714","Title":"Notes on Object-Oriented Approaches by James W. Cooper","Description":"Notes on Object-Oriented Approaches by James W. Cooper","Code":"Notes on Object-Oriented Approaches by James W. Cooper\r\n\r\nThe fundamental reason for using design patterns is to keep classes separated and prevent them from having to know too much about one another. Equally important, using these patterns helps you avoid reinventing the wheel and allows you to describe your programming approach succinctly in terms other programmers can easily understand.\r\n\r\nThere are a number of strategies that OO programmers use to achieve this separation, among them encapsulation and inheritance. Nearly all languages that have OO capabilities support inheritance. A class that inherits from a parent class has access to all of the methods of that parent class and to all of its nonprivate variables. However, by starting your inheritance hierarchy with a complete, working class, you may be unduly restricting yourself as well as carrying along specific method implementation baggage. Instead, Design Patterns suggests that you always do the following.\r\n\r\n  Program to an interface and not to an implementation.\r\n\r\nPutting this more succinctly, you should define the top of any class hierarchy with an abstract class or an interface, which implements no methods but simply defines the methods that class will support. Then in all of your derived classes you have more freedom to implement these methods as most suits your purposes.\r\n\r\nThe other major concept you should recognize is that of object composition. This is simply the construction of objects that contain others: encapsulation of several objects inside another one. While many beginning OO programmers use inheritance to solve every problem, as you begin to write more elaborate programs, you will begin to appreciate the merits of object composition.Your new object can have the interface that is best for what you want to accomplish without having all the methods of the parent classes. Thus, this is the second major precept suggested by Design Patterns.\r\n\r\n  Favor object composition over inheritance.\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"27","CategoryDescription":"OO Principles"},"Keywords":["Object-Oriented Approaches","Design Patterns"]},{"RecordId":"715","Title":"Principles of OO Design From the Gang of Four","Description":"Principles of OO Design from the Gang of Four as described in \"Design Patterns Explained: A New Perspective on Object-Oriented Design\", written by Alan Shalloway, James R. Trott, and James Trott","Code":"Principles of OO Design from the Gang of Four as described in \"Design Patterns Explained: A New Perspective on Object-Oriented Design\", written by Alan Shalloway, James R. Trott, and James Trott\r\n\r\n1 - Design to interfaces - Designing to interfaces allows us to hide implementations.\r\n\r\n2 - Encapsulate what varies - Encapsulation is not just data-hiding, but class hiding when\r\n     polymorphism is used.\r\n\r\n3 - Favor object composition over class inheritance - Inheritance should be thought of as a\r\n     way to classify, not specialize - we get reuse by containing previously developed objects.\r\n     Using object composition when possible instead of inheritance allows us to avoid large\r\n    class hierarchies that are difficult to maintain.","Declares":"","CodeCategory":{"CategoryId":"27","CategoryDescription":"OO Principles"},"Keywords":["Principles of OO Design","3 Guiding Principles"]},{"RecordId":"716","Title":"Custom Configuration Section Handler","Description":"Demonstrates how to build a custom configuration section handler to handle custom sections in app.config or web.config.","Code":"The Last Configuration Section Handler I'll Ever Need\r\n\r\nIf you've ever seen the web.config file that ASP.NET uses, and thought, \"Wow, I'm so glad they configure things that way, in this nice, easy-to-use XML file. Wish I could do that!\" then you should check out the System.Configuration namespace. There's an interface called IConfigurationSectionHandler that lets you write your own parsers for your application configuration file, letting you put whatever you want in there. \r\n\r\nI've written a bunch of these over the last few months, but today I wrote the last one I ever will. Here's the code for it:\r\n\r\nusing System; \r\nusing System.Configuration ; \r\nusing System.Xml ; \r\nusing System.Xml.Serialization ; \r\nusing System.Xml.XPath ; \r\n\r\nnamespace DevelopMentor.Candera.Utilities \r\n{ \r\n\r\n\tpublic class XmlSerializerSectionHandler : IConfigurationSectionHandler \r\n\t{ \r\n\t\r\n\t\tpublic object Create( object parent, object configContext, System.Xml.XmlNode section) \r\n\t\t{ \r\n\t\t\tXPathNavigator nav = section.CreateNavigator (); \r\n\t\t\tstring typename = ( string ) nav.Evaluate (\"string(@type)\"); \r\n\t\t\tType t = Type.GetType ( typename ); \r\n\t\t\tXmlSerializer ser = new XmlSerializer (t); \r\n\t\t\treturn ser.Deserialize ( new XmlNodeReader (section)); \r\n\t\t} \r\n\t} \r\n} \r\n\r\n\r\n\r\nIts very, very simple. When you map a section of your configuration file to this handler, using an entry in your config file that looks like this: \r\n\r\n< configuration > \r\n\t< configSections > \r\n\t\t< section name = \" MyStuff \" type =\"DevelopMentor.Candera.Utilities.XmlSerializerSectionHandler, Utilities\"/> \r\n\t</ configSections > \r\n</ configuration > \r\n\r\n\r\nWhat happens is that any time you ask for the MyStuff section of the config file with code that looks like this: \r\n\tConfigurationSettings.GetConfig (\" MyStuff \"); \r\n\r\n\r\nIt will actually go look in the config file to figure out who knows how to deal with the MyStuff section. When it sees that its the XmlSerializerSectionHandler, itll create an instance of this object and call Create, passing it (via the section parameter) a reference to the relevant portion of the config file. In our case, it might look something like this: \r\n\r\n< configuration > \r\n\t<!-- configSections element goes here -->   \r\n\t< MyStuff type =\" SomeNamespace.MyStuff , CraigsConfig \"> \r\n\t\t< Foo > 1.234 </ Foo > \r\n\t\t< Bar > A bunch of information </ Bar > \r\n\t</ MyStuff > \r\n</ configuration > \r\n\r\n\r\nWhat my handler does is to look for the type attribute on this bit of XML, in the form classname, assemblyname. In this case, its a class called MyStuff in a namespace SomeNamespace. It then  and heres the good bit  uses the XmlSerializer to initialize an instance of this type from the XML in the configuration file. The XmlSerializer is a very cool piece of the .NET libraries, and you should check it out if you havent already. Basically, you write a type like this: \r\n\r\npublic class MyStuff \r\n{ \r\n\tprivate float foo ; \r\n\tprivate string bar; \r\n\t\r\n\tpublic float Foo \r\n\t{ \r\n\t\tget { return foo ; } \r\n\t\tset { foo = value ; } \r\n\t} \r\n\t\r\n\tpublic string Bar \r\n\t{ \r\n\t\tget { return bar; } \r\n\t\tset { bar = value ; \r\n\t} \r\n} \r\n\r\n\r\nAnd the XmlSerializer takes care of turning it into the XML above and vice versa. There are even a bunch of attributes you can use to control the process. \r\n\r\nSo given the section handler I wrote, any time I want to put some information in a config file, all I have to do is write a type like MyStuff, map a section to my XmlSerializerSectionWriter, write some XML into the config file with the values Id like to capture and then ask the infrastructure to read it like this: \r\n\tMyStuff ms = ( MyStuff ) ConfigurationSettings.GetConfig (\" MyStuff \"); \r\n\r\n\r\nBingo!","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Custom Configuration Section","App.Config","Web.Config"]},{"RecordId":"717","Title":"File System Watcher","Description":"Detects when changes to a file occur and raises an event","Code":"void WatchForFileChanges()\r\n{\r\n    FileInfo myFile = new FileInfo( \"myfile.txt\" );\r\n    try\r\n    {\r\n        _watcher = new FileSystemWatcher(myFile.DirectoryName);\r\n        _watcher.Filter = myFile.Name;\r\n        _watcher.NotifyFilter = NotifyFilters.LastWrite;\r\n        _watcher.Changed += new FileSystemEventHandler(OnConfigChanged);\r\n        _watcher.EnableRaisingEvents = true;\r\n    }\r\n    catch(Exception ex)\r\n    {\r\n        Log.Error( \"An error occurred while attempting to watch for file system changes.\", ex );\r\n    }\r\n}\r\n\r\nvoid OnConfigChanged(object sender, FileSystemEventArgs e)\r\n{\r\n    // do something here...\r\n}\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["File System Watcher"]},{"RecordId":"718","Title":"XML Serialization of Objects","Description":"Demonstrates how to use the XMLSerializer to serialize and deserialize objects.","Code":"The XMLSerializer serializes and deserializes objects into and from XML documents. The XmlSerializer also enables you to control how objects are encoded into XML.\r\n\r\nNOTE:  Serializing class properties into XML attributes instead of into XML elements performs automatic escaping of the data (plus it makes the XML less verbose).  You can not do this on complex types, but for simple types, this would be recommended.\r\n\r\n\r\nThe following example creates a Purchase Order object (with Address and Line Item objects).  It then serializes the PO object into an XML file.  Lastly, it deserializes the XML file and recreates the actual objects.\r\n\r\nusing System;\r\nusing System.Xml;\r\nusing System.Xml.Serialization;\r\nusing System.IO;\r\n\r\n/* The XmlRootAttribute allows you to set an alternate name \r\n   (PurchaseOrder) of the XML element, the element namespace; by \r\n   default, the XmlSerializer uses the class name. The attribute \r\n   also allows you to set the XML namespace for the element.  Lastly,\r\n   the attribute sets the IsNullable property, which specifies whether \r\n   the xsi:null attribute appears if the class instance is set to \r\n   a null reference. */\r\n[XmlRootAttribute(\"PurchaseOrder\", Namespace=\"http://www.cpandl.com\", \r\nIsNullable = false)]\r\npublic class PurchaseOrder\r\n{\r\n   public Address ShipTo;\r\n   public string OrderDate; \r\n   /* The XmlArrayAttribute changes the XML element name\r\n    from the default of \"OrderedItems\" to \"Items\". */\r\n   [XmlArrayAttribute(\"Items\")]\r\n   public OrderedItem[] OrderedItems;\r\n   public decimal SubTotal;\r\n   public decimal ShipCost;\r\n   public decimal TotalCost;   \r\n}\r\n \r\npublic class Address\r\n{\r\n   /* The XmlAttribute instructs the XmlSerializer to serialize the Name\r\n      field as an XML attribute instead of an XML element (the default\r\n      behavior). */\r\n   [XmlAttribute]\r\n   public string Name;\r\n   public string Line1;\r\n\r\n   /* Setting the IsNullable property to false instructs the \r\n      XmlSerializer that the XML attribute will not appear if \r\n      the City field is set to a null reference. */\r\n   [XmlElementAttribute(IsNullable = false)]\r\n   public string City;\r\n   public string State;\r\n   public string Zip;\r\n}\r\n \r\npublic class OrderedItem\r\n{\r\n   public string ItemName;\r\n   public string Description;\r\n   public decimal UnitPrice;\r\n   public int Quantity;\r\n   public decimal LineTotal;\r\n\r\n   /* Calculate is a custom method that calculates the price per item,\r\n      and stores the value in a field. */\r\n   public void Calculate()\r\n   {\r\n      LineTotal = UnitPrice * Quantity;\r\n   }\r\n}\r\n \r\npublic class Test\r\n{\r\n   public static void Main()\r\n   {\r\n      // Read and write purchase orders.\r\n      Test t = new Test();\r\n      t.CreatePO(\"po.xml\");\r\n      t.ReadPO(\"po.xml\");\r\n   }\r\n\r\n   private void CreatePO(string filename)\r\n   {\r\n      // Create an instance of the XmlSerializer class;\r\n      // specify the type of object to serialize.\r\n      XmlSerializer serializer = \r\n      new XmlSerializer(typeof(PurchaseOrder));\r\n      TextWriter writer = new StreamWriter(filename);\r\n      PurchaseOrder po=new PurchaseOrder();\r\n       \r\n      // Create an address to ship and bill to.\r\n      Address billAddress = new Address();\r\n      billAddress.Name = \"Teresa Atkinson\";\r\n      billAddress.Line1 = \"1 Main St.\";\r\n      billAddress.City = \"AnyTown\";\r\n      billAddress.State = \"WA\";\r\n      billAddress.Zip = \"00000\";\r\n      // Set ShipTo and BillTo to the same addressee.\r\n      po.ShipTo = billAddress;\r\n      po.OrderDate = System.DateTime.Now.ToLongDateString();\r\n \r\n      // Create an OrderedItem object.\r\n      OrderedItem i1 = new OrderedItem();\r\n      i1.ItemName = \"Widget S\";\r\n      i1.Description = \"Small widget\";\r\n      i1.UnitPrice = (decimal) 5.23;\r\n      i1.Quantity = 3;\r\n      i1.Calculate();\r\n \r\n      // Insert the item into the array.\r\n      OrderedItem [] items = {i1};\r\n      po.OrderedItems = items;\r\n      // Calculate the total cost.\r\n      decimal subTotal = new decimal();\r\n      foreach(OrderedItem oi in items)\r\n      {\r\n         subTotal += oi.LineTotal;\r\n      }\r\n      po.SubTotal = subTotal;\r\n      po.ShipCost = (decimal) 12.51; \r\n      po.TotalCost = po.SubTotal + po.ShipCost; \r\n      // Serialize the purchase order, and close the TextWriter.\r\n      serializer.Serialize(writer, po);\r\n      writer.Close();\r\n   }\r\n \r\n   protected void ReadPO(string filename)\r\n   {\r\n      // Create an instance of the XmlSerializer class;\r\n      // specify the type of object to be deserialized.\r\n      XmlSerializer serializer = new XmlSerializer(typeof(PurchaseOrder));\r\n      /* If the XML document has been altered with unknown \r\n      nodes or attributes, handle them with the \r\n      UnknownNode and UnknownAttribute events.*/\r\n      serializer.UnknownNode+= new \r\n      XmlNodeEventHandler(serializer_UnknownNode);\r\n      serializer.UnknownAttribute+= new \r\n      XmlAttributeEventHandler(serializer_UnknownAttribute);\r\n   \r\n      // A FileStream is needed to read the XML document.\r\n      FileStream fs = new FileStream(filename, FileMode.Open);\r\n      // Declare an object variable of the type to be deserialized.\r\n      PurchaseOrder po;\r\n      /* Use the Deserialize method to restore the object's state with\r\n      data from the XML document. */\r\n      po = (PurchaseOrder) serializer.Deserialize(fs);\r\n      // Read the order date.\r\n      Console.WriteLine (\"OrderDate: \" + po.OrderDate);\r\n  \r\n      // Read the shipping address.\r\n      Address shipTo = po.ShipTo;\r\n      ReadAddress(shipTo, \"Ship To:\");\r\n      // Read the list of ordered items.\r\n      OrderedItem [] items = po.OrderedItems;\r\n      Console.WriteLine(\"Items to be shipped:\");\r\n      foreach(OrderedItem oi in items)\r\n      {\r\n         Console.WriteLine(\"\\t\"+\r\n         oi.ItemName + \"\\t\" + \r\n         oi.Description + \"\\t\" +\r\n         oi.UnitPrice + \"\\t\" +\r\n         oi.Quantity + \"\\t\" +\r\n         oi.LineTotal);\r\n      }\r\n      // Read the subtotal, shipping cost, and total cost.\r\n      Console.WriteLine(\"\\t\\t\\t\\t\\t Subtotal\\t\" + po.SubTotal);\r\n      Console.WriteLine(\"\\t\\t\\t\\t\\t Shipping\\t\" + po.ShipCost); \r\n      Console.WriteLine(\"\\t\\t\\t\\t\\t Total\\t\\t\" + po.TotalCost);\r\n   }\r\n \r\n   protected void ReadAddress(Address a, string label)\r\n   {\r\n      // Read the fields of the Address object.\r\n      Console.WriteLine(label);\r\n      Console.WriteLine(\"\\t\"+ a.Name );\r\n      Console.WriteLine(\"\\t\" + a.Line1);\r\n      Console.WriteLine(\"\\t\" + a.City);\r\n      Console.WriteLine(\"\\t\" + a.State);\r\n      Console.WriteLine(\"\\t\" + a.Zip );\r\n      Console.WriteLine();\r\n   }\r\n\r\n   protected void serializer_UnknownNode\r\n   (object sender, XmlNodeEventArgs e)\r\n   {\r\n      Console.WriteLine(\"Unknown Node:\" +   e.Name + \"\\t\" + e.Text);\r\n   }\r\n\r\n   protected void serializer_UnknownAttribute\r\n   (object sender, XmlAttributeEventArgs e)\r\n   {\r\n      System.Xml.XmlAttribute attr = e.Attr;\r\n      Console.WriteLine(\"Unknown attribute \" + \r\n      attr.Name + \"='\" + attr.Value + \"'\");\r\n   }\r\n}\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["XmlSerializer","Xml Serialization","Serialization Deserialization"]},{"RecordId":"719","Title":"Delegates","Description":"Demonstration of how delegate methods work","Code":"//----------------------------------------------------\r\n// The class that declares the delegate\r\n//----------------------------------------------------\r\npublic class DelegateDemo\r\n{\r\n\r\n\tpublic DelegateDemo() {} // Constructor\r\n\r\n\tpublic delegate void Print ( String s ); // Declare the delegate\r\n\t\r\n}\r\n\r\n\r\n\r\n//----------------------------------------------------\r\n// A class that declares a method that will be delegated to\r\n//----------------------------------------------------\r\npublic class DelegateUser1\r\n{\r\n\r\n\tpublic DelegateUser1() {} // Constructor\r\n\r\n\tpublic void toConsole ( String s )\r\n\t{\r\n\t\tSystem.Console.WriteLine(s);\r\n\t}\r\n\r\n}\r\n\r\n\r\n\r\n//----------------------------------------------------\r\n// A second class that declares a method that will be delegated to\r\n//----------------------------------------------------\r\npublic class DelegateUser2\r\n{\r\n\r\n\tpublic DelegateUser2() {} // Constructor\r\n\r\n\tpublic void toFile ( String s )\r\n\t{\r\n\t\tStreamWriter sw = File.CreateText ( \"MyFile.txt\" );\r\n\t\tsw.WriteLine ( s );\r\n\t\tsw.Flush();\r\n\t\tsw.Close();\r\n\t}\r\n\r\n}\r\n\r\n\r\n//----------------------------------------------------\r\n// This creates the delegate objects and calls the methods\r\n//----------------------------------------------------\r\nprivate void cmdDelegateDemo_Click(object sender, System.EventArgs e)\r\n{\r\n\r\n\tDelegateDemo.Print pConsole = new DelegateDemo.Print( new DelegateUser1().toConsole );\r\n\tDelegateDemo.Print pFile = new DelegateDemo.Print( new DelegateUser2().toFile );\r\n\tDelegateFoo( pConsole );\r\n\tDelegateFoo( pFile );\r\n}\r\n\r\n//----------------------------------------------------\r\n// This is the method that will polymorphically call the correct underlying method\r\n//----------------------------------------------------\r\nprivate void DelegateFoo( DelegateDemo.Print pMethod )\r\n{\r\n\tpMethod(\"Which way did it go?\");\r\n}\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Delegates"]},{"RecordId":"720","Title":"C# Documentation: A Simple Way to Include Examples","Description":"Demonstrates how to use Include files with NDoc to provide code samples","Code":"How do you handle the inclusion of examples into your C# documentation? If you've been asking yourself this question, here's a quick tip for automatic example inclusion.\r\n\r\nLet's start with an example. Consider the following dummy class MyClass:\r\n\r\npublic class MyClass\r\n{\r\n ...\r\n}\r\nWe hapilly write anexample for the MyClass class in a separate xml file (say Doc.xml):\r\n\r\n<doc>\r\n  <examples>\r\n    <example name=\"example1\">\r\n       public class MyLibrary\r\n       {\r\n           public static Main(string[] args)\r\n           {\r\n               MyClass mc = new MyClass();\r\n           }\r\n       }\r\n    </example>\r\n  </examples>\r\n</doc>\r\n\r\nNow the way Visual Studio suggests uses to include the example is to use the include tag with a XPath expression similar to this:\r\n\r\n//< include file='Doc.xml' path='example[@name=\"example1\"]' />\r\nThis is fine but it can break easily.Moreover, assuming that you have a lots of examples, you may miss some example that could be integrated into the documentation.\r\n\r\nA much better solution is to use the power of XPath. In fact, what we want to include is all the examples that involve the MyClass class, which in XPath translates to: contains(descendant-or-self::*,'MyClass'):\r\n\r\n/// <include \r\n///     file='MyLibrary.Doc.xml' \r\n///     path='//example[contains(descendant-or-self::*,\"MyClass\")]'\r\n/// />\r\n\r\nThat's it. Instead of using name=... you stop worrying and let XPath find the proper examples for you.","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["XML Comments","C# Documentation","NDoc"]},{"RecordId":"721","Title":"Garbage Collection - Dispose - Class Destructors","Description":"Demonstrates how and when to implement class destructors and Dispose().","Code":"When all references are lost on an object, the object becomes a candidate for garbage collection.  The garbage collector will call the object's destructor (~yourDestructor).  If you provide a Dispose method for your class, it should call the following code:\r\n\tFinalize(); \r\n\tSystem.GC.SuppressFinalize(this); \r\nIn the above code, the Finalize() calls the class destructor.  The System.GC.SuppressFinalize(this) tells the garbage collector that this object has already been garbage collected, so the framework will not call the class destructor. \r\n\r\nHere are two classes that allocate resources, the first class needs to implement a custom destructor and standard Dispose, but the second class doesn't need either. \r\n\r\nThe difference is that the first class allocates resources in the constructor and doesn't clean them up immediately. In contrast, the second class allocates resources in a member function and carefully frees them before exiting (using a finally block), so the second class author doesn't need to bother writing Dispose and a destructor. \r\n\r\nclass MustDispose : IDisposable\r\n{ \r\n  public MustDispose() \r\n  { \r\n    create a 3rd party object \r\n    open a file handle \r\n    allocate some memory \r\n    open a database connection \r\n    open a network port \r\n  } \r\n\r\n  ~MustDispose() \r\n  { \r\n    // customized destructor for this class \r\n    if (3rd party object != null) free the 3rd party object \r\n    if (file handle != null) close the file handle \r\n    if (memory != null) free the memory \r\n    if (connection != null) close the database connection \r\n    if (port open) close the network port \r\n  } \r\n\r\n  public void Dispose() \r\n  { \r\n    // Because this class needs a destructor, it also needs this idiomatic Dispose method \r\n    Finalize(); \r\n    System.GC.SuppressFinalize(this); \r\n  } \r\n} \r\n\r\nclass NoDispose \r\n{ \r\n  public NoDispose() \r\n  { \r\n    // This class has an uninteresting constructor so it doesn't need a destructor or Dispose \r\n  } \r\n\r\n  MemberFuncThatCleansUp() \r\n  { \r\n    try \r\n    { \r\n      create a 3rd party object \r\n      open a file handle \r\n      allocate some memory \r\n      open a database connection \r\n      open a network port \r\n    } \r\n    finally \r\n    { \r\n      if (3rd party object != null) free the 3rd party object \r\n      if (file handle != null) close the file handle \r\n      if (memory != null) free the memory \r\n      if (connection != null) close the database connection \r\n      if (port open) close the network port \r\n    } \r\n  } \r\n}  \r\n\r\nIf a class needs a destructor, you should customize how it is written. However, the Dispose method has become an idiom in C# for any class that needs a destructor.  The Dispose method should look like this: \r\n\r\npublic void Dispose() \r\n{ \r\n  Finalize(); \r\n  System.GC.SuppressFinalize(this); \r\n} \r\n\r\n\r\nWhen to Call Dispose \r\n\r\nCall Dispose on an object you create if the class author provides a Dispose method.  Call Dispose as soon as you are done using an object, especially if the object will remain in scope during a lengthy operation or if the object allocates significant resources of its own. \r\n\r\nIf the object you create doesn't itself allocate significant resources (but how do you know that?) then it might not be a problem to simply let the object go out of scope and have C# call its destructor automatically. \r\n\r\nFinally, here's a C# tip to actually avoid calling Dispose: \r\n\r\nobject obj = new MustDispose; \r\ntry \r\n{ \r\n  // use the object \r\n} \r\nfinally \r\n{ \r\n  if ((obj != null) && (obj is IDisposable))\r\n    ((IDisposable)obj).Dispose(); \r\n} \r\n\r\nYou can shorten this up and just write this instead: \r\n\r\nusing (MustDispose obj = new MustDispose) \r\n{ \r\n  // use the object \r\n} \r\n\r\nThis assumes that exceptions will be caught at a higher level, which is usually recommended. In other words, don't catch just to throw.","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Dispose","Class Destructor","Garbage Collection"]},{"RecordId":"722","Title":"Object Creation Using Factory Pattern (Example 2)","Description":"Good simple example of how to use a factory pattern when creating objects","Code":"// -------------------------------------\r\n// The factory\r\n// -------------------------------------\r\nusing System;\r\nclass Factory\r\n{\r\n   public Base GetObject(int type)\r\n   {\r\n   Base base1 = null;\r\n      switch(type)\r\n      {\r\n         case 1:\r\n            base1 = new Derived1();\r\n            break;\r\n         case 2:\r\n            base1 = new Derived2();\r\n            break;\r\n      }\r\n      return base1;\r\n   }\r\n}\r\n\r\n\r\n// -------------------------------------\r\n// The interface\r\n// -------------------------------------\r\ninterface Base\r\n{\r\n   void DoIt();\r\n}\r\n\r\n\r\n// -------------------------------------\r\n// Implementation class 1\r\n// -------------------------------------\r\nclass Derived1 : Base\r\n{\r\n   public void DoIt()\r\n   {\r\n      Console.WriteLine(\"Derived 1 method\");\r\n   }\r\n}\r\n\r\n\r\n// -------------------------------------\r\n// Implementation class 2\r\n// -------------------------------------\r\nclass Derived2 : Base\r\n{\r\n   public void DoIt()\r\n   {\r\n      Console.WriteLine(\"Derived 2 method\");\r\n   }\r\n}\r\n\r\n\r\n// -------------------------------------\r\n// Client\r\n// Client class neednt know about instance creation. The creation of Product is deferred to the Factory class\r\n// -------------------------------------\r\nclass MyClient\r\n{          \r\n   public static void Main()\r\n   {\r\n      Factory factory = new Factory();\r\n      Base obj = factory.GetObject(2);\r\n      obj.DoIt();\r\n   }\r\n}","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Interface Programming","Factory Pattern"]},{"RecordId":"723","Title":"Creating Non-Rectangular Windows with .NET","Description":"Creating Non-Rectangular Windows with .NET","Code":"Creating Non-Rectangular Windows with .NET\r\n\r\nIf you're tired of the same old rectangular boring user interfaces in your Windows programs and prefer the funky shapes of applications such as Windows Media Player 9, follow this step-by-step guide to take your applications where they have never been before. \r\nby Laurence Moroney  \r\n\r\nOne problem with creating GUIs with Microsoft Visual Studio.NET is that they all tend to look the same. It takes extra work and innovation to make your user interface stand out from the crowd, but one way to make your application distinctive is to create a non-standard shaped UI such as that used in Windows Media Player 9 (see Figure 1). You may not have realized thatthanks to the .NET frameworkcreating a non-rectangular UI like this is easier than it has ever been, and is well within the reach of every developer. There's no longer any need to override Windows subclasses to add your own drawing routines! The framework does it for you. In this article you'll find out how to create non-rectangular UIs, and build your own retro-style wooden application in the process.\r\n\r\nThe user interface of Windows Media Player 9 begins with a basic non-rectangular form, and then adds both non-traditional buttons and traditional controls, such as the TreeView on the left, and the ListBox containing the songs on the right. These are traditional, rectangular controls, placed on the form, and colored to blend in.\r\n\r\nIn this article, and in the downloadable code, you will create a basic HTML viewer similar to Windows Media Player (though not nearly as pretty, blame my artistic skills), with a non rectangular form that contains both traditional controls and some cool circular buttons.\r\n  \r\nYou may wonder: How do you drag the form around the screen, if you can't see its title bar? Well, you'll learn how to do that too.\r\n\r\n \r\nGetting Started\r\nTo create a non-rectangular form, you need to create a mask that defines the outline shape of the form. You can use any image editing application to create the mask. I used the GIMP (GNU Image Manipulation Program), which is a superb open source image processing application. Figure 2 shows the mask used in the sample application. You can use this one, or create your own.\r\n\r\nIt's important to realize that the mask picture itself is rectangular in shape. The mask image for this form, for example, is a rectangle with a white background; the parts of the background that are white now will become transparent later, when Windows draws the form, giving the impression that the form based on this picture is non rectangular.\r\n\r\nAvoid using compressed images, such as JPEGs for the mask, because the compression leaves small artifacts in the background, whichwhen you try to make it transparenttend to show up in a very ugly way. Figure 3 shows an example; you can see the jagged corners and edges caused by the compression, because those pixels are no longer 'pure' white, which is the color that the application was programmed to treat as transparent. You'll see more on that in the next section.\r\n\r\n\r\nMasking the Form\r\nAfter completing the mask image, you need to create your windows application. You'll \"skin\" the application's main window with the mask.\r\n\r\nLaunch Visual Studio.NET and create a new Windows Application project. Visual Studio creates a standard, simple, one-form, application with a rectangular form called Form1.\r\n\r\nYou're going to jazz that form up a bit. First, you have to remove the borders of the form, so set the formBorderStyle property to None. That will get rid of the form outline and the sizing handles. In this case you don't want your users to resize your form.\r\n\r\nNext, you set the BackgroundImage property to the path to your mask file. You may need to resize your form to fit the mask. Note that setting the BackgroundImage property makes your image act as wallpaper on the formthe background image repeats as a pattern if the form is wider or taller than the image (see Figure 4).\r\n\r\nResize your form so that you see a single instance of your mask, eliminating any repeating patterns.\r\n\r\nNext, you need to tell the form that you want the white part to be transparent, so that you can see through it when running the application. You do this by setting the TransparencyKey property to white.\r\n\r\nIf you run your application now, you'll see a beautiful, non rectangular wooden-looking form on the screen. But wait a minute! Because there's no Windows title bar at the top, you can't click 'x' to close it, and you can't move it around. It's just stuck there. Fortunately, you can close it with ALT-F4. In the next section you'll see how to add dragging functionality as well as self-closing capability.\r\n\r\n\r\nAdding Event Handlers\r\nWith Windows Forms, you get a lot of goodies for free, such as form closing, resizing, and dragging handling; but you lose those when using a borderless form (frmBorderstyle=None), so you have to implement your own.\r\n\r\nTo Add a Close handler to the form:\r\n\r\nDrag a button control onto the form. Call it btnClose, and assign its Text the string \"X\". \r\nDouble click this button to add a click event handler. In Visual Studio.NET, double clicking a control in design mode adds an event handler for the control's default event. If you want to add any other events, you use the events dialog. You'll see how to do this a little later. \r\nYou should now be in the code editor for the btn_Close() event. Change the event so that it looks like the following: \r\n\r\n   private void btnClose_Click(object sender, System.EventArgs e)\r\n   {\r\n       this.Close();\r\n   }\r\n\r\nYour form will now close when a user clicks the 'X' button. You can put this button anywhere on the form; you're not limited to the top right hand corner location that you get by default with a traditional form. You could replace the button with a custom Close icon that would work the same way to close the form. If you refer back to Figure 1, you'll see that that's how Windows Media Player does it, too.\r\n\r\nTo Add a Drag Handler to the form:\r\n\r\nFirst, declare a variable of type Point to track the offset of the mouse as you drag it around to move the form. You'll see how this is used in a moment, but for now, place the following code in the declarations section of your form. You can place it just below the declaration of the button at the top of the form declaration. \r\n\r\n   private Point ptOffset;\r\n\r\nNext, add a PictureBox control that will intercept the mouse events for mousedown and mousemove so that you can perform the dragging operation. Place the PictureBox over the location that you want to have 'sensitive' to dragging. Many shapeless applications use a specific part of the form (often called a \"thumb\") for dragging the form around. Assign the BackColor property PictureBox a color other than white (so it won't be transparent). Your form should now look something like Figure 5, where for clarity I colored it dark blue. \r\n   \r\nAdd MouseDown and MouseMove event handlers to the form. In C#, you do this by clicking on the events icon on the property editor. This icon looks like a bold of lightning. To add the event handler, find the event name and double click it. This adds the event declaration and handler to your code. Note that if you are doing this in VB.NET, the designer is a little differentyou select the PictureBox control from the dropdown list at the top of the code window, and then select the appropriate events from the dropdown list at the top right of the code window.  Edit the MouseDown event handler code so it looks like the following: \r\n   \r\n   private void pictureBox1_MouseDown( \r\n      object sender, \r\n      System.Windows.Forms.MouseEventArgs e)\r\n   {\r\n     ptOffset = new Point(-e.X - pictureBox1.Left, \r\n       -e.Y - pictureBox1.Top);\r\n   }\r\n\r\nThe preceding handler keeps track of the location where the user first depresses the mouse button. That becomes your point of reference when dragging. Note that ptOffset is set relative to the position of the picture box. The MouseEventArgs argument provides X and Y properties that give you the position of the mouse relative to the top left corner of the formso you translate the mouse location by the PictureBox coordinates to get a point relative to the picture box. \r\nNext you need to edit the MouseMove event handler so that it moves the form around when you drag the mouse, as shown below. \r\n\r\n   private void pictureBox1_MouseMove(\r\n   object sender, System.Windows.Forms.MouseEventArgs e)\r\n   {\r\n       if( e.Button==MouseButtons.Left)\r\n       {\r\n         Point mousePos = Control.MousePosition;\r\n         mousePos.Offset(ptOffset.X, ptOffset.Y);\r\n         this.Location = mousePos;\r\n       }\r\n   }\r\n\r\nThe code first checks to see if the left mouse button is pressed, and if so, calculates the current position of the mouse relative to the one when the mouse was first pushed down (stored in ptOffset) using the Point class's Offset method. Doing that determines where the new location of the form should be. Finally, the code relocates the form to that position. \r\n\r\nYou can now drag the form around, by clicking anywhere in the PictureBox area (the drag \"hotpoint\") and then dragging. The PictureBox may look ugly now, butit's a PictureBox; therefore, you can change the background picture to blend in with the background of the form. For example, you could use the same wooden background, but add some thumb lines and/or change the mouse cursor to indicate that it's a hotspot. Experiment, and have fun! \r\n\r\nYou can continue to add controls to the form, and color the controls so that they match the skin of the form appropriately. The download demonstrates some of this for you.","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Non-Rectangular Windows","Custom Shaped Forms"]},{"RecordId":"724","Title":"Hi Performance Timer","Description":"Hi performance timer","Code":"Introduction\r\n\r\nIn some applications exact time measurement methods are very important. The often used Windows API method GetTickCount() retrieves the number of milliseconds that have elapsed since the system was started, but the GetTickCount() function only archieve resolutions of 1ms and on the other side they are very imprecise. \r\n\r\nSo, for exact time measurement we should find another method.\r\n\r\nHigh resolution timing is supported in Win32 by the QueryPerformanceCounter() and QueryPerformanceFrequency() API methods. This timer functions has much better resolution than the \"standard\" millisecond-based timer calls, like the GetTickCount() method. On the other side there is also a little bit overhead when calling this \"unmanaged\" API methods from C#, but it's better than using the very imprecise GetTickCount() API function. \r\n\r\nThe first call, QueryPerformanceCounter(), queries the actual value of the high-resolution performance counter at any point. The second function, QueryPerformanceFrequency(), will return the number of counts per second that the high-resolution counter performs. To retrieve the elapsed time of a code section you have to get the actual value of the high-resolution performance counter immediately before and immediately after the section of code to be timed. The difference of these values would indicate the counts that elapsed while the code executed. \r\n\r\nThe elapsed time can be computed then, by dividing this difference by the number of counts per second that the high-resolution counter performs (the frequency of the high-resolution timer). \r\n\r\nduration = (stop - start) / frequency\r\n\r\nFor more information about QueryPerformanceCounter and QueryPerformanceFrequency read the documentation on MSDN. \r\n\r\n\r\nThe Timer Class\r\n\r\nThe following class implements the functionality of the QueryPerformanceCounter() and QueryPerformanceFrequency() API methods. \r\n\r\n\r\nusing System;\r\nusing System.Runtime.InteropServices;\r\nusing System.ComponentModel;\r\nusing System.Threading;\r\n\r\nnamespace Win32\r\n{\r\n    internal class HiPerfTimer\r\n    {\r\n        [DllImport(\"Kernel32.dll\")]\r\n        private static extern bool QueryPerformanceCounter(\r\n            out long lpPerformanceCount);\r\n\r\n        [DllImport(\"Kernel32.dll\")]\r\n        private static extern bool QueryPerformanceFrequency(\r\n            out long lpFrequency);\r\n\r\n        private long startTime, stopTime;\r\n        private long freq;\r\n\r\n        // Constructor\r\n        public HiPerfTimer()\r\n        {\r\n            startTime = 0;\r\n            stopTime  = 0;\r\n\r\n            if (QueryPerformanceFrequency(out freq) == false)\r\n            {\r\n                // high-performance counter not supported\r\n                throw new Win32Exception();\r\n            }\r\n        }\r\n\r\n        // Start the timer\r\n        public void Start()\r\n        {\r\n            // lets do the waiting threads there work\r\n            Thread.Sleep(0);\r\n\r\n            QueryPerformanceCounter(out startTime);\r\n        }\r\n\r\n        // Stop the timer\r\n        public void Stop()\r\n        {\r\n            QueryPerformanceCounter(out stopTime);\r\n        }\r\n\r\n        // Returns the duration of the timer (in seconds)\r\n        public double Duration\r\n        {\r\n            get\r\n            {\r\n                return (double)(stopTime - startTime) / (double) freq;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nThis class is very simple to use. Just create an instance of HiPerfTimer, call Start() to start timing and call Stop() to stop timing. To retrieve the elapsed time, just call the Duration() function and you will get the elapsed time. \r\n\r\n\r\nSample Usage\r\n\r\nHiPerfTimer pt = new HiPerfTimer();     // create a new PerfTimer object\r\npt.Start();                             // start the timer\r\nConsole.WriteLine(\"Test\\n\");            // the code to be timed\r\npt.Stop();                              // stop the timer\r\nConsole.WriteLine(\"Duration: {0} sec\\n\", pt.Duration); // print the duration of the timed code\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Timer","Hi Performance Timer"]},{"RecordId":"725","Title":"How to Make a Setup Program Automatically Un-Install Itself","Description":"Demonstrates how to cause a Setup program to automatically uninstall itself.","Code":"Project Properties and Settings\r\n\r\nDetectNewerInstalledVersion\tFalse\r\nRemovePreviousVersions\tTrue\r\nProductCode \t\tRegenerate each build\r\nUpgradeCode\t\tSet on first build and do not change","Declares":"","CodeCategory":{"CategoryId":"26","CategoryDescription":".Net - Visual Studio IDE"},"Keywords":["Setup","UnInstall"]},{"RecordId":"726","Title":"Generate Native and Synthetic Guids in SQL Server","Description":"Demonstrates how to generate native and custom GUIDs with TSQL.","Code":"Guids are cool, but they don't perform as efficiently as primary keys in SQL Server because of their randomness.  \r\n\r\nThe following code demonstrates how to generate custom guids that are more closely grouped so that they can be stored and retrieved more efficiently in SQL Server.\r\n\r\nIn the following example, @GuidReal is a true SQL guid, and @GuidCustom is the custom guid.  Both variables are true SQL UNIQUEIDENTIFIER data types, but the manner in which @GuidCustom is generated causes the rightmost group of bytes to be consistent, based on the current date/time.\r\n\r\n\r\nDECLARE @GuidCustom UNIQUEIDENTIFIER\r\nDECLARE @GuidReal UNIQUEIDENTIFIER\r\nDECLARE @i int\r\n\r\nSET @i = 0\r\n\r\nWHILE @i < 10 BEGIN\r\n\tSET @i = @i + 1\r\n\tSET @GuidCustom = CAST(CAST(NEWID() AS BINARY(10)) + CAST(GETDATE() AS BINARY(6)) AS UNIQUEIDENTIFIER)\r\n\tSET @GuidReal = NEWID()\r\n\tprint CAST(@GuidCustom AS VARCHAR(36)) + ' - ' + CAST(@GuidReal AS VARCHAR(36))\r\n\r\nEND\r\n\r\n\r\nOutput\r\n---------------------------------------------------------------------      ---------------------------------------------------------------------\r\n0E8D8B4C-A158-48CF-B914-954100DB3CF9 - 66FD0C16-AB8A-4BDA-BD3B-4C5504D639D3\r\n8BFAEFB0-848B-4801-A993-954100DB3CF9 - 72C2144D-08FD-429B-9EE5-C9EB1B6151A0\r\nAE8B38AE-C0AA-4B55-9C97-954100DB3CF9 - A9B4F4B0-E5E5-40EF-8DFC-E0258566773F\r\n005CBA0F-81CB-4B7E-9EB2-954100DB3CF9 - 8200AB7F-F252-4FDF-9988-B7BE914C8CD7\r\n8ECDF4DD-3EE1-41A1-A69F-954100DB3CF9 - 2E268FC5-13D8-40F7-AF41-EFB8E39C3152\r\n7352FE19-27D2-4457-8E77-954100DB3CF9 - CF1FC046-9655-42D1-8E39-DE0C15AF6026\r\n7CD71872-17AF-4707-99D5-954100DB3CF9 - 66AC1280-C3FA-4BD2-998A-7AC5167BD94C\r\n9A1DD23D-C560-4A91-AF4E-954100DB3CF9 - E360EF49-43EB-4A9B-A01C-FBB5EBFC5675\r\n23417A4C-081C-4D4C-9472-954100DB3CF9 - F219264B-1812-4368-8CAB-11442C484D6B\r\n3672D5B4-0F30-4944-A096-954100DB3CF9 - ADB7B981-DD57-4BC1-AECA-8FB1DF68F358\r\n","Declares":"","CodeCategory":{"CategoryId":"6","CategoryDescription":"T-SQL"},"Keywords":["GUID"]},{"RecordId":"727","Title":"Client-Side XML/XSL Transformation","Description":"Demonstrates how to load an XML and an XSL file and transform them client-side.","Code":"<html>\r\n   <body>\r\n   \r\n      <script type=\"text/javascript\">\r\n      \r\n         // Load XML \r\n         var xml = new ActiveXObject(\"Microsoft.XMLDOM\")\r\n         xml.async = false\r\n         xml.load(\"cdcatalog.xml\")\r\n         \r\n         // Load XSL\r\n         var xsl = new ActiveXObject(\"Microsoft.XMLDOM\")\r\n         xsl.async = false\r\n         xsl.load(\"cdcatalog.xsl\")\r\n         \r\n         // Transform\r\n         document.write(xml.transformNode(xsl))\r\n      \r\n      </script>\r\n   \r\n   </body>\r\n</html>","Declares":"","CodeCategory":{"CategoryId":"8","CategoryDescription":"XML"},"Keywords":["Client-side XML/XSL Transform","Transform"]},{"RecordId":"728","Title":"Setting Last Modified Date on Blob Stream","Description":"How to set the Last Modified date on an blob stream sent via ASP.Net Response object","Code":"To set the last modified date of an ASP.Net crawl page, we write a blob to the ASP .Net Response object and call Response.AppendHeader(\"Last-Modified\", DateTime.Now.ToString( \"r\") ) in order to set the HTTP Last Modified Date.\r\n\r\nThat does not work. Instead, you should use the Response.Cache.SetLastModifiedDate( DateTime.Now ) method.\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"20","CategoryDescription":".Net - ASP.Net"},"Keywords":["Last Modified Date"]},{"RecordId":"729","Title":"Load Assembly and Retrieve Version Number","Description":"Demonstrates how to dynamically load an assembly and retrieve it's version number.","Code":"using System.Reflection;\r\n\r\nAssembly assbly = Assembly.LoadFile(@\"C:\\Program Files\\RACKILM\\ILMWorkspace.exe\");\r\nMessageBox.Show(assbly .GetName().Version.ToString());\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Dynamically load assembly","Retrieve version"]},{"RecordId":"730","Title":"Visual Studio Start Page Project List","Description":"How to modify the Visual Studio Start Page project list","Code":"Stored in the registry here:\r\nHKEY_CURRENT_USER\\Software\\Microsoft\\VisualStudio\\7.1\\ProjectMRUList\r\n\r\nKeys are named in Filexxx (File1, File2, etc) format.  Always modify the keys in a manner that leaves no gaps.  If you delete a \"middle\" entry, decrement the remaining entries by 1 by renaming each key entry. \r\n\r\nNOTE:  No instance of .NET studio can be running, as it updates this part of the registry upon closing, using a cached copy of this registry area created during its startup, so you would lose any direct registry changes you made.\r\n","Declares":"","CodeCategory":{"CategoryId":"26","CategoryDescription":".Net - Visual Studio IDE"},"Keywords":["Start Page","Project List"]},{"RecordId":"731","Title":"Parse a Delimited String","Description":"T-SQL code to parse a delimited string and build a temp table.  This simulates splitting the string into an array.","Code":"set nocount on\r\n\r\n-- The string to be parsed\r\nDECLARE @strStringToParse VARCHAR(4000)\r\nSET @strStringToParse = 'abc,x,def,yyyyz,,,s'\r\n\r\n-- The delimiter\r\nDECLARE @strDelimiter VARCHAR(1)\r\nSET @strDelimiter = ','\r\n\r\n-- Internal variables\r\nDECLARE @intCurrentIndex INT\r\nDECLARE @intEndPosition INT\r\nDECLARE @intCount INT\r\nDECLARE @strTempValue VARCHAR(100)\r\n\r\n-- @tblOut is the \"return value\"\r\nDECLARE @tblOut TABLE (\r\n\tRecordID INT,\r\n\tValue VARCHAR(100)\r\n)\r\n\r\n\r\n-- If incoming string begins with the delimiter, remove it from the beginning of the string\r\nIF LEFT(@strStringToParse, 1) = @strDelimiter \r\n\tSET @strStringToParse = RIGHT(@strStringToParse, LEN(@strStringToParse) - 1)\t\r\n\r\n-- If incoming string does not end with the delimiter, add one to the end of the string\r\nIF RIGHT (@strStringToParse, 1) != @strDelimiter \r\n\tSET @strStringToParse = @strStringToParse + @strDelimiter\r\n\r\n\r\nSET @intCount = 0\r\n\r\nWHILE (1=1)\r\nBEGIN\r\n\tSET @intEndPosition = LEN(@strStringToParse)\r\n\t\r\n\t-- Look for the next delimiter\r\n\tSET @intCurrentIndex = CHARINDEX(@strDelimiter, @strStringToParse, 1)\r\n\tIF (@intCurrentIndex IS NULL) BREAK\r\n\r\n\t-- Found a delimiter\r\n\tIF (@intCurrentIndex > 0) \r\n\tBEGIN\r\n\t\t-- Get the discrete value up to, but not including the delimiter\r\n\t\tSET @strTempValue = LEFT(@strStringToParse, @intCurrentIndex - 1)\r\n\t\tSET @intCount = @intCount + 1\r\n\r\n\t\t-- Write this token into the output table\r\n\t\tINSERT INTO @tblOut (RecordID, Value) VALUES(@intCount, @strTempValue)\r\n\r\n\t\t-- Remove this token (and its delimiter) from the front of the string and do it all again\r\n\t\tSET @strStringToParse = RIGHT(@strStringToParse, @intEndPosition - @intCurrentIndex)\r\n\tEND\r\n\r\n\t-- Did not find any more delimiters, so exit\r\n\tELSE BREAK\r\nEND\r\n\r\nSELECT * FROM @tblOut\r\n\r\nset nocount off","Declares":"","CodeCategory":{"CategoryId":"6","CategoryDescription":"T-SQL"},"Keywords":["Parse string","Split string","Delimited string parsing"]},{"RecordId":"732","Title":"Write an Excel Spreadsheet in C#","Description":"Demonstrates how to create a native Excel file and write it.","Code":"StringBuilder sb = new StringBuilder();\r\n\r\n// Open the output file\r\nStreamWriter oWTR = new StreamWriter(@\"c:\\~cd\\fileout.xls\",false,System.Text.Encoding.Default);\r\n\r\n// Build all of the goofy stuff that Excel needs\r\nsb.Append(\"<html xmlns:o=\\\"urn:schemas-microsoft-com:office:office\\\" xmlns:x=\\\"urn:schemas-microsoft-com:office:excel\\\" xmlns=\\\"http://www.w3.org/TR/REC-html40\\\">\");\r\nsb.Append( \"<html><body><head>\" );\r\nsb.Append (@\"<style>\" + \r\n\t\"<!--table {}\" + \r\n\t\"\t@page\" + \r\n\t\"\t{margin:1.0in .75in 1.0in .75in;\" + \r\n\t\"\tmso-header-margin:.5in;\" + \r\n\t\"\tmso-footer-margin:.5in;}\" + \r\n\t\"tr\" + \r\n\t\"\t{mso-height-source:auto;}\" + \r\n\t\"col\" + \r\n\t\"\t{mso-width-source:auto;}\" + \r\n\t\"br\" + \r\n\t\"\t{mso-data-placement:same-cell;}\" + \r\n\t\".style0\" + \r\n\t\"\t{mso-number-format:General;\" + \r\n\t\"\ttext-align:general;\" + \r\n\t\"\tvertical-align:bottom;\" + \r\n\t\"\twhite-space:nowrap;\" + \r\n\t\"\tmso-rotate:0;\" + \r\n\t\"\tmso-background-source:auto;\" + \r\n\t\"\tmso-pattern:auto;\" + \r\n\t\"\tcolor:windowtext;\" + \r\n\t\"\tfont-size:10.0pt;\" + \r\n\t\"\tfont-weight:400;\" + \r\n\t\"\tfont-style:normal;\" + \r\n\t\"\ttext-decoration:none;\" + \r\n\t\"\tfont-family:Arial;\" + \r\n\t\"\tmso-generic-font-family:auto;\" + \r\n\t\"\tmso-font-charset:0;\" + \r\n\t\"\tborder:none;\" + \r\n\t\"\tmso-protection:locked visible;\" + \r\n\t\"\tmso-style-name:Normal;\" + \r\n\t\"\tmso-style-id:0;}\" + \r\n\t\"td\" + \r\n\t\"\t{mso-style-parent:style0;\" + \r\n\t\"\tpadding-top:1px;\" + \r\n\t\"\tpadding-right:1px;\" + \r\n\t\"\tpadding-left:1px;\" + \r\n\t\"\tmso-ignore:padding;\" + \r\n\t\"\tcolor:windowtext;\" + \r\n\t\"\tfont-size:10.0pt;\" + \r\n\t\"\tfont-weight:400;\" + \r\n\t\"\tfont-style:normal;\" + \r\n\t\"\ttext-decoration:none;\" + \r\n\t\"\tfont-family:Arial;\" + \r\n\t\"\tmso-generic-font-family:auto;\" + \r\n\t\"\tmso-font-charset:0;\" + \r\n\t\"\tmso-number-format:General;\" + \r\n\t\"\ttext-align:general;\" + \r\n\t\"\tvertical-align:bottom;\" + \r\n\t\"\tborder:none;\" + \r\n\t\"\tmso-background-source:auto;\" + \r\n\t\"\tmso-pattern:auto;\" + \r\n\t\"\tmso-protection:locked visible;\" + \r\n\t\"\twhite-space:nowrap;\" + \r\n\t\"\tmso-rotate:0;}\" + \r\n\t\"-->\" + \r\n\t\"</style>\" );\r\n\r\nsb.Append(\" <!--[if gte mso 9]><xml>\" + \r\n\t\" <x:ExcelWorkbook>\" + \r\n\t\"  <x:ExcelWorksheets>\" + \r\n\t\"   <x:ExcelWorksheet>\" + \r\n\t\"    <x:Name>Sheet1</x:Name>\" + \r\n\t\"    <x:WorksheetOptions>\" + \r\n\t\"     <x:Selected/>\" + \r\n\t\"     <x:Panes>\" + \r\n\t\"      <x:Pane>\" + \r\n\t\"       <x:Number>3</x:Number>\" + \r\n\t\"       <x:ActiveRow>0</x:ActiveRow>\" + \r\n\t\"       <x:ActiveCol>0</x:ActiveCol>\" + \r\n\t\"      </x:Pane>\" + \r\n\t\"     </x:Panes>\" + \r\n\t\"     <x:ProtectContents>False</x:ProtectContents>\" + \r\n\t\"     <x:ProtectObjects>False</x:ProtectObjects>\" + \r\n\t\"     <x:ProtectScenarios>False</x:ProtectScenarios>\" + \r\n\t\"    </x:WorksheetOptions>\" + \r\n\t\"   </x:ExcelWorksheet>\" + \r\n\t\"   <x:ExcelWorksheet>\" + \r\n\t\"    <x:Name>Sheet2</x:Name>\" + \r\n\t\"    <x:WorksheetOptions>\" + \r\n\t\"     <x:ProtectContents>False</x:ProtectContents>\" + \r\n\t\"     <x:ProtectObjects>False</x:ProtectObjects>\" + \r\n\t\"     <x:ProtectScenarios>False</x:ProtectScenarios>\" + \r\n\t\"    </x:WorksheetOptions>\" + \r\n\t\"   </x:ExcelWorksheet>\" + \r\n\t\"   <x:ExcelWorksheet>\" + \r\n\t\"    <x:Name>Sheet3</x:Name>\" + \r\n\t\"    <x:WorksheetOptions>\" + \r\n\t\"     <x:ProtectContents>False</x:ProtectContents>\" + \r\n\t\"     <x:ProtectObjects>False</x:ProtectObjects>\" + \r\n\t\"     <x:ProtectScenarios>False</x:ProtectScenarios>\" + \r\n\t\"    </x:WorksheetOptions>\" + \r\n\t\"   </x:ExcelWorksheet>\" + \r\n\t\"  </x:ExcelWorksheets>\" + \r\n\t\"  <x:WindowHeight>13035</x:WindowHeight>\" + \r\n\t\"  <x:WindowWidth>19035</x:WindowWidth>\" + \r\n\t\"  <x:WindowTopX>0</x:WindowTopX>\" + \r\n\t\"  <x:WindowTopY>30</x:WindowTopY>\" + \r\n\t\"  <x:DoNotCalculateBeforeSave/>\" + \r\n\t\"  <x:ProtectStructure>False</x:ProtectStructure>\" + \r\n\t\"  <x:ProtectWindows>False</x:ProtectWindows>\" + \r\n\t\" </x:ExcelWorkbook>\" + \r\n\t\"</xml><![endif]-->\" );\r\nsb.Append( \"</head><body>\" );\r\n\r\n// The main data starts here\r\nsb.Append( \"<table x:str border=0 cellpadding=0 cellspacing=0 width=320 style='border-collapse: collapse;table-layout:fixed;width:240pt'>\");\r\n\r\nfor (int i = 0; i < 5; i++ )\r\n{\r\n\r\n\t// Start a row\r\n\tsb.Append(\"<tr height=17 style='height:12.75pt'>\");\r\n\tfor (int j = 0; j < 5; j++ )\r\n\t{\r\n\t\t// Write the cells\r\n\t\tsb.Append(\"<td>\" + \"Row \" + i.ToString() + \" Col \" + j.ToString() + \"</td>\");\r\n\t}\r\n\tsb.Append(\"</tr>\");\r\n}\r\n\r\n// Close the tags\r\nsb.Append(\"</table></body></html>\");\r\n\r\n// Write it to the file system\r\noWTR.Write(sb.ToString());\r\n\r\n// Close the stream writer\r\noWTR.Close();\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Excel"]},{"RecordId":"733","Title":"Terminal Server Session Information","Description":"Displays users that are logged on to a server from Terminal Services","Code":"To display terminal server sessions:\r\n   quser /server:yourservername\r\n\r\nThe above displays a list of users with session info as follows:\r\n   USERNAME         SESSIONNAME   ID   STATE   IDLE TIME    LOGON TIME\r\n   someuser1             rdp-tcp#66            2    Active                   2     2/3/2005 7:58 AM\r\n   someuser2             rdp-tcp#67            3    Active                    .     2/3/2005 8:00 AM\r\n\r\nTo disconnect session 2 (from the example above):\r\n    logoff 2 /server:yourservername\r\n","Declares":"","CodeCategory":{"CategoryId":"7","CategoryDescription":"Misc"},"Keywords":["Terminal Server","Remote Desktop"]},{"RecordId":"734","Title":"Enumeration Sample","Description":"Demonstrates how to use custom strings in enumerations","Code":"//------------------------------------------------------------------\r\n//\tSample code that demonstrates how to use the enumeration class\r\n//------------------------------------------------------------------\r\n\r\nbool myBool = false;\r\n\r\n// Convert a string to the underlying enum type\r\nEnumClass.MyTypes eMT;\r\neMT  = EnumClass.GetType ( \"Type 1\" );\r\nif (eMT == EnumClass.MyTypes.Type1) \r\n{\r\n\tmyBool = true;\r\n}\r\nelse\r\n{\r\n\tmyBool = false;\r\n}\r\n\r\n// Convert an enum type to it's custom string\r\nstring s = EnumClass.ToString( EnumClass.MyTypes.Type1 );\r\nif (s == \"Type 1\") \r\n{\r\n\tmyBool = true;\r\n}\r\nelse\r\n{\r\n\tmyBool = false;\r\n}\r\n\r\n// Prints the types from the enum class\r\nforeach (string sName in Enum.GetNames( typeof (EnumClass.MyTypes )))\r\n{\r\n\tConsole.WriteLine ( sName );\r\n}\r\n\r\n// Prints the custom strings from the enum class\r\nforeach (EnumClass.MyTypes eMTx in Enum.GetValues( typeof (EnumClass.MyTypes )))\r\n{\r\n\tConsole.WriteLine ( EnumClass.ToString(eMTx) );\r\n}\r\n\r\n// Get a list of all custom strings from the enum class\r\nstring[] sList = EnumClass.GetStringList();\r\n\r\n\r\n\r\n//------------------------------------------------------------------\r\n//\tThe enumeration class\r\n//------------------------------------------------------------------\r\n\r\nusing System;\r\n\r\nnamespace WinForms_Playground\r\n{\r\n\tpublic class EnumClass\r\n\t{\r\n\r\n\t\t// The enumeration\r\n\t\tpublic enum MyTypes\r\n\t\t{\r\n\t\t\tType1,\r\n\t\t\tType2,\r\n\t\t\tType3,\r\n\t\t\tType4,\r\n\t\t\tTypeInvalid\r\n\t\t}\r\n\r\n\t\t// Constructor\r\n\t\tpublic EnumClass()\r\n\t\t{\r\n\t\t}\r\n\r\n\t\t// Converts a \"custom\" string into the underlying enumeration value\r\n\t\tpublic static EnumClass.MyTypes GetType ( string s ) \r\n\t\t{\r\n\t\t\tif (s == \"Type 1\") return EnumClass.MyTypes.Type1;\r\n\t\t\tif (s == \"Type 2\") return EnumClass.MyTypes.Type2;\r\n\t\t\tif (s == \"Type 3\") return EnumClass.MyTypes.Type3;\r\n\t\t\tif (s == \"Type 4\") return EnumClass.MyTypes.Type4;\r\n\t\t\treturn EnumClass.MyTypes.TypeInvalid;\r\n\t\t}\r\n\r\n\t\t// Returns a string array containing the \"custom\" strings for each enumeration value\r\n\t\tpublic static string[] GetStringList ()\r\n\t\t{\r\n\t\t\tint enumLength = 0;\r\n\t\t\tforeach (MyTypes eMTx in Enum.GetValues( typeof ( MyTypes )))\r\n\t\t\t{\r\n\t\t\t\tenumLength++;\r\n\t\t\t}\r\n\r\n\t\t\tstring[] s = new string[enumLength];\r\n\t\t\tint i = 0;\r\n\t\t\tforeach (MyTypes eMTx in Enum.GetValues( typeof ( MyTypes )))\r\n\t\t\t{\r\n\t\t\t\ts[i] = EnumClass.ToString( eMTx );\r\n\t\t\t\ti++;\r\n\t\t\t}\r\n\r\n\t\t\treturn s;\r\n\t\t}\r\n\r\n\r\n\t\t// Converts an enumeration value to a \"custom\" string value\r\n\t\tpublic static string ToString(MyTypes mt)\r\n\t\t{\r\n\t\t\tstring s = \"Invalid Element\";\r\n\t\t\tswitch ( mt )\r\n\t\t\t{\r\n\t\t\t\tcase  MyTypes.Type1:\r\n\t\t\t\t\ts = \"Type 1\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase MyTypes.Type2:\r\n\t\t\t\t\ts = \"Type 2\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase MyTypes.Type3:\r\n\t\t\t\t\ts = \"Type 3\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase MyTypes.Type4:\r\n\t\t\t\t\ts = \"Type 4\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\treturn s;\r\n\t\t}\r\n\t}\r\n}\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Enumerations","Enum"]},{"RecordId":"735","Title":"Open a File in its Registered Application","Description":"Demonstrates how to open a file in its registered application.","Code":"To display a file (somefile.pdf) when the user clicks a button, use the following code:\r\n\r\nusing System.diagnostics;\r\n\r\nProcess.Start(\"c:\\temp\\myfile.pdf\");\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Open File","Registered Application"]},{"RecordId":"736","Title":"Preserve Whitespace Characters in Serializable Classes","Description":"Demonstrates how to make an object serialize it's properties as XML attributes instead of the default manner, which is with XML elements.","Code":"To make a property serialize as an attribute instead of as an element us the \"[ System.Xml.Serialization.XmlAttribute ]\" attribute on the property.  They is necessary to preserve certain whitepsace characters in XML such as carriage returns.\r\n\r\n[ System.Xml.Serialization.XmlAttribute ]\r\npublic string Comments\r\n{\r\n\tget\r\n\t{\r\n\t\treturn m_comments;\r\n\t}\r\n\tset\r\n\t{\r\n\t\tthis.m_comments = value;\r\n\t}\r\n}\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Serialization","Preserve Whitespace"]},{"RecordId":"737","Title":"Choosing .Net Collection Classes","Description":"Explains the various .Net collection classes and recommends when to use each type.","Code":"Queue and Stack\r\nIdeal in a scenario where you receive data and need to process data one element at a time, either in FIFO or LIFO order.\r\n\r\nArray\r\nThe most efficient tool for fixed-size, indexed collections.\r\n\r\nArrayList\r\nAn array-like growable alternative to fixed-size arrays.  They can store any type of object.\r\n\r\nStringCollection\r\nA better choice than ArrayList for a dynamic size array of strings because it provides a strongly typed interface.\r\n\r\nHashtable and ListDictionary\r\nGood options when key-based access is required.  You might want to choose a ListDictionary to handle small numbers of items (20 or fewer) and opt for Hashtable for greater numbers of items.\r\n\r\nHybridDictionary\r\nA wrapper class that begins as a ListDictionary and automatically switches to Hashtable when the size grows beyond the critical threshold.\r\n\r\nStringDictionary\r\nA better choice than Hashtables as long as your collection contains only strings.\r\n\r\nNameValueCollection\r\nThe slowest collection.  You should use it only if you want to provide both indexed and key-based access to your data.\r\n\r\nSortedList\r\nA hybrid of a Hashtable and an Array.  It behaves like a Hashtable when you access an element by key and mimics an Array if you use an index.  You should use this class only if you need to maintain the sorted order.","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Collections",".Net Collection Classes","Choosing Collection Classes"]},{"RecordId":"738","Title":"Scrolling Title Bar","Description":"Makes text scroll in the title bar of the browser","Code":"<html>\r\n<head>\r\n<script language=\"javascript\">\r\n<!--\r\n//Scrolling Message Across Title Bar\r\n//By: Don Santiago\r\n//Email: senor_santi@yahoo.com\r\n//To change message edit below line\r\nmsg = \"Scrolly Scrolly Scrolling Message!\";\r\n//To change message edit above lin\r\n//\r\nmsg = \"...   ...\" + msg;pos = 0;\r\nfunction scrollMSG() {\r\ndocument.title = msg.substring(pos, msg.length) + msg.substring(0, pos);\r\npos++;\r\nif (pos >  msg.length) pos = 0\r\nwindow.setTimeout(\"scrollMSG()\",200);\r\n}\r\nscrollMSG();\r\n-->\r\n</script>\r\n</head>\r\n<body>\r\n<p align=\"center\"><h2>This script demonstrates for a scrolling Title Bar</h2>\r\n</body>\r\n</html>\r\n","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["Scrolling Title Bar","Scrolling Text"]},{"RecordId":"740","Title":"Underlying Connection Was Closed Webservice Exception","Description":"Explanation of how to solve the underlying connection was closed webservice exception.\r\n\r\nSolution posted by Jan Tielens' Bloggings [MVP]","Code":"In some cases the first call to a webservice works just fine, but if in the following few minutes no new call to the webservice is made, the next call would throw the exception shown below:\r\n\r\nSystem.Net.WebException: The underlying connection was closed: An unexpected error occurred on a send.\r\nat System.Web.Services.Protocols.WebClientProtocol.GetWebResponse(WebRequest request)\r\nat System.Web.Services.Protocols.HttpWebClientProtocol.GetWebResponse(WebRequest request)\r\nat System.Web.Services.Protocols.SoapHttpClientProtocol.Invoke(String methodName, Object[] parameters)\r\nat ...\r\n\r\nThis problem could be solved by altering the generated proxy class; in the GetWebRequest function the KeepAlive property must be set to false. This can be accomplished by following these steps:\r\n\r\nAdd a Web Reference using the normal way. \r\nMake sure Show All Files menu item is enable in the Project menu. \r\nIn the Solution Explorer window, navigate to: \r\nWeb References \r\n<Name of your webservice> \r\nReference.map \r\nReference.cs (or .vb)\r\nOpen the Reference.cs file and add following code in the webservice proxy class:\r\nprotected override System.Net.WebRequest GetWebRequest(Uri uri)\r\n{\r\n System.Net.HttpWebRequest webRequest = \r\n  (System.Net.HttpWebRequest) base.GetWebRequest(uri);\r\n webRequest.KeepAlive = false;\r\n return webRequest;\r\n}\r\n\r\n\r\n--------------------------------------------------------------------------\r\n\r\nIt seems that this exception also pops up when using Web Services Enhancements (WSE), but the solution I provided doesn't work in that case. Some people posted two solutions, so all kudos goes to these people. Both solutions use Reflection to get a hold of the HttpWebRequest.\r\n\r\n--Solution 1:\r\nusing System; \r\nusing System.Net; \r\nusing System.Reflection; \r\n\r\n// Web service reference entered in wizard was \"MyWebService.MyWebServiceWse\" \r\nusing MyProject.MyWebService; \r\n\r\nnamespace MyProject \r\n{ \r\n    public class MySubClassedWebService : MyWebServiceWse { \r\n        private static PropertyInfo requestPropertyInfo = null; \r\n\r\n        public MySubClassedWebService(){} \r\n\r\n        protected override System.Net.WebRequest GetWebRequest(Uri uri) { \r\n            WebRequest request = base.GetWebRequest(uri); \r\n\r\n            if (requestPropertyInfo==null) \r\n            // Retrieve property info and store it in a static member for optimizing future use \r\n            requestPropertyInfo = request.GetType().GetProperty(\"Request\"); \r\n\r\n            // Retrieve underlying web request \r\n            HttpWebRequest webRequest = \r\n            (HttpWebRequest)requestPropertyInfo.GetValue(request,null); \r\n\r\n            // Setting KeepAlive \r\n            webRequest.KeepAlive = false; \r\n            return request; \r\n        } \r\n    } \r\n} \r\n\r\n\r\n--Solution 2:\r\nprotected override System.Net.WebRequest GetWebRequest(Uri uri) \r\n{ \r\n    PropertyInfo requestPropertyInfo = null; \r\n\r\n    WebRequest request = base.GetWebRequest(uri); \r\n\r\n    if (requestPropertyInfo==null) \r\n\r\n    requestPropertyInfo = request.GetType().GetProperty(\"Request\"); \r\n\r\n    // Retrieve underlying web request \r\n    HttpWebRequest webRequest = (HttpWebRequest)requestPropertyInfo.GetValue(request, null); \r\n\r\n    // Setting KeepAlive \r\n    webRequest.KeepAlive = false; \r\n\r\n    return request; \r\n} \r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Underlying Connection Closed","Webservice Exception"]},{"RecordId":"741","Title":"Double Hop Authenication","Description":"Explains how to set up you environment so that double-hop authentication can be accomplished between websites.","Code":"Double Hop Authentication\r\nSubmitted By: Glenda Freeman, Contemporary PLC on 5/12/2005  \r\n\r\nDescription:\r\n\r\nIf you are using custom built Web Parts to access remote resources which require user authentication and authorization, you will probably run into the \"Double Hop\" problem.   In order to access your remote resource, you may need to supply the end user's credentials to the resource so that the output from the resource is limited to the data that the end user has permission to access.  \r\n\r\nAt first glance, the solution is simple - you supply the DefaultCredentials of the user, which are passed to the remote resource.  The problem is, you can only pass a set of credentials across a single \"server hop\".  Thus, hopping from the end user to the Sharepoint Server uses up your single hop, and the credentials that are passed from the Sharepoint Server to your remote resource are in fact the ASPNET user credentials (which hopefully will not authenticate against your resource!), and not the end user's credentials at all.\r\n\r\nSo, what's the solution?  Microsoft has 2 good articles that guide you through configuring delegation, so that your server is allowed to delegate the end user's credentials across more than one hop. They are:\r\n\r\nHow to configure an ASP.NET Application for a delegation scenario:  http://support.microsoft.com/default.aspx?scid=kb;en-us;810572\r\n\r\nHow to implement Kerberos Delegation for Windows 2000:\r\nhttp://msdn.microsoft.com/library/en-us/dnnetsec/html/SecNetHT05.asp?frame=true\r\n\r\nProblem is, many painful days of \"googling\" does not yield the missing link that makes the whole delegation scenario work with Sharepoint.  Here's the missing link:\r\n\r\nHow to configure a WSS virtual server to use Kerberos authentication:\r\nhttp://support.microsoft.com/?id=832769\r\n\r\nYou're probably balking at the idea of reading even more articles that may or may not help you, so here's a really quick guide to the steps required:\r\n\r\n1. In Active Directory, all of your users' accounts must be marked as allowed to be delegated. (Open the User properties in AD > Account Tab > UN-Tick the \"Account is sensitive and cannot be delegated\" checkbox. \r\n\r\n2. In Active Directory, the Sharepoint Server must be configured as being trusted for delegation (Open the computer properties in AD > Select \"Trust Computer for delegation\"\r\n\r\n3. Check that the Sharepoint Server and the Server that holds your remote resource both have their IIS Authentication set to \"Windows Integrated Security\" ONLY. \r\n\r\n4. Make sure that the web.config file for Sharepoint (usually found in Inetpub\\wwwroot) is set to impersonate the user (<identity impersonate=\"true\" />) \r\n\r\n5. In IE, check that Integrated Windows Authentication is enabled (Tools > Internet Options > Advanced) \r\n\r\n6. Check that IIS on the Sharepoint Server is using Kerberos authentication.  Open the command window, navigate to Inetpub\\adminscripts. Run the following: cscript adsutil.vbs get w3svc/1/NTAuthenticationProviders.  If it returns \"NTLM\", it's not using Kerberos, so you need to run the following: cscript adsutil.vbs set w3svc/1/NTAuthenticationProviders \"Negotiate,NTLM\"\r\n\r\n7. Restart IIS \r\n\r\n8. Check that the Sharepoint Virtual Server's Application Pool is using an identity of NetworkService\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"20","CategoryDescription":".Net - ASP.Net"},"Keywords":["Double Hop Authentication","Delegation"]},{"RecordId":"742","Title":"Collection Class - The Simple Way","Description":"Demonstrates how to implement a collection class using CollectionBase, which makes it much simpler than having to define an iterator, etc.","Code":"//--------------------------------------------------------------------\r\n// This example consists of two classes.  The Person \r\n// class defines a single person object.  The second \r\n// class defines a collection of person objects.\r\n//--------------------------------------------------------------------\r\n\r\n\r\n//--------------------------------------------------------------------\r\n// This is the object class.  It defines one person.\r\n//--------------------------------------------------------------------\r\n\r\nusing System;\r\n\r\nnamespace BusinessServices\r\n{\r\n    public class Person\r\n    {\r\n\r\n        private string m_PersonnelNumber = \"\";\r\n        private string m_LastName = \"\";\r\n        private string m_FirstName = \"\";\r\n        private PersonCollection m_MyUsers = null;\r\n\r\n        public Person()\r\n        {\r\n        }\r\n\r\n        public string PersonnelNumber \r\n        {\r\n            get {\r\n                    return m_PersonnelNumber;\r\n                }\r\n            set {\r\n                m_PersonnelNumber = value;\r\n            }\r\n        }\r\n\r\n\r\n        public string LastName\r\n        {\r\n            get \r\n            {\r\n                return m_LastName;\r\n            }\r\n            set \r\n            {\r\n                m_LastName = value;\r\n            }\r\n        }\r\n\r\n\r\n        public string FirstName\r\n        {\r\n            get \r\n            {\r\n                return m_FirstName;\r\n            }\r\n            set \r\n            {\r\n                m_FirstName = value;\r\n            }\r\n        }\r\n\r\n        public PersonCollection MyUsers\r\n        {\r\n            get \r\n            {\r\n                return m_MyUsers;\r\n            }\r\n\r\n            set \r\n            {\r\n                m_MyUsers = value;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n\r\n//--------------------------------------------------------------------\r\n// This is the collection class.  It defines a collection of person objects.\r\n//--------------------------------------------------------------------\r\n\r\n\r\nusing System;\r\nusing System.Collections;\r\n\r\nnamespace BusinessServices\r\n{\r\n    public class PersonCollection: CollectionBase\r\n    {\r\n        public PersonCollection()\r\n        {\r\n        }\r\n\r\n        public Person this [ int index]\r\n        {\r\n            get { return (Person) this.List[index]; }\r\n            set {    this.List[index] = value; }\r\n        }\r\n\r\n        public int Add ( Person person )\r\n        {\r\n            return this.List.Add(person);\r\n        }\r\n    }\r\n}","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Collections","Collection Class"]},{"RecordId":"743","Title":"Microsoft Enterprise Library - SQL Transaction Example","Description":"Demonstrates how to accomplish transactions in the Microsoft Enterprise Library for Data Access","Code":"Database db = DatabaseFactory.CreateDatabase();\r\n\r\nDBCommandWrapper creditCommandWrapper = db.GetStoredProcCommandWrapper(\"CreditAccount\");\r\ncreditCommandWrapper.AddInParameter(\"@AccountID\", DbType.Int32, sourceAccount);\r\ncreditCommandWrapper.AddInParameter(\"@Amount\", DbType.Int32, transactionAmount);\r\n\r\nDBCommandWrapper debitCommandWrapper = db.GetStoredProcCommandWrapper(\"DebitAccount\");\r\ndebitCommandWrapper.AddInParameter(\"@AccountID\", DbType.Int32, destinationAccount);\r\ndebitCommandWrapper.AddInParameter(\"@Amount\", DbType.Int32, transactionAmount);\r\n\r\nusing (IDbConnection connection = db.GetConnection())\r\n{\r\n  connection.Open();\r\n  IDbTransaction transaction = connection.BeginTransaction();\r\n\r\n  try\r\n  {\r\n    db.ExecuteNonQuery(creditCommandWrapper, transaction);\r\n    db.ExecuteNonQuery(debitCommandWrapper, transaction);\r\n    transaction.Commit();\r\n  }\r\n  catch\r\n  {\r\n    transaction.Rollback();\r\n  }\r\n  connection.Close();\r\n}","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Transactions","Enterprise Library"]},{"RecordId":"744","Title":"Active Directory Search","Description":"Returns a dataset from an Active Directory search.  Of particular interest is the manner that the LDAP root is determined.","Code":"private DataSet SearchAD(string strNameFrag) \r\n{\r\n\r\n\t// Account/password for the AD call\r\n\tstring strServiceAccountUser = \"domain\\useraccount\";\r\n\tstring strServiceAccountPassword = \"password\";\r\n\r\n\t// Determine the LDAP string\r\n\tstring strGCDomain = \"\";\r\n\tDirectoryEntry entry = new DirectoryEntry( \"LDAP://rootDSE\" );\r\n\tstrGCDomain = \"LDAP://\" + entry.Properties[ \"defaultNamingContext\" ][ 0 ].ToString();\r\n\r\n\tstring strADQuery = \"(&(sn=\" + strNameFrag + \"*)(|(mail=*)(info=*))(ObjectClass=User)(!UserAccountControl:1.2.840.113556.1.4.804:=2))\";\r\n\t//string strADQuery = \"(&(sn=\" + strNameFrag + \"*)(ObjectClass=User)(!UserAccountControl:1.2.840.113556.1.4.804:=2))\";\r\n\r\n\tDataSet dsADSearch = new DataSet();\r\n\tdsADSearch.Tables.Add(\"PeopleSearch\");\r\n\tdsADSearch.Tables[0].Columns.Add(\"displayName\");\r\n\tdsADSearch.Tables[0].Columns.Add(\"email\");\r\n\tdsADSearch.Tables[0].Columns.Add(\"cn\");\r\n\tdsADSearch.Tables[0].Columns.Add(\"samAccountName\");\r\n\tdsADSearch.Tables[0].Columns.Add(\"AdsPath\");\r\n\tdsADSearch.Tables[0].Columns.Add(\"sn\");\r\n\tdsADSearch.Tables[0].Columns.Add(\"givenName\");\r\n\tdsADSearch.Tables[0].Columns.Add(\"employeeid\");\r\n\tdsADSearch.Tables[0].Columns.Add(\"logon_name\");\r\n\tdsADSearch.Tables[0].Columns.Add(\"NativeGuid\");\r\n\r\n\r\n//\tDirectoryEntry oDERoot = new DirectoryEntry(strGCDomain);\r\n\tDirectoryEntry oDERoot = new DirectoryEntry(strGCDomain, strServiceAccountUser, strServiceAccountPassword, AuthenticationTypes.Secure);\r\n\tDirectorySearcher oDirSrch = new DirectorySearcher(oDERoot);\r\n//\toDirSrch.PropertiesToLoad.Add(\"samAccountName\");\r\n//\toDirSrch.PropertiesToLoad.Add(\"AdsPath\");\r\n//\toDirSrch.PropertiesToLoad.Add(\"cn\");\r\n//\toDirSrch.PropertiesToLoad.Add(\"displayName\");\r\n//\toDirSrch.PropertiesToLoad.Add(\"mail\");\r\n//\toDirSrch.PropertiesToLoad.Add(\"info\");\r\n//\toDirSrch.PropertiesToLoad.Add(\"sn\");\r\n//\toDirSrch.PropertiesToLoad.Add(\"givenName\");\r\n//\toDirSrch.PropertiesToLoad.Add(\"employeeid\");\r\n//\toDirSrch.PropertiesToLoad.Add(\"logon_name\");\r\n\toDirSrch.Filter = strADQuery;\r\n\tSearchResultCollection oSrchResults = oDirSrch.FindAll();\r\n\r\n\tforeach(SearchResult sr in oSrchResults) \r\n\t{\r\n\t\tDataRow dr = dsADSearch.Tables[0].NewRow();\r\n\t\tstring _dn = \"\";\r\n\t\tstring _mail = \"\";\r\n\t\tstring _info = \"\";\r\n\t\tstring _employeeid = \"\";\r\n\r\n\t\ttry {dr[\"NativeGuid\"] = sr.GetDirectoryEntry().NativeGuid.ToString();}\r\n\t\tcatch {dr[\"NativeGuid\"] = \"\"; }\r\n\r\n\t\ttry { _dn = sr.Properties[\"displayName\"][0].ToString(); }\r\n\t\tcatch { _dn = sr.Properties[\"cn\"][0].ToString(); }\r\n\t\t\r\n\t\ttry {_mail = sr.Properties[\"mail\"][0].ToString(); }\r\n\t\tcatch { }\r\n\t\t\r\n\t\ttry {dr[\"info\"] = sr.Properties[\"info\"][0].ToString();}\r\n\t\tcatch {  }\r\n\t\t\r\n\t\ttry {dr[\"cn\"] = sr.Properties[\"cn\"][0].ToString();}\r\n\t\tcatch {}\r\n\t\t\r\n\t\ttry {dr[\"samAccountName\"] = sr.Properties[\"samAccountName\"][0].ToString();}\r\n\t\tcatch {  }\r\n\t\t\r\n\t\ttry {dr[\"AdsPath\"] = sr.Properties[\"AdsPath\"][0].ToString();}\r\n\t\tcatch {}\r\n\t\t\r\n\t\ttry {dr[\"sn\"] = sr.Properties[\"sn\"][0].ToString();}\r\n\t\tcatch {}\r\n\r\n\t\ttry {dr[\"givenName\"] = sr.Properties[\"givenName\"][0].ToString();}\r\n\t\tcatch {}\r\n\r\n\t\ttry {_employeeid = sr.Properties[\"employeeid\"][0].ToString();}\r\n\t\tcatch {_employeeid = \"\"; }\r\n\t\t\r\n\t\ttry {dr[\"logon_name\"] = sr.Properties[\"logon_name\"][0].ToString();}\r\n\t\tcatch {}\r\n\r\n\t\ttry { _mail = sr.Properties[\"mail\"][0].ToString().ToLower(); } \r\n\t\tcatch {}\r\n\r\n\t\ttry { _info = sr.Properties[\"info\"][0].ToString().ToLower(); } \r\n\t\tcatch {}\r\n\r\n\t\tif (_mail.Length < 1) \r\n\t\t{\r\n\t\t\t_mail = _info;\r\n\t\t\t_mail = _mail.Replace(\"smtp:\", \"\");\r\n\t\t\t_mail = _mail.Replace(\"expat;\", \"\");\r\n\t\t}\r\n\r\n\t\tdr[\"displayName\"] = _dn;\r\n\t\tdr[\"email\"] = _mail;\r\n\r\n\t\tif (_employeeid.Length > 8)\r\n\t\t{\r\n\t\t\tint intLength = _employeeid.Length;\r\n\t\t\t_employeeid = _employeeid.Substring ( intLength - 8 );\r\n\t\t}\r\n\t\tdr[\"employeeid\"] = _employeeid;\r\n\r\n\t\tdsADSearch.Tables[0].Rows.Add(dr);\r\n\t}\r\n\r\n\treturn dsADSearch;\r\n\t\r\n}\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Active Directory","LDAP","ADSI"]},{"RecordId":"745","Title":"Get Nested Groups that a User is a Member Of","Description":"Returns all nested groups that a user is a member of.","Code":"using System;\r\nusing System.DirectoryServices;\r\nusing System.Collections;\r\nusing System.Text;\r\n\r\nnamespace ADDemoGroups\r\n{\r\n\tpublic class GroupClass\r\n\t{\r\n\r\n\t\tpublic GroupClass()\r\n\t\t{\r\n\t\t}\r\n\r\n\t\tpublic ArrayList GetAllGroups()\r\n\t\t{\r\n\r\n\t\t\tDirectoryEntry searchRoot = null;\r\n\t\t\tstring _adsPath = \"\";\r\n\t\t\tstring adsPath = \"GC://DC=yourdomain,DC=com\";\r\n\t\t\tstring sAMAccountName = \"jtgamble\";\r\n\r\n\t\t\tstring strServiceAccount = \"domain\\account\";\r\n\t\t\tstring strServicePassword = \"password\";\r\n\r\n\t\t\tsearchRoot = new DirectoryEntry( adsPath, strServiceAccount, strServicePassword, AuthenticationTypes.Secure );\r\n\r\n\t\t\tusing (DirectorySearcher ds = new DirectorySearcher(searchRoot))\r\n\t\t\t{\r\n\t\t\t\tds.Filter = String.Format( \"(&(objectCategory=person)(sAMAccountName={0}))\", sAMAccountName );\r\n\t\t\t\t\r\n\t\t\t\tSearchResult sr = null;\r\n\t\t\t\tusing (SearchResultCollection src = ds.FindAll())\r\n\t\t\t\t{\r\n\t\t\t\t\tif (src.Count > 0)\r\n\t\t\t\t\t\tsr = src[0];\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (sr == null)\r\n\t\t\t\t\tthrow new InvalidOperationException(\"User not Found\");\r\n\r\n\t\t\t\t_adsPath = String.Format(\"LDAP://{0}\", sr.Properties[\"distinguishedName\"][0]);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tStringBuilder sb = new StringBuilder();\r\n\t\t\tArrayList arOut = new ArrayList();\r\n\r\n\t\t\t//we are building an '|' clause\r\n\t\t\tsb.Append(\"(|\");\r\n\r\n\t\t\tusing (DirectoryEntry user = new DirectoryEntry(_adsPath, strServiceAccount, strServicePassword, AuthenticationTypes.Secure))\r\n\t\t\t{\r\n\t\t\t\t//we must ask for this one first\r\n\t\t\t\tuser.RefreshCache(new string[]{\"tokenGroups\"});\r\n\r\n\t\t\t\tforeach (byte[] sid in user.Properties[\"tokenGroups\"])\r\n\t\t\t\t{\r\n\t\t\t\t\t//append each member into the filter\r\n\t\t\t\t\tsb.AppendFormat(\"(objectSid={0})\", BuildOctetString(sid));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t//end our initial filter\r\n\t\t\tsb.Append(\")\");\r\n\r\n\t\t\t//now create and pull in one search\r\n\t\t\tusing (DirectorySearcher ds = new DirectorySearcher(searchRoot, sb.ToString(), new string[]{\"distinguishedName\", \"cn\"}))\r\n\t\t\t{\r\n\t\t\t\tusing (SearchResultCollection src = ds.FindAll())\r\n\t\t\t\t{\r\n\t\t\t\t\tstring[] groups = new string[src.Count];\r\n\r\n\t\t\t\t\tfor (int i = 0; i < src.Count; i++)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t//arOut.Add( src[i].Properties[\"distinguishedName\"][0].ToString());\r\n\t\t\t\t\t\tarOut.Add( src[i].Properties[\"cn\"][0].ToString());\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn arOut;\r\n\t\t}\r\n\t\t\r\n\t\tprivate string BuildOctetString(byte[] bytes)\r\n\t\t{\r\n\t\t\tStringBuilder sb = new StringBuilder();\r\n\r\n\t\t\tfor(int i=0; i < bytes.Length; i++)\r\n\t\t\t{\r\n\t\t\t\tsb.AppendFormat(\"\\\\{0}\", bytes[i].ToString(\"X2\"));\r\n\t\t\t}\r\n\t\t\treturn sb.ToString();\r\n\t\t}\r\n\t\t\r\n\t}\r\n}\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Nested Groups","Active Directory","Token Groups"]},{"RecordId":"746","Title":"Samantha's Killer AD Class - Excellent","Description":"AD class that gets all info (including nested groups) about a user.","Code":"using System;\r\nusing System.Text;\r\nusing System.Collections;\r\nusing System.DirectoryServices;\r\nusing System.Security.Principal;\r\nusing System.IO;\r\nusing System.Web;\r\nusing DESEncryptionLibrary;\r\n\r\nnamespace Deloitte.TimeCorrection.BusinessServices\r\n{\r\n\t/// <summary>\r\n\t/// Summary description for ADUserInfo.\r\n\t/// </summary>\r\n\tpublic class ADUserInfo\t\r\n\t{\r\n\r\n\t\t#region Member variables\r\n\r\n\t\tprivate string _UserName = \"\";\r\n\t\tprivate string _UserDomain = \"\";\r\n\t\tprivate string _GroupDomain = \"\";\r\n\t\tprivate string _cn = \"\";\r\n\t\tprivate string _mail = \"\";\r\n\t\tprivate string _AdsPath = \"\";\r\n\t\tprivate string _ADGuid = \"\";\r\n\t\tprivate string _sn = \"\";\r\n\t\tprivate string _givenName = \"\";\r\n\t\tprivate string _samAccountName = \"\";\r\n\t\tprivate string _LogonAccount = \"\";\r\n\r\n\t\tprivate string sUID = \"\";\r\n\t\tprivate string sUPW = \"\";\r\n\r\n\t\t#endregion\r\n\r\n\t\t#region Private methods\r\n\r\n\t\t#region setServiceAccount\r\n\r\n\t\tprivate void setServiceAccount()\t\r\n\t\t{\r\n\t\t\tsUID = System.Configuration.ConfigurationSettings.AppSettings[\"ServiceAccount\"].ToString();\r\n\t\t\tDESEncryptionLibrary.DES oDES = new DESEncryptionLibrary.DES();\r\n\t\t\tsUPW = oDES.DecryptToString(System.Configuration.ConfigurationSettings.AppSettings[\"ServiceAccountPW\"].ToString());\r\n\t\t\toDES = null;\r\n\t\t}\r\n\r\n\t\t#endregion\r\n\r\n\t\t#region BuildOctetString\r\n\t\t\r\n\t\tprivate string BuildOctetString(byte[] bytes)\r\n\t\t{\r\n\t\t\tStringBuilder sb = new StringBuilder();\r\n\r\n\t\t\tfor(int i=0; i < bytes.Length; i++)\r\n\t\t\t{\r\n\t\t\t\tsb.AppendFormat(\"\\\\{0}\", bytes[i].ToString(\"X2\"));\r\n\t\t\t}\r\n\t\t\treturn sb.ToString();\r\n\t\t}\r\n\r\n\t\t#endregion\r\n\r\n\t\t#region BytesToHex\r\n\r\n\t\tprivate string BytesToHex(byte[] sidBytes) \r\n\t\t{\r\n\t\t\tStringBuilder strSid = new StringBuilder();\r\n\t\t\tstrSid.Append(\"S-\");\r\n\t\t\ttry \r\n\t\t\t{\r\n\t\t\t\t// Add SID revision.\r\n\t\t\t\tstrSid.Append(sidBytes[0].ToString());\r\n\t\t\t\t// Next six bytes are SID authority value.\r\n\t\t\t\tif (sidBytes[6] != 0 || sidBytes[5] != 0) \r\n\t\t\t\t{\r\n\t\t\t\t\tstring strAuth = String.Format\r\n\t\t\t\t\t\t(\"0x{0:2x}{1:2x}{2:2x}{3:2x}{4:2x}{5:2x}\",\r\n\t\t\t\t\t\t(Int16)sidBytes[1],\r\n\t\t\t\t\t\t(Int16)sidBytes[2],\r\n\t\t\t\t\t\t(Int16)sidBytes[3],\r\n\t\t\t\t\t\t(Int16)sidBytes[4],\r\n\t\t\t\t\t\t(Int16)sidBytes[5],\r\n\t\t\t\t\t\t(Int16)sidBytes[6]);\r\n\t\t\t\t\tstrSid.Append(\"-\");\r\n\t\t\t\t\tstrSid.Append(strAuth);\r\n\t\t\t\t}\r\n\t\t\t\telse \r\n\t\t\t\t{\r\n\t\t\t\t\tInt64 iVal = (Int32)(sidBytes[1]) +\r\n\t\t\t\t\t\t(Int32)(sidBytes[2] << 8) +\r\n\t\t\t\t\t\t(Int32)(sidBytes[3] << 16) +\r\n\t\t\t\t\t\t(Int32)(sidBytes[4] << 24);\r\n\t\t\t\t\tstrSid.Append(\"-\");\r\n\t\t\t\t\tstrSid.Append(iVal.ToString());\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Get sub authority count...\r\n\t\t\t\tint iSubCount = Convert.ToInt32(sidBytes[7]);\r\n\t\t\t\tint idxAuth = 0;\r\n\t\t\t\tfor (int i = 0; i < iSubCount; i++) \r\n\t\t\t\t{\r\n\t\t\t\t\tidxAuth = 8 + i * 4;\r\n\t\t\t\t\tUInt32 iSubAuth = BitConverter.ToUInt32(sidBytes, idxAuth);\r\n\t\t\t\t\tstrSid.Append(\"-\");\r\n\t\t\t\t\tstrSid.Append(iSubAuth.ToString());\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tcatch \r\n\t\t\t{\r\n\t\t\t\treturn \"woopsie\";\r\n\t\t\t}\r\n\t\t\treturn strSid.ToString().ToUpper();\r\n\t\t}\r\n\r\n\t\t#endregion\r\n\r\n\t\t#region setCurrentUserProperties\r\n\r\n\t\tprivate void setCurrentUserProperties(string strADQuery, string strUserDomain) \r\n\t\t{\r\n\t\t\ttry \r\n\t\t\t{\r\n\t\t\t\tSearchResult oCurrentUser = getMemberDetails(strADQuery, @\"GC://\" + strUserDomain);\r\n\t\t\t\tif (oCurrentUser != null) \r\n\t\t\t\t{\r\n\t\t\t\t\t_sn = \"\";\r\n\t\t\t\t\t_givenName = \"\";\r\n\t\t\t\t\t_mail = \"\";\r\n\t\t\t\t\tstring _info = \"\";\r\n\r\n\t\t\t\t\t_AdsPath = oCurrentUser.Properties[\"AdsPath\"][0].ToString();\r\n\t\t\t\t\t_cn = oCurrentUser.Properties[\"cn\"][0].ToString();\r\n\t\t\t\t\tif (_cn.Substring(0, 4) == \"app.\") \r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t_cn = oCurrentUser.Properties[\"displayName\"][0].ToString();\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttry { _sn = oCurrentUser.Properties[\"sn\"][0].ToString(); } \r\n\t\t\t\t\tcatch {}\r\n\t\t\t\t\ttry { _givenName = oCurrentUser.Properties[\"givenName\"][0].ToString(); } \r\n\t\t\t\t\tcatch {}\r\n\t\t\t\t\ttry { _mail = oCurrentUser.Properties[\"mail\"][0].ToString().ToLower(); } \r\n\t\t\t\t\tcatch {}\r\n\t\t\t\t\ttry { _info = oCurrentUser.Properties[\"info\"][0].ToString().ToLower(); } \r\n\t\t\t\t\tcatch {}\r\n\t\t\t\t\ttry \r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tByte[] oUserGuidB;\r\n\t\t\t\t\t\toUserGuidB = (Byte[]) oCurrentUser.Properties[\"objectGUID\"][0];\r\n\t\t\t\t\t\tGuid oUserGUID = new Guid(oUserGuidB);\r\n\t\t\t\t\t\t_ADGuid = oUserGUID.ToString();\r\n\t\t\t\t\t} \r\n\t\t\t\t\tcatch {}\r\n\t\t\t\t\t\r\n\r\n\t\t\t\t\tif (_mail.Length < 1) \r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t_mail = _info;\r\n\t\t\t\t\t\t_mail = _mail.Replace(\"smtp:\", \"\");\r\n\t\t\t\t\t\t_mail = _mail.Replace(\"expat;\", \"\");\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\ttry { _samAccountName = oCurrentUser.Properties[\"samAccountName\"][0].ToString().ToLower(); } \r\n\t\t\t\t\tcatch {}\r\n\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t} \r\n\t\t\tcatch { }\r\n\r\n\t\t}\r\n\r\n\t\t#endregion\r\n\r\n\t\t#region getMemberDetails\r\n\r\n\t\tprivate SearchResult getMemberDetails(string strMemberIn, string strPathIn) \r\n\t\t{\r\n\r\n\t\t\tDirectoryEntry oDERoot = new DirectoryEntry(strPathIn, sUID, sUPW, AuthenticationTypes.Secure);\r\n\t\t\tDirectorySearcher oDirSrch = new DirectorySearcher(oDERoot);\r\n\t\t\toDirSrch.Filter = strMemberIn;\r\n\t\t\tSearchResult oResult = oDirSrch.FindOne();\r\n\r\n\t\t\treturn oResult;\r\n\t\t\t\r\n\t\t}\r\n\r\n\t\t#endregion\r\n\r\n\t\t#endregion\r\n\r\n\t\t#region Contructor(s)\r\n\r\n\t\tpublic ADUserInfo() \r\n\t\t{\r\n\r\n\t\t\tsetServiceAccount();\t\t\t\r\n\t\t\t_UserName = System.Security.Principal.WindowsIdentity.GetCurrent().Name.ToLower().Replace(\"/\", @\"\\\");\r\n\t\t\t//_UserName = HttpContext.Current.User.Identity.Name.ToLower().Replace(\"/\", @\"\\\");\r\n\t\t\t_UserDomain = _UserName.Substring(0, _UserName.IndexOf(@\"\\\"));\r\n\t\t\t_UserName = _UserName.Substring(_UserName.IndexOf(@\"\\\") + 1);\r\n\t\t\t//_GroupDomain = System.Configuration.ConfigurationSettings.AppSettings[\"Group_Domain\"].ToString();\r\n\t\t\t_GroupDomain = _UserDomain;\r\n\t\t\tsetCurrentUserProperties(\"(samAccountName=\" + _UserName + \")\", _UserDomain);\r\n\t\t\t_LogonAccount = _UserDomain.ToUpper() + @\"\\\" + _UserName.ToLower();\r\n\r\n\t\t}\r\n\r\n\r\n\t\tpublic ADUserInfo(string strLogonID)\t\r\n\t\t{\r\n\r\n\t\t\tsetServiceAccount();\r\n\r\n\t\t\tstrLogonID = strLogonID.ToLower().Replace(\"/\", @\"\\\");\r\n\r\n\t\t\tif (strLogonID.Length > 3) \r\n\t\t\t{\r\n\t\t\t\tif (strLogonID.IndexOf(@\"\\\") > 0) \r\n\t\t\t\t{\r\n\t\t\t\t\t_UserName = strLogonID; \r\n\t\t\t\t\t_UserDomain = _UserName.Substring(0, _UserName.IndexOf(@\"\\\"));\r\n\t\t\t\t\t_UserName = _UserName.Substring(_UserName.IndexOf(@\"\\\") + 1);\r\n\t\t\t\t\t//_GroupDomain = System.Configuration.ConfigurationSettings.AppSettings[\"Group_Domain\"].ToString();\r\n\t\t\t\t\t_GroupDomain = _UserDomain;\r\n\t\t\t\t\tsetCurrentUserProperties(\"(&(ObjectClass=User)(samAccountName=\" + _UserName + \"))\", _UserDomain);\r\n\t\t\t\t\t_LogonAccount = _UserDomain.ToUpper() + @\"\\\" + _UserName.ToLower();\r\n\t\t\t\t} \r\n\t\t\t\telse \r\n\t\t\t\t{\r\n\t\t\t\t\t//_GroupDomain = System.Configuration.ConfigurationSettings.AppSettings[\"Group_Domain\"].ToString();\r\n\t\t\t\t\tstrLogonID = strLogonID.Replace(\"(\", @\"\\28\");\r\n\t\t\t\t\tstrLogonID = strLogonID.Replace(\")\", @\"\\29\");\r\n\r\n\t\t\t\t\tstring strADSIQuery = \"(&(!cn=*@*)(ObjectClass=User)(|(cn=\" + strLogonID + \")(displayName=\" + strLogonID + \")))\";\r\n\t\t\t\t\tif ( (_GroupDomain.ToLower().IndexOf(\"usqa\") < 0) && (_GroupDomain.ToLower().IndexOf(\"usdev\") < 0)) \r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tsetCurrentUserProperties(strADSIQuery, \"dc=deloitte,dc=com\");\r\n\t\t\t\t\t} \r\n\t\t\t\t\telse \r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tsetCurrentUserProperties(strADSIQuery, _GroupDomain);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t_UserDomain = _AdsPath.Substring(_AdsPath.ToLower().IndexOf(@\"dc=\") + 3);\r\n\t\t\t\t\t_LogonAccount = _UserDomain.Substring(0, _UserDomain.ToLower().IndexOf(@\",\")).ToUpper() + @\"\\\" + _samAccountName;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\r\n\t\tpublic ADUserInfo(string strLogonID, string strEmail) \r\n\t\t{\r\n\t\t\t\r\n\t\t\tsetServiceAccount();\r\n\r\n\t\t\tstrLogonID = strLogonID.ToLower().Replace(\"/\", @\"\\\");\r\n\r\n\t\t\tif (strLogonID.Length > 3) \r\n\t\t\t{\r\n\t\t\t\tif (strLogonID.IndexOf(@\"\\\") > 0) \r\n\t\t\t\t{\r\n\t\t\t\t\t_UserName = strLogonID; \r\n\t\t\t\t\t_UserDomain = _UserName.Substring(0, _UserName.IndexOf(@\"\\\"));\r\n\t\t\t\t\t_UserName = _UserName.Substring(_UserName.IndexOf(@\"\\\") + 1);\r\n\t\t\t\t\t//_GroupDomain = System.Configuration.ConfigurationSettings.AppSettings[\"Group_Domain\"].ToString();\r\n\t\t\t\t\t_GroupDomain = _UserDomain;\r\n\t\t\t\t\tsetCurrentUserProperties(\"(&(ObjectClass=User)(samAccountName=\" + _UserName + \")(|(mail=\" + strEmail + \")(info=*:\" + strEmail + \")))\", _UserDomain);\r\n\t\t\t\t\t_LogonAccount = _UserDomain.ToUpper() + @\"\\\" + _UserName.ToLower();\r\n\t\t\t\t} \r\n\t\t\t\telse \r\n\t\t\t\t{\r\n\t\t\t\t\t//_GroupDomain = System.Configuration.ConfigurationSettings.AppSettings[\"Group_Domain\"].ToString();\r\n\t\t\t\t\tstrLogonID = strLogonID.Replace(\"(\", @\"\\28\");\r\n\t\t\t\t\tstrLogonID = strLogonID.Replace(\")\", @\"\\29\");\r\n\r\n\t\t\t\t\tstring strADSIQuery = \"(&(!cn=*@*)(ObjectClass=User)(|(cn=\" + strLogonID + \")(displayName=\" + strLogonID + \"))(|(mail=\" + strEmail + \")(info=*:\" + strEmail + \")))\";\r\n\t\t\t\t\tif ( (_GroupDomain.ToLower().IndexOf(\"usqa\") < 0) && (_GroupDomain.ToLower().IndexOf(\"usdev\") < 0)) \r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tsetCurrentUserProperties(strADSIQuery, \"dc=deloitte,dc=com\");\r\n\t\t\t\t\t} \r\n\t\t\t\t\telse \r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tsetCurrentUserProperties(strADSIQuery, _GroupDomain);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t_UserDomain = _AdsPath.Substring(_AdsPath.ToLower().IndexOf(@\"dc=\") + 3);\r\n\t\t\t\t\t_LogonAccount = _UserDomain.Substring(0, _UserDomain.ToLower().IndexOf(@\",\")).ToUpper() + @\"\\\" + _samAccountName;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\r\n\r\n\t\t#endregion\r\n\r\n\t\t#region Public Properties and Methods\r\n\r\n\t\tpublic string cn \r\n\t\t{\r\n\t\t\tget {return _cn;}\r\n\t\t\tset {}\r\n\t\t}\r\n\r\n\t\tpublic string samAccountName \r\n\t\t{\r\n\t\t\tget {return _samAccountName;}\r\n\t\t\tset {}\r\n\t\t}\r\n\r\n\t\tpublic string LogonAccount \r\n\t\t{\r\n\t\t\tget {return _LogonAccount;}\r\n\t\t\tset {}\r\n\t\t}\r\n\r\n\t\tpublic string ADGuid \r\n\t\t{\r\n\t\t\tget {return _ADGuid;}\r\n\t\t\tset {}\r\n\t\t}\r\n\r\n\t\tpublic string mail \r\n\t\t{\r\n\t\t\tget {return _mail;}\r\n\t\t\tset {}\r\n\t\t}\r\n\t\tpublic string InternetAddress \r\n\t\t{\r\n\t\t\tget {return _mail;}\r\n\t\t\tset {}\r\n\t\t}\r\n\t\tpublic string AdsPath \r\n\t\t{\r\n\t\t\tget {return _AdsPath;}\r\n\t\t\tset {}\r\n\t\t}\r\n\t\tpublic string sn \r\n\t\t{\r\n\t\t\tget {return _sn;}\r\n\t\t\tset {}\r\n\t\t}\r\n\t\tpublic string givenName \r\n\t\t{\r\n\t\t\tget {return _givenName;}\r\n\t\t\tset {}\r\n\t\t}\r\n\t\tpublic string LastName \r\n\t\t{\r\n\t\t\tget {return _sn;}\r\n\t\t\tset {}\r\n\t\t}\r\n\t\tpublic string FirstName  \r\n\t\t{\r\n\t\t\tget {return _givenName;}\r\n\t\t\tset {}\r\n\t\t}\r\n\r\n\r\n\t\tpublic ArrayList getTopLevelGroups ()\r\n\t\t{\r\n\r\n\t\t\tArrayList arOut = new ArrayList();\r\n\r\n\t\t\tDirectorySearcher oSearch = new DirectorySearcher(_AdsPath);\r\n\t\t\toSearch.Filter = \"(cn=\" + _cn + \")\";\r\n\t\t\toSearch.PropertiesToLoad.Add(\"memberOf\");\r\n\r\n\t\t\ttry \r\n\t\t\t{\r\n\t\t\t\tSearchResult result = oSearch.FindOne();\r\n\t\t\t\tint propertyCount = result.Properties[\"memberOf\"].Count;\r\n\t\t\t\tString dn;\r\n\t\t\t\tint equalsIndex, commaIndex;\r\n\r\n\t\t\t\tfor( int propertyCounter = 0; propertyCounter < propertyCount; propertyCounter++ ) \r\n\t\t\t\t{\r\n\t\t\t\t\tdn = (String)result.Properties[\"memberOf\"][propertyCounter];\r\n\r\n\t\t\t\t\tequalsIndex = dn.IndexOf(\"=\", 1);\r\n\t\t\t\t\tcommaIndex = dn.IndexOf(\",\", 1);\r\n\t\t\t\t\tif (-1 == equalsIndex) \r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t// False\r\n\t\t\t\t\t}\r\n\t\t\t\t\tarOut.Add(dn.Substring((equalsIndex + 1), (commaIndex - equalsIndex) - 1));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tcatch\r\n\t\t\t{\r\n\t\t\t\t// False\r\n\t\t\t} \r\n\r\n\t\t\treturn arOut;\r\n\t\t}\r\n\r\n\t\tpublic ArrayList getAllGroups()\r\n\t\t{\r\n\r\n\t\t\tArrayList ar = new ArrayList();\r\n\t\t\tDirectoryEntry dirUser = null;\r\n\t\t\tDirectoryEntry searchRoot = null;\r\n\t\t\tstring adsPathRoot = \"\";\r\n\r\n\t\t\tstring strUserDomain = _GroupDomain.ToLower();\r\n\t\t\tif (strUserDomain.StartsWith(\"usdev\") || strUserDomain.StartsWith(\"usqaex\"))\r\n\t\t\t{\r\n\t\t\t\tadsPathRoot = \"GC://\" + strUserDomain;\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tadsPathRoot = \"GC://DC=deloitte,DC=com\";\r\n\t\t\t}\r\n\r\n\r\n\t\t\ttry \r\n\t\t\t{\r\n\r\n\t\t\t\tstring strAdsPath = _AdsPath.Replace(\"GC:\", \"LDAP:\");\r\n\t\t\t\tdirUser = new DirectoryEntry(strAdsPath, sUID, sUPW, AuthenticationTypes.Secure);\r\n\t\t\t\t\r\n\t\t\t\tsearchRoot = new DirectoryEntry( adsPathRoot, sUID, sUPW, AuthenticationTypes.Secure);\r\n\r\n\t\t\t\t//string[] strPropList = {\"tokenGroups\"};\r\n\t\t\t\t//dirUser.RefreshCache(strPropList);\r\n\t\t\t\tdirUser.RefreshCache(new string[]{\"tokenGroups\"});\r\n\r\n\r\n\t\t\t\t// We are building an '|' clause\r\n\t\t\t\tStringBuilder sb = new StringBuilder();\r\n\t\t\t\tsb.Append(\"(|\");\r\n\r\n\t\t\t\tforeach (byte[] sid in dirUser.Properties[\"tokenGroups\"])\r\n\t\t\t\t{\r\n\t\t\t\t\t// Append each member into the filter\r\n\t\t\t\t\tsb.AppendFormat(\"(objectSid={0})\", BuildOctetString(sid));\r\n\t\t\t\t}\r\n\r\n\r\n\t\t\t\t// Finish the initial filter\r\n\t\t\t\tsb.Append(\")\");\r\n\r\n\t\t\t\t// Now get all groups in one search\r\n\t\t\t\tusing (DirectorySearcher ds = new DirectorySearcher( searchRoot, sb.ToString(), new string[]{\"distinguishedName\", \"cn\"} ))\r\n\t\t\t\t//using (DirectorySearcher ds = new DirectorySearcher( sb.ToString(), new string[]{\"distinguishedName\", \"cn\"}))\r\n\t\t\t\t{\r\n\t\t\t\t\tusing (SearchResultCollection src = ds.FindAll())\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tfor (int i = 0; i < src.Count; i++)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tstring s1 = src[i].Properties[\"distinguishedName\"][0].ToString();\r\n\t\t\t\t\t\t\tstring s2 = src[i].Properties[\"cn\"][0].ToString();\r\n\t\t\t\t\t\t\tar.Add ( s2 );\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} \r\n\t\t\tcatch (Exception ex)\r\n\t\t\t{ \r\n\t\t\t\tar.Add ( \"ERROR: \" + ex.Message);\r\n\t\t\t}\r\n\r\n\t\t\tdirUser.Dispose();\r\n\t\t\treturn ar;\r\n\t\t\r\n\t\t}\r\n\r\n\t\tpublic bool isMemberOf(string strGroupIn)\r\n\t\t{\r\n\t\t\tbool bMemberOf = false;\r\n\t\t\tstring strGroupSID = \"aaa-zzz\";\r\n\t\t\tstring strGroupPath = \"\";\r\n\t\t\tSearchResult oCurrentUser;\r\n\t\t\ttry \r\n\t\t\t{\r\n\t\t\t\toCurrentUser = getMemberDetails(\"(cn=\" + strGroupIn + \")\", @\"LDAP://\" + _GroupDomain);\r\n\t\t\t\tstrGroupPath  = oCurrentUser.Properties[\"AdsPath\"][0].ToString();\r\n\t\t\t} \r\n\t\t\tcatch \r\n\t\t\t{ \r\n\t\t\t\toCurrentUser = null;\r\n\t\t\t\tstrGroupPath = \"\";\r\n\t\t\t}\r\n\r\n\t\t\tif (strGroupPath.Length > 5) \r\n\t\t\t{\r\n\t\t\t\ttry \r\n\t\t\t\t{\r\n\t\t\t\t\tDirectoryEntry dirGroup = new DirectoryEntry(strGroupPath, sUID, sUPW, AuthenticationTypes.Secure);\r\n\t\t\t\t\tobject oGroupSID = dirGroup.Properties[\"objectSid\"].Value;\r\n\t\t\t\t\tif ((null != oGroupSID) && (strGroupPath.Length > 5)) \r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tstrGroupSID = BytesToHex((byte[])oGroupSID);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdirGroup.Dispose();\r\n\t\t\t\t} \r\n\t\t\t\tcatch { }\r\n\t\t\t}\r\n\r\n\t\t\ttry \r\n\t\t\t{\r\n\t\t\t\tstring strUserToken = \"\";\r\n\t\t\t\tstring strAdsPath = _AdsPath.Replace(\"GC:\", \"LDAP:\");\r\n\t\t\t\tDirectoryEntry dirUser = new DirectoryEntry(strAdsPath, sUID, sUPW, AuthenticationTypes.Secure);\r\n\r\n\t\t\t\t//string[] strPropList = {\"tokenGroups\"};\r\n\t\t\t\t//dirUser.RefreshCache(strPropList);\r\n\t\t\t\tdirUser.RefreshCache(new string[]{\"tokenGroups\"});\r\n\r\n\t\t\t\tforeach(object oTokenG in dirUser.Properties[\"tokenGroups\"]) \r\n\t\t\t\t{\r\n\t\t\t\t\tstrUserToken = BytesToHex((byte[])oTokenG);\r\n\t\t\t\t\tif (strGroupSID == strUserToken) \r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tbMemberOf = true;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tdirUser.Dispose();\r\n\t\t\t} \r\n\t\t\tcatch { }\r\n\r\n\t\t\treturn bMemberOf;\r\n\t\t\r\n\t\t}\r\n\r\n\r\n\t\t#endregion\r\n\r\n\r\n\t}\r\n}\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Active Directory","LDAP","Token Groups"]},{"RecordId":"747","Title":"Sorting a DataTable Using a DataView","Description":"Demonstrates how to sort a table in a DataSet and iterate through the sorted rows.","Code":"// Get some data from somewhere\r\nDataTable dt = GetSomeDataFormSomewhere();\r\n\r\n// Sort the data\r\ndt.DefaultView.Sort = \"LastName, FirstName, PersonnelNumber\";\r\n\r\n// Iterate through the sorted data\r\nforeach ( DataRowView odrv in dt.DefaultView)\r\n{\r\n\tstring strFirstName = odrv[\"FirstName\"].ToString();\r\n\tstring strLastName = odrv[\"LastName\"].ToString();\r\n\t...\r\n\t...\r\n}\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["DataView","Sorting DataSet"]},{"RecordId":"748","Title":"Converting String to Byte Array and Byte Array to String","Description":"Demonstrates how to convert a string to a byte array and also how to convert a byte array to a string.","Code":"string s = \"Now is the time\";\r\n\t\r\nbyte[] b1 = (new UnicodeEncoding()).GetBytes(s);    // Unicode strings\r\nbyte[] b2 = (new ASCIIEncoding()).GetBytes(s);        // ASCII strings\r\n\r\nstring s1 = (new UnicodeEncoding()).GetString( b1 );\r\nstring s2 = (new ASCIIEncoding()).GetString( b2 );\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["String to Byte Array","Byte Array to String"]},{"RecordId":"749","Title":"Edit List Permissions in SPS Portal","Description":"SPS Lists are secured based on the area to which they belong.  This shows how to edit the permissions for an individual list.","Code":"SPS Lists are secured based on the area to which they belong.  This means that you can not have different permissions on two lists that are under the same area.  This shows how to edit the permissions for an individual list, to overcome this shortcoming.\r\n\r\nWithin the SPS Portal, you typically edit the list columns, views, etc with a URL that looks similar to the following:\r\nhttp://YourPortal/SomeSubArea/_layouts/1033/listedit.aspx?List={FA515934-25C9-41D9-A96D-5C666A19D76B}\r\n\r\nTo edit the permissions for the list, simply manually alter the URL as follows:\r\nhttp://YourPortal/SomeSubArea/_layouts/1033/ShrOpt.aspx?obj={FA515934-25C9-41D9-A96D-5C666A19D76B},list\r\n\r\nSimply change \"listedit.aspx?List=\" to \"ShrOpt.aspx?obj=\" and add \",list\" on the end.  Viola!!!","Declares":"","CodeCategory":{"CategoryId":"25","CategoryDescription":"Sharepoint 2003"},"Keywords":["SPS List Permissions","Securing SPS Lists"]},{"RecordId":"750","Title":"Database Projects in Visual Studio .NET","Description":"Article by Scott Mitchell that explains how to include a database project in Visual Studio .Net","Code":"Database Projects in Visual Studio .NET\r\nBy Scott Mitchell\r\n\r\n----------------------------\r\nIntroduction\r\n----------------------------\r\nI've been using Visual Studio .NET for years developing ASP.NET applications, however it wasn't until about two years ago that I learned about Database projects in Visual Studio .NET. With a Database project you can manage all of your database's objects' creation scripts - stored procedures, views, tables, user-defined functions, jobs, and so on - through Visual Studio .NET. This offers a bevy of advantages, including:\r\n\r\n* Source control on database objects - if you are using source control (and you most definitely should be), the scripts managed through the Database project can be added to your source control provider. This means that any changes to your database objects will be recorded by your source control provider, thereby providing the myriad of advantages that source control affords (rolling back to older versions, a complete history of changes, etc.).\r\n\r\n* A centralized development experience - rather than having to poke through SQL Enterprise Manager you can manage your database-related objects through the same IDE that you are using to manage the pages and components in your ASP.NET application.\r\n\r\n* An improved text-editor - Visual Studio .NET's text-editor is head and shoulder's above SQL Enterprise Manager's built-in text-editing experience. Additionally, with SQL Enterprise Manager many of the dialog boxes that are used to create/edit database objects are modal, thereby making it impossible to examine other facets of the database when creating/editing a database object. Not so when doing it through Visual Studio .NET.\r\n\r\n* Ease of deployment - if you need to quickly replicate your database's structure having a Database project makes it as easy as right-clicking on the Database project's objects and selecting the 'Run' context-menu option.\r\n\r\n\r\n----------------------------\r\nAdding a Database Project to Your Solution\r\n----------------------------\r\nTo add a new Database project to the Solution, right-click on the Solution node in the tree and choose Add --> New Project. This will bring up the Add New Project dialog box. Under the Project Types section, expand the Other Projects folder and locate the Database Projects folder. \r\n\r\nAfter adding this new project type you'll be prompted to choose the database connection to use for the Database project. The Add Database Reference dialog box, lists the datasources saved in the Server Explorer. You can select one of the existing ones or add a new one by clicking the Add New Reference button. (If you opt to add a new database connection you will need to specify the provider - OLEDB for SQL Server, OLEDB for Oracle, Microsoft Jet for Access, etc. - along with the connection details, such as the server, username, password, database name, and so on.) You don't need to choose a database connection at this point if you don't like, as you can specify one later. To save this choice until later simply click the Cancel button.\r\n\r\nAfter choosing a database connection (or clicking the Cancel button) the new Database project will be added to the Solution.\r\n\r\nThe Database project consists of a list of folders and a set of Database References. If you chose a database connection from the Add Database Reference dialog box the selected database connection will appear in the Database References section. If you clicked Cancel, there will be no database connection included in this section. You can, at any time, add additional database connections to the set of Database References by right-clicking on the Database References node and selecting New Database Reference. Doing so will bring up the Add Database Reference dialog box.\r\n\r\nFrom this point I typically delete the default folders provided by the Database project and replace them with the following:\r\n    * Sprocs\r\n    * Tables\r\n    * Views\r\n    * UDFs\r\n    * Jobs\r\n\r\nFeel free to rename the folders, to leave them named as-is, or to apply your own naming scheme.  All that remains now is to add our existing database's objects to the Database project.\r\n\r\n----------------------------\r\nQuickly Adding the Database Objects from SQL Server to the Database Project\r\n----------------------------\r\nAt this point we have created the Database project, but have yet to add anything. What we want is this database project to have create scripts for the set of objects that makeup the ASP.NET application's associated database - the stored procedures, views, tables, UDFs, jobs, and so on. I am assuming that you already have these database entities created, and that you created them through SQL Enterprise Manager or T-SQL scripts. Moving the objects over from SQL Enterprise Manager to the Database project is pretty easy thanks to SQL Enterprise Manager's 'Generate SQL Script' tool.\r\n\r\nLaunch SQL Enterprise Manager and right-click on the database whose objects you want to import to the Database project created earlier. From the context-menu, choose All Tasks --> Generate SQL Script. This will display the Generate SQL Scripts dialog box. Click on the Show All button to list all of the database objects in the database. Next, move those objects you want scripted over to the 'Objects to be scripted' list by selecting those objects and clicking the Add >> button, or by checking the appropriate 'Objects to script' checkboxes. \r\n\r\nBefore generating the script, be certain to go to the Options tab and, under the Files to Generate section, opt to 'Create one file per object.' This will create a separate file for each object being scripted; the default option, 'Create one file,' will instead create just one file that contains the script for all of the objects. If you are scripting tables, you may also want to check the checkboxes in the Table Scripting Options section. If you have any special permissions for the various objects you might also want to check the 'Script object-level permissions' option as well.\r\n\r\nFinally, click the OK button to generate the SQL script. This will create one file for each object selected from the General tab. The final step, then, is to import these script files into the Database project. To do that, return to Visual Studio .NET, right-click on the Database project folder you want the object to reside and choose to Add Existing Item. Then browse to the directory where you saved the scripted objects and add the appropriate script files.\r\n\r\nWhen you need to create new database objects you have the option of either creating a new file in the Database project and writing the necessary T-SQL or creating the object through SQL Enterprise Manager and then importing it into the Visual Studio .NET Database project through the techniques discussed above. Personally I find myself creating tables and jobs through SQL Enterprise Manager, but Views, UDFs, and stored procedures through the Database project directly.\r\n\r\n----------------------------\r\nUsing the Database Project\r\n----------------------------\r\nNow that you have your database's objects included in the Database project, you can edit the objects through Visual Studio .NET, getting the advantages of source control, an integrated development environment, and Visual Studio .NET's superior editing experience. Once you have made changes to a database object you can apply those changes to the underlying database by clicking on the database object in the Solution Explorer and choosing Run or Run On. Run will execute the T-SQL script on the default Database Reference while the Run On option will allow you to choose which database connection to have the script executed. Additionally, from the editor you can select a chunk of T-SQL syntax, right-click on it and choose 'Run Selection' to execute just the selected text.","Declares":"","CodeCategory":{"CategoryId":"26","CategoryDescription":".Net - Visual Studio IDE"},"Keywords":["Database Project"]},{"RecordId":"751","Title":"Print SQL Server Exact Date and Time","Description":"Demonstrates how to get the exact date/time in milliseconds from SQL Server","Code":"-- Gets exact date/time\r\nprint convert(char(26),getdate(),109)\r\n\r\n-- Gets exact time\r\nprint convert(char(12),getdate(),114)\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"6","CategoryDescription":"T-SQL"},"Keywords":["getdate()","Exact DateTime","SQL Server Date Time"]},{"RecordId":"753","Title":"Custom Captions and Extended Properties of DataSet Columns","Description":"Shows how to set custom column captions and how to use the ExtendedProperties of columns.","Code":"// Get some data\r\nDataSet ds = GetMyData(Parm1, Parm2);\r\n\r\n// Create and set some ExtendedProperties\r\nDataColumnCollection cols = ds.Tables[0].Columns;\r\ncols[\"Col1\"].ExtendedProperties.Add(\"IsInDefaultView\", true);\r\ncols[\"Col2\"].ExtendedProperties.Add(\"IsInDefaultView\", true);\r\ncols[\"Col3\"].ExtendedProperties.Add(\"IsInDefaultView\", true);\r\n\r\n// Change the column headers (captions)\r\ncols[\"Col1\"].Caption = \"Caption for column 1\";\r\ncols[\"Col2\"].Caption = \"Caption for column 2\";\r\ncols[\"Col3\"].Caption = \"Caption for column 3\";\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["ExtendedProperties","Custom Captions","Column Headers"]},{"RecordId":"754","Title":"Update Sharepoint \"Choice\" Field from Database","Description":"Demonstrates how to sync up a Sharepoint \"choice\" field with a list from SQL Server","Code":"private void updateLookupFieldChoices() {\r\n\r\n\r\n\t// Open the SPS list\r\n\tSPWeb oSite = new SPSite( \"http://SomePortal/C3/Library\" ).OpenWeb();\r\n\toSite.AllowUnsafeUpdates = true;\r\n\tSPList oList = oSite.Lists[ \"Library\" ];\r\n\r\n\r\n\t// Get the existing field's XML\r\n\tstring _FieldSchemaXML = \"\";\r\n\tSPField oField = oList.Fields.GetField( \"Industry\" );\r\n\t_FieldSchemaXML = oField.SchemaXml;\r\n\r\n\tint iStart = _FieldSchemaXML.IndexOf( \"<CHOICES>\" ) + \"<CHOICES>\".Length; \t// get choice list start\r\n\tint iEnd = _FieldSchemaXML.IndexOf( \"</CHOICES>\" ); \t\t\t\t\t\t// get choice list end\r\n\tstring _XMLHead = _FieldSchemaXML.Substring( 0, iStart ); \t\t\t\t\t//preserves the column type etc.\r\n\tstring _XMLTail = _FieldSchemaXML.Substring( iEnd ) ; \t\t\t\t\t\t// preserves the closing tags\r\n\r\n\tstring _NewXMLChoice = \"\";\r\n\tstring _NewXMLChoices = \"\";\r\n\r\n\tstring strDBConnectionString = yourDBConnectionStringHere;\r\n\r\n\t// Open SQL connection\r\n\toConn = new SqlConnection();\r\n\toConn.ConnectionString = strDBConnectionString;\r\n\toConn.Open();\r\n\r\n\t// Create command object and get the data from SQL Server\r\n\tSqlCommand oCmd = new SqlCommand( \"app_c_GetDistinctIndustries\", oConn );\r\n\tSqlDataReader oDR = oCmd.ExecuteReader();\r\n\twhile ( oDR.Read() ) {\r\n\t\ttry\r\n\t\t{\r\n\t\t\t_NewXMLChoice = oDR[ 0 ].ToString();\r\n\t\t}\r\n\t\tcatch\r\n\t\t{\r\n\t\t\t_NewXMLChoice = \"\";\r\n\t\t}\r\n\t\t_NewXMLChoices += \"<CHOICE>\" + _NewXMLChoice + \"</CHOICE>\";\r\n\t}\r\n\toDR.Close();\r\n\toCmd.Dispose();\r\n\toConn.Close();\r\n\r\n\t// make sure there is at least one entry (one is required)\r\n\tif ( _NewXMLChoices == \"\" ) {\r\n\t\t_NewXMLChoices += \"<CHOICE>[none of the above]</CHOICE>\";\r\n\t}\r\n\r\n\t_FieldSchemaXML = _XMLHead + _NewXMLChoices + _XMLTail;\r\n\r\n\toSite.AllowUnsafeUpdates = true;\r\n\toField.SchemaXml = _FieldSchemaXML;\r\n\toField.Update();\r\n\toSite.AllowUnsafeUpdates = false;\r\n\r\n\toSite.Close();\r\n\toSite = null;\r\n\toList = null;\r\n\toField = null;\r\n\r\n}","Declares":"","CodeCategory":{"CategoryId":"25","CategoryDescription":"Sharepoint 2003"},"Keywords":["Sync Choice Field","Choice Field"]},{"RecordId":"755","Title":"Move an Item From One SPS List to Another SPS List","Description":"Demonstrates how to move one SPS list item from one one SPS list to another SPS list.  The code copies the fields and attachment(s) and the deletes the original item.","Code":"private void expireThisDoc(int intContributionIDIn, string strCurrentListNameIn) {\r\n\r\n\tstring strCurrentAreaName = \"\";\r\n\tstring strCurrentListName = \"\";\r\n\r\n\tswitch (strCurrentListNameIn) {\r\n\t\tcase \"Published\":\r\n\t\t\tstrCurrentAreaName = \"PublishedItemsArea\";\r\n\t\t\tstrCurrentListName = \"PublishedItemsListName\";\r\n\t\t\tbreak;\r\n\t\tcase \"Unpublished\":\r\n\t\t\tstrCurrentAreaName = \"UnPublishedItemsArea\";\r\n\t\t\tstrCurrentListName = \"UnPublishedItemsListName\";\r\n\t\t\tbreak;\r\n\t\tcase \"Expired\":\r\n\t\t\tstrCurrentAreaName = \"ExpiredItemsArea\";\r\n\t\t\tstrCurrentListName = \"ExpiredItemsListName\";\r\n\t\t\tbreak;\r\n\t\tcase \"Rejected\":\r\n\t\t\tstrCurrentAreaName = \"RejectedItemsArea\";\r\n\t\t\tstrCurrentListName = \"RejectedItemsListName\";\r\n\t\t\tbreak;\r\n\t\tdefault:\r\n\t\t\tbreak;\r\n\t}\r\n\r\n\tstring strTargetAreaName = \"ExpiredItemsArea\";\r\n\tstring strTargetListName = \"ExpiredItemsListName\";\r\n\r\n\tstring strSPSPortalCurrent = XMLHelper.XMLHelper.getConfigurationValue(strConfigFileName,strCurrentAreaName);\r\n\tstring strSPSPortalTarget = XMLHelper.XMLHelper.getConfigurationValue(strConfigFileName,strTargetAreaName);\r\n\r\n\t \r\n\t// Connect to the current and target lists\r\n\tSPWeb _siteCurrent = new SPSite(strSPSPortalCurrent).OpenWeb();\r\n\t_siteCurrent.AllowUnsafeUpdates = true;\r\n\r\n\tSPWeb _siteTarget = new SPSite(strSPSPortalTarget).OpenWeb();\r\n\t_siteTarget.AllowUnsafeUpdates = true;\r\n\r\n\t// Open the current list\r\n\t//string _strCurrentDocumentListName = ConfigurationSettings.AppSettings[strCurrentListName].ToString();\r\n\tstring _strCurrentDocumentListName = XMLHelper.XMLHelper.getConfigurationValue(strConfigFileName,strCurrentListName);\r\n\tSPList oListCurrent = _siteCurrent.Lists[_strCurrentDocumentListName];\r\n\t//SPListItemCollection listItemsCurrent = oListCurrent.Items;\r\n\r\n\t// Open the target list\r\n\t//string _strTargetDocumentListName = ConfigurationSettings.AppSettings[strTargetListName].ToString();\r\n\tstring _strTargetDocumentListName = XMLHelper.XMLHelper.getConfigurationValue(strConfigFileName,strTargetListName);\r\n\tSPList oListTarget = _siteTarget.Lists[_strTargetDocumentListName];\r\n\tSPListItemCollection listItemsTarget = oListTarget.Items;\r\n\r\n\t\r\n\t// Get the current contribution item\t\t\t\r\n\t//SPListItem oContributionItemCurrent = listItemsCurrent.GetItemById(intContributionIDIn);\r\n\tSPListItem oContributionItemCurrent = oListCurrent.GetItemById(intContributionIDIn);\r\n\r\n\t// Add new item to target list and populate fields\r\n\tSPListItem oContributionItemTarget = listItemsTarget.Add();\r\n\toContributionItemTarget[\"Title\"] = oContributionItemCurrent[\"Title\"];\r\n\toContributionItemTarget[\"Description\"] = oContributionItemCurrent[\"Description\"];\r\n\toContributionItemTarget[\"Country\"] = oContributionItemCurrent[\"Country\"];\r\n\toContributionItemTarget[\"Industry\"] = oContributionItemCurrent[\"Industry\"];\r\n\toContributionItemTarget[\"Contributed By\"] = oContributionItemCurrent[\"Contributed By\"];\r\n\toContributionItemTarget[\"Submitted Date\"] = oContributionItemCurrent[\"Submitted Date\"];\r\n\r\n\t// Add attachments\r\n\tSPAttachmentCollection attachFiles = oContributionItemCurrent.Attachments;\r\n\tforeach (string attachFile in attachFiles) {\r\n\t\tSPFile srcFile = _siteCurrent.GetFile(attachFiles.UrlPrefix + attachFile);\r\n\t\tbyte[] binFile = srcFile.OpenBinary();\r\n\t\toContributionItemTarget.Attachments.Add(attachFile,binFile);\r\n\t}\r\n\r\n\t// Save the new item\r\n\toContributionItemTarget.ModerationInformation.Status = SPModerationStatusType.Denied;\r\n\toContributionItemTarget.Update();\r\n\r\n\t// Delete the old item (This takes a work-around.  Note the steps that are involved.)\r\n\t// Step 1:  Set the item's status to approved so that we can access it via the .Items collection.  (Only approved items show up here.)\r\n\toContributionItemCurrent.ModerationInformation.Status = SPModerationStatusType.Approved;\r\n\toContributionItemCurrent.Update();\r\n\t\r\n\t// Step 2:  Retrieve the items collection in preparation for the delete\r\n\tSPListItemCollection listItemsCurrent = oListCurrent.Items;\r\n\t\r\n\t// Step 3:  Delete the item\r\n\tlistItemsCurrent.DeleteItemById(intContributionIDIn);\r\n\r\n}\r\n","Declares":"","CodeCategory":{"CategoryId":"25","CategoryDescription":"Sharepoint 2003"},"Keywords":["Move List Item"]},{"RecordId":"756","Title":"Read SPS Moderated (Un-Approved) List Items","Description":"Demonstrates how to retrieve all items from a moderated (requires approval) list, regardless of whether the items are approved or not.","Code":"public void processSPSDocuments(string strDocListIn) {\r\n\r\n\t// Determine which SPS document list to open\r\n\tstring strCurrentListName = \"\";\r\n\tstring strCurrentAreaName = \"\";\r\n\r\n\tswitch (strDocListIn) {\r\n\t\tcase \"Published\":\r\n\t\t\tstrCurrentAreaName = \"PublishedItemsArea\";\r\n\t\t\tstrCurrentListName = \"PublishedItemsListName\";\r\n\t\t\tbreak;\r\n\t\tcase \"Unpublished\":\r\n\t\t\tstrCurrentAreaName = \"UnPublishedItemsArea\";\r\n\t\t\tstrCurrentListName = \"UnPublishedItemsListName\";\r\n\t\t\tbreak;\r\n\t\tcase \"Rejected\":\r\n\t\t\tstrCurrentAreaName = \"UnPublishedItemsArea\";\r\n\t\t\tstrCurrentListName = \"UnPublishedItemsListName\";\r\n\t\t\tbreak;\r\n\t\tcase \"Expired\":\r\n\t\t\tstrCurrentAreaName = \"UnPublishedItemsArea\";\r\n\t\t\tstrCurrentListName = \"UnPublishedItemsListName\";\r\n\t\t\tbreak;\r\n\t}\r\n\r\n\tstring strSPSList = XMLHelper.XMLHelper.getConfigurationValue(strConfigFileName, strCurrentListName);\r\n\tstring strSPSPortal = XMLHelper.XMLHelper.getConfigurationValue(strConfigFileName, strCurrentAreaName);\r\n\r\n\t// Open the SPS list\r\n\tSPWeb oSite = new SPSite(strSPSPortal).OpenWeb();\r\n\tSPList oList = oSite.Lists[strSPSList];\r\n\tSPQuery oAllItems = new SPQuery();\r\n\toAllItems.ViewAttributes = \"ModerationType='Moderator'\";\r\n\tSPListItemCollection oListItems = oList.GetItems(oAllItems);\r\n\t\r\n\tforeach (SPListItem oItem in oListItems) {\r\n\r\n\t\tstring strContributionTitle = \"\";\r\n\t\tstring strCountry = \"\";\r\n\t\tstring strExpirationDate = \"\";\r\n\r\n\t\tbool blnDocWillExpire = false;\r\n\t\tbool blnDocIsExpired = false;\r\n\r\n\t\ttry { strContributionTitle = oItem[\"Title\"].ToString();} catch{}\r\n\t\ttry { strCountry = oItem[\"Country\"].ToString();} catch{}\r\n\t\ttry {strExpirationDate = oItem[\"Expiration Date\"].ToString();} catch{}\r\n\r\n\t\t// This doc has an expiration date\r\n\t\tif (strExpirationDate != \"\") {\r\n\t\t\t...\r\n\t\t\t...\r\n\t\t}\r\n\t}\r\n}","Declares":"","CodeCategory":{"CategoryId":"25","CategoryDescription":"Sharepoint 2003"},"Keywords":["Moderated List"]},{"RecordId":"757","Title":"Transform SPS List into Custom HTML Using JavaScript and XSL","Description":"The following code, in an SPS Content Editor Webpart, retrieves the contents of an\r\nSPS List as XML, and transforms it into custom HTML.","Code":"--------------------------------------------------------------------\r\nThe following code, in an SPS Content Editor Webpart, retrieves the contents of an\r\nSPS List as XML, and transforms it into custom HTML.\r\n--------------------------------------------------------------------\r\n<script language=jscript>\r\n\r\n\tvar httpRootStr=\"/IndustryMaps\";\r\n\tvar listID=\"BDEF4E53-228F-451B-9E9B-DF455CBE6B14\";\r\n\r\n\tvar strPost=httpRootStr+\"/_vti_bin/owssvr.dll?Cmd=Display&\"+\"List=\"+listID+\"&XMLDATA=true\";\r\n\r\n\r\n\tvar HTTPobj;\r\n\tHTTPobj = new ActiveXObject(\"Microsoft.XMLHTTP\");\r\n\tHTTPobj.open(\"GET\", strPost, false);\r\n\tHTTPobj.send();\r\n\r\n\t// Load XSL\r\n\tvar xsl = new ActiveXObject(\"MSXML2.FreeThreadedDOMDocument\");\r\n\txsl.async = false;\r\n\txsl.load(\"/IndustryMaps/Document Library/CycleTransform.xsl\");\r\n\r\n\tvar xslTemplate = new ActiveXObject(\"MSXML2.XSLTemplate\");\r\n\txslTemplate.stylesheet = xsl;\r\n\r\n\tvar xslProc = xslTemplate.createProcessor();\r\n\txslProc.input = HTTPobj.responseXml;\r\n\txslProc.transform();\r\n\r\n\t// Transform\r\n\tdocument.write(xslProc.output);\r\n\r\n</script>\r\n\r\n\r\n--------------------------------------------------------------------\r\nHere is the XSL stylesheet\r\n--------------------------------------------------------------------\r\n<?xml version=\"1.0\" encoding=\"ISO-8859-1\" ?> \r\n<xsl:stylesheet version=\"1.0\" xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\" xmlns:rs=\"urn:schemas-microsoft-com:rowset\" xmlns:z=\"#RowsetSchema\">\r\n\r\n   <xsl:param name=\"Header\" /> \r\n   <xsl:param name=\"HeaderMatch1\" /> \r\n   <xsl:param name=\"HeaderMatch2\" /> \r\n\r\n   <xsl:template match=\"/\">\r\n\r\n      <style>\r\n         .thumbnail { border: 2 solid #C0D5A7; /* process */ border: 2 solid #DCCEA0; /* cycle */ background-color: #EEEEEE; float: left; width: 225px; padding: 8px; font-size: 10pt; font-family: Arial, Helvetica, sans-serif; margin: 10px; } \r\n         .thumbnail img { border: none; float: left; margin-right: 16px; width: 35px; height: 35px; } \r\n         .thumbnail a:link, .thumbnail a:visited, .thumbnail a:active { color: black; text-decoration: none; } \r\n         .thumbnail a:hover { color: #C30; text-decoration: underline; } \r\n         .title { font-weight: bold; font-family: Verdana; color: #000000; font-size: 16px; background-color: #C0D5A7; /* process */ background-color: #DCCEA0; /* cycle */ padding: 6px; height: 1.2em; line-height: 1.2em; margin: 10px; } \r\n         .title img { border: none; float: right; }\r\n      </style> \r\n      \r\n      <div class=\"title\">\r\n         <a href=\"Process.aspx\">\r\n            <img src=\"/IndustryMaps/Image%20Library/GoToProcess.gif\" width=\"200\" height=\"20\" alt=\"Go to Process View\" /> \r\n         </a>\r\n         Business Cycle View \r\n      </div>\r\n\r\n      <xsl:apply-templates /> \r\n   </xsl:template>\r\n\r\n   <xsl:template match=\"rs:data\">\r\n      <xsl:apply-templates /> \r\n      </xsl:template>\r\n\r\n      <xsl:template match=\"z:row\">\r\n      <xsl:if test=\"@ows_Hidden=0\">\r\n         <xsl:variable name=\"thumbnail_url\" select=\"@ows_Thumbnail\" /> \r\n   \r\n         <div class=\"thumbnail\">\r\n            <a>\r\n               <xsl:if test=\"@ows_Link\">\r\n                  <xsl:attribute name=\"href\">\r\n                  <xsl:choose>\r\n                     <xsl:when test=\"contains(@ows_Link, $HeaderMatch1)\">\r\n                        <xsl:value-of select=\"$Header\" /> \r\n                        <xsl:value-of select=\"substring-after(@ows_Link, $HeaderMatch1)\" /> \r\n                     </xsl:when>\r\n                     <xsl:when test=\"contains(@ows_Link, $HeaderMatch2)\">\r\n                        <xsl:value-of select=\"$Header\" /> \r\n                        <xsl:value-of select=\"substring-after(@ows_Link, $HeaderMatch2)\" /> \r\n                     </xsl:when>\r\n                     <xsl:otherwise>\r\n                        <xsl:value-of select=\"@ows_Link\" /> \r\n                     </xsl:otherwise>\r\n                  </xsl:choose>\r\n                  </xsl:attribute>\r\n               </xsl:if>\r\n               <img>\r\n                  <xsl:attribute name=\"src\">\r\n                  <xsl:value-of select=\"$thumbnail_url\" /> \r\n                  </xsl:attribute>\r\n               </img>\r\n            </a>\r\n            <a>\r\n               <xsl:if test=\"@ows_Link\">\r\n                  <xsl:attribute name=\"href\">\r\n                  <xsl:choose>\r\n                     <xsl:when test=\"contains(@ows_Link, $HeaderMatch1)\">\r\n                     <xsl:value-of select=\"$Header\" /> \r\n                     <xsl:value-of select=\"substring-after(@ows_Link, $HeaderMatch1)\" /> \r\n                     </xsl:when>\r\n                        <xsl:when test=\"contains(@ows_Link, $HeaderMatch2)\">\r\n                        <xsl:value-of select=\"$Header\" /> \r\n                        <xsl:value-of select=\"substring-after(@ows_Link, $HeaderMatch2)\" /> \r\n                     </xsl:when>\r\n                     <xsl:otherwise>\r\n                        <xsl:value-of select=\"@ows_Link\" /> \r\n                     </xsl:otherwise>\r\n                  </xsl:choose>\r\n                  </xsl:attribute>\r\n               </xsl:if>\r\n               <xsl:value-of select=\"@ows_LinkTitle\" /> \r\n            </a>\r\n         </div>\r\n      </xsl:if>\r\n   </xsl:template>\r\n</xsl:stylesheet>\r\n\r\n\r\n--------------------------------------------------------------------\r\nHere is the XML from the list\r\n--------------------------------------------------------------------\r\n<xml xmlns:s=\"uuid:BDC6E3F0-6DA3-11d1-A2A3-00AA00C14882\" xmlns:dt=\"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882\" xmlns:rs=\"urn:schemas-microsoft-com:rowset\" xmlns:z=\"#RowsetSchema\">\r\n   <s:Schema id=\"RowsetSchema\">\r\n      <s:ElementType name=\"row\" content=\"eltOnly\" rs:CommandTimeout=\"30\">\r\n         <s:AttributeType name=\"ows_Attachments\" rs:name=\"Attachments\" rs:number=\"1\">\r\n            <s:datatype dt:type=\"boolean\" dt:maxLength=\"2\" /> \r\n         </s:AttributeType>\r\n         <s:AttributeType name=\"ows_LinkTitle\" rs:name=\"Name\" rs:number=\"2\">\r\n            <s:datatype dt:type=\"string\" dt:maxLength=\"512\" /> \r\n         </s:AttributeType>\r\n         <s:AttributeType name=\"ows_Link\" rs:name=\"Link\" rs:number=\"3\">\r\n            <s:datatype dt:type=\"string\" dt:maxLength=\"512\" /> \r\n         </s:AttributeType>\r\n         <s:AttributeType name=\"ows_Thumbnail\" rs:name=\"Thumbnail\" rs:number=\"4\">\r\n            <s:datatype dt:type=\"string\" dt:maxLength=\"512\" /> \r\n         </s:AttributeType>\r\n         <s:AttributeType name=\"ows_Hidden\" rs:name=\"Hidden\" rs:number=\"5\">\r\n            <s:datatype dt:type=\"boolean\" dt:maxLength=\"2\" /> \r\n         </s:AttributeType>\r\n      </s:ElementType>\r\n   </s:Schema>\r\n   <rs:data>\r\n      <z:row ows_Attachments=\"0\" ows_LinkTitle=\"Airlines\" ows_Link=\"https://rack.deloitte.com/esswebui/ContextView.aspx?industryID=27169d15-7e83-40e7-b616-d16d6c90e74d&context=Cycle&relatedprocess=1&relatedcycle=1&relatedaccount=1\" ows_Thumbnail=\"/IndustryMaps/Image%20Library/airlines_icon1.jpg\" ows_Hidden=\"0\" /> \r\n      <z:row ows_Attachments=\"0\" ows_LinkTitle=\"Banking\" ows_Thumbnail=\"/IndustryMaps/Image%20Library/BankInfra_icon.jpg\" ows_Hidden=\"-1\" /> \r\n      <z:row ows_Attachments=\"0\" ows_LinkTitle=\"Brokers\" ows_Link=\"http://rackv2/esswebui/ContextView.aspx?industryID=c908993d-133d-4c47-9715-3c61af1268c3&context=Cycle&relatedprocess=1&relatedcycle=1&relatedaccount=1\" ows_Thumbnail=\"/IndustryMaps/Image%20Library/CapMark_icon.jpg\" ows_Hidden=\"0\" /> \r\n      <z:row ows_Attachments=\"0\" ows_LinkTitle=\"Chemical\" ows_Thumbnail=\"/IndustryMaps/Image%20Library/Chemical_icon.jpg\" ows_Hidden=\"-1\" /> \r\n      <z:row ows_Attachments=\"0\" ows_LinkTitle=\"Construction\" ows_Link=\"http://rackv2/esswebui/ContextView.aspx?industryID=97c399e4-339c-4fa8-8a1f-f03b4ecbce39&context=Cycle&relatedprocess=1&relatedcycle=1&relatedaccount=1\" ows_Thumbnail=\"/IndustryMaps/Image%20Library/Construct_icon.jpg\" ows_Hidden=\"0\" /> \r\n      <z:row ows_Attachments=\"0\" ows_LinkTitle=\"Consumer Products\" ows_Link=\"http://rackv2/esswebui/ContextView.aspx?industryID=bbad22af-0b56-4ce9-bdd2-f134a48bcecb&context=Cycle&relatedprocess=1&relatedcycle=1&relatedaccount=1\" ows_Thumbnail=\"/IndustryMaps/Image%20Library/ConsumerBiz_icon.jpg\" ows_Hidden=\"0\" /> \r\n      <z:row ows_Attachments=\"0\" ows_LinkTitle=\"Depository Institutions\" ows_Link=\"http://rackv2/esswebui/ContextView.aspx?industryID=b256738b-6aff-42b2-aa69-fb1c0eb7ccda&context=Cycle&relatedprocess=1&relatedcycle=1&relatedaccount=1\" ows_Thumbnail=\"/IndustryMaps/Image%20Library/Banking%20Retail_icon.jpg\" ows_Hidden=\"0\" /> \r\n      <z:row ows_Attachments=\"0\" ows_LinkTitle=\"Emerging Strategic Clients\" ows_Link=\"http://rackv2/esswebui/ContextView.aspx?industryID=163a8f1c-b236-4229-bbad-115acef9ab73&context=Cycle&relatedprocess=1&relatedcycle=1&relatedaccount=1\" ows_Thumbnail=\"/IndustryMaps/Image%20Library/strategic_icon1.jpg\" ows_Hidden=\"0\" /> \r\n      <z:row ows_Attachments=\"0\" ows_LinkTitle=\"Employee Benefits\" ows_Link=\"http://rackv2/esswebui/ContextView.aspx?industryID=95f282d6-9849-4fb0-a2f1-690fbf572355&context=Cycle&relatedprocess=1&relatedcycle=1&relatedaccount=1\" ows_Thumbnail=\"/IndustryMaps/Image%20Library/EmployBen_icon.jpg\" ows_Hidden=\"0\" /> \r\n      <z:row ows_Attachments=\"0\" ows_LinkTitle=\"Finance Companies\" ows_Link=\"http://rackv2/esswebui/ContextView.aspx?industryID=86a05693-d780-4056-a1b5-dcdc34f760a1&context=Cycle&relatedprocess=1&relatedcycle=1&relatedaccount=1\" ows_Thumbnail=\"/IndustryMaps/Image%20Library/BankCom_icon.jpg\" ows_Hidden=\"0\" /> \r\n      <z:row ows_Attachments=\"0\" ows_LinkTitle=\"General Computer Controls\" ows_Link=\"http://rackv2/esswebui/ContextView.aspx?industryID=5599c1dc-cc7b-4d39-b005-baeaeba0b376&context=Cycle&relatedprocess=1&relatedcycle=1&relatedaccount=1#\" ows_Thumbnail=\"/IndustryMaps/Image%20Library/GenComp_icon2.jpg\" ows_Hidden=\"0\" /> \r\n      <z:row ows_Attachments=\"0\" ows_LinkTitle=\"Health Care\" ows_Link=\"http://rackv2/esswebui/ContextView.aspx?industryID=a33b4950-61ed-4296-a65e-da3dd75c02d9&context=Cycle&relatedprocess=1&relatedcycle=1&relatedaccount=1#\" ows_Thumbnail=\"/IndustryMaps/Image%20Library/HealthcareProvider_icon.jpg\" ows_Hidden=\"0\" /> \r\n      <z:row ows_Attachments=\"0\" ows_LinkTitle=\"Higher Ed\" ows_Link=\"http://rackv2/esswebui/ContextView.aspx?industryID=7ec48e66-4bd4-4981-9a89-3d46b00022bb&context=Cycle&relatedprocess=1&relatedcycle=1&relatedaccount=1#\" ows_Thumbnail=\"/IndustryMaps/Image%20Library/HigherEd_icon.jpg\" ows_Hidden=\"0\" /> \r\n      <z:row ows_Attachments=\"0\" ows_LinkTitle=\"Homebuilders and Developers\" ows_Link=\"http://rackv2/esswebui/ContextView.aspx?industryID=6dc713ee-d54c-4750-ba4c-da9aa5bf824d&context=Cycle&relatedprocess=1&relatedcycle=1&relatedaccount=1#\" ows_Thumbnail=\"/IndustryMaps/Image%20Library/Construct_icon.jpg\" ows_Hidden=\"0\" /> \r\n      <z:row ows_Attachments=\"0\" ows_LinkTitle=\"Hospitality and Gaming\" ows_Link=\"http://rackv2/esswebui/ContextView.aspx?industryID=88503935-48f5-48e7-9c23-c915ae3fa2b2&context=Cycle&relatedprocess=1&relatedcycle=1&relatedaccount=1#\" ows_Thumbnail=\"/IndustryMaps/Image%20Library/HospGaming_icon3.jpg\" ows_Hidden=\"0\" /> \r\n      <z:row ows_Attachments=\"0\" ows_LinkTitle=\"Housing and Urban Development\" ows_Link=\"http://rackv2/esswebui/ContextView.aspx?industryID=147efede-3973-417a-8e41-abf3139d79c1&context=Cycle&relatedprocess=1&relatedcycle=1&relatedaccount=1#\" ows_Thumbnail=\"/IndustryMaps/Image%20Library/Housing_icon.jpg\" ows_Hidden=\"0\" /> \r\n      <z:row ows_Attachments=\"0\" ows_LinkTitle=\"Income Producing Properties\" ows_Link=\"http://rackv2/esswebui/ContextView.aspx?industryID=fc8d7220-ec7e-40a5-a839-0426e0c0dc11&context=Cycle&relatedprocess=1&relatedcycle=1&relatedaccount=1#\" ows_Thumbnail=\"/IndustryMaps/Image%20Library/Income_icon.jpg\" ows_Hidden=\"0\" /> \r\n      <z:row ows_Attachments=\"0\" ows_LinkTitle=\"Insurance\" ows_Link=\"http://rackv2/esswebui/ContextView.aspx?industryID=6b9ea0ee-dbfe-4a2b-a9a8-862753c85ed1&context=Cycle&relatedprocess=1&relatedcycle=1&relatedaccount=1#\" ows_Thumbnail=\"/IndustryMaps/Image%20Library/Insurance_icon.jpg\" ows_Hidden=\"0\" /> \r\n      <z:row ows_Attachments=\"0\" ows_LinkTitle=\"Investment Advisors\" ows_Link=\"http://rackv2/esswebui/ContextView.aspx?industryID=333c24d2-078b-4ba8-baf7-016584617982&context=Cycle&relatedprocess=1&relatedcycle=1&relatedaccount=1#\" ows_Thumbnail=\"/IndustryMaps/Image%20Library/Sarbanes_icon.jpg\" ows_Hidden=\"0\" /> \r\n      <z:row ows_Attachments=\"0\" ows_LinkTitle=\"Investment Companies\" ows_Link=\"http://rackv2/esswebui/ContextView.aspx?industryID=f08c6ceb-6037-473b-a6a7-854412d8336f&context=Cycle&relatedprocess=1&relatedcycle=1&relatedaccount=1#\" ows_Thumbnail=\"/IndustryMaps/Image%20Library/InvestComp_icon.jpg\" ows_Hidden=\"0\" /> \r\n      <z:row ows_Attachments=\"0\" ows_LinkTitle=\"Life Sciences\" ows_Link=\"http://rackv2/esswebui/ContextView.aspx?industryID=0818f631-f34f-4ef5-a05c-2f8ca2b94ab2&context=Cycle&relatedprocess=1&relatedcycle=1&relatedaccount=1#\" ows_Thumbnail=\"/IndustryMaps/Image%20Library/PharmaLife_icon.jpg\" ows_Hidden=\"0\" /> \r\n      <z:row ows_Attachments=\"0\" ows_LinkTitle=\"Manage Taxes\" ows_Link=\"http://rackv2/esswebui/ContextView.aspx?industryID=77578ef4-e642-408c-af58-9c2a2d8a907f&context=Cycle&relatedprocess=1&relatedcycle=1&relatedaccount=1#\" ows_Thumbnail=\"/IndustryMaps/Image%20Library/ManageTaxes_icon.jpg\" ows_Hidden=\"0\" /> \r\n      <z:row ows_Attachments=\"0\" ows_LinkTitle=\"Managed Care\" ows_Link=\"http://rackv2/esswebui/ContextView.aspx?industryID=c186b42d-27b3-424b-a37f-271b986c8ece&context=Cycle&relatedprocess=1&relatedcycle=1&relatedaccount=1#\" ows_Thumbnail=\"/IndustryMaps/Image%20Library/HealthcarePay_icon.jpg\" ows_Hidden=\"0\" /> \r\n      <z:row ows_Attachments=\"0\" ows_LinkTitle=\"Manufacturing\" ows_Link=\"http://rackv2/esswebui/ContextView.aspx?industryID=0c980ca3-92e4-47ce-aea9-629f7cd70f04&context=Cycle&relatedprocess=1&relatedcycle=1&relatedaccount=1#\" ows_Thumbnail=\"/IndustryMaps/Image%20Library/Manufacturing_icon.jpg\" ows_Hidden=\"0\" /> \r\n      <z:row ows_Attachments=\"0\" ows_LinkTitle=\"Public Sector\" ows_Link=\"http://rackv2/esswebui/ContextView.aspx?industryID=e10ddd60-c278-41b4-8eae-24397d97c3f0&context=Cycle&relatedprocess=1&relatedcycle=1&relatedaccount=1#\" ows_Thumbnail=\"/IndustryMaps/Image%20Library/PublicSect_icon.jpg\" ows_Hidden=\"0\" /> \r\n      <z:row ows_Attachments=\"0\" ows_LinkTitle=\"Public Utilities\" ows_Link=\"http://rackv2/esswebui/ContextView.aspx?industryID=9c161802-8f65-403a-8c69-9879f47196e2&context=Cycle&relatedprocess=1&relatedcycle=1&relatedaccount=1#\" ows_Thumbnail=\"/IndustryMaps/Image%20Library/PubUtil_icon.jpg\" ows_Hidden=\"0\" /> \r\n      <z:row ows_Attachments=\"0\" ows_LinkTitle=\"Publishing\" ows_Link=\"http://rackv2/esswebui/ContextView.aspx?industryID=2780e745-14d3-4b2a-ab9b-d1b9febd163e&context=Cycle&relatedprocess=1&relatedcycle=1&relatedaccount=1#\" ows_Thumbnail=\"/IndustryMaps/Image%20Library/Publishing_icon.jpg\" ows_Hidden=\"0\" /> \r\n      <z:row ows_Attachments=\"0\" ows_LinkTitle=\"Real Estate Investment Trust\" ows_Link=\"http://rackv2/esswebui/ContextView.aspx?industryID=9a21bf51-1232-4af2-a27d-921133dfcc94&context=Cycle&relatedprocess=1&relatedcycle=1&relatedaccount=1#\" ows_Thumbnail=\"/IndustryMaps/Image%20Library/RealEstInv_icon.jpg\" ows_Hidden=\"0\" /> \r\n      <z:row ows_Attachments=\"0\" ows_LinkTitle=\"Telecommunications - Wireline\" ows_Link=\"http://rackv2/esswebui/ContextView.aspx?industryID=50b064aa-6602-4473-b959-286521dfae4a&context=Cycle&relatedprocess=1&relatedcycle=1&relatedaccount=1#\" ows_Thumbnail=\"/IndustryMaps/Image%20Library/TelecomWireline_icon.jpg\" ows_Hidden=\"0\" /> \r\n      <z:row ows_Attachments=\"0\" ows_LinkTitle=\"Trade\" ows_Link=\"http://rackv2/esswebui/ContextView.aspx?industryID=e602be63-91e0-4461-9608-69218f7ebdbe&context=Cycle&relatedprocess=1&relatedcycle=1&relatedaccount=1#\" ows_Thumbnail=\"/IndustryMaps/Image%20Library/Retail_icon.jpg\" ows_Hidden=\"0\" /> \r\n   </rs:data>\r\n</xml>\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"25","CategoryDescription":"Sharepoint 2003"},"Keywords":["Transform List","Custom List Display"]},{"RecordId":"758","Title":"Retrieve SPS List Data in XML","Description":"Retrieves a SPS list contents in XML","Code":"http://SomeSPSPortal/SomeArea/_vti_bin/owssvr.dll?Cmd=Display&List=BDEF4E53-228F-451B-9E9B-DF455CBE6B14&XMLDATA=true","Declares":"","CodeCategory":{"CategoryId":"25","CategoryDescription":"Sharepoint 2003"},"Keywords":["List Contents as XML","Get SPS List Contents as XML"]},{"RecordId":"759","Title":"Dynamically Filter a List (or View) Using the Querystring","Description":"Shows how to construct a URL to dynamically filter a list (or view) using the querystring","Code":"http://SomePortal/SomeArea/SomeSubAreay/Lists/SomeListName/Default.aspx\r\n?View={3764C496-0CA6-4433-928B-7CD8D176C53D}\r\n&FilterField1=FieldNameToFilterOn  (Use internal field name)\r\n&FilterValue1=Text to match  (Do not include quote marks)\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"25","CategoryDescription":"Sharepoint 2003"},"Keywords":["Filter List","Filter View","Dynamically Filter"]},{"RecordId":"760","Title":"Persisting Information Using UserData Behaviors","Description":"Client-side information can be persisted in the userData behavior in addition to cookies.  The userData object persists after the browser is closed and can be retrieved later.","Code":"The userData behavior persists data across sessions, using one UserData store for each object. The UserData store is persisted in the cache using the save and load methods. Once the UserData store has been saved, it can be reloaded even if Microsoft Internet Explorer has been closed and reopened.\r\n\r\nThe information is stored in XML form in the following location on the user's machine:\r\nC:\\Documents and Settings\\UserNameGoesHere\\UserData\r\n\r\n\r\nSetting the userData behavior class on the html, head, title, or style object causes an error when the save or load method is called.\r\n\r\nThe required style can be set inline or in the document header, as follows: \r\n\r\n   <STYLE>\r\n      .storeuserData {behavior:url(#default#userData);}\r\n   </STYLE>\r\n\r\n\r\n----------------------------------------------------------------------------------------\r\nThis example uses the userData behavior to preserve information in a UserData Store.\r\n----------------------------------------------------------------------------------------\r\n\r\n<HTML>\r\n<HEAD>\r\n<STYLE>\r\n   .storeuserData {behavior:url(#default#userData);}\r\n</STYLE>\r\n<SCRIPT>\r\nfunction fnSaveInput(){\r\n   var oPersist=oPersistForm.oPersistInput;\r\n   oPersist.setAttribute(\"sPersist\",oPersist.value);\r\n   oPersist.save(\"oXMLBranch\");\r\n}\r\nfunction fnLoadInput(){\r\n   var oPersist=oPersistForm.oPersistInput;\r\n   oPersist.load(\"oXMLBranch\");\r\n   oPersist.value=oPersist.getAttribute(\"sPersist\");\r\n}\r\n</SCRIPT>\r\n</HEAD>\r\n<BODY>\r\n<FORM ID=\"oPersistForm\">\r\n<INPUT CLASS=\"storeuserData\" TYPE=\"text\" ID=\"oPersistInput\">\r\n<INPUT TYPE=\"button\" VALUE=\"Load\" onclick=\"fnLoadInput()\">\r\n<INPUT TYPE=\"button\" VALUE=\"Save\" onclick=\"fnSaveInput()\">\r\n</FORM>\r\n</BODY>\r\n</HTML>\r\n\r\n\r\n----------------------------------------------------------------------------------------\r\nThe following example uses the userData behavior in a custom tag to preserve information in a UserData Store.\r\n----------------------------------------------------------------------------------------\r\n\r\n<HTML XMLNS:sdk>\r\n<HEAD>\r\n<STYLE>\r\nsdk\\:cacher {behavior:url(#default#userData);}\r\n</STYLE>\r\n<SCRIPT>\r\nfunction fnSaveInput(){\r\n   cachetag.setAttribute(\"sPersist\",txt1.value);\r\n   cachetag.save(\"cache\");\r\n}\r\nfunction fnLoadInput(){\r\n   cachetag.load(\"cache\");\r\n   cachetag.value=cachetag.getAttribute(\"sPersist\");\r\n}\r\n</SCRIPT>\r\n</HEAD>\r\n<BODY>\r\n<sdk:cacher id=\"cachetag\"></sdk:cacher>\r\n<INPUT TYPE=\"button\" VALUE=\"Load\" onclick=\"fnLoadInput()\">\r\n<INPUT TYPE=\"button\" VALUE=\"Save\" onclick=\"fnSaveInput()\">\r\n<INPUT TYPE=\"text\" ID=\"txt1\" VALUE=\"some value\">\r\n</BODY>\r\n</HTML>\r\n","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["UserData","Persisting Information","Cookies"]},{"RecordId":"761","Title":"Scroll to Control on Page Without SmartNavigation","Description":"Demonstrates how to scroll a control into view on a webform","Code":"Scroll to Control on Page Without SmartNavigation \r\nSubmitted By:  Peter Bromberg \r\n\r\nWe get a number of posts and requests on how to make a page scroll to the position of a control deep down on the page that issued a postback.   \r\n\r\nAs we all know, SmartNavigation is not always appropriate.  Here is a very easy way to accomplish this.  We put it in Global.asax so that it is accessible easily as a utility method from any page in our application: \r\n\r\n-----------------------------------------------\r\n// in Global.asax.cs: \r\n-----------------------------------------------\r\npublic class Global : System.Web.HttpApplication \r\n{ \r\n\r\n\t// insert static SetFocus method here, just below the class Global declaration: \r\n\tpublic static void SetFocus(System.Web.UI.Page webPage) \r\n\t{   \r\n\t\tstring[] pbCtrl = webPage.Page.Request.Form.GetValues(\"__EVENTTARGET\"); \r\n\t\tif (pbCtrl != null && pbCtrl.Length > 0) \r\n\t\t{ \r\n\t\t\tstring ctrlId; \r\n\t\t\tctrlId = pbCtrl[0]; \r\n\t\t\tSystem.Web.UI.Control ctrlFound = webPage.Page.FindControl(ctrlId); \r\n\t\t\tif ((ctrlFound != null) && ( ctrlFound is System.Web.UI.WebControls.DropDownList || ctrlFound is System.Web.UI.WebControls.TextBox || ctrlFound is System.Web.UI.WebControls.RadioButton || ctrlFound is System.Web.UI.WebControls.RadioButtonList)) \r\n\t\t\t{ \r\n\t\t\t\tstring ctrlClientId; \r\n\t\t\t\tctrlClientId = ctrlFound.ClientID; \r\n\t\t\t\tstring strScript; \r\n\t\t\t\tstrScript = \"<SCRIPT language=\\\"javascript\\\"> document.getElementById('\" + ctrlClientId + \"').focus(); document.getElementById('\" + ctrlClientId + \"').scrollIntoView(true) </SCRIPT>\";     \r\n\t\t\t\twebPage.Page.RegisterStartupScript(\"controlFocus\",strScript );   \r\n\t\t\t} \r\n\t\t} \r\n\t} \r\n\r\n...\r\n\r\n}\r\n\r\n\r\n\r\n\r\n-----------------------------------------------\r\n// In your Page_Load handler for (any page) \r\n-----------------------------------------------\r\nprivate void Page_Load(object sender, System.EventArgs e) \r\n{ \r\n    // insert this conditional call to the SetFocus Method: \r\n   if(IsPostBack) Global.SetFocus(this); \r\n   ...\r\n}","Declares":"","CodeCategory":{"CategoryId":"20","CategoryDescription":".Net - ASP.Net"},"Keywords":["Scroll Control to View","scrollIntoView"]},{"RecordId":"762","Title":"Enterprise Library Exception Handler - Memory Leak if Used Improperly","Description":"If used incorrectly, Enterprise Library Exception Handler leaks memory.  See these notes.","Code":"Enterprise Library has the ability to intercept and handle exceptions according to a configured policy.  This exception handler will contain a line similar to the following:\r\n\r\nreturn ExceptionPolicy.HandleException(E, \"Application\", new ConfigurationContext());\r\n\r\nThe call to ExceptionPolicy.HandleException is the call into Enterprise Library to handle whatever the current exception is.  The last parameter is the one giving the problems.  The statement \"new ConfigurationContext()\" creates a new configuration context object for the handler to use.  The ConfigurationContext object potentially uses unmanaged resources, and when it is created in this way, it cannot dispose of the resources when it is finished using them -- leading to a memory leak.  The leak occurs regardless of how the policy is configured.\r\n\r\nThe solution depends on the actual application.  There are a couple of different options:  \r\n1. Rewrite the code to allow for the disposal of the context object\r\n2. Use an overloaded method of ExceptionPolicy.HandleException that does not require\r\n    a ConfigurationContext object.\r\n\r\nHere is the recommended call:\r\nreturn ExceptionPolicy.HandleException(E, \"Application\");\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Enterprise Library Memory Leak"]},{"RecordId":"763","Title":"Global Exception Handling and Logging in ASP.Net","Description":"Create a global exception handler that logs errors to a table.","Code":"----------------------------------------------------------------\r\nPut this code in Global.asax to hook-up the error page with unhandled exceptions\r\n----------------------------------------------------------------\r\n\r\nprotected void Application_Error(Object sender, EventArgs e)\r\n{\r\n\tServer.Transfer(\"/UnhandledError.aspx\");\r\n}\r\n\r\n\r\n----------------------------------------------------------------\r\nPut this code in an aspx page named \"UnhandledError.aspx\", which gets called anytime an unhandled exception occurs\r\n----------------------------------------------------------------\r\n\r\nException ex = Server.GetLastError();\r\nif (ex.InnerException != null)\r\n{\r\n\tex = ex.InnerException;\r\n}\r\n\r\nint exceptionId = ExceptionLog.LogException(ex.Message, ex.StackTrace);\r\nliteral.Text = String.Format(\"A system error has occurred. Please call 1-800-HelpME and provide the following error code <b>{0}</b>.\", exceptionId.ToString());\r\n\r\n\r\n\r\n----------------------------------------------------------------\r\nThis is the code that is in our BL.\r\n----------------------------------------------------------------\r\n\r\npublic static int LogException ( string ExceptionText, string StackTraceText )\r\n{\r\n\r\n\tstring strUserLogon = System.Security.Principal.WindowsIdentity.GetCurrent().Name.ToLower();\r\n\r\n\tDatabase db = DatabaseFactory.CreateDatabase( Globals.DBKey );\r\n\r\n\t// Command object to insert comment\r\n\tstring sqlCommand = \"pub_InsExceptionLog\";\r\n\tDBCommandWrapper dbCommandWrapper = db.GetStoredProcCommandWrapper( sqlCommand ); \r\n\tdbCommandWrapper.AddInParameter( \"@LogonUser\", DbType.String, strUserLogon );\r\n\tdbCommandWrapper.AddInParameter( \"@ExceptionText\", DbType.String, ExceptionText );\r\n\tdbCommandWrapper.AddInParameter( \"@StackTraceText\", DbType.String, StackTraceText );\r\n\tdbCommandWrapper.AddOutParameter( \"@RecordID\", DbType.Int32, 4 );\r\n\r\n\tdb.ExecuteNonQuery ( dbCommandWrapper );\r\n\r\n\tint intReturnValue = int.Parse ( dbCommandWrapper.GetParameterValue( \"@RecordID\" ).ToString() );\r\n\treturn intReturnValue;\r\n\r\n}\r\n","Declares":"","CodeCategory":{"CategoryId":"20","CategoryDescription":".Net - ASP.Net"},"Keywords":["Global Exception Handler","Logging Exceptions"]},{"RecordId":"764","Title":"Scroll Control into View","Description":"Scrolls a control named CurrentItem into view.","Code":"function ScrollToCurrentDay()\r\n{\r\n  if (document.all.CurrentItem != null)\r\n  {\r\n    document.all.CurrentItem.scrollIntoView(true);\r\n  }\r\n}\r\n\r\n\r\n<body onload=\"ScrollToCurrentDay()\">","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["Scroll Control Into View","scrollIntoView"]},{"RecordId":"765","Title":"ValidateRequest - Allowing HTML in Form Posts","Description":"Explains how to set validateRequest to false so that .Net webforms can post HTML to the server without generating an error.","Code":"The default value of validateRequest is true.  This causes the .Net framework to display the following error if a form posts HTML (from a text field) to the server.\r\nA potentially dangerous Request.Form value was detected from the client (txtClientName=\"<javascript>alert('h...\"). \r\n\r\nYou can disable request validation by setting validateRequest=false in the Page directive or in the configuration section. However, it is strongly recommended that your application explicitly check all inputs in this case.\r\n\r\n<%@ Page ... validateRequest=\"false\" %> \r\n\r\n<system.web> \r\n   <pages validateRequest=\"false\" /> \r\n</system.web> \r\n\r\nIf you set validateRequest to false, your users can enter HTML in free-form text fields.  This poses a security risk.  It is recommended that you HTML encode all content if you set requestValidation to false.\r\n\r\n\r\nHow to HTML encode content\r\n\r\nIf you have disabled request validation, it is good practice to HTML-encode content that will be stored for future use. HTML encoding will automatically replace any < or > (together with several other symbols) with their corresponding HTML encoded representation.\r\n\r\nContent can be easily HTML-encoded on the server using the Server.HtmlEncode(string) API. Content can also be easily HTML-decoded, that is, reverted back to standard HTML using the Server.HtmlDecode(string) method. \r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"20","CategoryDescription":".Net - ASP.Net"},"Keywords":["ValidateRequest"]},{"RecordId":"766","Title":"How To Change the View Source Editor in IE","Description":"How To Change the View Source Editor in IE","Code":"Changing the \"View Source\" application in Internet Explorer\r\n\r\nChange (or create if it doesn't exist) the following key:\r\n\r\nHKEY_LOCAL_MACHINE\r\n\t\\SOFTWARE\r\n\t\t\\Microsoft\r\n\t\t\t\\Internet Explorer\r\n\t\t\t\t\\View Source Editor\r\n\t\t\t\t\t\\Editor Name\t\t(Default) value = \"C:\\Utilities\\UltraEdit\\uedit32.exe\"","Declares":"","CodeCategory":{"CategoryId":"7","CategoryDescription":"Misc"},"Keywords":["View Source Editor"]},{"RecordId":"767","Title":"Encrypting Viewstate","Description":"Explains how to encrypt Viewstate in a .Net web application.","Code":"Protecting ViewState\r\n\r\nBy default the ViewState of a page is unprotected. Although the values are not directly visible as in the case of querystring or hidden form fields, it would not be too difficult for a determined individual to decode the stored information. However, Microsoft has provided two mechanisms for increasing the security of ViewState. \r\n\r\nMachine Authentication Check (MAC) - tamper-proofing\r\nIn fact tamper-proofing does not protect against an individual determining the contents of the ViewState. It instead provides a way of detecting whether someone has modified the contents of the ViewState in an attempt to deceive your application. In this technique the ViewState is encoded using a hash code (using the SHA1 or MD5 algorithms) before it is sent to the client browsers. On postback ASP.NET checks the encoded ViewState to verify it has not been tampered with. This is called a machine authentication check and is simply enabled at the page level: \r\n\r\n<%@ Page EnableViewStateMac=\"true\"%>  \r\n\r\nHowever, MAC is enabled by default in the machine.config file so should not be a concern unless someone has altered the default settings. \r\n\r\nEncrypting the ViewState\r\nYou can instruct ASP.NET to encrypt the contents of ViewState using the Triple DES symmetric algorithm (see the .NET SDK documentation for more information) - a stronger encryption algorithm that makes it very difficult for anyone to decode the ViewState. \r\n\r\n\r\nThis encryption can only be applied at the machine.config level, as follows: \r\n\r\n<machineKey validation=\"3DES\" validationKey=\"\" />\r\n\r\nIn the validationKey=\"\" you'll have to enter a 128 bit key. See the code at the end of this sample (provided by Susan Warren) to see how to build a page, that generates a 128 bit key.\r\n\r\nIf securing ViewState in a web farm scenario (multiple servers running the same application and thus needing to share state information) you must use the same validation key for all servers which is used to encrypt and decrypt the data. To do this you need to explicitly specify a common key rather than relying on autogeneration of a key as per the above configuration line. See the referenced 'Taking a Bite Out of ASP.NET ViewState' article for further information on this area. \r\n\r\nThe following URL will generate the web.config entry for you:\r\nhttp://www.aspnetresources.com/tools/keycreator.aspx\r\n\r\n\r\nViewState Security on a Web Farm\r\n\r\nBy default, ASP.NET creates a random validation key and stores it in each server's Local Security Authority (LSA). In order to validate a ViewState field created on another server, the validationKey for both servers must be set to the same value. If you secure ViewState by any of the means listed above for an application running in a Web Farm configuration, you will need to provide a single, shared validation key for all of the servers. \r\n\r\nThe validation key is a string of 20 to 64 random, cryptographically-strong bytes, represented as 40 to 128 hexadecimal characters. Longer is more secure, so a 128-character key is recommended for machines that support it. For example:\r\n\r\n<machineKey validation=\"SHA1\" validationKey=\" \r\nF3690E7A3143C185AB1089616A8B4D81FD55DD7A69EEAA3B32A6AE813ECEECD28DEA66A\r\n23BEE42193729BD48595EBAFE2C2E765BE77E006330BC3B1392D7C73F\" />\r\n\r\nThe System.Security.Cryptography namespace includes the RNGCryptoServiceProvider class that you can use to generate this string, as demonstrated in the following GenerateCryptoKey.aspx sample:\r\n\r\n//-----------------------------------------------------------------------------------------------------------------\r\nThe following algorithm will generate a string to plug into the machine key:\r\n//-----------------------------------------------------------------------------------------------------------------\r\n\r\nint keylength = 40;\r\n//int keylength = 128;  This is the prefered length more higher security\r\nbyte[] buff = new Byte[keylength/2];\r\n\r\n// Fill an array with cryptographically strong random bytes\r\nRNGCryptoServiceProvider rng = new RNGCryptoServiceProvider();\r\nrng.GetBytes(buff);\r\n\r\nStringBuilder sb = new StringBuilder(keylength);\r\nint i;\r\nfor (i = 0; i < buff.Length; i++) \r\n{\r\n\tsb.Append(String.Format(\"{0:X2}\",buff[i]));\r\n}\r\n\r\n// Show the string so that we can use it\r\nSystem.Console.WriteLine(sb.ToString());\r\n","Declares":"","CodeCategory":{"CategoryId":"20","CategoryDescription":".Net - ASP.Net"},"Keywords":["Viewstate","Encrypting Viewstate"]},{"RecordId":"768","Title":"Create a Hash From a String","Description":"Demonstrates how to create a hash from a string.  The string is made more tamper-proof by adding a secret string to it.","Code":"// The string to hash\r\nstring strStringToHash = \"now is the time\";\r\n\r\n// The secret string that makes it more tamper-proof\r\nstring strSecretSalt = \"H3#@*ALMLLlk31q4l1ncL#@...\";\r\n\r\n// Construct a funky string from all of the parts.  This makes it more secure.\r\nstring strFinalInput = String.Concat(strSecretSalt, strStringToHash, strSecretSalt);\r\n\r\n// The array of bytes that will contain the encrypted value of input\r\nbyte[] hashedDataBytes;\r\n\r\n// The encoder class used to convert strPlainText to an array of bytes\r\nUTF8Encoding encoder = new UTF8Encoding();\r\n\r\n// Create an instance of the MD5CryptoServiceProvider class\r\nMD5CryptoServiceProvider md5Hasher = new MD5CryptoServiceProvider();\r\n\r\n// Call ComputeHash, passing in the plain-text string as an array of bytes.  The return value is the encrypted value, as an array of bytes\r\nhashedDataBytes = md5Hasher.ComputeHash(encoder.GetBytes(strFinalInput));\r\n\r\n// Base-64 Encode the results and strip off ending '==', if it exists\r\nstring strHashOutput = Convert.ToBase64String(hashedDataBytes).TrimEnd(\"=\".ToCharArray());\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Hash"]},{"RecordId":"769","Title":"Split Multiple Delimited String into it's Components","Description":"Parsing routine that splits a string into it's components","Code":"string strInput = \"a:b|c:d,e,f|g:h,i\";\r\nchar[] charSeparator1 = new char[]{':'};\r\nchar[] charSeparator2 = new char[]{','};\r\nchar[] charSeparator3 = new char[]{'|'};\r\n\r\nstring[] strTokenOuter = strInput.Split(charSeparator3);\r\nforeach (string strOuter in strTokenOuter)\r\n{\r\n\r\n   string[] strTokenMiddle = strOuter.Split(charSeparator1);\r\n   for (int intMidNdx = 1; intMidNdx < strTokenMiddle.Length; intMidNdx++)\r\n   {\r\n\t\t\r\n      string[] strTokenInner = strTokenMiddle[intMidNdx].Split(charSeparator2);\r\n      for (int intInnerNdx = 0; intInnerNdx < strTokenInner.Length; intInnerNdx++)\r\n      {\r\n         string strResult = strTokenMiddle[0] + \"-\" + strTokenInner[intInnerNdx];\r\n         Console.WriteLine( strResult );\r\n         }  // Inner\r\n      }  // Middle\r\n}  // Outer\r\n\r\n\r\nOutput:\r\na-b\r\nc-d\r\nc-e\r\nc-f\r\ng-h\r\ng-i\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Delimited String","Split String"]},{"RecordId":"770","Title":"Encrypting ASP.Net Credentials and Session State Connection Strings","Description":"How to use the ASP.NET utility to encrypt credentials and session state connection strings.\r\nApplies to 1.0 and 1.1 .Net Frameworks","Code":"How to use the ASP.NET utility to encrypt credentials and session state connection strings\r\n\r\nApplies to 1.0 and 1.1 .Net Frameworks\r\n\r\nArticle ID : 329290 \r\nLast Review : July 8, 2005 \r\nRevision : 7.2 \r\n\r\nIMPORTANT: This article contains information about modifying the registry. Before you modify the registry, make sure to back it up and make sure that you understand how to restore the registry if a problem occurs. For information about how to back up, restore, and edit the registry, click the following article number to view the article in the Microsoft Knowledge Base: \r\n256986 (http://support.microsoft.com/kb/256986/EN-US/) Description of the Microsoft Windows Registry \r\n\r\nSUMMARY\r\nThis step-by-step article describes how to use the Aspnet_setreg.exe utility to encrypt credentials and session state connection strings. ASP.NET version 1.0 requires that you store plain text credentials in configuration files if you want to do any of the following: \r\n Change the Microsoft ASP.NET worker process identity. \r\n Specify an impersonation identity. \r\n Specify a connection string for session state. \r\n\r\nWhen you apply the hotfix that is described in Microsoft Knowledge Base article 329250 (see \"References\"), you can use encrypted data that is stored in the registry instead of plain text in the following configuration sections: \r\n <identity userName= password= /> \r\n <processModel userName= password= /> \r\n <sessionState stateConnectionString= sqlConnectionString= /> \r\n\r\n\r\nIntroduction\r\nUse the Aspnet_setreg.exe utility to encrypt and to store these attribute values in the registry under a secure key. Use the CryptProtectData function with the CRYPTPROTECT_LOCAL_MACHINE flag to encrypt the credentials. Because anyone with access to the computer can call CryptUnprotectData, the encrypted data is stored under a secure registry key with a strong discretionary access control list (DACL). When ASP.NET parses the configuration file, it reads the secure registry key and then uses CryptUnprotectData to decrypt the data.\r\n\r\nInetinfo.exe, which runs under the System identity, reads the <processModel /> section. To read the registry keys that store a user name and password for the ASP.NET worker process, the System account must have Read permission to these keys.\r\n\r\nThe ASP.NET worker process (Aspnet_wp.exe) reads the <identity /> and <sessionState /> sections. To read these registry keys, the worker process account must have Read permission to these keys. If content is hosted on a Universal Naming Convention (UNC) share, the account that is used to access the UNC share must have permission to read these keys.\r\n\r\nBy default, the registry keys that Aspnet_setreg.exe creates grant full control to the System, Administrator, and Creator Owner accounts. You can use Regedt32.exe to modify the DACL on the registry key. Make sure that arbitrary users cannot read the registry keys. \r\n\r\n\r\nUse encrypted attributes in the configuration file\r\n\r\nWARNING: If you use Registry Editor incorrectly, you may cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that you can solve problems that result from using Registry Editor incorrectly. Use Registry Editor at your own risk.\r\nNote This tool creates the registry keys under the HKEY_LOCAL_MACHINE subtree. By default, only administrators can create keys under this key. Make sure that you are logged on as an administrator to successfully create these registry keys. \r\n\r\n1. Encrypt the userName and password attributes to be used with the <identity> section. (You can also do this for the other sections that are mentioned in this article). To do this, type the following command at the command line:\r\n c:\\Tools>aspnet_setreg.exe -k:SOFTWARE\\MY_SECURE_APP\\identity\r\n      -u:\"yourdomainname\\username\" -p:\"password\"\r\nThis command encrypts the userName and password attributes, creates registry keys at any location that you specify, and then stores the attributes in those registry keys. This command also generates output that specifies how to change your Web.config or Machine.config file so that ASP.NET will use these keys to read that information from the registry.\r\n\r\nAfter you execute this command, you receive output that is similar to the following: \r\n\r\nPlease edit your configuration to contain the following:\r\nuserName=\"registry:HKLM\\SOFTWARE\\MY_SECURE_APP\\identity\\ASPNET_SETREG,userName\"\r\npassword=\"registry:HKLM\\SOFTWARE\\MY_SECURE_APP\\identity\\ASPNET_SETREG,password\"\r\n\r\nThe DACL on the registry key grants Full Control to System, Administrators, and Creator Owner.\r\n\r\nIf you have encrypted credentials for the <identity/> configuration section, or a connection\r\nstring for the <sessionState/> configuration section, ensure that the process identity has\r\nRead access to the registry key. Furthermore, if you have configured IIS to access content on a\r\nUNC share, the account used to access the share will need Read access to the registry key.\r\nRegedt32.exe may be used to view/modify registry key permissions.\r\n\r\nYou may rename the registry subkey and registry value in order to prevent discovery.\r\n\t\t\t\t\t\r\n \r\n2. Modify the corresponding configuration file to point to these registry keys. If these values must be used in the <identity> section, the resulting <identity> section resembles the following:<identity impersonate=\"true\"\r\nuserName=\"registry:HKLM\\SOFTWARE\\MY_SECURE_APP\\identity\\ASPNET_SETREG,userName\"\r\npassword=\"registry:HKLM\\SOFTWARE\\MY_SECURE_APP\\identity\\ASPNET_SETREG,password\" />\r\n\t\t\t\t\t\r\n \r\n3. Grant Read permissions to the Aspnet_wp.exe process account. For more information about how to change permissions for registry keys, see the \"Use Regedt32.exe to Grant Permissions for the ASP.NET Account on These Registry Keys\" section of this article. \r\n\r\nUse Regedt32.exe to grant permissions for the ASP.NET account on these registry keys\r\nWARNING: If you use Registry Editor incorrectly, you may cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that you can solve problems that result from using Registry Editor incorrectly. Use Registry Editor at your own risk.\r\n1. Click Start, click Run, type regedt32 in the Open box, and then click OK. \r\n2. Click the HKEY_LOCAL_MACHINE\\SOFTWARE\\MY_SECURE_APP\\ subkey. \r\n3. On the Security menu, click Permissions to open the Permissions dialog box. On Microsoft Windows XP or on Windows Server 2003, right-click the registry key, and then click Permissions. \r\n4. Click Add. In the dialog box that opens, type yourservername\\ASPNET(or yourservername\\NetWork Service when using Windows Server 2003 (IIS 6.0)), and then click OK. \r\n5. Make sure that the account that you just added has Read permissions, and then click OK. \r\n6. Close Registry Editor. \r\n","Declares":"","CodeCategory":{"CategoryId":"20","CategoryDescription":".Net - ASP.Net"},"Keywords":["Encrypting Credentials","Encrypting Session State"]},{"RecordId":"771","Title":"T-SQL Script to Import Files Into Table With Blob Field","Description":"T-SQL script that imports a group of files from the file system into a blob field in a table.  The script assumes that file names match a table that already has records with a list of those files.","Code":"\r\nSET NOCOUNT ON\r\n\r\nDECLARE \r\n@testid\tUNIQUEIDENTIFIER,\r\n@origSource\tVARCHAR(250),\r\n@FileType\tVARCHAR(250)\r\n\r\n\r\nDECLARE Files_cursor CURSOR FOR \r\nSELECT  TestID, T.[Name], origSource\r\nFROM tblEDATestProperty P \r\n\tJOIN tblEDAPropertyType T ON P.propertyTypeID = T.propertyTypeID\r\n\r\nOPEN Files_cursor\r\n\r\nFETCH NEXT FROM Files_cursor \r\nINTO @testid, @FileType, @origSource\r\n\r\nWHILE @@FETCH_STATUS = 0\r\nBEGIN\r\n\r\n\tif @FileType = 'Test Guidance' \r\n\t\tBEGIN \r\n\t\t\t\\master..xp_cmdshell 'TEXTCOPY.EXE\r\n\t\t\t/S \r\n\t\t\t /U \r\n\t\t\t /P \r\n\t\t\t /D WorkCenter\r\n\t\t\t /T tblEDATestGuidance\r\n\t\t\t /C TestGuidance\r\n\t\t\t /W \"WHERE TestID=\" & @testid\r\n\t\t\t /F \"c:\\EDA\\Guidance\" & @origSource\r\n\t\t\t /I'\r\n\t\tEND\r\n\tELSE IF @FileType = 'Test Batch' \r\n\t\tBEGIN \r\n\t\t\t\\master..xp_cmdshell 'TEXTCOPY.EXE\r\n\t\t\t/S \r\n\t\t\t /U \r\n\t\t\t /P \r\n\t\t\t /D WorkCenter\r\n\t\t\t /T tblEDABatch\r\n\t\t\t /C BatchFile\r\n\t\t\t /W \"WHERE TestID=\" & @testid\r\n\t\t\t /F \"c:\\EDA\\TestBatch\" & @origSource\r\n\t\t\t /I'\r\n\t\tEND\r\n\tELSE IF @FileType= 'Cue Card' \r\n\t\tBEGIN \r\n\t\t\t\\master..xp_cmdshell 'TEXTCOPY.EXE\r\n\t\t\t/S \r\n\t\t\t /U \r\n\t\t\t /P \r\n\t\t\t /D WorkCenter\r\n\t\t\t /T tblEDACueCard\r\n\t\t\t /C CueCardFile\r\n\t\t\t /W \"WHERE TestID=\" & @testid\r\n\t\t\t /F \"c:\\EDA\\CueCard\" & @origSource\r\n\t\t\t /I'\r\n\t\tEND\r\n        \r\n   -- Get the next file.\r\n   FETCH NEXT FROM Files_cursor \r\n\tINTO @testid, @FileType, @origSource\r\nEND\r\n\r\nCLOSE Files_cursor\r\nDEALLOCATE Files_cursor\r\nGO\r\n","Declares":"","CodeCategory":{"CategoryId":"6","CategoryDescription":"T-SQL"},"Keywords":["Import File"]},{"RecordId":"772","Title":"Save and Retrieve a File Into and From a Blob","Description":"Demonstrates how to save a binay file into a blob field and then retrieve it","Code":"//---------------------------------------------------------------------------------\r\n// Saves a binary file to a blob field (Assumes that the file is uploaded from an HtmlInputFile contol that is contained on a webform)\r\n//---------------------------------------------------------------------------------\r\n\r\nprivate void saveFileToDB(string strFileNameIn, System.Web.UI.HtmlControls.HtmlInputFile File1In) \r\n{\r\n\tstring strThisUser = HttpContext.Current.User.Identity.Name.ToLower();\r\n\r\n\tstring dbConnectString = yourSQLServerConnectionString;\r\n\tSqlConnection oConn = new SqlConnection(dbConnectString);\r\n\toConn.Open();\r\n\r\n\tint intFileLen = (int) File1In.PostedFile.InputStream.Length;\r\n\tbyte[] bytFileStream = new byte[intFileLen];\r\n\tFile1In.PostedFile.InputStream.Read(bytFileStream,0,intFileLen);\r\n\r\n\tSqlCommand oCmd = new SqlCommand(\"INSERT INTO tmpAttachment (FileName, UserName, FileData, FileSize) values(@FileName, @UserName, @FileData, @FileSize)\",oConn);\r\n\toCmd.Parameters.Add(\"@FileName\", System.Data.SqlDbType.VarChar,200);\r\n\toCmd.Parameters.Add(\"@UserName\", System.Data.SqlDbType.VarChar,200);\r\n\toCmd.Parameters.Add(\"@FileData\", System.Data.SqlDbType.Binary);\r\n\toCmd.Parameters.Add(\"@FileSize\", System.Data.SqlDbType.Int);\r\n\toCmd.Parameters[\"@FileName\"].Value = strFileNameIn;\r\n\toCmd.Parameters[\"@UserName\"].Value = strThisUser;\r\n\toCmd.Parameters[\"@FileData\"].Value = bytFileStream;\r\n\toCmd.Parameters[\"@FileSize\"].Value = intFileLen;\r\n\toCmd.ExecuteNonQuery();\r\n\toConn.Close();\r\n\r\n}\r\n\r\n\r\n\r\n//---------------------------------------------------------------------------------\r\n// Retrieves a blob field from a database table\r\n//---------------------------------------------------------------------------------\r\n\r\nSqlConnection oConn = new SqlConnection(_strDBConnectString);\r\noConn.Open();\r\nSqlCommand oCmd = new SqlCommand();\r\noCmd.Connection = oConn;\r\n\r\nSqlDataReader oRS;\r\n\r\nstring strThisFileName = \"someFileName.doc\"\r\noCmd.CommandText = \"SELECT FileData, FileSize FROM tmpAttachment WHERE FileName = '\" + strThisFileName + \"' AND UserName = '\" + _strThisUser + \"'\";\r\noRS = oCmd.ExecuteReader();\r\nif (oRS.Read()) \r\n{\r\n\tint intFileSize = int.Parse(oRS[\"FileSize\"].ToString());\r\n\tbyte[] oFileContents = new byte[intFileSize];\r\n\toFileContents = (byte[]) oRS[\"FileData\"];\r\n\r\n\t// oFileContents now contains the file\r\n\r\n}\r\noRS.Close();","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Binary File","Blob"]},{"RecordId":"773","Title":"Insert Data Into an Excel Workbook and Stream It to the Browser","Description":"Insert Data Into an Excel Workbook and Stream It to the Browser","Code":"// Stream the data from an Excel Spreadsheet's workbook\r\nMemoryStream objMemStream = CreateExcel()\r\n\r\n//Set Content Type to Excel.\r\nResponse.ContentType = \"application/msexcel\";\r\nResponse.AppendHeader(\"Content-Disposition\", \"attachment; filename= someFile.xls\" );\r\n\r\n// Write the stream\r\nobjMemStream.WriteTo(Response.OutputStream);           \r\n\r\n//--------------------------------------------------------------------------------------------------\r\n\r\npublic MemoryStream CreateExcel( )\r\n{\r\n\t// Assumes that a spreadsheet named \"someSpreadsheet.xls\" exists as a template to be written to.\r\n\tstring filename = \"someSpreadsheet.xls\";\r\n\tstring  sConnectionString = @\"Provider=Microsoft.Jet.OLEDB.4.0; Data Source=\" + filename +\";Extended Properties='Excel 8.0;'\";\r\n\tSystem.Data.OleDb.OleDbConnection objConn = new System.Data.OleDb.OleDbConnection(sConnectionString);\r\n\tobjConn.Open();\r\n\t\r\n\tSystem.Data.OleDb.OleDbCommand objCmd = new System.Data.OleDb.OleDbCommand();\r\n\tobjCmd.Connection = objConn;\r\n\r\n\tint = 0;\r\n\t\r\n\tforeach (DataRow row in dtSchemesTemp.Rows)\r\n\t{\r\n\t\ti=i+1;\r\n\t\t \r\n\t\tstrFRF = row[\"FraudRiskFactor\"].ToString().Replace(\"'\",\"\");\r\n\t\tstrComment = row[\"Comment\"].ToString().Replace(\"'\",\"\");\r\n\r\n\t\tstrAuditResponse = row[\"AuditResponse\"].ToString().Replace(\"'\",\"\");\r\n\t\tstrFraudRisk = row[\"FraudRisk\"].ToString().Replace(\"'\",\"\");\r\n\t\t//strNew = row[\"AuditResponse\"].ToString().Replace(\"'\",\"\");\r\n\t\tstrDirection = row[\"Direction\"].ToString();\r\n\t\tstrNature = row[\"Nature\"].ToString();\r\n\t\tstrAccountType = row[\"AccountType\"].ToString();\r\n\t\tstrPotentialError = row[\"PotentialError\"].ToString();\r\n\t\tFraudScheme = row[\"FraudScheme\"].ToString();\r\n\t\r\n\t\tobjCmd.CommandText = @\"Insert into [Worksheet1$] (F1,F2,F3,F4,F5,F6,F7,F8, F9, F10) values ('\" + i + \"','\" + strComment + \"','\" + strFRF + \"','\" + strFraudRisk + \"','\" + strNature + \"','\" + strAccountType + \"','\" + strPotentialError + \"','\" + strDirection + \"','\" + FraudScheme +\"','\" + strAuditResponse +\"')\";\r\n\t\tobjCmd.ExecuteNonQuery();\r\n\t}\t\r\n\tobjConn.Close();\r\n\t\r\n\t// Return the file as a stream and delete it!\r\n\tFileStream fs = new FileStream(filename,System.IO.FileMode.Open);\r\n\tbyte[] buffer = new byte[fs.Length];\r\n\tfs.Read(buffer, 0, (int)fs.Length);\r\n\tMemoryStream ms = new MemoryStream(buffer);\r\n\tfs.Close();\r\n\t\r\n\tobjConn.Close();\r\n\t\r\n\tFile.Delete(filename);\r\n\t\r\n\treturn ms;\r\n}\r\n","Declares":"","CodeCategory":{"CategoryId":"20","CategoryDescription":".Net - ASP.Net"},"Keywords":["Excel Export","Populate Excel"]},{"RecordId":"777","Title":"EM Dashes","Description":"This article explains the difference between hyphens, en dashes and em dashes. \r\n","Code":"It is one of the little-known secrets of good writing that dashes come in two different sizes. The table below compares a hyphen with dashes and shows how to type them from within Microsoft Word. (Other programs may or may not support dashes.) \r\n\r\nName      Keys within MS Word\r\nhyphen   minus or numeric-minus\r\nen dash  Ctrl + numeric-minus\r\nem dash  Ctrl + Alt + numeric-minus\r\n \r\nThe numeric minus key is the minus key at the top-right corner of your keyboards numeric keypad. \r\n\r\nThe en dash is the width of a letter n; i.e. about half-again the width of a hyphen. The em dash is the width of a letter m; i.e. about twice the width of a hyphen. \r\n\r\nWhen to use hyphens\r\nHyphens are used within some names (e.g. Crichton-Browne), to separate some prefixes from a root word (e.g. pre-empt), and in compound adjectives (e.g. role-playing game). \r\n\r\nWhen to use en dashes\r\nhe most common use of the en dash is to indicate a span. For example: See lines 24-29 \r\nOpen Monday-Friday \r\nAnother use of the en dash is to act as a minus sign. (A hyphen is too narrow.) For example: \r\n10 - 3 = 7 \r\nNote:  When used to indicate a span the en dash is generally not surrounded with spaces. When used as a minus sign it is. \r\n\r\nWhen to use em dashes\r\nThe most common use of em dashes is instead of commas when setting off a parenthetical comment. For example: \r\nItem 12, the broken CPU, is to be repaired today. \r\nItem 12-the broken CPU-is to be repaired today. \r\nNote:  Some editors surround em dashes with spaces, others do not. There is no clear convention, so you are free to choose whichever you prefer. Be consistent, though. \r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"7","CategoryDescription":"Misc"},"Keywords":["EM Dash"]},{"RecordId":"778","Title":"Combine Multiple Table Rows into a Single String","Description":"Demonstrates how to combine multiple rows from a table in a single string to be returned.","Code":"DECLARE @TitleFragments varchar(4000)\r\nDECLARE @delimiter char\r\n\r\nSET @delimiter = '|'\r\n\r\nSELECT @TitleFragments = COALESCE(@TitleFragments + @delimiter, '') + TitleFragment FROM dbo.RoleTitles \r\nWHERE roleid = 2\r\n\r\n--PRINT  @TitleFragments \r\nSELECT @TitleFragments AS [TitleFragments]","Declares":"","CodeCategory":{"CategoryId":"6","CategoryDescription":"T-SQL"},"Keywords":["Combine Table Rows","Return String From Rows","Concatenate Columns To String"]},{"RecordId":"779","Title":"Convert Collection of Objects to DataTable","Description":"Demonstrates how to convert a collection of objects into a DataTable","Code":"using System;\r\nusing System.Data;\r\nusing System.Diagnostics;\r\nusing System.Reflection;\r\n\r\nnamespace YourNamespace\r\n{\r\n    public class ObjectConverter\r\n    {\r\n        public ObjectConverter()\r\n        {\r\n        }\r\n\r\n        public DataTable ConvertToDataTable(object[] objectArray, bool UseNamedColumns)\r\n        {\r\n            Debug.Assert(null != objectArray, \"objectArray is null\", \"An empty dataset will be returned.\");\r\n            Debug.Assert(0 < objectArray.Length, \"objectArray length is less is 0\", \"An empty dataset will be returned.\");\r\n\r\n            if (null == objectArray)\r\n            {\r\n                return new DataTable();\r\n            }\r\n\r\n            if (0 == objectArray.Length)\r\n            {\r\n                return new DataTable();\r\n            }\r\n\r\n            DataTable outDataTable = new DataTable();\r\n\r\n            int counter = -1;\r\n            object propValue;\r\n            object firstObject = objectArray[0];\r\n            PropertyInfo[] firstObjectPropertyInfo = firstObject.GetType().GetProperties();\r\n            object[] propValues = new object[firstObjectPropertyInfo.Length];\r\n            \r\n            foreach (PropertyInfo firstObjectProperty in firstObjectPropertyInfo)\r\n            {\r\n                if (UseNamedColumns)\r\n                {\r\n                    outDataTable.Columns.Add(firstObjectProperty.Name, firstObjectProperty.PropertyType);\r\n                }\r\n                else\r\n                {\r\n                    counter++;\r\n                    outDataTable.Columns.Add(counter.ToString(), firstObjectProperty.PropertyType);\r\n                }\r\n            }\r\n                \r\n            counter = -1;\r\n\r\n            foreach (object currentObject in objectArray)\r\n            {\r\n                PropertyInfo[] currentObjectPropertyInfo = currentObject.GetType().GetProperties();\r\n\r\n                foreach (PropertyInfo currentObjectProperty in currentObjectPropertyInfo)\r\n                {\r\n                    counter++;\r\n                    propValue = currentObjectProperty.GetValue(currentObject, null);\r\n\r\n                    if (null != propValue)\r\n                    {\r\n                        propValues[counter] = Convert.ChangeType(propValue, currentObjectProperty.PropertyType);\r\n                    }\r\n                    else\r\n                    {\r\n                        propValues[counter] = null;\r\n                    }\r\n                }\r\n\r\n                outDataTable.Rows.Add(propValues);\r\n                counter = -1;\r\n            }\r\n\r\n            return outDataTable;\r\n        }\r\n    }\r\n}\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Collection to DataTable"]},{"RecordId":"780","Title":"Deserialize an XML Document into an Object","Description":"Demonstrates how to take an XML document, and deserialize it to rehydrate an object","Code":"string xmlStuff = TaxReturnXMLDoc.OuterXml;\r\nTextReader reader = new StreamReader(@\"C:\\temp\\Efile-SerializedTaxReturnObject-Clean.xml\");\r\nXmlSerializer serializer = new XmlSerializer(typeof(TaxReturnEntity));\r\nTaxReturnEntity tre = (TaxReturnEntity)serializer.Deserialize(reader);\r\nreader.Close();\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Deserialize","XMLDocument","Serialize"]},{"RecordId":"781","Title":"Serialize an Object into XML","Description":"Demonstrates how to serialize an object into XML and load that XML into an XML Document","Code":"// Create a BizTalk TaxReturn object\r\nBizTalkNotifyEnterpriseWS.TaxReturnEntity taxReturn = new BizTalkNotifyEnterpriseWS.TaxReturnEntity();\r\ntaxReturn.EIN = \"11-2222222\";\r\ntaxReturn.TaxReturnName = \"1120\";\r\ntaxReturn.YearEndDate = System.DateTime.Now;\r\n\r\n// Serialize the BizTalk TaxReturn object into a string\r\nStringWriter sw = new StringWriter();\r\nXmlSerializer xmls = new XmlSerializer(typeof( BizTalkNotifyEnterpriseWS.TaxReturnEntity));\r\nxmls.Serialize(sw,taxReturn);\r\nstring ssXML = sw.ToString();\r\n\r\n// Load the string into an XMLDocument\r\nXmlDocument TaxReturnXML = new XmlDocument();\r\nTaxReturnXML.LoadXml(ssXML);\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Serialize","XMLDocument"]},{"RecordId":"782","Title":"4181 - Installing the SSL Certificate","Description":"You may receive a \"Trusted Connection\" or \"Underlying connection closed\" \r\nerror trying to access the webservice on 4181 from within your .NET code.","Code":"Installing the 4181 Certificate\r\n\r\nYou may receive a \"Trusted Connection\" or \"Underlying connection closed\" \r\nerror trying to access the webservice on 4181 from within your .NET code.  \r\n\r\nThe following steps should resolved this issue:\r\n\r\n 1.  Navigate to http://usher7310/certsrv/\r\n 2.  Click on \"Download a CA certificate, certificate chain, or CRL\"\r\n 3.  Click on \"install this CS certificate chain\"\r\n 4.  Click \"Yes\" when asked if you trust the source.  The cert should be installed.\r\n 5.  Back in Windows, click Start->Run, and execute MMC.exe\r\n 6.  Add two \"Certificates\" snap-ins:  1 for the current user, 1 for the local machine.\r\n 7.  On the \"Certificates - Current User\" snap-in, browse to Trusted Root Certfication Authorities->Certificates, and find the cert for usher7310 in the list.\r\n 8.  Right click on the usher7310 cert, and select Copy\r\n 9.  On the \"Certificates - Local Machine\" snap-in, browse to Trusted Root Certfication Authorities->Certificates\r\n10.  Right click on the Certificates folder, and select Paste\r\n\r\n\r\nYou can install the root CA from http://usher7310/certsrv/ (click on download a CA certificate, then install this CA chain), or you can use http:// for the service - I don't think that usher4181 requires SSL.\r\n\r\nAlso, in QA and production, you should use http://localhost:88/ for the service.","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["4181","Underlying Connection Closed"]},{"RecordId":"783","Title":"Get Path of Executing Assembly","Description":"Works on both web apps and WinForms apps - Gets path of an executing assembly","Code":"string strPath = \r\n        System.IO.Path.GetDirectoryName(\r\n                      System.Reflection.Assembly.GetExecutingAssembly().CodeBase);\r\n\r\n\r\nThe return value has \"file:\\\" at the beginning:\r\n    file:\\C:\\Projects\\SomeFolder1\\SomeFolder2\\bin\\Debug\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["App.Path"]},{"RecordId":"784","Title":"AppScan - Code to Validate Querystring and Form Fields","Description":"Code to pass an AppScan","Code":"function isValidChars(strValue)\r\n\r\n\tif InStr(strValue, \"%\") <> 0 or _\r\n\t\tInStr(strValue, \"&\") <> 0 or _\r\n\t\tInStr(strValue, \"*\") <> 0 or _\r\n\t\tInStr(strValue, \";\") <> 0 or _\r\n\t\tInStr(strValue, \":\") <> 0 or _\r\n\t\tInStr(strValue, \"\\\") <> 0 or _\r\n\t\tInStr(strValue, \"/\") <> 0 or _\r\n\t\tInStr(strValue, \"(\") <> 0 or _\r\n\t\tInStr(strValue, \")\") <> 0 or _\r\n\t\tInStr(strValue, \"+\") <> 0 or _\r\n\t\tInStr(strValue, \"''\") <> 0 or _\r\n\t\tInStr(strValue, \"--\") <> 0 or _\r\n\t\tInStr(strValue, \"<\") <> 0 or _\r\n\t\tInStr(strValue, \">\") <> 0 then\r\n\t\t\tisValidChars = false\r\n\telse\r\n\t\tisValidChars = true\r\n\tend if\r\nend function\r\n\r\nsub ValidateQueryString\r\n\r\n\tdim i\r\n\tIf Request.QueryString.Count > 0 then\r\n\t\tfor i = 1 to Request.QueryString.Count\r\n\t\t\tif isValidChars(Request.QueryString(i)) = false then\r\n\t\t\t\tResponse.Redirect (\"error.asp\")\r\n\t\t\t\texit for\r\n\t\t\tend if\t\t\r\n\t\tnext\r\n\tend if\r\n\t\r\n\tdim strQ \r\n\tstrQ = Request.QueryString\r\n\tif instr(strQ,\"<\") then Response.Redirect (\"error.asp\")\r\n\tif instr(strQ,\"&lt;\") then Response.Redirect (\"error.asp\")\r\n\tif instr(strQ,\"&lt%3b\") then Response.Redirect (\"error.asp\")\r\n\tif instr(strQ,\"%3c\") then Response.Redirect (\"error.asp\")\r\n\tif instr(strQ,\"%3e\") then Response.Redirect (\"error.asp\")\r\n\tif instr(strQ,\">\") then Response.Redirect (\"error.asp\")\r\n\tif instr(strQ,\"&gt;\") then Response.Redirect (\"error.asp\")\r\n\tif instr(strQ,\"&gt%3b\") then Response.Redirect (\"error.asp\")\r\n\r\nend sub\r\n\r\nsub ValidatePost\r\n\tdim i\r\n\tIf Request.form.Count > 0 then\r\n\t\tfor i = 1 to Request.form.Count\r\n\t\t\tif isValidChars(Request.form(i)) = false then\r\n\t\t\t\tResponse.Redirect (\"error.asp\")\r\n\t\t\t\texit for\r\n\t\t\tend if\t\t\r\n\t\tnext\r\n\tend if\r\nend sub\r\n","Declares":"","CodeCategory":{"CategoryId":"7","CategoryDescription":"Misc"},"Keywords":["AppScan"]},{"RecordId":"785","Title":"Removing UTF Encoding Characters from XML","Description":"The Microsoft .Net XmlDocument object inserts Byte Order Mark characters at the begninning of the XML file.  This examples shows how to remove them.","Code":"If an XML document does not have XML declaration line or the encoding attribute, the workaround in this case is to look for very first bytes in the file. These first bytes are known as Byte Order Mark or BOM. ANSI formatted text files does not contain any BOM bytes; UTF-8 format files contain EF BB BF as the first three bytes and Unicode saved files contain FF FE or FE FF (big endian) as the first two bytes.  The BOM is optional for UTF-8. \r\n\r\nFirst bytes\t\t\tEncoding assumed\r\n------------------------------------------\t---------------------------------------\r\nEF BB BF \t\tUTF-8                                                                                             \r\nFE FF \t\t\tUTF-16 (big-endian)                                                        \r\nFF FE \t\t\tUTF-16 (little-endian)                                                      \r\n00 00 FE FF \t\tUTF-32 (big-endian)                                                                        \r\nFF FE 00 00 \t\tUTF-32 (little-endian)                                                                      \r\nNone of the above \tUTF-8                                                                                                     \r\n                                                                                                                            \r\nNote that the encoding of an XML document is never iso-8859-1 by default.  \r\n\r\n\r\n\r\nThis is the traditional way of loading, updating, and saving an XML file.  It will automatically insert the Byte Order Mark (BOM) at the beginning of the file.  Some editors (UltraEdit) WILL NOT show the BOM (even in binary mode).\r\n\r\nXmlDocument oXml = new XmlDocument();\r\nstring strFilenameIn = @\"manifest\\file.xml\";\r\nstring strFilenameOut = @\"manifest\\manifest.xml\";\r\noXml.PreserveWhitespace = true;\r\noXml.Load(strFilenameIn);\r\nstring strXPathQuery = \"//*[local-name()='SubmissionId']\";\r\nXmlNode oNode = oXml.SelectSingleNode(strXPathQuery);\r\nif (oNode != null)\r\n{\r\n\toNode.InnerText = _submissionID;\r\n}\r\noXml.Save(strFilenameOut);\r\n\r\n---------------------------------------------------------------------------------\r\nSample XML (note that the Byte Order Mark is not shown, but it \r\nwould exist prior to the <?xml version=\"1.0\" encoding=\"UTF-8\"?>)\r\n---------------------------------------------------------------------------------\r\n\r\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<SomeXml>\r\n ...\r\n</SomeXml>\r\n\r\n\r\n\r\n\r\n\r\n\r\nThis will remove the Byte Order Mark, BUT it will not keep the \"encoding='UTF-8'\" prolog in the XML.\r\n\r\nXmlDocument oXml = new XmlDocument();\r\nstring strFilenameIn = @\"manifest\\file.xml\";\r\nstring strFilenameOut = @\"manifest\\manifest.xml\";\r\noXml.PreserveWhitespace = true;\r\noXml.Load(strFilenameIn);\r\nstring strXPathQuery = \"//*[local-name()='SubmissionId']\";\r\nXmlNode oNode = oXml.SelectSingleNode(strXPathQuery);\r\nif (oNode != null)\r\n{\r\n\toNode.InnerText = _submissionID;\r\n}\r\n\r\nXmlTextWriter oWtr = new XmlTextWriter( strFilenameOut, null );\r\noWtr.Formatting = Formatting.Indented;\r\noXml.Save(oWtr);\r\noWtr.Close();\r\n\r\n---------------------------------------------------------------------------------\r\nSample XML (note that the encoding=\"UTF-8\"?> is missing, but the Byte Order Mark\r\nis not included in the output).\r\n---------------------------------------------------------------------------------\r\n\r\n<?xml version=\"1.0\">\r\n\r\n<SomeXml>\r\n ...\r\n</SomeXml>\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["UTF-8","Byte Order Mark","Xml"]},{"RecordId":"786","Title":"Read the Registry in .Net","Description":"Demonstrates how to read the registry in .Net","Code":"using Microsoft.Win32;\r\n\r\nRegistryKey oKey = Registry.LocalMachine.OpenSubKey(@\"SOFTWARE\\US Portal\\SQL Settings\\Independence\", false);\r\n\r\nstring strKeyVal = \"\";\r\nstring strFullConn = \"\";\r\n\r\nstrKeyVal = oKey.GetValue(\"ConnString\").ToString();\r\nstrFullConn = strKeyVal;\r\nApplication[\"ConnString\"] = strKeyVal;\r\n\r\nstrKeyVal = oKey.GetValue(\"RuntimeUsername\").ToString();\r\nApplication[\"RuntimeUsername\"] = strKeyVal;\r\nstrFullConn += \" User Id=\" + strKeyVal + \"; \";\r\n\r\nstrKeyVal = oKey.GetValue(\"RuntimePassword\").ToString();\r\nApplication[\"RuntimePassword\"] = strKeyVal;\r\nstrFullConn += \" Password=\" + strKeyVal + \"; \";\r\n\r\noKey  = null;\r\n\r\nApplication[\"FullConnString\"] = strFullConn.Trim();","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Registry"]},{"RecordId":"787","Title":"Enterprise Library - Circumventing dataconfiguration.config","Description":"Demonstrates how to use Microsoft Enterprise Library, but instead of storing the connection information in the dataconfiguration.config file, it can be stored elsewhere.","Code":"-------------------------------------------------------------- \r\nThis constructs the E/L Database object and gets it ready for use.\r\n-------------------------------------------------------------- \r\n\r\npublic Database CreateIndependenceDatabase()  \r\n{\r\n \r\n   string strU = Application[\"RuntimeUsername\"].ToString();\r\n   string strP = Application[\"RuntimePassword\"].ToString();\r\n \r\n   DatabaseSettings settings = new DatabaseSettings(); \r\n \r\n   DatabaseTypeData typeData=new DatabaseTypeData(); \r\n   typeData.Name=\"Sql Server\"; \r\n   typeData.TypeName=\"Microsoft.Practices.EnterpriseLibrary.Data.Sql.SqlDatabase, Microsoft.Practices.EnterpriseLibrary.Data, Version=1.0.0.1, Culture=neutral, PublicKeyToken=7d9454662d4acd98\"; \r\n \r\n   InstanceData instanceData = new InstanceData(); \r\n   instanceData.ConnectionString=\"IndependenceDB Connection String\"; \r\n   instanceData.DatabaseTypeName=\"Sql Server\"; \r\n   instanceData.Name=\"SomeConnDB\"; \r\n   \r\n   ConnectionStringData connStringData = new ConnectionStringData();\r\n   connStringData.Parameters.Add(new ParameterData(\"user id\", strU));\r\n   connStringData.Parameters.Add(new ParameterData(\"password\", strP));\r\n   connStringData.Parameters.Add(new ParameterData(\"server\", \"YourSQLServer\"));\r\n   connStringData.Parameters.Add(new ParameterData(\"database\", \"YourDatabase\"));\r\n   connStringData.Parameters.Add(new ParameterData(\"Integrated Security\", \"false\"));\r\n   connStringData.Name=\"SomeDB Connection String\"; \r\n \r\n   settings.DatabaseTypes.Add(typeData); \r\n   settings.Instances.Add(instanceData); \r\n   settings.ConnectionStrings.Add(connStringData); \r\n \r\n   ConfigurationDictionary configDictionary = new ConfigurationDictionary(); \r\n   configDictionary.Add(\"dataConfiguration\",settings); \r\n   ConfigurationContext context = ConfigurationManager.CreateContext(configDictionary); \r\n \r\n   Database db = new DatabaseProviderFactory(context).CreateDatabase(\"SomeConnDB\");\r\n   return db; \r\n \r\n}\r\n\r\n\r\n-------------------------------------------------------------- \r\nPages that call into E/L to access data use this.  The only thing that is different is how the Database object is created.\r\n-------------------------------------------------------------- \r\n  \r\n    Database db = CreateIndependenceDatabase();\r\n    DBCommandWrapper commandWrapper = db.GetStoredProcCommandWrapper(\"spAdmin_GetSurvey\");\r\n    commandWrapper.AddInParameter(\"@fetch\", DbType.String, \"filtered\");\r\n \r\n \r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Enterprise Library"]},{"RecordId":"788","Title":"Code to Map a Drive Letter (and Pass Credentials)","Description":"Map a drive letter to a network share","Code":"----------------------------------------------------------------------------------------------------\r\n USAGE\r\n----------------------------------------------------------------------------------------------------\r\n\r\ncNetworkDrive oNetDrive = new cNetworkDrive();\r\n\r\n//Map drive with current user credentials\r\noNetDrive.LocalDrive = \"m:\";\r\noNetDrive.ShareName = \"\\\\ComputerName\\Share1\"\r\noNetDrive.MapDrive();\r\n\r\n//Map drive with specified user credentials\r\noNetDrive.LocalDrive = \"m:\";\r\noNetDrive.ShareName = \"\\\\ComputerName\\Share1\"\r\noNetDrive.MapDrive(\"Bob_Username\",\"Bob_Password\");\r\n\r\n//Map drive with and prompt user for credentials\r\noNetDrive.LocalDrive = \"m:\";\r\noNetDrive.ShareName = \"\\\\ComputerName\\Share1\"\r\noNetDrive.PromptForCredentials = true;\r\noNetDrive.MapDrive();\r\n\r\n//Map drive using a persistent connection\r\noNetDrive.LocalDrive = \"m:\";\r\noNetDrive.Persistent = true;\r\noNetDrive.SaveCredentials = true;\r\noNetDrive.ShareName = \"\\\\ComputerName\\Share1\"\r\noNetDrive.MapDrive(\"Bob_Username\",\"Bob_Password\");\r\n\r\n//Unmap a network connection\r\noNetDrive.LocalDrive = \"m:\";\r\noNetDrive.ShareName = \"\\\\ComputerName\\Share1\"\r\noNetDrive.UnMapDrive();\r\n\r\n//Unmap a network connection ignoring network related errors\r\noNetDrive.LocalDrive = \"m:\";\r\noNetDrive.Force = true;\r\noNetDrive.ShareName = \"\\\\ComputerName\\Share1\"\r\noNetDrive.UnMapDrive();\r\n\r\n//Display windows connection dialog\r\noNetDrive.ShowConnectDialog(this);\r\n\r\n//Display windows disconnection dialog\r\noNetDrive.ShowDisconnectDialog(this);\r\n\r\n//Restore all persistent connections\r\noNetDrive.RestoreDrives();\r\n\r\n\r\n----------------------------------------------------------------------------------------------------\r\nTHE CODE\r\n----------------------------------------------------------------------------------------------------\r\n\r\n/*======================================================\r\nAejW.com - Network Drives\r\nBuild:             0015\r\nAuthor:            Adam ej Woods\r\nModified:          14/05/2004\r\nOwnership:         Copyright (c)2004 Adam ej Woods\r\nSource:            http://www.aejw.com/\r\nEULA:              In no way can this class be disturbed without my permission, this means\r\n                         reposting on a web site, cdrom, or any other form of media. The code can be\r\n                         used for commercial or personal purposes, as long as credit is given to the\r\n                         author. The header (this information) can not be modified or removed. \r\n                         www.CodeProject.com has permission to distribute this class.\r\n=========================================================*/\r\nusing System;\r\nusing System.Windows.Forms;\r\nusing System.Runtime.InteropServices;\r\n\r\nnamespace aejw.Network\r\n{\r\n\t/// <summary>\r\n\t/// AejW.com - Network Drive Interface\r\n\t/// </summary>\r\n\tpublic class NetworkDrive\r\n\t{\r\n\r\n\t\t#region API\r\n\t\t[DllImport(\"mpr.dll\")] private static extern int WNetAddConnection2A(ref structNetResource pstNetRes, string psPassword, string psUsername, int piFlags);\r\n\t\t[DllImport(\"mpr.dll\")] private static extern int WNetCancelConnection2A(string psName, int piFlags, int pfForce);\r\n\t\t[DllImport(\"mpr.dll\")] private static extern int WNetConnectionDialog(int phWnd, int piType);\r\n\t\t[DllImport(\"mpr.dll\")] private static extern int WNetDisconnectDialog(int phWnd, int piType);\r\n\t\t[DllImport(\"mpr.dll\")] private static extern int WNetRestoreConnectionW(int phWnd, string psLocalDrive);\r\n\r\n\t\t[StructLayout(LayoutKind.Sequential)]\r\n\t\t\tprivate struct structNetResource\r\n\t\t{\r\n\t\t\tpublic int iScope;\r\n\t\t\tpublic int iType;\r\n\t\t\tpublic int iDisplayType;\r\n\t\t\tpublic int iUsage;\r\n\t\t\tpublic string sLocalName;\r\n\t\t\tpublic string sRemoteName;\r\n\t\t\tpublic string sComment;\r\n\t\t\tpublic string sProvider;\r\n\t\t}\r\n\t\t\r\n\t\tprivate const int RESOURCETYPE_DISK = 0x1;\r\n\t\t\r\n\t\t//Standard\t\r\n\t\tprivate const int CONNECT_INTERACTIVE = 0x00000008;\r\n\t\tprivate const int CONNECT_PROMPT = 0x00000010;\r\n\t\tprivate const int CONNECT_UPDATE_PROFILE = 0x00000001;\r\n\t\t//IE4+\r\n\t\tprivate const int CONNECT_REDIRECT = 0x00000080;\r\n\t\t//NT5 only\r\n\t\tprivate const int CONNECT_COMMANDLINE = 0x00000800;\r\n\t\tprivate const int CONNECT_CMD_SAVECRED = 0x00001000;\r\n\t\t\r\n\t\t#endregion\r\n\r\n\t\t#region Propertys and options\r\n\t\tprivate bool lf_SaveCredentials = false;\r\n\t\t/// <summary>\r\n\t\t/// Option to save credentials are reconnection...\r\n\t\t/// </summary>\r\n\t\tpublic bool SaveCredentials\r\n\t\t{\r\n\t\t\tget{return(lf_SaveCredentials);}\r\n\t\t\tset{lf_SaveCredentials=value;}\r\n\t\t}\r\n\t\tprivate bool lf_Persistent = false;\r\n\t\t/// <summary>\r\n\t\t/// Option to reconnect drive after log off / reboot ...\r\n\t\t/// </summary>\r\n\t\tpublic bool Persistent\r\n\t\t{\r\n\t\t\tget{return(lf_Persistent);}\r\n\t\t\tset{lf_Persistent=value;}\r\n\t\t}\r\n\t\tprivate bool lf_Force = false;\r\n\t\t/// <summary>\r\n\t\t/// Option to force connection if drive is already mapped...\r\n\t\t/// or force disconnection if network path is not responding...\r\n\t\t/// </summary>\r\n\t\tpublic bool Force\r\n\t\t{\r\n\t\t\tget{return(lf_Force);}\r\n\t\t\tset{lf_Force=value;}\r\n\t\t}\r\n\t\tprivate bool ls_PromptForCredentials = false;\r\n\t\t/// <summary>\r\n\t\t/// Option to prompt for user credintals when mapping a drive\r\n\t\t/// </summary>\r\n\t\tpublic bool PromptForCredentials\r\n\t\t{\r\n\t\t\tget{return(ls_PromptForCredentials);}\r\n\t\t\tset{ls_PromptForCredentials=value;}\r\n\t\t}\r\n\r\n\t\tprivate string ls_Drive = \"s:\";\r\n\t\t/// <summary>\r\n\t\t/// Drive to be used in mapping / unmapping...\r\n\t\t/// </summary>\r\n\t\tpublic string LocalDrive\r\n\t\t{\r\n\t\t\tget{return(ls_Drive);}\r\n\t\t\tset\r\n\t\t\t{\r\n\t\t\t\tif(value.Length>=1)\r\n\t\t\t\t{\r\n\t\t\t\t\tls_Drive=value.Substring(0,1)+\":\";\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\tls_Drive=\"\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tprivate string ls_ShareName = \"\\\\\\\\Computer\\\\C$\";\r\n\t\t/// <summary>\r\n\t\t/// Share address to map drive to.\r\n\t\t/// </summary>\r\n\t\tpublic string ShareName\r\n\t\t{\r\n\t\t\tget{return(ls_ShareName);}\r\n\t\t\tset{ls_ShareName=value;}\r\n\t\t}\r\n\t\t#endregion\r\n\r\n\t\t#region Function mapping\r\n\t\t/// <summary>\r\n\t\t/// Map network drive\r\n\t\t/// </summary>\r\n\t\tpublic void MapDrive(){zMapDrive(null, null);}\r\n\t\t/// <summary>\r\n\t\t/// Map network drive (using supplied Password)\r\n\t\t/// </summary>\r\n\t\tpublic void MapDrive(string Password){zMapDrive(null, Password);}\r\n\t\t/// <summary>\r\n\t\t/// Map network drive (using supplied Username and Password)\r\n\t\t/// </summary>\r\n\t\tpublic void MapDrive(string Username, string Password){zMapDrive(Username, Password);}\r\n\t\t/// <summary>\r\n\t\t/// Unmap network drive\r\n\t\t/// </summary>\r\n\t\tpublic void UnMapDrive(){zUnMapDrive(this.lf_Force);}\r\n\t\t/// <summary>\r\n\t\t/// Check / restore persistent network drive\r\n\t\t/// </summary>\r\n\t\tpublic void RestoreDrives(){zRestoreDrive();}\r\n\t\t/// <summary>\r\n\t\t/// Display windows dialog for mapping a network drive\r\n\t\t/// </summary>\r\n\t\tpublic void ShowConnectDialog(Form ParentForm){zDisplayDialog(ParentForm,1);}\r\n\t\t/// <summary>\r\n\t\t/// Display windows dialog for disconnecting a network drive\r\n\t\t/// </summary>\r\n\t\tpublic void ShowDisconnectDialog(Form ParentForm){zDisplayDialog(ParentForm,2);}\r\n\r\n\r\n\t\t#endregion\r\n\r\n\t\t#region Core functions\r\n\r\n\t\t// Map network drive\r\n\t\tprivate void zMapDrive(string psUsername, string psPassword)\r\n\t\t{\r\n\t\t\t//create struct data\r\n\t\t\tstructNetResource stNetRes = new structNetResource();\t\t\t\r\n\t\t\tstNetRes.iScope=2;\r\n\t\t\tstNetRes.iType=RESOURCETYPE_DISK;\r\n\t\t\tstNetRes.iDisplayType=3;\r\n\t\t\tstNetRes.iUsage=1;\r\n\t\t\tstNetRes.sRemoteName=ls_ShareName;\r\n\t\t\tstNetRes.sLocalName=ls_Drive;\tNOTE:  Comment this line out and you can connect to a share using the UNC path instead of a drive letter\t\t\r\n\t\t\t//prepare params\r\n\t\t\tint iFlags=0;\r\n\t\t\tif(lf_SaveCredentials){iFlags+=CONNECT_CMD_SAVECRED;}\r\n\t\t\tif(lf_Persistent){iFlags+=CONNECT_UPDATE_PROFILE;}\r\n\t\t\tif(ls_PromptForCredentials){iFlags+=CONNECT_INTERACTIVE+CONNECT_PROMPT;}\r\n\t\t\tif(psUsername==\"\"){psUsername=null;}\r\n\t\t\tif(psPassword==\"\"){psPassword=null;}\r\n\t\t\t//if force, unmap ready for new connection\r\n\t\t\tif(lf_Force){try{zUnMapDrive(true);}\r\n\t\t\t\t\t\t catch{}}\r\n\t\t\t//call and return\r\n\t\t\tint i = WNetAddConnection2A(ref stNetRes, psPassword, psUsername, iFlags);\t\t\t\r\n\t\t\tif(i>0){throw new System.ComponentModel.Win32Exception(i);}\t\t\t\t\t\t\r\n\t\t}\r\n\r\n\t\t// Unmap network drive\r\n\t\tprivate void zUnMapDrive(bool pfForce)\r\n\t\t{\r\n\t\t\t//call unmap and return\r\n\t\t\tint iFlags=0;\r\n\t\t\tif(lf_Persistent){iFlags+=CONNECT_UPDATE_PROFILE;}\r\n\t\t\tint i = WNetCancelConnection2A(ls_Drive, iFlags, Convert.ToInt32(pfForce));\r\n\t\t\tif(i>0){throw new System.ComponentModel.Win32Exception(i);}\r\n\t\t}\r\n\t\t// Check / Restore a network drive\r\n\t\tprivate void zRestoreDrive()\r\n\t\t{\r\n\t\t\t//call restore and return\r\n\t\t\tint i = WNetRestoreConnectionW(0, null);\r\n\t\t\tif(i>0){throw new System.ComponentModel.Win32Exception(i);}\r\n\t\t}\r\n\t\t// Display windows dialog\r\n\t\tprivate void zDisplayDialog(Form poParentForm, int piDialog)\r\n\t\t{\r\n\t\t\tint i = -1;\r\n\t\t\tint iHandle = 0;\r\n\t\t\t//get parent handle\r\n\t\t\tif(poParentForm!=null)\r\n\t\t\t{\r\n\t\t\t\tiHandle = poParentForm.Handle.ToInt32();\r\n\t\t\t}\r\n\t\t\t//show dialog\r\n\t\t\tif(piDialog==1)\r\n\t\t\t{\r\n\t\t\t\ti = WNetConnectionDialog(iHandle, RESOURCETYPE_DISK);\r\n\t\t\t}\r\n\t\t\telse if(piDialog==2)\r\n\t\t\t{\r\n\t\t\t\ti = WNetDisconnectDialog(iHandle, RESOURCETYPE_DISK);\r\n\t\t\t}\r\n\t\t\tif(i>0){throw new System.ComponentModel.Win32Exception(i);}\r\n\t\t\t//set focus on parent form\r\n\t\t\tpoParentForm.BringToFront();\r\n\t\t}\r\n\r\n\r\n\t\t#endregion\r\n\t}\r\n}","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Map Drive","Share"]},{"RecordId":"789","Title":"Code to Map a Drive Letter (Picks Next Available Drive)","Description":"Code to map a network drive by picking the next available drive letter","Code":"[DllImport(\"mpr.dll\")] private static extern int WNetUseConnection(int phWnd, ref structNetResource pstNetRes, string psPassword, string psUsername, int piFlags, StringBuilder b, out int bl, out int s);\r\n[DllImport(\"mpr.dll\")] private static extern int WNetCancelConnection2A(string psName, int piFlags, int pfForce);\r\n\r\n[StructLayout(LayoutKind.Sequential)]\r\n\tprivate struct structNetResource\r\n{\r\n\tpublic int iScope;\r\n\tpublic int iType;\r\n\tpublic int iDisplayType;\r\n\tpublic int iUsage;\r\n\tpublic string sLocalName;\r\n\tpublic string sRemoteName;\r\n\tpublic string sComment;\r\n\tpublic string sProvider;\r\n}\r\n\t\t\r\n//Constants\r\npublic const int RESOURCETYPE_DISK = 0x1;\t\r\npublic const int CONNECT_INTERACTIVE = 0x00000008;\r\npublic const int CONNECT_PROMPT = 0x00000010;\r\npublic const int CONNECT_UPDATE_PROFILE = 0x00000001;\r\npublic const int CONNECT_REDIRECT = 0x00000080;\r\npublic const int CONNECT_COMMANDLINE = 0x00000800;\r\npublic const int CONNECT_CMD_SAVECRED = 0x00001000;\r\n\r\n//StringBuilder for Unmanaged return\r\nStringBuilder sb = new StringBuilder(32);\r\n\r\n\r\n//Map Network Drive\r\nprivate void MapDrive(string psUsername, string psPassword)\r\n{\r\n\tstring buffer=\"\";\r\n\tbuffer += buffer.PadRight(32);\r\n\r\n\tint bufferlen = buffer.Length;\r\n\tint success = 0;\r\n\r\n\t//create struct data\r\n\tstructNetResource stNetRes = new structNetResource();\t\t\t\r\n\tstNetRes.iScope=2;\r\n\tstNetRes.iType=RESOURCETYPE_DISK;\r\n\tstNetRes.iDisplayType=3;\r\n\tstNetRes.iUsage=1;\r\n\tstNetRes.sRemoteName=txtAddress.Text;\r\n\tstNetRes.sLocalName=null;\t\t\t\r\n\r\n\t//call and return\r\n\ttry\r\n\t{\r\n\t\tint i = WNetUseConnection(0, ref stNetRes, psPassword, psUsername, CONNECT_REDIRECT, sb, out bufferlen, out success);\t\t\t\r\n\t\r\n\t\tif(i>0)\r\n\t\t{\r\n\t\t\tthrow new System.ComponentModel.Win32Exception(i);\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tMessageBox.Show(\"Drive Mapped As \" + sb.ToString());\r\n\t\t}\r\n\t}\r\n\tcatch(Exception err)\r\n\t{\r\n\t\t//report error\r\n\t\tMessageBox.Show(this, \"Cannot map drive!\\nError: \"+err.Message);\r\n\t}\r\n}\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Map Drive","Share"]},{"RecordId":"790","Title":"Determinine if an Assembly is Compiled in Debug Mode","Description":"How to determine if a DLL is compiled in debug mode","Code":"Open Visual Studio command prompt\r\nRun ILDASM\r\nView the Manifest\r\nIf you see DebuggableAttribute, it's compiled in debug mode","Declares":"","CodeCategory":{"CategoryId":"26","CategoryDescription":".Net - Visual Studio IDE"},"Keywords":["Debug mode"]},{"RecordId":"791","Title":"Remote Desktop - Norton AntiVirus Configuration","Description":"How to configure Norton AntiVirus to allow Remote Desktop","Code":"Cannot connect to another computer using Windows Remote Desktop after installing Norton AntiVirus 2005\r\n\r\nSituation: \r\n\r\nAfter you install Norton AntiVirus 2005, you cannot connect to another computer by using the Windows XP Remote Desktop software.\r\n\r\nSolution:\r\nTo fix the problem, create a program rule in Internet Worm Protection for Mstsc.exe and Svchost.exe located in C:\\Windows\\System32. Read the following section for detailed instructions.\r\n\r\nTo create a new program rule \r\n\r\n1. Start Norton AntiVirus. \r\n2. Click Options. \r\n3. In the left pane, click Internet Worm Protection. \r\n4. In the right pane, click Program Control. \r\n5. Click Add. \r\n6. Navigate to C:\\Windows\\System32, and click Mstsc.exe. \r\n7. In the next dialog box, in the drop-down menu, click Permit. \r\n8. Repeat steps 3 through 7 for Svchost.exe. \r\n9. Click OK.\r\n","Declares":"","CodeCategory":{"CategoryId":"7","CategoryDescription":"Misc"},"Keywords":["Norton AntiVirus","Remote Desktop"]},{"RecordId":"792","Title":"AJAX (for .Net 1.1)","Description":"Shows how to use Ajax to retrieve a dataset and populate an HTML div.","Code":"---------------------------------------------------------\r\nWeb.config entry\r\n---------------------------------------------------------\r\n\r\n  &lt;system.web&gt;\r\n    &lt;httpHandlers&gt;\r\n    \t   &lt;add verb=&quot;POST,GET&quot; path=&quot;ajax/*.ashx&quot; type=&quot;Ajax.PageHandlerFactory, Ajax&quot; /&gt;\r\n    &lt;/httpHandlers&gt;\r\n  &lt;/system.web&gt;\r\n\r\n\r\n---------------------------------------------------------\r\nASPX HTML\r\n---------------------------------------------------------\r\n\r\n&lt;%@ Page language=&quot;c#&quot; Codebehind=&quot;WebForm1.aspx.cs&quot; AutoEventWireup=&quot;false&quot; Inherits=&quot;AjaxDemo.WebForm1&quot; %&gt;\r\n&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.0 Transitional//EN&quot; &gt;\r\n&lt;HTML&gt;\r\n\t&lt;HEAD&gt;\r\n\t\t&lt;title&gt;WebForm1&lt;/title&gt;\r\n\t\t&lt;meta name=&quot;GENERATOR&quot; Content=&quot;Microsoft Visual Studio .NET 7.1&quot;&gt;\r\n\t\t&lt;meta name=&quot;CODE_LANGUAGE&quot; Content=&quot;C#&quot;&gt;\r\n\t\t&lt;meta name=&quot;vs_defaultClientScript&quot; content=&quot;JavaScript&quot;&gt;\r\n\t\t&lt;meta name=&quot;vs_targetSchema&quot; content=&quot;http://schemas.microsoft.com/intellisense/ie5&quot;&gt;\r\n\t\t&lt;script lang=&quot;JavaScript&quot;&gt;\r\n\r\n\t\t\tfunction DoAjax(s)\r\n\t\t\t{\r\n\t\t\t\tWebForm1.GetData(s , ServerSideAdd_CallBack);\r\n\t\t\t}\r\n\r\n\t\t\tfunction ServerSideAdd_CallBack(resp)\r\n\t\t\t{\r\n\r\n\t\t\t\tvar ds = resp.value;\r\n\r\n\t\t\t\tvar strHTML = '&lt;table cellpadding=&quot;3&quot; cellspacing=&quot;0&quot; border=&quot;1&quot;&gt;';\r\n\t\t\t\tfor(var i=0; i &lt; ds.Tables[0].Rows.length; i++)\r\n\t\t\t\t{\r\n\t\t\t\t\tstrHTML += '&lt;tr&gt;&lt;td&gt;' + ds.Tables[0].Rows[i].Col1 + '&lt;/td&gt;&lt;td&gt;' + ds.Tables[0].Rows[i].Col2 + '&lt;/td&gt;&lt;/tr&gt;';\r\n\t\t\t\t}\r\n\t\t\t\tstrHTML += '&lt;/table&gt;';\r\n\t\t\t\tdocument.all.DataDiv.innerHTML = strHTML;\r\n\r\n\t\t\t}\r\n\r\n\t\t&lt;/script&gt;\r\n\t&lt;/HEAD&gt;\r\n\t&lt;body&gt;\r\n\t\t&lt;form id=&quot;Form1&quot; method=&quot;post&quot; runat=&quot;server&quot;&gt;\r\n\t\t\t&lt;input type=&quot;button&quot; id=&quot;cmdAjax1&quot; value=&quot;Get data - 5 rows&quot; onclick=&quot;DoAjax('1')&quot;&gt;&lt;br&gt;\r\n\t\t\t&lt;input type=&quot;button&quot; id=&quot;cmdAjax2&quot; value=&quot;Get data - 10 rows&quot; onclick=&quot;DoAjax('2')&quot;&gt;&lt;br&gt;\r\n\t\t\t&lt;br&gt;\r\n\t\t\t&lt;br&gt;\r\n\t\t\t&lt;br&gt;\r\n\t\t\t&lt;br&gt;\r\n\t\t\t&lt;div id=&quot;DataDiv&quot;&gt;&lt;/div&gt;\r\n\t\t\t&lt;br&gt;\r\n\t\t\t&lt;br&gt;\r\n\t\t&lt;/form&gt;\r\n\t&lt;/body&gt;\r\n&lt;/HTML&gt;\r\n\r\n\r\n\r\n---------------------------------------------------------\r\nASPX Code-behind\r\n---------------------------------------------------------\r\nusing System;\r\nusing System.Collections;\r\nusing System.ComponentModel;\r\nusing System.Data;\r\nusing System.Drawing;\r\nusing System.Web;\r\nusing System.Web.SessionState;\r\nusing System.Web.UI;\r\nusing System.Web.UI.WebControls;\r\nusing System.Web.UI.HtmlControls;\r\n\r\nnamespace AjaxDemo\r\n{\r\n\t/// &lt;summary&gt;\r\n\t/// Summary description for WebForm1.\r\n\t/// &lt;/summary&gt;\r\n\tpublic class WebForm1 : System.Web.UI.Page\r\n\t{\r\n\t\r\n\t\tprivate void Page_Load(object sender, System.EventArgs e)\r\n\t\t{\r\n\t\t\t// Put user code to initialize the page here\r\n\t\t\tAjax.Utility.RegisterTypeForAjax(typeof(WebForm1));      \r\n\t\t}\r\n\r\n\r\n\t\t[Ajax.AjaxMethod()]\r\n\t\tpublic int ServerSideAdd(int firstNumber, int secondNumber)\r\n\t\t{\r\n\t\t\treturn firstNumber + secondNumber;\r\n\t\t}\r\n\r\n\t\t[Ajax.AjaxMethod()]\r\n\t\tpublic DataSet GetData(string strDSType)\r\n\t\t{\r\n\t\t\t\r\n\t\t\tDataSet ds = new DataSet();\r\n\t\t\tDataTable dt = new DataTable();\r\n\t\t\tdt.Columns.Add( new DataColumn(&quot;Col1&quot;, System.Type.GetType ( &quot;System.String&quot; )));\r\n\t\t\tdt.Columns.Add( new DataColumn(&quot;Col2&quot;, System.Type.GetType ( &quot;System.String&quot; )));\r\n\r\n\t\t\tif (strDSType == &quot;1&quot;)\t\r\n\t\t\t{\r\n\t\t\t\tfor (int i = 0; i &lt; 5; i++)\r\n\t\t\t\t{\r\n\t\t\t\t\tDataRow dr = dt.NewRow();\r\n\t\t\t\t\tdr[&quot;Col1&quot;] = i.ToString();\r\n\t\t\t\t\tdr[&quot;Col2&quot;] = &quot;Value is &quot; + i.ToString();\r\n\t\t\t\t\tdt.Rows.Add(dr);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tfor (int i = 0; i &lt; 10; i++)\r\n\t\t\t\t{\r\n\t\t\t\t\tDataRow dr = dt.NewRow();\r\n\t\t\t\t\tdr[&quot;Col1&quot;] = i.ToString();\r\n\t\t\t\t\tdr[&quot;Col2&quot;] = &quot;Value is &quot; + i.ToString();\r\n\t\t\t\t\tdt.Rows.Add(dr);\r\n\t\t\t\t}\r\n\t\t\t\r\n\t\t\t}\r\n\r\n\t\t\tds.Tables.Add(dt);\r\n\t\t\treturn ds;\r\n\r\n\t\t}\r\n\r\n\t\t#region Web Form Designer generated code\r\n\t\toverride protected void OnInit(EventArgs e)\r\n\t\t{\r\n\t\t\t//\r\n\t\t\t// CODEGEN: This call is required by the ASP.NET Web Form Designer.\r\n\t\t\t//\r\n\t\t\tInitializeComponent();\r\n\t\t\tbase.OnInit(e);\r\n\t\t}\r\n\t\t\r\n\t\t/// &lt;summary&gt;\r\n\t\t/// Required method for Designer support - do not modify\r\n\t\t/// the contents of this method with the code editor.\r\n\t\t/// &lt;/summary&gt;\r\n\t\tprivate void InitializeComponent()\r\n\t\t{    \r\n\t\t\tthis.Load += new System.EventHandler(this.Page_Load);\r\n\r\n\t\t}\r\n\t\t#endregion\r\n\t}\r\n}\r\n\r\n\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"20","CategoryDescription":".Net - ASP.Net"},"Keywords":["AJAX"]},{"RecordId":"793","Title":"Using SQL Server for ASP.Net Session State - Hotfix","Description":"Microsoft Hotfix \r\nhttp://support.microsoft.com/kb/836680/","Code":"By design, all ASP.NET applications use the same database to store data when they use SQL Server session state. You cannot specify a database name for each application. However, after you apply this software update, you can include the database name in the SQL connection string of a configuration file in the sessionstate section.\r\n\r\nThis hotfix addes the capability of specifying a database name for the SessionState setting on a web app.  It also replaces the InstallSqlStateTemplate.sql and UninstallSqlStateTemplate.sql files.\r\n\r\n<sessionState \r\n\tmode=\"SQLServer\"\r\n\tallowCustomSqlDatabase = \"true\" <!-- This line is a new attribute to sessionState -->\r\n\tsqlConnectionString=\"data source=127.0.0.1;database=mydatabase;userid=UserName;password=StrongPassword\" cookieless=\"false\" timeout=\"20\"\r\n/>\r\n\r\nMicrosoft Hotfix \r\nhttp://support.microsoft.com/kb/836680/","Declares":"","CodeCategory":{"CategoryId":"20","CategoryDescription":".Net - ASP.Net"},"Keywords":["SQL Server Session State","ASPState"]},{"RecordId":"794","Title":"Highlighting Search Words in the WSS Search Results","Description":"SharePoint 2003 does not highlight searched text in the search results page.  This shows how to accomplish this task.","Code":"Highlighting Search Words in the WSS Search Results\r\nBy: Igor Goldshtaub, KWizCom, 4/10/2006\r\n\r\nSharePoint 2003 does not highlight searched text in the search results page.  If all you are interested in is highlighting the searched text in the WSS search results page, you should be able to complete this by adding some JavaScript code to the searchresults.aspx page located in the SharePoint layouts folder.\r\n\r\nThis example adds this functionality to an English SharePoint search results page. If you are not using English, change any reference to \"1033\" to your own language's LCID number.\r\n\r\n\r\nvar strSearchTerm = document.forms[\"frmSearch\"].elements[\"SearchString\"].value;\r\nHighlightSearchTerm(strSearchTerm);\r\n\r\nfunction HighlightSearchTerm(strSearchTerm)\r\n{\r\n   var cellTables = document.all.tags(\"table\");\r\n   var strSearchTerm = strSearchTerm.toLowerCase();\r\n   if(strSearchTerm == \"\")\r\n      return;\r\n   for(var ii = 0; ii < cellTables.length; ii++)\r\n   {\r\n      if((cellTables[ii].all[\"frmSearch\"] != null) || (cellTables[ii].className != \"\"))\r\n         continue;\r\n      var cellTags = cellTables[ii].all.tags(\"td\");\r\n\r\n      for(var iii = 0; iii < cellTags.length; iii++)\r\n      {\r\n         if(cellTags[iii].className != \"ms-vb\")\r\n            continue;\r\n         var strBodyText = cellTags[iii].innerHTML;\r\n         var strText = strBodyText.toLowerCase();\r\n         var i = -1;\r\n         var strNewText = \"\";\r\n         while (strBodyText.length > 0)\r\n         {\r\n            i = strText.indexOf(strSearchTerm, i+1);\r\n            if (i < 0)\r\n            {\r\n               strNewText += strBodyText;\r\n               strBodyText = \"\";\r\n            }\r\n            else\r\n            {\r\n               if (strBodyText.lastIndexOf(\">\", i) >= strBodyText.lastIndexOf(\"<\", i))\r\n               {\r\n                  if (strText.lastIndexOf(\"/script>\", i) >= strText.lastIndexOf(\"<script\", i))\r\n                  {\r\n                     strNewText += strBodyText.substring(0, i) + \"<B style='COLOR: black; BACKGROUND-COLOR: #ffff66'>\" + strBodyText.substr(i, strSearchTerm.length) + \"</B>\";\r\n                     strBodyText = strBodyText.substr(i + strSearchTerm.length);\r\n                     strText = strBodyText.toLowerCase();\r\n                     i = -1;\r\n                  }\r\n               }\r\n            }\r\n         }\r\n         cellTags[iii].innerHTML = strNewText;\r\n      }\r\n   }\r\n}\r\n","Declares":"","CodeCategory":{"CategoryId":"25","CategoryDescription":"Sharepoint 2003"},"Keywords":["Highlight Search Terms"]},{"RecordId":"795","Title":"Generating Thumbnail Images from ASP.Net","Description":"Demonstrates how to generate a thumbnail image from an ASP.Net page.","Code":"private void Page_Load(object sender, System.EventArgs e)\r\n{\r\n  // get the file name -- Image1.jpg\r\n  //string file = Request.QueryString[\"file\"];\r\n  string file = \"image1.jpg\";\r\n\r\n  // create an image object, using the filename we just retrieved\r\n  System.Drawing.Image image = System.Drawing.Image.FromFile(Server.MapPath(file));\r\n\r\n  // create the actual thumbnail image\r\n  System.Drawing.Image thumbnailImage = image.GetThumbnailImage(64, 64, \r\n      new System.Drawing.Image.GetThumbnailImageAbort(ThumbnailCallback), IntPtr.Zero);\r\n\r\n  // make a memory stream to work with the image bytes\r\n  MemoryStream imageStream = new MemoryStream();\r\n\r\n  // put the image into the memory stream\r\n  thumbnailImage.Save(imageStream, System.Drawing.Imaging.ImageFormat.Jpeg);\r\n\r\n  // make byte array the same size as the image\r\n  byte[] imageContent = new Byte[imageStream.Length];\r\n\r\n  // rewind the memory stream\r\n  imageStream.Position = 0;\r\n\r\n  // load the byte array with the image\r\n  imageStream.Read(imageContent, 0, (int)imageStream.Length);\r\n\r\n  // return byte array to caller with image type\r\n  Response.ContentType = \"image/jpeg\";\r\n  Response.BinaryWrite(imageContent);\r\n\r\n  image.Dispose();\r\n  thumbnailImage.Dispose();\r\n\r\n}\r\n\r\npublic bool ThumbnailCallback()\r\n{\r\n  return true;\r\n}\r\n","Declares":"","CodeCategory":{"CategoryId":"20","CategoryDescription":".Net - ASP.Net"},"Keywords":["Thumbnail"]},{"RecordId":"796","Title":"Sending Embedded Images in EMail Messages","Description":".Net framework 1.0 and 1.1 do no support embedded images in emails.  2.0 framework does.  The 1.0 and 1.1 workaround is to use CDO inside of a COM wrapper.","Code":"Set a COM project reference to cdosys.dll\r\n\r\n\r\nCDO.Message mm = new CDO.MessageClass();\r\n\r\nmm.To = \"you@there.com\";\r\nmm.From = \"me@here.com\";\r\nmm.Subject = \"Test Email\";\r\n\r\nmm.HTMLBody = \"Picture 1: <img src='SquareKnot.jpg'>\";\r\n\r\nmm.AddRelatedBodyPart(@\"C:\\~CD\\SquareKnot.jpg\",\"SquareKnot.jpg\", CDO.CdoReferenceType.cdoRefTypeLocation, null, null);\r\n\r\nCDO.Configuration objConfig = new CDO.ConfigurationClass();\r\n\r\nobjConfig.Fields[\"cdoSendUsingMethod\"].Value = CDO.CdoSendUsing.cdoSendUsingPort; \r\n\r\nobjConfig.Fields[\"cdoSMTPServer\"].Value = \"localhost\" ;\r\n\r\nobjConfig.Fields[\"cdoSMTPServerPort\"].Value = 25 ;\r\n\r\nobjConfig.Fields[\"cdoSMTPAuthenticate\"].Value = CDO.CdoProtocolsAuthentication.cdoBasic;\r\n\r\nobjConfig.Fields.Update();\r\n\r\nmm.Configuration = objConfig;\r\n\r\nmm.Send();\r\n\r\nmm = null;","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Embedded Images","CDO"]},{"RecordId":"797","Title":"Windows XP Performance Tweak","Description":"Performance tweak for XP","Code":"Anytime you install a fresh copy of Windows XP, or create a new user,do the following to improve performance.  It's also one of the most effective at speeding up EVERYTHING in Windows. This tweak only cost you 5% of Windows visual appearance. It's so unnoticable that you will only know something has changed because you changed it.\r\n\r\n1.  Click Start\r\n     Right Click on My Computer\r\n     Click Properties\r\n\r\n2.  Click on the Advanced Tab\r\n     Click on the first Settings Button\r\n\r\n3.  Choose \"Adjust for best performance\"\r\n\r\n4. Scroll down and check the following boxes:\r\n     Check the last two boxes \"Use drop shadows...\" and \"Use visual styles...\"\r\n     Check the \"Smooth edges of screen fonts\" box (this is optional).\r\n     Then Click OK\r\n\r\nThat's it. Now Windows won't eat up memory every time you open or close a window or click on a menu.","Declares":"","CodeCategory":{"CategoryId":"7","CategoryDescription":"Misc"},"Keywords":["XP Performance Tweak"]},{"RecordId":"798","Title":"Could not establish trust relationship with remote server","Description":"Workaround for invalid SSL certs that result in the \"Could not establish trust relationship with remote server\" error message.","Code":"--------------------------------------------------------------------------\r\nPut the following code in a stand-alone class:\r\n--------------------------------------------------------------------------\r\ninternal class AcceptAllCertificatePolicy : ICertificatePolicy\r\n{\r\n\tpublic AcceptAllCertificatePolicy()\r\n\t{\r\n\t}\r\n\r\n\tpublic bool CheckValidationResult(ServicePoint sPoint,\r\n\t                                  X509Certificate cert, WebRequest wRequest,int certProb)\r\n\t{\r\n\t\t// Always accept\r\n\t\treturn true;\r\n\t}\r\n}\r\n\r\n\r\n\r\n--------------------------------------------------------------------------\r\nCall the webservice as follows:\r\n--------------------------------------------------------------------------\r\nSomeWebservice ws = new SomeWebservice();\r\nws.Credentials = new NetworkCredential(\"acct\", \"pwd\",\"domain\");\r\nServicePointManager.CertificatePolicy = new AcceptAllCertificatePolicy();  // This is the secret\r\nstring s = ws.DoSomething(\"69\");\r\n","Declares":"","CodeCategory":{"CategoryId":"20","CategoryDescription":".Net - ASP.Net"},"Keywords":["Invalid SSL Cert","Establish Trust"]},{"RecordId":"800","Title":"Processing XML in SQL Stored Procedure (Simple Example)","Description":"Demonstrates how to load XML in a T-SQL DOM","Code":"--SET NOCOUNT ON\r\n\r\n   DECLARE @idoc Integer\r\n   DECLARE @xmlNodePath nVarChar(1000)\r\n   DECLARE @XMLdoc nVarChar(1000)\r\n\r\n   SET @XMLdoc = N'\r\n\t<XML>\r\n\t\t<Data F1=\"ABC1\" F2=\"DEF\" />\r\n\t\t<Data F1=\"ABC2\" F2=\"DEF\" />\r\n\t</XML>'\r\n\r\n\r\n\r\n   -- Translate the XML internally in SQL\r\n   EXEC sp_xml_preparedocument @idoc OUTPUT, @XMLdoc\r\n\r\n   -- This is the XPath query\r\n   SET @xmlNodePath = '//Data'\r\n\r\n   SELECT \r\n\txmlClient.F1,\r\n\txmlClient.F2\r\n   FROM   OPENXML (@idoc, @xmlNodePath, 1) \r\n   WITH ( \r\n\tF1 nVarChar(10),\r\n\tF2 nVarChar(10)\r\n    ) xmlClient\r\n\r\n  --SET NOCOUNT OFF\r\n","Declares":"","CodeCategory":{"CategoryId":"6","CategoryDescription":"T-SQL"},"Keywords":["XML"]},{"RecordId":"801","Title":"Convert Color Image to Black & White","Description":"Shows how to convert a color image to black and white.","Code":"Code taken from BobPowell.net\r\n\r\nnamespace GrayShear\r\n{\r\n  /// <summary>\r\n  /// Summary description for Form1.\r\n  /// </summary>\r\n  public class Form1 : System.Windows.Forms.Form\r\n  {\r\n    /// <summary>\r\n    /// Required designer variable.\r\n    /// </summary>\r\n    private System.ComponentModel.Container components = null;\r\n    public Form1()\r\n    {\r\n      //\r\n      // Required for Windows Form Designer support\r\n      //\r\n      InitializeComponent();\r\n      //\r\n      // TODO: Add any constructor code after InitializeComponent call\r\n      //\r\n    }\r\n    /// <summary>\r\n    /// Clean up any resources being used.\r\n    /// </summary>\r\n    protected override void Dispose( bool disposing )\r\n    {\r\n      if( disposing )\r\n      {\r\n        if (components != null) \r\n        {\r\n          components.Dispose();\r\n        }\r\n      }\r\n      base.Dispose( disposing );\r\n    }\r\n    #region Windows Form Designer generated code\r\n    /// <summary>\r\n    /// Required method for Designer support - do not modify\r\n    /// the contents of this method with the code editor.\r\n    /// </summary>\r\n    private void InitializeComponent()\r\n    {\r\n      // \r\n      // Form1\r\n      // \r\n      this.AutoScaleBaseSize = new System.Drawing.Size(5, 13);\r\n      this.ClientSize = new System.Drawing.Size(296, 269);\r\n      this.Name = \"Form1\";\r\n      this.Text = \"Form1\";\r\n      this.Load += new System.EventHandler(this.Form1_Load);\r\n    }\r\n    #endregion\r\n    /// <summary>\r\n    /// The main entry point for the application.\r\n    /// </summary>\r\n    [STAThread]\r\n    static void Main() \r\n    {\r\n      Application.Run(new Form1());\r\n    }\r\n    private void Form1_Load(object sender, System.EventArgs e)\r\n    {\r\n      OpenFileDialog dlg = new OpenFileDialog();\r\n      dlg.Filter=\"Image files (*.BMP, *.JPG, *.GIF)|*.bmp;*.jpg;*.gif\";\r\n      if(dlg.ShowDialog()==DialogResult.OK)\r\n      {\r\n        Image img = Image.FromFile(dlg.FileName);\r\n        Bitmap bm = new Bitmap(img.Width,img.Height);\r\n        Graphics g = Graphics.FromImage(bm);\r\n \r\n        \r\n        /*\r\n        //Original grayscale shear (USE THE MATRIX BELOW INSTEAD OF THIS ONE)\r\n        ColorMatrix cm = new ColorMatrix(new float[][]{   new float[]{0.5f,0.5f,0.5f,0,0},\r\n                                  new float[]{0.5f,0.5f,0.5f,0,0},\r\n                                  new float[]{0.5f,0.5f,0.5f,0,0},\r\n                                  new float[]{0,0,0,1,0,0},\r\n                                  new float[]{0,0,0,0,1,0},\r\n                                  new float[]{0,0,0,0,0,1}});\r\n        */\r\n        \r\n        //Gilles Khouzams colour corrected grayscale shear (USE THIS MATRIX INSTEAD OF THE ONE ABOVE)\r\n        ColorMatrix cm = new ColorMatrix(new float[][]{   new float[]{0.3f,0.3f,0.3f,0,0},\r\n                                  new float[]{0.59f,0.59f,0.59f,0,0},\r\n                                  new float[]{0.11f,0.11f,0.11f,0,0},\r\n                                  new float[]{0,0,0,1,0,0},\r\n                                  new float[]{0,0,0,0,1,0},\r\n                                  new float[]{0,0,0,0,0,1}});\r\n\r\n        ImageAttributes ia = new ImageAttributes();\r\n        ia.SetColorMatrix(cm);\r\n        g.DrawImage(img,new Rectangle(0,0,img.Width,img.Height),0,0,img.Width,img.Height,GraphicsUnit.Pixel,ia);\r\n        g.Dispose();\r\n        this.BackgroundImage=bm;\r\n      }  \r\n    }\r\n  }\r\n}\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Color Conversion","Black and White","Black & White"]},{"RecordId":"802","Title":"Determining Image Dimensions (Height & Width)","Description":"Code to determine the height and width of an uploaded image","Code":"<form id=\"UploadImage\" method=\"post\" encType=\"multipart/form-data\" runat=\"server\">\r\n<p>Choose an image file from your machine:\r\n<br>\r\n    <INPUT id=\"UploadedPicture\" type=\"file\" name=\"UploadedPicture\" runat=\"server\">\r\n<br>\r\n<asp:button id=\"ButtonUpload\" runat=\"server\" Text=\"Upload This Image\"></asp:button>\r\n</p>\r\n</form>\r\n\r\n\r\n\r\nprivate void ButtonUpload_Click(object sender, System.EventArgs e)  {\r\n\r\n    //Determine type and filename of uploaded image\r\n    string UploadedImageType = UploadedPicture.PostedFile.ContentType.ToString().ToLower();\r\n    string UploadedImageFileName = UploadedPicture.PostedFile.FileName;\r\n\r\n    //Create an image object from the uploaded file\r\n    System.Drawing.Image UploadedImage = \r\n            System.Drawing.Image.FromStream(UploadedPicture.PostedFile.InputStream);\r\n\r\n    //Determine width and height of uploaded image\r\n    float UploadedImageWidth = UploadedImage.PhysicalDimension.Width;\r\n    float UploadedImageHeight = UploadedImage.PhysicalDimension.Height;\r\n\r\n    //Check that image does not exceed maximum dimension settings\r\n    if (UploadedImageWidth > 600 || UploadedImageHeight > 400) {\r\n            Response.Write(\"This image is too big - please resize it!\");\r\n    }\r\n\r\n}\r\n","Declares":"","CodeCategory":{"CategoryId":"20","CategoryDescription":".Net - ASP.Net"},"Keywords":["Image Dimensions","Image Height and Width"]},{"RecordId":"805","Title":"Invalid ViewState Error in ASP.Net","Description":"One workaround to try if you are experiencing the infamous Invalid ViewState error in your ASP.Net applications.","Code":"Add the following to your <@Page ...> directive:\r\nEnableViewStateMac=\"False\"\r\n\r\n\r\n.Net attempts to validate the ViewState of your webform as it is posted back to the server(s).  If your ASP.Net application is hosted in a webfarm environment, and your postbacks are being bounced back and forth between machines, then if the farm is not configured correctly, you will get the following error.  As the error suggests, one typical culprit is that the <machineKey> configuration on the servers is not set correctly.  BUT, if your application is perhaps hosted in an environment where you don't have access to the web servers to alter the configuration, you can override this default behavior by adding the EnableViewStateMac=\"False\" statement to your <@Page ...> directive.\r\n\r\nUnable to validate data. \r\nDescription: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code. \r\n\r\nException Details: System.Web.HttpException: Unable to validate data.\r\n\r\nSource Error: \r\n\r\nAn unhandled exception was generated during the execution of the current web request. Information regarding the origin and location of the exception can be identified using the exception stack trace below. \r\n\r\nStack Trace: \r\n\r\n\r\n[HttpException (0x80004005): Unable to validate data.]\r\nSystem.Web.Configuration.MachineKey.GetDecodedData(Byte[] buf, Byte[] modifier, Int32 start, Int32 length, Int32& dataLength) +195\r\nSystem.Web.UI.LosFormatter.Deserialize(String input) +60\r\n\r\n[HttpException (0x80004005): Authentication of viewstate failed. 1) If this is a cluster, edit <machineKey> configuration so all servers use the same validationKey and validation algorithm. AutoGenerate cannot be used in a cluster. 2) Viewstate can only be posted back to the same page. 3) The viewstate for this page might be corrupted.]\r\nSystem.Web.UI.LosFormatter.Deserialize(String input) +118\r\nSystem.Web.UI.Page.LoadPageStateFromPersistenceMedium() +101\r\n\r\n[HttpException (0x80004005): Invalid_Viewstate\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"20","CategoryDescription":".Net - ASP.Net"},"Keywords":["EnableViewStateMac","Unable to validate data","Invalid Viewstate"]},{"RecordId":"806","Title":"XSL Transformations .Net","Description":"Demonstrates how to perform an XSL transformation on an XML document.","Code":"string xmlOut = string.Empty;\r\nstring strXslFile = string.Empty;\r\nstrXslFile = Server.MapPath(\"SomeFile.xsl\");\r\n\r\nXmlDocument myXmlDoc = new XmlDocument();\r\nmyXmlDoc.Load (\"http://www.someXMLSource.com/\");\r\n\r\nXslTransform myXslDoc = new XslTransform();\r\nmyXslDoc.Load(strXslFile);\r\n\r\nStream str = new MemoryStream();\r\nmyXslDoc.Transform( myXmlDoc, null, str, null);\r\nstr.Flush();\r\nstr.Position = 0;\r\n\r\nSystem.IO.StreamReader sr = new System.IO.StreamReader(str);\r\nxmlOut = sr.ReadToEnd();\r\nsr.Close();\r\nstr.Close();\r\n\r\nreturn xmlOut;\r\n","Declares":"","CodeCategory":{"CategoryId":"20","CategoryDescription":".Net - ASP.Net"},"Keywords":["XSL Transform"]},{"RecordId":"807","Title":"Execute a Web Request to Get Data (as in RSS data)","Description":"Demonstrates how to open a web request and get data from the source.","Code":"string strHTTPResult = string.Empty;\r\n\r\nWebRequest myRequest = WebRequest.Create(\"http://www.someurl.com/?a=foo\");\r\nWebResponse myResponse = myRequest.GetResponse();\r\n\r\nStreamReader sr = new StreamReader(myResponse.GetResponseStream(), Encoding.ASCII);\r\nstrHTTPResult = sr.ReadToEnd();\r\nmyResponse.Close();\r\nsr.Close();\r\n\r\nreturn strHTTPResult;\r\n","Declares":"","CodeCategory":{"CategoryId":"20","CategoryDescription":".Net - ASP.Net"},"Keywords":["Web Request","Get HTTP Data","Open URL"]},{"RecordId":"808","Title":"Dynamically Create DataTable on the Fly","Description":"Dynamically create a DataTable on the fly and populate it with data","Code":"NOTE - The column creation samples below can be improved as follows:\r\n\r\ndt.Columns.Add(new DataColumn(\"EventStartDate\", typeof(System.DateTime));\r\ndt.Columns.Add(new DataColumn(\"EventTitle\", typeof(string));\r\ndt.Columns.Add(new DataColumn(\"EventStartMonth\", typeof(int));\r\n\r\n\r\n\r\n\r\nDataTable dt = new DataTable();\r\ndt.Columns.Add(new DataColumn(&quot;EventStartDate&quot;, System.Type.GetType(&quot;System.DateTime&quot;)));\r\ndt.Columns.Add(new DataColumn(&quot;EventEndDate&quot;, System.Type.GetType(&quot;System.DateTime&quot;)));\r\ndt.Columns.Add(new DataColumn(&quot;EventTitle&quot;, System.Type.GetType(&quot;System.String&quot;)));\r\ndt.Columns.Add(new DataColumn(&quot;EventStartMonth&quot;, System.Type.GetType(&quot;System.Int32&quot;)));\r\ndt.Columns.Add(new DataColumn(&quot;EventStartDay&quot;, System.Type.GetType(&quot;System.Int32&quot;)));\r\ndt.Columns.Add(new DataColumn(&quot;EventStartYear&quot;, System.Type.GetType(&quot;System.Int32&quot;)));\r\ndt.Columns.Add(new DataColumn(&quot;EventEndMonth&quot;, System.Type.GetType(&quot;System.Int32&quot;)));\r\ndt.Columns.Add(new DataColumn(&quot;EventEndDay&quot;, System.Type.GetType(&quot;System.Int32&quot;)));\r\ndt.Columns.Add(new DataColumn(&quot;EventEndYear&quot;, System.Type.GetType(&quot;System.Int32&quot;)));\r\ndt.Columns.Add(new DataColumn(&quot;EventCategory&quot;, System.Type.GetType(&quot;System.String&quot;)));\r\n\r\nstring strXMLFileName =  HttpContext.Current.Server.MapPath(&quot;Events.xml&quot;);\r\nXmlDocument oXMLDoc = new XmlDocument();\r\noXMLDoc.Load(strXMLFileName);\r\n\r\nXmlNodeList oNodeList = oXMLDoc.SelectNodes(&quot;//Event&quot;);\r\nfor (int i = 0; i &lt; oNodeList.Count; i++) \r\n{\r\n\r\n\tDataRow dr = dt.NewRow();\r\n\r\n\tstring strEventStartDate = oNodeList.Item(i).Attributes[&quot;date&quot;].Value.ToString();\r\n\tstring strEventEndDate = oNodeList.Item(i).Attributes[&quot;enddate&quot; ].Value.ToString();\r\n\tstring strEventTitle = oNodeList.Item(i).Attributes[ &quot;title&quot; ].Value.ToString();\r\n\tstring strEventCategory = oNodeList.Item(i).Attributes[ &quot;category&quot; ].Value.ToString();\r\n\r\n\tdr[&quot;EventStartDate&quot;] = strEventStartDate;\r\n\tdr[&quot;EventEndDate&quot;] = strEventEndDate;\r\n\tdr[&quot;EventTitle&quot;] = strEventTitle;\r\n\tDateTime datTemp = System.Convert.ToDateTime(strEventStartDate);\r\n\tdr[&quot;EventStartDay&quot;] = datTemp.Day.ToString();\r\n\tdr[&quot;EventStartMonth&quot;] = datTemp.Month.ToString();\r\n\tdr[&quot;EventStartYear&quot;] = datTemp.Year.ToString();\r\n\tdatTemp = System.Convert.ToDateTime(strEventEndDate);\r\n\tdr[&quot;EventEndDay&quot;] = datTemp.Day.ToString();\r\n\tdr[&quot;EventEndMonth&quot;] = datTemp.Month.ToString();\r\n\tdr[&quot;EventEndYear&quot;] = datTemp.Year.ToString();\r\n\tdr[&quot;EventCategory&quot;] = strEventCategory + &quot;&quot;;\r\n\tdt.Rows.Add(dr);\r\n\r\n}\r\n\r\ndt.DefaultView.Sort =  &quot;EventStartYear, EventStartMonth, EventStartDay&quot;;\r\ndt.AcceptChanges();\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Create DataTable","Dynamic DataTable"]},{"RecordId":"809","Title":"Representing Business Entities (XML, DataSet, Typed DataSet or Custom Classes)","Description":"Explanation of various patterns for representing Business Entities with advantages and disadvantages of each.","Code":"The following is an excerpt taken from an article pusblished on Microsoft's Patterns and Practices website.\r\n\r\n\r\nThere are various ways to represent business entities in your application, ranging from a data-centric model to a more object-oriented representation: \r\n\tXML \r\n\tGeneric DataSet \r\n\tTyped DataSet \r\n\tCustom business entity components \r\n\tCustom business entity components with CRUD behaviors \r\n\r\n\r\n============================================\r\nRepresenting Business Entities as XML\r\n============================================\r\n\r\nThe following example shows how to represent a simple business entity as XML. The business entity consists of a single product.\r\n\r\n\t&lt;?xml version=&quot;1.0&quot;?&gt;\r\n\t&lt;Product xmlns=&quot;urn:aUniqueNamespace&quot;&gt;\r\n\t  &lt;ProductID&gt;1&lt;/ProductID&gt;\r\n\t  &lt;ProductName&gt;Chai&lt;/ProductName&gt;\r\n\t  &lt;QuantityPerUnit&gt;10 boxes x 20 bags&lt;/QuantityPerUnit&gt;\r\n\t  &lt;UnitPrice&gt;18.00&lt;/UnitPrice&gt;\r\n\t  &lt;UnitsInStock&gt;39&lt;/UnitsInStock&gt;\r\n\t  &lt;UnitsOnOrder&gt;0&lt;/UnitsOnOrder&gt;\r\n\t  &lt;ReorderLevel&gt;10&lt;/ReorderLevel&gt;\r\n\t&lt;/Product&gt;\r\n\r\nThe following example shows how to represent collections and hierarchies of data in an XML document. The XML document represents a single order made by a customer; note that the &lt;OrderDetails&gt; element holds a collection of order detail information for the order.\r\n\r\n\t&lt;Order xmlns=&quot;urn:aUniqueNamespace&quot;&gt;\r\n\t  &lt;OrderID&gt;10248&lt;/OrderID&gt;\r\n\t  &lt;CustomerID&gt;VINET&lt;/CustomerID&gt;\r\n\t  &lt;OrderDate&gt;1996-07-04&lt;/OrderDate&gt;\r\n\t  &lt;ShippedDate&gt;1996-07-16&lt;/ShippedDate&gt;\r\n\t  &lt;OrderDetails&gt;\r\n\t    &lt;OrderDetail&gt;\r\n\t      &lt;ProductID&gt;11&lt;/ProductID&gt;\r\n\t      &lt;UnitPrice&gt;14.00&lt;/UnitPrice&gt;\r\n\t      &lt;Quantity&gt;12&lt;/Quantity&gt;\r\n\t    &lt;/OrderDetail&gt;\r\n\t    &lt;OrderDetail&gt;\r\n\t      &lt;ProductID&gt;42&lt;/ProductID&gt;\r\n\t      &lt;UnitPrice&gt;9.80&lt;/UnitPrice&gt;\r\n\t      &lt;Quantity&gt;10&lt;/Quantity&gt;\r\n\t    &lt;/OrderDetail&gt;\r\n\t    &lt;OrderDetail&gt;\r\n\t      &lt;ProductID&gt;72&lt;/ProductID&gt;\r\n\t      &lt;UnitPrice&gt;34.80&lt;/UnitPrice&gt;\r\n\t      &lt;Quantity&gt;5&lt;/Quantity&gt;\r\n\t    &lt;/OrderDetail&gt;\r\n\t  &lt;/OrderDetails&gt;\r\n\t&lt;/Order&gt;\r\n\r\n\r\n\r\nWhen you use XML to represent business entity data, consider the following guidelines: \r\n\r\nUse a namespace to uniquely identify the XML document, to avoid name clashes with content in other XML documents. The preceding example uses a default namespace called urn:aUniqueNamespace. \r\nChoose appropriate names for elements and attributes. The preceding example uses the column names from the Product table, but this is not a requirement. Choose names that make sense for your application. \r\nUse one of the following approaches to retrieve your business entities in XML format: \r\nIf you are using SQL Server 2000, you can use the FOR XML clause in your queries or stored procedures. In performance tests, using FOR XML is only slightly faster than returning a DataSet. \r\nRetrieve a DataSet and transform it or write it out as an XML stream. With this approach, you incur the overhead of creating the DataSet and additional overhead if performing a transformation. \r\nBuild an XML document from output parameters or by using a data reader. Data readers are the fastest way to retrieve multiple rows from the database, but the process associated with building XML may decrease the performance benefit. \r\nFor more information and performance considerations, see Performance Comparison: Data Access Techniques.\r\n\r\nThe advantages of representing business entities as XML are as follows: \r\n\r\nStandards support. XML is a World Wide Web Consortium (W3C) standard data representation format. For more information about this standard, see http://www.w3.org/xml. \r\nFlexibility. XML can represent hierarchies and collections of information. For more information, see How to Use XML to Represent Collections and Hierarchies of Data in the appendix. \r\nInteroperability. XML is an ideal choice for exchanging information with external parties and trading partners, regardless of platform. If the XML data will be consumed by ASP.NET or Windows Forms applications, you can load the XML data into a DataSet to take advantage of the data binding support provided by DataSets. \r\n\r\nThe disadvantages of representing business entities as XML are as follows: \r\n\r\nPreserving type fidelity. Type fidelity is not preserved in XML. However, you can use XSD schemas for simple data typing. \r\nValidating XML. To validate XML, you can parse the code manually or use an XSD schema. Both approaches are relatively slow. For an example of how to validate XML by using an XSD schema, see How to Validate XML by Using an XSD Schema. \r\nDisplaying XML. You cannot automatically display XML data in the user interface. You can write an XSLT style sheet to transform the data into a DataSet; however, style sheets are not easy to write. Alternatively, the style sheet can transform the XML into a displayable format such as HTML. For more information, see How to Apply a Style Sheet Programmatically in a .NET Application in the appendix. \r\nParsing XML. To parse XML, you can use the Document Object Model (DOM) or the XmlReader class provided in the Microsoft .NET Framework class library. XmlReader provides fast-forward only, read-only access to XML data, but DOM is more flexible because it provides random read/write access. However, parsing an XML document by using DOM is slower; you must create an instance of XmlDocument (or another XML parser class) and load the entire XML document into memory. \r\nSorting XML. You cannot automatically sort XML data. Instead, use one of the following techniques: \r\nDeliver the data in presorted order. This option does not support dynamic resorting of data in the calling application. \r\nApply an XSLT style sheet to sort the data dynamically. If necessary, you can alter the sort criteria in the XSLT style sheet at run time, by using DOM. \r\nTransform the XML data into a DataSet, and use a DataView object to sort and search the data elements. \r\nUsing private fields. You do not have the option of hiding information. \r\n\r\n\r\n============================================\r\nRepresenting Business Entities As a Generic DataSet\r\n============================================\r\n\r\nA generic DataSet is an instance of the DataSet class, which is defined in the System.Data namespace in ADO.NET. A DataSet object contains one or more DataTable objects to represent information that the Data Access Logic Component retrieves from the database.\r\n\r\nThe advantages of representing business entities as a generic DataSet are as follows: \r\n\r\nFlexibility. DataSets can contain collections of data, and can represent complex data relationships. \r\nSerialization. DataSets natively support serialization when passing across tiers. \r\nData binding. DataSets can be bound to any user-interface controls in ASP.NET and Windows Forms applications. \r\nSorting and filtering. DataSets can be sorted and filtered by using DataView objects. An application can create several DataView objects for the same DataSet, to view the data in different ways. \r\nInterchangeability with XML. DataSets can be read or written in XML format. This is a useful technique in remote and disconnected applications, which can receive a DataSet in XML format and recreate the DataSet object locally. Applications can also persist DataSets to XML format while the applications are disconnected from the database. \r\nAvailability of metadata. Full metadata can be provided for a DataSet, in the form of an XSD schema. You can also programmatically obtain metadata for the DataSet by using methods in the DataSet, DataTable, DataColumn, Constraint, and Relation classes. \r\nOptimistic concurrency. When you are updating data, you can use DataSets, in conjunction with data adapters, to perform optimistic concurrency checks easily. \r\nExtensibility. If the database schema is modified, the methods in the Data Access Logic Component can create DataSets that contain modified DataTable and DataRelation objects as appropriate. The Data Access Logic Component method signatures do not change. The calling application can be modified to use these new elements in the DataSet. \r\n\r\nThe disadvantages of representing business entities as a generic DataSet are as follows: \r\n\r\nClient code must access data through collections in the DataSet. To access a table in a DataSet, client code must index into the DataTable collections by using an integer indexer or a string indexer. To access a particular column, you must index into the DataColumn collection by using a column number or a column name. The following example shows how to access the ProductName column for the first row in the Products table: \r\n\t// Get the product name for the product in the first row of a DataSet called \r\n\t// dsProducts. Note the collections are zero-based.\r\n\tString str = (String)dsProducts.Tables[&quot;Products&quot;].Rows[0][&quot;ProductName&quot;];\r\n\r\nThere is no compile-time checking of these indexer values. If you specify an invalid table name, column name, or column type, the error is trapped at run time. \r\nThere is no IntelliSense support when you use generic DataSets.\r\nHigh instantiation and marshalling costs. DataSets result in the creation of several subobjects (DataTable, DataRow, and DataColumn), which means that DataSets can take longer to instantiate and marshal than XML strings or custom entity components. The relative performance of DataSets improves as the amount of data increases, because the overhead of creating the internal structure of the DataSet is less significant than the time it takes to populate the DataSet with data. \r\nPrivate fields. You do not have the option of hiding information. \r\n\r\n\r\n============================================\r\nRepresenting Business Entities As a Typed DataSet\r\n============================================\r\n\r\nA typed DataSet is a class that contains strongly typed methods, properties, and type definitions to expose the data and metadata in a DataSet.\r\n\r\nThe following lists describe the advantages and disadvantages of typed DataSets, compared with generic DataSets. Note that typed DataSets exhibit approximately the same instantiation and marshalling performance as generic DataSets.\r\n\r\nThe advantages of representing business entities as a typed DataSet are as follows: \r\n\r\nCode readability. To access tables and columns in a typed DataSet, you can use typed methods and properties, as shown in the following code: \r\n\t// Get the product name for the product in the first row of a typed DataSet called \r\n\t// dsProducts. Note the collections are zero-based.\r\n\tString str = dsProducts.Products[0].ProductName;\r\n\r\nIn this example, dsProducts is an instance of a typed DataSet. The DataSet has a single DataTable, which is exposed by a property named Products. The columns in this DataTable are exposed by properties such as ProductName, which returns the appropriate data type for the column (rather than just returning Object). \r\n\r\nThe provision of typed methods and properties makes typed DataSets easier to use than generic DataSets. When you use typed DataSets, IntelliSense is available. \r\n\r\nCompile type checking. Invalid table names and column names are detected at compile time rather than at run time. \r\n\r\nThe disadvantages of representing business entities as a typed DataSet are as follows: \r\n\r\nDeployment. The assembly containing the typed DataSet class must be deployed to all tiers that use the business entity. \r\nSupport of Enterprise Services (COM+) callers. If a typed DataSet will be used by COM+ clients, the assembly containing the typed DataSet class must be given a strong name and must be registered on client computers. Typically, the assembly is installed in the global assembly cache. These steps will also be required for custom entity classes, as described later in this document. \r\nExtensibility issues. If the database schema is modified, the typed DataSet class might need to be regenerated to support the new schema. The regeneration process will not preserve any custom code that was implemented in the typed DataSet class. The assembly containing the typed DataSet class must be redeployed to all client applications. \r\nInstantiation. You cannot instantiate the type by using the new operator. \r\nInheritance. Your typed dataset must inherit from DataSet, which precludes the use of any other base classes. \r\n\r\n\r\n============================================\r\nDefining Custom Business Entity Components\r\n============================================\r\n\r\nCustom classes that represent business entities typically contain the following members: \r\n\r\nPrivate fields to cache the business entity's data locally. These fields hold a snapshot of the data in the database at the time the data was retrieved from the database by the Data Access Logic Component. \r\nPublic properties to access the state of the entity, and to access subcollections and hierarchies of data inside the entity. The properties can have the same names as the database column names, but this is not an absolute requirement. Choose property names according to the needs of your application, rather than the names in the database. \r\nMethods and properties to perform localized processing by using the data in the entity component. \r\nEvents to signal changes to the internal state of the entity component. \r\nThe entity class has no knowledge of the Data Access Logic Component or the underlying database; all database access is performed by the Data Access Logic Component to centralize data access policies and business logic. Also, the way in which you pass business entity data through the tiers is not directly tied to the format of your business entity representation; for example, you can represent business entities locally as objects, yet choose a different approach (such as scalar values or XML) to pass business entity data to a different tier.\r\n\r\nRecommendations for Defining Custom Business Entity Components\r\n\r\nTo help you implement your custom entity components, consider the following recommendations: \r\n\r\nChoosing between structs and classes. For simple business entities that do not contain hierarchical data or collections, consider defining a struct to represent the business entity. For complex business entities, or for business entities that require inheritance, define the entity as a class instead. For a comparison of struct and class types, see Structures and Classes. \r\nRepresenting the business entity's state. For simple values such as numbers and strings, define fields by using the equivalent .NET data type. \r\nRepresenting subcollections and hierarchies in a custom Business Entity Component. There are two ways to represent subcollections and hierarchies of data in a custom entity: \r\n\tA .NET collection such as ArrayList. The .NET collection classes offer a convenient programming model for resizable collections, and also provide built-in support for data binding to user-interface controls. \r\n\tA DataSet. DataSets are well suited for storing collections and hierarchies of data from a relational database or from an XML document. Additionally, DataSets are preferred if you need to be able to filter, sort, or data bind your subcollections. \r\nSupporting data binding for user-interface clients. If the custom entity will be consumed by user interfaces and you want to take advantage of automatic data binding, you may need to implement data binding in your custom entity. Consider the following scenarios: \r\nData binding in Windows Forms. You can data bind an entity instance to controls without implementing data binding interfaces in your custom entity. You can also data bind an array or a .NET collection of entities. \r\nData binding in Web Forms. You cannot data bind an entity instance to controls in a Web Form without implementing the IBindingList interface. However, if you want to data bind only sets, you can use an array or a .NET collection without needing to implement the IBindingList interface in your custom entity. \r\n\r\nExposing events for internal data changes. Exposing events is useful for rich-client user-interface design because it enables data to be refreshed wherever it is being displayed. The events should be for internal state only, not for data changes on a server. \r\nMaking your business entities serializable. Making business entities serializable enables the business entity's state to be persisted in interim states without database interactions. The result can be to ease offline application development and design of complex user interface processes that do not affect business data until they are complete. There are two types of serialization: \r\nXML serialization by using the XmlSerializer class. Use XML serialization when you need to serialize only public fields and public read/write properties to XML. Note that if you return business entity data from a Web service, the object is automatically serialized to XML through XML serialization. \r\nYou can perform XML serialization on business entities without implementing any additional code inside the entity. However, only the public fields and public read/write properties in the object are serialized to XML. Private fields, indexers, private properties, read-only properties and object graphs are not serialized. You can control the resulting XML by using attributes in your custom entity. For more information about how to serialize custom entity components to XML format, see How to Serialize Business Entity Components to XML Format in the appendix. \r\n\r\nFormatted serialization by using the BinaryFormatter or SoapFormatter class. Use formatted serialization when you need to serialize all the public and private fields and object graphs of an object, or if you will pass an entity component to or from a remoting server. \r\nThe formatter classes serialize all of an object's fields and properties, both public and private. BinaryFormatter serializes the object to binary format, and SoapFormatter serializes an object to SOAP format. Serialization by using BinaryFormatter is faster than serialization by using SoapFormatter. To use either of these formatter classes, you must mark your entity class with the [Serializable] attribute. If you need explicit control over the serialization format, your class must also implement the ISerializable interface.\r\n\r\nNote - Default constructors are not called when an object is deserialized. This constraint is placed on deserialization for performance reasons.\r\n\r\nThe advantages of defining a custom entity are as follows: \r\n\r\nCode readability. To access data in a custom entity class, you can use typed methods and properties, as shown in the following code: \r\n\t// Create a ProductDALC object\r\n\tProductDALC dalcProduct = new ProductDALC();\r\n\t\r\n\t// Use the ProductDALC object to create and populate a ProductEntity \r\n\tobject.\r\n\t// This code assumes the ProductDALC class has a method named GetProduct, \r\n\t// which takes a Product ID as a parameter (21 in this example) and \r\n\treturns a\r\n\t// ProductEntity object containing all the data for this product.\r\n\tProductEntity aProduct = dalcProduct.GetProduct(21);\r\n\t\r\n\t// Change the product name for this product\r\n\taProduct.ProductName = &quot;Roasted Coffee Beans&quot;;\r\n\r\nIn the preceding example, a product is an instance of a custom entity class named ProductEntity. The ProductDALC class has a method named GetProduct, which creates a ProductEntity object, populates the object with data for a specific product and returns the ProductEntity object. The calling application can use properties such as ProductName to access the data on the ProductEntity object and can call methods to manipulate the object. \r\n\r\nEncapsulation. Custom entities can contain methods to encapsulate simple business rules. These methods operate on the business entity data cached in the entity component, rather than accessing the live data in the database. Consider the following example: \r\n\t// Call a method defined in the ProductEntity class.\r\n\taProduct.IncreaseUnitPriceBy(1.50);\r\n\r\nIn the preceding example, the calling application calls a method named IncreaseUnitPriceBy on the ProductEntity object. This change is not made permanent until the ProductEntity object is saved back to the database when the calling application invokes an appropriate method on the ProductDALC object. \r\n\r\nModeling of complex systems. If you are modeling a complex domain problem that has many interactions between different business entities, it may be beneficial to define custom entity classes to absorb the complexity behind well-defined class interfaces. \r\nLocalized validation. Custom entity classes can perform simple validation tests in their property accessors to detect invalid business entity data. For more information, see How to Validate Data in Property Accessors in Business Entity Components. \r\nPrivate fields. You can hide information that you do not want to expose to the caller. \r\n\r\nThe disadvantages of defining a custom entity are as follows: \r\n\r\nCollections of business entities. A custom entity represents a single business entity, not a collection of business entities. The calling application must create an array or a .NET collection to hold multiple business entities. \r\nSerialization. You must implement your own serialization mechanism in a custom entity. You can use attributes to control how entity components are serialized, or you can implement the ISerializable interface to control your own serialization. \r\nRepresentation of complex relationships and hierarchies in a business entity. You must implement your own mechanism for representing relationships and hierarchies of data in a Business Entity Component. As described previously, DataSets are often the easiest way to achieve this effect. \r\nSearching and sorting of data. You must define your own mechanism to support searching and sorting of entities. For example, you can implement the IComparable interface to allow entity components to be held in a SortedList or Hashtable collection. \r\nDeployment. You must deploy, on all physical tiers, the assembly containing the custom entity. \r\nSupport for Enterprise Services (COM+) clients. If a custom entity will be used by COM+ clients, the assembly containing the entity must be given a strong name and must be registered on client computers. Typically, the assembly is installed in the global assembly cache. \r\nExtensibility issues. If the database schema is modified, you might need to modify the custom entity class and redeploy the assembly. \r\n\r\n============================================\r\nDefining Custom Business Entity Components with CRUD Behaviors\r\n============================================\r\n\r\nWhen you define a custom entity, you can provide methods to completely encapsulate the CRUD operations on the underlying Data Access Logic Component. This is the more traditional object-oriented approach, and may be appropriate for complex object domains. The client application no longer accesses the Data Access Logic Component class directly. Instead, the client application creates an entity component and calls CRUD methods on the entity component. These methods forward to the underlying Data Access Logic Component.\r\n\r\nThe advantages of defining custom entity classes with CRUD behaviors are as follows: \r\n\r\nEncapsulation. The custom entity encapsulates the operations defined by the underlying Data Access Logic Component. \r\nInterface to caller. The caller must deal with only one interface to persist business entity data. There is no need to access the Data Access Logic Component directly. \r\nPrivate fields. You can hide information that you do not want to expose to the caller. \r\n\r\nThe disadvantages of defining custom entity classes with CRUD behaviors are as follows: \r\n\r\nDealing with sets of business entities. The methods in the custom entity pertain to a single business entity instance. To support sets of business entities, you can define static methods that take or return an array or a collection of entity components. \r\nIncreased development time. The traditional object-oriented approach typically requires more design and development effort than working with existing objects, such as DataSets, requires. \r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Business Entities","Typed DataSets"]},{"RecordId":"811","Title":"Aspect Oriented Programming - Intercepting Method Calls for Tracing","Description":"This sample demonstrates how to use Aspect Oriented Programming to intercept the call chain in a class' methods in order to capture the value of incoming parameters and return values of the class' methods.","Code":"This sample demonstrates how to use Aspect Oriented Programming to intercept the call chain in a class's methods.  Doing so allows you to capture the value of incoming parameters immediately before the method is called, and to capture the value of method returns immediately after the call returns.\r\n\r\nThis sample provides the additional capability that if you do not want certain public methods within a decorated class to be traced, you can disable tracing on those methods by decorating them with a [CallTracingIgnoreMethodTrace()] attribute.\r\n\r\nIf you are passing Business Entity classes into and out of methods, and you want the properties of the Business Entities traced, the Business Entity class must be decorated with a [Serializable] attribute so that the class can be serialized.\r\n\r\nCaveats:  \r\n   Static method calls are not traced.\r\n   Private methods are not traced.\r\n   Constructors are not traced.\r\n\r\nThere are two requirements to enable tracing for a class:  \r\n   1 - Decorate the class to be traced with [CallTracingAttribute()]\r\n   2 - The class to be traced must inherit from ContextBoundObject\r\n\r\nPerformance Impact:\r\nMy tests reveal that simply decorating a class with the [CallTracingAttribute()] attribute and inheriting from ContextBoundObject imposes a .13 millisecond delay per class that is instantiated.  Additionally, enabling actual tracing results in a total of .31 millisecond performance hit.  Therefore, it is suggested that you only decorate those public classes in which you absolutely must trace in, and only turn tracing on when it is necessary.\r\n\r\n\r\n//*---------------------------------------------------------\r\n//* This is the class whose calls are to be traced.  \r\n//*---------------------------------------------------------\r\nusing System;\r\nusing System.Runtime.Remoting.Messaging;\r\n\r\nnamespace TracingDemo\r\n{\r\n   [CallTracingAttribute()]  // &lt;&lt;&lt;--- This is needed to hook-up the tracer\r\n   public class TraceMe : ContextBoundObject   // &lt;&lt;&lt;--- Must inherit from ContextBoundObject\r\n   {\r\n   \r\n      public TraceMe()\r\n      {\r\n      }\r\n\r\n      public TraceMe(string init)\r\n      {\r\n         \r\n      }\r\n\r\n      public int ReturnFive(String s) \r\n      {\r\n//       Object obj = CallContext.GetData(CallTracingAspect.ContextName) ;\r\n//       CallTracingAspect aspect = (CallTracingAspect)obj ;\r\n//       aspect.Trace(&quot;Inside MethodCall&quot;);\r\n\r\n         TraceMe_Call2 tmc2 = new TraceMe_Call2();\r\n         tmc2.ReturnFive(&quot;d&quot;);\r\n         tmc2=null;\r\n\r\n\r\n         return 5;\r\n      }\r\n\r\n\r\n      public void BusinessObjectSampleMethod(Author a)\r\n      {\r\n         int z = Foo(32);\r\n      }\r\n\r\n      [CallTracingIgnoreMethodTrace()]  // &lt;&lt;&lt;--- This would allow us to skip tracing this method\r\n      public Author GetBusinessObjectSampleMethod(int p1, string p2)\r\n      {\r\n         Author a = new Author();\r\n         a.Id=99;\r\n         a.Name=&quot;xyz&quot;;\r\n         return a;\r\n      }\r\n\r\n      private int Foo(int intIn)\r\n      {\r\n         return intIn * 2;\r\n      }\r\n\r\n   }\r\n}\r\n\r\n\r\n//*---------------------------------------------------------\r\n//* This is the class that hooks up to and performs the call tracing.\r\n//*---------------------------------------------------------\r\nusing System;\r\nusing System.IO;\r\nusing System.Reflection;\r\nusing System.Runtime.Remoting.Messaging;\r\nusing System.Runtime.Remoting.Contexts;\r\nusing System.Runtime.Remoting.Activation;\r\nusing System.Text;\r\nusing System.Xml;\r\n\r\nnamespace TracingDemo \r\n{\r\n   \r\n   internal class CallTracingAspect : IMessageSink \r\n   {\r\n      private IMessageSink m_next;\r\n      private String m_typeAndName ;\r\n      private bool blnIsTracingOn = false;\r\n    \r\n      internal CallTracingAspect(IMessageSink next) \r\n      { \r\n         m_next = next;\r\n      }\r\n\r\n      public IMessageSink NextSink \r\n      {\r\n         get \r\n         {\r\n            return m_next;\r\n         }\r\n      }\r\n    \r\n      public IMessage SyncProcessMessage(IMessage msg) \r\n      {\r\n         \r\n         blnIsTracingOn = true;  // &lt;&lt;&lt;--- This simulates a member variable that turns tracing on/off for the session.  The thinking is that you can turn tracing on and off at the user level, and set that value here.\r\n\r\n         Preprocess(msg);\r\n         IMessage returnMethod = m_next.SyncProcessMessage(msg);\r\n         PostProcess(msg, returnMethod);\r\n         return returnMethod;\r\n      }\r\n    \r\n      public IMessageCtrl AsyncProcessMessage( IMessage msg, IMessageSink replySink ) \r\n      {\r\n         throw new InvalidOperationException() ;\r\n      }\r\n    \r\n      public static string ContextName \r\n      {\r\n         get \r\n         {\r\n            return &quot;CallTrace&quot; ;\r\n         }\r\n      }\r\n\r\n\r\n      private void Preprocess(IMessage msg) \r\n      {\r\n\r\n         if (!blnIsTracingOn) return;\r\n\r\n         StringBuilder sb = new StringBuilder();\r\n\r\n         // We only want to process method calls\r\n         if (!(msg is IMethodMessage)) return;\r\n\r\n         IMethodMessage call = msg as IMethodMessage;\r\n         Attribute[] attributeArray = Attribute.GetCustomAttributes(call.MethodBase);\r\n         foreach(Attribute attrib in attributeArray)\r\n         {\r\n            if (attrib is CallTracingIgnoreMethodTrace) return;\r\n         }\r\n\r\n\r\n         Type t = Type.GetType(call.TypeName) ;\r\n         m_typeAndName = t.Name + &quot;.&quot; + call.MethodName ;\r\n         sb.Append(&quot;PreProcessing: &quot; + m_typeAndName + &quot;(&quot;);\r\n         // Loop through the [in] parameters\r\n         for (int i = 0; i &lt; call.ArgCount; ++i) \r\n         {\r\n            if (i &gt; 0)\r\n            {\r\n               sb.Append(&quot;, &quot;);\r\n            }\r\n            //sb.Append(call.GetArgName(i) + &quot;= &quot; + call.GetArg(i));\r\n            StringWriter sw = new StringWriter(sb);\r\n            XmlWriter writer = new XmlTextWriter(sw);\r\n            sb.Append(call.GetArgName(i) + &quot;= &quot;);\r\n            DiagXmlObjectFormatter.Format(call.Args[i], writer);\r\n\r\n         }\r\n         sb.Append(&quot;)&quot;);\r\n         Console.WriteLine(sb.ToString());\r\n        \r\n         // set us up in the callContext\r\n         call.LogicalCallContext.SetData(ContextName, this);\r\n      }\r\n\r\n      public void Trace(String s)\r\n      {\r\n         Console.WriteLine(&quot;During: &quot; + m_typeAndName + &quot;: &quot; + s) ;\r\n      }\r\n    \r\n      private void PostProcess(IMessage msg, IMessage msgReturn)\r\n      {    \r\n\r\n         if (!blnIsTracingOn) return;\r\n\r\n         StringBuilder sb = new StringBuilder();\r\n\r\n         // We only want to process method return calls\r\n         if (!(msg is IMethodMessage) || !(msgReturn is IMethodReturnMessage)) return;\r\n\r\n         IMethodReturnMessage retMsg = (IMethodReturnMessage)msgReturn;\r\n         sb.Append(&quot;PostProcessing: &quot;);\r\n         Exception e = retMsg.Exception;\r\n         if (e != null) \r\n         {     \r\n            Console.WriteLine(&quot;Exception was thrown: &quot; + e);\r\n            return;\r\n         }\r\n\r\n         // Loop through all the [out] parameters\r\n         sb.Append(m_typeAndName + &quot;(&quot;);\r\n         if (retMsg.OutArgCount &gt; 0) \r\n         {\r\n            sb.Append(&quot;out parameters[&quot;);\r\n            for (int i = 0; i &lt; retMsg.OutArgCount; ++i ) \r\n            {\r\n               if (i &gt; 0)\r\n               {\r\n                  sb.Append(&quot;, &quot;);\r\n               }\r\n               //sb.Append(retMsg.GetOutArgName(i) + &quot;= &quot; +  retMsg.GetOutArg(i));\r\n               StringWriter sw = new StringWriter(sb);\r\n               XmlWriter writer = new XmlTextWriter(sw);\r\n               sb.Append(retMsg.GetOutArgName(i) + &quot;= &quot;);\r\n               DiagXmlObjectFormatter.Format(retMsg.OutArgs[i], writer);\r\n            }\r\n            sb.Append(&quot;]&quot;);\r\n         }\r\n         if (retMsg.ReturnValue.GetType() != typeof(void))\r\n         {\r\n            //sb.Append(&quot;returned [&quot; + retMsg.ReturnValue + &quot;]&quot;);\r\n            sb.Append(&quot;returned [&quot;);\r\n            StringWriter sw = new StringWriter(sb);\r\n            XmlWriter writer = new XmlTextWriter(sw);\r\n            DiagXmlObjectFormatter.Format(retMsg.ReturnValue, writer);\r\n            sb.Append(&quot;]&quot;);\r\n         }\r\n\r\n         sb.Append(&quot;)&quot;);\r\n         Console.WriteLine(sb.ToString());\r\n      }\r\n   }\r\n\r\n   public class CallTracingProperty : IContextProperty, IContributeObjectSink \r\n   {\r\n      public IMessageSink GetObjectSink(MarshalByRefObject o, IMessageSink next) \r\n      {\r\n         return new CallTracingAspect(next);\r\n      }\r\n      public bool IsNewContextOK( Context newCtx ) \r\n      {\r\n         return true ;\r\n      }\r\n      public void Freeze(Context newContext)\r\n      {\r\n      }\r\n      public string Name \r\n      {\r\n         get \r\n         {\r\n            return &quot;CallTracingProperty&quot;;\r\n         }\r\n      }\r\n   }\r\n\r\n   [AttributeUsage(AttributeTargets.Class)]\r\n   public class CallTracingAttribute : ContextAttribute \r\n   {\r\n      public CallTracingAttribute() : base(&quot;CallTracing&quot;) {}\r\n      public override void GetPropertiesForNewContext(IConstructionCallMessage ccm) \r\n      {\r\n         ccm.ContextProperties.Add(new CallTracingProperty());\r\n      }\r\n   }\r\n\r\n\r\n   [AttributeUsage(AttributeTargets.Method)]\r\n   public class CallTracingIgnoreMethodTrace : Attribute \r\n   {\r\n      public CallTracingIgnoreMethodTrace(){}\r\n   }\r\n}\r\n\r\n\r\n\r\n\r\n//*---------------------------------------------------------\r\n//* This is the class that serializes the input &amp; output parms into XML for tracing.\r\n//*---------------------------------------------------------\r\nusing System;\r\nusing System.Collections;\r\nusing System.Xml;\r\nusing System.Xml.Serialization;\r\n\r\nnamespace TracingDemo\r\n{\r\n   /// &lt;exclude /&gt;\r\n   /// &lt;summary&gt;\r\n   /// Used by the diagnostics framework to format objects as XML\r\n   /// &lt;/summary&gt;\r\n   internal class DiagXmlObjectFormatter\r\n   {\r\n      private static IDictionary _serializerCache = Hashtable.Synchronized( new Hashtable() );\r\n\r\n      /// &lt;summary&gt;\r\n      /// Initializes an instance of the DiagXmlObjectFormatter class. Default constructor.\r\n      /// &lt;/summary&gt;\r\n      private DiagXmlObjectFormatter()\r\n      {\r\n      }\r\n\r\n      /// &lt;summary&gt;\r\n      /// Gets the appropriate XmlSerializer for the specified type.\r\n      /// &lt;/summary&gt;\r\n      /// &lt;param name=&quot;t&quot;&gt;The type to find a serializer for&lt;/param&gt;\r\n      /// &lt;returns&gt;An XmlSerializer&lt;/returns&gt;\r\n      private static XmlSerializer GetSerializerForType( Type t )\r\n      {\r\n         XmlSerializer serializer = _serializerCache[ t ] as XmlSerializer;\r\n\r\n         if ( serializer == null )\r\n         {\r\n            serializer = new XmlSerializer( t );\r\n            _serializerCache.Add( t, serializer );\r\n         }\r\n\r\n         return serializer;\r\n      }\r\n\r\n      /// &lt;summary&gt;\r\n      /// Formats and writes a dictionary object to the specified XmlWriter\r\n      /// &lt;/summary&gt;\r\n      /// &lt;param name=&quot;dictionary&quot;&gt;The dictionary object to format and write.&lt;/param&gt;\r\n      /// &lt;param name=&quot;writer&quot;&gt;The XmlWriter object to write to.&lt;/param&gt;\r\n      private static void FormatDictionary( IDictionary dictionary, XmlWriter writer )\r\n      {\r\n         if ( dictionary != null )\r\n         {\r\n            foreach( DictionaryEntry de in dictionary )\r\n            {\r\n               string name = de.Key.ToString();\r\n               object value = de.Value;\r\n               if ( value != null )\r\n               {\r\n                  writer.WriteStartElement( &quot;item&quot; );\r\n                  writer.WriteAttributeString( &quot;key&quot;, name );\r\n                  writer.WriteAttributeString( &quot;value&quot;, value.ToString() );\r\n                  writer.WriteAttributeString( &quot;type&quot;, value.GetType().FullName );\r\n                  writer.WriteEndElement();\r\n               }\r\n            }\r\n         }\r\n      }\r\n\r\n      /// &lt;summary&gt;\r\n      /// Formats an object as XML.\r\n      /// &lt;/summary&gt;\r\n      /// &lt;param name=&quot;value&quot;&gt;The object to format.&lt;/param&gt;\r\n      /// &lt;param name=&quot;writer&quot;&gt;The XmlWriter to write to.&lt;/param&gt;\r\n      public static void Format( object value, XmlWriter writer )\r\n      {\r\n\r\n         if ( value == null )\r\n         {\r\n            writer.WriteString( &quot;NULL&quot; );\r\n         }\r\n         else\r\n         {\r\n            //get the type of object\r\n            Type type = value.GetType();\r\n\r\n            //we have a dictionary so handle it differently\r\n            if ( value is IDictionary)\r\n            {\r\n               FormatDictionary(value as IDictionary, writer);\r\n            }\r\n               // our object is serializable so write it\r\n            else if ( value is IXmlSerializable )\r\n            {\r\n               writer.WriteStartElement( type.Name );\r\n               ( ( IXmlSerializable ) value ).WriteXml( writer );\r\n               writer.WriteEndElement();\r\n            }\r\n               //we have a primitive, or simple type, so format it as a string\r\n            else if ( type.IsPrimitive || type.IsEnum || value is DateTime || value is string )\r\n            {\r\n               writer.WriteString( String.Format( &quot;{0}&quot;, value ) );\r\n            }\r\n\r\n            else\r\n            {\r\n               //we don't know what we have, so try to find a serializer to write it\r\n               XmlSerializer serializer = null;\r\n            \r\n               try\r\n               {\r\n                  serializer = GetSerializerForType( value.GetType() );\r\n               }\r\n\r\n               catch{}\r\n\r\n               if ( serializer != null )\r\n               {\r\n                  serializer.Serialize( writer, value );\r\n               }\r\n\r\n               else\r\n               {\r\n                  writer.WriteString( String.Format( &quot;{0}&quot;, value ) );\r\n               }\r\n            }           \r\n         }\r\n      }\r\n   }\r\n}\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Tracing","Aspect Oriented Programming","ContextBoundObject"]},{"RecordId":"812","Title":"XSL Transformations in .Net (Simplified)","Description":"Demonstrates how to perform an XSL transform against an XML document.  Note that this uses the simplified StringWriter to get the textual output of the transform.  This results in a UTF-16 encoded file, whereas the traditional methods produce UTF-8.","Code":"string xmlOut = string.Empty;\r\n\r\nstring strXslFile = string.Empty;\r\nstrXslFile = Server.MapPath(&quot;Moreover2.xsl&quot;);\r\n\r\nXmlDocument myXmlDoc = new XmlDocument();\r\nmyXmlDoc.Load (strXMLURL);\r\n\r\nXslTransform myXslDoc = new XslTransform();\r\nmyXslDoc.Load(strXslFile);\r\n\r\nStringBuilder sb = new StringBuilder();\r\nStringWriter sw = new StringWriter(sb);\r\nmyXslDoc.Transform( myXmlDoc, null, sw, null);\r\nxmlOut = sb.ToString();\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["XSL Transformations","XML/XSL"]},{"RecordId":"813","Title":"XmlHttpRequest - Make Server-side Call From Client-side JavaScript (Similar to Ajax)","Description":"Demonstrates how to use the XmlHttpRequest object to make an asynchronous web request from a web page to retrieve information via a server-side processing page.  Works with IE and non-IE browsers.","Code":"=======================================\r\nPage that performs XmlHttpRequest (1 of 2)\r\n=======================================\r\n&lt;html&gt;\r\n&lt;head&gt;\r\n\r\n&lt;script type=&quot;text/javascript&quot;&gt;\r\n\r\n   var xmlHttpReq;\r\n\r\n\r\n   function sendRequest()\r\n   {\r\n      var catalogId=encodeURIComponent(document.getElementById(&quot;catalogId&quot;).value);\r\n\r\n      xmlHttpReq=init();\r\n      xmlHttpReq.open(&quot;GET&quot;, &quot;GetItem.asp?catalogId=&quot; + catalogId, true);\r\n      xmlHttpReq.onreadystatechange=processRequest;\r\n      xmlHttpReq.send(null);\r\n   }\r\n\r\n   function init()\r\n   {\r\n      if (window.XMLHttpRequest) {\r\n         return new XMLHttpRequest();\r\n      }\r\n      else if (window.ActiveXObject)\r\n      {\r\n         return new ActiveXObject(&quot;Microsoft.XMLHTTP&quot;);\r\n      }\r\n   }\r\n\r\n   function processRequest()\r\n   {\r\n      if(xmlHttpReq.readyState==4)\r\n      {\r\n         if(xmlHttpReq.status==200)\r\n         {\r\n            var msg=xmlHttpReq.responseXML;\r\n            // Sample XML Response  &quot;&lt;catalogId&gt;valid&lt;/catalogId&gt;&quot;\r\n\r\n            var catalogId=msg.getElementsByTagName(&quot;catalogId&quot;)[0].firstChild.nodeValue;\r\n            if(catalogId==&quot;valid&quot;)\r\n            {\r\n               var validationMessage = document.getElementById(&quot;validationMessage&quot;);\r\n               validationMessage.innerHTML = &quot;Catalog Id is Valid&quot;;\r\n            }\r\n            else\r\n            {\r\n               var validationMessage = document.getElementById(&quot;validationMessage&quot;);\r\n               validationMessage.innerHTML = &quot;Catalog Id is not Valid&quot;;\r\n            }\r\n         }\r\n      }\r\n   }\r\n\r\n&lt;/script&gt;\r\n\r\n\r\n&lt;/head&gt;\r\n\r\n&lt;body&gt;\r\n\r\n   &lt;form name=&quot;validationForm&quot; action=&quot;validateForm&quot; method=&quot;post&quot;&gt;\r\n      &lt;table&gt;\r\n         &lt;tr&gt;\r\n            &lt;td&gt;Catalog Id:&lt;/td&gt;\r\n            &lt;td&gt;\r\n               &lt;input type=&quot;text&quot;\r\n                  size=&quot;20&quot;\r\n                  id=&quot;catalogId&quot; name=&quot;catalogId&quot;\r\n                  autocomplete=&quot;off&quot;\r\n                  onkeyup=&quot;sendRequest()&quot; &gt;\r\n            &lt;/td&gt;\r\n            &lt;td&gt;&lt;div id=&quot;validationMessage&quot;&gt;&lt;/div&gt;&lt;/td&gt;\r\n         &lt;/tr&gt;\r\n      &lt;/table&gt;\r\n   &lt;/form&gt;\r\n\r\n&lt;/body&gt;\r\n&lt;/html&gt;\r\n\r\n\r\n=======================================\r\nGetItem.asp (2 of 2)\r\n=======================================\r\n&lt;%@ Language=VBScript %&gt;\r\n&lt;%\r\nOption Explicit\r\n\r\nresponse.Expires = 0\r\nresponse.ContentType=&quot;text/xml&quot;\r\n\r\nDim strItemID\r\nstrItemID = request.querystring(&quot;catalogId&quot;)\r\nif strItemID = &quot;69&quot; then\r\n   response.write &quot;&lt;catalogId&gt;valid&lt;/catalogId&gt;&quot;\r\nelse\r\n   response.write &quot;&lt;catalogId&gt;notvalid&lt;/catalogId&gt;&quot;\r\nend if\r\n\r\nresponse.end\r\n\r\n%&gt;\r\n","Declares":"","CodeCategory":{"CategoryId":"8","CategoryDescription":"XML"},"Keywords":["XmlHttpRequest","Ajax","XML"]},{"RecordId":"814","Title":"Get Members of an Active Directory Group","Description":"Demonstrates how to retrieve the members of an Active Directory group.  NOTE:  Does not traverse nested groups.","Code":"string strDomain = &quot;SomeDomainName&quot;;\r\nstring strGroup = &quot;Some Group Name&quot;;\r\n\r\nstring strOut = string.Empty;\r\nstrOut += &quot;----- getGroupMembers ------------\\n&quot;;\r\nstrOut += &quot;Domain: &quot; + strDomain + &quot;    Group: &quot;+ strGroup + &quot;\\n&quot;;\r\n\r\nDirectoryEntry ent = new DirectoryEntry(&quot;LDAP://DC=&quot; + strDomain + &quot;,DC=com&quot;);\r\nDirectorySearcher srch = new DirectorySearcher(ent, &quot;(CN=&quot; + strGroup + &quot;)&quot;);\r\nSearchResultCollection coll = srch.FindAll();\r\nforeach (SearchResult rs in coll)\r\n{\r\n   ResultPropertyCollection resultPropColl = rs.Properties;\r\n   foreach( Object memberColl in resultPropColl[&quot;member&quot;])\r\n   {\r\n      DirectoryEntry gpMemberEntry = new DirectoryEntry(&quot;LDAP://&quot; + memberColl);\r\n      System.DirectoryServices.PropertyCollection userProps = gpMemberEntry.Properties;\r\n      string acctName = userProps[&quot;sAMAccountName&quot;].Value.ToString();\r\n      //string lastName = userProps[&quot;Sn&quot;].Value.ToString();\r\n      //string firstName = userProps[&quot;givenName&quot;].Value.ToString();\r\n      //string email = userProps[&quot;mail&quot;].Value.ToString();\r\n      strOut += acctName + &quot;\\n&quot;;\r\n   }\r\n}\r\n\r\nstrOut += &quot;\\n\\n&quot;;\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["LDAP","Group Membership","Active Directory"]},{"RecordId":"815","Title":"Secure LDAP Connection","Description":"Shows the connection string needed to make Secure LDAP calls.","Code":"DirectoryEntry objDirEntry = New DirectoryEntry(&quot;LDAP://us.dlt.com:636&quot;, &quot;domain\\user&quot;, &quot;password&quot;, AuthenticationTypes.Secure);\r\n\r\nDirectoryEntry objDirEntry = New DirectoryEntry(&quot;LDAP://USDEV:636&quot;, &quot;domain\\user&quot;, &quot;password&quot;, AuthenticationTypes.Secure);\r\n\r\nThe port for LDAP with SSL is 636.  \r\nIf you are using Global Catalog with SSL, you should use port 3269.\r\n\r\n\r\nNOTE:  We have had problems using port numbers.  I have found evidence that simply including &quot;AuthenticationTypes.SecureSocketsLayer&quot; in the constructor is sufficient to force a secure connection (without using the port number) as follows:\r\n\r\nDirectoryEntry objDirEntry = New DirectoryEntry(&quot;LDAP://us.dlt.com&quot;, &quot;domain\\user&quot;, &quot;password&quot;, AuthenticationTypes.SecureSocketsLayer);\r\n\r\nDirectoryEntry objDirEntry = New DirectoryEntry(&quot;LDAP://USDEV&quot;, &quot;domain\\user&quot;, &quot;password&quot;, AuthenticationTypes.SecureSocketsLayer);","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Secure LDAP"]},{"RecordId":"816","Title":"Performance Counters","Description":"Demonstrates how to Install, Use, and Uninstall performance counters.","Code":"private void InstallCounters()\r\n{\r\n\r\n   // Create a collection of type CounterCreationDataCollection.\r\n   System.Diagnostics.CounterCreationDataCollection CounterDatas = new System.Diagnostics.CounterCreationDataCollection();\r\n\r\n   // Create the counters and set their properties.\r\n   System.Diagnostics.CounterCreationData cdCounter1 = new System.Diagnostics.CounterCreationData();\r\n   System.Diagnostics.CounterCreationData cdCounter2 = new System.Diagnostics.CounterCreationData();\r\n\r\n   cdCounter1.CounterName = &quot;TedzPerfCounter1&quot;;\r\n   cdCounter1.CounterHelp = &quot;Help string1&quot;;\r\n   cdCounter1.CounterType = System.Diagnostics.PerformanceCounterType.NumberOfItems64;\r\n\r\n   cdCounter2.CounterName = &quot;TedzPerfCounter2&quot;;\r\n   cdCounter2.CounterHelp = &quot;Help string 2&quot;;\r\n   cdCounter2.CounterType = System.Diagnostics.PerformanceCounterType.NumberOfItems64;\r\n\r\n   // Add both counters to the collection.\r\n   CounterDatas.Add(cdCounter1);\r\n   CounterDatas.Add(cdCounter2);\r\n\r\n   // Create the category and pass the collection to it.\r\n   System.Diagnostics.PerformanceCounterCategory.Create(&quot;Tedz Perf Counter Category&quot;, &quot;Category help&quot;, CounterDatas);\r\n\r\n}\r\n\r\n\r\nprivate void ExerciseCountersPositiveDirection()\r\n{\r\n   \r\n   System.Diagnostics.PerformanceCounter PC = new System.Diagnostics.PerformanceCounter(&quot;Tedz Perf Counter Category&quot;, &quot;TedzPerfCounter1&quot;, false);\r\n   System.Diagnostics.PerformanceCounter BPC = new System.Diagnostics.PerformanceCounter(&quot;Tedz Perf Counter Category&quot;, &quot;TedzPerfCounter2&quot;, false);\r\n\r\n   for (int i = 0; i &lt; 100; i++)\r\n   {\r\n      PC.IncrementBy(1);\r\n      BPC.Increment();\r\n   }\r\n\r\n   PC.Dispose();\r\n   BPC.Dispose();\r\n   \r\n}\r\n\r\n\r\nprivate void ExerciseCountersNegativeDirection()\r\n{\r\n\r\n   System.Diagnostics.PerformanceCounter PC = new System.Diagnostics.PerformanceCounter(&quot;Tedz Perf Counter Category&quot;, &quot;TedzPerfCounter1&quot;, false);\r\n   System.Diagnostics.PerformanceCounter BPC = new System.Diagnostics.PerformanceCounter(&quot;Tedz Perf Counter Category&quot;, &quot;TedzPerfCounter2&quot;, false);\r\n\r\n   for (int i = 0; i &lt; 100; i++)\r\n   {\r\n      PC.IncrementBy(-1);\r\n      BPC.Decrement();\r\n   }\r\n   \r\n   PC.Dispose();\r\n   BPC.Dispose();\r\n\r\n}\r\n\r\n\r\nprivate void ResetCounterValues()\r\n{\r\n   System.Diagnostics.PerformanceCounter PC = new System.Diagnostics.PerformanceCounter(&quot;Tedz Perf Counter Category&quot;, &quot;TedzPerfCounter1&quot;, false);\r\n   PC.RawValue=0;\r\n\r\n   System.Diagnostics.PerformanceCounter BPC = new System.Diagnostics.PerformanceCounter(&quot;Tedz Perf Counter Category&quot;, &quot;TedzPerfCounter2&quot;, false);\r\n   BPC.RawValue=0;\r\n\r\n   PC.Dispose();\r\n   BPC.Dispose();\r\n   \r\n}\r\n\r\n\r\nprivate void UninstallCounters()\r\n{\r\n   System.Diagnostics.PerformanceCounterCategory.Delete(&quot;Tedz Perf Counter Category&quot;);       \r\n}\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Performance Counters","PerfMon"]},{"RecordId":"817","Title":"SAML Sample","Description":"Demonstrates how to generate SAML Artifact and Assertion.\r\nExcellent examples of Base64 and HexToBin conversions as well as how to deterimine a server's time zone.","Code":"&lt;%@ Language=VBScript %&gt;\r\n&lt;% \r\n' this page operates in two modes:\r\n' 1. Hit the page with &quot;TARGET=someResourceURL&quot; and it will generate an assertion and forward it to the URL\r\n' 2. When the consumer calls back to retrieve the assertion using SOAP/POST, it will\r\n'       return the assertion.\r\n\r\n' IMPORTANT!  For this page to work (meaning correctly get your NT login and use\r\n'  it as your Subject Name in the generated assertion), you need to remove the Anonymous check\r\n'  and check Basic Authentication in IIS Admin Mgr on the properties of THIS PAGE\r\n'  (or the whole virtual dir if this is the only page in it), then make sure the NT test users \r\n'  have NT read/execute rights on this file using Explorer. Your SAML consumer page\r\n'  will therefore need an NT login to use for Basic Authentication to hit this\r\n'  page to retrieve the assertion, and unless you use SSL the password will be sent in\r\n'  clear text, so make sure you don't use your own login for the consumer page.\r\n'\r\n'  If you don't do the above, the assertion will always use a name of &quot;GUEST&quot;, not your\r\n'   own NT login name.\r\n'\r\n' NOTE: This file uses App vars to hold the assertions between calls, as a result this\r\n'       page won't work in a web farm:  Single-server only.  If you need web farm\r\n'       ability, you need to save the assertions in a SQL database somewhere.\r\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\r\n' Some configuration vars you must fill in for this page to work:\r\nDim nArtifactType   ' 1 or 2; 1 is the standard, 2 is an alternate form, rarely used\r\nnArtifactType = 1       \r\nDim sSourceID       ' 40 hex char for type 1 assertions; normally you get by SHA1 hashing your assertion URL\r\nsSourceID = &quot;A89D2E0F36A2225EE8CCA5A03700782ADBA723CF&quot;\r\n\r\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\r\n\r\n' constant to note invalid w3c-format date in the SAML assertion\r\nConst BAD_SAML_DATE = #1/1/1901 00:00:00#\r\n\r\nDim sSAMLProfile, sSAMLTarget, sSAMLArtifact, sSAMLResponse\r\nDim oRequest, oAssertion, oStatus, oConditions, oSubject\r\nDim s, a, i, rs, sVersion, nTimeZoneBias\r\nDim rc, xmlDoc, xmlCall\r\nDim sRequestID, sCallbackURL, sRequestUser, sRequestPW, nLocationFrom, sLocationQuery\r\nDim sFirm, sLocation\r\nDim sSOAPVer\r\n\r\n' SOAP version used in request\r\nsSOAPVer = &quot;1.1&quot;\r\n\r\n' get time zone information, so we generate a valid request\r\nnTimeZoneBias = 0\r\nIf IsNumeric(Application(&quot;TimeZoneBias&quot;)) Then\r\n\tIf CInt(Application(&quot;TimeZoneBias&quot;)) &gt; 0 Then\r\n\t\tnTimeZoneBias = CInt(Application(&quot;TimeZoneBias&quot;))\r\n\tEnd if\r\nEnd if\r\nIf nTimeZoneBias = 0 Then\r\n    ' get time zone offset from registry\r\n\tDim x\r\n    Set x = Server.CreateObject(&quot;WScript.Shell&quot;)\r\n    nTimeZoneBias = x.RegRead(&quot;HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentcontrolSet\\Control\\TimeZoneInformation\\ActiveTimeBias&quot; )       \r\n\tSet x = Nothing\r\n    If IsNumeric(nTimeZoneBias) Then\r\n        Application(&quot;TimeZoneBias&quot;) = nTimeZoneBias\r\n    Else\r\n        nTimeZoneBias = 360 ' time zone offset not found, assume Central time zone\r\n    End if\r\nEnd if\r\nIf nTimezoneBias = 0 Then\r\n  \tEndWithStatus &quot;500 Internal Server Error&quot;, &quot;Cannot determine time zone of server.&quot;, &quot;&quot;\r\nEnd if\r\n\r\n' 1. Browser/SAML artifact (SAML 1.1 Bindings doc section 4.1.1)\r\nIf Request.QueryString(&quot;TARGET&quot;) &lt;&gt; &quot;&quot; Then\r\n    ' this is an initial assertion generation request\r\n    ' SAML1.1 Bind 4.1.1.8 - Artifact is defined as follows: B64(TypeCode RemainingArtifact)\r\n        'TypeCode := 0x0001\r\n        'RemainingArtifact := SourceID AssertionHandle\r\n        'SourceID := 20-byte_sequence\r\n        'AssertionHandle := 20-byte_sequence\r\n    ' SAML1.1 Bind 7.2 Alternate format of Artifact:\r\n        'TypeCode := 0x0002\r\n        'RemainingArtifact := AssertionHandle SourceLocation\r\n        'AssertionHandle := 20-byte_sequence\r\n        'SourceLocation := URI -- The address of the SAML responder associated with the source site.\r\n    If nArtifactType = 1 Then\r\n        sRequestID = chr(0) &amp; chr(1) &amp; HexToBinary(sSourceID)\r\n       \tFor i = 1 To 20\r\n\t        sRequestID = sRequestID &amp; Chr(65 + Int(26 * Rnd))\r\n    \tNext\r\n    Else\r\n        sRequestID = chr(0) &amp; chr(2)\r\n       \tFor i = 1 To 20\r\n\t        sRequestID = sRequestID &amp; Chr(65 + Int(26 * Rnd))\r\n    \tNext\r\n    \t' add this URL\r\n\t    sRequestID = sRequestID &amp; FixSSLUrl(&quot;http://&quot; &amp; Request.ServerVariables(&quot;SERVER_NAME&quot;) &amp; Request.ServerVariables(&quot;URL&quot;))\r\n    End if\r\n    sRequestID = Base64Encode(sRequestID)\r\n    ' save in app vars this request\r\n    Application(&quot;SAML_&quot; &amp; sRequestID) = sRequestID\r\n    Application(&quot;GEN_&quot;  &amp; sRequestID) = Now\r\n    Application(&quot;USER_&quot;  &amp; sRequestID) = Request.ServerVariables(&quot;REMOTE_USER&quot;)\r\n    Application(&quot;TARG_&quot; &amp; sRequestID) = Request.QueryString(&quot;TARGET&quot;)\r\n    \r\n    If Request.ServerVariables(&quot;REMOTE_USER&quot;) = &quot;&quot; Then\r\n        Application(&quot;USER_&quot;  &amp; sRequestID) = &quot;GUEST&quot;\r\n    End if\r\n    Response.Redirect Request.QueryString(&quot;TARGET&quot;) &amp; &quot;?SAMLart=&quot; &amp; Server.URLEncode(sRequestID) &amp; &quot;&amp;TARGET=&quot; &amp; server.URLEncode(Request.QueryString(&quot;TARGET&quot;))\r\nElse\r\n    ' server is calling back to retrieve the assertion\r\n    On Error Resume Next\r\n    Set xmlDoc = Server.CreateObject(&quot;MSXML2.FreeThreadedDOMDocument&quot;)\r\n    If Err.number &lt;&gt; 0 then\r\n    \tEndWithStatus &quot;500 Internal Server Error&quot;, &quot;Cannot create MSXML3 DOM.&quot;, &quot;&quot;\r\n    End if\r\n    xmlDoc.async = false\r\n    xmlDoc.setProperty &quot;SelectionLanguage&quot;, &quot;XPath&quot;\r\n    ' assume SOAP 1.1 first\r\n    xmlDoc.setProperty &quot;SelectionNamespaces&quot;, &quot;xmlns:samlp='urn:oasis:names:tc:SAML:1.0:protocol' xmlns:saml='urn:oasis:names:tc:SAML:1.0:assertion' xmlns:SOAP-ENV='http://schemas.xmlsoap.org/soap/envelope/'&quot;\r\n    a = CStr(Request.BinaryRead(Request.TotalBytes))\r\n    ' BinaryRead produces a Unicode string that needs &quot;translating&quot; to vbscript string\r\n    If LenB(a) &gt; 0 Then\r\n        For i = 1 To LenB(a)\r\n        \ts = s &amp; Chr(AscB(MidB(a,i,1)))\r\n        Next\r\n    End if\r\n\r\n    On Error Resume Next\r\n    xmlDoc.loadXML(s)\r\n    If Err.number &lt;&gt; 0 Then\r\n    \tEndWithStatus &quot;400 Bad request&quot;, &quot;Bad XML: &quot; &amp; err.Description, s\r\n    End if\r\n    \r\n    ' grab the SAML request\r\n    Set oRequest = xmlDoc.selectSingleNode(&quot;SOAP-ENV:Envelope/SOAP-ENV:Body/samlp:Request/samlp:AssertionArtifact&quot;)\r\n    If oRequest Is Nothing Then\r\n        ' try SOAP 1.2 instead\r\n        sSOAPVer = &quot;1.2&quot;\r\n        xmlDoc.setProperty &quot;SelectionNamespaces&quot;, &quot;xmlns:samlp='urn:oasis:names:tc:SAML:1.0:protocol' xmlns:saml='urn:oasis:names:tc:SAML:1.0:assertion' xmlns:SOAP-ENV='http://www.w3.org/2003/05/soap-envelope'&quot;\r\n        Set oRequest = xmlDoc.selectSingleNode(&quot;SOAP-ENV:Envelope/SOAP-ENV:Body/samlp:Request/samlp:AssertionArtifact&quot;)\r\n        If oRequest Is Nothing Then\r\n        \tEndWithStatus &quot;400 Bad request&quot;, &quot;No SAML Request Assertion artifact.&quot;, xmlDoc.text\r\n        End if\r\n    End if\r\n    sSAMLArtifact = oRequest.Text\r\n    sRequestID = xmlDoc.selectSingleNode(&quot;SOAP-ENV:Envelope/SOAP-ENV:Body/samlp:Request&quot;).getAttribute(&quot;RequestID&quot;)\r\n    If sRequestID = &quot;&quot; Then\r\n    \tEndWithStatus &quot;400 Bad request&quot;, &quot;RequestID missing.&quot;, xmlDoc.xml\r\n    End if\r\n    \r\n    ' verify this artifact came from me\r\n    If Application(&quot;SAML_&quot; &amp; sSAMLArtifact) = &quot;&quot; Then\r\n    \tEndWithStatus &quot;400 Bad request&quot;, &quot;Invalid artifact.&quot;, xmlDoc.xml\r\n    End if\r\n    \r\n    ' send saml SOAP response back to caller\r\n    s = &quot;&quot;\r\n    s = GetSAMLResponse(sSAMLArtifact, sRequestID)\r\n    If sSOAPVer = &quot;1.1&quot; Then\r\n        s = &quot;&lt;SOAP-ENV:Envelope xmlns:SOAP-ENV=&quot;&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;&quot;&gt;&lt;SOAP-ENV:Body&gt;&quot; &amp; s &amp; _\r\n            &quot;&lt;/SOAP-ENV:Body&gt;&lt;/SOAP-ENV:Envelope&gt;&quot;\r\n        Response.ContentType = &quot;text/xml&quot;\r\n    Else    ' soap 1.2\r\n        s = &quot;&lt;env:Envelope xmlns:env=&quot;&quot;http://www.w3.org/2003/05/soap-envelope&quot;&quot;&gt;&lt;env:Body&gt;&quot; &amp; s &amp; _\r\n            &quot;&lt;/env:Body&gt;&lt;/env:Envelope&gt;&quot;\r\n        Response.ContentType = &quot;application/soap+xml&quot;\r\n    End if\r\n\r\n    Response.Write s\r\n    Set xmlDoc = Nothing\r\n    Set oRequest = Nothing    \r\n\r\n    ' erase the assertion - single use only\r\n    Application(&quot;SAML_&quot; &amp; sSAMLArtifact) = &quot;&quot;\r\n    Application(&quot;GEN_&quot;  &amp; sSAMLArtifact) = &quot;&quot;\r\n    Application(&quot;USER_&quot;  &amp; sSAMLArtifact) = &quot;&quot;\r\n    Application(&quot;TARG_&quot; &amp; sSAMLArtifact) = &quot;&quot;\r\n    \r\n    Response.End\r\nEnd if\r\n\r\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\r\nFunction GetSAMLResponse(sArt, sReqID)\r\nDim s, i\r\nDim dt, dbefore, dafter, dnow\r\n\r\ndnow = Now\r\ndbefore = ConstructSAMLTime(DateAdd(&quot;n&quot;,-5,dNow))\r\ndafter = ConstructSAMLTime(DateAdd(&quot;n&quot;,10,dNow))\r\ndt = ConstructSAMLTime(dNow)\r\n\r\ns = &quot;&lt;samlp:Response xmlns:samlp=&quot;&quot;urn:oasis:names:tc:SAML:1.0:protocol&quot;&quot; &quot; &amp; _\r\n    &quot;xmlns:saml=&quot;&quot;urn:oasis:names:tc:SAML:1.0:assertion&quot;&quot; &quot; &amp; _\r\n    &quot;MajorVersion=&quot;&quot;1&quot;&quot; MinorVersion=&quot;&quot;0&quot;&quot; &quot; &amp; _\r\n    &quot;ResponseID=&quot;&quot;&quot;\r\nFor i = 1 To 15\r\n    s = s &amp; Int(10 * Rnd) \r\nNext\r\ns = s &amp; &quot;&quot;&quot; &quot; &amp; _\r\n    &quot;InResponseTo=&quot;&quot;&quot; &amp; sReqID &amp; &quot;&quot;&quot; &quot; &amp; _\r\n    &quot;IssueInstant=&quot;&quot;&quot; &amp; dt &amp; &quot;&quot;&quot; &quot; &amp; _\r\n    &quot;Recipient=&quot;&quot;&quot; &amp; Application(&quot;TARG_&quot; &amp; sArt) &amp; &quot;&quot;&quot; &gt;&quot; &amp; _\r\n    &quot;&lt;samlp:Status xmlns:samlp=&quot;&quot;urn:oasis:names:tc:SAML:1.0:protocol&quot;&quot; &quot; &amp; _\r\n    &quot;xmlns:saml=&quot;&quot;urn:oasis:names:tc:SAML:1.0:assertion&quot;&quot; &gt;&quot; &amp; _\r\n    &quot;&lt;samlp:StatusCode Value=&quot;&quot;samlp:Success&quot;&quot;&gt;&lt;/samlp:StatusCode&gt;&lt;/samlp:Status&gt;&quot; &amp; _\r\n    &quot;&lt;saml:Assertion xmlns:saml=&quot;&quot;urn:oasis:names:tc:SAML:1.0:assertion&quot;&quot; &quot; &amp; _\r\n    &quot;MajorVersion=&quot;&quot;1&quot;&quot; MinorVersion=&quot;&quot;0&quot;&quot; &quot; &amp; _\r\n    &quot;AssertionID=&quot;&quot;&quot;\r\nFor i = 1 To 15\r\n    s = s &amp; Int(10 * Rnd) \r\nNext\r\n    s = s &amp; &quot;&quot;&quot; Issuer=&quot;&quot;&quot; &amp; FixSSLUrl(&quot;http://&quot; &amp; Request.ServerVariables(&quot;SERVER_NAME&quot;) &amp; Request.ServerVariables(&quot;URL&quot;)) &amp; &quot;&quot;&quot; &quot; &amp; _\r\n    &quot;IssueInstant=&quot;&quot;&quot; &amp; dt &amp; &quot;&quot;&quot;  &gt;&quot; &amp; _\r\n    &quot;&lt;saml:Conditions NotBefore=&quot;&quot;&quot; &amp; dbefore &amp; &quot;&quot;&quot; NotOnOrAfter=&quot;&quot;&quot; &amp; dafter &amp; &quot;&quot;&quot; &gt;&quot; &amp; _\r\n    &quot;&lt;saml:AudienceRestrictionCondition&gt;&quot; &amp; _\r\n        &quot;&lt;saml:Audience&gt;&quot; &amp; Application(&quot;TARG_&quot; &amp; sArt) &amp; &quot;&lt;/saml:Audience&gt; &quot; &amp; _\r\n    &quot;&lt;/saml:AudienceRestrictionCondition&gt;&quot; &amp; _\r\n    &quot;&lt;/saml:Conditions&gt;&quot; &amp; _\r\n    &quot;&lt;saml:AuthenticationStatement AuthenticationMethod=&quot;&quot;Unspecified&quot;&quot; &quot; &amp; _\r\n      &quot;AuthenticationInstant=&quot;&quot;&quot; &amp; ConstructSAMLTime(Application(&quot;GEN_&quot; &amp; sArt)) &amp; &quot;&quot;&quot;&gt;&quot; &amp; _\r\n      &quot;&lt;saml:Subject&gt;&quot; &amp; _\r\n        &quot;&lt;saml:NameIdentifier &quot; &amp; _\r\n          &quot;NameQualifier=&quot;&quot;RIASamlAssertTest&quot;&quot; &quot;\r\nIf Instr(Application(&quot;USER_&quot; &amp; sArt),&quot;\\&quot;) &gt; 0 Then\r\n    s = s &amp; &quot;Format=&quot;&quot;urn:oasis:names:tc:SAML:1.0:assertion#WindowsDomainQualifiedName&quot;&quot;&gt; &quot;\r\nElse\r\n    s = s &amp; &quot;Format=&quot;&quot;urn:oasis:names:tc:SAML:1.0:assertion&quot;&quot;&gt; &quot;\r\nEnd if   \r\n    s = s &amp; Application(&quot;USER_&quot;  &amp; sArt) &amp; _\r\n        &quot;&lt;/saml:NameIdentifier&gt;&quot; &amp; _\r\n      &quot;&lt;/saml:Subject&gt;&quot; &amp; _\r\n    &quot;&lt;/saml:AuthenticationStatement&gt;&quot; &amp; _\r\n  &quot;&lt;/saml:Assertion&gt;&quot; &amp; _\r\n&quot;&lt;/samlp:Response&gt;&quot;\r\n\r\nGetSAMLResponse = s\r\n\r\nEnd function\r\n\r\n''''''''''''''''''''''''''''''''''''''''\r\n' exit the page with an error status\r\nSub EndWithStatus(sStatus, sMsg, sXML)\r\n    On Error Resume Next\r\n    Response.Status = sStatus\r\n    Response.Write &quot;&lt;H3&gt;&quot; &amp; sStatus &amp; &quot;&lt;/H3&gt;&quot;\r\n    Response.Write &quot;&lt;p&gt;&quot; &amp; sMsg &amp; &quot;&lt;/p&gt;&quot;\r\n    If CStr(sXML) &lt;&gt; &quot;&quot; Then\r\n        Response.Write &quot;&lt;XML&gt;&quot; &amp; sXML &amp; &quot;&lt;/XML&gt;&quot;\r\n    End if\r\n    Session.Abandon\r\n\tResponse.End\r\nEnd sub\r\n\r\n''''''''''''''''''''''''''''''''''''''''\r\n' convert a time from a SAML doc from w3c to VB date\r\nFunction ConvertSAMLTime(sTime)\r\nDim a, d\r\nIf Instr(sTime, &quot;T&quot;) = 0 Or Instr(sTime, &quot;Z&quot;) = 0 Then\r\n    ConvertSAMLTime = BAD_SAML_DATE\r\n    Exit Function\r\nEnd if\r\na = Split(sTime, &quot;T&quot;)\r\na(1) = Left(a(1), Instr(a(1),&quot;Z&quot;)-1)\r\nd = Split(a(0), &quot;-&quot;)\r\nConvertSAMLTime = CDate(d(1) &amp; &quot;/&quot; &amp; d(2) &amp; &quot;/&quot; &amp; d(0) &amp; &quot; &quot; &amp; a(1))\r\nEnd function\r\n\r\n''''''''''''''''''''''''''''\r\nFunction ConstructSAMLTime(ByVal d)\r\n\r\nd = DateAdd(&quot;n&quot;,nTimeZoneBias,d)\r\n\r\nConstructSAMLTime = Year(d) &amp; &quot;-&quot; &amp; Right(&quot;00&quot; &amp; Month(d),2) &amp; &quot;-&quot; &amp; Right(&quot;00&quot; &amp; Day(d),2) &amp; &quot;T&quot; &amp; _\r\n     Right(&quot;00&quot; &amp; Hour(d),2) &amp; &quot;:&quot; &amp; Right(&quot;00&quot; &amp; Minute(d),2) &amp; &quot;:&quot; &amp; Right(&quot;00&quot; &amp; Second(d),2) &amp; &quot;Z&quot;\r\nEnd function\r\n\r\n\r\n''''''''''''''''''''''''''''''''''''''''\r\n' Decodes a base-64 encoded string (BSTR type).\r\n' 1999 - 2004 Antonin Foller, http://www.pstruh.cz\r\n' 1.01 - solves problem with Access And 'Compare Database' (InStr)\r\nFunction Base64Decode(ByVal base64String)\r\n  'rfc1521\r\n  '1999 Antonin Foller, PSTRUH Software, http://pstruh.cz\r\n  Const Base64 = &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;\r\n  Dim dataLength, sOut, groupBegin\r\n  \r\n  'remove white spaces, If any\r\n  base64String = Replace(base64String, vbCrLf, &quot;&quot;)\r\n  base64String = Replace(base64String, vbTab, &quot;&quot;)\r\n  base64String = Replace(base64String, &quot; &quot;, &quot;&quot;)\r\n  \r\n  'The source must consists from groups with Len of 4 chars\r\n  dataLength = Len(base64String)\r\n  If dataLength Mod 4 &lt;&gt; 0 Then\r\n    Err.Raise 1, &quot;Base64Decode&quot;, &quot;Bad Base64 string.&quot;\r\n    Exit Function\r\n  End If\r\n  \r\n  ' Now decode each group:\r\n  For groupBegin = 1 To dataLength Step 4\r\n    Dim numDataBytes, CharCounter, thisChar, thisData, nGroup, pOut\r\n    ' Each data group encodes up To 3 actual bytes.\r\n    numDataBytes = 3\r\n    nGroup = 0\r\n\r\n    For CharCounter = 0 To 3\r\n      ' Convert each character into 6 bits of data, And add it To\r\n      ' an integer For temporary storage.  If a character is a '=', there\r\n      ' is one fewer data byte.  (There can only be a maximum of 2 '=' In\r\n      ' the whole string.)\r\n\r\n      thisChar = Mid(base64String, groupBegin + CharCounter, 1)\r\n\r\n      If thisChar = &quot;=&quot; Then\r\n        numDataBytes = numDataBytes - 1\r\n        thisData = 0\r\n      Else\r\n        thisData = InStr(1, Base64, thisChar, vbBinaryCompare) - 1\r\n      End If\r\n      If thisData = -1 Then\r\n        Err.Raise 2, &quot;Base64Decode&quot;, &quot;Bad character In Base64 string.&quot;\r\n        Exit Function\r\n      End If\r\n\r\n      nGroup = 64 * nGroup + thisData\r\n    Next\r\n    \r\n    'Hex splits the long To 6 groups with 4 bits\r\n    nGroup = Hex(nGroup)\r\n    \r\n    'Add leading zeros\r\n    nGroup = String(6 - Len(nGroup), &quot;0&quot;) &amp; nGroup\r\n    \r\n    'Convert the 3 byte hex integer (6 chars) To 3 characters\r\n    pOut = Chr(CByte(&quot;&amp;H&quot; &amp; Mid(nGroup, 1, 2))) + _\r\n      Chr(CByte(&quot;&amp;H&quot; &amp; Mid(nGroup, 3, 2))) + _\r\n      Chr(CByte(&quot;&amp;H&quot; &amp; Mid(nGroup, 5, 2)))\r\n    \r\n    'add numDataBytes characters To out string\r\n    sOut = sOut &amp; Left(pOut, numDataBytes)\r\n  Next\r\n\r\n  Base64Decode = sOut\r\nEnd Function\r\n\r\nFunction Base64Encode(inData)\r\n  'rfc1521\r\n  '2001 Antonin Foller, PSTRUH Software, http://pstruh.cz\r\n  Const Base64 = &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;\r\n  Dim cOut, sOut, I\r\n  \r\n  'For each group of 3 bytes\r\n  For I = 1 To Len(inData) Step 3\r\n    Dim nGroup, pOut, sGroup\r\n    \r\n    'Create one long from this 3 bytes.\r\n    nGroup = &amp;H10000 * Asc(Mid(inData, I, 1)) + _\r\n      &amp;H100 * MyASC(Mid(inData, I + 1, 1)) + MyASC(Mid(inData, I + 2, 1))\r\n    \r\n    'Oct splits the long To 8 groups with 3 bits\r\n    nGroup = Oct(nGroup)\r\n    \r\n    'Add leading zeros\r\n    nGroup = String(8 - Len(nGroup), &quot;0&quot;) &amp; nGroup\r\n    \r\n    'Convert To base64\r\n    pOut = Mid(Base64, CLng(&quot;&amp;o&quot; &amp; Mid(nGroup, 1, 2)) + 1, 1) + _\r\n      Mid(Base64, CLng(&quot;&amp;o&quot; &amp; Mid(nGroup, 3, 2)) + 1, 1) + _\r\n      Mid(Base64, CLng(&quot;&amp;o&quot; &amp; Mid(nGroup, 5, 2)) + 1, 1) + _\r\n      Mid(Base64, CLng(&quot;&amp;o&quot; &amp; Mid(nGroup, 7, 2)) + 1, 1)\r\n    \r\n    'Add the part To OutPut string\r\n    sOut = sOut + pOut\r\n    \r\n    'Add a new line For Each 76 chars In dest (76*3/4 = 57)\r\n    'If (I + 2) Mod 57 = 0 Then sOut = sOut + vbCrLf\r\n  Next\r\n  Select Case Len(inData) Mod 3\r\n    Case 1: '8 bit final\r\n      sOut = Left(sOut, Len(sOut) - 2) + &quot;==&quot;\r\n    Case 2: '16 bit final\r\n      sOut = Left(sOut, Len(sOut) - 1) + &quot;=&quot;\r\n  End Select\r\n  Base64Encode = sOut\r\nEnd Function\r\n\r\nFunction MyASC(OneChar)\r\n  If OneChar = &quot;&quot; Then MyASC = 0 Else MyASC = Asc(OneChar)\r\nEnd Function\r\n\r\n'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\r\n' given a complete URL, fix the http/https part according to the client's session type\r\nFunction FixSSLURL(sURL)\r\n\r\nDim bSSL\r\nbSSL = False\r\n' the client is SSL if either the F5 SSL cookie is set, or if the server handling the SSL session\r\nIf Request.Cookies(&quot;RIA-SSLTRANSLATION&quot;) &lt;&gt; &quot;&quot; Then\r\n    bSSL = True\r\nElseIf UCase(Request.ServerVariables(&quot;HTTPS&quot;)) = &quot;ON&quot; Then\r\n    bSSL = True\r\nEnd if\r\n\r\n' switch to https or http as necessary depending on URL from caller\r\ns = sURL\r\nIf Not bSSL Then\r\n    If UCase(Left(sURL,6)) = &quot;HTTPS:&quot; Then\r\n        s = &quot;http:&quot; &amp; Mid(sURL,7)\r\n    End if\r\nElse\r\n    If UCase(Left(sURL,5)) = &quot;HTTP:&quot; Then\r\n        s = &quot;https:&quot; &amp; Mid(sURL,6)\r\n    End if\r\nEnd if    \r\nFixSSLURL = s\r\nEnd function\r\n\r\n'******************************************************************************\r\n' utility function to convert hex string to binary string (therefore half as long)\r\nFunction HexToBinary(s)\r\nDim i, k\r\nk = &quot;&quot;\r\nFor i = 1 To Len(s) Step 2\r\n\tk = k &amp; Chr(CInt(&quot;&amp;H&quot; &amp; Mid(s,i,2)))\r\nNext\r\nHexToBinary = k\t\r\nEnd function\r\n\r\n%&gt;","Declares":"","CodeCategory":{"CategoryId":"5","CategoryDescription":"ASP"},"Keywords":["SAML","Base64","HexToBin"]},{"RecordId":"818","Title":"MSN Presence Awareness","Description":"JavaScript to put MSN Messenger presence awareness information on a webpage.","Code":"\r\n&lt;!-- BEGIN MICROSOFT PRESENCE INFORMATION --&gt;\r\n\r\n&lt;script language=&quot;javascript&quot;&gt;\r\n\r\nfunction Browseris ()\r\n{\r\n    var agt = navigator.userAgent.toLowerCase();\r\n    this.osver = 1.0;\r\n    if (agt)\r\n    {\r\n        var stOSVer = agt.substring(agt.indexOf(&quot;windows &quot;) + 11);\r\n        this.osver = parseFloat(stOSVer);\r\n    }\r\n    this.major = parseInt(navigator.appVersion);\r\n    this.nav = ((agt.indexOf('mozilla')!=-1)&amp;&amp;((agt.indexOf('spoofer')==-1) &amp;&amp; (agt.indexOf('compatible')==-1)));\r\n    this.nav2 = (this.nav &amp;&amp; (this.major == 2));\r\n    this.nav3 = (this.nav &amp;&amp; (this.major == 3));\r\n    this.nav4 = (this.nav &amp;&amp; (this.major == 4));\r\n    this.nav6 = this.nav &amp;&amp; (this.major == 5);\r\n    this.nav6up = this.nav &amp;&amp; (this.major &gt;= 5);\r\n    this.nav7up = false;\r\n    if (this.nav6up)\r\n    {\r\n        var navIdx = agt.indexOf(&quot;netscape/&quot;);\r\n        if (navIdx &gt;=0 )\r\n            this.nav7up = parseInt(agt.substring(navIdx+9)) &gt;= 7;\r\n    }\r\n    this.ie = (agt.indexOf(&quot;msie&quot;)!=-1);\r\n    this.aol = this.ie &amp;&amp; agt.indexOf(&quot; aol &quot;)!=-1;\r\n    if (this.ie)\r\n    {\r\n        var stIEVer = agt.substring(agt.indexOf(&quot;msie &quot;) + 5);\r\n        this.iever = parseInt(stIEVer);\r\n        this.verIEFull = parseFloat(stIEVer);\r\n    }\r\n    else\r\n        this.iever = 0;\r\n\r\n    this.ie3 = ( this.ie &amp;&amp; (this.major == 2));\r\n    this.ie4 = ( this.ie &amp;&amp; (this.major == 4));\r\n    this.ie4up = this.ie &amp;&amp; (this.major &gt;=4);\r\n    this.ie5up = this.ie &amp;&amp; (this.iever &gt;= 5);\r\n    this.ie55up = this.ie &amp;&amp; (this.verIEFull &gt;= 5.5);\r\n    this.ie6up = this.ie &amp;&amp; (this.iever &gt;= 6);\r\n    this.win16 = ((agt.indexOf(&quot;win16&quot;)!=-1) || (agt.indexOf(&quot;16bit&quot;)!=-1) || (agt.indexOf(&quot;windows 3.1&quot;)!=-1) || (agt.indexOf(&quot;windows 16-bit&quot;)!=-1) );\r\n    this.win31 = (agt.indexOf(&quot;windows 3.1&quot;)!=-1) || (agt.indexOf(&quot;win16&quot;)!=-1) || (agt.indexOf(&quot;windows 16-bit&quot;)!=-1);\r\n    this.win98 = ((agt.indexOf(&quot;win98&quot;)!=-1)||(agt.indexOf(&quot;windows 98&quot;)!=-1));\r\n    this.win95 = ((agt.indexOf(&quot;win95&quot;)!=-1)||(agt.indexOf(&quot;windows 95&quot;)!=-1));\r\n    this.winnt = ((agt.indexOf(&quot;winnt&quot;)!=-1)||(agt.indexOf(&quot;windows nt&quot;)!=-1));\r\n    this.win32 = this.win95 || this.winnt || this.win98 || ((this.major &gt;= 4) &amp;&amp; (navigator.platform == &quot;Win32&quot;)) || (agt.indexOf(&quot;win32&quot;)!=-1) || (agt.indexOf(&quot;32bit&quot;)!=-1);\r\n    this.os2   = (agt.indexOf(&quot;os/2&quot;)!=-1) || (navigator.appVersion.indexOf(&quot;OS/2&quot;)!=-1) || (agt.indexOf(&quot;ibm-webexplorer&quot;)!=-1);\r\n    this.mac = (agt.indexOf(&quot;mac&quot;)!=-1);\r\n    this.mac68k = this.mac &amp;&amp; ((agt.indexOf(&quot;68k&quot;)!=-1) || (agt.indexOf(&quot;68000&quot;)!=-1));\r\n    this.macppc = this.mac &amp;&amp; ((agt.indexOf(&quot;ppc&quot;)!=-1) || (agt.indexOf(&quot;powerpc&quot;)!=-1));\r\n    this.w3c = this.nav6up;\r\n}\r\n\r\nvar browseris = new Browseris();\r\n\r\nvar IMNControlObj = null;\r\nvar bIMNControlInited = false;\r\nvar IMNDictionaryObj = null;\r\nvar bIMNSorted = false;\r\nvar bIMNOnloadAttached = false;\r\nvar IMNOrigScrollFunc = null;\r\nvar bIMNInScrollFunc = false;\r\nvar IMNSortableObj = null;\r\nvar IMNHeaderObj = null;\r\nvar IMNNameDictionaryObj = null;\r\nvar IMNShowOfflineObj = null;\r\n\r\nfunction EnsureIMNControl()\r\n{\r\n    if (!bIMNControlInited)\r\n    {\r\n        if (browseris.ie5up &amp;&amp; browseris.win32)\r\n        {\r\n\r\n            try\r\n            {\r\n                IMNControlObj = new ActiveXObject(&quot;Name.NameCtrl.1&quot;);\r\n            }\r\n            catch(e)\r\n            {\r\n            };\r\n        }\r\n\r\n        bIMNControlInited = true;\r\n        if (IMNControlObj)\r\n        {\r\n            IMNControlObj.OnStatusChange = IMNOnStatusChange;\r\n        }\r\n    }\r\n    return IMNControlObj;\r\n}\r\n\r\nfunction IMNGetStatusImage(state, showoffline)\r\n{\r\n    var img = &quot;o_blank.gif&quot;;\r\n    switch (state)\r\n    {\r\n        case 0:\r\n            img = &quot;o_imnon.gif&quot;;\r\n            break;\r\n        case 1:\r\n            if (showoffline)\r\n            {\r\n                img = &quot;o_imnoff.gif&quot;;\r\n            }\r\n            else\r\n            {\r\n                img = &quot;o_blank.gif&quot;;\r\n            }\r\n            break;\r\n        case 2:\r\n            img = &quot;o_imnaway.gif&quot;;\r\n            break;\r\n        case 3:\r\n            img = &quot;o_imnbusy.gif&quot;;\r\n            break;\r\n        case 4:\r\n            img = &quot;o_imnaway.gif&quot;;\r\n            break;\r\n        case 5:\r\n            img = &quot;o_imnbusy.gif&quot;;\r\n            break;\r\n        case 6:\r\n            img = &quot;o_imnaway.gif&quot;;\r\n            break;\r\n    }\r\n    return img;\r\n}\r\n\r\nfunction IMNGetHeaderImage()\r\n{\r\n    return &quot;o_imnhdr.gif&quot;;\r\n}\r\n\r\nfunction IMNIsOnlineState(state)\r\n{\r\n    if (state == 1)\r\n    {\r\n        return false;\r\n    }\r\n    return true;\r\n}\r\n\r\nfunction IMNSortList(j, oldState, state)\r\n{\r\n    var objTable = null;\r\n    var objRow = null;\r\n    if (IMNSortableObj &amp;&amp; IMNSortableObj[j])\r\n    {\r\n        objRow = document.getElementById(j);\r\n        while (objRow &amp;&amp; !(objRow.tagName == &quot;TR&quot; &amp;&amp; typeof(objRow.Sortable) != &quot;undefined&quot;))\r\n        {\r\n            objRow = objRow.parentNode;\r\n        }\r\n        objTable = objRow;\r\n        while (objTable &amp;&amp; objTable.tagName != &quot;TABLE&quot;)\r\n        {\r\n            objTable = objTable.parentNode;\r\n        }\r\n        if (objTable != null &amp;&amp; objRow != null)\r\n        {\r\n            if (objTable.rows[1].style.display == &quot;none&quot;)\r\n            {\r\n                for (i=1; i&lt;4; i++)\r\n                {\r\n                    objTable.rows[i].style.display = &quot;block&quot;;\r\n                }\r\n            }\r\n            if (!IMNIsOnlineState(oldState) &amp;&amp; IMNIsOnlineState(state))\r\n            {\r\n                objTable.rows[2].style.display = &quot;none&quot;;\r\n                i = 3;\r\n                while (objTable.rows[i].id != &quot;Offline&quot; &amp;&amp; objTable.rows[i].innerText &lt; objRow.innerText)\r\n                    i++;\r\n                objTable.moveRow(objRow.rowIndex, i);\r\n                if ( objTable.rows[objTable.rows.length - 3].id == &quot;Offline&quot;)\r\n                {\r\n                    objTable.rows[objTable.rows.length - 2].style.display = &quot;block&quot;;\r\n                }\r\n            }\r\n            else if (IMNIsOnlineState(oldState) &amp;&amp; !IMNIsOnlineState(state))\r\n            {\r\n                if (objRow.rowIndex == 3 &amp;&amp; objTable.rows[objRow.rowIndex + 1].id == &quot;Offline&quot;)\r\n                {\r\n                    objTable.rows[2].style.display = &quot;block&quot;;\r\n                }\r\n                if (objTable.rows[objTable.rows.length - 3].id == &quot;Offline&quot;)\r\n                {\r\n                    objTable.rows[objTable.rows.length - 2].style.display = &quot;none&quot;;\r\n                }\r\n                i = objTable.rows.length - 2;\r\n                while (objTable.rows[i - 1].id != &quot;Offline&quot; &amp;&amp; objTable.rows[i].innerText &gt; objRow.innerText)\r\n                    i--;\r\n                objTable.moveRow(objRow.rowIndex, i);\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nfunction IMNOnStatusChange(name, state, id)\r\n{\r\n    if (IMNDictionaryObj)\r\n    {\r\n        var img = IMNGetStatusImage(state, IMNSortableObj[id] ||\r\n        IMNShowOfflineObj[id]);\r\n        if (IMNDictionaryObj[id] != state)\r\n        {\r\n            if (bIMNSorted)\r\n                IMNSortList(id, IMNDictionaryObj[id], state);\r\n            IMNUpdateImage(id, img);\r\n            IMNDictionaryObj[id] = state;\r\n        }\r\n    }\r\n}\r\n\r\nfunction IMNUpdateImage(id, img)\r\n{\r\n    var obj = document.images(id);\r\n    if (obj)\r\n    {\r\n        var oldImg = obj.src;\r\n        var index = oldImg.lastIndexOf(&quot;/&quot;);\r\n        var newImg = oldImg.slice(0, index + 1);\r\n        newImg += img;\r\n        if (oldImg != newImg)\r\n            obj.src = newImg;\r\n        if (obj.altbase)\r\n        {\r\n            obj.alt = obj.altbase;\r\n        }\r\n    }\r\n}\r\n\r\nfunction IMNHandleAccelerator()\r\n{\r\n    if (IMNControlObj)\r\n    {\r\n        if (event.altKey &amp;&amp; event.shiftKey &amp;&amp; event.keyCode==121)\r\n        {\r\n            IMNControlObj.DoAccelerator();\r\n        }\r\n    }\r\n}\r\n\r\nfunction IMNGetOOUILocation(obj)\r\n{\r\n    var objRet = new Object;\r\n    var objSpan = obj;\r\n    var objOOUI = obj;\r\n    var oouiX = 0, oouiY = 0, objDX = 0;\r\n    var fRtl = document.dir == &quot;rtl&quot;;\r\n    while (objSpan &amp;&amp; objSpan.tagName != &quot;SPAN&quot; &amp;&amp; objSpan.tagName != &quot;TABLE&quot;)\r\n    {\r\n        objSpan = objSpan.parentNode;\r\n    }\r\n    if (objSpan)\r\n    {\r\n        var collNodes = objSpan.tagName == &quot;TABLE&quot; ?\r\n        objSpan.rows(0).cells(0).childNodes :\r\n        objSpan.childNodes;\r\n        var i;\r\n        for (i = 0; i &lt; collNodes.length; ++i)\r\n        {\r\n            if (collNodes.item(i).tagName == &quot;IMG&quot; &amp;&amp; collNodes.item(i).id)\r\n            {\r\n                objOOUI = collNodes.item(i);\r\n                break;\r\n            }\r\n        }\r\n    }\r\n    obj = objOOUI;\r\n    while (obj)\r\n    {\r\n        if (fRtl)\r\n        {\r\n            if (obj.scrollWidth &gt;= obj.clientWidth + obj.scrollLeft)\r\n                objDX = obj.scrollWidth - obj.clientWidth - obj.scrollLeft;\r\n            else\r\n                objDX = obj.clientWidth + obj.scrollLeft - obj.scrollWidth;\r\n            oouiX += obj.offsetLeft + objDX;\r\n        }\r\n        else\r\n            oouiX += obj.offsetLeft - obj.scrollLeft;\r\n        oouiY += obj.offsetTop - obj.scrollTop;\r\n        obj = obj.offsetParent;\r\n    }\r\n\r\n    try\r\n    {\r\n        obj = window.frameElement;\r\n        while (obj)\r\n        {\r\n            if (fRtl)\r\n            {\r\n                if (obj.scrollWidth &gt;= obj.clientWidth + obj.scrollLeft)\r\n                    objDX = obj.scrollWidth - obj.clientWidth - obj.scrollLeft;\r\n                else\r\n                    objDX = obj.clientWidth + obj.scrollLeft - obj.scrollWidth;\r\n                oouiX += obj.offsetLeft + objDX;\r\n            }\r\n            else\r\n                oouiX += obj.offsetLeft - obj.scrollLeft;\r\n            oouiY += obj.offsetTop - obj.scrollTop;\r\n            obj = obj.offsetParent;\r\n        }\r\n    }\r\n    catch(e)\r\n    {\r\n    };\r\n\r\n    objRet.objSpan = objSpan;\r\n    objRet.objOOUI = objOOUI;\r\n    objRet.oouiX = oouiX;\r\n    objRet.oouiY = oouiY;\r\n    if (fRtl)\r\n        objRet.oouiX += objOOUI.offsetWidth;\r\n    return objRet;\r\n}\r\n\r\nfunction IMNShowOOUIMouse()\r\n{\r\n    IMNShowOOUI(0);\r\n}\r\n\r\nfunction IMNShowOOUIKyb()\r\n{\r\n    IMNShowOOUI(1);\r\n}\r\n\r\nfunction IMNShowOOUI(inputType)\r\n{\r\n    if (browseris.ie5up &amp;&amp; browseris.win32)\r\n    {\r\n        var obj = window.event.srcElement;\r\n        var objSpan = obj;\r\n        var objOOUI = obj;\r\n        var oouiX = 0, oouiY = 0;\r\n        if (EnsureIMNControl() &amp;&amp; IMNNameDictionaryObj)\r\n        {\r\n            var objRet = IMNGetOOUILocation(obj);\r\n            objSpan = objRet.objSpan;\r\n            objOOUI = objRet.objOOUI;\r\n            oouiX = objRet.oouiX;\r\n            oouiY = objRet.oouiY;\r\n            var name = IMNNameDictionaryObj[objOOUI.id];\r\n            if (objSpan)\r\n                objSpan.onkeydown = IMNHandleAccelerator;\r\n            IMNControlObj.ShowOOUI(name, inputType, oouiX, oouiY);\r\n        }\r\n    }\r\n}\r\n\r\nfunction IMNHideOOUI()\r\n{\r\n    if (IMNControlObj)\r\n    {\r\n        IMNControlObj.HideOOUI();\r\n        return false;\r\n    }\r\n    return true;\r\n}\r\n\r\nfunction IMNScroll()\r\n{\r\n    if (!bIMNInScrollFunc)\r\n    {\r\n        bIMNInScrollFunc = true;\r\n        IMNHideOOUI();\r\n    }\r\n    bIMNInScrollFunc = false;\r\n    return IMNOrigScrollFunc ? IMNOrigScrollFunc() : true;\r\n}\r\n\r\nfunction IMNRC(name)\r\n{\r\n    if (name == null || name == '')\r\n        return;\r\n\r\n    if (browseris.ie5up &amp;&amp; browseris.win32)\r\n    {\r\n        var obj = window.event.srcElement;\r\n        var objSpan = obj;\r\n        var id = obj.id;\r\n        var fFirst = false;\r\n        if (!IMNDictionaryObj)\r\n        {\r\n            IMNDictionaryObj = new Object();\r\n            IMNNameDictionaryObj = new Object();\r\n            IMNSortableObj = new Object();\r\n            IMNShowOfflineObj = new Object();\r\n            if (!IMNOrigScrollFunc)\r\n            {\r\n                IMNOrigScrollFunc = window.onscroll;\r\n                window.onscroll = IMNScroll;\r\n            }\r\n        }\r\n        if (IMNDictionaryObj)\r\n        {\r\n            if (!IMNNameDictionaryObj[id])\r\n            {\r\n                IMNNameDictionaryObj[id] = name;\r\n                fFirst = true;\r\n            }\r\n            if (typeof(IMNDictionaryObj[id]) == &quot;undefined&quot;)\r\n            {\r\n                IMNDictionaryObj[id] = 1;\r\n            }\r\n            if (!IMNSortableObj[id] &amp;&amp; (typeof(obj.Sortable) != &quot;undefined&quot;))\r\n            {\r\n                IMNSortableObj[id] = obj.Sortable;\r\n                if (!bIMNOnloadAttached)\r\n                {\r\n                    if (EnsureIMNControl() &amp;&amp; IMNControlObj.PresenceEnabled)\r\n                        window.attachEvent(&quot;onload&quot;, IMNSortTable);\r\n                    bIMNOnloadAttached = true;\r\n                }\r\n            }\r\n\r\n            if (!IMNShowOfflineObj[id] &amp;&amp; (typeof(obj.ShowOfflinePawn) != &quot;undefined&quot;))\r\n            {\r\n                IMNShowOfflineObj[id] = obj.ShowOfflinePawn;\r\n            }\r\n            if (fFirst &amp;&amp; EnsureIMNControl() &amp;&amp; IMNControlObj.PresenceEnabled)\r\n            {\r\n                var state = 1, img;\r\n                state = IMNControlObj.GetStatus(name, id);\r\n                if (IMNIsOnlineState(state) || IMNSortableObj[id] ||IMNShowOfflineObj[id])\r\n                {\r\n                    img = IMNGetStatusImage(state, IMNSortableObj[id] || IMNShowOfflineObj[id]);\r\n                    IMNUpdateImage(id, img);\r\n                    IMNDictionaryObj[id] = state;\r\n                }\r\n            }\r\n        }\r\n        if (fFirst)\r\n        {\r\n            var objRet = IMNGetOOUILocation(obj);\r\n            objSpan = objRet.objSpan;\r\n            if (objSpan)\r\n            {\r\n                objSpan.onmouseover = IMNShowOOUIMouse;\r\n                objSpan.onfocusin = IMNShowOOUIKyb;\r\n                objSpan.onmouseout = IMNHideOOUI;\r\n                objSpan.onfocusout = IMNHideOOUI;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nfunction IMNSortTable()\r\n{\r\n    var id;\r\n    for (id in IMNDictionaryObj)\r\n    {\r\n        IMNSortList(id, 1, IMNDictionaryObj[id]);\r\n    }\r\n    bIMNSorted = true;\r\n}\r\n\r\nfunction IMNRegisterHeader()\r\n{\r\n    if (browseris.ie5up &amp;&amp; browseris.win32)\r\n    {\r\n        var obj = window.event.srcElement;\r\n        if (!IMNHeaderObj)\r\n        {\r\n            IMNHeaderObj = new Object();\r\n        }\r\n        if (IMNHeaderObj)\r\n        {\r\n            var id = obj.id;\r\n            if (!IMNHeaderObj[id])\r\n            {\r\n                IMNHeaderObj[id] = id;\r\n                var img;\r\n                img = IMNGetHeaderImage();\r\n                IMNUpdateImage(id, img);\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n\r\n&lt;/script&gt;\r\n\r\n&lt;script type=&quot;text/javascript&quot;&gt;\r\n\r\nif (!document.layers &amp;&amp; !document.all &amp;&amp; !document.getElementById)\r\n    Event=&quot;test&quot;\r\n\r\nfunction showtip(current,e,text)\r\n{\r\n    if (document.all||document.getElementById)\r\n    {\r\n        thetitle=text.split('&lt;br&gt;')\r\n        if (thetitle.length&gt;1)\r\n        {\r\n            thetitles=''\r\n            for (i=0;i&lt;thetitle.length;i++)\r\n            thetitles+=thetitle[i]\r\n            current.title=thetitles\r\n        }\r\n        else\r\n            current.title=text\r\n    }\r\n\r\n    else if (document.layers)\r\n    {\r\n        document.tooltip.document.write('&lt;layer bgColor=&quot;white&quot; style=&quot;border:1px solid #005CB2;font-size:12px;font-family:verdana;&quot;&gt;'+text+'&lt;/layer&gt;')\r\n        document.tooltip.document.close()\r\n        document.tooltip.left=e.pageX+5\r\n        document.tooltip.top=e.pageY+5\r\n        document.tooltip.visibility=&quot;show&quot;\r\n    }\r\n}\r\n\r\nfunction hidetip()\r\n{\r\n    if (document.layers)\r\n        document.tooltip.visibility=&quot;hidden&quot;\r\n}\r\n\r\n&lt;/script&gt;\r\n\r\n&lt;style type=&quot;text/css&quot;&gt;\r\n    body { scrollbar-face-color: #f4f4f0; scrollbar-shadow-color: #d0d0d0; scrollbar-highlight-color: #FFFFFF; scrollbar-3dlight-color: #4F4F82; scrollbar-darkshadow-color: #4F4F82; scrollbar-track-color: #ffffff; scrollbar-arrow-color: #0066C8; }\r\n    .sectionHead, .subMenuHead {display: inline-block; FILTER: progid:DXImageTransform.Microsoft.Gradient(gradientType=0,startColorStr=#D8E8FC,endColorStr=#8F9CB8)}\r\n    .sectionBody {height:100%;}\r\n    .section {border: 1px solid #005CB2; margin-bottom:10px; margin-right:5px; width:120px; background-color:#ffffff;}\r\n    .sectionHead {background-color:#B2C1DA; border-bottom: 1px solid #88ACE3; padding:2px; font-variant: small-caps; font-face: verdana; color:#000F41;}\r\n    .sectionHead a {color: #000F41;}\r\n    .sectionBody {padding:2px; padding-top:4px; padding-bottom:12px; border-bottom: 2px solid #f4f4f0;}\r\n&lt;/style&gt;\r\n\r\n&lt;!-- --&gt;\r\n&lt;div class=&quot;section&quot;&gt;\r\n    &lt;div class=&quot;sectionHead&quot; onMouseover=&quot;showtip(this,event,'sample tip')&quot; onMouseout=&quot;hidetip()&quot;&gt;MSN Presence&lt;/div&gt;\r\n    &lt;div class=&quot;sectionBody&quot;&gt;\r\n        &lt;span&gt;\r\n            &lt;font face=&quot;verdana&quot; size=1 color=black&gt;\r\n                &lt;img border=&quot;0&quot; height=&quot;12&quot; width=&quot;12&quot; src=&quot;o_blank.gif&quot; onload=&quot;IMNRegisterHeader();IMNRC('someuser1@here.com')&quot; id=&quot;IMID1&quot; ShowOfflinePawn=1&gt;\r\n            &lt;/font&gt;\r\n        &lt;/span&gt; &lt;b&gt;User 1&lt;/b&gt;\r\n        &lt;br&gt;\r\n        &lt;span&gt;\r\n            &lt;font face=&quot;verdana&quot; size=1 color=black&gt;\r\n                &lt;img border=&quot;0&quot; height=&quot;12&quot; width=&quot;12&quot; src=&quot;o_blank.gif&quot; onload=&quot;IMNRegisterHeader();IMNRC('someuser2@here.com')&quot; id=&quot;IMID2&quot; ShowOfflinePawn=1&gt;\r\n            &lt;/font&gt;\r\n        &lt;/span&gt; &lt;b&gt;User 2&lt;/b&gt;\r\n        &lt;br&gt;\r\n        &lt;span&gt;\r\n            &lt;font face=&quot;verdana&quot; size=1 color=black&gt;\r\n                &lt;img border=&quot;0&quot; height=&quot;12&quot; width=&quot;12&quot; src=&quot;o_blank.gif&quot; onload=&quot;IMNRegisterHeader();IMNRC('someuser3@here.com')&quot; id=&quot;IMID3&quot; ShowOfflinePawn=1&gt;\r\n            &lt;/font&gt;\r\n        &lt;/span&gt; &lt;b&gt;User 3&lt;/b&gt;\r\n        &lt;br&gt;\r\n    &lt;/div&gt;\r\n&lt;/div&gt;\r\n\r\n&lt;!-- END PRESENCE INFORMATION --&gt;\r\n\r\n","Declares":"Assumes that the following GIFs are included (which are the online, busy, away, etc. icons):\r\no_blank.gif\r\no_imnaway.gif\r\no_imnbusy.gif\r\no_imnhdr.gif\r\no_imnoff.gif\r\no_imnon.gif","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["MSN Messenger Presence","Presence Awareness"]},{"RecordId":"819","Title":"Adding User to Active Directory Group","Description":"Demonstrates two methods of adding a user to an active directory group.","Code":"---- Example 1 ---------------------------------------------------\r\n\r\n// Create a directory entry pointing to the location of the standard OU where the My Standard Group security group is contained\r\nDirectoryEntry groupDE = new DirectoryEntry();\r\n\r\n// Set credentials of an AD account to &quot;Run As&quot;\r\ngroupDE.Username = username;\r\ngroupDE.Password = password;\r\n\r\n// Set active LDAP path to be the OU where the security group is contained\r\ngroupDE.Path = LDAPpath;\r\n\r\n// Find the security group within the OU\r\nDirectoryEntry groupEntry = groupDE.Children.Find(&quot;CN=My Standard Group&quot;, &quot;group&quot;);\r\n\r\n// Add the user we just created to the security group\r\ngroupEntry.Invoke(&quot;add&quot;, new object[] {user.Path});\r\n\r\n// Commit the changes of adding the user to the security group\r\ngroupEntry.CommitChanges();\r\n\r\n\r\n\r\n---- Example 2 ---------------------------------------------------\r\n\r\nDirectoryEntry grp = new DirectoryEntry(GroupName);\r\ngrp.Username = username;\r\ngrp.Password = password;\r\nif (grp!=null)\r\n{\r\n\tgrp.Properties[&quot;member&quot;].Add(strUserLDAPString);\r\n\tgrp.CommitChanges();\r\n}\r\n\r\n\r\n\r\n---- Example 3 ---------------------------------------------------\r\n\r\nDirectoryEntry dom = new DirectoryEntry();\r\nDirectoryEntry group = dom.Children.Find(&quot;CN=Consulting&quot;);\r\ngroup.Username = username;\r\ngroup.Password = password;\r\n\r\n// Add a single user to a group;\r\nDirectoryEntry usr = group.Children.Find(&quot;CN=New User&quot;);\r\n\r\n//To add the user's distinguished name to the member property on the group object, use the Add method.\r\ngroup.Properties[&quot;member&quot;].Add(usr.Properties[&quot;distinguishedName&quot;].Value);\r\n\r\n//Commit the changes to the directory.\r\ngroup.CommitChanges();","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Add Member to Group","ADSI","Active Directory"]},{"RecordId":"820","Title":"Data Driven Business Entity Objects","Description":"Demonstrates how to tag business entity objects with attributes that specify stored procedures, parms, and field mappings so that the business entity object automatically maps to the underlying database table.","Code":"The following samples were built by Kevin Martinelli (who is one of the best programmers that I've ever had the pleasure of working with).\r\n\r\n//*****************************************************\r\n// File 1 of 2 (This is the business entity object)\r\n//*****************************************************\r\n\r\nusing System;\r\nusing NameSpace1.NHP.Common;\r\nusing NameSpace1.NHP.Common.Exceptions;\r\nusing NameSpace1.NHP.Common.Validation;\r\n\r\nnamespace  NameSpace1.NHP.Common\r\n{\r\n    [Serializable]\r\n    [PersistConfig(\r\n         &quot;CreateProc=pub_InsertCPAExam(Candidate_SID, ExamTypeCode, TestDate, Grade, TimesTaken, State_SID);&quot; +\r\n         &quot;ReadProc=pub_GetCPAExamByPrimaryKey(CPAExam_SID);&quot; +\r\n         &quot;UpdateProc=pub_UpdateCPAExam(CPAExam_SID, Candidate_SID, ExamTypeCode, TestDate, Grade, TimesTaken, State_SID);&quot; +\r\n         &quot;DeleteProc=pub_DeleteCPAExam(CPAExam_SID);&quot; +\r\n         &quot;ReadAllProc=pub_GetCPAExamAll();&quot; +\r\n         &quot;ReadByCandidateID=pub_GetCPAExamByCandidateSID(Candidate_SID)&quot;)]\r\n    public class CPAExam : DataEntityBase\r\n    {\r\n        #region Instance Variables\r\n        Int32 _cPAExam_SID;\r\n        Int32 _candidate_SID;\r\n        Byte _examTypeCode;\r\n        DateTime _testDate;\r\n        String _grade;\r\n        String _timesTaken;\r\n        Int32 _state_SID;\r\n\r\n        #endregion Instance Variables\r\n\r\n        #region Constructors\r\n        internal CPAExam()\r\n        {\r\n            _cPAExam_SID=Int32.MinValue;\r\n            _candidate_SID=Int32.MinValue;\r\n            _examTypeCode=Byte.MinValue;\r\n            _testDate=DateTime.MinValue;\r\n            _grade=null;\r\n            _timesTaken=null;\r\n            _state_SID=Int32.MinValue;\r\n        }\r\n\r\n        public CPAExam(int Candidate_SID) : this()\r\n        {\r\n            _candidate_SID = Candidate_SID;\r\n        }\r\n\r\n        internal CPAExam(\r\n            Int32 CPAExam_SID\r\n            ,Int32 Candidate_SID\r\n            ,Byte ExamTypeCode\r\n            ,DateTime TestDate\r\n            ,String Grade\r\n            ,String TimesTaken\r\n            ,Int32 State_SID\r\n            ) : this()\r\n        {\r\n            _cPAExam_SID=CPAExam_SID;\r\n            _candidate_SID=Candidate_SID;\r\n            _examTypeCode=ExamTypeCode;\r\n            _testDate=TestDate;\r\n            _grade=Grade;\r\n            _timesTaken=TimesTaken;\r\n            _state_SID=State_SID;\r\n        }\r\n        #endregion Constructors\r\n\r\n        #region Properties\r\n\r\n        #region Candidate_SID\r\n        [PersistConfig (&quot;Param=@candidate_SID;DbType=Int32;Nullable=False&quot;)]\r\n        protected internal override int Candidate_SID\r\n        {\r\n            get\r\n            {\r\n                return _candidate_SID;\r\n            }\r\n\r\n            set\r\n            {\r\n                _candidate_SID = value;\r\n            }\r\n        }\r\n        #endregion Candidate_SID\r\n\r\n\r\n        #region CPAExam_SID\r\n        [PersistConfig (&quot;Param=@CPAExam_SID;DbType=Int32;Nullable=False&quot;)]\r\n        public Int32 CPAExam_SID\r\n        {\r\n            get\r\n            {\r\n                return _cPAExam_SID;\r\n            }\r\n\r\n            set\r\n            {\r\n                _cPAExam_SID = value;\r\n            }\r\n        }\r\n        #endregion CPAExam_SID\r\n\r\n        #region ExamTypeCode\r\n        [PersistConfig (&quot;Param=@ExamTypeCode;DbType=Byte;Nullable=False&quot;)]\r\n        public Byte ExamTypeCode\r\n        {\r\n            get\r\n            {\r\n                return _examTypeCode;\r\n            }\r\n\r\n            set\r\n            {\r\n                _examTypeCode = value;\r\n            }\r\n        }\r\n        #endregion ExamTypeCode\r\n\r\n        #region TestDate\r\n        [PersistConfig (&quot;Param=@TestDate;DbType=DateTime;Nullable=True&quot;)]\r\n        public DateTime TestDate\r\n        {\r\n            get\r\n            {\r\n                return _testDate;\r\n            }\r\n\r\n            set\r\n            {\r\n                _testDate = value;\r\n            }\r\n        }\r\n        #endregion TestDate\r\n\r\n        #region Grade\r\n        [PersistConfig (&quot;Param=@Grade;DbType=String;Nullable=True&quot;)]\r\n        public String Grade\r\n        {\r\n            get\r\n            {\r\n                return _grade;\r\n            }\r\n\r\n            set\r\n            {\r\n                _grade = Encode(value);\r\n            }\r\n        }\r\n        #endregion Grade\r\n\r\n        #region TimesTaken\r\n        [PersistConfig (&quot;Param=@TimesTaken;DbType=String;Nullable=True&quot;)]\r\n        public String TimesTaken\r\n        {\r\n            get\r\n            {\r\n                return _timesTaken;\r\n            }\r\n\r\n            set\r\n            {\r\n                _timesTaken = Encode(value);\r\n            }\r\n        }\r\n        #endregion TimesTaken\r\n\r\n        #region State_SID\r\n        [PersistConfig (&quot;Param=@State_SID;DbType=Int32;Nullable=True&quot;)]\r\n        public Int32 State_SID\r\n        {\r\n            get\r\n            {\r\n                return _state_SID;\r\n            }\r\n\r\n            set\r\n            {\r\n                if(value &lt;= 0) value = Int32.MinValue;\r\n                _state_SID = value;\r\n            }\r\n        }\r\n        #endregion State_SID\r\n\r\n\r\n        #region EntityID\r\n        public override int EntityID\r\n        {\r\n            get\r\n            {\r\n                return CPAExam_SID;\r\n            }\r\n        }\r\n        #endregion EntityID\r\n\r\n        #region EntityIDInternal\r\n        internal override int EntityIDInternal\r\n        {\r\n            get\r\n            {\r\n                return CPAExam_SID;\r\n            }\r\n\r\n            set\r\n            {\r\n                CPAExam_SID = value;\r\n            }\r\n        }\r\n        #endregion EntityIDInternal\r\n        #endregion Properties\r\n\r\n        #region Custom Code\r\n        public override BusinessRuleException[] Validate()\r\n        {\r\n            Validator validator = new Validator();\r\n\r\n            validator.IsNull(State_SID, typeof(Int32), &quot;State is empty.&quot;);\r\n            validator.IsNull(ExamTypeCode, typeof(Int32), &quot;Exam Type Code is empty.&quot;);\r\n            validator.IsNull(TestDate, typeof(DateTime), &quot;Test Date is empty.&quot;);\r\n\r\n            if (0 &lt; DateTime.Compare(DateTime.Now, TestDate))\r\n            {\r\n                validator.AddException(&quot;Test Date must be prior than the current date.&quot;);\r\n            }\r\n\r\n            return validator.Exceptions;\r\n        }\r\n\r\n        Guid _uniqueID = Guid.NewGuid();\r\n        public Guid UniqueID\r\n        {\r\n            get { return _uniqueID; }\r\n        }\r\n        #endregion Custom sCode\r\n    }\r\n}\r\n\r\n\r\n\r\n//*****************************************************\r\n// File 2 of 2 (This is the sql processor that performs the mapping)\r\n//*****************************************************\r\n\r\n\r\nusing System;\r\nusing System.Data;\r\nusing System.Data.SqlClient;\r\nusing System.Reflection;\r\nusing System.Text.RegularExpressions;\r\n\r\nusing NameSpace1.NHP.Common.Diagnostics;\r\n\r\nusing Microsoft.Practices.EnterpriseLibrary.Data;\r\nusing Microsoft.Practices.EnterpriseLibrary.Data.Configuration;\r\n\r\nnamespace NameSpace1.NHP.Common\r\n{\r\n    public sealed class SqlProcessor\r\n    {\r\n        private PersistConfigAttribute _classAttribute;\r\n        private object _dataEntity;\r\n        private Database _database;\r\n\r\n        public SqlProcessor()\r\n        {\r\n        }\r\n\r\n        public SqlProcessor(object dataEntity)\r\n        {\r\n            DataEntity = dataEntity;\r\n            GetAttributes();\r\n        }\r\n\r\n        private void GetAttributes()\r\n        {\r\n//          object[] attributes = _dataEntity.GetType().GetCustomAttributes(typeof(PersistConfigAttribute), true);\r\n            object[] attributes = _dataEntity.GetType().GetCustomAttributes(false);\r\n\r\n            if (null != attributes &amp;&amp; 0 &lt; attributes.Length)\r\n            {\r\n                foreach(Attribute attribute in attributes)\r\n                {\r\n                    if(attribute is PersistConfigAttribute)\r\n                    {\r\n                        _classAttribute = (PersistConfigAttribute)attribute;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n\r\n            if(_classAttribute == null)\r\n            {\r\n                SqlProcessorException spe = new SqlProcessorException(\r\n                    &quot;Could not find the PersistConfig attribute.&quot;);\r\n\r\n                spe.AddObject(&quot;Data Entity&quot;, _dataEntity);\r\n\r\n                spe[&quot;Attributes Count&quot;] = attributes.Length;\r\n\r\n                for(int counter = 0;\r\n                    counter &lt; attributes.Length;\r\n                    counter++)\r\n                {\r\n                    spe.AddObject(&quot;Attribute_&quot; + counter,\r\n                        attributes[counter]);\r\n                }\r\n\r\n                throw spe;\r\n            }\r\n        }\r\n\r\n        public int Create(Guid TransactionGuid)\r\n        {\r\n            DBCommandWrapper command = GetCommand(&quot;CreateProc&quot;);\r\n\r\n            return ExecuteNonQuery(command, TransactionGuid, true);\r\n        }\r\n\r\n        public int ExecuteNonQuery(DBCommandWrapper command, Guid transactionGuid, bool executeScalar)\r\n        {\r\n            if (null == _classAttribute)\r\n            {\r\n                GetAttributes();\r\n            }\r\n\r\n            AddCommandParameters(command);\r\n\r\n            object returnValue = null;\r\n            PersistentTransaction persistentTransaction = null;\r\n            IDbTransaction sqlTransaction = null;\r\n            IDbConnection sqlConnection = null;\r\n\r\n            try\r\n            {\r\n                // Attempt to get the PersistentTransaction object from the TransactionManager\r\n                persistentTransaction = GetPersistentTransaction(transactionGuid);\r\n\r\n                if (null != persistentTransaction)\r\n                {\r\n                    sqlTransaction = persistentTransaction.GetTransaction(ProvisioningDatabase.ConfigurationName);\r\n\r\n                    if (null == sqlTransaction)\r\n                    {\r\n                        StartOrJoinTransaction(persistentTransaction, ref sqlConnection, ref sqlTransaction, ref command);\r\n                    }\r\n\r\n                    if (executeScalar)\r\n                    {\r\n                        SqlConnection conn = sqlConnection as SqlConnection;\r\n\r\n                        if(conn == null)\r\n                        {\r\n                            conn = sqlTransaction.Connection as SqlConnection;\r\n                        }\r\n\r\n                        SqlCommand cmd = command.Command as SqlCommand;\r\n\r\n                        if(conn != null &amp;&amp; cmd != null)\r\n                        {\r\n                            cmd.Connection = conn;\r\n                            cmd.Transaction = sqlTransaction as SqlTransaction;\r\n\r\n                            returnValue = cmd.ExecuteScalar();\r\n                        }\r\n                        else\r\n                        {\r\n                            SqlProcessorException spe = new SqlProcessorException(\r\n                                &quot;One or more required values is null.&quot;);\r\n\r\n                            spe.AddObject(&quot;conn&quot;, conn);\r\n                            spe.AddObject(&quot;cmd&quot;, cmd);\r\n\r\n                            throw spe;\r\n                        }\r\n\r\n                        //returnValue = ProvisioningDatabase.ExecuteScalar(command, sqlTransaction);\r\n                    }\r\n                    else\r\n                    {\r\n                        ProvisioningDatabase.ExecuteNonQuery(command, sqlTransaction);\r\n                        returnValue = command.RowsAffected;\r\n                    }\r\n\r\n                    // keep track of # of commands executed\r\n                    persistentTransaction.ExecutedCommandCount++;\r\n                }\r\n                // No transaction was found\r\n                else\r\n                {\r\n                    using (sqlConnection = ProvisioningDatabase.GetConnection())\r\n                    {\r\n                        sqlConnection.Open();\r\n\r\n                        if (executeScalar)\r\n                        {\r\n                            returnValue = ProvisioningDatabase.ExecuteScalar(command);\r\n                        }\r\n                        else\r\n                        {\r\n                            ProvisioningDatabase.ExecuteNonQuery(command);\r\n                            returnValue = command.RowsAffected;\r\n                        }\r\n                    }\r\n                }\r\n\r\n                if (null != returnValue &amp;&amp; typeof(Int32) == returnValue.GetType())\r\n                {\r\n                    return Convert.ToInt32(returnValue);\r\n                }\r\n            }\r\n            catch (Exception sqlException)\r\n            {\r\n                SqlProcessorException sqlProcessorException =\r\n                    new SqlProcessorException(&quot;ExecuteNonQuery failed.&quot;, sqlException);\r\n\r\n                string commandText = null != command ? command.Command.CommandText : string.Empty;\r\n\r\n                sqlProcessorException[&quot;commandText&quot;] = commandText;\r\n\r\n                foreach (IDataParameter parameter in command.Command.Parameters)\r\n                {\r\n                    string parameterName = parameter.ParameterName;;\r\n                    string parameterValue = string.Format(&quot;[{0} :: {1}] = {2} :: {3}&quot;,\r\n                        parameter.SourceColumn,\r\n                        parameter.DbType.ToString(),\r\n                        &quot;NULL&quot;,\r\n                        &quot;Unknown&quot;);\r\n\r\n                    if (parameter.Value != null &amp;&amp; parameter.Value != DBNull.Value)\r\n                    {\r\n                        parameterValue = string.Format(&quot;[{0} :: {1}] = {2} :: {3}&quot;,\r\n                            parameter.SourceColumn,\r\n                            parameter.DbType.ToString(),\r\n                            parameter.Value.ToString(),\r\n                            parameter.Value.GetType().FullName);\r\n                    }\r\n\r\n                    sqlProcessorException[parameterName] = parameterValue;\r\n                }\r\n\r\n                throw sqlProcessorException;\r\n            }\r\n\r\n            return 0;\r\n        }\r\n\r\n        private void StartOrJoinTransaction(PersistentTransaction persistentTransaction, ref IDbConnection sqlConnection, ref IDbTransaction sqlTransaction, ref DBCommandWrapper command)\r\n        {\r\n            sqlTransaction = persistentTransaction.GetTransaction(ProvisioningDatabase.ConfigurationName);\r\n\r\n            // Transaction has not been started\r\n            if (null == sqlTransaction)\r\n            {\r\n                sqlConnection = ProvisioningDatabase.GetConnection();\r\n                sqlConnection.Open();\r\n\r\n                // Start the transaction since this is the first command on the connection\r\n                sqlTransaction = sqlConnection.BeginTransaction(persistentTransaction.IsolationLevel);\r\n\r\n                persistentTransaction.State = TransactionState.InProgress;\r\n\r\n                // add the transaction and connection objects to this instance of the PersistentTransaction object.  Subsequent calls\r\n                // will use the existing connection and transaction objects\r\n                persistentTransaction.AddTransaction(ProvisioningDatabase.ConfigurationName, sqlTransaction);\r\n                persistentTransaction.AddConnection(ProvisioningDatabase.ConfigurationName, sqlConnection);\r\n            }\r\n                // Join an existing transaction, the transaction was started by a previous call to this method\r\n            else\r\n            {\r\n                sqlConnection = persistentTransaction.GetConnection(ProvisioningDatabase.ConfigurationName);\r\n\r\n                if (ConnectionState.Open == sqlConnection.State)\r\n                {\r\n                    command.Command.Connection = sqlConnection;\r\n                }\r\n                else\r\n                {\r\n                    string commandText = null != command ? command.Command.CommandText : string.Empty;\r\n                    throw new SqlProcessorException(&quot;Connection object closed. &quot; + commandText);\r\n                }\r\n            }\r\n\r\n            // set the time of the last executed command\r\n            persistentTransaction.StartTime = DateTime.Now;\r\n        }\r\n\r\n        private PersistentTransaction GetPersistentTransaction(Guid TransactionGuid)\r\n        {\r\n            if (Guid.Empty != TransactionGuid)\r\n            {\r\n                PersistentTransaction persistentTransaction = TransactionManager.GetTransaction(TransactionGuid);\r\n\r\n                if (null == persistentTransaction)\r\n                {\r\n                    SqlProcessorException exception = new SqlProcessorException(&quot;Transaction not found.&quot;);\r\n                    exception.Add(&quot;TransactionGuid&quot;, TransactionGuid);\r\n                    throw exception;\r\n                }\r\n\r\n                return persistentTransaction;\r\n            }\r\n\r\n            return null;\r\n        }\r\n\r\n        public IDataReader Read(string customCommand, Guid TransactionGuid)\r\n        {\r\n            if (null == _classAttribute)\r\n            {\r\n                GetAttributes();\r\n            }\r\n\r\n\r\n            DBCommandWrapper command = GetCommand(customCommand);\r\n            AddCommandParameters(command);\r\n\r\n            PersistentTransaction persistentTransaction = null;\r\n            IDbTransaction sqlTransaction = null;\r\n            IDbConnection sqlConnection = null;\r\n            string connectionString = string.Empty;\r\n\r\n            Regex regex = new Regex(&quot;PWD=[^;]*;&quot;);\r\n\r\n            try\r\n            {\r\n                // Attempt to get the PersistentTransaction object from the TransactionManager\r\n                persistentTransaction = GetPersistentTransaction(TransactionGuid);\r\n\r\n                if (null != persistentTransaction)\r\n                {\r\n                    sqlTransaction = persistentTransaction.GetTransaction(ProvisioningDatabase.ConfigurationName);\r\n\r\n                    if (null == sqlTransaction)\r\n                    {\r\n                        StartOrJoinTransaction(persistentTransaction, ref sqlConnection, ref sqlTransaction, ref command);\r\n                    }\r\n\r\n                    // keep track of # of commands executed\r\n                    persistentTransaction.ExecutedCommandCount++;\r\n\r\n                    return ProvisioningDatabase.ExecuteReader(command, sqlTransaction);\r\n                }\r\n                // No transaction was found\r\n                else\r\n                {\r\n                    sqlConnection = ProvisioningDatabase.GetConnection();\r\n\r\n                    using (sqlConnection)\r\n                    {\r\n                        connectionString = regex.Replace(sqlConnection.ConnectionString, &quot;PWD=&lt;hidden&gt;;&quot;);\r\n\r\n                        sqlConnection.Open();\r\n                        IDataReader reader = ProvisioningDatabase.ExecuteReader(command);\r\n                        return reader;\r\n                    }\r\n                }\r\n            }\r\n            catch (Exception sqlException)\r\n            {\r\n                SqlProcessorException sqlProcessorException = new SqlProcessorException(&quot;Read failed.&quot;, sqlException);\r\n                string commandText = null != command ? command.Command.CommandText : string.Empty;\r\n                sqlProcessorException[&quot;commandText&quot;] = commandText;\r\n\r\n                foreach (IDataParameter parameter in command.Command.Parameters)\r\n                {\r\n                    string parameterName = string.Empty;\r\n                    string parameterValue = &quot;NULL&quot;;\r\n                    parameterName = parameter.ParameterName;\r\n\r\n                    if (parameter.Value != null &amp;&amp; parameter.Value != DBNull.Value)\r\n                    {\r\n                        parameterValue = parameter.Value.ToString();\r\n                    }\r\n\r\n                    sqlProcessorException[parameterName] = parameterValue;\r\n                }\r\n\r\n                sqlProcessorException.Add(&quot;sqlConnection&quot;, connectionString);\r\n\r\n                throw sqlProcessorException;\r\n            }\r\n        }\r\n\r\n        public IDataReader Read(string customCommand)\r\n        {\r\n            return Read(customCommand, Guid.Empty);\r\n        }\r\n\r\n        public IDataReader ReadByCandidate()\r\n        {\r\n            return Read(&quot;ReadByCandidateID&quot;, Guid.Empty);\r\n        }\r\n\r\n        public IDataReader ReadByCandidate(Guid TransactionGuid)\r\n        {\r\n            return Read(&quot;ReadByCandidateID&quot;, TransactionGuid);\r\n        }\r\n\r\n        public DataTable GetDataTable(string customCommand)\r\n        {\r\n            if (null == _classAttribute)\r\n            {\r\n                GetAttributes();\r\n            }\r\n\r\n            DataTable results = null;\r\n\r\n            DBCommandWrapper command = GetCommand(customCommand);\r\n            AddCommandParameters(command);\r\n\r\n            #region Try-Catch-Finally\r\n                #region Try\r\n            try\r\n            {\r\n                results = ProvisioningDatabase.ExecuteDataSet(command).Tables[0];\r\n            }\r\n                #endregion Try\r\n                #region Catch\r\n            catch(Exception exception)\r\n            {\r\n                SqlProcessorException spe = null;\r\n\r\n                if(exception is SqlProcessorException)\r\n                {\r\n                    spe = (SqlProcessorException)exception;\r\n                    spe.Add(&quot;GetDataTable_StackTrace&quot;, spe.StackTrace);\r\n                }\r\n                else\r\n                {\r\n                    spe = new SqlProcessorException(\r\n                        &quot;Caught exception in GetDataTable.&quot;,\r\n                        exception);\r\n                }\r\n\r\n                spe.Add(&quot;customCommand&quot;, customCommand);\r\n\r\n                foreach(SqlParameter parameter in command.Command.Parameters)\r\n                {\r\n                    spe.AddObject(parameter.SourceColumn, parameter);\r\n                }\r\n\r\n                throw spe;\r\n            }\r\n                #endregion Catch\r\n                #region Finally\r\n            finally\r\n            {\r\n            }\r\n                #endregion Finally\r\n            #endregion Try-Catch-Finally\r\n\r\n\r\n            return results;\r\n        }\r\n\r\n        public IDataReader Read()\r\n        {\r\n            return Read(&quot;ReadProc&quot;);\r\n        }\r\n\r\n        public IDataReader Read(Guid TransactionGuid)\r\n        {\r\n            return Read(&quot;ReadProc&quot;, TransactionGuid);\r\n        }\r\n\r\n        public int Update(Guid TransactionGuid)\r\n        {\r\n            int result = Int32.MinValue;\r\n\r\n            try\r\n            {\r\n                DBCommandWrapper command = GetCommand(&quot;UpdateProc&quot;);\r\n\r\n                result = ExecuteNonQuery(command, TransactionGuid, false);\r\n\r\n                PersistentTransaction transaction = GetPersistentTransaction(TransactionGuid);\r\n\r\n                if(transaction != null)\r\n                {\r\n                    transaction.AddEntity((DataEntityBase)DataEntity);\r\n                }\r\n            }\r\n            finally\r\n            {\r\n            }\r\n\r\n            return result;\r\n        }\r\n\r\n        public int Delete(Guid TransactionGuid)\r\n        {\r\n            DBCommandWrapper command = GetCommand(&quot;DeleteProc&quot;);\r\n\r\n            return ExecuteNonQuery(command, TransactionGuid, false);\r\n        }\r\n\r\n        public object DataEntity\r\n        {\r\n            get\r\n            {\r\n                return _dataEntity;\r\n            }\r\n            set\r\n            {\r\n                _database = null;\r\n                _classAttribute = null;\r\n                _dataEntity = value;\r\n            }\r\n        }\r\n\r\n        private string[] GetInputParameters(ref string command)\r\n        {\r\n            int openPos = 0;\r\n            int closedPos = 0;\r\n            string[] inputParams = new string[0];\r\n\r\n            openPos = command.IndexOf(&quot;(&quot;);\r\n\r\n            if (-1 &lt; openPos)\r\n            {\r\n                closedPos = command.IndexOf(&quot;)&quot;);\r\n\r\n                if (-1 &lt; closedPos)\r\n                {\r\n                    inputParams = command.Substring(openPos + 1, closedPos - openPos - 1).Split(',');\r\n                    command = command.Substring(0, openPos);\r\n                }\r\n            }\r\n\r\n            return inputParams;\r\n        }\r\n\r\n        private void AddCommandParameters(DBCommandWrapper command)\r\n        {\r\n            PropertyInfo property;\r\n            string param;\r\n            string dbType;\r\n            bool nullable = false;\r\n            object[] attributes;\r\n            object propertyValue;\r\n            PersistConfigAttribute fieldAttribute;\r\n\r\n            string commandText = command.Command.CommandText;\r\n            string[] inputParams = GetInputParameters(ref commandText);\r\n\r\n            command.Command.CommandText = commandText;\r\n            System.Type dataEntityType = _dataEntity.GetType();\r\n            System.Type attributeType = typeof(PersistConfigAttribute);\r\n\r\n            for (int index = 0; index &lt; inputParams.Length; index++)\r\n            {\r\n                property = dataEntityType.GetProperty(inputParams[index].Trim(),\r\n                    BindingFlags.Public\r\n                    | BindingFlags.NonPublic\r\n                    | BindingFlags.Instance );\r\n\r\n                if (null != property)\r\n                {\r\n                    attributes = property.GetCustomAttributes(attributeType, false);\r\n\r\n                    if (null != attributes &amp;&amp; 0 &lt; attributes.Length)\r\n                    {\r\n                        fieldAttribute = (PersistConfigAttribute)attributes[0];\r\n\r\n                        if (null != fieldAttribute)\r\n                        {\r\n                            param = (string)fieldAttribute[&quot;Param&quot;];\r\n                            dbType = (string)fieldAttribute[&quot;DbType&quot;];\r\n\r\n                            if (null != fieldAttribute[&quot;Nullable&quot;])\r\n                            {\r\n                                nullable = &quot;true&quot; == fieldAttribute[&quot;Nullable&quot;].ToLower() ? true : false;\r\n                            }\r\n\r\n                            if (null != param &amp;&amp; null != dbType)\r\n                            {\r\n                                propertyValue = property.GetValue(_dataEntity, new object[0]);\r\n\r\n                                if (nullable)\r\n                                {\r\n                                    propertyValue = SqlProcessorHelper.GetNullOrValue(property.PropertyType.UnderlyingSystemType.ToString(), propertyValue);\r\n                                }\r\n\r\n                                command.AddInParameter(param, SqlProcessorHelper.ConvertToDbType(dbType), propertyValue);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        private DBCommandWrapper GetCommand(string commandIdentifier)\r\n        {\r\n            if (null == _classAttribute[commandIdentifier])\r\n            {\r\n                throw new NotImplementedException(commandIdentifier + &quot; not implemented for &quot; + _dataEntity.GetType().FullName);\r\n            }\r\n\r\n            return ProvisioningDatabase.GetStoredProcCommandWrapper(_classAttribute[commandIdentifier]);\r\n        }\r\n\r\n        private Database ProvisioningDatabase\r\n        {\r\n            get\r\n            {\r\n                string dbKey = Globals.DB_KEY;\r\n\r\n                if (null != _classAttribute[&quot;DatabaseInstance&quot;])\r\n                {\r\n                    if(_classAttribute[&quot;DatabaseInstance&quot;] ==\r\n                        Globals.DB_ERROR_LOGGING_KEY)\r\n                    {\r\n                        dbKey = Globals.DB_ERROR_LOGGING_KEY;\r\n                    }\r\n                    else if(_classAttribute[&quot;DatabaseInstance&quot;] ==\r\n                        Globals.DB_DMZ_KEY)\r\n                    {\r\n                            dbKey = Globals.DB_DMZ_KEY;\r\n                    }\r\n                }\r\n\r\n                if (null == _database)\r\n                {\r\n                    _database = DatabaseFactory.CreateDatabase(dbKey);\r\n                }\r\n\r\n                return _database;\r\n            }\r\n        }\r\n\r\n        public void SetDatabaseInstance(string value)\r\n        {\r\n            if(_classAttribute != null)\r\n            {\r\n                GetAttributes();\r\n            }\r\n\r\n            _classAttribute[&quot;DatabaseInstance&quot;] = value;\r\n        }\r\n    }\r\n}\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Data Driven Business Objects"]},{"RecordId":"821","Title":"Fade Effect on Page Transitions","Description":"Meta tag to cause pages to fade on transitioning between pages.","Code":"&lt;meta http-equiv=&quot;Page-Exit&quot; content=&quot;progid:DXImageTransform.Microsoft.Fade(duration=.2)&quot;&gt;\r\n","Declares":"","CodeCategory":{"CategoryId":"2","CategoryDescription":"Web"},"Keywords":["Page Fade","Meta Tags","HTTP-EQUIV"]},{"RecordId":"822","Title":"Measuring Session State Size","Description":"Demonstrates how to compute session state size","Code":"MemoryStream m = new MemoryStream();\r\nBinaryFormatter b = new BinaryFormatter();\r\nstring sOut = string.Empty;\r\nint iNdx = 0;\r\nforeach (object o in Session)\r\n{\r\n  b.Serialize(m, o);\r\n  double size = Convert.ToDouble(m.Length) / Convert.ToDouble(1000);\r\n  sOut += Session.Keys[iNdx].ToString() + &amp;quot; &amp;quot; + size.ToString() + &amp;quot; KB&amp;lt;br&amp;gt;&amp;quot;;\r\n  iNdx++;\r\n}\r\n","Declares":"","CodeCategory":{"CategoryId":"20","CategoryDescription":".Net - ASP.Net"},"Keywords":["Session State Size"]},{"RecordId":"823","Title":"Measuring Session State and Cache Contents and Details","Description":"Retrieve Session State variables and Cache contents and display their contents (and size for Session ","Code":"//*************************************************\r\n// Session Info (1 of 2)\r\n//*************************************************\r\n\r\nusing System;\r\nusing System.Web;\r\nusing System.Web.UI;\r\nusing System.Web.SessionState;\r\nusing System.Web.UI.HtmlControls;\r\nusing System.Web.UI.WebControls;\r\n\r\nusing System.IO;\r\nusing System.Text;\r\nusing System.Runtime.Serialization.Formatters.Binary;\r\n\r\nnamespace Charteris.Web.HttpHandlers\r\n{\r\n\t/// &lt;summary&gt;\r\n\t/// This class is an HttpHandler and reports on ASP.NET Session State\r\n\t/// &lt;/summary&gt;\r\n\tpublic class SessionViewHandler : IHttpHandler, IRequiresSessionState \r\n\t{\r\n\t\tprivate HttpContext m_context;\r\n\t\tprivate HttpRequest m_request;\r\n\t\tprivate HttpResponse m_response;\r\n\t\tprivate HtmlTextWriter m_writer;\r\n\r\n\t\tprivate Type[] m_altSerializationType;\r\n\r\n\t\tprivate Configuration.HttpHandlersConfig m_HttpHandlerSettings;\r\n\r\n\t\tprivate string pageStyle;\r\n\t\t\r\n\t\tpublic SessionViewHandler()\r\n\t\t{\r\n\t\t\tpageStyle = @&quot;&lt;style&gt; {background-color:white; color:black;\tfont: 10pt verdana, arial;}\r\n\t\t\t\ttable {font: 10pt verdana, arial; cellspacing:0; \tcellpadding:0; \tmargin-bottom:25}\r\n\t\t\t\ttr.subhead { background-color:cccccc;}\r\n\t\t\t\tth { padding:0,3,0,3 }\r\n\t\t\t\tth.alt { background-color:black; color:white; padding:3,3,2,3; }\r\n\t\t\t\ttd { padding:0,3,0,3 }\r\n\t\t\t\ttr.alt { background-color:eeeeee }\r\n\t\t\t\th1 { font: 24pt verdana, arial; margin:0,0,0,0}\r\n\t\t\t\th2 { font: 18pt verdana, arial; margin:0,0,0,0}\r\n\t\t\t\th3 { font: 12pt verdana, arial; margin:0,0,0,0}\r\n\t\t\t\tth a { color:darkblue; font: 8pt verdana, arial; }\r\n\t\t\t\ta { color:darkblue;text-decoration:none }\r\n\t\t\t\ta:hover { color:darkblue;text-decoration:underline; }\r\n\t\t\t\tdiv.outer { width:90%; margin:15,15,15,15}\r\n\t\t\t\ttable.viewmenu td { background-color:006699; color:white; padding:0,5,0,5; }\r\n\t\t\t\ttable.viewmenu td.end { padding:0,0,0,0; }\r\n\t\t\t\ttable.viewmenu a {color:white; font: 8pt verdana, arial; }\r\n\t\t\t\ttable.viewmenu a:hover {color:white; font: 8pt verdana, arial; }\r\n\t\t\t\ta.tinylink {color:darkblue; font: 8pt verdana, arial;text-decoration:underline;}\r\n\t\t\t\ta.link {color:darkblue; text-decoration:underline;}\r\n\t\t\t\tdiv.buffer {padding-top:7; padding-bottom:17;}\r\n\t\t\t\t.small { font: 8pt verdana, arial }\r\n\t\t\t\ttable td { padding-right:20 } \r\n\t\t\t\ttable td.nopad { padding-right:5 }\r\n\t\t\t&lt;/style&gt;&quot;;\r\n\r\n\t\t\tm_altSerializationType = new Type[19];\r\n\t\t\t\r\n\t\t\tm_altSerializationType[0] = typeof(String);\r\n\t\t\tm_altSerializationType[1] = typeof(Int32);\r\n\t\t\tm_altSerializationType[2] = typeof(Boolean);\r\n\t\t\tm_altSerializationType[3] = typeof(DateTime);\r\n\t\t\tm_altSerializationType[4] = typeof(Decimal);\r\n\t\t\tm_altSerializationType[5] = typeof(Byte);\r\n\t\t\tm_altSerializationType[6] = typeof(Char);\r\n\t\t\tm_altSerializationType[7] = typeof(Single);\r\n\t\t\tm_altSerializationType[8] = typeof(Double);\r\n\t\t\tm_altSerializationType[9] = typeof(Int16);\r\n\t\t\tm_altSerializationType[10] = typeof(Int64);\r\n\t\t\tm_altSerializationType[11] = typeof(UInt16);\r\n\t\t\tm_altSerializationType[12] = typeof(UInt32);\r\n\t\t\tm_altSerializationType[13] = typeof(UInt64);\r\n\t\t\tm_altSerializationType[14] = typeof(SByte);\r\n\t\t\tm_altSerializationType[15] = typeof(TimeSpan);\r\n\t\t\tm_altSerializationType[16] = typeof(Guid);\r\n\t\t\tm_altSerializationType[17] = typeof(IntPtr);\r\n\t\t\tm_altSerializationType[18] = typeof(UIntPtr);\r\n\t\t\t\r\n\t\t}\r\n\t\r\n\t\tprivate bool TypeIsInAlternativeSerializationList(Type type) {\r\n\t\t\t\r\n\t\t\tfor(int i =0;i&lt;=(m_altSerializationType.Length -1);i++) {\r\n\t\t\t\tif(type == m_altSerializationType[i]) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t//Only would have got to here is the type was not found in the list of types\r\n\t\t\t//that go though the &quot;alternative&quot; serialization\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t#region IHttpHandler Members\r\n\r\n\t\t/// &lt;summary&gt;\r\n\t\t/// Standard HttpHandler Entry point. Coordinate the displaying of the Session View\r\n\t\t/// &lt;/summary&gt;\r\n\t\t/// &lt;param name=&quot;context&quot;&gt;The current HttpContext&lt;/param&gt;\r\n\t\tpublic void ProcessRequest(HttpContext context) {\r\n\t\t\t\r\n\t\t\t//Only allow session viewing on requests that have originated locally\r\n\t\t\tif(Common.RequestIsLocal(context.Request) == false) {\r\n\t\t\t\tcontext.AddError(new ApplicationException(&quot;SessionView can only be accessed locally i.e. localhost&quot;));\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tm_HttpHandlerSettings = (Configuration.HttpHandlersConfig) context.GetConfig(&quot;charteris.web/httpHandlers&quot;);\r\n\t\t\t\r\n\t\t\tif(m_HttpHandlerSettings ==null || \r\n\t\t\t\t\t(m_HttpHandlerSettings.SessionView == null) ||\r\n\t\t\t\t\t(m_HttpHandlerSettings.SessionView.Enabled == false)) \r\n\t\t\t{\r\n\t\t\t\t//Session View is not enabled fire exception\r\n\t\t\t\tcontext.AddError(new ApplicationException(@&quot;SessionView is not enabled. See the charteris.web\\httpHandlers\\ section in your configuration file&quot;,null));\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tm_context = context;\r\n\t\t\tm_request = context.Request;\r\n\t\t\tm_response = context.Response;\r\n\r\n\t\t\tm_writer = new HtmlTextWriter(m_response.Output);\r\n\t\t\r\n\t\t\tm_writer.Write(&quot;&lt;html&gt;\\r\\n&quot;);\r\n\r\n\t\t\t//Write out Html head and style tags\r\n\t\t\tm_writer.Write(&quot;&lt;head&gt;\\r\\n&quot;);\r\n\t\t\tm_writer.Write(pageStyle);\r\n\t\t\tm_writer.Write(&quot;&lt;/head&gt;\\r\\n&quot;);\t\r\n\t\t\t\r\n\t\t\tif(m_context.Session.Mode != SessionStateMode.Off) {\r\n\t\t\t\tif(context.Request.QueryString[&quot;Item&quot;] == null) {\r\n\t\t\t\t\t//An item specific requets is NOT being made. Display the lot\r\n\t\t\t\t\tEnumerateAndDisplaySessionState();\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\t//A session item specific request is being made. Try and display it\r\n\t\t\t\t\tDisplaySessionStateItem();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\t//Session state is off\r\n\t\t\t\tDisplaySessionStateOff();\r\n\t\t\t}\r\n\r\n\t\t\tm_writer.Write(&quot;\\r\\n&lt;/body&gt;\\r\\n&lt;/html&gt;\\r\\n&quot;);\r\n\t\t\t\r\n\t\t}\r\n\r\n\t\t/// &lt;summary&gt;\r\n\t\t/// Gets the bool saying whether this HttpHandler is Reusable or not\r\n\t\t/// &lt;/summary&gt;\r\n\t\tpublic bool IsReusable {\r\n\t\t\tget {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t#endregion\r\n\r\n\t\tprivate void DisplaySessionStateOff() {\r\n\t\t\tTable sessionTable = TableHelper.CreateTable(); \r\n\t\t\t\r\n\t\t\t//Table Header\r\n\t\t\tTableRow mainHeadingRow = new TableRow();\r\n\t\t\tsessionTable.Rows.Add(mainHeadingRow);\r\n\r\n\t\t\tTableHelper.AddHeaderCell(mainHeadingRow,&quot;Session State is Off&quot;);\r\n\t\t\t\r\n\t\t\tsessionTable.RenderControl(m_writer);\r\n\t\t}\r\n\r\n\t\tprivate void EnumerateAndDisplaySessionState() {\r\n\r\n\t\t\tbool displayingObjectSize;\r\n\r\n\t\t\tTable sessionTable = TableHelper.CreateTable(); \r\n\t\t\t\r\n\t\t\t//Table Header\r\n\t\t\tTableRow mainHeadingRow = new TableRow();\r\n\t\t\tsessionTable.Rows.Add(mainHeadingRow);\r\n\r\n\t\t\tTableCell mainHeading;\r\n\r\n\t\t\tif(m_context.Session.Mode == SessionStateMode.SQLServer ||\r\n\t\t\t\tm_context.Session.Mode == SessionStateMode.StateServer){\r\n\t\t\t\tdisplayingObjectSize = true;\r\n\t\t\t\tmainHeading = TableHelper.AddHeaderCell(mainHeadingRow,&quot;&lt;h3&gt;&lt;b&gt;Session State Details including approximate item size&lt;/b&gt;&lt;/h3&gt;&quot;);\r\n\t\t\t\tmainHeading.CssClass = &quot;alt&quot;;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tdisplayingObjectSize = false;\r\n\t\t\t\tmainHeading = TableHelper.AddHeaderCell(mainHeadingRow,&quot;&lt;h3&gt;&lt;b&gt;Session State Details&lt;/b&gt;&lt;/h3&gt;&quot;);\r\n\t\t\t}\r\n\r\n\t\t\tmainHeading.ColumnSpan = 4;\r\n\t\t\tmainHeading.CssClass = &quot;alt&quot;;\r\n\t\t\t\r\n\t\t\tTableRow secondaryHeadingRow = new TableRow();\r\n\t\t\tsecondaryHeadingRow.CssClass = &quot;subhead&quot;;\r\n\t\t\tsessionTable.Rows.Add(secondaryHeadingRow);\r\n\t\t\t\r\n\t\t\tTableCell headingRowCol1 = TableHelper.AddHeaderCell(secondaryHeadingRow,&quot;Session Key&quot;);\r\n\t\t\t\r\n\t\t\tTableCell headingRowCol2 = TableHelper.AddHeaderCell(secondaryHeadingRow,&quot;Object Type&quot;);\r\n\t\t\t\r\n\t\t\tif(displayingObjectSize == true) {\r\n\t\t\t\tTableCell headingRowCol3 = TableHelper.AddHeaderCell(secondaryHeadingRow,&quot;Object Size (Serialized)&quot;);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\t//Make second column span 2\r\n\t\t\t\theadingRowCol2.ColumnSpan = 2;\r\n\t\t\t}\r\n\r\n\t\t\tTableCell headingRowCol4 = TableHelper.AddHeaderCell(secondaryHeadingRow,&quot;View Data&quot;);\r\n\t\t\r\n\t\t\tbool alternatingRowToggle = false;\r\n\t\t\tTableRow dataRow;\r\n\r\n\t\t\t//Loop through all the session item keys \r\n\t\t\tforeach(string sessionKey in m_context.Session.Keys) {\r\n\t\t\t\t\r\n\t\t\t\tdataRow = new TableRow();\r\n\r\n\t\t\t\t//Key column\r\n\t\t\t\tTableHelper.AddCell(dataRow,sessionKey);\r\n\r\n\t\t\t\tif(m_context.Session[sessionKey] != null) {\r\n\t\t\t\t\t//Get out of session\r\n\t\t\t\t\tObject sessionItem = m_context.Session[sessionKey];\r\n\t\t\t\r\n\t\t\t\t\tSystem.Type type = sessionItem.GetType();\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t//Type column\r\n\t\t\t\t\tTableHelper.AddCell(dataRow,sessionItem.GetType().FullName);\r\n\t\t\t\t\t\r\n\t\t\t\t\tif(displayingObjectSize == true) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t//Size column\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tStream alternativeSerializationStreamSessionKey = BinaryWrite(sessionKey);\r\n\r\n\t\t\t\t\t\tif(TypeIsInAlternativeSerializationList(sessionItem.GetType()) == true) {\r\n\t\t\t\t\t\t\tStream alternativeSerializationStream = BinaryWrite(sessionItem);\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t//Alt Serialization Size column\r\n\t\t\t\t\t\t\tTableHelper.AddCell(dataRow,\r\n\t\t\t\t\t\t\t\tConvert.ToDouble(alternativeSerializationStream.Length + alternativeSerializationStreamSessionKey.Length) \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t/ Convert.ToDouble(1000) + &quot; KB&quot;);\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tMemoryStream m;\r\n\t\t\t\t\t\t\tm = Common.BinarySerialize(sessionItem);\r\n\r\n\t\t\t\t\t\t\tTableHelper.AddCell(dataRow,\r\n\t\t\t\t\t\t\t\t\t\t\t\tConvert.ToDouble(m.Length + alternativeSerializationStreamSessionKey.Length) \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/ Convert.ToDouble(1000) + &quot; KB&quot;);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\t// Make second column span 2 to make up for unused third col\r\n\t\t\t\t\t\tdataRow.Cells[1].ColumnSpan = 2;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t//Data link column\r\n\t\t\t\t\tif(m_HttpHandlerSettings.SessionView.ShowViewDataLink == true) {\r\n\t\t\t\t\t\tStringWriter swTest = Common.XmlSerialize(sessionItem);\r\n\r\n\t\t\t\t\t\tif(swTest == null) { \r\n\t\t\t\t\t\t\t//Could not serialize the data in a human readable form using Xml\r\n\t\t\t\t\t\t\tTableHelper.AddCell(dataRow,&quot;Data could not be serialized to Xml&quot;);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tTableHelper.AddCell(dataRow,&quot;Click to view data&quot;,&quot;SessionView.axd?Item=&quot; + sessionKey);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tTableHelper.AddCell(dataRow,&quot;N/A&quot;);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tTableHelper.AddCell(dataRow,&quot;N/A&quot;);\r\n\t\t\t\t\r\n\t\t\t\t\tif(displayingObjectSize == true) {\r\n\t\t\t\t\t\tTableHelper.AddCell(dataRow,&quot;N/A&quot;);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tdataRow.Cells[1].ColumnSpan = 3;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif(alternatingRowToggle == true){\r\n\t\t\t\t\tdataRow.CssClass = &quot;alt&quot;;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\talternatingRowToggle = alternatingRowToggle == Convert.ToBoolean(0);\r\n\t\t\t\tsessionTable.Rows.Add(dataRow);\r\n\t\t\t}\r\n\r\n\t\t\tsessionTable.RenderControl(m_writer);\r\n\t\t}\r\n\r\n\t\t/// &lt;summary&gt;\r\n\t\t/// \r\n\t\t/// &lt;/summary&gt;\r\n\t\t/// &lt;param name=&quot;objectToWrite&quot;&gt;&lt;/param&gt;\r\n\t\t/// &lt;returns&gt;&lt;/returns&gt;\r\n\t\tprivate Stream BinaryWrite(object valueToWrite) {\r\n\r\n\t\t\tBinaryWriter writer = new BinaryWriter(new MemoryStream());\r\n\t\t\t\r\n\t\t\tSystem.Type valueType = valueToWrite.GetType();\r\n\r\n\t\t\tif (valueToWrite == null) {\r\n\t\t\t\twriter.Write(16);\r\n\t\t\t\treturn writer.BaseStream;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (valueType == m_altSerializationType[0]) {\r\n\t\t\t\twriter.Write(1);\r\n\t\t\t\twriter.Write((String) valueToWrite);\r\n\t\t\t\treturn  writer.BaseStream;\r\n\t\t\t}\r\n\t\t\tif (valueType == m_altSerializationType[1]) {\r\n\t\t\t\twriter.Write(2);\r\n\t\t\t\twriter.Write((Int32) valueToWrite);\r\n\t\t\t\treturn writer.BaseStream;\r\n\t\t\t}\r\n\t\t\tif (valueType == m_altSerializationType[2]) {\r\n\t\t\t\twriter.Write(3);\r\n\t\t\t\twriter.Write((Boolean) valueToWrite);\r\n\t\t\t\treturn writer.BaseStream;\r\n\t\t\t}\r\n\t\t\tif (valueType == m_altSerializationType[3]) {\r\n\t\t\t\twriter.Write(4);\r\n\t\t\t\tDateTime tempdateTime;\r\n\t\t\t\ttempdateTime = (DateTime) valueToWrite;\r\n\t\t\t\twriter.Write(tempdateTime.Ticks);\r\n\t\t\t\treturn writer.BaseStream;\r\n\t\t\t}\r\n\t\t\tif (valueType == m_altSerializationType[4]) {\r\n\t\t\t\twriter.Write(5);\r\n\t\t\t\tint[] decimalBits;\r\n\t\t\t\tdecimalBits = Decimal.GetBits((Decimal) valueToWrite);\r\n\t\t\t\tint i = 0;\r\n\t\t\t\twhile (i &lt; 4) {\r\n\t\t\t\t\twriter.Write(decimalBits[i]);\r\n\t\t\t\t\ti++;\r\n\t\t\t\t}\r\n\t\t\t\treturn writer.BaseStream;\r\n\t\t\t}\r\n\t\t\tif (valueType == m_altSerializationType[5]) {\r\n\t\t\t\twriter.Write(6);\r\n\t\t\t\twriter.Write((Byte) valueToWrite);\r\n\t\t\t\treturn writer.BaseStream;\r\n\t\t\t}\r\n\t\t\tif (valueType == m_altSerializationType[6]) {\r\n\t\t\t\twriter.Write(6);\r\n\t\t\t\twriter.Write((Char) valueToWrite);\r\n\t\t\t\treturn writer.BaseStream;\r\n\t\t\t}\r\n\t\t\tif (valueType == m_altSerializationType[7]) {\r\n\t\t\t\twriter.Write(8);\r\n\t\t\t\twriter.Write((Single) valueToWrite);\r\n\t\t\t\treturn writer.BaseStream;\r\n\t\t\t}\r\n\t\t\tif (valueType == m_altSerializationType[8]) {\r\n\t\t\t\twriter.Write(9);\r\n\t\t\t\twriter.Write((Double) valueToWrite);\r\n\t\t\t\treturn writer.BaseStream;\r\n\t\t\t}\r\n\t\t\tif (valueType == m_altSerializationType[9]) {\r\n\t\t\t\twriter.Write(10);\r\n\t\t\t\twriter.Write((Int16) valueToWrite);\r\n\t\t\t\treturn writer.BaseStream;\r\n\t\t\t}\r\n\t\t\tif (valueToWrite == m_altSerializationType[10]) {\r\n\t\t\t\twriter.Write(11);\r\n\t\t\t\twriter.Write((Int64) valueToWrite);\r\n\t\t\t\treturn writer.BaseStream;\r\n\t\t\t}\r\n\t\t\tif (valueType == m_altSerializationType[11]) {\r\n\t\t\t\twriter.Write(12);\r\n\t\t\t\twriter.Write((UInt16) valueToWrite);\r\n\t\t\t\treturn writer.BaseStream;\r\n\t\t\t}\r\n\t\t\tif (valueType == m_altSerializationType[12]) {\r\n\t\t\t\twriter.Write(13);\r\n\t\t\t\twriter.Write((UInt32) valueToWrite);\r\n\t\t\t\treturn writer.BaseStream;\r\n\t\t\t}\r\n\t\t\tif (valueType == m_altSerializationType[13]) {\r\n\t\t\t\twriter.Write(14);\r\n\t\t\t\twriter.Write((UInt64) valueToWrite);\r\n\t\t\t\treturn writer.BaseStream;\r\n\t\t\t}\r\n\r\n\t\t\tif (valueType == m_altSerializationType[14]) {\r\n\t\t\t\twriter.Write(10);\r\n\t\t\t\twriter.Write((SByte) valueToWrite);\r\n\t\t\t\treturn writer.BaseStream;\r\n\t\t\t}\r\n\r\n\t\t\tif (valueType == m_altSerializationType[15]) {\r\n\t\t\t\twriter.Write(16);\r\n\t\t\t\tTimeSpan timespanToWrite = (TimeSpan) valueToWrite;\r\n\t\t\t\twriter.Write(timespanToWrite.Ticks);\r\n\t\t\t\treturn writer.BaseStream;\r\n\t\t\t}\r\n\t\t\tif (valueType == m_altSerializationType[16]) {\r\n\t\t\t\twriter.Write(17);\r\n\t\t\t\tGuid guidToWrite = (Guid) valueToWrite;\r\n\t\t\t\tbyte[] guidAsByteArray = guidToWrite.ToByteArray();\r\n\t\t\t\twriter.Write(guidAsByteArray);\r\n\t\t\t\treturn writer.BaseStream;\r\n\t\t\t}\r\n\t\t\tif (valueType == m_altSerializationType[17]) {\r\n\t\t\t\twriter.Write(18);\r\n\t\t\t\tIntPtr intptrToWrite = (IntPtr) valueToWrite;\r\n\t\t\t\tif (IntPtr.Size == 4) {\r\n\t\t\t\t\twriter.Write(intptrToWrite.ToInt32());\r\n\t\t\t\t\treturn writer.BaseStream;\r\n\t\t\t\t}\r\n\t\t\t\twriter.Write(intptrToWrite.ToInt64());\r\n\t\t\t\treturn writer.BaseStream;\r\n\t\t\t}\r\n\t\t\tif (valueType == m_altSerializationType[18]) {\r\n\t\t\t\twriter.Write(19);\r\n\t\t\t\tUIntPtr uintptrToWrite = (UIntPtr) valueToWrite;\r\n\t\t\t\tif (UIntPtr.Size == 4) {\r\n\t\t\t\t\twriter.Write(uintptrToWrite.ToUInt32());\r\n\t\t\t\t\treturn writer.BaseStream;\r\n\t\t\t\t}\r\n\t\t\t\twriter.Write(uintptrToWrite.ToUInt64());\r\n\t\t\t\treturn writer.BaseStream;\r\n\t\t\t}\t\t\t\r\n\r\n\t\t\treturn writer.BaseStream;\r\n\t\t\t\r\n\t\t}\r\n\r\n\t\tprivate void DisplaySessionStateItem() {\r\n\t\t\r\n\t\t\tobject sessionItem;\r\n\r\n\t\t\t//Get requested item from session state\r\n\t\t\tsessionItem = m_context.Session[m_request.QueryString[&quot;Item&quot;]];\r\n\r\n\t\t\tTable sessionItemTable = TableHelper.CreateTable(); \r\n\t\t\t\r\n\t\t\t//Table Header\r\n\t\t\tTableRow mainHeadingRow = new TableRow();\r\n\t\t\tsessionItemTable.Rows.Add(mainHeadingRow);\r\n\r\n\t\t\tTableCell mainHeading;\r\n\r\n\t\t\tmainHeading = TableHelper.AddHeaderCell(mainHeadingRow,&quot;&lt;h3&gt;&lt;b&gt;Session State Item&lt;/b&gt;&lt;/h3&gt;&quot;);\r\n\t\t\tmainHeading.CssClass = &quot;alt&quot;;\r\n\t\t\tmainHeading.ColumnSpan = 4;\r\n\t\t\t\r\n\t\t\t//Sub heading\r\n\t\t\tTableRow secondaryHeadingRow = new TableRow();\r\n\t\t\tsecondaryHeadingRow.CssClass = &quot;subhead&quot;;\r\n\t\t\tsessionItemTable.Rows.Add(secondaryHeadingRow);\r\n\t\t\t\r\n\t\t\tTableCell headingRowCol1 = TableHelper.AddHeaderCell(secondaryHeadingRow,&quot;Session Item Key: &quot; + m_request.QueryString[&quot;Item&quot;]);\r\n\t\t\t\r\n\t\t\t//Explanation heading\r\n\t\t\tTableRow explanationHeadingRow = new TableRow();\r\n\t\t\tsessionItemTable.Rows.Add(explanationHeadingRow);\r\n\r\n\t\t\tTableHelper.AddCell(explanationHeadingRow,&quot;The outer xml tags are a result of the Xml serialization used to render the item&quot;);\r\n\r\n\t\t\tTableRow dataRow;\r\n\r\n\t\t\tdataRow = new TableRow();\r\n\r\n\t\t\tif(sessionItem != null) {\r\n\t\t\t\r\n\t\t\t\tStringWriter swTest = Common.XmlSerialize(sessionItem);\r\n\r\n\t\t\t\tif(swTest == null) { \r\n\t\t\t\t\t//Could not serialize the data in a human readable form using Xml\r\n\t\t\t\t\tTableHelper.AddCell(dataRow,&quot;Item was not viewable&quot;);\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tTableHelper.AddCell(dataRow,m_context.Server.HtmlEncode(swTest.ToString()));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tTableHelper.AddCell(dataRow,&quot;Item is NULL in value&quot;);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tsessionItemTable.Rows.Add(dataRow);\r\n\r\n\t\t\tsessionItemTable.RenderControl(m_writer);\r\n\t\t}\r\n\t}\r\n}\r\n\r\n\r\n//*************************************************\r\n// Cache Info (2 of 2)\r\n//*************************************************\r\nusing System;\r\nusing System.Web;\r\nusing System.Web.UI;\r\nusing System.Web.SessionState;\r\nusing System.Web.UI.HtmlControls;\r\nusing System.Web.UI.WebControls;\r\n\r\nusing System.IO;\r\nusing System.Text;\r\nusing System.Runtime.Serialization.Formatters.Binary;\r\nusing System.Collections;\r\n\r\nnamespace Charteris.Web.HttpHandlers\r\n{\r\n\t/// &lt;summary&gt;\r\n\t/// This class is an HttpHandler and reports on the ASP.NET Cache\r\n\t/// &lt;/summary&gt;\r\n\tpublic class CacheViewHandler: IHttpHandler {\r\n\t\t\r\n\t\tprivate HttpContext m_context;\r\n\t\tprivate HttpRequest m_request;\r\n\t\tprivate HttpResponse m_response;\r\n\t\tprivate HtmlTextWriter m_writer; \r\n\r\n\t\tprivate Configuration.HttpHandlersConfig m_HttpHandlerSettings;\r\n\t\t\r\n\t\tprivate string pageStyle;\r\n\r\n\t\tpublic CacheViewHandler()\r\n\t\t{\r\n\t\t\tpageStyle = @&quot;&lt;style&gt; {background-color:white; color:black;\tfont: 10pt verdana, arial;}\r\n\t\t\t\ttable {font: 10pt verdana, arial; cellspacing:0; \tcellpadding:0; \tmargin-bottom:25}\r\n\t\t\t\ttr.subhead { background-color:cccccc;}\r\n\t\t\t\tth { padding:0,3,0,3 }\r\n\t\t\t\tth.alt { background-color:black; color:white; padding:3,3,2,3; }\r\n\t\t\t\ttd { padding:0,3,0,3 }\r\n\t\t\t\ttr.alt { background-color:eeeeee }\r\n\t\t\t\ttd.duplicate {background-color:red }\r\n\t\t\t\th1 { font: 24pt verdana, arial; margin:0,0,0,0}\r\n\t\t\t\th2 { font: 18pt verdana, arial; margin:0,0,0,0}\r\n\t\t\t\th3 { font: 12pt verdana, arial; margin:0,0,0,0}\r\n\t\t\t\tth a { color:darkblue; font: 8pt verdana, arial; }\r\n\t\t\t\ta { color:darkblue;text-decoration:none }\r\n\t\t\t\ta:hover { color:darkblue;text-decoration:underline; }\r\n\t\t\t\tdiv.outer { width:90%; margin:15,15,15,15}\r\n\t\t\t\ttable.viewmenu td { background-color:006699; color:white; padding:0,5,0,5; }\r\n\t\t\t\ttable.viewmenu td.end { padding:0,0,0,0; }\r\n\t\t\t\ttable.viewmenu a {color:white; font: 8pt verdana, arial; }\r\n\t\t\t\ttable.viewmenu a:hover {color:white; font: 8pt verdana, arial; }\r\n\t\t\t\ta.tinylink {color:darkblue; font: 8pt verdana, arial;text-decoration:underline;}\r\n\t\t\t\ta.link {color:darkblue; text-decoration:underline;}\r\n\t\t\t\tdiv.buffer {padding-top:7; padding-bottom:17;}\r\n\t\t\t\t.small { font: 8pt verdana, arial }\r\n\t\t\t\ttable td { padding-right:20 }\r\n\t\t\t\ttable td.nopad { padding-right:5 }\r\n\t\t\t&lt;/style&gt;&quot;;\r\n\t\t}\r\n\t\r\n\t\t#region IHttpHandler Members\r\n\r\n\t\t/// &lt;summary&gt;\r\n\t\t/// Standard HttpHandler Entry point. Coordinate the displaying of the Cache View\r\n\t\t/// &lt;/summary&gt;\r\n\t\t/// &lt;param name=&quot;context&quot;&gt;The current HttpContext&lt;/param&gt;\r\n\t\tpublic void ProcessRequest(HttpContext context) {\r\n\t\t\t\t\t\t\r\n\t\t\tif(Common.RequestIsLocal(context.Request) == false) {\r\n\t\t\t\tcontext.AddError(new ApplicationException(&quot;CacheView can only be accessed locally i.e. localhost&quot;));\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tm_HttpHandlerSettings = (Configuration.HttpHandlersConfig) context.GetConfig(&quot;charteris.web/httpHandlers&quot;);\r\n\r\n\t\t\tif(m_HttpHandlerSettings ==null || \r\n\t\t\t\t\t(m_HttpHandlerSettings.CacheView == null) ||\r\n\t\t\t\t\t(m_HttpHandlerSettings.CacheView.Enabled == false)) \r\n\t\t\t{\r\n\t\t\t\t//Cache View is not enabled fire exception\r\n\t\t\t\tcontext.AddError(new ApplicationException(@&quot;CacheView is not enabled. See the charteris.web/httpHandlers section in your configuration file&quot;,null));\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tm_context = context;\r\n\t\t\tm_request = context.Request;\r\n\t\t\tm_response = context.Response;\r\n\r\n\t\t\tm_writer = new HtmlTextWriter(m_response.Output);\r\n\t\r\n\t\t\tm_writer.Write(&quot;&lt;html&gt;\\r\\n&quot;);\r\n\r\n\t\t\t//Write out Html head and style tags\r\n\t\t\tm_writer.Write(&quot;&lt;head&gt;\\r\\n&quot;);\r\n\t\t\tm_writer.Write(pageStyle);\r\n\t\t\tm_writer.Write(&quot;&lt;/head&gt;\\r\\n&quot;);\t\r\n\r\n\t\t\tif(context.Request.QueryString[&quot;Item&quot;] == null) {\r\n\t\t\t\t//An item specific requets is NOT being made. Display the lot\r\n\t\t\t\tEnumerateAndDisplayCache();\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\t//A cache item specific request is being made. Try and display it\r\n\t\t\t\tDisplayCacheItem();\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tm_writer.Write(&quot;\\r\\n&lt;/body&gt;\\r\\n&lt;/html&gt;\\r\\n&quot;);\r\n\t\t}\r\n\r\n\t\tpublic bool IsReusable {\r\n\t\t\tget {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t#endregion\r\n\r\n\t\tprivate void DisplayCacheItem() {\r\n\r\n\t\t\tobject cacheItem;\r\n            \r\n\t\t\t//Get requested item from cache\r\n\t\t\tcacheItem = m_context.Cache[m_request.QueryString[&quot;Item&quot;]];\r\n\r\n\t\t\tTable sessionItemTable = TableHelper.CreateTable(); \r\n\t\t\t\r\n\t\t\t//Table Header\r\n\t\t\tTableRow mainHeadingRow = new TableRow();\r\n\t\t\tsessionItemTable.Rows.Add(mainHeadingRow);\r\n\r\n\t\t\tTableCell mainHeading;\r\n\r\n\t\t\tmainHeading = TableHelper.AddHeaderCell(mainHeadingRow,&quot;&lt;h3&gt;&lt;b&gt;Cache Item&lt;/b&gt;&lt;/h3&gt;&quot;);\r\n\t\t\tmainHeading.CssClass = &quot;alt&quot;;\r\n\t\t\tmainHeading.ColumnSpan = 4;\r\n\t\t\t\r\n\t\t\t//Sub heading\r\n\t\t\tTableRow secondaryHeadingRow = new TableRow();\r\n\t\t\tsecondaryHeadingRow.CssClass = &quot;subhead&quot;;\r\n\t\t\tsessionItemTable.Rows.Add(secondaryHeadingRow);\r\n\t\t\t\r\n\t\t\tTableCell headingRowCol1 = TableHelper.AddHeaderCell(secondaryHeadingRow,&quot;Cache Item Key: &quot; + m_request.QueryString[&quot;Item&quot;]);\r\n\t\t\t\r\n\t\t\t//Explanation heading\r\n\t\t\tTableRow explanationHeadingRow = new TableRow();\r\n\t\t\tsessionItemTable.Rows.Add(explanationHeadingRow);\r\n\r\n\t\t\tTableHelper.AddCell(explanationHeadingRow,&quot;The outer xml tags are a result of the Xml serialization used to render the item&lt;BR&gt;&lt;BR&gt;&quot;);\r\n\r\n\t\t\tTableRow dataRow;\r\n\r\n\t\t\tdataRow = new TableRow();\r\n\r\n\t\t\tif(cacheItem != null) {\r\n\t\t\t\r\n\t\t\t\tStringWriter swTest = Common.XmlSerialize(cacheItem);\r\n\r\n\t\t\t\tif(swTest == null) { \r\n\t\t\t\t\t//Could not serialize the data in a human readable form using Xml\r\n\t\t\t\t\tTableHelper.AddCell(dataRow,&quot;Item was not viewable&quot;);\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tTableHelper.AddCell(dataRow,m_context.Server.HtmlEncode(swTest.ToString()));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tTableHelper.AddCell(dataRow,&quot;Item is NULL in value&quot;);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tsessionItemTable.Rows.Add(dataRow);\r\n\r\n\t\t\tsessionItemTable.RenderControl(m_writer);\r\n\t\t}\r\n\t\tprivate void EnumerateAndDisplayCache() {\r\n\t\t\t\r\n\t\t\tTable cacheTable = TableHelper.CreateTable(); \r\n\t\t\t\r\n\t\t\t//Table Header\r\n\t\t\tTableRow mainHeadingRow = new TableRow();\r\n\t\t\tcacheTable.Rows.Add(mainHeadingRow);\r\n\r\n\t\t\tTableCell mainHeading;\r\n\t\t\t\r\n\t\t\tmainHeading = TableHelper.AddHeaderCell(mainHeadingRow,&quot;&lt;h3&gt;&lt;b&gt;Cache Details&lt;/b&gt;&lt;/h3&gt;&quot;);\r\n\t\t\tmainHeading.ColumnSpan = 3;\r\n\t\t\tmainHeading.CssClass = &quot;alt&quot;;\r\n\t\t\t\t\t\t\r\n\t\t\tTableRow secondaryHeadingRow = new TableRow();\r\n\t\t\tsecondaryHeadingRow.CssClass = &quot;subhead&quot;;\r\n\t\t\tcacheTable.Rows.Add(secondaryHeadingRow);\r\n\t\t\t\r\n\t\t\tTableCell headingRowCol1 = TableHelper.AddHeaderCell(secondaryHeadingRow,&quot;Cache Key&quot;);\r\n\t\t\r\n\t\t\tTableCell headingRowCol2 = TableHelper.AddHeaderCell(secondaryHeadingRow,&quot;Cached Object Type&quot;);\r\n\t\t\t\r\n\t\t\tTableCell headingRowCol3 = TableHelper.AddHeaderCell(secondaryHeadingRow,&quot;View Data&quot;);\r\n\r\n\t\t\tbool alternatingRowToggle = false;\r\n\t\t\tArrayList enumeratedItems = new ArrayList();\r\n\t\t\tTableRow dataRow;\r\n\t\t\t\r\n\t\t\tforeach(DictionaryEntry cacheDictionaryItem in m_context.Cache) {\r\n\t\t\t\tdataRow = new TableRow();\r\n\r\n\t\t\t\t//Key column\r\n\t\t\t\tTableHelper.AddCell(dataRow,cacheDictionaryItem.Key.ToString());\r\n\r\n\t\t\t\tif(m_context.Cache[cacheDictionaryItem.Key.ToString()] != null) {\r\n\t\t\t\t\t\r\n\t\t\t\t\t//Get out of cache\r\n\t\t\t\t\tObject cacheObjectItem = m_context.Cache[cacheDictionaryItem.Key.ToString()];\r\n\t\t\t\r\n\t\t\t\t\tSystem.Type type = cacheObjectItem.GetType();\r\n\t\t\t\r\n\t\t\t\t\t//Type column\r\n\t\t\t\t\tTableHelper.AddCell(dataRow, cacheObjectItem.GetType().FullName);\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\t//Type column\r\n\t\t\t\t\tTableHelper.AddCell(dataRow, &quot;NULL&quot;);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//Data link column\r\n\t\t\t\tif(m_HttpHandlerSettings.CacheView.ShowViewDataLink == true) {\r\n\t\t\t\t\tStringWriter swTest = Common.XmlSerialize(cacheDictionaryItem.Value);\r\n\r\n\t\t\t\t\tif(swTest == null) { \r\n\t\t\t\t\t\t//Could not serialize the data in a human readable form using Xml\r\n\t\t\t\t\t\tTableHelper.AddCell(dataRow,&quot;Data could not be serialized to Xml&quot;);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tTableHelper.AddCell(dataRow,&quot;Click to view data&quot;,&quot;CacheView.axd?Item=&quot; + cacheDictionaryItem.Key.ToString());\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tTableHelper.AddCell(dataRow,&quot;N/A&quot;);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif(alternatingRowToggle == true){\r\n\t\t\t\t\tdataRow.CssClass = &quot;alt&quot;;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\talternatingRowToggle = alternatingRowToggle == Convert.ToBoolean(0);\r\n\t\t\t\tcacheTable.Rows.Add(dataRow);\r\n\t\t\t}\r\n\r\n\t\t\tcacheTable.RenderControl(m_writer);\r\n\t\t}\r\n\t}\r\n}\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"20","CategoryDescription":".Net - ASP.Net"},"Keywords":["Session State","Cache"]},{"RecordId":"824","Title":"SQL NoLock Sample","Description":"Shows how to use NoLock in T-SQL","Code":"CREATE PROCEDURE [dbo].[pub_GetLoanTypeByLoanSID]\r\n(\r\n    @loan_SID int\r\n)\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON\r\n    SELECT\r\n        LT.[LoanTypeDesc]\r\n    FROM [dbo].[Loan] L WITH (NOLOCK)\r\n    INNER JOIN [dbo].[ref_LoanType] LT WITH (NOLOCK) \r\n        ON  L.LoanTypeCode = LT.LoanTypeCode\r\n    WHERE\r\n        (L.[Loan_SID] = @loan_SID)\r\n\r\n    SET NOCOUNT OFF\r\n    RETURN 0\r\nEND\r\n\r\nGO\r\n","Declares":"","CodeCategory":{"CategoryId":"6","CategoryDescription":"T-SQL"},"Keywords":["NoLock"]},{"RecordId":"825","Title":"How to Force Page Breaks When Printing HTML Pages","Description":"Uses CSS page-break directives to force page breaks when printing HTML pages.","Code":"&lt;html&gt;\r\n    \r\n    &lt;head&gt;\r\n        &lt;style type=&quot;text/css&quot;&gt;\r\n            body { font-family:Arial, Helvetica, sans-serif; font-size:10pt; font-weight:normal; color:#000000; }   \r\n            td { font-family:Arial, Helvetica, sans-serif; font-size:10pt; font-weight:normal; color:#000000; }\r\n            p {width:50%}\r\n            .DataHeader { font-family:Arial, Helvetica, sans-serif; font-size:12pt; font-weight:normal; color:#000000; }    \r\n            .DataBlock { page-break-inside: avoid }\r\n            .Bordered { border:1px solid #000000; width:50% }\r\n        &lt;/style&gt;\r\n    &lt;/head&gt;\r\n    \r\n    &lt;body&gt;\r\n    \r\n        &lt;p class='DataHeader'&gt;&lt;b&gt;Cover Page&lt;/b&gt;&lt;/p&gt;\r\n        &lt;p&gt;This HTML page demonstrates page breaks.  There will be a page break after this paragraph and between the first and second data blocks when the page is printed.&lt;/p&gt;\r\n        &lt;br style=&quot;page-break-before:always;&quot;&gt;\r\n\r\n        &lt;div class='Bordered'&gt;\r\n            &lt;table border='0' cellpadding='0' cellspacing='2' class='DataBlock'&gt;\r\n                &lt;tr&gt;&lt;td colspan='2' class='DataHeader'&gt;&lt;b&gt;Data block 1&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;\r\n                &lt;tr&gt;&lt;td&gt;&lt;b&gt;Col 1&lt;/b&gt;&lt;/td&gt;&lt;td&gt;&lt;b&gt;Col 2&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;\r\n                &lt;tr&gt;&lt;td&gt;r1c1&lt;/td&gt;&lt;td&gt;r1c2&lt;/td&gt;&lt;/tr&gt;\r\n                &lt;tr&gt;&lt;td&gt;r2c1&lt;/td&gt;&lt;td&gt;r2c2&lt;/td&gt;&lt;/tr&gt;\r\n                &lt;tr&gt;&lt;td&gt;r3c1&lt;/td&gt;&lt;td&gt;r3c2&lt;/td&gt;&lt;/tr&gt;\r\n            &lt;/table&gt;\r\n        &lt;/div&gt;\r\n        &lt;br style=&quot;page-break-before:always;&quot;&gt;\r\n        \r\n        \r\n        &lt;div class='Bordered'&gt;\r\n            &lt;table border='0' cellpadding='0' cellspacing='2' class='DataBlock'&gt;\r\n                &lt;tr&gt;&lt;td colspan='2' class='DataHeader'&gt;&lt;b&gt;Data block 2&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;\r\n                &lt;tr&gt;&lt;td&gt;&lt;b&gt;Col 1&lt;/b&gt;&lt;/td&gt;&lt;td&gt;&lt;b&gt;Col 2&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;\r\n                &lt;tr&gt;&lt;td&gt;r1c1&lt;/td&gt;&lt;td&gt;r1c2&lt;/td&gt;&lt;/tr&gt;\r\n                &lt;tr&gt;&lt;td&gt;r2c1&lt;/td&gt;&lt;td&gt;r2c2&lt;/td&gt;&lt;/tr&gt;\r\n                &lt;tr&gt;&lt;td&gt;r3c1&lt;/td&gt;&lt;td&gt;r3c2&lt;/td&gt;&lt;/tr&gt;\r\n            &lt;/table&gt;\r\n        &lt;/div&gt;\r\n    \r\n    &lt;/body&gt;\r\n&lt;/html&gt;","Declares":"","CodeCategory":{"CategoryId":"13","CategoryDescription":"CSS"},"Keywords":["Page Break"]},{"RecordId":"826","Title":"Enterprise Library - Explicit Use of Connection Open/Close","Description":"Demonstrates how to use explicit open and close connections in Microsoft Enterprise Library.","Code":"Database db = DatabaseFactory.CreateDatabase(&quot;RackV2_ILM&quot;);\r\nIDbConnection cn = db.GetConnection();\r\n\r\ncn.Open();\r\nIDbTransaction tx = cn.BeginTransaction();\r\n\r\nstring sqlCommand = &quot;ILM_pub_SelContentDomain&quot;;\r\nDBCommandWrapper dbCommandWrapper = db.GetStoredProcCommandWrapper(sqlCommand); \r\ndbCommandWrapper.AddInParameter(&quot;@Include&quot;, DbType.String, &quot;All&quot;);\r\nDataSet ds = db.ExecuteDataSet(dbCommandWrapper, tx);\r\ntx.Commit();\r\n\r\ntx.Dispose();\r\ntx=null;\r\n\r\ncn.Close();\r\ncn.Dispose();\r\ncn=null;\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Enterprise Library","Connections","IDbConnection"]},{"RecordId":"827","Title":"Cache vs. Static Variables","Description":"Article comparing ASP.Net Cache object and Static variables.","Code":"=====================\r\nASP.NET Cache\r\n=====================\r\n\r\nASP.NET cache object is a favorite caching mechanism. ASP.NET provides a key-value pair object, the Cache object, which is available in the System.Web.Caching namespace. The scope of it is the application domain and the life span is tied to the application.\r\n\r\nAlthough both Application and Cache objects look the same, the key difference between them is the added features provided by the Cache object like the expiration policies and dependencies. It means that the data stored in the cache object can be expired/removed based on some predefined time limit set by the application code or when the dependent entity gets changed whereas this feature is not available in the Application object.\r\n\r\nTime based expiration provides an option to expire an item in the cache at a predefined time. The expiration time can be set as absolute time like 31st October 2005 12:00 or sliding time i.e. relative to the current time when the item is accessed.\r\n\r\n//Absolute Expiration\r\nCache.Insert(&quot;EMP_NAME&quot;, &quot;Shubhabrata&quot;, null, DateTime.Now.AddDays(1), Cache.NoSlidingExpiration);\r\n\r\n//Sliding Expiration\r\nCache.Insert(&quot;EMP_NAME&quot;, &quot;Shubhabrata&quot;, null, Cache.NoAbsoluteExpiration, TimeSpan.FromSeconds(60));\r\n\r\n\r\nSometimes we want to know when an item is removed from the cache.  This is possible by using cache callbacks.  The following example shows how to use cache callback to handle the item expiration scenario:\r\n\r\nprivate void AddItemsToCache()\r\n{\r\n    int empNum = 5435;\r\n    CacheItemRemovedCallback onEmpDetailsRemove = new CacheItemRemovedCallback(EmpDetailsRemoved);\r\n    Cache.Insert(&quot;EMP_NUM&quot;, empNum, null,\r\n                              Cache.NoAbsoluteExpiration,\r\n                              Cache.NoSlidingExpiration,\r\n                              CacheItemPriority.Default,\r\n                              onEmpDetailsRemove);\r\n}\r\n\r\nprivate void EmpDetailsRemoved(string key, object val, CacheItemRemovedReason reason)\r\n{\r\n    //When the item is expired\r\n    if (reason == CacheItemRemovedReason.Expired)\r\n    {\r\n        //Add it back to the Cache\r\n        AddItemsToCache();\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n=====================\r\nStatic Variables\r\n=====================\r\n\r\nWe can use static variables for storing data or objects globally so that they can be accessed during the life of the application. Similarly, in ASP.NET we can use static objects for caching data and we can also provide methods to retrieve and save data to the cache. As static variables are stored in the process area, performance wise it is faster. But since it is very difficult to implement expiration policies and dependencies incase of static variables, I generally prefer ASP.NET cache object over this option. Another problem is that the custom static cache object has to be thread-safe which has to be implemented carefully.\r\n\r\nCustom static cache object can be defined as shown below:\r\npublic class CustomCache\r\n{\r\n    //Synchronized to implement thread-safe\r\n    static Hashtable _myCache =\r\n             Hashtable.Synchronized(new Hashtable());\r\n\r\n    public static object GetData(object key)\r\n    {\r\n        return _myCache[key];\r\n    }\r\n\r\n    public static void SetData(object key, object val)\r\n    {\r\n        _myCache[key] = val;\r\n    }\r\n}","Declares":"","CodeCategory":{"CategoryId":"20","CategoryDescription":".Net - ASP.Net"},"Keywords":["Cache","Static Variables"]},{"RecordId":"828","Title":"Paging in SQL Server 2005","Description":"Demonstrates how to use the ROW_NUMBER() keyword in SQL Server 2005 to number rows and then return a page of data from a query.","Code":"================================================================\r\nEfficiently Getting Back a Page of Data with SQL Server 2005\r\n================================================================\r\n\r\nSQL Server 2005 introduces a number of new keywords for returning ranked results. In particular, the ROW_NUMBER() keyword enables us to associate a sequentially-increasing row number for the results returned. We can use ROW_NUMBER(), then, to get a particular page of data using a query like the following:\r\n\r\nSELECT ...\r\nFROM\r\n   (SELECT ...\r\n         ROW_NUMBER() OVER(ORDER BY ColumnName) as RowNum\r\n    FROM Employees e\r\n   ) as DerivedTableName\r\nWHERE RowNum BETWEEN @startRowIndex AND (@startRowIndex + @maximumRows) - 1\r\n\r\nHere @startRowIndex is the index of the row to start from and @maximumRows is the maximum number of records to show per page. This query returns the subset of records whose ROW_NUMBER() is between the starting index and the starting index plus the page size.\r\n\r\nTo help concretize this concept, let's look at the following example. Imagine that we have an Employees table with 5,000 records. The following query:\r\n\r\nSELECT RowNum, EmployeeID, LastName, FirstName\r\nFROM\r\n   (SELECT EmployeeID, LastName, FirstName\r\n       ROW_NUMBER() OVER(ORDER BY EmployeeID) as RowNum\r\n    FROM Employees e\r\n   ) as EmployeeInfo\r\n\r\n\r\nWould return results like:\r\n\r\nRowNum EmployeeID LastName FirstName\r\n1 1000 Smith Frank\r\n2 1001 Jackson Lucy\r\n3 1011 Lee Sam\r\n4 1012 Mitchell Jisun\r\n5 1013 Yates Scott\r\n6 1016 Props Kathryn\r\n...\r\n5000 6141 Jordan DJ\r\n\r\nNotice that even though the EmployeeID fields may have gaps and may not start at 1, the ROW_NUMBER() value starts at 1 for the first record and steadily increases. Therefore, if we want to view 10 records per page, and we want to see the third page, we know that we want records 31-40, and can accomplish that in a simple WHERE clause.\r\n\r\n\r\n================================================================\r\nNumbering Rows with ROW_NUMBER\r\n================================================================\r\n\r\nThe ROW_NUMBER function assigns an ordinal value with each record returned, with the ordinal values depending on a particular ORDER BY clause used in tandem with the function. The syntax for ROW_NUMBER is: ROW_NUMBER() OVER([partition] order-by-clause). For example, the following query would return the products from most expensive to least expensive, with a rank assigned to each product based on price:\r\n\r\nSELECT ProductID, Name, Price,\r\n       ROW_NUMBER() OVER(ORDER BY Price DESC) As PriceRank\r\nFROM Products\r\n\r\n\r\nThe results would be:\r\n\r\nProductID Name Price PriceRank\r\n8 Desk 495.0000 1\r\n10 Executive Chair 295.0000 2\r\n9 Chair 125.0000 3\r\n5 Mouse 14.9500 4\r\n6 Mousepad 9.9900 5\r\n11 Scissors 8.5000 6\r\n4 Stapler 7.9500 7\r\n3 Binder 1.9500 8\r\n\r\n\r\nBy default, the ROW_NUMBER function assigns a increasing value to each record in the resultset. With the optional partition parameter, you can instruct the ROW_NUMBER function to start renumbering whenever there's a change in the value of the column for partitioning. To demonstrate this, I created a view called vwTotalAmountBilledPerOrder that returns each OrderID and the total amount billed for that order using the following query syntax:\r\n\r\nSELECT OrderID, SUM(AmountBilled) AS TotalOrderAmount\r\nFROM OrderItems\r\nGROUP BY OrderID\r\n\r\nThis returns each unique order in the OrderItems table along with the sum of AmountBilled values pertaining to that order. With this view we can use the ROW_NUMBER method to rank those orders by most amount of money spent using the following:\r\n\r\nSELECT c.Name, o.DateOrdered, tab.TotalOrderAmount,\r\n       ROW_NUMBER() OVER (ORDER BY TotalOrderAmount DESC) AS BestCustomer\r\nFROM vwTotalAmountBilledPerOrder AS tab\r\n       INNER JOIN Orders AS o ON\r\n           o.OrderID = tab.OrderID\r\n       INNER JOIN Customers AS c ON\r\n           c.CustomerID = o.CustomerID\r\n\r\n\r\n\r\nThis will return results like:\r\n\r\nName DateOrdered TotalOrderAmount BestCustomer\r\nBob 12/1/2005 12649.9900 1\r\nDarren 1/2/2006 620.0000 2\r\nBob 12/19/2005 265.8500 3\r\nTito 12/22/2005 14.9500 4\r\nBruce 1/5/2006 14.9500 5\r\nTito 12/18/2005 12.4400 6\r\nBruce 1/4/2006 9.9900 7\r\nLee Ann 1/3/2006 8.5000 8\r\n\r\n\r\nNotice that certain customers are on this list multiple times (Bob, Tito, and Bruce). Perhaps rather than seeing all orders, ordered by sales amount, we are interested in seeing the top orders per customer. We can accomplish this with the PARTITION BY clause in the ROW_NUMBER function like so:\r\n\r\nSELECT c.Name, o.DateOrdered, tab.TotalOrderAmount,\r\n       ROW_NUMBER() OVER (PARTITION BY c.CustomerID ORDER BY TotalOrderAmount DESC) AS BestCustomer\r\nFROM vwTotalAmountBilledPerOrder AS tab\r\n       INNER JOIN Orders AS o ON\r\n           o.OrderID = tab.OrderID\r\n       INNER JOIN Customers AS c ON\r\n           c.CustomerID = o.CustomerID\r\n\r\n\r\n\r\nThis will return the following results:\r\n\r\nName DateOrdered TotalOrderAmount BestCustomer\r\nBob 12/1/2005 12649.9900 1\r\nBob 12/19/2005 265.8500 2\r\nTito 12/22/2005 14.9500 1\r\nTito 12/18/2005 12.4400 2\r\nDarren 1/2/2006 620.0000 1\r\nBruce 1/5/2006 14.9500 1\r\nBruce 1/4/2006 9.9900 2\r\nLee Ann 1/3/2006 8.5000 1\r\n\r\n\r\nWhile these results are definitely cool, the bad news is that you can't use the ROW_NUMBER() (or any of the other ranking functions) in the WHERE clause. That is, you might want to say, &quot;Give me the products ranked by price whose rank is between 5 and 8.&quot; To accomplish this you'd need to use a derived table or view. For example, you could put the above query in a view called vwPriceRankedProducts and then get back just the 5th through 8th ranked products use the query:\r\n\r\nSELECT ProductID, Name, Price, PriceRank\r\nFROM vwPriceRankedProducts\r\nWHERE PriceRank BETWEEN 5 AND 8\r\n\r\n\r\n================================================================\r\nHandling Ties with RANK and DENSE_RANK\r\n================================================================\r\n\r\nThe ROW_NUMBER function blindly increments the value for each returned result based on the optional partition clause and the required order by clause. However, sometimes you may wish to handle ties differently, instead assigning the same value to ties. For example, earlier when displaying the list of total order amounts the amount of the order placed by Tito on 12/22/2005 is the same as the amount of the order placed by Bruce on 1/5/2006. However, the ROW_NUMBER function ranks these two rows as #4 and #5, rather than using #4 for both.\r\n\r\nBoth the RANK and DENSE_RANK functions will number ties with the same ranking. For example, using the following query:\r\n\r\nSELECT c.Name, o.DateOrdered, tab.TotalOrderAmount,\r\n       RANK() OVER (ORDER BY TotalOrderAmount DESC) AS BestCustomer\r\nFROM vwTotalAmountBilledPerOrder AS tab\r\n       INNER JOIN Orders AS o ON\r\n           o.OrderID = tab.OrderID\r\n       INNER JOIN Customers AS c ON\r\n           c.CustomerID = o.CustomerID\r\n\r\n\r\nThe results will be:\r\n\r\nName DateOrdered TotalOrderAmount BestCustomer\r\nBob 12/1/2005 12649.9900 1\r\nDarren 1/2/2006 620.0000 2\r\nBob 12/19/2005 265.8500 3\r\nTito 12/22/2005 14.9500 4\r\nBruce 1/5/2006 14.9500 4\r\nTito 12/18/2005 12.4400 6\r\nBruce 1/4/2006 9.9900 7\r\nLee Ann 1/3/2006 8.5000 8\r\n\r\n\r\nNotice how the two orders with the same amount are both ranked #4. The difference between RANK and DENSE_RANK is in how they begin renumbering after the tied results. RANK bypasses as many numbers as there are tied results. In our example above, since there are two results tied at #4, following that rank #5 is skipped and the ranking resumes with #6. DENSE_RANK, on the other hand, picks up with the next number. Had we replaced the function name RANK with DENSE_RANK in the above query, Tito's order on 12/18/2005 for $12.44 would have the rank #5.\r\n\r\nLike ROW_NUMBER both RANK and DENSE_RANK can use the optional PARTITION BY clause.\r\n\r\n================================================================\r\nGrouping Ranked Results with NTILE\r\n================================================================\r\nThe final ranking-related T-SQL function new to SQL Server 2005 is NTILE(int). NTILE operates like the other ranking functions, but breaks down the results into int number of groups, assigning the same rankings for all records in the specified group. You can use NTILE to break results down into halves, thirds, quarters, and so on, as this example shows:\r\n\r\nSELECT ProductID, Name, Price, NTILE(4) OVER (ORDER BY Price DESC) as Quartile\r\nFROM Produts\r\n\r\n\r\nWith the results being:\r\n\r\nProductID Name Price Quartile\r\n8 Desk 495.0000 1\r\n10 Executive Chair 295.0000 1\r\n9 Chair 125.0000 2\r\n5 Mouse 14.9500 2\r\n6 Mousepad 9.9900 3\r\n11 Scissors 8.5000 3\r\n4 Stapler 7.9500 4\r\n3 Binder 1.9500 4","Declares":"","CodeCategory":{"CategoryId":"6","CategoryDescription":"T-SQL"},"Keywords":["Paged Results","ROW_NUMBER()"]},{"RecordId":"829","Title":"Architecture Principles and Groupings","Description":"The following explanation of Architecture Principles were written by Mark Schults, a senior Certified IT Architect at IBM.  The article was published in March 2007.","Code":"Architecture Principles and Groupings\r\n\r\nYou should try to limit the number of principles so as not to overwhelm the person trying to understand them. A general rule is to keep it to 20 or less. This number will be higher if you are developing a reference architecture that is enterprisewide.\r\n\r\nAs the number of principles increase, it will become clear that there are some natural groupings. Most architectures end up with the following principle groupings: \r\n\r\nGeneral architecture \r\nBusiness \r\nTechnology \r\nInformation/data \r\nManagement \r\nIndustry trends \r\nSecurity \r\nTesting \r\n\r\nThe following sections briefly cover these principles and can be used for your next project. They reflect the natural groupings, listed above, that enable people to better understand their focus and applicability to their role.\r\n\r\nGeneral architecture principles\r\n\r\nOn demand - An enterprise's business processes must be integrated end to end with key partners, suppliers, and customers. A business must rapidly respond to any customer demand, market opportunity, or external threat. \r\nEase of use - The IT architecture will promote ease of use in building and supporting the architecture, and solutions based on the architecture. \r\nNonfunctional requirements weighted equally to functional requirements - Nonfunctional requirements will be designed, developed, tested, and managed with the rigor of functional requirements. \r\nSingle point of view - The IT architecture will enable solutions that provide a consistent, integrated view of the business, regardless of access point. \r\nBuy compared to build - Business applications, system components, and enabling frameworks will be purchased unless there is a competitive reason to develop them internally. \r\nSimplicity - The IT architecture should be kept as simple as possible while still meeting business and enterprise requirements. Where complexity is needed, it should be encapsulated to promote simplicity of solutions built on the architecture. \r\n\r\nBusiness principles\r\n\r\nSpeed and quality - Architectural decisions will be made with an emphasis on accelerating time to market for solutions, while still maintaining quality. \r\nFlexibility - The IT architecture will incorporate flexibility to support changing business needs and enable evolution of the architecture and the solutions built on it. \r\nTechnology risk - Stability of business systems will be preserved through controlled usage and management of technology across its life cycle. \r\nIntegrated solutions - The IT architecture will support the delivery of business solutions composed of integrated application and infrastructure components. \r\nAlignment of IT to business - The IT architecture will be aligned with the business vision, objectives, and strategies and will support the business operations. \r\nStrategic use of relationships - The IT architecture will leverage strategic relationships with other businesses and vendors to facilitate building and evolution of the IT architecture. \r\nOptimize IT infrastructure - The IT infrastructure will be optimized based on business requirements and technology capabilities. \r\n\r\nTechnology principles\r\n\r\nInnovative and agile - The IT architecture will readily support incorporation of new technologies to support business and technology innovation. \r\nTechnology and vendor independence - The IT architecture will be designed to reduce the impact of technology changes on the business, as well as be resilient to change. \r\n\r\nInformation/data principles\r\n\r\nAll components of the computing environment must maintain confidentiality and integrity of the information that is used to conduct business, with decisions based on data classification.\r\n\r\nManagement principles\r\n\r\nGeneral governance - Compliance to and evolution of the architecture will be managed through controlled governance processes. \r\nCost performance - The IT architecture will be managed to ensure the cost effectiveness of the information and technology environment. \r\nApplications and infrastructure components - These elements will be designed and implemented to facilitate monitoring and measurement. \r\nService-level management - The IT architecture will support operation of business processes as defined by service-level agreements. \r\n\r\nIndustry trend principles\r\n\r\nOpen standards - The IT architecture will use open industry standards. \r\nLeverage industry knowledge \r\nThe IT architecture will leverage industry best practices. \r\nService-oriented - The IT architecture and components built upon it should be viewed as a set of independent services that can be composed to provide a solution. \r\nSeparation of concerns - The IT architecture will support clearly defined, well partitioned, and loosely coupled components, processes, and roles. \r\nReuse - Common components in the IT architecture should be used while balancing application and enterprise requirements. \r\n\r\nSecurity principles\r\n\r\nThe following principles are value statements that the business requires for the delivery of security (including trust model, asset profile). \r\n\r\nDefense in depth - Greater security will be obtained by layering defenses. \r\nManaged risk - Risk and security controls should be balanced according to business objectives -- security controls should be proportionate to risk. \r\nSecurity by design - Security should not be an afterthought or add-on. Security considerations should begin with the requirements phase of development and be treated as an integral part of the overall system design. \r\nRequirements-based access - A user (human or computer) should only be given enough privileges to do those tasks needed to perform a specified job activity, function, or task; no more, no less. \r\nTransparency - Security should be user transparent and not cause users undue extra effort. Administration and configuration of security components should not be overly complex or obscure. \r\nResilience in response - Design and operate IT systems to limit vulnerability and to be resilient in response. \r\nEnforced policy - Implement processes, procedures, and systems that promote enforcement of organizational security policies. \r\n\r\nTesting principles\r\n\r\nTestability - IT architecture should be designed for testing. Test environments will provide simulation of the production environment to a degree appropriate for the level and type of testing. The design of the IT architecture should not preclude simulating the production environment due to cost or complexity. \r\n\r\nThe IT architecture should support test efforts that are able to work independently, without excessive coordination or scheduling.\r\n","Declares":"","CodeCategory":{"CategoryId":"7","CategoryDescription":"Misc"},"Keywords":["Architecture Principles"]},{"RecordId":"830","Title":"Triggers - Disadvantages for Using Them","Description":"Brief list of disadvantages for using triggers.","Code":"While triggers provide a great deal of power and flexibility, they can very easily used in a manner that is detrimental to the database's maintainability and performance. It is all too easy to forget that you added a trigger or to overlook an existing trigger that was added by someone else. If you don't recall or know of a particular trigger's existence, certain behavior may seem buggy and be confusing. \r\n\r\nTriggers are also notorious for being inefficiently designed. While inserts, updates, and deletes can occur over sets of data (for example, UPDATE Employees SET Salary = Salary * 2 WHERE HireDate &lt; '2007-01-01' doubles the salary for every employee hired before 2007), oftentimes the logic of triggers applies on a record-by-record basis. Consequently, triggers often include CURSORs to enumerate the inserted, updated, or deleted records one at a time. This can introduce a performance bottleneck. \r\n\r\nHaving multiple triggers on a table can add to the confusion - if there are three triggers on the Employees table that are all configured to execute after data is deleted, when records are deleted which trigger runs first, then second, then third? \r\n\r\nTriggers are limited in that they cannot work with text or image columns, which are used to store large amounts of text or binary data. The good news is that in Microsoft SQL Server 2005 these limitations can be circumvented by using the data types varchar(MAX) (or nvarchar(MAX)) and varbinary(MAX) instead of text and image, respectively. \r\n\r\nTriggers also suffer from a maintainability standpoint.  Namely, each time a table's schema changes, the trigger needs to be updated to reflect the change. ","Declares":"","CodeCategory":{"CategoryId":"10","CategoryDescription":"SQL Server"},"Keywords":["Triggers"]},{"RecordId":"831","Title":"JavaScript Sleep Function","Description":"Function so simulate &quot;Sleep()&quot; in JavaScript","Code":"function pause(millis) \r\n{\r\n    var date = new Date();\r\n    var curDate = null;\r\n\r\n    do { curDate = new Date(); } \r\n    while(curDate-date &lt; millis)\r\n}\r\n\r\nUsage:\tpause(1000);\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"4","CategoryDescription":"JavaScript / DHTML"},"Keywords":["Sleep","Wait","Pause"]},{"RecordId":"832","Title":"Read and Write a Text File One Line at a Time","Description":"Demonstrates how to read and write a text file one line at a time.","Code":"// Read a text file one line at a time\r\nStreamReader file = new StreamReader(FileName);\r\nwhile((strLine = file.ReadLine()) != null)\r\n{\r\n  string strTextFromFile = strLine;\r\n}\r\nfile.Close();\r\n\r\n\r\n// Write a text file one line at a time\r\nTextWriter file = new StreamWriter(FileName,false,Encoding.ASCII);\r\nforeach (DictionaryEntry de in RandomNumberList)\r\n{\r\n  int intIndex = int.Parse(de.Value.ToString());\r\n  file.WriteLine(SongList[intIndex]);\r\n}\r\nfile.Close();\r\n\r\n\r\n\r\n\r\n\r\n\t","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["File I/O","Read Text File","Write Text File"]},{"RecordId":"833","Title":"Tracing and Assertions","Description":"Philosophy of tracing and assertions.","Code":"--------------\r\nAssert\r\n--------------\r\n\r\nFor .NET, all your assertions start with De-bug.Assert methods from the System.Diagnostic namespace. There are three over-loaded Assert methods. All three take a Boolean value as their first or only parame-ter, and if the value is false, the assertion is triggered. As shown in the following ex-amples in which I used Debug.Assert, one of the methods takes a second parameter of type string, which is shown as a message in the output. The final overloaded Assert method takes a third parameter of type string, which provides even more informa-\r\ntion when the assertion triggers. In my experience, the two-parameter approach is the easiest to use because I simply copy the condition checked in the first parameter and paste it in as a string.\r\n\r\nDebug.Assert ( i &gt; 3 ) ;\r\nDebug.Assert ( i &gt; 3 , &quot;i &gt; 3&quot; ) ;\r\nDebug.Assert ( i &gt; 3 , &quot;i &gt; 3&quot; , &quot;This means I got a bad parameter&quot;) ;\r\n\r\n// The wrong way to write an assertion. Which parameter was bad?\r\nstring FillData ( char[] array , int offset , int length )\r\n{\r\n    Debug.Assert ( ( null != array ) &amp;&amp;\r\n        ( offset &gt; 0 ) &amp;&amp;\r\n        ( ( length &gt; 0 &amp;&amp; ( length &lt; 100 ) ) ) );\r\n    ...\r\n}\r\n\r\n// The proper way. Each parameter is checked individually so that you\r\n// can see which one failed.\r\nstring FillData ( char[] array , int offset , int length )\r\n{\r\n    Debug.Assert ( null != array , &quot;null != array&quot;) ;\r\n    Debug.Assert ( offset &gt; 0, &quot;offset &gt; 0&quot;) ;\r\n    Debug.Assert ( ( length &gt; 0 ) &amp;&amp; ( length &lt; 100 ) ,\r\n    &quot; ( length &gt; 0 ) &amp;&amp; ( length &lt; 100 )&quot; ) ;\r\n    ...\r\n}\r\n\r\n\r\nIt doesnt hurt to assert every parameter of every method, but if a parameter comes from outside the module, and if you fully asserted it once, you might not need to again. By asserting each parameter on every function, however, you might catch some errors inside your module.\r\n\r\n\r\n--------------\r\nTrace\r\n--------------\r\n\r\nThe Trace object has four overloaded methods to output trace information: Write, WriteIf, WriteLine, and WriteLineIf. You can probably guess the difference between Write and WriteLine, but understanding the *If methods is a little more challenging: they allow for conditional tracing. If the first parameter to the *If method evaluates to true, the trace happens; evaluating to false means it doesnt.\r\n\r\n// Paying the overhead every time\r\nTrace.WriteLineIf ( bShowTrace , &quot;Parameters: x=&quot; + x + &quot;y=&quot; + y );\r\n\r\n// Causing the concatenation only when necessary\r\nif ( true == bShowTrace )\r\n{\r\n    Trace.WriteLine (&quot;Parameters: x=&quot; + x + &quot;y=&quot; + y );\r\n}\r\n\r\nThe most important part of TraceSwitch is the name its given in the first parameter of the constructor. (The second parameter is a descriptive name.) The name enables you to control the switch from outside the ap-plication, which Ill talk about in a moment. TraceSwitch objects wrap a tracing level. The levels are shown in Table 3-1. To check whether TraceSwitch matches a particu-lar level, you use a set of properties, such as TraceError, that returns true if the switch condition is met. Combined with the *If methods, using TraceSwitch objects is quite straightforward.\r\n\r\npublic static void Main ( )\r\n{\r\n    TraceSwitch TheSwitch = new TraceSwitch ( &quot;SwitchyTheSwitch&quot;,&quot;Example Switch&quot; );\r\n    TheSwitch.Level = TraceLevel.Info ;\r\n    Trace.WriteLineIf ( TheSwitch.TraceError , &quot;Error tracing is on!&quot; ) ;\r\n    Trace.WriteLineIf ( TheSwitch.TraceWarning , &quot;Warning tracing is on!&quot; ) ;\r\n    Trace.WriteLineIf ( TheSwitch.TraceInfo , &quot;Info tracing is on!&quot; ) ;\r\n    Trace.WriteLineIf ( TheSwitch.TraceVerbose , &quot;VerboseSwitching is on!&quot; ) ;\r\n}\r\n\r\nThe real magic of TraceSwitch objects is that they allow you to easily set them from outside the application in the ubiquitous .Config file. The switches element under the system.diagnostics element is where you specify the add elements to add and set the name and level. A complete configuration file for an application follows this paragraph. Ideally, you have a separate TraceSwitch object for each assembly in your application. Keep in mind that the TraceSwitch settings can also be applied to the global Machine.Config.\r\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;\r\n&lt;configuration&gt;\r\n    &lt;system.diagnostics&gt;\r\n        &lt;switches&gt;\r\n            &lt;add name=&quot;Wintellect.ScheduleJob&quot; value=&quot;4&quot; /&gt;\r\n            &lt;add name=&quot;Wintellect.DataAccess&quot; value=&quot;0&quot; /&gt;\r\n        &lt;/switches&gt;\r\n    &lt;/system.diagnostics&gt;\r\n&lt;/configuration&gt;","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Assert","Trace"]},{"RecordId":"834","Title":"Exceptions","Description":"Exception handling philosophy","Code":"Exception types should always be serializable so that the exception object can be marshaled across an AppDomain or a machine boundary and rethrown in the clients code. Making an exception type serializable also allows it to persist in a log or a data-base. To make your exception type serializable, you must apply the [Serializable] cus-tom attribute to the type, and if the type defines any fields of its own, you must also implement the ISerializable interface along with its GetObjectData method and spe-cial protected constructor, both of which take SerializationInfo and StreamingCon-text parameters. The following code shows how to properly define your own excep-tion type:\r\n\r\nusing System;\r\nusing System.IO;\r\nusing System.Runtime.Serialization;\r\nusing System.Runtime.Serialization.Formatters.Soap;\r\n\r\n// Allow instances of DiskFullException to be serialized.\r\n[Serializable]\r\nsealed class DiskFullException : Exception, ISerializable {\r\n    // The three public constructors\r\n    public DiskFullException(): base() {\r\n        // Call base constructor.\r\n    }\r\n\r\n    public DiskFullException(String message): base(message) {\r\n        // Call base constructor.\r\n    }\r\n\r\n    public DiskFullException(String message, Exception innerException): base(message, innerException) {\r\n        // Call base constructor.\r\n    }\r\n\r\n    // Define a private field.\r\n    private String diskpath;\r\n\r\n    // Define a read-only property that returns the field.\r\n    public String DiskPath {\r\n        get {\r\n            return diskpath;\r\n        }\r\n    }\r\n\r\n    // Override the public Message property so that the field is included in the message.\r\n    public override String Message {\r\n        get {\r\n            String msg = base.Message;\r\n            if (diskpath != null)\r\n            msg += Environment.NewLine + &quot;Disk Path: &quot; + diskpath;\r\n            return msg;\r\n        }\r\n    }\r\n\r\n    // Because at least one field is defined, define the special deserialization\r\n    // constructor. Because this class is sealed, this constructor is private.\r\n    // If this class is not sealed, this constructor should be protected.\r\n    private DiskFullException(SerializationInfo info, StreamingContext context): base(info, context) {\r\n        // Let the base deserialize its fields.\r\n        // Deserialize each field.\r\n        diskpath = info.GetString(&quot;DiskPath&quot;);\r\n    }\r\n\r\n    // Because at least one field is defined, define the serialization method.\r\n    void ISerializable.GetObjectData(SerializationInfo info, StreamingContext context) {\r\n        // Serialize each field.\r\n        info.AddValue(&quot;DiskPath&quot;, diskpath);\r\n        // Let the base type serialize its fields.\r\n        base.GetObjectData(info, context);\r\n    }\r\n\r\n    // Define additional constructors that set the field.\r\n    public DiskFullException(String message, String diskpath): this(message) {\r\n        // Call another constructor.\r\n        this.diskpath = diskpath;\r\n    }\r\n\r\n    public DiskFullException(String message, String diskpath,Exception innerException): this(message, innerException) {\r\n        // Call another constructor.\r\n        this.diskpath = diskpath;\r\n    }\r\n}\r\n\r\n// The following code tests the serialization of the exception.\r\nclass App {\r\n    static void Main() {\r\n\r\n        // Construct a DiskFullException object, and serialize it.\r\n        DiskFullException e = new DiskFullException(&quot;The disk volume is full&quot;, @&quot;C:\\&quot;);\r\n        FileStream fs = new FileStream(@&quot;Test&quot;, FileMode.Create);\r\n        IFormatter f = new SoapFormatter();\r\n        f.Serialize(fs, e);\r\n        fs.Close();\r\n\r\n        // Deserialize the DiskFullException object, and check its fields.\r\n        fs = new FileStream(@&quot;Test&quot;, FileMode.Open);\r\n        e = (DiskFullException) f.Deserialize(fs);\r\n        fs.Close();\r\n        Console.WriteLine(&quot;Type: {1}{0}DiskPath: {2}{0}Message: {3}&quot;,\r\n        Environment.NewLine, e.GetType(), e.DiskPath, e.Message);\r\n\r\n    }\r\n}","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Exceptions"]},{"RecordId":"835","Title":"Paged Data in a Stored Procedure Using XML","Description":"Demonstrates how to pass record ID's into a stored procedure as XML so that you can join against it for paged data.","Code":"/*****************************************************************************************************************\r\nPROCEDURE:  pub_GetDashboardDetail_Search\r\nCOMMENTS:   Incoming @positions text contains a list of positions as XML in the following format:\r\n        &lt;a&gt;\r\n            &lt;b c=&quot;28425&quot; /&gt;\r\n            &lt;b c=&quot;28267&quot; /&gt;\r\n            &lt;b c=&quot;28268&quot; /&gt;\r\n            &lt;b c=&quot;28462&quot; /&gt;\r\n            &lt;b c=&quot;28988&quot; /&gt;\r\n            &lt;b c=&quot;29079&quot; /&gt;\r\n            &lt;b c=&quot;29168&quot; /&gt;\r\n            &lt;b c=&quot;29239&quot; /&gt;\r\n            &lt;b c=&quot;29547&quot; /&gt;\r\n            &lt;b c=&quot;28054&quot; /&gt;\r\n            &lt;b c=&quot;28086&quot; /&gt;\r\n            &lt;b c=&quot;28151&quot; /&gt;\r\n            &lt;b c=&quot;28809&quot; /&gt;\r\n            &lt;b c=&quot;28343&quot; /&gt;\r\n            &lt;b c=&quot;28907&quot; /&gt;\r\n            &lt;b c=&quot;28489&quot; /&gt;\r\n            &lt;b c=&quot;27533&quot; /&gt;\r\n            &lt;b c=&quot;28217&quot; /&gt;\r\n            &lt;b c=&quot;28521&quot; /&gt;\r\n            &lt;b c=&quot;28559&quot; /&gt;\r\n        &lt;/a&gt;\r\n*****************************************************************************************************************/\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\n\r\nALTER   PROCEDURE [dbo].[pub_GetDashboardDetail_Search] \r\n(\r\n    @user_SID   INT,\r\n    @positions  NTEXT = NULL\r\n)\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    DECLARE @ErrorNbr int;\r\n    DECLARE @ErrorMessage varchar(400);\r\n    DECLARE @positionsHandle INT;\r\n\r\n    IF @positions IS NULL\r\n    BEGIN\r\n        -- Build the XML for th error message\r\n        SET @ErrorMessage = '&lt;Error number=&quot;' + Cast(@ErrorNbr as Varchar) + '&quot; procedure=&quot;pub_GetDashboardDetail_Search&quot;&gt;' +\r\n            '&lt;Parameter name=&quot;@positions&quot; value=&quot;' + IsNull(cast(@positions as VARCHAR), 'NULL') + '&quot;/&gt;' + \r\n            '&lt;Parameter name=&quot;@user_SID&quot; value=&quot;' + IsNull(cast(@user_SID as VARCHAR), 'NULL') + '&quot;/&gt;' + \r\n        '&lt;/Error&gt;';\r\n\r\n        -- Raise the error\r\n        RAISERROR (@ErrorMessage, 16 , 1);\r\n    END\r\n\r\n    DECLARE @positionsTable TABLE (\r\n        ID INT IDENTITY(1,1),\r\n        Position_SID INT NOT NULL\r\n    );\r\n\r\n    IF @positions IS NOT NULL\r\n        BEGIN\r\n            EXEC sp_Xml_PrepareDocument @positionsHandle OUTPUT, @positions\r\n            INSERT INTO @positionsTable \r\n            SELECT CAST([Position_SID] AS INT) FROM OPENXML(@positionsHandle, '/a/b', 1) WITH([Position_SID] VARCHAR(50) '@c')\r\n            IF @positionsHandle IS NOT NULL EXEC sp_Xml_RemoveDocument @positionsHandle\r\n        END\r\n    ELSE\r\n        BEGIN\r\n            SET @positionsHandle = NULL\r\n        END\r\n\r\n    SELECT\r\n        C.[Candidate_SID],\r\n        IsNull(C.[LastName], '') + ', ' + \r\n        IsNull(C.[FirstName], '') + ' ' + \r\n        IsNull(C.[MiddleName], '') as [Candidate Name],\r\n        J.[PersonnelArea] as [Personnel Area],\r\n        CS.[SSN] as [SSN / PAN],\r\n        CSt.[CandidateStatusShortDesc] AS [Status],\r\n        J.[EventDate] as [Start Date],\r\n        L.[LocationDesc] as [Office],\r\n        R.[Name] as [Recruiter],\r\n        C.[RMSApplicantID] as [RMS Applicant ID],\r\n        J.[Requisition] as [Requisition Number],\r\n        CS.[SSN] as [SSN],\r\n        IsNull(X.[XmlDiffTotal], 0) AS [Pending XML Differences],\r\n        SAP.[SAPPersonnelNumber] AS [Personnel Number],\r\n        ENLS.[EnlsStatus] AS [ENLS Status],\r\n        RA.[RegionAbbreviation] AS [Region],\r\n        RCC.[CostCenterCode] AS [Cost Center],\r\n        ES.[EmployeeSubgroupAbbr] AS [Employee Subgroup],\r\n        HRS.[ChangeOnDate] AS [HR Submitted],\r\n        J.[Position_SID] as [Position_SID],\r\n        PA.[RegionCode] as [Region Code],\r\n        RCC.[CompanyCode] as [Company Code],\r\n        JT.[JobDesc] as [Title],\r\n        STUFF(RCC.[CostCenterCode],1,PATINDEX('%[^0]%',RCC.[CostCenterCode]) - 1, SPACE(0)) + ' &amp; ' + RCC.[CostCenterDesc] as [Cost Center Full]\r\n    -- Populate Temp Table\r\n    FROM\r\n        [dbo].[Job] J WITH(NOLOCK)\r\n    -- Limit result Set by input parmater results\r\n    INNER JOIN \r\n        @positionsTable POSIT ON J.[Position_SID] = POSIT.[Position_SID]\r\n    -- Join on the Candidate table\r\n\r\n    ORDER BY POSIT.[ID]\r\n\r\n    SET @ErrorNbr = @@ERROR;\r\n    IF @ErrorNbr &lt;&gt; 0\r\n    BEGIN\r\n        -- Build the XML for th error message\r\n        SET @ErrorMessage = '&lt;Error number=&quot;' + Cast(@ErrorNbr as Varchar) + '&quot; procedure=&quot;pub_GetDashboardDetail_Search&quot;&gt;' +\r\n            '&lt;Parameter name=&quot;@user_SID&quot; value=&quot;' + IsNull(cast(@user_SID as VARCHAR), 'NULL') + '&quot;/&gt;' + \r\n        '&lt;/Error&gt;';\r\n\r\n        -- Raise the error\r\n        RAISERROR (@ErrorMessage, 16 , 1);\r\n    END\r\nEND\r\nGO\r\n\r\nSET ANSI_NULLS OFF\r\nGO\r\nSET QUOTED_IDENTIFIER OFF\r\nGO","Declares":"","CodeCategory":{"CategoryId":"6","CategoryDescription":"T-SQL"},"Keywords":["Paged Data","XML"]},{"RecordId":"836","Title":"AJAX Web Services","Description":"Article explaining using AJAX extensions to return results from a web service formatted as either XML or JSON (Javascript Object Notation).","Code":"The following information is taken from several articles written by Dan Wahlin.\r\n\r\nCreating AJAX-Enabled Web services in .NET\r\n\r\nAlthough modern browsers such as Internet Explorer, FireFox and Safari support many different technologies ranging from DOM to CSS to JavaScript, XML parsing support isn't consistent across browsers and is fairly limited except in Internet Explorer. This lack of parsing support presents a challenge when exchanging data between a browser and a service, since Web services typically send XML messages that conform to the SOAP specification. Fortunately, you can overcome the XML parsing problem by exchanging messages using JavaScript Object Notation (JSON), as opposed to SOAP. JSON parsing support is built-in to all major browsers, making it a viable option. A little work is required on your part to allow .NET Web services to handle JSON messages, though.\r\n\r\nSOAP is difficult to work with on the client-side. Instead, modern browsers support a specialized way to &quot;markup&quot; object data called JavaScript Object Notation (JSON). JSON provides several benefits including cross-browser support and the ability to exchange data among distributed applications in a compact messaging format.\r\n\r\nJSON uses several delimiter characters such as { } and [ ] to serialize name/value pairs and arrays. While XML requires that every starting tag has a closing tag, JSON only requires that the { and } characters properly match up. For example, if you need to pass the name of a country to a service so that you can retrieve customers that live in that country, you can pass the following JSON message:\r\n\r\n{&quot;Country&quot;:&quot;Argentina&quot;}\r\n\r\nThis simple JSON message contains the data item's name (in C# or VB.NET terms, think of it as the property name) as well as the value. Notice that the name and value are wrapped using the { and } characters. Multiple name/value pairs can be added and separated with a comma:\r\n\r\n{&quot;Country&quot;:&quot;Argentina&quot;,\r\n &quot;Continent&quot;:&quot;South America&quot;}\r\n\r\n\r\nAn array of customers serialized into the JSON format might look like this:\r\n[\r\n {\r\n  &quot;Country&quot;:&quot;Argentina&quot;,\r\n  &quot;CompanyName&quot;:&quot;Cactus Comidas\r\n   paralevar&quot;,\r\n  &quot;CustomerID&quot;:&quot;CACTU&quot;,\r\n  &quot;ContactName&quot;:\r\n  &quot;Patricio Simpson&quot;\r\n },\r\n {\r\n  &quot;Country&quot;:&quot;Argentina&quot;,\r\n  &quot;CompanyName&quot;:&quot;Oc&#233;ano Atl&#225;ntico\r\n   Ltda.&quot;,\r\n  &quot;CustomerID&quot;:&quot;OCEAN&quot;,\r\n  &quot;ContactName&quot;:&quot;Yvonne Moncada&quot;\r\n },\r\n {\r\n  &quot;Country&quot;:&quot;Argentina&quot;,\r\n  &quot;CompanyName&quot;:&quot;Rancho grande&quot;,\r\n  &quot;CustomerID&quot;:&quot;RANCH&quot;,\r\n  &quot;ContactName&quot;:&quot;Sergio Guti&#233;rrez&quot;\r\n }\r\n]\r\n\r\n\r\n.NET Web services don't natively work with JSON messages, but Microsoft's ASP.NET AJAX Extensions provides a way to easily allow services to support JSON messages so you can use them with little effort.\r\n\r\nThe ASP.NET AJAX Extensions provide a class named ScriptMethodAttribute that can be applied to Web methods in a Web service. By using the ScriptMethodAttribute class, clients can make GET requests instead of POST requests when calling a service and can receive XML data instead of JSON data. ScriptMethodAttribute exposes three properties including UseHttpGet (which accepts a Boolean value), ResponseFormat (which can be set to a ResponseFormat enumeration value), and XmlSerializeString (which can be set to a Boolean value). You should only change to GET when you're absolutely sure that sensitive data isn't going to be passed to and from a Web service. Sticking with the default POST verb is recommended.\r\n\r\nThe code below shows a standard .NET Web Service with a single Web Method named Add(). While this service will work fine with clients that are capable of working with SOAP, it won't work &quot;out of the box&quot; with ASP.NET AJAX applications since it doesn't know how to work with JSON messages.\r\n\r\n[WebService(Namespace = &quot;http://www.xmlforasp.net&quot;)]\r\n[WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]\r\npublic class MathService : System.Web.Services.WebService\r\n{\r\n    public MathService()\r\n    {\r\n    }\r\n\r\n    [WebMethod]\r\n    public int Add(int x, int y)\r\n    {\r\n        return x + y;\r\n    }\r\n}\r\n\r\nTo allow the service to handle JSON messages, the ASP.NET AJAX Extensions's ScriptServiceAttribute class can be applied to the Web Service class, as shown in the code below. The attribute is applied directly above the service's class and does nothing more than mark the service as being JSON-capable.\r\n\r\n[System.Web.Script.Services.ScriptService]\r\n[WebService(Namespace = &quot;http://www.xmlforasp.net&quot;)]\r\n[WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]\r\npublic class MathService : System.Web.Services.WebService\r\n{\r\n    public MathService()\r\n    {\r\n    }\r\n\r\n    [WebMethod]\r\n    public int Add(int x, int y)\r\n    {\r\n        return x + y;\r\n    }\r\n}\r\n\r\n\r\nWhen you'd like a Web method to return XML data, you can set the ResponseFormat property to a value of ResponseFormat.Xml as shown below:\r\n\r\n[ScriptMethod(ResponseFormat = ResponseFormat.Xml)]\r\n[WebMethod]\r\npublic XmlElement GetRssFeed(string url)\r\n{\r\n    XmlDocument doc = new XmlDocument();\r\n    doc.Load(url);\r\n    return doc.DocumentElement;\r\n}\r\n\r\n\r\nIn cases where Web methods return string values that you'd like wrapped in an XML tag, you can set the XmlSerializeString property to true as shown below. This will wrap the returned string with &lt;string&gt;&lt;/string&gt; tags.\r\n\r\n[ScriptMethod(ResponseFormat = ResponseFormat.Xml,XmlSerializeString=true)]\r\n[WebMethod]\r\npublic string GetXmlString(string input)\r\n{\r\n    return input;\r\n}\r\n\r\nThe default JSON message format using in ASP.NET AJAX should be leveraged wherever possible when working in a cross-browser environment.  However, in cases where a browser with XML parsing support is available, you can use the ScriptMethodAttribute class to send XML responses to the client.","Declares":"","CodeCategory":{"CategoryId":"20","CategoryDescription":".Net - ASP.Net"},"Keywords":["AJAX","Web Services","JSON"]},{"RecordId":"837","Title":"Determine Pixel is Black and White or Color","Description":"Determine if a pixel is within a gray scale tolerance.  If not, assume the pixel comes from a color photo.","Code":"GRAY_TOLERANCE = 5\r\n\r\nprivate static bool IsGray(System.Drawing.Color c)\r\n{\r\n  int min = Math.Min(Math.Min(c.R, c.G), c.B);\r\n  int max = Math.Max(Math.Max(c.R, c.G), c.B);\r\n  return ((max - min) &lt;= GRAY_TOLERANCE);\r\n}\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Black and White","IsGray"]},{"RecordId":"838","Title":"Generics","Description":"Overview of .Net 2.0 Generics.","Code":"Excerpt from Professional C# 2005 (John Wiley &amp; Sons, Inc. - aka WROX Press)\r\nby Christian Nagel, Bill Evjen, Jay Glynn, Karli Watson, Morgan Skinner, Allen Jones\r\n\r\n==================\r\nPerformance\r\n==================\r\n\r\nOne of the big advantages of generics is performance. Adding a value type to such a collection results in boxing and unboxing when the value type is converted to a reference type and vice versa.\r\n\r\nHere is a short look at boxing and unboxing.  Value types are stored on the stack. Reference types are stored on the heap. C# classes are reference type; structs are value types. .NET makes it easy to convert value types to reference types, and so you can use a value type everywhere an object (which is a reference type) is needed. For example, an int can be assigned to an object. The conversion from a value type to a reference type is known as boxing. Boxing happens automatically if a method requires an object as a parameter, and a value type is passed. On the other side, a boxed value type can be converted to a value type using unboxing. With unboxing the cast operator is required.\r\n\r\nThe following example shows the ArrayList class from the namespace System.Collections. ArrayList stores objects, the Add() method is defined to require an object as a parameter, and so an integer type is boxed. When the values from an ArrayList are read, unboxing occurs when the object is converted to an integer type. This may be obvious with the cast operator that is used to assign the first element of the ArrayList collection to the variable i1, but also happens inside the foreach statement where the variable i2 of type int is accessed:\r\n\r\nArrayList list = new ArrayList();\r\nlist.Add(44);   // boxing - convert a value type to a reference type\r\nint i1 = (int)list[0];   // unboxing - convert a reference type to a value type\r\nforeach (int i2 in list)\r\n{\r\n  Console.WriteLine(i2);   // unboxing\r\n}\r\n\r\nBoxing and unboxing is easy to use, but it has a big performance impact, especially when iterating through many items.\r\n\r\nInstead of using objects, the List&lt;T&gt; class from the namespace System.Collections.Generic allows you to define the type when it is used. In the example here, the generic type of the List&lt;T&gt; class is defined as int, and so the int type is used inside the class that is generated dynamically from the JIT compiler. Boxing and unboxing no longer happens:\r\n\r\nList&lt;int&gt; list = new List&lt;int&gt;();\r\nlist.Add(44);   // no boxing - value types are stored in the List&lt;int&gt;\r\nint i1 = list[0];   // no unboxing, no cast needed\r\nforeach (int i2 in list)\r\n{\r\n  Console.WriteLine(i2);\r\n}\r\n\r\n\r\n==================\r\nType Safety\r\n==================\r\n\r\nAnother feature of generics is type safety. As with the ArrayList class, if objects are used, any type can be added to this collection. This example shows adding an integer, a string, and an object of type MyClass to the collection of type ArrayList:\r\n\r\nArrayList list = new ArrayList();\r\nlist.Add(44);\r\nlist.Add(&quot;mystring&quot;);\r\nlist.Add(new MyClass());\r\n\r\nNow if this collection is iterated using the following foreach statement which iterates using integer elements, the compiler accepts this code. However, because not all elements in the collection can be cast to an int, a runtime exception will occur:\r\n\r\nforeach (int i in list)\r\n{\r\n  Console.WriteLine(i);\r\n}\r\n\r\nErrors should be detected as early as possible. With the generic class List&lt;T&gt;, the generic type T defines what types are allowed. With a definition of List&lt;int&gt;, only integer types can be added to the collection. The compiler doesn't compile this code because the Add() method has invalid arguments:\r\n\r\nList&lt;int&gt; list = new List&lt;int&gt;();\r\nlist.Add(44);\r\nlist.Add(&quot;mystring&quot;);   // compile time error\r\nlist.Add(new MyClass());   // compile time error\r\n\r\n\r\n==================\r\nBinary Code Reuse\r\n==================\r\n\r\nGenerics allow better binary code reuse. A generic class can be defined once and can be instantiated with many different types.\r\n\r\nAs an example, here the List&lt;T&gt; class from the namespace System.Collections.Generic in the assembly mscorlib is instantiated with an int, a string, and a MyClass type:\r\n\r\nList&lt;int&gt; list = new List&lt;int&gt;();\r\nlist.Add(44);\r\n\r\nList&lt;string&gt; stringList = new List&lt;string&gt;();\r\nstringList.Add(&quot;mystring&quot;);\r\n\r\nList&lt;MyClass&gt; myclassList = new List&lt;MyClass&gt;();\r\nmyClassList.Add(new MyClass());\r\n\r\nGeneric types can be defined in one language and used from any other .NET language.\r\n\r\n\r\n==================\r\nCode Bloat\r\n==================\r\n\r\nHow much code is created with generics when instantiating them with different specific types?  Because a generic class definition goes into the assembly, instantiating generic classes with specific types doesn't duplicate these classes in the IL code. However, when the generic classes are compiled by the JIT compiler to native code, a new class for every specific value type is created. Reference types share all the same implementation of the same native class. This is because with reference types only a 4-byte memory address (with 32-bit systems) is needed within the generic instantiated class to reference a reference type. Value types are contained within the memory of the generic instantiated class, and because every value type can have different memory requirements, a new class for every value type is instantiated.\r\n\r\n\r\n==================\r\nNaming Guidelines\r\n==================\r\n\r\nIf generics are used in the program, it helps when generic types can be distinguished from non-generic types. Here are naming guidelines for generic types:\r\n\r\n(1) Generic type names should be prefixed with the letter T.\r\n\r\n(2) If the generic type can be replaced by any class because there's no special requirement, and only one generic type is used, the character T is good as a generic type name:\r\n  public class List&lt;T&gt; { }\r\n  public class LinkedList&lt;T&gt; { }\r\n\r\n(3) If there's a special requirement for a generic type (for example, it must implement an interface or derive from a base class), or if two or more generic types are used, descriptive names should be used for the type names:\r\n  public delegate void EventHandler&lt;TEventArgs&gt; (object sender, TEventArgs e);\r\n  public delegate TOutput Converter&lt;TInput, TOutput&gt;(TInput from);\r\n  public class SortedList&lt;TKey, TValue&gt; { }\r\n\r\n\r\n==================\r\nGeneric Collections Overview\r\n==================\r\n\r\nBefore taking a closer look at how to use the collection classes, this section gives you an overview of which generic collection classes and interfaces are available.\r\n\r\nThe major interfaces and their functionality are defined in the following table.\r\n\r\nICollection&lt;T&gt;:  The interface ICollection&lt;T&gt; is implemented by collection classes. Methods of this interface can be used to add and remove elements from the collection. The generic interface ICollection&lt;T&gt; inherits from the non-generic interface IEnumerable. With this it is possible to pass objects implementing ICollection&lt;T&gt; to methods that require IEnumerable objects as parameters.\r\n\r\nIList&lt;T&gt;:  The interface IList&lt;T&gt; allows you to access a collection using an indexer. It is also possible to insert or remove elements at any position of the collection. Similar to ICollection&lt;T&gt;, the interface IList&lt;T&gt; inherits from IEnumerable.\r\n\r\nIEnumerable&lt;T&gt;:  The interface IEnumerable&lt;T&gt; is required if a foreach statement is used with the collection. This interface defines the method GetEnumerator() that returns an enumerator implementing IEnumerator&lt;T&gt;. The generic interface IEnumerable&lt;T&gt; inherits from the non-generic interface IEnumerable.\r\n\r\nIEnumerator&lt;T&gt;:  The foreach statement uses an enumerator implementing IEnumerator&lt;T&gt; for accessing all elements in a collection. The interface IEnumerator&lt;T&gt; inherits from the non-generic interfaces IEnumerator and IDisposable. The interface IEnumerator defines the methods MoveNext() and Reset(), IEnumerator&lt;T&gt; defines the type-safe version of the property Current.\r\n\r\nIDictionary&lt;TKey, TValue&gt;:  The interface IDictionary&lt;K, V&gt; is implemented by collections whose elements have a key and a value.\r\n\r\nIComparer&lt;T&gt;:  The interface IComparer&lt;T&gt; is used to sort elements inside a collection with the Compare() method.\r\n\r\nIEqualityComparer&lt;T&gt;:  IEqualityComparer&lt;T&gt; is the second interface to compare objects. With this interface the objects can be compared for equality. The method GetHashCode() should return a unique value for every object. The method Equals() returns true if the objects are equal, false otherwise.\r\n\r\nThe generic collection classes and their functionality are shown in the following table.\r\n\r\nList&lt;T&gt;:  The List&lt;T&gt; class is the generic replacement for the ArrayList class. Similarly to the ArrayList class, the List&lt;T&gt; class can grow and shrink dynamically. Besides the implementation of the three implemented interfaces, this class also supports additional functionality like sorting and reversing the elements in the collection.\r\n\r\nDictionary&lt;TKey, TValue&gt;:  Dictionary&lt;TKey, TValue&gt; is a collection class that stores key and value pairs.\r\n\r\nSortedList&lt;TKey, TValue&gt;:  SortedList&lt;TKey, TValue&gt; is similar to Dictionary&lt;TKey, TValue&gt; with the difference that this collection is sorted by the key.\r\n\r\nLinkedList&lt;T&gt;:  LinkedList&lt;T&gt; is a double-linked list. With a double-linked list one element references the next and the previous.\r\n\r\nQueue&lt;T&gt;:  Queue&lt;T&gt; is a collection with first-in, first-out behavior. The element that was added first will be read first from the queue. This is similar to a print-queue where the oldest print jobs are processed first. The method Enque() adds an object to the end of the queue; the method Deque() returns and removes an object from the beginning of the queue. With the method Peek() it is possible to read the first object from the queue without removing it.\r\n\r\nStack&lt;T&gt;:  Stack&lt;T&gt; is a collection with first-in, last-out behavior. The element that was added last will be read first from the stack. The Stack&lt;T&gt; offers the methods Push() and Pop(). With Push() an object is added to the end of the stack, while Pop() reads and removes the object from the end of the stack. The method Peek() reads the last object from the stack without removing it.\r\n\r\nThe .NET Framework offers some generic collection base classes that can be used to create a custom generic collection class. The classes in the following table are found in the namespace System.Collections.ObjectModel.\r\n\r\nCollection&lt;T&gt;:  The class Collection&lt;T&gt; can be used as a base class for a custom generic collection class. It implements the interfaces IList&lt;T&gt;, ICollection&lt;T&gt;, and IEnumerable&lt;T&gt;. Behind the scenes, this class makes use of the List&lt;T&gt; class. However, it doesn't offer all the methods that List&lt;T&gt; does. So with a custom generic collection class you can offer the methods that are appropriate for the use case. With a custom collection class you can access the underlying List&lt;T&gt; object with the protected property Items.\r\n\r\nReadOnlyCollection&lt;T&gt;:  ReadOnlyCollection&lt;T&gt; is a read-only version of the class Collection&lt;T&gt;. All the methods from the interfaces that allow adding and removing elements are explicitly implemented and throw a NotSupportedException. An object of this class can be created by passing any collection that implements the IList&lt;T&gt; interface to the constructor.\r\n\r\nKeyedCollection&lt;TKey, TItem&gt;:  KeyedCollection&lt;TKey, TItem&gt; is an abstract base class that can be used for custom collection classes that have a key and a value. This class inherits from Collection&lt;TItem&gt;.\r\n\r\n\r\n==================\r\nUsing the List&lt;T&gt; Class\r\n==================\r\n\r\nThe class List&lt;T&gt; in the namespace System.Collections.Generic is a very similar in its usage to the ArrayList class from the namespace System.Collections. This class implements the IList, ICollection, and IEnumerable interfaces.\r\n\r\nThe following example uses the class Racer as elements to be added to the collection to represent a Formula-1 racer. This class has two fields, a name and a car, that can be accessed with properties. With the constructor of the class the name of the racer and the car can be passed to set the members. The method ToString() is overridden to return the name of the racer and the car:\r\n\r\npublic class Racer\r\n{\r\n\r\n  private string name;\r\n  private string car;\r\n\r\n  public string Name\r\n  {\r\n    get\r\n    {\r\n      return name;\r\n    }\r\n  }\r\n  \r\n  public string Car\r\n  {\r\n    get\r\n    {\r\n      return car;\r\n    }\r\n  }\r\n  \r\n  public Racer(string name, string car)\r\n  {\r\n    this.name = name;\r\n    this.car = car;\r\n  }\r\n  \r\n  public override string ToString()\r\n  {\r\n    return name + &quot;, &quot; + car;\r\n  }\r\n}\r\n\r\nThe variable racers is defined to be of type List&lt;Racer&gt;. With the new operator a new object of the same type is created. Here the default constructor of the List&lt;T&gt; class is used. This class also has a constructor to reserve memory for a specific number of items, and a constructor to copy elements from another collection of type List&lt;T&gt;.\r\n\r\nBecause the class List&lt;T&gt; was instantiated with the concrete class Racer, now only Racer objects can be added with the Add() method. With the class List&lt;T&gt;, the Add() method is defined as void Add(T item). In the following sample code five Formula-1 racers are created and added to the collection. Then, using the foreach statement, every team in the collection is iterated to be displayed on the console:\r\n\r\nList&lt;Racer&gt; racers = new List&lt;Racer&gt;();\r\nracers.Add(new Racer(&quot;Michael Schumacher&quot;, &quot;Ferrari&quot;));\r\nracers.Add(new Racer(&quot;Juan Pablo Montoya&quot;, &quot;McLaren-Mercedes&quot;));\r\nracers.Add(new Racer(&quot;Kimi Raikkonen&quot;, &quot;McLaren-Mercedes&quot;));\r\nracers.Add(new Racer(&quot;Mark Webber&quot;, &quot;Williams-BMW&quot;));\r\nracers.Add(new Racer(&quot;Rubens Barichello&quot;, &quot;Ferrari&quot;));\r\n\r\nforeach (Racer r in racers)\r\n{\r\n  Console.WriteLine(r);\r\n}\r\n\r\nWith the List&lt;T&gt; class, not only can you add items and access them by using an enumerator; this class also has methods to insert and remove elements, clear the collection, and copy the elements to an array. Even more powerful functionality is discussed next. List&lt;T&gt; offers methods to search and to convert elements, reverse the order, and so on.\r\n\r\n==================\r\nFinding elements\r\n==================\r\nIn this section, you search for all racers in the collection that drive a Ferrari.\r\n\r\nThe List&lt;T&gt; class offers Find() and FindAll() methods with these declarations:\r\n\r\npublic T Find(Predicate&lt;T&gt; match);\r\npublic List&lt;T&gt; FindAll(Predicate&lt;T&gt; match);\r\n\r\nBoth methods require a Predicate&lt;T&gt; as an argument. Predicate&lt;T&gt; is a delegate that references a predicate method. A predicate is a method that returns a Boolean value. If the predicate returns true, there's a match and the element is found. If it returns false, the element is not added to the result of the search. With the definition of Predicate&lt;T&gt;, the predicate must have a single argument of type T. The Find() method returns the first element with a predicate match, and the FindAll() method returns all elements with a predicate match in a list collection.\r\n\r\nSo you have to define a predicate. You use the predicate method DrivingCarPredicate() for finding a racer with a specific car. This method is defined in the class FindRacer, which can be initialized with the car to search. DrivingCarPredicate() receives a Racer object and compares the car of the Racer object with the car that is set in the constructor to return true or false accordingly:\r\n\r\npublic class FindRacer\r\n{\r\n  private string car;\r\n  public FindRacer(string car)\r\n  {\r\n    this.car = car;\r\n  }\r\n\r\n  public bool DrivingCarPredicate(Racer racer)\r\n  {\r\n    return racer.Car == car;\r\n  }\r\n}\r\n\r\nTo find the specific racers, the FindRacer class is initiated and initialized with a Ferrari, because you want to find all Ferrari racers. With the FindAll() method of the List&lt;T&gt; class, a new predicate delegate is instantiated, and this predicate delegate receives the finder.DrivingCarPredicate method. FindAll() returns a list of type List&lt;Racer&gt; that is used with the foreach to iterate all returned racers to display them on the console:\r\n\r\nFindRacer finder = new FindRacer(&quot;Ferrari&quot;);\r\n\r\nforeach (Racer racer in\r\n       racers.FindAll(new Predicate&lt;Racer&gt;(finder.DrivingCarPredicate)))\r\n{\r\n  Console.WriteLine(racer);\r\n}\r\n\r\nAs a result, Michael Schumacher and Rubens Barichello are displayed on the console.","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Generics"]},{"RecordId":"839","Title":"XML Basics in SQL Server 2005","Description":"Demonstrates how to query XML data in SQL Server 2005","Code":"/* \r\ntblMyTable layout is as follows:\r\n\tRecordID int IDENTITY(1,1) NOT NULL,\r\n\tTextValue nchar(50) NOT NULL,\r\n\tIntValue int NOT NULL,\r\n\tDateTimeValue datetime NOT NULL DEFAULT (getdate()),\r\n\tXMLValue xml NOT NULL\r\n*/\r\n\r\ninsert into tblmytable (TextValue, IntValue, XMLValue) \r\nvalues ('a', 1, '&lt;option val=&quot;a&quot; checked=&quot;no&quot; /&gt;')\r\n\r\ninsert into tblmytable (TextValue, IntValue, XMLValue) \r\nvalues ('b', 2, '&lt;option val=&quot;a&quot; checked=&quot;yes&quot; /&gt;')\r\n\r\ninsert into tblmytable (TextValue, IntValue, XMLValue) \r\nvalues ('c', 3, '&lt;option val=&quot;b&quot; checked=&quot;no&quot; /&gt;')\r\n\r\ninsert into tblmytable (TextValue, IntValue, XMLValue) \r\nvalues ('d', 4, '&lt;option val=&quot;b&quot; checked=&quot;yes&quot; /&gt;')\r\n\r\ninsert into tblmytable (TextValue, IntValue, XMLValue) \r\nvalues ('e', 5, '&lt;options&gt;&lt;option val=&quot;a&quot; checked=&quot;no&quot; /&gt;&lt;option val=&quot;b&quot; checked=&quot;yes&quot; /&gt;&lt;/options&gt;')\r\n\r\nSELECT RecordID, TextValue, XMLValue.query('//option') as XMLData FROM tblmytable \r\n\r\nSELECT RecordID, TextValue, XMLValue.query('//option[@val=&quot;a&quot;]') as XMLData FROM tblmytable \r\n\r\nSELECT RecordID, TextValue, XMLValue.value('(//option)[1]', 'nchar(100)') as XMLData FROM tblmytable \r\n\r\nSELECT RecordID, TextValue, XMLValue.value('(//@val)[1]', 'nchar(100)') as XMLData FROM tblmytable \r\n\r\nSELECT RecordID, TextValue, XMLValue.value('(//option/@val)[1]', 'nchar(100)') as XMLData FROM tblmytable \r\n\r\nSELECT RecordID, TextValue, XMLValue.value('(//option/@val)[1]', 'nchar(100)') as Val, XMLValue.value('(//option/@checked)[1]', 'nchar(100)') as Checked FROM tblmytable \r\n\r\nSELECT RecordID, TextValue, XMLValue.value('(//option/@val)[2]', 'nchar(100)') as Val, XMLValue.value('(//option/@checked)[2]', 'nchar(100)') as Checked FROM tblmytable \r\n","Declares":"","CodeCategory":{"CategoryId":"6","CategoryDescription":"T-SQL"},"Keywords":["XML"]},{"RecordId":"840","Title":"Getting the Current Time in UTC","Description":"Getting the Current Time in UTC\r\n","Code":"Both the .NET Framework and Microsoft SQL Server provide functions to return the current time in UTC. \r\n\r\nIn the .NET Framework, use the DateTime.UtcNow property:\r\nDateTime currentTime = DateTime.UtcNow;  \r\n\r\nFor SQL Server, use the getutcdate() function:\r\nDECLARE @currentTime datetime\r\nSET @currentTime = GETUTCDATE()  \r\n\r\nConverting from UTC Time to Server Time - Given a time in UTC, the .NET Framework makes it easy to convert it to server time. Just use the DateTime class's ToLocalTime() method as follows:\r\n\r\nDateTime currentServerTime = DateTime.UtcNow.ToLocalTime();\r\ncurrentServerTime = ((DateTime) Eval(&quot;DateCreated&quot;)).ToLocalTime()  \r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["UTC"]},{"RecordId":"841","Title":"Programmatically Register ActiveX Libraries","Description":"Demonstrates how to programmatically register ActiveX DLLs, OCXs, etc. using C#.","Code":"using System;\r\nusing System.Runtime.InteropServices;\r\n\r\nnamespace Omnicell.Tools.SystemRestore\r\n{\r\n    class RegCOMServer\r\n    {\r\n\r\n        [DllImport(\"kernel32.dll\")]\r\n        static extern bool FreeLibrary(IntPtr hModule);\r\n\r\n        [DllImport(\"kernel32.dll\")]\r\n        static extern IntPtr LoadLibrary(string lpFilename);\r\n\r\n        [DllImport(\"kernel32.dll\")]\r\n        static extern UIntPtr GetProcAddress(IntPtr hModule, string lpProcName);\r\n\r\n        [DllImport(\"user32.dll\")]\r\n        static extern IntPtr CallWindowProc(UIntPtr lpPrevWndFunc, IntPtr hWnd, uint Msg, UIntPtr wParam, IntPtr lParam);\r\n\r\n        public static bool RegisterActiveX(string AXPath)\r\n        {\r\n            return (RegAX(AXPath, true));\r\n        }\r\n\r\n        public static bool UnRegisterActiveX(string AXPath)\r\n        {\r\n            return (RegAX(AXPath, false));\r\n        }\r\n\r\n        private static bool RegAX(string AXPath, bool Register)\r\n        {\r\n            IntPtr lb = IntPtr.Zero;\r\n            UIntPtr pa;\r\n\r\n            try\r\n            {\r\n                lb = LoadLibrary(AXPath);\r\n                if (lb == IntPtr.Zero)\r\n                    return (false);\r\n\r\n                if (Register)\r\n                {\r\n                    pa = GetProcAddress(lb, \"DllRegisterServer\");\r\n                    if (pa == UIntPtr.Zero)\r\n                        return (false);\r\n                }\r\n                else\r\n                    pa = GetProcAddress(lb, \"DllUnregisterServer\");\r\n\r\n                if (CallWindowProc(pa, IntPtr.Zero, 0, UIntPtr.Zero, IntPtr.Zero) == IntPtr.Zero)\r\n                {\r\n                    return (true);\r\n                }\r\n                else\r\n                {\r\n                    return (false);\r\n                }\r\n            }\r\n            catch (Exception e)\r\n            {\r\n                throw (e);\r\n            }\r\n            finally\r\n            {\r\n                FreeLibrary(lb);\r\n            }\r\n        }\r\n\r\n    }\r\n}\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["ActiveX","Register DLL","RegSvr32"]},{"RecordId":"842","Title":"Serialize and Deserialize an Object With Xml","Description":"Shows a very simple means of serializing and deserializing an object with Xml","Code":"// ----------------------------------------------------\r\n// This is the class that will be serialized and deserialized \r\n// ----------------------------------------------------\r\n\r\n[Serializable]\r\npublic class Foo\r\n{\r\n    private int _id = 0;\r\n    private string _name = string.Empty;\r\n\r\n    [XmlAttribute]\r\n    public string Name\r\n    {\r\n        get { return _name; }\r\n        set { _name = value; }\r\n    }\r\n\r\n    [XmlAttribute]\r\n    public int Id\r\n    {\r\n        get { return _id;}\r\n        set { _id = value;}\r\n    }\r\n\r\n\r\n}\r\n\r\n// ----------------------------------------------------\r\n// Serialize a Foo object\r\n// ----------------------------------------------------\r\n\r\nStringWriter sw = new StringWriter();\r\nXmlSerializer xmls = new XmlSerializer(typeof(Foo));\r\nFoo f = new Foo();\r\nf.Id = 69;\r\nf.Name = \"My foo class\";\r\nxmls.Serialize(sw, f);\r\nstring ssXML = sw.ToString();\r\n\r\n// ----------------------------------------------------\r\n// Deserialize a Foo object\r\n// ----------------------------------------------------\r\n\r\nStringReader sr = new StringReader(ssXML);\r\nFoo f2 = null;\r\nf2 = (Foo)xmls.Deserialize(sr);\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Serialize"]},{"RecordId":"843","Title":"MSMQ - Putting Objects On and Off of an MSMQ","Description":"Demonstrates how to put objects on an MSMQ and the retrieve them back into a rehydrated object.","Code":"//-----------------------------------------------\r\n// The object that will be serialized/deserialized and put on/off the MSMQ\r\n//-----------------------------------------------\r\n\r\n[Serializable]\r\npublic class Foo\r\n{\r\n    private int _id = 0;\r\n    private string _name = string.Empty;\r\n\r\n    [XmlAttribute]\r\n    public string Name\r\n    {\r\n        get { return _name; }\r\n        set { _name = value; }\r\n    }\r\n\r\n    [XmlAttribute]\r\n    public int Id\r\n    {\r\n        get { return _id;}\r\n        set { _id = value;}\r\n    }\r\n\r\n\r\n//-----------------------------------------------\r\n// Create an object an put it on the queue\r\n//-----------------------------------------------\r\n\r\nMessageQueue msgQ = new MessageQueue(@&quot;.\\private$\\myQueue&quot;);\r\nmsgQ.DefaultPropertiesToSend.Recoverable = true;\r\n\r\nFoo f = new Foo();\r\nf.Id = 69;\r\nf.Name = &quot;My foo class&quot;;\r\n\r\nmsgQ.Send(f);\r\nmsgQ.Close();\r\n\r\n\r\n\r\n//-----------------------------------------------\r\n// Get the message off of the queue and de-serialize back into an object\r\n//-----------------------------------------------\r\n\r\nMessageQueue msgQ = new MessageQueue(@\".\\private$\\Ted_MSMQ_1\");\r\nSystem.Messaging.Message msg = msgQ.Receive();\r\nmsg.Formatter = new XmlMessageFormatter(new Type[] { typeof(Foo)});\r\nFoo f = (Foo) msg.Body;\r\n\r\nMessageBox.Show(\"Foo.Id: \" + f.Id.ToString() + Environment.NewLine + \"Foo.Name: \" + f.Name);\r\n\r\nmsgQ.Close();\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["MSMQ"]},{"RecordId":"844","Title":"MSMQ - Simple Example","Description":"Very simple example of MSMQ","Code":"//-----------------------------------------------\r\n// Create a string on the queue\r\n//-----------------------------------------------\r\n\r\nMessageQueue msgQ = new MessageQueue(@\".\\private$\\myQueue\");\r\nmsgQ.DefaultPropertiesToSend.Recoverable=true;\r\n\r\nSystem.Messaging.Message recoverableMessage = new System.Messaging.Message();\r\nrecoverableMessage.Recoverable = true;\r\nstring strMessageText = \"Elvis rules!!!\";\r\nrecoverableMessage.Body = strMessageText;\r\n\r\nmsgQ.Send(recoverableMessage);\r\nmsgQ.Close();\r\n\r\n//-----------------------------------------------\r\n// Get the message off of the queue\r\n//-----------------------------------------------\r\n\r\n\r\nMessageQueue msgQ = new MessageQueue(@\".\\private$\\myQueue\");\r\n\r\nSystem.Messaging.Message recoverableMessage = msgQ.Receive();\r\nrecoverableMessage.Formatter = new XmlMessageFormatter(new string[] {\"System.String\"});\r\n\r\nstring strMessageBody = recoverableMessage.Body.ToString();\r\nMessageBox.Show(recoverableMessage.Body.ToString());\r\n\r\nmsgQ.Close();\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["MSMQ"]},{"RecordId":"845","Title":"Wizard Using Panels","Description":"Demonstrates how to create a wizard using a single winform which contains multiple panels.  Handles Next, Previous, Cancel, Finish.  Great framework.","Code":"using System;\r\nusing System.Drawing;\r\nusing System.Collections;\r\nusing System.ComponentModel;\r\nusing System.Windows.Forms;\r\n\r\nnamespace wizard\r\n{\r\n    /// <summary>\r\n    /// Summary description for MDXQueryBuilderWizard.\r\n    /// </summary>\r\n    public class PanelWizard : System.Windows.Forms.Form\r\n    {\r\n        private System.Windows.Forms.Label label1;\r\n        private System.Windows.Forms.Label label2;\r\n        private System.Windows.Forms.Label label3;\r\n        private System.Windows.Forms.Label label4;\r\n        private System.Windows.Forms.Button btnCancel;\r\n        private System.Windows.Forms.Button btnback;\r\n        private System.Windows.Forms.Button btnNext;\r\n        private System.Windows.Forms.Button btnFinish;\r\n\r\n        //---enabling and disabling the buttons\r\n        private bool cancelEnabled;\r\n        private bool backEnabled;\r\n        private bool nextEnabled;\r\n        private bool finishEnabled;\r\n        //--------\r\n        //--set the next and back panel\r\n        private Panel nextPanel;\r\n        private Panel backPanel;\r\n        private Panel presentPanel;\r\n        //\r\n        private Panel[] arrayPanel;\r\n        private System.Windows.Forms.Panel panel1;\r\n        private System.Windows.Forms.Panel panel2;\r\n        private System.Windows.Forms.Panel panel3;\r\n        private System.Windows.Forms.Panel panel4;\r\n        private System.Windows.Forms.Label label5;\r\n        //\r\n\r\n        /// <summary>\r\n        /// Required designer variable.\r\n        /// </summary>\r\n        private System.ComponentModel.Container components = null;\r\n\r\n        public PanelWizard()\r\n        {\r\n\r\n            InitializeComponent();\r\n\r\n            arrayPanel=new Panel[]{panel1,panel2,panel3,panel4};\r\n        }\r\n\r\n        /// <summary>\r\n        /// Clean up any resources being used.\r\n        /// </summary>\r\n        protected override void Dispose( bool disposing )\r\n        {\r\n            if( disposing )\r\n            {\r\n                if(components != null)\r\n                {\r\n                    components.Dispose();\r\n                }\r\n            }\r\n            base.Dispose( disposing );\r\n        }\r\n\r\n        #region Windows Form Designer generated code\r\n        /// <summary>\r\n        /// Required method for Designer support - do not modify\r\n        /// the contents of this method with the code editor.\r\n        /// </summary>\r\n        private void InitializeComponent()\r\n        {\r\n            this.panel1 = new System.Windows.Forms.Panel();\r\n            this.label1 = new System.Windows.Forms.Label();\r\n            this.panel2 = new System.Windows.Forms.Panel();\r\n            this.label2 = new System.Windows.Forms.Label();\r\n            this.panel3 = new System.Windows.Forms.Panel();\r\n            this.label3 = new System.Windows.Forms.Label();\r\n            this.panel4 = new System.Windows.Forms.Panel();\r\n            this.label4 = new System.Windows.Forms.Label();\r\n            this.btnCancel = new System.Windows.Forms.Button();\r\n            this.btnback = new System.Windows.Forms.Button();\r\n            this.btnNext = new System.Windows.Forms.Button();\r\n            this.btnFinish = new System.Windows.Forms.Button();\r\n            this.label5 = new System.Windows.Forms.Label();\r\n            this.panel1.SuspendLayout();\r\n            this.panel2.SuspendLayout();\r\n            this.panel3.SuspendLayout();\r\n            this.panel4.SuspendLayout();\r\n            this.SuspendLayout();\r\n            //\r\n            // panel1\r\n            //\r\n            this.panel1.BorderStyle = System.Windows.Forms.BorderStyle.FixedSingle;\r\n            this.panel1.Controls.AddRange(new System.Windows.Forms.Control[] {\r\n                                                                                 this.label1});\r\n            this.panel1.Location = new System.Drawing.Point(80, 128);\r\n            this.panel1.Name = \"panel1\";\r\n            this.panel1.Size = new System.Drawing.Size(448, 296);\r\n            this.panel1.TabIndex = 0;\r\n            //\r\n            // label1\r\n            //\r\n            this.label1.Name = \"label1\";\r\n            this.label1.TabIndex = 0;\r\n            this.label1.Text = \"Panel 1(First)\";\r\n            this.label1.TextAlign = System.Drawing.ContentAlignment.MiddleCenter;\r\n            //\r\n            // panel2\r\n            //\r\n            this.panel2.BorderStyle = System.Windows.Forms.BorderStyle.FixedSingle;\r\n            this.panel2.Controls.AddRange(new System.Windows.Forms.Control[] {\r\n                                                                                 this.label2});\r\n            this.panel2.Location = new System.Drawing.Point(136, 112);\r\n            this.panel2.Name = \"panel2\";\r\n            this.panel2.Size = new System.Drawing.Size(448, 296);\r\n            this.panel2.TabIndex = 1;\r\n            //\r\n            // label2\r\n            //\r\n            this.label2.Name = \"label2\";\r\n            this.label2.TabIndex = 0;\r\n            this.label2.Text = \"Panel 2\";\r\n            this.label2.TextAlign = System.Drawing.ContentAlignment.MiddleCenter;\r\n            //\r\n            // panel3\r\n            //\r\n            this.panel3.BorderStyle = System.Windows.Forms.BorderStyle.FixedSingle;\r\n            this.panel3.Controls.AddRange(new System.Windows.Forms.Control[] {\r\n                                                                                 this.label3});\r\n            this.panel3.Location = new System.Drawing.Point(224, 112);\r\n            this.panel3.Name = \"panel3\";\r\n            this.panel3.Size = new System.Drawing.Size(448, 296);\r\n            this.panel3.TabIndex = 2;\r\n            //\r\n            // label3\r\n            //\r\n            this.label3.Name = \"label3\";\r\n            this.label3.TabIndex = 0;\r\n            this.label3.Text = \"Panel 3\";\r\n            this.label3.TextAlign = System.Drawing.ContentAlignment.MiddleCenter;\r\n            //\r\n            // panel4\r\n            //\r\n            this.panel4.BorderStyle = System.Windows.Forms.BorderStyle.FixedSingle;\r\n            this.panel4.Controls.AddRange(new System.Windows.Forms.Control[] {\r\n                                                                                 this.label4});\r\n            this.panel4.Location = new System.Drawing.Point(320, 112);\r\n            this.panel4.Name = \"panel4\";\r\n            this.panel4.Size = new System.Drawing.Size(448, 296);\r\n            this.panel4.TabIndex = 3;\r\n            //\r\n            // label4\r\n            //\r\n            this.label4.Name = \"label4\";\r\n            this.label4.TabIndex = 0;\r\n            this.label4.Text = \"Panel 4(last)\";\r\n            this.label4.TextAlign = System.Drawing.ContentAlignment.MiddleCenter;\r\n            //\r\n            // btnCancel\r\n            //\r\n            this.btnCancel.Location = new System.Drawing.Point(120, 456);\r\n            this.btnCancel.Name = \"btnCancel\";\r\n            this.btnCancel.TabIndex = 4;\r\n            this.btnCancel.Text = \"Cancel\";\r\n            this.btnCancel.Click += new System.EventHandler(this.btnCancel_Click);\r\n            //\r\n            // btnback\r\n            //\r\n            this.btnback.Location = new System.Drawing.Point(248, 456);\r\n            this.btnback.Name = \"btnback\";\r\n            this.btnback.TabIndex = 5;\r\n            this.btnback.Text = \"< Back\";\r\n            this.btnback.Click += new System.EventHandler(this.btnback_Click);\r\n            //\r\n            // btnNext\r\n            //\r\n            this.btnNext.Location = new System.Drawing.Point(376, 456);\r\n            this.btnNext.Name = \"btnNext\";\r\n            this.btnNext.TabIndex = 6;\r\n            this.btnNext.Text = \"Next >\";\r\n            this.btnNext.Click += new System.EventHandler(this.btnNext_Click);\r\n            //\r\n            // btnFinish\r\n            //\r\n            this.btnFinish.Location = new System.Drawing.Point(504, 456);\r\n            this.btnFinish.Name = \"btnFinish\";\r\n            this.btnFinish.TabIndex = 7;\r\n            this.btnFinish.Text = \"Finish\";\r\n            //\r\n            // label5\r\n            //\r\n            this.label5.Location = new System.Drawing.Point(168, 64);\r\n            this.label5.Name = \"label5\";\r\n            this.label5.Size = new System.Drawing.Size(296, 23);\r\n            this.label5.TabIndex = 8;\r\n            this.label5.Text = \"Wizard using Panels\";\r\n            //\r\n            // PanelWizard\r\n            //\r\n            this.AutoScaleBaseSize = new System.Drawing.Size(5, 13);\r\n            this.ClientSize = new System.Drawing.Size(680, 541);\r\n            this.Controls.AddRange(new System.Windows.Forms.Control[] {\r\n                                                                          this.label5,\r\n                                                                          this.panel1,\r\n                                                                          this.btnFinish,\r\n                                                                          this.btnNext,\r\n                                                                          this.btnback,\r\n                                                                          this.btnCancel,\r\n                                                                          this.panel4,\r\n                                                                          this.panel3,\r\n                                                                          this.panel2});\r\n            this.Name = \"PanelWizard\";\r\n            this.Text = \"MDXQueryBuilderWizard\";\r\n            this.Load += new System.EventHandler(this.MDXQueryBuilderWizard_Load);\r\n            this.panel1.ResumeLayout(false);\r\n            this.panel2.ResumeLayout(false);\r\n            this.panel3.ResumeLayout(false);\r\n            this.panel4.ResumeLayout(false);\r\n            this.ResumeLayout(false);\r\n\r\n        }\r\n        #endregion\r\n\r\n        private void MDXQueryBuilderWizard_Load(object sender, System.EventArgs e)\r\n        {\r\n\r\n            foreach(Control ct in this.Controls)\r\n            {\r\n                if(ct.GetType().Name==\"Panel\")\r\n                {\r\n                    ct.Left=136;\r\n                    ct.Top=88;\r\n                    ct.Visible=false;\r\n                }\r\n\r\n            }\r\n            presentPanel=arrayPanel[0];\r\n            //--set the properties\r\n            setBtnPanProperty(getPosition(presentPanel));\r\n            //------\r\n            refreshLook();\r\n        }\r\n\r\n        //-set the buttons and panel\r\n        private void refreshLook()\r\n        {\r\n            if(cancelEnabled)\r\n                btnCancel.Enabled=true;\r\n            else\r\n                btnCancel.Enabled=false;\r\n\r\n            if(backEnabled)\r\n                 btnback.Enabled=true;\r\n            else\r\n                btnback.Enabled=false;\r\n\r\n            if(nextEnabled)\r\n                btnNext.Enabled=true;\r\n            else\r\n                btnNext.Enabled=false;\r\n\r\n            if(finishEnabled)\r\n                btnFinish.Enabled=true;\r\n            else\r\n                btnFinish.Enabled=false;\r\n\r\n            if(presentPanel!=null)\r\n            {\r\n                presentPanel.Show();\r\n                presentPanel.BringToFront();\r\n            }\r\n        }\r\n        //--------\r\n        private int getPosition(Panel p)\r\n        {\r\n            int result=-1;\r\n            for(int i=0;i<arrayPanel.Length;i++)\r\n            {\r\n                if(arrayPanel[i]==p)\r\n                {\r\n                    result=i;\r\n                    break;\r\n                }\r\n            }\r\n            return result ;\r\n        }\r\n        //----\r\n\r\n        private void setBtnPanProperty(int presentPanelPosition )\r\n        {\r\n            int panelLength=arrayPanel.Length-1;\r\n            if(presentPanelPosition==0)\r\n            {\r\n                //first panel...no back ,no finish\r\n                cancelEnabled=true;\r\n                backEnabled=false;\r\n                nextEnabled=true;\r\n                finishEnabled=false;\r\n                presentPanel=arrayPanel[presentPanelPosition];\r\n                nextPanel=arrayPanel[presentPanelPosition+1];\r\n                backPanel=null;\r\n\r\n            }\r\n            else if(presentPanelPosition==panelLength)\r\n            {\r\n                //last panel...no next,finish\r\n                cancelEnabled=true;\r\n                backEnabled=true;\r\n                nextEnabled=false;\r\n                finishEnabled=true;\r\n                presentPanel=arrayPanel[presentPanelPosition];\r\n                nextPanel=null;\r\n                backPanel=arrayPanel[presentPanelPosition-1];\r\n            }\r\n            else\r\n            {\r\n                //no finish,next and back\r\n                cancelEnabled=true;\r\n                backEnabled=true;\r\n                nextEnabled=true;\r\n                finishEnabled=false;\r\n                presentPanel=arrayPanel[presentPanelPosition];\r\n                nextPanel=arrayPanel[presentPanelPosition+1];\r\n                backPanel=arrayPanel[presentPanelPosition-1];\r\n            }\r\n        }\r\n\r\n        private void btnNext_Click(object sender, System.EventArgs e)\r\n        {\r\n            presentPanel=arrayPanel[getPosition(presentPanel)+1];\r\n            setBtnPanProperty(getPosition(presentPanel));\r\n            refreshLook();\r\n        }\r\n\r\n        private void btnback_Click(object sender, System.EventArgs e)\r\n        {\r\n            presentPanel=arrayPanel[getPosition(presentPanel)-1];\r\n            setBtnPanProperty(getPosition(presentPanel));\r\n            refreshLook();\r\n        }\r\n        [STAThread]\r\n        static void Main()\r\n        {\r\n            Application.Run(new PanelWizard());\r\n        }\r\n\r\n        private void btnCancel_Click(object sender, System.EventArgs e)\r\n        {\r\n            this.Dispose(true);\r\n        }\r\n\r\n\r\n    }\r\n}\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Wizard"]},{"RecordId":"846","Title":"MSMQ Triggers","Description":"Explanation of how to build .Net assemblies to be consumed by MSMQ Triggers","Code":"//-----------------------------------------------------------\r\n// Creating a COM Capable .Net assembly\r\n//-----------------------------------------------------------\r\nThe .Net assembly must be COM capable.  To accomplish this, it must be strong named, and have the \"Register for COM interop\" checkbox checked on the Build Options.  \r\n\r\n\r\n//-----------------------------------------------------------\r\n// Deploying the .Net assembly\r\n//-----------------------------------------------------------\r\nTo deploy the .Net assembly, register it with regasm.  If you also want to deploy it to the GAC, use gacutil to install it into the GAC.  During your development and testing, you will be repeatedly re-building and re-deploying your .Net assembly.  You must stop the Message Queuing Triggers service before un-registering an existing assembly. Use the following commands:\r\n\r\nnet stop \"Message Queuing Triggers\"\r\ngacutil /u MSMQ_Handler\r\nregasm  \"C:\\somepath\\MSMQ_Handler.dll\" /unregister\r\n\r\nCompile and deploy\r\n\r\nregasm  \"C:\\somepath\\MSMQ_Handler.dll\" /codebase\r\ngacutil /i \"C:\\somepath\\MSMQ_Handler.dll\"\r\nnet start \"Message Queuing Triggers\"\r\n\r\n\r\n//-----------------------------------------------------------\r\n// Hooking up the .Net assembly as an MSMQ Trigger\r\n//-----------------------------------------------------------\r\n\r\nTo hook up the .Net assembly as an MSMQ trigger:\r\nCreate a Message Queue on the computer.  Next, create a MSMQ Rule.  On the Rule Action tab of the Rule dialog, check the \"Invoke COM component\" selection.  In the \"Component ProgID\" field, enter the value in assemble.class format.  So, for example, if your .Net assembly name is YourAssembly.dll and it contains a class named YourClass.  The ProdID is YourAssembly.YourClass.  Next, in the \"Method name\" field, enter the name of the method in YourClass that you want to call.  The method must be declared as \"public void\".  Your method will probably receive MSMQ parms passed into it.  Be sure to select those on the \"Paramters\" dialog.  The types and order on the dialog must match your method signature.\r\n\r\n\r\n//-----------------------------------------------------------\r\n// Sample .Net class\r\n//-----------------------------------------------------------\r\nusing System;\r\nusing System.Collections.Generic;\r\nusing System.Text;\r\nusing System.Messaging;\r\nusing System.Runtime.InteropServices;\r\nusing System.IO;\r\n\r\nnamespace MSMQ_Handler\r\n{\r\n    [ComVisible(true)]\r\n    [Guid(\"9CBA4D1A-1891-4637-AD4A-2DEF8C07E527\")]\r\n    public class MSMQTriggerHandler\r\n    {\r\n        [ComVisible(true)]\r\n        public void HandleMSMQEvent2()\r\n        {\r\n            try\r\n            {\r\n                string s = \"Tedz Test\";\r\n                StreamWriter oLogFile = new StreamWriter(\"MSMQ_Ted.log\", true);\r\n                oLogFile.WriteLine(System.DateTime.Now.ToString() + \"  \" + s);\r\n                oLogFile.Close();\r\n\r\n            }\r\n\r\n            // catch any exception to keep the MSMQ trigger service ok\r\n            catch (Exception)\r\n            { }\r\n        }\r\n\r\n        \r\n        [ComVisible(true)]\r\n        public void HandleMSMQEvent(object MsgBody, string MQPath, string RespFormatName)\r\n        {\r\n\r\n            try\r\n            {\r\n                // get the response message queue path from the response format name\r\n                string MQResponsePath = RespFormatName.Split(':')[1];\r\n\r\n                // open the respone message queue\r\n                MessageQueue MQueue = new MessageQueue(MQResponsePath);\r\n\r\n                // create a message out of the message body we got passed along\r\n                // so we can read the message body in the format originally sent\r\n                Message Msg = new Message();\r\n                Msg.BodyStream = new System.IO.MemoryStream((Byte[])MsgBody);\r\n                Msg.Formatter = new XmlMessageFormatter(new Type[] { typeof(Foo) });\r\n\r\n                // gets the Foo object from the message body passed along\r\n                Foo f = (Foo)Msg.Body;\r\n\r\n                // close the response message queue again\r\n                MQueue.Close();\r\n\r\n                string s = \"Foo.Id: \" + f.Id.ToString() + Environment.NewLine + \"Foo.Name: \" + f.Name;\r\n                StreamWriter oLogFile = new StreamWriter(\"MSMQ_Ted.log\", true);\r\n                oLogFile.WriteLine(System.DateTime.Now.ToString() + \"  \" + s);\r\n                oLogFile.Close();\r\n\r\n            }\r\n\r\n            // catch any exception to keep the MSMQ trigger service ok\r\n            catch (Exception)\r\n            { }\r\n        }\r\n    }\r\n}\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["MSMQ Trigger",".Net COM Interop"]},{"RecordId":"847","Title":"Convert ADODB.RecordSet to ADO.Net DataSet","Description":"Demonstrates how to convert an ADODB.RecordSet into an ADO.Net DataSet","Code":"You can convert an ADO Recordset into an ADO.NET Dataset. You can use the OleDbDataAdapter to get rows from an ADODB.Recordset and the ADODB.Record and put them in a DataSet. \r\n\r\nThe following C# code using System.Data.OleDb namespace will accomplish this. \r\n\r\nADODB.Recordset MyRs= new ADODB.Recordset();\r\nADODB.Connection MyCn = new ADODB.Connection();\r\n\r\nMyCn.Open(\"Provider=Microsoft.Jet.OLEDB.4.0;data source=D:\\\\Northwind.mdb\",\r\n  \"Admin\", \"\", 0);\r\nMyRs.Open(\"Select * from Customers\",MyCn,ADODB.CursorTypeEnum.adOpenStatic, ADODB.LockTypeEnum.adLockOptimistic,0);\r\n\r\n// Create and fill the dataset from the recordset. Note that the\r\n// OleDbDataAdapter.Fill() overload that takes a DataTable.  \r\nOleDbDataAdapter myDA = new OleDbDataAdapter();\r\nDataSet myDS = new DataSet(\"MyTable\");\r\nmyDA.Fill(myDS, MyRs, \"MyTable\");\r\n\r\n// Close and destroy ADODB Objects.  An ADO object implicitly calls Close() \r\n// on the ADO object when the Fill operation is complete.\r\nMyCn.Close();","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["ADODB.RecordSet","DataTable"]},{"RecordId":"848","Title":"Convert ADO.Net DataTable to ADODB.RecordSet","Description":"Demonstrates how to convert an ADO.Net DataTable into an ADODB.RecordSet.  \r\nNOTE:  You must set a reference to Microsoft ActiveX Data Objects to use ADODB.RecordSets.  If you want to pass the ADODB.RecordSet back to VB6, you must COM+ enable your class.","Code":"using System;\r\nusing System.Collections.Generic;\r\nusing System.Text;\r\nusing System.Data;\r\nusing ADODB;\r\nusing System.Runtime.InteropServices;\r\n\r\nnamespace Foo_BusinessServices\r\n{\r\n  [Guid(\"E51A4F3A-8D0D-4024-B365-F738F5E32EAB\")]\r\n  public interface IADOWrapper\r\n  {\r\n    ADODB.Recordset GetFooDataADO(int CustID);\r\n  }\r\n\r\n\r\n  [ClassInterface(ClassInterfaceType.None)]\r\n  [Guid(\"04A2855A-209C-45e0-ABD3-69575E3DA1EB\")]\r\n  public class Foo1:IADOWrapper \r\n  {\r\n\r\n    private ADODB.DataTypeEnum TranslateType(Type columnType)\r\n    {\r\n      switch (columnType.UnderlyingSystemType.ToString())\r\n      {\r\n        case \"System.Boolean\":\r\n          return ADODB.DataTypeEnum.adBoolean;\r\n\r\n        case \"System.Byte\":\r\n          return ADODB.DataTypeEnum.adUnsignedTinyInt;\r\n\r\n        case \"System.Char\":\r\n          return ADODB.DataTypeEnum.adChar;\r\n\r\n        case \"System.DateTime\":\r\n          return ADODB.DataTypeEnum.adDate;\r\n\r\n        case \"System.Decimal\":\r\n          return ADODB.DataTypeEnum.adCurrency;\r\n\r\n        case \"System.Double\":\r\n          return ADODB.DataTypeEnum.adDouble;\r\n\r\n        case \"System.Int16\":\r\n          return ADODB.DataTypeEnum.adSmallInt;\r\n\r\n        case \"System.Int32\":\r\n          return ADODB.DataTypeEnum.adInteger;\r\n\r\n        case \"System.Int64\":\r\n          return ADODB.DataTypeEnum.adBigInt;\r\n\r\n        case \"System.SByte\":\r\n          return ADODB.DataTypeEnum.adTinyInt;\r\n\r\n        case \"System.Single\":\r\n          return ADODB.DataTypeEnum.adSingle;\r\n\r\n        case \"System.UInt16\":\r\n          return ADODB.DataTypeEnum.adUnsignedSmallInt;\r\n\r\n        case \"System.UInt32\":\r\n          return ADODB.DataTypeEnum.adUnsignedInt;\r\n\r\n        case \"System.UInt64\":\r\n          return ADODB.DataTypeEnum.adUnsignedBigInt;\r\n\r\n        case \"System.String\":\r\n        default:\r\n          return ADODB.DataTypeEnum.adVarChar;\r\n      }\r\n    }\r\n\r\n    private ADODB.Recordset ConvertDataTableToRecordSet(DataTable inTable)\r\n    {\r\n      ADODB.Recordset result = new ADODB.Recordset();\r\n      result.CursorLocation = ADODB.CursorLocationEnum.adUseClient;\r\n\r\n      ADODB.Fields resultFields = result.Fields;\r\n      System.Data.DataColumnCollection inColumns = inTable.Columns;\r\n\r\n      foreach (DataColumn inColumn in inColumns)\r\n      {\r\n        resultFields.Append(inColumn.ColumnName\r\n          , TranslateType(inColumn.DataType)\r\n          , inColumn.MaxLength\r\n          , inColumn.AllowDBNull ? ADODB.FieldAttributeEnum.adFldIsNullable :\r\n                                   ADODB.FieldAttributeEnum.adFldUnspecified\r\n          , null);\r\n      }\r\n\r\n      result.Open(System.Reflection.Missing.Value\r\n            , System.Reflection.Missing.Value\r\n            , ADODB.CursorTypeEnum.adOpenStatic\r\n            , ADODB.LockTypeEnum.adLockOptimistic, 0);\r\n\r\n      foreach (DataRow dr in inTable.Rows)\r\n      {\r\n        result.AddNew(System.Reflection.Missing.Value,\r\n                      System.Reflection.Missing.Value);\r\n\r\n        for (int columnIndex = 0; columnIndex < inColumns.Count; columnIndex++)\r\n        {\r\n          resultFields[columnIndex].Value = dr[columnIndex];\r\n        }\r\n      }\r\n      if (inTable.Rows.Count > 0)\r\n      {\r\n          result.MoveFirst();\r\n      }\r\n      return result;\r\n    }\r\n\r\n\r\n    public ADODB.Recordset GetFooDataADO(int CustID)\r\n    {\r\n      return ConvertDataTableToRecordSet(GetFooData(CustID));\r\n    }\r\n\r\n\r\n    public static DataTable GetFooData(int CustID)\r\n    {\r\n      DataTable dt = new DataTable();\r\n      dt.Columns.Add(new DataColumn(\"CustomerID\", System.Type.GetType(\"System.Int32\")));\r\n      dt.Columns.Add(new DataColumn(\"CustomerName\", System.Type.GetType(\"System.String\")));\r\n      for (int i = 0; i < 5; i++)\r\n      {\r\n          DataRow dr = dt.NewRow();\r\n          dr[\"CustomerID\"] = i;\r\n          dr[\"CustomerName\"] = \"Customer \" + i.ToString() + \" Name\";\r\n          dt.Rows.Add(dr);\r\n      }\r\n      dt.AcceptChanges();\r\n      return dt;\r\n    }\r\n  }\r\n}\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["ADODB.RecordSet","DataTable"]},{"RecordId":"850","Title":"List All User Tables and Column Information in SQL Database","Description":"T-Sql to list all user tables, columns, and column info (including extended description).","Code":"//----------------------------------------------------\r\n// Print all User Tables\r\n//----------------------------------------------------\r\n\r\nSELECT  Name as TableName\r\nFROM    sys.objects\r\nWHERE   type_desc = 'USER_TABLE'\r\nORDER BY TableName\r\n\r\n\r\n//----------------------------------------------------\r\n// Print column information for all user tables (includes table names)\r\n//----------------------------------------------------\r\n\r\nSELECT  o.Name as TableName,\r\n        c.name AS ColumnName,\r\n        SCHEMA_NAME(t.schema_id) AS SchemaName,\r\n        t.name AS TypeName,\r\n        c.max_length,\r\n        c.precision,\r\n        c.scale,\r\n        [Description] = ex.value\r\nFROM sys.objects o\r\nJOIN    sys.columns AS c\r\nON      o.object_id=c.Object_id\r\nJOIN    sys.types AS t\r\nON      c.user_type_id=t.user_type_id\r\nLEFT OUTER JOIN sys.extended_properties ex\r\nON      ex.major_id = c.object_id\r\nAND     ex.minor_id = c.column_id\r\nAND     ex.name = 'MS_Description'\r\nWHERE o.type_desc = 'USER_TABLE'\r\nAND o.Name NOT IN (\r\n    'dtproperties',\r\n    'OPFXInterfacesInbound',\r\n    'OPFXInterfacesOutbound',\r\n    'tbl_AdmissionPrinters',\r\n    'tbl_ADT_Inbound',\r\n    'tbl_LabelPrintingLocations',\r\n    'tbl_ORCaseScrubNurse',\r\n    'tbl_ORChargeProcedures',\r\n    'tbl_ORDoctorAssistantLink',\r\n    'tbl_ORDraping',\r\n    'tbl_ORPositioning',\r\n    'tbl_ORProcedureHaveReady',\r\n    'tbl_ORSchedTemp',\r\n    'tbl_ORScrubNurse',\r\n    'tbl_PrintFile',\r\n    'tbl_ProcedureORChargeProcedure',\r\n    'tbl_ProcedureORDraping',\r\n    'tbl_ProcedureORPositioning'\r\n    )\r\nORDER BY TableName\r\n\r\n\r\n//----------------------------------------------------\r\n// Print column information for all user tables (Prints unique columns only, does not include table names)\r\n//----------------------------------------------------\r\n\r\nSELECT  distinct\r\n        c.name AS ColumnName,\r\n        SCHEMA_NAME(t.schema_id) AS SchemaName,\r\n        t.name AS TypeName,\r\n        c.max_length,\r\n        c.precision,\r\n        c.scale,\r\n        [Description] = ex.value\r\nFROM sys.objects o\r\nJOIN    sys.columns AS c\r\nON      o.object_id=c.Object_id\r\nJOIN    sys.types AS t\r\nON      c.user_type_id=t.user_type_id\r\nLEFT OUTER JOIN sys.extended_properties ex\r\nON      ex.major_id = c.object_id\r\nAND     ex.minor_id = c.column_id\r\nAND     ex.name = 'MS_Description'\r\nWHERE o.type_desc = 'USER_TABLE'\r\nAND o.Name NOT IN (\r\n    'dtproperties',\r\n    'OPFXInterfacesInbound',\r\n    'OPFXInterfacesOutbound',\r\n    'tbl_AdmissionPrinters',\r\n    'tbl_ADT_Inbound',\r\n    'tbl_LabelPrintingLocations',\r\n    'tbl_ORCaseScrubNurse',\r\n    'tbl_ORChargeProcedures',\r\n    'tbl_ORDoctorAssistantLink',\r\n    'tbl_ORDraping',\r\n    'tbl_ORPositioning',\r\n    'tbl_ORProcedureHaveReady',\r\n    'tbl_ORSchedTemp',\r\n    'tbl_ORScrubNurse',\r\n    'tbl_PrintFile',\r\n    'tbl_ProcedureORChargeProcedure',\r\n    'tbl_ProcedureORDraping',\r\n    'tbl_ProcedureORPositioning'\r\n    )\r\nORDER BY ColumnName","Declares":"","CodeCategory":{"CategoryId":"6","CategoryDescription":"T-SQL"},"Keywords":["Table Info","Column Info","Schema"]},{"RecordId":"851","Title":"Populate DataTable","Description":"Demonstrates simple DataTable population using SqlConnection, SqlCommand, and SqlDataAdapter.","Code":"DataTable dt = new DataTable();\r\n\r\nSqlConnection cn = new SqlConnection();\r\ncn.ConnectionString = &quot;server=YourServer; uid=YourUser; pwd=YourPassword; database=YourDB&quot;;\r\ncn.Open();\r\n\r\nSqlCommand cmd = new SqlCommand( &quot;Select * from YourTable&quot;, cn );\r\n\r\nSqlDataAdapter da = new SqlDataAdapter( cmd );\r\nda.Fill( dt );\r\n\r\nda.Dispose();\r\ncmd.Dispose();\r\ncn.Close();\r\ncn.Dispose();\r\n\r\n// dt can now be used as desired even after connection is closed.","Declares":"","CodeCategory":{"CategoryId":"21","CategoryDescription":".Net - ADO.Net"},"Keywords":["DataTable"]},{"RecordId":"852","Title":"Retrieve Running Processes","Description":"Routines to retrieve all running processes.","Code":"using System;\r\nusing System.Collections.Generic;\r\nusing System.Text;\r\nusing System.Management;\r\nusing System.Diagnostics;\r\n\r\n// Lists all Win32 processes (those that show in Task Manager on the Processes tab)\r\npublic static List<string> ListWin32ProcessesByProcessName()\r\n{\r\n   List<string> strListOut = new List<string>();\r\n   ManagementClass MgmtClass = new ManagementClass( \"Win32_Process\" );\r\n   foreach ( ManagementObject mo in MgmtClass.GetInstances() )\r\n   {\r\n      strListOut.Add( mo[\"Name\"].ToString().ToLower() );\r\n   }\r\n   return strListOut;\r\n}\r\n\r\n// List all running applicattions (those that show in Task Manager on the Applications tab)\r\npublic static string ListAllApplications()\r\n{\r\n   StringBuilder sb = new StringBuilder();\r\n   foreach (Process p in Process.GetProcesses(\".\"))\r\n   {\r\n      try\r\n      {\r\n         if (p.MainWindowTitle.Length > 0)\r\n         {\r\n            sb.Append(\"Window Title:\\t\" + p.MainWindowTitle.ToString()+ Environment.NewLine);\r\n            sb.Append(\"Process Name:\\t\" + p.ProcessName.ToString() + Environment.NewLine);\r\n            sb.Append(\"Window Handle:\\t\" + p.MainWindowHandle.ToString() + Environment.NewLine);\r\n            sb.Append(\"Memory Allocation:\\t\" + p.PrivateMemorySize64.ToString() + Environment.NewLine);\r\n            sb.Append(Environment.NewLine);\r\n         }\r\n      }\r\n      catch { }\r\n   }\r\n   return sb.ToString();\r\n}\r\n\r\n// List all loaded assemblies of all running applicattions (those that show in Task Manager on the Applications tab)\r\npublic static string ListAllByImageName()\r\n{\r\n   StringBuilder sb = new StringBuilder();\r\n   foreach (Process p in Process.GetProcesses(\".\"))\r\n   {\r\n      try\r\n      {\r\n         foreach (ProcessModule pm in p.Modules)\r\n         {\r\n            sb.Append(\"Image Name:\\t\" + pm.ModuleName.ToString() + Environment.NewLine);\r\n            sb.Append(\"File Path:\\t\\t\" + pm.FileName.ToString() + Environment.NewLine);\r\n            sb.Append(\"Memory Size:\\t\" + pm.ModuleMemorySize.ToString() + Environment.NewLine);\r\n            sb.Append(\"Version:\\t\\t\" + pm.FileVersionInfo.FileVersion.ToString() + Environment.NewLine);\r\n            sb.Append(Environment.NewLine);\r\n         }\r\n      }\r\n      catch { }\r\n   }\r\n   return sb.ToString();\r\n}\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Win32 Processes","Running Processes"]},{"RecordId":"853","Title":"NT Service Utilities","Description":"Demonstrates how to find, start, stop, pause, and ping a service.","Code":"// Find a specific NT Service by name and return an instance of it\r\npublic ServiceController FindService(string serviceName) \r\n{\r\n   ServiceController[] services = ServiceController.GetServices();;\r\n   for (int i = 0; i < services.Length; i++) \r\n   {\r\n      if (services[i].ServiceName == serviceName) \r\n      {\r\n         return services[i];\r\n      }\r\n   }\r\n   return null;\r\n}\r\n\r\n// Change the status of the NT Service (Start,Stop,Pause,Ping,Continue)\r\npublic void SetServiceStatus(ServiceController service, string status) \r\n{\r\n   if (status == \"Start\") \r\n   {\r\n      service.Start();\r\n      service.WaitForStatus(ServiceControllerStatus.Running);\r\n   } \r\n   else if (status == \"Stop\") \r\n   {\r\n      service.Stop();\r\n      service.WaitForStatus(ServiceControllerStatus.Stopped);\r\n   } \r\n   else if (status == \"Pause\") \r\n   {\r\n      service.Pause();\r\n      service.WaitForStatus(ServiceControllerStatus.Paused);\r\n   } \r\n   else if (status == \"Continue\") \r\n   {\r\n      service.Continue();\r\n      service.WaitForStatus(ServiceControllerStatus.Running);\r\n   } \r\n   else if (status == \"Ping\") \r\n   {\r\n      service.ExecuteCommand(128);  // Can be any value between 128 and 255\r\n      service.WaitForStatus(ServiceControllerStatus.Running);\r\n   } \r\n}\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Service","NT Service"]},{"RecordId":"854","Title":"Recursive Directory Crawler","Description":"Returns list of all files in a directory tree (uses recursion).","Code":"// Initial call\r\nList<string> list = ProcessDirectory( @\"C:\\SomeDirName\", null );\r\n\r\n\r\nprivate List<string> ProcessDirectory( string directory, List<string> list )\r\n{\r\n    if ( list == null )\r\n    {\r\n        list = new List<string>();\r\n    }\r\n\r\n    string[] files = Directory.GetFiles( directory );\r\n    foreach ( string file in files )\r\n    {\r\n        list.Add( file );\r\n    }\r\n    string[] dirs = Directory.GetDirectories( directory );\r\n    foreach ( string dir in dirs )\r\n    {\r\n        list = ProcessDirectory( dir, list );\r\n    }\r\n\r\n    return list;\r\n}\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Directory Processor","Recursive Directory Processor"]},{"RecordId":"855","Title":"Retrieve MAC Address, CPU Processor ID, and Operating System Installation Date/Time","Description":"Uses WMI to retrieve a computer's MAC Address, CPU Processor ID, and Operating System Installation Date/Time.","Code":"using System.Management;\r\n\r\nManagementClass mc = new ManagementClass( \"Win32_NetworkAdapterConfiguration\" );\r\nManagementObjectCollection moc = mc.GetInstances();\r\nstring MACAddress = string.Empty;\r\nforeach ( ManagementObject mo in moc )\r\n{\r\n  if ( MACAddress == string.Empty )  // only return MAC Address from first card\r\n  {\r\n    if ( ( bool ) mo[\"IPEnabled\"] == true )\r\n    {\r\n      MACAddress = mo[\"MacAddress\"].ToString();\r\n    }\r\n  }\r\n  mo.Dispose();\r\n}\r\n\r\nstring cpuInfo = string.Empty;\r\nmc = new ManagementClass( \"Win32_Processor\" );\r\nmoc = mc.GetInstances();\r\nforeach ( ManagementObject mo in moc )\r\n{\r\n  if ( cpuInfo == string.Empty )  // only get first Processor\r\n  {\r\n    cpuInfo = mo.Properties[\"ProcessorId\"].Value.ToString();\r\n  }\r\n  mo.Dispose();\r\n}\r\nSystem.Console.WriteLine( cpuInfo);\r\n\r\nstring OSInstallDateTime = string.Empty;\r\nmc = new ManagementClass( \"Win32_OperatingSystem\" );\r\nmoc = mc.GetInstances();\r\nforeach ( ManagementObject mo in moc )\r\n{\r\n  if ( OSInstallDateTime == string.Empty )\r\n  {\r\n    OSInstallDateTime = mo.Properties[\"InstallDate\"].Value.ToString();\r\n  }\r\n  mo.Dispose();\r\n}\r\n\r\nMessageBox.Show(\r\n  \"MAC Address: \" + MACAddress + Environment.NewLine +\r\n  \"CPU Processor ID: \" + cpuInfo + Environment.NewLine +\r\n  \"O/S Install Date/Time: \" + OSInstallDateTime\r\n);","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["MAC Address","OS Installation Date/Time","Processor ID"]},{"RecordId":"856","Title":"Dynamically Load an Assembly and Call a Method (Two samples with performance analysis)","Description":"Demonstrates 2 ways to dynamically load an assembly and call a method on it.  Also contains informance on performance differences between the options.","Code":"Assembly a = Assembly.LoadFile( @&quot;C:\\SomePath\\Concrete.dll&quot; );\r\nIOrderService os = a.CreateInstance( &quot;Concrete.OrderService&quot; ) as IOrderService;\r\nDataTable dt = os.GetOrders( 69 );\r\n\r\nObjectHandle objectHandle = Activator.CreateInstanceFrom( @&quot;C:\\SomePath\\Concrete.dll&quot;, &quot;Concrete.OrderService&quot; );\r\nobject phantomObject = objectHandle.Unwrap();\r\nIOrderService os = phantomObject as IOrderService;\r\nDataTable dt = os.GetOrders( 69 );\r\n\r\n\r\nExecuting the above code for 100 iterations:\r\nAssembly.LoadFile took an average of 200 milliseconds to execute 100 iterations.  \r\nActivator.CreateInstanceFrom took an average of 15 milliseconds to execute 100 iterations.\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Dynamically Load Assembly","CreateInstance"]},{"RecordId":"857","Title":"Change Domain Password Via Outlook","Description":"Explains how to change a domain password using Outlook.","Code":"1. On the Outlook Tools menu, click Options.  \r\n2. In the Options dialog box, click the Other tab.  \r\n3. Click Advanced Options.  \r\n4. Click Custom Forms.  \r\n5. Click Password.  \r\n6. Fill out the appropriate information in the Change Windows NT Password dialog box. Click OK four times to close Options. \r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"7","CategoryDescription":"Misc"},"Keywords":["Change Password"]},{"RecordId":"858","Title":"Creating a Send-To Shortcut to Add a .Net Asembly to the GAC","Description":"Explains how to create a Send To-item in your Windows Explorer right-click shortcut menu to install a .Net assembly to the GAC","Code":"1. Create a .bat file in any directory that contains the following code (for example \"AddToGAC.bat\"):\r\n   \"C:\\Program Files\\Microsoft Visual Studio 8\\SDK\\v2.0\\Bin\\gacutil.exe\" -i %1\r\n2. Using Windows Explorer, right-click the .bat file and select Copy from the shortcut menu.\r\n3. Using Windows Explorer, navigate to the C:\\Documents and Settings\\<User Name>\\SendTo folder.\r\n4. Right-click in the right pane of Windows Explorer and select Paste Shortcut.\r\n5. Rename the shortcut to something user-friendly such as \"GAC\"\r\n\r\nNow you can right-click a .NET assembly in Windows Explorer and select \"Add to GAC\" from the shortcut menu.","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Send-To GAC","GAC"]},{"RecordId":"859","Title":"Dynamically Load an Assembly and Dynamically Call a Method (Two samples with performance analysis)","Description":"Demonstrates two ways to dynamically load and assembly and dynamically invoke a method.","Code":"In the two samples that follow, Method 1 is always slower than Method 2.  The highest cost in each of these samples is loading the assembly (either with Assembly.LoadFile or Activator.CreateInstanceFrom).  Once that step occurs, the subsequent operations are relatively fast regardless of the methodology used.\r\n\r\nIn the code below, 2000 iterations were ran four different ways:\r\nMethod 1 load the assembly each time:  2400 ticks\r\nMethod 1 load the assembly once and execute everything else each time:  130 ticks\r\nMethod 2 Load the assembly each time:  220 ticks\r\nMethod 2 load the assembly once and execute everything else each time:  40 ticks\r\n\r\n// ------------------------------------------\r\n// Method 1\r\n// ------------------------------------------\r\nAssembly a = Assembly.LoadFile( @\"C:\\SomePath\\SomeLibrary.dll\" );\r\nobject theClass = a.CreateInstance( \"SomeLibrary.SomeClass\" );\r\nType theType = a.GetType( \"SomeLibrary.SomeClass\" );\r\nobject[] arguments = new object[2];\r\narguments[0] = 69;\r\narguments[1] = 96;\r\nobject retVal =\r\ntheType.InvokeMember( \"DoSomeWork\",\r\n    BindingFlags.Default | BindingFlags.InvokeMethod,\r\n    null,\r\n    theClass,\r\n    arguments );\r\nstring s = retVal as string;\r\n\r\n// ------------------------------------------\r\n// Method 2\r\n// ------------------------------------------\r\nObjectHandle objectHandle = Activator.CreateInstanceFrom( @\"C:\\SomePath\\SomeLibrary.dll\", \"SomeLibrary.SomeClass\" );\r\nobject theClass = objectHandle.Unwrap();\r\nType theType = theClass.GetType();\r\nobject[] arguments = new object[2];\r\narguments[0] = 69;\r\narguments[1] = 96;\r\nobject retVal =\r\ntheType.InvokeMember( \"DoSomeWork\",\r\n    BindingFlags.Default | BindingFlags.InvokeMethod,\r\n    null,\r\n    theClass,\r\n    arguments );\r\nstring s = retVal as string;","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Dynamically Load Assembly","Dynamically Invoke Method"]},{"RecordId":"860","Title":"Object Serialization Using BinaryFormatter, SoapFormatter, and XmlSerializer","Description":"The code demonstrates how to use a BinaryFormatter, SoapFormatter, and XmlSerializer to serialize and de-serialize an object into Base64 and ASCII strings.  Two different methods of using the XmlSerializer are demonstrated.","Code":"There is one important point to consider when choosing a serializer. The XmlSerializer will NOT serialize the state of private variables that are not referenced by public properties, whereas the BinaryFormatter and SoapFormatter will. Given the class below, the value of \"secretNbr\" will not be preserved using an XmlSerializer, but it will using the BinaryFormatter and SoapFormatter.\r\n\r\npublic class MyClass1\r\n{\r\n  private int id;\r\n  private string name;\r\n  private int secretNbr;\r\n  \r\n  public MyClass1() { }\r\n  \r\n  public MyClass1( int id ): this(id,\"\") { }\r\n  \r\n  public MyClass1( int id, string name )\r\n  {\r\n    this.id = id;\r\n    this.name = name;\r\n    secretNbr = 69;\r\n  }\r\n  \r\n  public int Id\r\n  {\r\n    get { return id; }\r\n    set { id = value; }\r\n  }\r\n  \r\n  public string Name\r\n  {\r\n    get { return name; }\r\n    set { name = value; }\r\n  }\r\n  \r\n  public int DoFoo( int parm1, int parm2 )\r\n  {\r\n    return ( parm1 + parm2 );\r\n  }\r\n}\r\n\r\n\r\n\r\n\r\n//---------------------------------------------------------\r\n// These Binary, Soap and Xml examples convert to Base64 strings\r\n// Below this section are examples that convert to ASCII strings\r\n//---------------------------------------------------------\r\n\r\nMyClass1 c1 = new MyClass1( 1, \"Elvis\" );\r\n\r\n\r\n// Serialize the object using a BinaryFormatter\r\nBinaryFormatter binFmtr = new BinaryFormatter();\r\nMemoryStream swBin = new MemoryStream();\r\nbinFmtr.Serialize( swBin, c1 );\r\nByte[] binBytes = swBin.ToArray();\r\nstring binString = System.Convert.ToBase64String( binBytes );\r\n\r\n// De-serialize the object using a BinaryFormatter\r\nswBin = new MemoryStream( System.Convert.FromBase64String( binString ) );\r\nbinFmtr = new BinaryFormatter();\r\nMyClass1 c2 = ( MyClass1 ) binFmtr.Deserialize( swBin );\r\n\r\n\r\n// Serialize the object using a SoapFormatter\r\nSoapFormatter soapFmtr = new SoapFormatter();\r\nMemoryStream swSoap = new MemoryStream( );\r\nsoapFmtr.Serialize( swSoap, c1 );\r\nByte[] soapBytes = swSoap.ToArray();\r\nstring soapString = System.Convert.ToBase64String( soapBytes );\r\n\r\n// De-serialize the object using a SoapFormatter\r\nswSoap = new MemoryStream( System.Convert.FromBase64String( soapString ) );\r\nsoapFmtr = new SoapFormatter();\r\nMyClass1 c3 = ( MyClass1 ) soapFmtr.Deserialize( swSoap );\r\n\r\n\r\n// Serialize the object using an XmlSerializer (Method 1)\r\nXmlSerializer xmlFmtr = new XmlSerializer( typeof( MyClass1 ) );\r\nMemoryStream swXml = new MemoryStream();\r\nxmlFmtr.Serialize( swXml, c1 );\r\nByte[] xmlBytes = swXml.ToArray();\r\nstring xmlString = System.Convert.ToBase64String( xmlBytes );\r\n\r\n// De-serialize the object using an XmlSerializer\r\nswXml = new MemoryStream( System.Convert.FromBase64String( xmlString ) );\r\nxmlFmtr = new XmlSerializer( typeof( MyClass1 ) );\r\nMyClass1 c4 = ( MyClass1 ) xmlFmtr.Deserialize( swXml );\r\n\r\n\r\n\r\n\r\n//---------------------------------------------------------\r\n// These Binary, Soap and Xml examples convert to ASCII strings\r\n//---------------------------------------------------------\r\n\r\nMyClass1 c1 = new MyClass1( 1, \"Elvis\" );\r\n\r\n// Serialize the object using a BinaryFormatter\r\nBinaryFormatter binFmtr = new BinaryFormatter();\r\nMemoryStream swBin = new MemoryStream();\r\nbinFmtr.Serialize( swBin, c1 );\r\nstring binString = Encoding.ASCII.GetString( swBin.GetBuffer() );\r\n\r\n// De-serialize the object using a BinaryFormatter\r\nswBin = new MemoryStream( Encoding.ASCII.GetBytes( binString ) );\r\nbinFmtr = new BinaryFormatter();\r\nMyClass1 c2 = ( MyClass1 ) binFmtr.Deserialize( swBin );\r\n\r\n\r\n// Serialize the object using a SoapFormatter\r\nSoapFormatter soapFmtr = new SoapFormatter();\r\nMemoryStream swSoap = new MemoryStream();\r\nsoapFmtr.Serialize( swSoap, c1 );\r\nstring soapString = Encoding.ASCII.GetString( swSoap.GetBuffer() );\r\n\r\n// De-serialize the object using a SoapFormatter\r\nswSoap = new MemoryStream( Encoding.ASCII.GetBytes( soapString ) );\r\nsoapFmtr = new SoapFormatter();\r\nMyClass1 c3 = ( MyClass1 ) soapFmtr.Deserialize( swSoap );\r\n\r\n\r\n// Serialize the object using an XmlSerializer (Method 1)\r\nXmlSerializer xmlFmtr = new XmlSerializer( typeof( MyClass1 ) );\r\nMemoryStream swXml = new MemoryStream();\r\nxmlFmtr.Serialize( swXml, c1 );\r\nstring xmlString = Encoding.ASCII.GetString( swXml.GetBuffer() );\r\n\r\n// De-serialize the object using an XmlSerializer\r\nswXml = new MemoryStream( Encoding.ASCII.GetBytes( xmlString ) );\r\nxmlFmtr = new XmlSerializer( typeof( MyClass1 ) );\r\nMyClass1 c4 = ( MyClass1 ) xmlFmtr.Deserialize( swXml );\r\n\r\n\r\n// Serialize the object using an XmlSerializer (Method 2)\r\nxmlFmtr = new XmlSerializer( typeof( MyClass1 ) );\r\nStringWriter sw = new StringWriter();\r\nxmlFmtr.Serialize( sw, c1 );\r\nxmlString = sw.ToString();\r\n\r\n// De-serialize the object using an XmlSerializer\r\nxmlFmtr = new XmlSerializer( typeof( MyClass1 ) );\r\nStringReader srdr = new StringReader( xmlString );\r\nMyClass1 c5 = ( MyClass1 ) xmlFmtr.Deserialize( srdr );","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Serialize","Deserialize","Serialization"]},{"RecordId":"861","Title":"Session Object (Like ASP.Net Session State)","Description":"Demonstrates how to construct a session object which is similar in functionality to the ASP.Net Session object.  The object is thread-safe for multi-threaded environments.","Code":"The Session is implemented as a thread-safe Singleton pattern.\r\n\r\nNOTE:  If you attempt to retrieve the value of a non-existent key, the service will return null.\r\n\r\n=================================\r\nExample Usage\r\n=================================\r\n\r\n// Create a session object\r\nSession session = Session.Instance;\r\n\r\n// Add a string and an integer to the session collection\r\nsession[&amp;quot;SomeStringValue&amp;quot;] = &amp;quot;Your string value here&amp;quot;;\r\nsession[&amp;quot;SomeIntValue&amp;quot;] = 42;\r\n\r\n// Retrieve session values\r\nstring s = session[&amp;quot;SomeStringValue&amp;quot;].ToString();\r\nint i = int.Parse( session[&amp;quot;SomeIntValue&amp;quot;].ToString() );\r\n\r\n// Using a try/catch if you don't know whether the key exists\r\nstring s = string.Empty;\r\ntry\r\n{\r\n   string s = session[&amp;quot;SomeStringValue&amp;quot;].ToString();\r\n}\r\ncatch{}\r\n\r\n\r\n// Check for the existence of a key value\r\nbool retVal = session.Contrains( &amp;quot;SomeStringValue&amp;quot; );\r\n\r\n// Clear all session contents\r\nsession.Clear();\r\n\r\n\r\n\r\n=================================\r\nThe Session Class\r\n=================================\r\n\r\nusing System;\r\nusing System.Collections;\r\nusing System.Collections.Generic;\r\nusing System.Threading;\r\n\r\nnamespace YourNamespace\r\n{\r\n    /// <summary>\r\n    /// Session object - functions very similar to ASP.Net session object\r\n    /// </summary>\r\n    [Serializable]\r\n    public class Session\r\n    {\r\n\r\n        #region ---------------------- Fields ----------------------\r\n\r\n        private Dictionary<string, object> session = new Dictionary<string, object>();\r\n        private static volatile Session instance;\r\n        private static object objectlockCheck = new Object();\r\n        private ReaderWriterLockSlim operationSemaphore = new ReaderWriterLockSlim();\r\n\r\n        #endregion\r\n\r\n        #region ---------------------- Constructor ----------------------\r\n        /// <summary>\r\n        /// Hides default constructor\r\n        /// </summary>\r\n        private Session() { }\r\n        #endregion\r\n\r\n        #region ---------------------- Public members ----------------------\r\n\r\n        #region Instance\r\n        /// <summary>\r\n        /// Singleton constructor - This is how you get an instance of the Session object\r\n        /// </summary>\r\n        /// <returns>Session</returns>\r\n        public static Session Instance\r\n        {\r\n            get\r\n            {\r\n                if ( instance == null )\r\n                {\r\n                    lock ( objectlockCheck )\r\n                    {\r\n                        if ( instance == null )\r\n                            instance = new Session();\r\n                    }\r\n                }\r\n\r\n                return instance;\r\n            }\r\n        }\r\n\r\n        #endregion\r\n\r\n        #region GetEnumerator\r\n        /// <summary>\r\n        /// Enumerator\r\n        /// </summary>\r\n        /// <returns>IEnumerator</returns>\r\n        public IEnumerator GetEnumerator()\r\n        {\r\n            // Get read lock\r\n            this.operationSemaphore.EnterReadLock();\r\n\r\n            try\r\n            {\r\n\r\n                foreach (KeyValuePair<string, object> kvp in session)\r\n                {\r\n                    yield return kvp.Value;\r\n                }\r\n            }\r\n            finally\r\n            {\r\n                // Release read lock\r\n                this.operationSemaphore.ExitReadLock();\r\n            }\r\n        }\r\n        #endregion\r\n\r\n        #region Contains\r\n        /// <summary>\r\n        /// Used to test to see if the collection contains the specified key\r\n        /// </summary>\r\n        /// <param name=\"key\">Key to lookup</param>\r\n        /// <returns>bool</returns>\r\n        public bool Contains( string key )\r\n        {\r\n\r\n            bool returnValue = false;\r\n\r\n            // Get read lock\r\n            this.operationSemaphore.EnterReadLock();\r\n            try\r\n            {\r\n                if ( session.ContainsKey( key ) )\r\n                    returnValue = true;\r\n            }\r\n            finally\r\n            {\r\n                // Release read lock\r\n                this.operationSemaphore.ExitReadLock();\r\n            }\r\n\r\n            return returnValue;\r\n        }\r\n        #endregion\r\n\r\n        #region Clear\r\n        /// <summary>\r\n        /// Removes all items in the Session\r\n        /// </summary>\r\n        public void Clear()\r\n        {\r\n            // Get write lock\r\n            this.operationSemaphore.EnterWriteLock();\r\n\r\n            try\r\n            {\r\n                session.Clear();\r\n            }\r\n            finally\r\n            {\r\n                // Release write lock\r\n                this.operationSemaphore.ExitWriteLock();\r\n            }\r\n        }\r\n        #endregion\r\n\r\n        #region this (named indexer)\r\n        /// <summary>\r\n        /// Named indexer\r\n        /// </summary>\r\n        /// <param name=\"key\">Key to lookup</param>\r\n        /// <returns>object</returns>\r\n        public object this[string key]\r\n        {\r\n            get\r\n            {\r\n                // Get read lock\r\n                this.operationSemaphore.EnterReadLock();\r\n                try\r\n                {\r\n                    if (session.ContainsKey(key))\r\n                    {\r\n                        return session[key];\r\n                    }\r\n                    else\r\n                    {\r\n                        return null;\r\n                    }\r\n                }\r\n                finally\r\n                {\r\n                    // Release read lock\r\n                    this.operationSemaphore.ExitReadLock();\r\n                }\r\n            }\r\n\r\n            set\r\n            {\r\n                // Get write lock\r\n                this.operationSemaphore.EnterWriteLock();\r\n                try\r\n                {\r\n                    if (session.ContainsKey(key))\r\n                    {\r\n                        session[key] = value;\r\n                    }\r\n                    else\r\n                    {\r\n                        session.Add(key, value);\r\n                    }\r\n                }\r\n                finally\r\n                {\r\n                    // Release write lock\r\n                    this.operationSemaphore.ExitWriteLock();\r\n                }\r\n            }\r\n        }\r\n        #endregion\r\n\r\n        #endregion\r\n\r\n    }\r\n}","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Sesssion","Singleton"]},{"RecordId":"862","Title":"Calling C# From VB6","Description":"Demonstrates how to create .Net assemblies that can be called from within VB6.","Code":"In the classes that will be exposed to COM, you need to include a reference to InteropServices\r\n\r\n  using System.Runtime.InteropServices;\r\n\r\n\r\n\r\nPut these attributes on each class that must be exposed to COM (use Visual Studio Guid Generation utility to create Guids)\r\n\r\n  [ComVisible( true )]\r\n  [ClassInterface(ClassInterfaceType.AutoDual)]\r\n  [Guid( \"7EBAD64A-B4DC-4e2a-AF9F-161A162D149A\" )]\r\n\r\n\r\n\r\nRegister the assembly with COM\r\n\r\n  regasm COM_Callable_Assembly.dll /tlb\r\n\r\n\r\nNOTE:  The assembly does NOT need to be strong-named.\r\n\r\n\r\n===============================================\r\nThe .Net class that is COM-callable\r\n===============================================\r\n\r\nusing System;\r\nusing System.Collections.Generic;\r\nusing System.Linq;\r\nusing System.Text;\r\nusing System.Runtime.InteropServices;\r\n\r\nnamespace COM_Callable_Assembly\r\n{\r\n   [ComVisible( true )]\r\n   [ClassInterface(ClassInterfaceType.AutoDual)]\r\n   [Guid( \"7EBAD64A-B4DC-4e2a-AF9F-161A162D149A\" )]\r\n   public class Class_Entity\r\n   {\r\n\r\n      private int id = 0;\r\n      private string name = string.Empty;\r\n      private DateTime dob = System.DateTime.MinValue;\r\n\r\n      public Class_Entity() { }\r\n\r\n      public int ID\r\n      {\r\n         get { return id; }\r\n         set { id = value; }\r\n      }\r\n\r\n      public string Name\r\n      {\r\n         get { return name; }\r\n         set { name = value; }\r\n      }\r\n      \r\n      public DateTime DateOfBirth\r\n      {\r\n         get { return dob; }\r\n         set { dob = value; }\r\n      }\r\n\r\n      public bool SaveData()\r\n      {\r\n     \r\n         if ( this.id == 0 )\r\n            throw new Exception( \"Missing ID\" );\r\n\r\n         if ( this.name == string.Empty )\r\n            throw new Exception( \"Missing Name\" );\r\n\r\n         if ( this.dob == System.DateTime.MinValue )\r\n            throw new Exception( \"Missing Date of Birth\" );\r\n\r\n         return true;\r\n\r\n      }\r\n   }\r\n}\r\n\r\n\r\n===============================================\r\nThe VB6 code that consumes the .Net class\r\n===============================================\r\n\r\nDim retVal As Boolean\r\nDim ce As Class_Entity\r\n    \r\nSet ce = New Class_Entity\r\nce.ID = 69\r\nce.Name = \"Elvis\"\r\nce.DateOfBirth = \"01/08/1935\"\r\nretVal = ce.SaveData()\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["COM Interop","Calling C# From VB6"]},{"RecordId":"863","Title":"Disabling the Close X Button on WinForm","Description":"This sample demonstrates 2 wasy to disable the \"Close X\" button on a WinForm","Code":"=================================================\r\nMethod 1 - Simple and elegant\r\nNOTE:  This method also automatically removes the \"Close\" and \"Alt-F4\" options from the form's Control Menu.  (Very sweet!!!)\r\n=================================================\r\n\r\nPut this code in your form.  The \"CreateParams\" is called every time the form is created.\r\n\r\nprivate const int CP_NOCLOSE_BUTTON = 0x200;\r\nprotected override CreateParams CreateParams\r\n{\r\n  get\r\n  {\r\n    CreateParams myCp = base.CreateParams;\r\n    myCp.ClassStyle = myCp.ClassStyle | CP_NOCLOSE_BUTTON ;\r\n    return myCp;\r\n  }\r\n} \r\n\r\n\r\n\r\n=================================================\r\nMethod 2 -  Uses the Win32 API (Ick!, but hey, we're trained professionals)\r\nNOTE:  This method also automatically removes the \"Close\" option from the form's Control Menu, but it DOES NOT disable the \"Alt-F4\" keystroke hotkey close.  To address this, you'll have to add code in the form's FormClosing event.  (Definitely not as elegant.)\r\n=================================================\r\n\r\n\r\nAdd a reference to Interop:\r\n\r\nusing System.Runtime.InteropServices;\r\n\r\n\r\nDeclare the following as class level variables:\r\n\r\nconst int MF_BYPOSITION = 0x400;\r\n\r\n[DllImport(&quot;User32&quot;)]\r\nprivate static extern int RemoveMenu(IntPtr hMenu, int nPosition, int wFlags);\r\n\r\n[DllImport(&quot;User32&quot;)]\r\nprivate static extern IntPtr GetSystemMenu(IntPtr hWnd, bool bRevert);\r\n\r\n[DllImport(&quot;User32&quot;)]\r\nprivate static extern int GetMenuItemCount(IntPtr hWnd);\r\n\r\n\r\nIn the Form_Load() event, write the following code:\r\n\r\nprivate void Form1_Load(object sender, EventArgs e)\r\n{\r\n  IntPtr hMenu = GetSystemMenu(this.Handle, false);\r\n  int menuItemCount = GetMenuItemCount(hMenu);\r\n  RemoveMenu(hMenu, menuItemCount - 1, MF_BYPOSITION);\r\n}\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Close X","Close Button"]},{"RecordId":"864","Title":"Windows Service Installer - Sets \"Allow service to interact with desktop\" Flag","Description":"Create a Windows Service Installer that sets the \"Allow service to interact with desktop\" flag","Code":"using System;\r\nusing System.ComponentModel;\r\nusing System.Configuration.Install;\r\nusing System.ServiceProcess;\r\nusing System.Management;\r\nnamespace WindowsServiceDemo\r\n{\r\n   [RunInstaller( true )]\r\n   public partial class ProjectInstaller : Installer\r\n   {\r\n      public ProjectInstaller()\r\n      {\r\n         InitializeComponent();\r\n         \r\n         ServiceProcessInstaller serviceProcessInstaller = new ServiceProcessInstaller();\r\n         ServiceInstaller serviceInstaller = new ServiceInstaller();\r\n         \r\n         // Service Account Information\r\n         serviceProcessInstaller.Account = ServiceAccount.LocalSystem;\r\n         serviceProcessInstaller.Username = null;\r\n         serviceProcessInstaller.Password = null;\r\n         \r\n         // Service Information\r\n         serviceInstaller.DisplayName = \"TedzService\";\r\n         serviceInstaller.StartType = ServiceStartMode.Manual;\r\n         serviceInstaller.ServiceName = \"TedzService\";\r\n         serviceInstaller.AfterInstall +=new InstallEventHandler(serviceInstaller_AfterInstall);\r\n         \r\n         this.Installers.Add( serviceProcessInstaller );\r\n         this.Installers.Add( serviceInstaller );\r\n      }\r\n      \r\n      void serviceInstaller_AfterInstall( object sender, InstallEventArgs e )\r\n      {\r\n         // This sets the \"Allow service to interact with desktop\" flag\r\n         ConnectionOptions coOptions = new ConnectionOptions();\r\n         coOptions.Impersonation = ImpersonationLevel.Impersonate;\r\n         ManagementScope mgmtScope = new System.Management.ManagementScope( @\"root\\CIMV2\", coOptions );\r\n         mgmtScope.Connect();\r\n         ManagementObject wmiService;\r\n         wmiService = new ManagementObject( \"Win32_Service.Name='TedzService'\" );\r\n         ManagementBaseObject InParam = wmiService.GetMethodParameters( \"Change\" );\r\n         InParam[\"DesktopInteract\"] = true;\r\n         ManagementBaseObject OutParam = wmiService.InvokeMethod( \"Change\", InParam, null );\r\n      }\r\n   }\r\n}\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Windows Service","Interact with desktop"]},{"RecordId":"865","Title":"Debugging a Windows Service","Description":"Describes how to attach to and debug a Windows Service","Code":"Debugging a Windows Service is different than a normal application. More steps are required to debug a Windows Service. The service cannot be debugged by simply executing it in the development environment as you can with a normal application. The service must first be installed and started. Once it is started, you attach Visual Studio to the running process in order to step through and debug the code. Remember, each change you make to the Windows Service will require you to uninstall and reinstall the service.\r\n\r\nAttach to a Running Windows Service - These instructions assume that you have already installed the Windows Service and it is currently running.\r\n\r\nLoad the project into Visual Studio \r\nClick on the Debug menu \r\nClick on the Attach to Processes menu item \r\nMake sure the Show processes from all users and the Show processes in all sessions options are selected \r\nLocate your process in the Processes list based on the name of your executable and click on it \r\nClick the Attach button \r\nClick OK \r\nClick Close \r\nSet a break point in the code and wait for it to execute ","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Debugging Windows Service"]},{"RecordId":"866","Title":"Adding an Item to the Visual Studio \"Add References\" Dialog","Description":"Explains how to add an item to the Visual Studio \"Add References\" dialog.","Code":"Open RegEdit and navigate to the following location:\r\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\.NETFramework\\AssemblyFolders\r\n\r\nCreate a new key for your application.  The name of the key can be anything, but I suggest using something simple and short and somewhat related to the name of your app/dll.\r\n\r\nUpdate the (Default) value with the full path to your exe/dll.  Be sure and include the trailing slash as in c:\\myfolder\\mysubfolder\\\r\n\r\nIMPORTANT! You must exit and restart Visual Studio to see your assembly in the Add Reference dialog.\r\n\r\n\r\n\r\nIf you have multiple versions of the same assembly in the GAC, and you want all versions to appear in the Visual Studio list of installed assemblies, you have two options:\r\n\r\n1. Provide a different name for each version of the assembly, such as MyLib1.0.dll and MyLib2.0.dll.\r\n\r\n2. Store each version of the assembly in its own folder, and add each folder to the registry as shown above. ","Declares":"","CodeCategory":{"CategoryId":"26","CategoryDescription":".Net - Visual Studio IDE"},"Keywords":["Add References"]},{"RecordId":"867","Title":"Add an Item to Windows Explorer's Right-click Context Menu","Description":"Explains how to add a menu item to Windows Explorer's right-click context menu.","Code":"If the menu option applies to DLLs, create a subkey under: \r\nHKEY_CLASSES_ROOT\\dllfile\\shell\\\r\n\r\nIf the menu option applies to EXEs, create a subkey under:\r\nHKEY_CLASSES_ROOT\\exefile\\shell\\\r\n\r\nThen, create a subkey to the newly added subkey named \"Command\"\r\nSet the default value of the \"Command\" subkey to the exe/dll name (including the path), plus the \"%1\" parameter.\r\n\r\n\r\nFor example, if you were adding a menu item named MyApp that is supposed to run c:\\myappsfolder\\myapp.exe when you right-click on a DLL, you would perform the setup as follows:\r\n\r\nCreate two new registry keys as follows:\r\nHKEY_CLASSES_ROOT\\dllfile\\shell\\MyApp\r\nHKEY_CLASSES_ROOT\\dllfile\\shell\\MyApp\\Command\r\n\r\nSet the default value of the Command subkey to (you must include the quotes):\r\n\"c:\\myappsfolder\\myapp.exe\" \"%1\" ","Declares":"","CodeCategory":{"CategoryId":"7","CategoryDescription":"Misc"},"Keywords":["Explorer Context Menu","Right-click menu item"]},{"RecordId":"868","Title":"Retrieving Class Properties and Property Values Using Reflection","Description":"Demonstrates how to retrieve the properties and their values of a class.","Code":"User u = new User();\r\nu.UserId = &quot;TeddyG&quot;;\r\nu.Age = 52;\r\n\r\nType type = u.GetType();\r\n\r\nPropertyInfo[] properties = type.GetProperties();\r\n\r\nforeach ( PropertyInfo property in properties )\r\n{\r\n    string propName = property.Name;\r\n    object oValue = property.GetValue( u, null );\r\n    if ( propName == \"UserId\" )\r\n    {\r\n        property.SetValue( u, \"TeddyG\", null );\r\n    }\r\n}\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Reflection","PropertyInfo"]},{"RecordId":"869","Title":"Constructor Chaining","Description":"Demonstrates how to chain a class's constructors.","Code":"using System;\r\n\r\nnamespace HelloWorld\r\n{\r\n    public class MultipleConstructors\r\n    {\r\n\r\n        // Two public properties\r\n        public int Id { get; set; }\r\n        public string Name { get; set; }\r\n\r\n        // Default constructor (calls overloaded constructor)\r\n        public MultipleConstructors()\r\n            : this( -1, \"Not Provided\" )\r\n        {\r\n\r\n        }\r\n        \r\n        // Overloaded constructed\r\n        public MultipleConstructors( int id, string name )\r\n        {\r\n            this.Name = name;\r\n            this.Id = id;\r\n        }\r\n    }\r\n}","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Constructor Chaining","Constructor Overloading"]},{"RecordId":"870","Title":"Singleton - Thread-safe","Description":"Singleton object - Preferred way to create a thread-safe Singleton object.","Code":"using System;\r\n\r\npublic class SingletonExample\r\n{\r\n\r\n  private static volatile SingletonExample instance;\r\n  private static object objectlockCheck = new Object();\r\n  private SingletonExample () {}\r\n  \r\n  public static SingletonExample Instance\r\n  {\r\n    get\r\n    {\r\n      if (instance == null)\r\n      {\r\n        lock (objectlockCheck)\r\n        {\r\n          if (instance == null)\r\n            instance = new SingletonExample ();\r\n        }\r\n      }\r\n      \r\n      return instance;\r\n    }\r\n  }\r\n}\r\n\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Singleton"]},{"RecordId":"871","Title":"Deprecating a Method or Property","Description":"Demonstrates how to mark a property or method as obsolete (deprecated).","Code":"If you want to deprecate a method in C#, simply add the Obsolete attribute in the declaration.  This will cause Intellisense to inform us that the method is deprecated every time we use code completion on the method.  The compiler will produce a Warning.\r\n\r\n[Obsolete(\"This is a deprecated method.\")]\r\npublic void Foo()\r\n{ ... }\r\n\r\n\r\nIf you use the overridden attribute and set error to true, the compiler will issue an Error instead of a warning.\r\n\r\n[Obsolete(\"This is a deprecated method.\", true)]\r\npublic void Foo()\r\n{ ... }\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Deprecate","Obsolete"]},{"RecordId":"872","Title":"MSMQ - Simple Example with Native Strings","Description":"Demonstrates how to use a custom MessageFormatter to write native .Net strings to a MSMQ and read native .Net strings from a MSMQ.\r\n\r\nNOTE:  If you don't use a custom MessageFormatter, the message body is wrapped in Xml.","Code":"//---------------------------------------------------------------------------\r\n// Writing raw string to the queue\r\n//---------------------------------------------------------------------------\r\n\r\nMessageQueue mq = new MessageQueue( @\".\\private$\\MyQueue\" );\r\nmq.Formatter = new MSMQStringMessageFormatter();\r\n\r\nstring msgText = \"Message text\";\r\nmq.Send(msgText);\r\n\r\nmq.Close();\r\n\r\n\r\n//---------------------------------------------------------------------------\r\n// Reading raw string from the queue\r\n//---------------------------------------------------------------------------\r\n\r\nMessageQueue mq = new MessageQueue( @\".\\private$\\MyQueue\" );\r\nmq.Formatter = new MSMQStringMessageFormatter();\r\n\r\nSystem.Messaging.Message msg = mq.Receive();\r\nstring msgText = msg.Body.ToString();\r\n\r\nmq.Close();\r\n\r\n\r\n//---------------------------------------------------------------------------\r\n// StringMessageFormatter class - Custom MessageFormatter to facilitate \r\n// writing and reading native strings on MSMQs\r\n//---------------------------------------------------------------------------\r\n\r\nusing System.IO;\r\nusing System.Messaging;\r\nusing System.Text;\r\n\r\nnamespace MSMQ_Testing\r\n{\r\n  class MSMQStringMessageFormatter:IMessageFormatter\r\n  {\r\n  \r\n    public object Read(Message message)\r\n    {\r\n      StreamReader streamReader;\r\n      Stream stream;\r\n      \r\n      stream = message.BodyStream;\r\n      streamReader = new StreamReader( stream, Encoding.Unicode );\r\n      \r\n      return streamReader.ReadToEnd();\r\n    }\r\n    \r\n    public void Write(Message message, object obj)\r\n    {\r\n      byte[] buffer;\r\n      Stream stream;\r\n      \r\n      buffer = Encoding.Unicode.GetBytes( obj.ToString() );\r\n      stream = new MemoryStream( buffer );\r\n      message.BodyType = 8;\r\n      message.BodyStream = stream;\r\n    \r\n    }\r\n    \r\n    public bool CanRead( Message message )\r\n    {\r\n      return true;\r\n    }\r\n    \r\n    public object Clone()\r\n    {\r\n      return new MSMQStringMessageFormatter();\r\n    }\r\n  }\r\n}\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["MSMQ","MessageFormatter"]},{"RecordId":"873","Title":"EXE Name","Description":"Demonstrates how to obtain the executable that is running.","Code":"string exe = Environment.GetCommandLineArgs()[0];\r\nstring hostApplicationName = Path.GetFileNameWithoutExtension( exe );\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["EXE Name","Executable Name"]},{"RecordId":"874","Title":"Enumerations - Using Custom String Properties","Description":"Demonstrates how to assign custom string values to enumeration elements, and how to retrieve an enumeration element given a custom string.","Code":"//**************************************************************************\r\n// Usage Samples\r\n//**************************************************************************\r\n\r\nStringEnum.GetStringValue(EnumWithStrings.Fox)\r\nEnumWithStrings en = (EnumWithStrings) StringEnum.Parse(typeof(EnumWithStrings), \"Fourth Value\")\r\n\r\nenum EnumWithStrings\r\n{\r\n    [StringValue(\"First Value\")]\r\n    Quick,\r\n    [StringValue(\"Second Value\")]\r\n    Brown = 1,\r\n    [StringValue(\"Third Value\")]\r\n    Fox = 8,\r\n    [StringValue(\"Fourth Value\")]\r\n    Lazy,\r\n    [StringValue(\"Fifth Value\")]\r\n    Dog = 7\r\n}\r\n\r\nenum IdenticalEnumWithDifferentStrings\r\n{\r\n    [StringValue(\"1st Value\")]\r\n    Quick,\r\n    [StringValue(\"2nd Value\")]\r\n    Brown = 1,\r\n    [StringValue(\"3rd Value\")]\r\n    Fox = 8,\r\n    [StringValue(\"4th Value\")]\r\n    Lazy,\r\n    [StringValue(\"5th Value\")]\r\n    Dog = 7\r\n}\r\n\r\nenum EnumWithoutStrings\r\n{\r\n    She = 0,\r\n    Sells = 1,\r\n    Seashells = 4,\r\n    Seashore = 5\r\n}\r\n\r\nenum EnumPartialStrings\r\n{\r\n    Jumping,\r\n    [StringValue(\"Jack be nimble\")]\r\n    Jack,\r\n    Frost\r\n}\r\n\r\n\r\n//**************************************************************************\r\n// StringEnum class - This is the implementation\r\n//**************************************************************************\r\nusing System;\r\nusing System.Collections;\r\nusing System.Reflection;\r\n\r\nnamespace CodeBureau\r\n{\r\n\r\n    #region Class StringEnum\r\n\r\n    /// <summary>\r\n    /// Helper class for working with 'extended' enums using <see cref=\"StringValueAttribute\"/> attributes.\r\n    /// </summary>\r\n    public class StringEnum\r\n    {\r\n        #region Instance implementation\r\n\r\n        private Type _enumType;\r\n        private static Hashtable _stringValues = new Hashtable();\r\n\r\n        /// <summary>\r\n        /// Creates a new <see cref=\"StringEnum\"/> instance.\r\n        /// </summary>\r\n        /// <param name=\"enumType\">Enum type.</param>\r\n        public StringEnum(Type enumType)\r\n        {\r\n            if (!enumType.IsEnum)\r\n                throw new ArgumentException(String.Format(\"Supplied type must be an Enum.  Type was {0}\", enumType.ToString()));\r\n\r\n            _enumType = enumType;\r\n        }\r\n\r\n        /// <summary>\r\n        /// Gets the string value associated with the given enum value.\r\n        /// </summary>\r\n        /// <param name=\"valueName\">Name of the enum value.</param>\r\n        /// <returns>String Value</returns>\r\n        public string GetStringValue(string valueName)\r\n        {\r\n            Enum enumType;\r\n            string stringValue = null;\r\n            try\r\n            {\r\n                enumType = (Enum) Enum.Parse(_enumType, valueName);\r\n                stringValue = GetStringValue(enumType);\r\n            }\r\n            catch (Exception) { }//Swallow!\r\n\r\n            return stringValue;\r\n        }\r\n\r\n        /// <summary>\r\n        /// Gets the string values associated with the enum.\r\n        /// </summary>\r\n        /// <returns>String value array</returns>\r\n        public Array GetStringValues()\r\n        {\r\n            ArrayList values = new ArrayList();\r\n            //Look for our string value associated with fields in this enum\r\n            foreach (FieldInfo fi in _enumType.GetFields())\r\n            {\r\n                //Check for our custom attribute\r\n                StringValueAttribute[] attrs = fi.GetCustomAttributes(typeof (StringValueAttribute), false) as StringValueAttribute[];\r\n                if (attrs.Length > 0)\r\n                    values.Add(attrs[0].Value);\r\n\r\n            }\r\n\r\n            return values.ToArray();\r\n        }\r\n\r\n        /// <summary>\r\n        /// Gets the values as a 'bindable' list datasource.\r\n        /// </summary>\r\n        /// <returns>IList for data binding</returns>\r\n        public IList GetListValues()\r\n        {\r\n            Type underlyingType = Enum.GetUnderlyingType(_enumType);\r\n            ArrayList values = new ArrayList();\r\n            //Look for our string value associated with fields in this enum\r\n            foreach (FieldInfo fi in _enumType.GetFields())\r\n            {\r\n                //Check for our custom attribute\r\n                StringValueAttribute[] attrs = fi.GetCustomAttributes(typeof (StringValueAttribute), false) as StringValueAttribute[];\r\n                if (attrs.Length > 0)\r\n                    values.Add(new DictionaryEntry(Convert.ChangeType(Enum.Parse(_enumType, fi.Name), underlyingType), attrs[0].Value));\r\n\r\n            }\r\n\r\n            return values;\r\n\r\n        }\r\n\r\n        /// <summary>\r\n        /// Return the existence of the given string value within the enum.\r\n        /// </summary>\r\n        /// <param name=\"stringValue\">String value.</param>\r\n        /// <returns>Existence of the string value</returns>\r\n        public bool IsStringDefined(string stringValue)\r\n        {\r\n            return Parse(_enumType, stringValue) != null;\r\n        }\r\n\r\n        /// <summary>\r\n        /// Return the existence of the given string value within the enum.\r\n        /// </summary>\r\n        /// <param name=\"stringValue\">String value.</param>\r\n        /// <param name=\"ignoreCase\">Denotes whether to conduct a case-insensitive match on the supplied string value</param>\r\n        /// <returns>Existence of the string value</returns>\r\n        public bool IsStringDefined(string stringValue, bool ignoreCase)\r\n        {\r\n            return Parse(_enumType, stringValue, ignoreCase) != null;\r\n        }\r\n\r\n        /// <summary>\r\n        /// Gets the underlying enum type for this instance.\r\n        /// </summary>\r\n        /// <value></value>\r\n        public Type EnumType\r\n        {\r\n            get { return _enumType; }\r\n        }\r\n\r\n        #endregion\r\n\r\n        #region Static implementation\r\n\r\n        /// <summary>\r\n        /// Gets a string value for a particular enum value.\r\n        /// </summary>\r\n        /// <param name=\"value\">Value.</param>\r\n        /// <returns>String Value associated via a <see cref=\"StringValueAttribute\"/> attribute, or null if not found.</returns>\r\n        public static string GetStringValue(Enum value)\r\n        {\r\n            string output = null;\r\n            Type type = value.GetType();\r\n\r\n            if (_stringValues.ContainsKey(value))\r\n                output = (_stringValues[value] as StringValueAttribute).Value;\r\n            else\r\n            {\r\n                //Look for our 'StringValueAttribute' in the field's custom attributes\r\n                FieldInfo fi = type.GetField(value.ToString());\r\n                StringValueAttribute[] attrs = fi.GetCustomAttributes(typeof (StringValueAttribute), false) as StringValueAttribute[];\r\n                if (attrs.Length > 0)\r\n                {\r\n                    _stringValues.Add(value, attrs[0]);\r\n                    output = attrs[0].Value;\r\n                }\r\n\r\n            }\r\n            return output;\r\n\r\n        }\r\n\r\n        /// <summary>\r\n        /// Parses the supplied enum and string value to find an associated enum value (case sensitive).\r\n        /// </summary>\r\n        /// <param name=\"type\">Type.</param>\r\n        /// <param name=\"stringValue\">String value.</param>\r\n        /// <returns>Enum value associated with the string value, or null if not found.</returns>\r\n        public static object Parse(Type type, string stringValue)\r\n        {\r\n            return Parse(type, stringValue, false);\r\n        }\r\n\r\n        /// <summary>\r\n        /// Parses the supplied enum and string value to find an associated enum value.\r\n        /// </summary>\r\n        /// <param name=\"type\">Type.</param>\r\n        /// <param name=\"stringValue\">String value.</param>\r\n        /// <param name=\"ignoreCase\">Denotes whether to conduct a case-insensitive match on the supplied string value</param>\r\n        /// <returns>Enum value associated with the string value, or null if not found.</returns>\r\n        public static object Parse(Type type, string stringValue, bool ignoreCase)\r\n        {\r\n            object output = null;\r\n            string enumStringValue = null;\r\n\r\n            if (!type.IsEnum)\r\n                throw new ArgumentException(String.Format(\"Supplied type must be an Enum.  Type was {0}\", type.ToString()));\r\n\r\n            //Look for our string value associated with fields in this enum\r\n            foreach (FieldInfo fi in type.GetFields())\r\n            {\r\n                //Check for our custom attribute\r\n                StringValueAttribute[] attrs = fi.GetCustomAttributes(typeof (StringValueAttribute), false) as StringValueAttribute[];\r\n                if (attrs.Length > 0)\r\n                    enumStringValue = attrs[0].Value;\r\n\r\n                //Check for equality then select actual enum value.\r\n                if (string.Compare(enumStringValue, stringValue, ignoreCase) == 0)\r\n                {\r\n                    output = Enum.Parse(type, fi.Name);\r\n                    break;\r\n                }\r\n            }\r\n\r\n            return output;\r\n        }\r\n\r\n        /// <summary>\r\n        /// Return the existence of the given string value within the enum.\r\n        /// </summary>\r\n        /// <param name=\"stringValue\">String value.</param>\r\n        /// <param name=\"enumType\">Type of enum</param>\r\n        /// <returns>Existence of the string value</returns>\r\n        public static bool IsStringDefined(Type enumType, string stringValue)\r\n        {\r\n            return Parse(enumType, stringValue) != null;\r\n        }\r\n\r\n        /// <summary>\r\n        /// Return the existence of the given string value within the enum.\r\n        /// </summary>\r\n        /// <param name=\"stringValue\">String value.</param>\r\n        /// <param name=\"enumType\">Type of enum</param>\r\n        /// <param name=\"ignoreCase\">Denotes whether to conduct a case-insensitive match on the supplied string value</param>\r\n        /// <returns>Existence of the string value</returns>\r\n        public static bool IsStringDefined(Type enumType, string stringValue, bool ignoreCase)\r\n        {\r\n            return Parse(enumType, stringValue, ignoreCase) != null;\r\n        }\r\n\r\n        #endregion\r\n    }\r\n\r\n    #endregion\r\n\r\n    #region Class StringValueAttribute\r\n\r\n    /// <summary>\r\n    /// Simple attribute class for storing String Values\r\n    /// </summary>\r\n    public class StringValueAttribute : Attribute\r\n    {\r\n        private string _value;\r\n\r\n        /// <summary>\r\n        /// Creates a new <see cref=\"StringValueAttribute\"/> instance.\r\n        /// </summary>\r\n        /// <param name=\"value\">Value.</param>\r\n        public StringValueAttribute(string value)\r\n        {\r\n            _value = value;\r\n        }\r\n\r\n        /// <summary>\r\n        /// Gets the value.\r\n        /// </summary>\r\n        /// <value></value>\r\n        public string Value\r\n        {\r\n            get { return _value; }\r\n        }\r\n    }\r\n\r\n    #endregion\r\n}","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Enumerations"]},{"RecordId":"875","Title":"Use Reflection to Call an Event","Description":"Demonstrates how to use reflection to raise an event.","Code":"===========================================================\r\nThis sample assumes that there are two event that should be\r\npublished.  The events are named UserSaved and UserDeleted.\r\nIn order for this to happen, matching event args must exist\r\nand be named as follows:\r\n===========================================================\r\n\r\nUserSavedEventArgs\r\nUserDeletedEventArgs\r\n\r\n\r\n===========================================================\r\nThis sample further assumes that a User Service service exists\r\nthat wishes to employ the Event Publishing Service to publish \r\nthe event as follows:\r\n===========================================================\r\n\r\neventPublishingService.PublishUserSavedEvent(userSavedEventArgs);\r\neventPublishingService.PublishUserDeletedEvent(userDeletedEventArgs);\r\n\r\n\r\n===========================================================\r\nIn the Event Publishing Service, we must declare a delegate\r\nthat will be used to asynchronously raise the event.\r\n===========================================================\r\n\r\ndelegate void AsyncInvokeDelegate(Delegate del, params object[] args);\r\n\r\n===========================================================\r\nIn the Event Publishing Service, we must declare the events \r\nthat should be published.\r\n===========================================================\r\n\r\npublic event EventHandler&lt;UserSavedEventArgs&gt; UserSaved;\r\npublic event EventHandler&lt;UserDeletedEventArgs&gt; UserDeleted;\r\n\r\n\r\n===========================================================\r\nIn the Event Publishing Service, we must declare public methods\r\nthat the User Service can call to publish the events.\r\n===========================================================\r\n\r\npublic void PublishUserSavedEvent(UserSavedEventArgs userSavedEventArgs)\r\n{\r\n  OnEvent(userSavedEventArgs);\r\n}\r\n\r\npublic void PublishUserDeletedEvent(UserDeletedEventArgs userDeletedEventArgs)\r\n{\r\n  OnEvent(userSavedEventArgs);\r\n}\r\n\r\n\r\n===========================================================\r\nIn the Event Publishing Service, we must include this code.\r\nIt uses reflection to get a handle to an event handler and \r\ndynamically call it.  Note that in the code below, there are\r\nexamples of how to raise the event synchronously and synchronously.\r\n===========================================================\r\n\r\nprivate void OnEvent(ClientEventArgs e)\r\n{\r\n\r\n  // Determine the event name from the EventArgs\r\n  string eventName = e.GetType().ToString();\r\n  int lastDot = eventName.LastIndexOf(\".\");\r\n  if (lastDot > -1)\r\n  {\r\n    eventName = eventName.Substring(lastDot + 1);\r\n    eventName = eventName.Replace(\"EventArgs\", string.Empty);\r\n  }\r\n  \r\n  // ***********************************\r\n  // Use this if you want to raise the event synchronously\r\n  // ***********************************\r\n  var eventInfo = this.GetType().GetField(eventName, BindingFlags.Instance | BindingFlags.NonPublic);\r\n  if (eventInfo != null)\r\n  {\r\n    var event_member = eventInfo.GetValue(this);\r\n    if (event_member != null)\r\n    {\r\n      event_member.GetType().GetMethod(\"Invoke\").Invoke(event_member, new object[] { this, e });\r\n    }\r\n  }\r\n  \r\n  // ***********************************\r\n  // Use this if you want to raise the event asynchronously\r\n  // ***********************************\r\n  MulticastDelegate eventDelagate = (MulticastDelegate) this.GetType().GetField(eventName, BindingFlags.Instance | BindingFlags.NonPublic).GetValue(this);\r\n  if (eventDelagate != null)\r\n  {\r\n\r\n    Delegate[] delegates = eventDelagate.GetInvocationList();\r\n    AsyncInvokeDelegate invoker = new AsyncInvokeDelegate(InvokeDelegate);\r\n    \r\n    foreach (Delegate sink in delegates)\r\n    {\r\n      invoker.BeginInvoke(sink, new object[] { this, e }, null, null);\r\n    }\r\n  }\r\n}\r\n\r\n\r\n===========================================================\r\nIn the Event Publishing Service, we must include this helper\r\nmethod.  It is the concrete implementation of the delegate that\r\nis defined above.  It is called asychronously from OnEvent, and \r\nthis is the method that will actually raise the event asynchronously.\r\n===========================================================\r\n\r\nprivate static void InvokeDelegate(Delegate sink, object[] args) \r\n{\r\n  try \r\n  {\r\n    sink.DynamicInvoke(args);\r\n  }\r\n  catch {}\r\n}","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Dynamically Raise Event","Dynamically Invoke Event","EventHandler"]},{"RecordId":"876","Title":"Retrieve IP Addresses and All Network Adapters Information","Description":"Demonstrates ways of getting IP addresses and all other information about a PC's network adapters.","Code":"//------------------------\r\n//  Simple, only gets the first one\r\n//------------------------\r\n\r\nstring myHost = System.Net.Dns.GetHostName();\r\nstring myIP = System.Net.Dns.GetHostEntry(myHost).AddressList[0].ToString();\r\nSystem.Net.IPAddress[] ipAddresses = System.Net.Dns.GetHostEntry(myHost).AddressList;\r\n\r\n\r\n//------------------------\r\n//  Simple, gets all\r\n//------------------------\r\n\r\nManagementObjectSearcher objSearcher = new ManagementObjectSearcher(\"SELECT * FROM Win32_NetworkAdapterConfiguration WHERE IPEnabled = 'TRUE'\");\r\nManagementObjectCollection objCollection = objSearcher.Get();\r\nforeach (ManagementObject obj in objCollection)\r\n{\r\n  string[] AddressList = (string[]) obj[\"IPAddress\"];\r\n  foreach (string Address in AddressList)\r\n  {\r\n    string a = Address;\r\n  }\r\n}\r\n\r\n\r\n//------------------------ \r\n// Everything we need to know\r\n//------------------------ \r\n\r\nManagementObjectSearcher network_connections = new ManagementObjectSearcher(\"SELECT * FROM Win32_NetworkAdapter\");\r\n\r\nConsole.WriteLine(\"\\nFirst we will just list the names of all physical adapters\");\r\nConsole.WriteLine(\"and their connection status\");\r\nConsole.WriteLine(\"-----------------------------\");\r\n\r\n// The query of the underlying ObjectQuery object is not executed  \r\n// until the Get() function is executed.  \r\nforeach (ManagementObject connection in network_connections.Get())\r\n{\r\n  if (connection.Properties[\"NetConnectionStatus\"].Value != null)\r\n  {\r\n    Console.WriteLine(\"Product Name: \" + connection.Properties[\"ProductName\"].Value);\r\n    Console.WriteLine(\"Connection Status: \" + connection.Properties[\"NetConnectionStatus\"].Value);\r\n    Console.WriteLine(\"-----------------------------\");\r\n  }\r\n}\r\n\r\nConsole.WriteLine(\"\\nNext we will show all of the information availalbe for each physical adapter.\");\r\nConsole.WriteLine(\"Probably more than you ever wanted to know about your network adapter, but your software might need to know it...\");\r\nConsole.WriteLine(\"-----------------------------\");\r\n\r\nforeach (ManagementObject connection in network_connections.Get())\r\n{\r\n  if (connection.Properties[\"NetConnectionStatus\"].Value != null)\r\n  {\r\n    foreach (PropertyData d in connection.Properties)\r\n    {\r\n      Console.WriteLine(\"-- Name: \" + d.Name + \" Value: \" + d.Value);\r\n    }\r\n    Console.WriteLine(\"-----------------------------\");\r\n  }\r\n}\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["IP Addresses","Network Adapters"]},{"RecordId":"877","Title":"Enumerations - Using Custom String Properties (Preferred)","Description":"Demonstrates how to decorate enumeration values with strings so that you can later retrieve the string value.  This uses an attribute class to provide the decoration and an extension method to retrieve the string value.","Code":"//==========================================================\r\n// This is the attribute class\r\n//==========================================================\r\n\r\nusing System;\r\nusing System.Reflection;\r\n\r\nnamespace YourNamespace\r\n{\r\n   public static class EnumExtensions\r\n   {\r\n      /// &amp;lt;summary&amp;gt;\r\n      /// Gets the string value for a given enum's value.  This will only\r\n      /// work if you decorate your enumerations with the StringValue\r\n      /// attribute to the items in your enum.\r\n      /// &amp;lt;/summary&amp;gt;\r\n      /// &amp;lt;param name=&amp;quot;value&amp;quot;&amp;gt;The incoming enumeration.&amp;lt;/param&amp;gt;\r\n      /// &amp;lt;returns&amp;gt;The string value of the enumeration.&amp;lt;/returns&amp;gt;\r\n      public static string GetStringValue(this Enum value)\r\n      {\r\n         // Get the type\r\n         Type type = value.GetType();\r\n         \r\n         // Get fieldinfo for this type\r\n         FieldInfo fieldInfo = type.GetField(value.ToString());\r\n         \r\n         // Get the stringvalue attributes\r\n         StringValueAttribute[] attribs = fieldInfo.GetCustomAttributes(\r\n         typeof(StringValueAttribute), false) as StringValueAttribute[];\r\n         \r\n         // Return the first if there was a match.\r\n         return attribs.Length &amp;gt; 0 ? attribs[0].StringValue : string.Empty;\r\n      }\r\n   }\r\n}\r\n\r\n\r\n\r\n//==========================================================\r\n// This is the enum extension class\r\n//==========================================================\r\n\r\nusing System;\r\n\r\nnamespace YourNamespace\r\n{\r\n   /// &amp;lt;summary&amp;gt;\r\n   /// Attribute class that provides the capability of decorating an enum\r\n   /// value with a string value.\r\n   /// &amp;lt;/summary&amp;gt;\r\n   public class StringValueAttribute:Attribute\r\n   {\r\n   \r\n      /// &amp;lt;summary&amp;gt;\r\n      /// Holds the StringValue for a value in an enum.\r\n      /// &amp;lt;/summary&amp;gt;\r\n      public string StringValue { get; protected set; }\r\n      \r\n      /// Constructor used to init a StringValue Attribute\r\n      /// &amp;lt;/summary&amp;gt;\r\n      /// &amp;lt;param name=&amp;quot;value&amp;quot;&amp;gt;&amp;lt;/param&amp;gt;\r\n      public StringValueAttribute(string value)\r\n      {\r\n         this.StringValue = value;\r\n      }\r\n   }\r\n}\r\n\r\n\r\n\r\n//==========================================================\r\n// This how you decorate enums with string values.  Note that you can\r\n// mix and match decorations.  If an enum is not decorated, the value \r\n// returned is string.Empty.\r\n//==========================================================\r\n\r\npublic enum TheEnum\r\n{\r\n   [StringValue(&amp;quot;1st&amp;quot;)]\r\n   First,\r\n   \r\n   [StringValue(&amp;quot;2nd&amp;quot;)]\r\n   Second,\r\n   \r\n   Third\r\n}\r\n\r\n\r\n//==========================================================\r\n// This is how you retrieve the string values of the enum.\r\n//==========================================================\r\n\r\nstring enumText;\r\nTheEnum te = new TheEnum();\r\n\r\nte = TheEnum.First;\r\nenumText = te.GetStringValue();\r\n\r\nte = TheEnum.Second;\r\nenumText = te.GetStringValue();\r\n\r\nte = TheEnum.Third;\r\nenumText = te.GetStringValue();\r\n\r\n\r\n//==========================================================\r\n// This is how you retrieve the enum from the custom string's value.\r\n//==========================================================\r\n\r\npublic static T ParseFromEnumStringValue<T>(this string value) {\r\n\r\n   Type type = typeof (T);\r\n   T parsedValue = default(T);\r\n\r\n   foreach (var field in type.GetFields()) {\r\n      StringValueAttribute[] attribs = field.GetCustomAttributes(typeof(StringValueAttribute), false) as StringValueAttribute[];\r\n      if(attribs.Length > 0 && attribs[0].StringValue.Equals(value)) {\r\n         parsedValue = (T)Enum.Parse(type, field.Name);\r\n      }\r\n   }\r\n\r\n   return parsedValue;\r\n}","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Enumeration","Enum String Value"]},{"RecordId":"878","Title":"Invoking a Class Constructor Using Reflection","Description":"Demonstrates how to call a class's constructor and pass in parms using Reflection.","Code":"The heart of the matter is the ability to create an instance of a class dynamically, and to determine how to instantiate the object. In order to begin this example, I need to create a Type object that will allow me to access metadata on a class, such as constructors, methods, properties, etc. The provider pattern should not hard-code the type name as I have done below, but use an alternative means, such as an accessible property on a provider object. \r\n\r\n// Get my class type at runtime\r\nType myType = Type.GetType( &quot;SomeAssembly.SomeClass, SomeClass&quot; );\r\n\r\nThe next step is to create our constructor object using our instance of the type object we just created. Before doing this, we need to create an array of types that describe our constructor. If we are going to get our constructor reference, we need to describe it, for example, MyProvider(), MyProvider(string connection), and MyProvider(string connection, int someInt), all have different signatures. By creating an array of Type objects, we will be able to call the appropriate constructor. In my example, the constructor I want to call requires three parameters of different types. \r\n\r\n// We are anticipating a constructor that takes 3 parameters,\r\n// the first is a string, the second is an int, the third is a boolean.\r\nType[] conTypes = new Type[3];\r\nconTypes[0] = typeof( string );\r\nconTypes[1] = typeof( int );\r\nconTypes[2] = typeof( bool );\r\n\r\n// Get the constructor that adheres to our parameters.\r\nConstructorInfo constructor = myType.GetConstructor( conTypes );\r\n\r\nNext, we are going to invoke our constructor dynamically. Before doing this, we must define parameters to pass into our constructor when it is instantiated. In my example, I am going to pass in three objects to my constructor. \r\n\r\n// Define the parameters to pass into our constructor when we call it.\r\nobject[] constructorParams = new object[3];\r\nconstructorParams[0] = &quot;server=.;database=Pubs;uid=sa;pasword=pw&quot;;\r\nconstructorParams[1] = 52;\r\nconstructorParams[2] = false;\r\n\r\n// Invoke the constructor dynamically, getting an instance of the class.\r\nobject myObject = constructor.Invoke( constructorParams );\r\n\r\nAt this point, we have created our class object at runtime using reflection. If we debug our application, we can see how the process occurs. \r\n\r\nWhat happened to Activator.CreateInstance()? It turns out we can use Activator.CreateInstance as well to create an instance of a specified type at runtime as well. Here is the same code example using Activator.CreateInstance(). \r\n\r\n// Get my class type at runtime\r\nType myType = Type.GetType( &quot;SomeAssembly.SomeClass, SomeClass&quot; );\r\nobject instance = Activator.CreateInstance( myType );\r\n\r\n// We are anticipating a constructor that takes 3 parameters,\r\n// the first is a string, the second is an int, the third is a boolean.\r\nType[] conTypes = new Type[3];\r\nconTypes[0] = typeof( string );\r\nconTypes[1] = typeof( int );\r\nconTypes[2] = typeof( bool );\r\n\r\n// Get the constructor that adheres to our parameters.\r\nConstructorInfo constructor = myType.GetConstructor( conTypes );\r\n\r\n// Define the parameters to pass into our constructor when we call it.\r\nobject[] constructorParams = new object[3];\r\nconstructorParams[0] = &quot;server=.;database=Pubs;uid=sa;pasword=pw&quot;;\r\nconstructorParams[1] = 52;\r\nconstructorParams[2] = false;\r\n\r\n// Invoke the constructor dynamically, getting an instance of the class.\r\nobject myObject = constructor.Invoke( instance, constructorParams );\r\n\r\n\r\n\r\nHere is how to get at a internal, protected, or private constructor, assuming your class is called Foo:\r\n\r\n// If the constructor takes arguments, otherwise pass these as null\r\nType[] pTypes = new Type[1];\r\npTypes[0] = typeof(object);\r\nobject[] argList = new object[1];\r\nargList[0] = constructorArgs;\r\n\r\nConstructorInfo c = typeof(Foo).GetConstructor (\r\n\tBindingFlags.NonPublic | BindingFlags.Instance,\r\n\tnull,\r\n\tpTypes,\r\n\tnull);\r\n\r\nFoo foo = (Foo) c.Invoke(\r\n\tBindingFlags.NonPublic,\r\n\tnull,\r\n\targList,\r\n\tApplication.CurrentCulture);","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Reflection","Constructor"]},{"RecordId":"879","Title":"Generics Sample","Description":"This is a simple example that demonstrates how to pass a type into a method using generics.","Code":"============================\r\nThe method\r\n============================\r\n\r\npublic static T Get<T>() where T : class\r\n{\r\n  string implName = Program.Settings[typeof(T).Name].ToString();\r\n  object concrete = Activator.CreateInstance(Type.GetType(implName));\r\n  return (T)concrete;\r\n}\r\n\r\n\r\n============================\r\nHow to call the method\r\n============================\r\n\r\nIPlugin plugin = PluginFactory.Get<IPlugin>();\r\nplugin.OutputMessage(\"hello, world!\");\r\n\r\n\r\n============================\r\nThe configuration file for this sample\r\n============================\r\n\r\n<setting name=\"IPlugin\" serializeAs=\"String\">\r\n  <value>SomeAssembly.SomeClass</value>\r\n</setting>","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Generics"]},{"RecordId":"880","Title":"Synchronous Cancellable and Non-cancellable Events","Description":"Demonstrates how to retrieve an event's subscribers, raise the events, and retrieve the cancellable flag.","Code":"protected virtual void OnUserSaved(UserSavedEventArgs e)\r\n{\r\n  if (this.UserSaved != null)\r\n  {\r\n    foreach (EventHandler<UserSavedEventArgs> attachedClient in\r\n       this.UserSaved.GetInvocationList())\r\n    {\r\n      attachedClient(this, e);\r\n    }\r\n  }\r\n}\r\n\r\n\r\n\r\n\r\nprotected virtual void OnUserSaving(UserSavingEventArgs e)\r\n{\r\n  if (this.UserSaving != null)\r\n  {\r\n    foreach (EventHandler<UserSavingEventArgs> attachedClient in \r\n       this.UserSaving.GetInvocationList())\r\n    {\r\n      attachedClient(this, e);\r\n      if (e.Cancel)\r\n      {\r\n        break;\r\n      }\r\n    }\r\n  }\r\n}","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Events","Cancellable Event"]},{"RecordId":"881","Title":"Disposable Pattern - How to Correctly Implement It","Description":"Demonstrates how to correctly implement a disposable pattern.","Code":"//==============================================================\r\n// Abstract base class.  Note that it implements the IDisposable interface.\r\n//==============================================================\r\n\r\nusing System;\r\nnamespace HelloWorld\r\n{\r\n    public abstract class DisposableBaseClass : IDisposable\r\n    {\r\n        public void Dispose()\r\n        {\r\n            Dispose(true);\r\n            GC.SuppressFinalize(this);\r\n        }\r\n\r\n        private void Dispose(bool disposing)\r\n        {\r\n            if (disposing)\r\n            {\r\n                OnDispose();\r\n            }\r\n        }\r\n\r\n        //Template method\r\n        protected virtual void OnDispose() { }\r\n\r\n    }\r\n}\r\n\r\n\r\n//==============================================================\r\n// Derived class.  Note the implementation of OnDispose().\r\n//==============================================================\r\nusing System;\r\nnamespace HelloWorld\r\n{\r\n    public class DisposableDerivedClass:DisposableBaseClass\r\n    {\r\n        protected override void OnDispose()\r\n        {\r\n            string s = \"abc\";\r\n            base.OnDispose();\r\n        }\r\n    }\r\n}\r\n\r\n\r\n//==============================================================\r\n// Using the derived class.  When d.Dispose() is called, the \r\n// Abstract base class Dispose() method executes. This, in turn,\r\n// calls the private Dispose(bool disposing) method, which calls\r\n// the protected virtual OnDispose().  Since the derived class \r\n// has its OnDispose() method defined as protected override, \r\n// this method runs instead of the base class's OnDispose() \r\n// method.  We then force the call to the base class's OnDispose()\r\n// method by calling base.OnDispose().\r\n//==============================================================\r\nDisposableDerivedClass d = new DisposableDerivedClass();\r\nd.Dispose();","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Dispose","IDisposable"]},{"RecordId":"882","Title":"Collection Class Using Generics and IEnumerable<T>","Description":"Demonstrates how to implement a collection class using generics.  The class also implements IEnumerable<T>.","Code":"//=============================================================\r\n// Define the collection class\r\n//=============================================================\r\n\r\npublic class CarCollection<T> : IEnumerable<T> where T : Car\r\n{\r\n\r\n\tprivate List<T> arCars = new List<T>();\r\n\t\r\n\tpublic T GetCar(int pos)\r\n\t{\r\n\t\treturn arCars[pos];\r\n\t}\r\n\t\r\n\tpublic void AddCar(T c)\r\n\t{\r\n\t\tarCars.Add(c); \r\n\t}\r\n\t\r\n\tpublic void ClearCars()\r\n\t{\r\n\t\tarCars.Clear(); \r\n\t}\r\n\t\r\n\tpublic int Count\r\n\t{\r\n\t\tget \r\n\t\t{ \r\n\t\t\treturn arCars.Count; \r\n\t\t}\r\n\t}\r\n\t\r\n\t// IEnumerable<T> extends IEnumerable, therefore we need to implement\r\n\t// both versions of GetEnumerator().\r\n\tIEnumerator<T> IEnumerable<T>.GetEnumerator()\r\n\t{ \r\n\t\treturn arCars.GetEnumerator(); \r\n\t}\r\n\t\r\n\tIEnumerator IEnumerable.GetEnumerator()\r\n\t{\r\n\t\treturn arCars.GetEnumerator(); \r\n\t}\r\n}\r\n\r\n\r\n\r\n//=============================================================\r\n// Use the collection class\r\n//=============================================================\r\n \r\nCarCollection<Car> myCars = new CarCollection<Car>();\r\nmyCars.AddCar(new Car(\"Rusty\", 20));\r\nmyCars.AddCar(new Car(\"Zippy\", 90));\r\n\r\nforeach (Car c in myCars)\r\n{\r\n\tConsole.WriteLine(\"PetName: {0}, Speed: {1}\",\r\n\tc.PetName, c.Speed);\r\n}\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Generics Collection","IEnumerable<T>"]},{"RecordId":"883","Title":"Improving Your Code","Description":"Simple ways to improve the quality of your code.","Code":"Compose Method - Remove, share, generalize.  Make things reusable.  One idea per task.\r\n\r\nTDD - You become the first consumer of your code.  Use introverted objects and mocks.\r\n\r\nStatic Code Analysis - FxCop and StyleCop allow you to find the low hanging fruit.\r\n\r\nGood Citizenship - Replace Getters and Setters with more complex Set methods.  Only create Getters and Setters when you need them.  Use the Constructor pattern, Singletons, and Reflective Factories.\r\n\r\nYAGNI - You Ain't Gonna Need it.  Don't indulge in speculative development because it introduces unnecessary complexity.  Let frameworks evolve from working code instead of an all-encompassing design up front.\r\n\r\nSingle Level Abstraction Principle - Keep all code within a method at the same level of abstraction.","Declares":"","CodeCategory":{"CategoryId":"7","CategoryDescription":"Misc"},"Keywords":["Improving Your Code"]},{"RecordId":"884","Title":"Deep Copy Clone Using Object Serialize/Deserialize","Description":"Accomplishes a deep copy clone of an object using Serialize/Deserialize against a BinaryFormatter.  NOTE:  The object to be cloned must be marked as [Serializable].","Code":"Usage:  myClone = ObjectCopier.Clone(objectBeingCloned);.\r\n\r\n\r\n\r\nusing System;\r\nusing System.IO;\r\nusing System.Runtime.Serialization;\r\nusing System.Runtime.Serialization.Formatters.Binary;     \r\n\r\n/// <summary>\r\n/// Provides a method for performing a deep copy of an object.\r\n/// Binary Serialization is used to perform the copy.\r\n/// </summary>\r\npublic static class ObjectCopier\r\n{\r\n   public static T Clone<T>(T source)\r\n   {\r\n      if (!typeof(T).IsSerializable)\r\n      {\r\n         throw new ArgumentException(\"The type must be serializable.\", \"source\");\r\n      }\r\n      \r\n      // Don't serialize a null object, simply return the default for that object\r\n      if (Object.ReferenceEquals(source, null))\r\n      {\r\n         return default(T);\r\n      }\r\n      \r\n      IFormatter formatter = new BinaryFormatter();\r\n      Stream stream = new MemoryStream();\r\n      using (stream)\r\n      {\r\n         formatter.Serialize(stream, source);\r\n         stream.Seek(0, SeekOrigin.Begin);\r\n         return (T)formatter.Deserialize(stream);\r\n      }\r\n   }\r\n}","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Clone","Deep Copy"]},{"RecordId":"885","Title":"Speeding up Firefox 3.5.5","Description":"Config settings to speed up Firefox 3.5.5.","Code":"Speeding up Firefox 3.5.5\r\n\r\nType about.config in address bar\r\n\r\nEdit these keys\r\nnetwork.http.pipelining.maxrequests\t8\r\nnetwork.http.pipelining\t\t\ttrue\r\nnetwork.http.proxy.pipelining\t\ttrue\r\nplugin.expose_full_path\t\t\ttrue\r\nnetwork.dns.disableIPv6 \t\ttrue\r\n\r\nCreate these new keys\r\nui.submenuDelay\t\t\tinteger\t\t0\r\nnglayout.initialpaint.delay\tinteger\t\t0\r\ncontent.notify.backoffcount\tinteger\t\t5\r\n","Declares":"","CodeCategory":{"CategoryId":"7","CategoryDescription":"Misc"},"Keywords":["Firefox"]},{"RecordId":"886","Title":"Implementing Equals in a Class","Description":"Demonstrates the proper way to implement Equals in class.","Code":"NOTES:\r\nIn the .Net framework, == and != are intended to be implemented as ReferenceEquals, therefore you should allow the framework to implement those comparisons.\r\n\r\nThe .Equals method is where individual property comparisons should occur.\r\n\r\nThe code below was created by ReSharper.\r\n\r\nThe interface is included only to verify when .Equals is called on the concrete class.\r\n\r\n\r\npublic interface IMyClass\r\n{\r\n    string Id {get;set;}\r\n    string Name {get;set;}\r\n}\r\n\r\n\r\nnamespace HelloWorld.OperatorOverrides\r\n{\r\n    public class MyClass : IMyClass\r\n    {\r\n        public string Id { get; set; }\r\n        public string Name { get; set; }\r\n\r\n        public override bool Equals(object obj)\r\n        {\r\n            if (ReferenceEquals(null, obj))\r\n                return false;\r\n\r\n            if (ReferenceEquals(this, obj))\r\n                return true;\r\n\r\n            if (obj.GetType() != typeof(MyClass))\r\n                return false;\r\n\r\n            return Equals((MyClass) obj);\r\n        }\r\n\r\n        public bool Equals(MyClass other)\r\n        {\r\n            if (ReferenceEquals(null, other))\r\n                return false;\r\n\r\n            if (ReferenceEquals(this, other))\r\n                return true;\r\n\r\n            return Equals(other.Id, this.Id) && Equals(other.Name, this.Name);\r\n        }\r\n\r\n        public override int GetHashCode()\r\n        {\r\n            unchecked\r\n            {\r\n                return ((this.Id != null ? this.Id.GetHashCode() : 0) * 397)\r\n                       ^ (this.Name != null ? this.Name.GetHashCode() : 0);\r\n            }\r\n        }\r\n    }\r\n}","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Equals","Overriding Operators"]},{"RecordId":"887","Title":"Windows 7 Super Panel","Description":"The following was found on http://jeffblankenburg.com.  It explains how to create a \"Super Panel\" folder on your Windows 7 computer where you will have access to all of the control panel features in one place.","Code":"Create a new folder on your computer.\r\n \r\nRename the folder \"SuperPanel.{ED7BA470-8E54-465E-825C-99712043E01C}\" without the quotes.  Note that the use of \"SuperPanel\" is arbitrary.  It can be any valid folder name that you prefer.\r\n \r\nOpen the folder in Windows Explorer.\r\n\r\nWhat you will find is a wonderfully long list of control panel features all in one place!\r\n","Declares":"","CodeCategory":{"CategoryId":"7","CategoryDescription":"Misc"},"Keywords":["Windows 7 Super Panel"]},{"RecordId":"888","Title":"Add Non-Nullable Column to Sql Server Table","Description":"Demonstrates the best (simplest) way to add a non-nullable column to a Sql Server table.","Code":"The WITH VALUES modifier to a DEFAULT constraint applies the default value to existing rows, eliminating the need to add a nullable column, update all rows, then change it to non-nullable.\r\n\r\nIF NOT EXISTS (SELECT * FROM sys.columns WHERE object_id=OBJECT_ID('[YourTable]') AND [Name]='YourColumn')\r\n  ALTER TABLE [YourTable]\r\n    ADD [YourColumn] nvarchar(20) not null \r\n    CONSTRAINT DF_YourTable_YourColumn DEFAULT 'YourDefaultValue' WITH VALUES \r\n\r\n\r\n\r\nWITH VALUES specifies that the value given in DEFAULT constant_expression is stored in a new column added to existing rows. WITH VALUES can be specified only when DEFAULT is specified in an ADD column clause. If the added column allows null values and WITH VALUES is specified, the default value is stored in the new column added to existing rows. If WITH VALUES is not specified for columns that allow nulls, the value NULL is stored in the new column in existing rows. If the new column does not allow nulls, the default value is stored in new rows regardless of whether WITH VALUES is specified.\r\n","Declares":"","CodeCategory":{"CategoryId":"6","CategoryDescription":"T-SQL"},"Keywords":["Add Non-Nullable Column","WITH VALUES"]},{"RecordId":"889","Title":"Time Zones - Information and Problems","Description":"Information about how to retrieve the time zone and daylight savings settings.  Also describes the problem of cached CultureInfo and changes to these settings.","Code":"The implementation of the DateTime object in .NET caches the current CultureInfo object.  Therefore, .Net is not aware of any changes to it once it has been read.  This means that changes to the machine's current time zone are cached and not re-read when the time zone setting is changed until the machine is rebooted.\r\n\r\nWhen changing the time zone setting on a machine, the problem discussed in general terms:\r\nhttp://social.msdn.microsoft.com/Forums/en/netfxbcl/thread/ee781cd6-bbfc-4f86-a317-f00de4f1aa59 \r\n\r\nHow to determine the current time zone and daylight savings in .NET or in Win 32:\r\n\r\n.NET\r\nhttp://msdn.microsoft.com/en-us/library/system.timezone.aspx \r\nNOTE: This method also used the cached culture information. Therefore, it cannot be used to observe time zone changes in the OS.\r\n\r\nWin32\r\nhttp://www.pinvoke.net/default.aspx/kernel32/GetTimeZoneInformation.html \r\n\r\nMore information about DateTime-object. Note this is not updated to the latest framework version but still valuable.\r\nhttp://msdn.microsoft.com/en-us/netframework/aa569606.aspx \r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Time Zone","Daylight Savings Time","CultureInfo"]},{"RecordId":"890","Title":"Using Log4Net to Write to Sql Compact Database","Description":"Example that shows how to configure Log4Net to write to a Sql Compact database.  The database contains some of the built-in information from Log4Net as well as two additional columns.","Code":"======================================================\r\nSql table layout\r\nTable name:  Log\r\nNote that the table contains two custom columns (Custom1 & Custom2)\r\n======================================================\r\nColumns\r\n\r\nID uniqueidentifier defaultvalue=NewID()\r\nDate datetime\r\nThread nvarchar(255)\r\nLevel nvarchar(50)\r\nLogger nvarchar(255)\r\nMessage nvarchar(4000)\r\nException nvarchar(2000)\r\nUserName nvarchar(255)\r\nCustom1 nvarchar(100)\r\nCustom2 nvarchar(100)\r\n\r\n======================================================\r\nConfig to handle the log4net column mappings\r\n======================================================\r\n\r\n<?xml version=\"1.0\" encoding=\"utf-8\" ?>\r\n<configuration>\r\n\r\n  <configSections>\r\n    <section name=\"log4net\"\r\n           type=\"log4net.Config.Log4NetConfigurationSectionHandler,Log4net\"/>\r\n  </configSections>\r\n\r\n  <log4net>\r\n\r\n    <root>\r\n      <level value=\"DEBUG\" />\r\n      <appender-ref ref=\"SQLCEAppender\" />\r\n    </root>\r\n\r\n    <appender name=\"SQLCEAppender\" type=\"log4net.Appender.AdoNetAppender\">\r\n\r\n      <connectionType value=\"System.Data.SqlServerCe.SqlCeConnection, \r\n         System.Data.SqlServerCe\" />\r\n      <connectionString value=\"Data Source='LoggingDB.sdf';\" />\r\n      <commandText value=\"INSERT INTO Log \r\n        ([Date],[Thread],[Level],[Logger],[Message],[Exception],[UserName],\r\n            [Custom1], [Custom2]) \r\n        VALUES (@log_date, @thread, @log_level, @logger, @message, @exception,\r\n            @username, @custom1, @custom2)\" />\r\n\r\n      <parameter>\r\n        <parameterName value=\"@log_date\" />\r\n        <dbType value=\"DateTime\" />\r\n        <layout type=\"log4net.Layout.RawUtcTimeStampLayout\" />\r\n      </parameter>\r\n\r\n      <parameter>\r\n        <parameterName value=\"@thread\" />\r\n        <dbType value=\"String\" />\r\n        <size value=\"255\" />\r\n        <layout type=\"log4net.Layout.PatternLayout\">\r\n          <conversionPattern value=\"%thread\" />\r\n        </layout>\r\n      </parameter>\r\n\r\n      <parameter>\r\n        <parameterName value=\"@log_level\" />\r\n        <dbType value=\"String\" />\r\n        <size value=\"50\" />\r\n        <layout type=\"log4net.Layout.PatternLayout\">\r\n          <conversionPattern value=\"%level\" />\r\n        </layout>\r\n      </parameter>\r\n\r\n      <parameter>\r\n        <parameterName value=\"@logger\" />\r\n        <dbType value=\"String\" />\r\n        <size value=\"255\" />\r\n        <layout type=\"log4net.Layout.PatternLayout\">\r\n          <conversionPattern value=\"%logger\" />\r\n        </layout>\r\n      </parameter>\r\n\r\n      <parameter>\r\n        <parameterName value=\"@message\" />\r\n        <dbType value=\"String\" />\r\n        <size value=\"4000\" />\r\n        <layout type=\"log4net.Layout.PatternLayout\">\r\n          <conversionPattern value=\"%message\" />\r\n        </layout>\r\n      </parameter>\r\n\r\n      <parameter>\r\n        <parameterName value=\"@exception\" />\r\n        <dbType value=\"String\" />\r\n        <size value=\"2000\" />\r\n        <layout type=\"log4net.Layout.ExceptionLayout\" />\r\n      </parameter>\r\n\r\n      <parameter>\r\n        <parameterName value=\"@username\" />\r\n        <dbType value=\"String\" />\r\n        <size value=\"255\" />\r\n        <layout type=\"log4net.Layout.PatternLayout\">\r\n          <conversionPattern value=\"%username\" />\r\n        </layout>\r\n      </parameter>\r\n\r\n      <parameter>\r\n        <parameterName value=\"@custom1\" />\r\n        <dbType value=\"String\" />\r\n        <size value=\"255\" />\r\n        <layout type=\"log4net.Layout.PatternLayout\">\r\n          <conversionPattern value=\"%property{Custom1}\" />\r\n        </layout>\r\n      </parameter>\r\n\r\n      <parameter>\r\n        <parameterName value=\"@custom2\" />\r\n        <dbType value=\"String\" />\r\n        <size value=\"255\" />\r\n        <layout type=\"log4net.Layout.PatternLayout\">\r\n          <conversionPattern value=\"%property{Custom2}\" />\r\n        </layout>\r\n      </parameter>\r\n    </appender>\r\n  </log4net>\r\n</configuration>\r\n\r\n\r\n\r\n======================================================\r\nClass that logs some stuff\r\n======================================================\r\n\r\npublic class Program\r\n{\r\n\r\n  private static log4net.ILog Log = \r\n          log4net.LogManager.GetLogger(typeof(Program));\r\n  \r\n  public static void Main(string[] args)\r\n  {\r\n  \r\n    log4net.Config.XmlConfigurator.Configure();\r\n    \r\n    log4net.ThreadContext.Properties[\"Custom1\"] = \"This is a custom message 1\";\r\n    log4net.ThreadContext.Properties[\"Custom2\"] = \"This is a custom message 2\";\r\n    \r\n    Log.Info(\"This is a info message\");\r\n    Log.Debug(\"This is a debug message\");\r\n    Log.Error(\"This is a error message\");\r\n    Log.Fatal(\"This is a fatal message\");\r\n    Log.Warn(\"This is a warning message\");\r\n  \r\n  }\r\n}\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Log4Net"]},{"RecordId":"891","Title":"Linq to Enties Sample","Description":"Demonstrates how to replace \"Include\" in Linq to Entities.  Also shows how perform \"where\" against nested collection.","Code":"Traditional Linq to Entities using &quot;Include&quot;\r\n\r\nvar query = from p in ctx.PicklistLines\r\n        .Include(&quot;Picklist&quot;)\r\n        .Include(&quot;Item&quot;)\r\n        .Include(&quot;Item.ItemAliases&quot;)\r\n        .Include(&quot;Item.ItemLocations&quot;)\r\n        .Include(&quot;Item.ItemLocations.Location&quot;)\r\n        .Include(&quot;TargetStation&quot;)\r\n        .Include(&quot;TargetStation.Area&quot;)\r\n        .Include(&quot;Area&quot;)\r\n        .Include(&quot;Item.ItemLocations.Location.Inventory&quot;)\r\n    where p.Item.ItemLocations.Any(l =&gt; l.LocationId == 65533)\r\n    select p;\r\n\r\n\r\n\r\nRe-written without &quot;Include&quot;, but returns the same result.\r\nNote the nested &quot;where&quot; on ItemLocations.\r\n\r\nvar query = (from p in ctx.PicklistLines\r\n    where p.FillDate != null &amp;&amp; p.Item.ItemLocations.Any(il =&gt; il.LocationId == 65533)\r\n    select new {\r\n         Picklist = p.Picklist,\r\n         PicklistLine = p,\r\n         Item = p.Item,\r\n         ItemLocations = p.Item.ItemLocations.Where(il =&gt; il.LocationId == 65533),\r\n         ItemAliases = p.Item.ItemAliases,\r\n         TargetStation = p.TargetStation,\r\n         TargetStationArea = p.TargetStation.Area,\r\n         Area = p.Area,\r\n         Location = p.Item.ItemLocations.Select(l=&gt;l.Location),\r\n         Inventory = p.Item.ItemLocations.Select(l=&gt;l.Location).Select(il=&gt;il.Inventory)\r\n    })\r\n    .AsEnumerable()\r\n    .Select(p =&gt; p.PicklistLine);","Declares":"","CodeCategory":{"CategoryId":"28","CategoryDescription":".Net - LINQ"},"Keywords":["Linq to Entities"]},{"RecordId":"892","Title":"Linq to Enties Sample - Group By","Description":"Demonstrates how to perform a Group By on two columns and sum on a third column.","Code":"var itemsSummed = from sll in StocklistLinesToStock\r\n\t\t\t        group sll by new {sll.ItemId, sll.InventoryId } into g\r\n            \t\tselect new { ItemId = g.Key.ItemId, InventoryId = g.Key.InventoryId, QtyOrderedSummed = g.Sum(x => x.QuantityOrdered) };\r\n","Declares":"","CodeCategory":{"CategoryId":"28","CategoryDescription":".Net - LINQ"},"Keywords":["Group By"]},{"RecordId":"893","Title":"Linq to Enties Sample - Contains (Similar to \"WHERE IN\")","Description":"Linq sample that demonstrates how to use \"Contains\" in Linq to entities query. \r\n\r\nThis the T-Sql equivalent of \"SELECT Something FROM Somewhere WHERE SomeField IN ('a', 'b')\"\r\n","Code":"NOTE that in LINQ we extract the list of things that go in the \"Contains\" clause precedes the list of items being filtered.\r\n\r\nIf this were T-Sql, it would like more like this:\r\nSelect sll.InventoryId from sll Where Inventory In secondaryInventories.InventoryIds.\r\n\r\nIn this sample, variable \"secondaryInventories\" is an IList of InventoryDTO.\r\n\r\n\r\nvar remoteStocklistLines = (from sl in CurrentStocklists\r\n                            from sll in sl.StocklistLinesDTO\r\n                            where sll.QuantityOrderedRemaining != 0\r\n                                    && ((sll.ItemDTO.ItemLocationsDTO.Where( l => l.LocationId == GlobalVariables.RemoteItemLocations.RemoteItemsBinId).Any())\r\n                                        || \r\n                                    \t(secondaryInventories.Select(si => si.InventoryId).Contains(sll.InventoryId)))                                                        \r\n                            select sll).ToList();\r\n","Declares":"","CodeCategory":{"CategoryId":"28","CategoryDescription":".Net - LINQ"},"Keywords":["Contains"]},{"RecordId":"894","Title":"Linq to Enties Sample - Group By and Sum Multiple Rows Into Single Row With Additional Columns","Description":"Combines multiple lines for the same Item from the same Source (each with a different Inventory) by summing the quantities of specific inventory into a specific Quantity variable.\r\n","Code":"CREATE TABLE [dbo].[StocklistLine](\r\n  [RestockId] [nvarchar](16) NOT NULL,\r\n  [ItemId] [nvarchar](16) NOT NULL,\r\n  [SourceId] [nvarchar](25) NOT NULL,\r\n  [SourceType] [nvarchar](1) NOT NULL,\r\n  [StationId] [nvarchar](10) NULL,\r\n  [AreaId] [nvarchar](8) NULL,\r\n  [ReturnReason] [nvarchar](64) NULL,\r\n  [ReceivedDate] [datetime] NULL,\r\n  [ReceivedUserId] [nvarchar](12) NULL,\r\n  [SyncProcess] [datetime] NULL,\r\n  [Deleted] [bit] NOT NULL,\r\n  [QuantityOrdered] [numeric](8, 2) NOT NULL,\r\n  [QuantityReceived] [numeric](8, 2) NULL,\r\n  [InventoryId] [int] NOT NULL,\r\n     CONSTRAINT [PK_StocklistLine] PRIMARY KEY CLUSTERED \r\n     (\r\n        [RestockId] ASC,\r\n        [ItemId] ASC,\r\n        [SourceId] ASC,\r\n        [SourceType] ASC,\r\n        [InventoryId] ASC\r\n     )\r\n)\r\n\r\nvar query = from p in stocklistLines\r\n   group p by new {\r\n      p.RestockId,\r\n      ReceivingSourceId = p.ReceivingSource.Id,\r\n      ReceivingSourceName = p.ReceivingSource.Name,\r\n      ItemDosage = p.ItemDTO.DosageForm,\r\n      TicketBarCode = p.StockingTicketBarcode,\r\n      TicketId = p.StockingTicketId,\r\n      p.ItemId,\r\n      p.ItemDTO.ItemDescription\r\n   }\r\n   into g\r\n   select new OrderLineDataView {\r\n      OrderId = g.Key.RestockId,\r\n      ContraLocationId = g.Key.ReceivingSourceId,\r\n      ContraLocationName = g.Key.ReceivingSourceName,\r\n      ItemId = g.Key.ItemId,\r\n      ItemDescription = g.Key.ItemDescription,\r\n      FillQuantity = g.Where(p => p.InventoryDTO.InventoryType ==\r\n         InventoryType.Primary.GetStringValue())\r\n           .Sum(p => p.QuantityReceived.Value),\r\n      ExpiredReceiveQuantity = g.Where(p => p.InventoryDTO.InventoryType ==\r\n         InventoryType.Expired.GetStringValue())\r\n           .Sum(p => p.QuantityReceived.Value),\r\n      WasteReceiveQuantity = g.Where(p => p.InventoryDTO.InventoryType ==\r\n         InventoryType.Waste.GetStringValue())\r\n           .Sum(p => p.QuantityReceived.Value),\r\n      ItemDosage = g.Key.ItemDosage,\r\n      TicketBarcode = g.Key.TicketBarCode,\r\n      TicketId = g.Key.TicketId\r\n   };\r\n","Declares":"","CodeCategory":{"CategoryId":"28","CategoryDescription":".Net - LINQ"},"Keywords":["Linq to Entities","Group and Sum","Combine Rows"]},{"RecordId":"895","Title":"Determine Week Number","Description":"Computes week number of a date.","Code":"DateTime[] dateTimes = new DateTime[4];\r\ndateTimes[0] = new DateTime(2012,01,01);\r\ndateTimes[1] = new DateTime(2012,01,07);\r\ndateTimes[2] = new DateTime(2012,01,08);\r\ndateTimes[3] = DateTime.Now;\r\n\r\nCultureInfo cultureInfo = CultureInfo.CurrentCulture;\r\nforeach (DateTime dt in dateTimes) {\r\n\tConsole.WriteLine( string.Format(\"{0} = {1}.\" , \r\n\tdt.ToShortDateString(), \r\n\tcultureInfo.Calendar.GetWeekOfYear( dt,\r\n\t\tcultureInfo.DateTimeFormat.CalendarWeekRule,\r\n\t\tcultureInfo.DateTimeFormat.FirstDayOfWeek )));\r\n}\r\n","Declares":"","CodeCategory":{"CategoryId":"22","CategoryDescription":".Net - C#"},"Keywords":["Week Number"]},{"RecordId":"896","Title":"Compute Elapsed Time in DOS bat File","Description":"Computes elapsed time in a DOS batch file.","Code":"@echo off\r\n\r\n:: Capture the start time (in centiseconds since midnight)\r\nfor /f \"tokens=5-8 delims=:,. \" %%a in ('echo:^|time') do (\r\n  set /a hh=%%a,mm=1%%b-100,ss=1%%c-100,cc=1%%d-100\r\n)\r\nset /a start=360000*hh+6000*mm+100*ss+cc\r\n\r\n\r\n:: Do you tasks here\r\nping localhost\r\n\r\n:: Capture the finish time (in centiseconds since midnight)\r\nfor /f \"tokens=5-8 delims=:,. \" %%a in ('echo:^|time') do (\r\n  set /a hh=%%a,mm=1%%b-100,ss=1%%c-100,cc=1%%d-100\r\n)\r\n\r\n:: Calculate the elapsed time in centiseconds.  Adjust for midnight.\r\nset /a elapsed=360000*hh+6000*mm+100*ss+cc-start\r\nif %elapsed% lss 0 set /a elapsed=8640000-elapsed\r\n\r\n:: Convert centiseconds into hours, minutes and seconds\r\nset /a t=elapsed,cc=t%%100,t/=100,ss=t%%60,t/=60,mm=t%%60,t/=60,hh=t%%24\r\necho Elapsed time = %hh% hrs %mm% mins %ss%.%cc% secs\r\n\r\npause","Declares":"","CodeCategory":{"CategoryId":"7","CategoryDescription":"Misc"},"Keywords":["Elapsed Time","DOS"]},{"RecordId":"897","Title":"Create Date/Time String in DOS Batch File","Description":"Demonstrates how to create a string that contains the Date & Time in a DOS batch file.  This variable can then be used to create a temp file name (if needed).","Code":"for /F \"tokens=2-4 delims=/ \" %%i in ('date /t') do set yyyymmdd=%%k%%i%%j\r\nset hhmmss=%TIME:~0,2%%TIME:~3,2%%TIME:~6,2%\r\nset ResultFileName=MyFile%yyyymmdd%%hhmmss%.txt\r\necho %ResultFileName%","Declares":"","CodeCategory":{"CategoryId":"7","CategoryDescription":"Misc"},"Keywords":["DOS Date Time","DOS DateTime","DOS Temp File"]}]